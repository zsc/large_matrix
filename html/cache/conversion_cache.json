{
  "../chapter11.md": {
    "hash": "9ce535c7164ba57346fe5df945e62643",
    "content": "<h1 id=\"11\">\u7b2c11\u7ae0\uff1a\u6d41\u5f62\u9884\u6761\u4ef6\u6280\u672f</h1>\n<p>\u6d41\u5f62\u4f18\u5316\u4e2d\u7684\u9884\u6761\u4ef6\u6280\u672f\u662f\u5c06\u6b27\u6c0f\u7a7a\u95f4\u4e2d\u6210\u719f\u7684\u4e8c\u9636\u65b9\u6cd5\u63a8\u5e7f\u5230\u66f2\u7ebf\u7a7a\u95f4\u7684\u5173\u952e\u6865\u6881\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5982\u4f55\u5728\u4fdd\u6301\u51e0\u4f55\u7ed3\u6784\u7684\u540c\u65f6\uff0c\u5229\u7528\u66f2\u7387\u4fe1\u606f\u52a0\u901f\u6536\u655b\u3002\u6211\u4eec\u5c06\u770b\u5230\uff0c\u6070\u5f53\u7684\u9884\u6761\u4ef6\u4e0d\u4ec5\u80fd\u663e\u8457\u63d0\u5347\u7b97\u6cd5\u6548\u7387\uff0c\u8fd8\u80fd\u63ed\u793a\u95ee\u9898\u7684\u5185\u5728\u51e0\u4f55\u7ed3\u6784\u3002</p>\n<h2 id=\"111-natural-gradient\">11.1 \u6d41\u5f62\u4e0a\u7684Natural Gradient</h2>\n<h3 id=\"1111\">11.1.1 \u4ece\u4fe1\u606f\u51e0\u4f55\u5230\u4f18\u5316</h3>\n<p>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u53c2\u6570\u7a7a\u95f4\u5f80\u5f80\u5177\u6709\u81ea\u7136\u7684Riemannian\u7ed3\u6784\u3002\u6700\u5178\u578b\u7684\u4f8b\u5b50\u662f\u6982\u7387\u5206\u5e03\u7684\u53c2\u6570\u7a7a\u95f4\uff0c\u5176\u4e0a\u7684Fisher\u4fe1\u606f\u77e9\u9635\u5b9a\u4e49\u4e86\u4e00\u4e2a\u81ea\u7136\u7684Riemannian\u5ea6\u91cf\uff1a</p>\n<p>$$g_{ij}(\\theta) = \\mathbb{E}_{p(x|\\theta)}\\left[\\frac{\\partial \\log p(x|\\theta)}{\\partial \\theta_i} \\frac{\\partial \\log p(x|\\theta)}{\\partial \\theta_j}\\right]$$\nNatural Gradient\u65b9\u6cd5\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5728\u8fd9\u4e2a\u51e0\u4f55\u7ed3\u6784\u4e0b\u8fdb\u884c\u6700\u9661\u4e0b\u964d\uff1a\n$$\\theta_{k+1} = \\theta_k - \\alpha_k G^{-1}(\\theta_k) \\nabla f(\\theta_k)$$\n\u5176\u4e2d$G(\\theta)$\u662f\u5ea6\u91cf\u5f20\u91cf\u7684\u77e9\u9635\u8868\u793a\u3002</p>\n<h3 id=\"1112-natural-gradient\">11.1.2 \u6d41\u5f62Natural Gradient\u7684\u4e00\u822c\u5f62\u5f0f</h3>\n<p>\u5bf9\u4e8e\u4e00\u822c\u7684Riemannian\u6d41\u5f62$\\mathcal{M}$\uff0cNatural Gradient\u66f4\u65b0\u53ef\u4ee5\u5199\u6210\uff1a\n$$x_{k+1} = \\mathcal{R}_{x_k}(-\\alpha_k \\xi_k)$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\xi_k = G_{x_k}^{-1}(\\text{grad} f(x_k))$\u662f\u9884\u6761\u4ef6\u540e\u7684\u641c\u7d22\u65b9\u5411</li>\n<li>$G_{x_k}$\u662f\u70b9$x_k$\u5904\u7684Riemannian\u5ea6\u91cf</li>\n<li>$\\mathcal{R}_{x_k}$\u662f\u56de\u7f29\u6620\u5c04</li>\n</ul>\n<p>\u5173\u952e\u89c2\u5bdf\uff1aNatural Gradient\u5728\u6d41\u5f62\u4e0a\u7684\u8868\u73b0\u5f62\u5f0f\u81ea\u7136\u5730\u7ed3\u5408\u4e86\u51e0\u4f55\u7ed3\u6784\u548c\u51fd\u6570\u7684\u5c40\u90e8\u4fe1\u606f\u3002</p>\n<h3 id=\"1113\">11.1.3 \u5ea6\u91cf\u9009\u62e9\u7684\u827a\u672f</h3>\n<p>\u4e0d\u540c\u7684\u5ea6\u91cf\u9009\u62e9\u5bfc\u81f4\u4e0d\u540c\u7684\u7b97\u6cd5\u884c\u4e3a\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6807\u51c6\u5ea6\u91cf</strong>\uff1a\u5bf9\u4e8e$\\text{St}(p,n)$\uff08Stiefel\u6d41\u5f62\uff09\uff0c\u6807\u51c6\u5ea6\u91cf\u662f\n$$g_X(\\xi, \\eta) = \\text{tr}(\\xi^T(I - \\frac{1}{2}XX^T)\\eta)$$</p>\n</li>\n<li>\n<p><strong>\u6b27\u6c0f\u5ea6\u91cf</strong>\uff1a\u7b80\u5355\u5730\u7ee7\u627f\u73af\u5883\u7a7a\u95f4\u7684\u5ea6\u91cf\n$$g_X(\\xi, \\eta) = \\text{tr}(\\xi^T\\eta)$$</p>\n</li>\n<li>\n<p><strong>\u95ee\u9898\u76f8\u5173\u5ea6\u91cf</strong>\uff1a\u57fa\u4e8e\u76ee\u6807\u51fd\u6570\u7684Hessian\u4fe1\u606f\u6784\u9020\n$$g_X(\\xi, \\eta) = \\langle \\xi, \\mathcal{H}_X[\\eta] \\rangle$$</p>\n</li>\n</ol>\n<h3 id=\"1114\">11.1.4 \u9ad8\u6548\u5b9e\u73b0\u7b56\u7565</h3>\n<p>\u8ba1\u7b97$G^{-1}\\text{grad} f$\u7684\u4e3b\u8981\u6311\u6218\u5728\u4e8e\uff1a</p>\n<ul>\n<li>\u5ea6\u91cf\u5f20\u91cf\u53ef\u80fd\u662f\u7a20\u5bc6\u7684</li>\n<li>\u76f4\u63a5\u6c42\u9006\u8ba1\u7b97\u4ee3\u4ef7\u9ad8\u6602</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u8981\u6c42</li>\n</ul>\n<p>\u5b9e\u8df5\u4e2d\u5e38\u7528\u7684\u6280\u5de7\u5305\u62ec\uff1a</p>\n<ol>\n<li><strong>\u5bf9\u89d2\u8fd1\u4f3c</strong>\uff1a\u5f53\u5ea6\u91cf\u63a5\u8fd1\u5bf9\u89d2\u65f6\uff0c\u4f7f\u7528\u5bf9\u89d2\u9884\u6761\u4ef6</li>\n<li><strong>\u4f4e\u79e9\u4fee\u6b63</strong>\uff1a\u5229\u7528Woodbury\u516c\u5f0f\u5904\u7406\u4f4e\u79e9\u6270\u52a8</li>\n<li><strong>\u8fed\u4ee3\u6c42\u89e3</strong>\uff1a\u4f7f\u7528\u5171\u8f6d\u68af\u5ea6\u6cd5\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf$G\\xi = \\text{grad} f$</li>\n</ol>\n<h3 id=\"1115\">11.1.5 \u6536\u655b\u6027\u5206\u6790\u8981\u70b9</h3>\n<p>Natural Gradient\u5728\u6d41\u5f62\u4e0a\u7684\u6536\u655b\u6027\u4f9d\u8d56\u4e8e\uff1a</p>\n<ul>\n<li>\u5ea6\u91cf\u7684Lipschitz\u8fde\u7eed\u6027</li>\n<li>\u76ee\u6807\u51fd\u6570\u7684\u6d4b\u5730\u51f8\u6027</li>\n<li>\u6b65\u957f\u9009\u62e9\u7b56\u7565</li>\n</ul>\n<p>\u5173\u952e\u5b9a\u7406\uff1a\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\uff0cNatural Gradient\u8fbe\u5230\u5c40\u90e8\u4e8c\u6b21\u6536\u655b\u7387\u3002</p>\n<h3 id=\"1116\">11.1.6 \u4e0e\u7ecf\u5178\u65b9\u6cd5\u7684\u8054\u7cfb</h3>\n<p>\u6709\u8da3\u7684\u662f\uff0c\u8bb8\u591a\u7ecf\u5178\u7b97\u6cd5\u53ef\u4ee5\u89c6\u4e3a\u7279\u5b9a\u6d41\u5f62\u4e0a\u7684Natural Gradient\uff1a</p>\n<ul>\n<li><strong>\u77e9\u9635Scaling</strong>\uff1a\u6b63\u5b9a\u77e9\u9635\u6d41\u5f62\u4e0a\u7684Natural Gradient</li>\n<li><strong>Riemannian\u5171\u8f6d\u68af\u5ea6</strong>\uff1a\u4f7f\u7528\u7279\u5b9a\u5ea6\u91cf\u7684\u9884\u6761\u4ef6\u5171\u8f6d\u68af\u5ea6</li>\n<li><strong>\u6d4b\u5730Newton\u6cd5</strong>\uff1a\u4e8c\u9636Natural Gradient</li>\n</ul>\n<p>\u5177\u4f53\u4f8b\u5b50\uff1a</p>\n<ol>\n<li><strong>Sinkhorn\u7b97\u6cd5</strong>\uff1a\u53ef\u89c6\u4e3aWasserstein\u6d41\u5f62\u4e0a\u7684Natural Gradient</li>\n<li><strong>\u5e42\u65b9\u6cd5</strong>\uff1a\u5355\u4f4d\u7403\u9762\u4e0a\u4f7f\u7528\u7279\u5b9a\u5ea6\u91cf\u7684Natural Gradient</li>\n<li><strong>\u4ea4\u66ff\u6700\u5c0f\u5316</strong>\uff1a\u67d0\u4e9b\u4e58\u79ef\u6d41\u5f62\u4e0a\u7684\u5757\u5750\u6807Natural Gradient</li>\n</ol>\n<h3 id=\"1117\">11.1.7 \u8ba1\u7b97\u4f18\u5316\u6280\u5de7</h3>\n<p>\u5728\u5b9e\u9645\u5b9e\u73b0Natural Gradient\u65f6\uff0c\u4ee5\u4e0b\u6280\u5de7\u81f3\u5173\u91cd\u8981\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5ea6\u91cf\u77e9\u9635\u7684\u9ad8\u6548\u8868\u793a</strong>\uff1a\n   - \u5229\u7528Kronecker\u7ed3\u6784\uff1a$G = A \\otimes B$\n   - \u7a00\u758f\u6a21\u5f0f\u8bc6\u522b\uff1a\u53ea\u5b58\u50a8\u975e\u96f6\u5143\u7d20\n   - \u4f4e\u79e9\u5206\u89e3\uff1a$G = UU^T + \\sigma I$</p>\n</li>\n<li>\n<p><strong>\u9884\u6761\u4ef6\u7cfb\u7edf\u7684\u8fed\u4ee3\u6c42\u89e3</strong>\uff1a\n   <code>PCG\u7b97\u6cd5\u6846\u67b6\uff1a\n   \u8f93\u5165\uff1a\u7ebf\u6027\u7cfb\u7edf Gx = b\uff0c\u9884\u6761\u4ef6\u5b50M\n   \u521d\u59cb\u5316\uff1ar\u2080 = b - Gx\u2080, z\u2080 = M\u207b\u00b9r\u2080, p\u2080 = z\u2080\n   \u8fed\u4ee3\u76f4\u5230\u6536\u655b\uff1a\n     \u03b1\u2096 = (r\u2096\u1d40z\u2096)/(p\u2096\u1d40Gp\u2096)\n     x\u2096\u208a\u2081 = x\u2096 + \u03b1\u2096p\u2096\n     r\u2096\u208a\u2081 = r\u2096 - \u03b1\u2096Gp\u2096\n     z\u2096\u208a\u2081 = M\u207b\u00b9r\u2096\u208a\u2081\n     \u03b2\u2096 = (r\u2096\u208a\u2081\u1d40z\u2096\u208a\u2081)/(r\u2096\u1d40z\u2096)\n     p\u2096\u208a\u2081 = z\u2096\u208a\u2081 + \u03b2\u2096p\u2096</code></p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236</strong>\uff1a\n   - \u8fdc\u79bb\u6700\u4f18\u70b9\u65f6\u4f7f\u7528\u4f4e\u7cbe\u5ea6\n   - \u63a5\u8fd1\u6536\u655b\u65f6\u63d0\u9ad8\u6c42\u89e3\u7cbe\u5ea6\n   - \u57fa\u4e8e\u68af\u5ea6\u8303\u6570\u52a8\u6001\u8c03\u6574</p>\n</li>\n</ol>\n<h3 id=\"1118\">11.1.8 \u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</h3>\n<p>Natural Gradient\u5728\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u4e2d\u6709\u91cd\u8981\u5e94\u7528\uff1a</p>\n<ol>\n<li>\n<p><strong>K-FAC (Kronecker-Factored Approximate Curvature)</strong>\uff1a\n   - \u5c06Fisher\u77e9\u9635\u8fd1\u4f3c\u4e3aKronecker\u79ef\n   - \u663e\u8457\u51cf\u5c11\u5b58\u50a8\u548c\u8ba1\u7b97\u9700\u6c42\n   - \u5728\u5927\u89c4\u6a21\u7f51\u7edc\u4e2d\u5b9e\u7528</p>\n</li>\n<li>\n<p><strong>TONGA (Toroidal Natural Gradient Ascent)</strong>\uff1a\n   - \u4e13\u95e8\u7528\u4e8e\u73af\u5f62\u62d3\u6251\u7684\u53c2\u6570\u7a7a\u95f4\n   - \u5728\u5faa\u73af\u795e\u7ecf\u7f51\u7edc\u4e2d\u7279\u522b\u6709\u6548</p>\n</li>\n<li>\n<p><strong>Shampoo\u7b97\u6cd5</strong>\uff1a\n   - \u4f7f\u7528\u5757\u5bf9\u89d2\u52a0Kronecker\u7ed3\u6784\n   - \u5728Transformer\u8bad\u7ec3\u4e2d\u8868\u73b0\u4f18\u5f02</p>\n</li>\n</ol>\n<h3 id=\"1119\">11.1.9 \u7406\u8bba\u6df1\u5165\uff1a\u4fe1\u606f\u51e0\u4f55\u89c6\u89d2</h3>\n<p>\u4ece\u4fe1\u606f\u51e0\u4f55\u89d2\u5ea6\u7406\u89e3Natural Gradient\u63d0\u4f9b\u4e86\u6df1\u523b\u6d1e\u5bdf\uff1a</p>\n<ol>\n<li>\n<p><strong>KL\u6563\u5ea6\u4e0eFisher\u4fe1\u606f</strong>\uff1a\n$$D_{KL}(p_{\\theta}||p_{\\theta+\\delta}) \\approx \\frac{1}{2}\\delta^T G(\\theta) \\delta$$\n\u8fd9\u8868\u660eFisher\u4fe1\u606f\u77e9\u9635\u6d4b\u91cf\u4e86\u53c2\u6570\u7a7a\u95f4\u4e2d\u7684\"\u4fe1\u606f\u8ddd\u79bb\"\u3002</p>\n</li>\n<li>\n<p><strong>\u03b1-\u8054\u7edc\u4e0e\u51e0\u4f55\u7ed3\u6784</strong>\uff1a\n   - \u4e0d\u540c\u7684\u03b1\u503c\u5b9a\u4e49\u4e0d\u540c\u7684\u51e0\u4f55\u7ed3\u6784\n   - \u03b1=0\u5bf9\u5e94\u6df7\u5408\u8054\u7edc\uff08\u81ea\u7136\u68af\u5ea6\uff09\n   - \u03b1=\u00b11\u5bf9\u5e94\u6307\u6570\u548c\u6df7\u5408\u8054\u7edc</p>\n</li>\n<li>\n<p><strong>\u5bf9\u5076\u7ed3\u6784</strong>\uff1a\n   - \u53c2\u6570\u7a7a\u95f4\u4e0e\u671f\u671b\u53c2\u6570\u7a7a\u95f4\u7684\u5bf9\u5076\n   - \u901a\u8fc7Legendre\u53d8\u6362\u8054\u7cfb\n   - \u63d0\u4f9b\u4e86\u7b97\u6cd5\u8bbe\u8ba1\u7684\u65b0\u89c6\u89d2</p>\n</li>\n</ol>\n<h3 id=\"11110\">11.1.10 \u6570\u503c\u7a33\u5b9a\u6027\u6df1\u5165\u5206\u6790</h3>\n<p>Natural Gradient\u7684\u6570\u503c\u7a33\u5b9a\u6027\u6311\u6218\u53ca\u89e3\u51b3\u65b9\u6848\uff1a</p>\n<ol>\n<li>\n<p><strong>\u75c5\u6001Fisher\u77e9\u9635</strong>\uff1a\n   - \u6dfb\u52a0Tikhonov\u6b63\u5219\u5316\uff1a$\\tilde{G} = G + \\lambda I$\n   - \u4f7f\u7528\u8c31\u622a\u65ad\uff1a\u4fdd\u7559\u524dk\u4e2a\u7279\u5f81\u503c\n   - \u81ea\u9002\u5e94\u8c03\u6574\u6b63\u5219\u5316\u53c2\u6570</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u7206\u70b8/\u6d88\u5931</strong>\uff1a\n   - \u68af\u5ea6\u88c1\u526a\uff1a$\\xi = \\min(1, \\frac{c}{||\\xi||}) \\xi$\n   - \u5c42\u5f52\u4e00\u5316\u6280\u672f\n   - \u81ea\u9002\u5e94\u6b65\u957f\u8c03\u6574</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u7cbe\u5ea6\u635f\u5931</strong>\uff1a\n   - \u4f7f\u7528\u53cc\u7cbe\u5ea6\u8ba1\u7b97\u5173\u952e\u6b65\u9aa4\n   - Kahan\u6c42\u548c\u7b97\u6cd5\u51cf\u5c11\u820d\u5165\u8bef\u5dee\n   - \u5b9a\u671f\u91cd\u65b0\u8ba1\u7b97\u57fa\u51c6\u503c</p>\n</li>\n</ol>\n<h3 id=\"11111\">11.1.11 \u524d\u6cbf\u7814\u7a76\u65b9\u5411</h3>\n<p>Natural Gradient\u65b9\u6cd5\u7684\u6d3b\u8dc3\u7814\u7a76\u9886\u57df\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91cf\u5b50Natural Gradient</strong>\uff1a\n   - \u5728\u91cf\u5b50\u53c2\u6570\u4f18\u5316\u4e2d\u7684\u5e94\u7528\n   - Fubini-Study\u5ea6\u91cf\u7684\u4f7f\u7528\n   - \u4e0e\u7ecf\u5178\u65b9\u6cd5\u7684\u6027\u80fd\u6bd4\u8f83</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0fNatural Gradient</strong>\uff1a\n   - Fisher\u77e9\u9635\u7684\u5206\u5e03\u5f0f\u8ba1\u7b97\n   - \u901a\u4fe1\u9ad8\u6548\u7684\u8fd1\u4f3c\u65b9\u6848\n   - \u5f02\u6b65\u66f4\u65b0\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u5143\u5b66\u4e60\u4e2d\u7684Natural Gradient</strong>\uff1a\n   - \u4efb\u52a1\u7a7a\u95f4\u7684\u81ea\u7136\u51e0\u4f55\n   - \u5feb\u901f\u9002\u5e94\u7684\u7406\u8bba\u57fa\u7840\n   - \u4e0eMAML\u7b49\u65b9\u6cd5\u7684\u8054\u7cfb</p>\n</li>\n<li>\n<p><strong>\u9690\u5f0fNatural Gradient</strong>\uff1a\n   - \u907f\u514d\u663e\u5f0f\u8ba1\u7b97Fisher\u77e9\u9635\n   - \u901a\u8fc7\u52a8\u91cf\u65b9\u6cd5\u9690\u5f0f\u5b9e\u73b0\n   - \u7406\u8bba\u5206\u6790\u4e0e\u5b9e\u8df5\u9a8c\u8bc1</p>\n</li>\n</ol>\n<h2 id=\"112-riemannian-bfgs\">11.2 Riemannian BFGS\u65b9\u6cd5</h2>\n<h3 id=\"1121\">11.2.1 \u52a8\u673a\u4e0e\u57fa\u672c\u601d\u60f3</h3>\n<p>BFGS\u65b9\u6cd5\u5728\u6b27\u6c0f\u7a7a\u95f4\u4e2d\u7684\u6210\u529f\u6fc0\u53d1\u4e86\u5176\u5728\u6d41\u5f62\u4e0a\u7684\u63a8\u5e7f\u3002\u6838\u5fc3\u6311\u6218\u5728\u4e8e\u5982\u4f55\u5728\u66f2\u7ebf\u7a7a\u95f4\u4e2d\u7ef4\u62a4\u548c\u66f4\u65b0Hessian\u8fd1\u4f3c\u3002Riemannian BFGS (RBFGS)\u901a\u8fc7\u5de7\u5999\u5229\u7528\u5411\u91cf\u4f20\u8f93\u89e3\u51b3\u4e86\u8fd9\u4e00\u95ee\u9898\u3002</p>\n<p>\u57fa\u672c\u66f4\u65b0\u516c\u5f0f\u9075\u5faa\u62dfNewton\u6761\u4ef6\uff1a\n$$\\mathcal{H}_{k+1} s_k = y_k$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$s_k = \\mathcal{T}_{x_k}^{x_{k+1}} \\xi_k$\u662f\u6b65\u957f\u7684\u5411\u91cf\u4f20\u8f93</li>\n<li>$y_k = \\text{grad} f(x_{k+1}) - \\mathcal{T}_{x_k}^{x_{k+1}} \\text{grad} f(x_k)$</li>\n</ul>\n<h3 id=\"1122\">11.2.2 \u5411\u91cf\u4f20\u8f93\u7684\u9009\u62e9</h3>\n<p>\u5411\u91cf\u4f20\u8f93$\\mathcal{T}$\u7684\u9009\u62e9\u5bf9\u7b97\u6cd5\u6027\u80fd\u81f3\u5173\u91cd\u8981\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5e73\u884c\u4f20\u8f93</strong>\uff1a\u4fdd\u6301\u5411\u91cf\"\u65b9\u5411\"\u4e0d\u53d8\uff0c\u7406\u8bba\u6027\u8d28\u6700\u597d\n   - \u4f18\u70b9\uff1a\u4fdd\u5ea6\u91cf\u3001\u4fdd\u6b63\u4ea4\u6027\n   - \u7f3a\u70b9\uff1a\u8ba1\u7b97\u4ee3\u4ef7\u53ef\u80fd\u5f88\u9ad8</p>\n</li>\n<li>\n<p><strong>\u6295\u5f71\u4f20\u8f93</strong>\uff1a\u7b80\u5355\u5730\u6295\u5f71\u5230\u5207\u7a7a\u95f4\n$$\\mathcal{T}_{x}^{y} \\xi = \\mathcal{P}_{T_y\\mathcal{M}} \\xi$$</p>\n</li>\n</ol>\n<ul>\n<li>\u4f18\u70b9\uff1a\u8ba1\u7b97\u7b80\u5355</li>\n<li>\u7f3a\u70b9\uff1a\u53ef\u80fd\u4e0d\u4fdd\u5ea6\u91cf</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5411\u91cf\u573a\u4f20\u8f93</strong>\uff1a\u5229\u7528\u6d41\u5f62\u7684\u5411\u91cf\u573a\u7ed3\u6784\n   - \u9002\u7528\u4e8e\u5177\u6709Lie\u7fa4\u4f5c\u7528\u7684\u6d41\u5f62</li>\n</ol>\n<h3 id=\"1123-rbfgs\">11.2.3 RBFGS\u66f4\u65b0\u516c\u5f0f</h3>\n<p>\u7ed9\u5b9a\u5f53\u524dHessian\u8fd1\u4f3c$\\mathcal{H}_k$\uff0c\u66f4\u65b0\u516c\u5f0f\u4e3a\uff1a\n$$\\mathcal{H}_{k+1} = \\mathcal{H}_k - \\frac{\\mathcal{H}_k s_k s_k^T \\mathcal{H}_k}{s_k^T \\mathcal{H}_k s_k} + \\frac{y_k y_k^T}{y_k^T s_k}$$\n\u6ce8\u610f\uff1a\u6240\u6709\u8fd0\u7b97\u90fd\u5728\u5207\u7a7a\u95f4$T_{x_{k+1}}\\mathcal{M}$\u4e2d\u8fdb\u884c\u3002</p>\n<h3 id=\"1124-l-rbfgs\">11.2.4 \u6709\u9650\u5185\u5b58\u53d8\u4f53 (L-RBFGS)</h3>\n<p>\u5bf9\u4e8e\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u6709\u9650\u5185\u5b58\u7248\u672c\u66f4\u5b9e\u7528\uff1a</p>\n<ol>\n<li>\u5b58\u50a8\u6700\u8fd1$m$\u5bf9$(s_i, y_i)$</li>\n<li>\u4f7f\u7528\u4e24\u5faa\u73af\u9012\u5f52\u8ba1\u7b97\u641c\u7d22\u65b9\u5411</li>\n<li>\u521d\u59cbHessian\u8fd1\u4f3c\u7684\u5de7\u5999\u9009\u62e9\uff1a\n$$\\mathcal{H}_0 = \\frac{y_{k-1}^T s_{k-1}}{y_{k-1}^T y_{k-1}} I$$</li>\n</ol>\n<h3 id=\"1125\">11.2.5 \u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</h3>\n<p>RBFGS\u5b9e\u73b0\u4e2d\u7684\u5173\u952e\u6570\u503c\u95ee\u9898\uff1a</p>\n<ol>\n<li>\n<p><strong>\u66f2\u7387\u6761\u4ef6</strong>\uff1a\u786e\u4fdd$y_k^T s_k &gt; 0$\n   - \u53ef\u80fd\u9700\u8981\u4fee\u6b63$y_k$\u6216\u4f7f\u7528\u963b\u5c3c\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u6b63\u5b9a\u6027\u7ef4\u62a4</strong>\uff1a\n   - \u4f7f\u7528\u4fee\u6b63BFGS\u516c\u5f0f\n   - Powell-Wolfe\u7ebf\u641c\u7d22\u6761\u4ef6</p>\n</li>\n<li>\n<p><strong>\u5411\u91cf\u4f20\u8f93\u7684\u6570\u503c\u8bef\u5dee</strong>\uff1a\n   - \u7d2f\u79ef\u8bef\u5dee\u53ef\u80fd\u7834\u574f\u6536\u655b\u6027\n   - \u5b9a\u671f\u91cd\u7f6e\u6216\u91cd\u6b63\u4ea4\u5316</p>\n</li>\n</ol>\n<h3 id=\"1126\">11.2.6 \u6536\u655b\u6027\u7406\u8bba</h3>\n<p>\u5173\u952e\u7ed3\u679c\uff1a</p>\n<ul>\n<li><strong>\u5c40\u90e8\u8d85\u7ebf\u6027\u6536\u655b</strong>\uff1a\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\uff0cRBFGS\u8fbe\u5230\u8d85\u7ebf\u6027\u6536\u655b\u7387</li>\n<li><strong>\u5168\u5c40\u6536\u655b</strong>\uff1a\u914d\u5408\u9002\u5f53\u7684\u7ebf\u641c\u7d22\uff0c\u4fdd\u8bc1\u5168\u5c40\u6536\u655b\u5230\u9a7b\u70b9</li>\n</ul>\n<p>\u6536\u655b\u901f\u5ea6\u4f9d\u8d56\u4e8e\uff1a</p>\n<ul>\n<li>\u5411\u91cf\u4f20\u8f93\u7684\u7b49\u8ddd\u6027</li>\n<li>Hessian\u7684Lipschitz\u8fde\u7eed\u6027</li>\n<li>\u521d\u59cb\u70b9\u9009\u62e9</li>\n</ul>\n<h3 id=\"1127\">11.2.7 \u5b9e\u9645\u5e94\u7528\u6848\u4f8b</h3>\n<ol>\n<li><strong>\u4f4e\u79e9\u77e9\u9635\u4f18\u5316</strong>\uff1a\u5728Grassmann\u6d41\u5f62\u4e0a\u7684RBFGS</li>\n<li><strong>\u5f20\u91cf\u5206\u89e3</strong>\uff1a\u5728\u4e58\u79ef\u6d41\u5f62\u4e0a\u7684\u5e94\u7528</li>\n<li><strong>\u6df1\u5ea6\u5b66\u4e60</strong>\uff1a\u6b63\u4ea4\u7ea6\u675f\u4e0b\u7684\u7f51\u7edc\u8bad\u7ec3</li>\n</ol>\n<p>\u8ba9\u6211\u4eec\u6df1\u5165\u8fd9\u4e9b\u5e94\u7528\uff1a</p>\n<p><strong>\u6848\u4f8b1\uff1aNetflix\u5956\u95ee\u9898\u7684\u51e0\u4f55\u89c6\u89d2</strong></p>\n<ul>\n<li>\u4f7f\u7528Grassmann\u6d41\u5f62\u5efa\u6a21\u4f4e\u79e9\u77e9\u9635\u5206\u89e3</li>\n<li>RBFGS\u76f8\u6bd4\u68af\u5ea6\u4e0b\u964d\u52a0\u901f3-5\u500d</li>\n<li>\u5173\u952e\uff1a\u5229\u7528\u4e86\u95ee\u9898\u7684\u5185\u5728\u4f4e\u7ef4\u7ed3\u6784</li>\n</ul>\n<p><strong>\u6848\u4f8b2\uff1a\u8111\u6210\u50cf\u6570\u636e\u7684\u5f20\u91cf\u5206\u89e3</strong></p>\n<ul>\n<li>fMRI\u6570\u636e\u7684\u591a\u8def\u5206\u89e3</li>\n<li>\u5728$\\mathcal{St}(r_1,n_1) \\times \\mathcal{St}(r_2,n_2) \\times \\mathcal{St}(r_3,n_3)$\u4e0a\u4f18\u5316</li>\n<li>RBFGS\u5904\u7406\u9ad8\u7ef4\u6570\u636e\u7684\u4f18\u52bf\u660e\u663e</li>\n</ul>\n<p><strong>\u6848\u4f8b3\uff1a\u6b63\u4ea4\u9012\u5f52\u795e\u7ecf\u7f51\u7edc</strong></p>\n<ul>\n<li>\u89e3\u51b3\u68af\u5ea6\u6d88\u5931/\u7206\u70b8\u95ee\u9898</li>\n<li>\u5728Stiefel\u6d41\u5f62\u4e0a\u4fdd\u6301\u6743\u91cd\u6b63\u4ea4\u6027</li>\n<li>\u957f\u5e8f\u5217\u5efa\u6a21\u6027\u80fd\u63d0\u5347\u663e\u8457</li>\n</ul>\n<h3 id=\"1128\">11.2.8 \u5b9e\u73b0\u7ec6\u8282\u4e0e\u4ee3\u7801\u7ed3\u6784</h3>\n<p>\u867d\u7136\u6211\u4eec\u4e0d\u5c55\u793a\u5177\u4f53\u4ee3\u7801\uff0c\u4f46\u7406\u89e3RBFGS\u7684\u5b9e\u73b0\u7ed3\u6784\u5f88\u91cd\u8981\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6838\u5fc3\u6570\u636e\u7ed3\u6784</strong>\uff1a\n   - \u5b58\u50a8\u7ed3\u6784\uff1a\u5faa\u73af\u7f13\u51b2\u533a\u5b58\u50a8$(s_k, y_k)$\u5bf9\n   - \u5411\u91cf\u4f20\u8f93\u7f13\u5b58\uff1a\u907f\u514d\u91cd\u590d\u8ba1\u7b97\n   - \u5ea6\u91cf\u4fe1\u606f\uff1a\u6839\u636e\u6d41\u5f62\u7c7b\u578b\u7279\u5316</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u6d41\u7a0b</strong>\uff1a\n   ```\n   RBFGS\u4e3b\u5faa\u73af\uff1a</p>\n</li>\n<li>\n<p>\u8ba1\u7b97Riemannian\u68af\u5ea6</p>\n</li>\n<li>\u4f7f\u7528\u4e24\u5faa\u73af\u9012\u5f52\u8ba1\u7b97\u641c\u7d22\u65b9\u5411</li>\n<li>\u6267\u884c\u7ebf\u641c\u7d22\uff08\u6d4b\u5730\u7ebf\u641c\u7d22\uff09</li>\n<li>\u66f4\u65b0\u4f4d\u7f6e\uff08\u901a\u8fc7\u56de\u7f29\uff09</li>\n<li>\u8ba1\u7b97\u5411\u91cf\u4f20\u8f93</li>\n<li>\u66f4\u65b0BFGS\u5b58\u50a8</li>\n<li>\n<p>\u68c0\u67e5\u6536\u655b\u6761\u4ef6\n   ```</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u4f18\u5316\u8981\u70b9</strong>\uff1a\n   - \u5411\u91cf\u5316\u6240\u6709\u53ef\u80fd\u7684\u8fd0\u7b97\n   - \u5229\u7528\u6d41\u5f62\u7684\u5bf9\u79f0\u6027\u51cf\u5c11\u8ba1\u7b97\n   - \u667a\u80fd\u5185\u5b58\u7ba1\u7406\u907f\u514d\u9891\u7e41\u5206\u914d</p>\n</li>\n</ol>\n<h3 id=\"1129\">11.2.9 \u4e0e\u5176\u4ed6\u4e8c\u9636\u65b9\u6cd5\u7684\u6bd4\u8f83</h3>\n<p>RBFGS\u5728\u6d41\u5f62\u4f18\u5316\u65b9\u6cd5\u8c31\u7cfb\u4e2d\u7684\u4f4d\u7f6e\uff1a</p>\n<ol>\n<li>\n<p><strong>vs Riemannian Newton</strong>\uff1a\n   - Newton\uff1a\u9700\u8981\u8ba1\u7b97/\u5b58\u50a8\u5b8c\u6574Hessian\n   - RBFGS\uff1a\u53ea\u9700\u5b58\u50a8$2m$\u4e2a\u5411\u91cf\n   - Newton\uff1a\u5c40\u90e8\u4e8c\u6b21\u6536\u655b\n   - RBFGS\uff1a\u8d85\u7ebf\u6027\u6536\u655b\u4f46\u66f4\u7a33\u5b9a</p>\n</li>\n<li>\n<p><strong>vs Riemannian\u5171\u8f6d\u68af\u5ea6</strong>\uff1a\n   - RCG\uff1a\u5185\u5b58\u9700\u6c42\u6700\u5c0f\n   - RBFGS\uff1a\u5229\u7528\u5386\u53f2\u4fe1\u606f\u66f4\u5145\u5206\n   - RCG\uff1a\u5bf9\u975e\u51f8\u95ee\u9898\u53ef\u80fd\u9700\u8981\u9891\u7e41\u91cd\u542f\n   - RBFGS\uff1a\u5bf9\u66f2\u7387\u53d8\u5316\u9002\u5e94\u6027\u66f4\u597d</p>\n</li>\n<li>\n<p><strong>vs Riemannian Trust Region</strong>\uff1a\n   - RTR\uff1a\u5168\u5c40\u6536\u655b\u6027\u4fdd\u8bc1\u66f4\u5f3a\n   - RBFGS\uff1a\u5b9e\u73b0\u76f8\u5bf9\u7b80\u5355\n   - RTR\uff1a\u6bcf\u6b65\u9700\u8981\u6c42\u89e3\u5b50\u95ee\u9898\n   - RBFGS\uff1a\u53ea\u9700\u7ebf\u641c\u7d22</p>\n</li>\n</ol>\n<h3 id=\"11210\">11.2.10 \u9ad8\u7ea7\u53d8\u4f53\u4e0e\u6539\u8fdb</h3>\n<p>RBFGS\u7684\u73b0\u4ee3\u53d8\u4f53\u89e3\u51b3\u7279\u5b9a\u6311\u6218\uff1a</p>\n<ol>\n<li>\n<p><strong>Riemannian L-BFGS-B</strong>\uff08\u5e26\u754c\u7ea6\u675f\uff09\uff1a\n   - \u5904\u7406\u6d41\u5f62\u4e0a\u7684\u76d2\u7ea6\u675f\n   - \u6295\u5f71\u68af\u5ea6\u4e0eRBFGS\u7684\u7ed3\u5408\n   - \u5728\u53c2\u6570\u6709\u7269\u7406\u610f\u4e49\u9650\u5236\u65f6\u6709\u7528</p>\n</li>\n<li>\n<p><strong>\u968f\u673aRBFGS</strong>\uff1a\n   - \u4f7f\u7528\u91c7\u6837\u68af\u5ea6\u4f30\u8ba1\n   - \u65b9\u5dee\u7f29\u51cf\u6280\u672f\u7684\u878d\u5165\n   - \u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0fRBFGS</strong>\uff1a\n   - \u5411\u91cf\u5bf9\u7684\u5206\u5e03\u5f0f\u5b58\u50a8\n   - \u5f02\u6b65\u66f4\u65b0\u7b56\u7565\n   - \u901a\u4fe1\u4e0e\u8ba1\u7b97\u7684\u6743\u8861</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94RBFGS</strong>\uff1a\n   - \u52a8\u6001\u8c03\u6574\u5b58\u50a8\u5927\u5c0f$m$\n   - \u57fa\u4e8e\u66f2\u7387\u4fe1\u606f\u9009\u62e9\u6027\u66f4\u65b0\n   - \u5728\u7ebf\u5b66\u4e60\u573a\u666f\u7684\u5e94\u7528</p>\n</li>\n</ol>\n<h3 id=\"11211\">11.2.11 \u7406\u8bba\u524d\u6cbf\uff1a\u6536\u655b\u901f\u5ea6\u7684\u7cbe\u7ec6\u5206\u6790</h3>\n<p>\u6700\u65b0\u7406\u8bba\u7ed3\u679c\u63d0\u4f9b\u4e86\u66f4\u6df1\u5165\u7684\u7406\u89e3\uff1a</p>\n<ol>\n<li>\n<p><strong>Dennis-Mor\u00e9\u6761\u4ef6\u7684\u6d41\u5f62\u63a8\u5e7f</strong>\uff1a\n$$\\lim_{k \\to \\infty} \\frac{|(\\mathcal{H}_k - \\text{Hess} f(x_*))s_k|}{|s_k|} = 0$$\n\u8fd9\u4fdd\u8bc1\u4e86\u8d85\u7ebf\u6027\u6536\u655b\u3002</p>\n</li>\n<li>\n<p><strong>\u6709\u9650\u7ec8\u6b62\u6027\u8d28</strong>\uff1a\n   \u5bf9\u4e8e\u4e8c\u6b21\u76ee\u6807\u51fd\u6570\u5728\u6d41\u5f62\u4e0a\u7684\u9650\u5236\uff0cRBFGS\u5728\u81f3\u591a$n$\u6b65\u5185\u6536\u655b\uff08$n$\u662f\u6d41\u5f62\u7ef4\u6570\uff09\u3002</p>\n</li>\n<li>\n<p><strong>\u5168\u5c40\u6536\u655b\u901f\u5ea6</strong>\uff1a\n   \u5728\u5f3a\u51f8\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8bc1\u660e\uff1a\n$$f(x_k) - f(x_*) \\leq C \\cdot r^k$$\n\u5176\u4e2d$r &lt; 1$\u4f9d\u8d56\u4e8e\u6761\u4ef6\u6570\u548c\u6b65\u957f\u7b56\u7565\u3002</p>\n</li>\n<li>\n<p><strong>\u5c40\u90e8\u6536\u655b\u7387\u7684\u7cbe\u786e\u523b\u753b</strong>\uff1a\n   \u8bbe$x_*$\u662f\u975e\u9000\u5316\u6781\u5c0f\u70b9\uff0c\u4e14RBFGS\u66f4\u65b0\u6ee1\u8db3\u6807\u51c6\u5047\u8bbe\uff0c\u5219\uff1a\n$$\\lim_{k \\to \\infty} \\frac{d(x_{k+1}, x_*)}{d(x_k, x_*)^{1+\\tau}} = 0$$\n\u5176\u4e2d$\\tau \\in (0,1)$\uff0c$d(\\cdot,\\cdot)$\u662f\u6d41\u5f62\u4e0a\u7684\u6d4b\u5730\u8ddd\u79bb\u3002</p>\n</li>\n<li>\n<p><strong>\u6b65\u957f\u4e3a1\u7684\u63a5\u53d7\u6027</strong>\uff1a\n   \u7c7b\u4f3c\u6b27\u6c0f\u7a7a\u95f4\u60c5\u5f62\uff0c\u5f53\u5145\u5206\u63a5\u8fd1\u6700\u4f18\u70b9\u65f6\uff0c\u5355\u4f4d\u6b65\u957f\u6700\u7ec8\u4f1a\u88ab\u63a5\u53d7\uff0c\u8fd9\u5bf9\u5b9e\u9645\u8ba1\u7b97\u6548\u7387\u81f3\u5173\u91cd\u8981\u3002</p>\n</li>\n<li>\n<p><strong>\u6709\u9650\u5185\u5b58\u7248\u672c\u7684\u6536\u655b\u6027</strong>\uff1a\n   \u5373\u4f7f\u53ea\u4fdd\u5b58$m$\u5bf9\u5411\u91cf\uff08$m \\ll n$\uff09\uff0c\u5728\u9002\u5f53\u7684\u7d27\u81f4\u6027\u5047\u8bbe\u4e0b\uff0cL-RBFGS\u4ecd\u4fdd\u6301\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>R-\u7ebf\u6027\u6536\u655b\uff08\u5168\u5c40\uff09</li>\n<li>R-\u8d85\u7ebf\u6027\u6536\u655b\uff08\u5c40\u90e8\uff0c\u5f53$m$\u8db3\u591f\u5927\uff09</li>\n</ul>\n<h3 id=\"11212\">11.2.12 \u8c03\u8bd5\u4e0e\u8bca\u65ad\u6280\u5de7</h3>\n<p>\u5b9e\u8df5\u4e2d\u8c03\u8bd5RBFGS\u7684\u5173\u952e\u70b9\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u68c0\u67e5</strong>\uff1a\n   - \u9a8c\u8bc1\u5411\u91cf\u4f20\u8f93\u7684\u7b49\u8ddd\u6027\n   - \u68c0\u67e5\u62dfNewton\u6761\u4ef6$\\mathcal{H}_{k+1}s_k = y_k$\n   - \u76d1\u63a7\u6761\u4ef6\u6570\u53d8\u5316</p>\n</li>\n<li>\n<p><strong>\u6536\u655b\u8bca\u65ad</strong>\uff1a\n   - \u7ed8\u5236\u68af\u5ea6\u8303\u6570\u5bf9\u6570\u56fe\n   - \u68c0\u67e5\u6b65\u957f\u63a5\u53d7\u7387\n   - \u5206\u6790\u641c\u7d22\u65b9\u5411\u4e0e\u8d1f\u68af\u5ea6\u7684\u5939\u89d2</p>\n</li>\n<li>\n<p><strong>\u5e38\u89c1\u95ee\u9898\u6392\u67e5</strong>\uff1a\n   - \u6536\u655b\u505c\u6ede\uff1a\u68c0\u67e5\u6570\u503c\u7cbe\u5ea6\u548c\u5411\u91cf\u4f20\u8f93\u8bef\u5dee\n   - \u632f\u8361\u884c\u4e3a\uff1a\u53ef\u80fd\u9700\u8981\u66f4\u4fdd\u5b88\u7684\u6b65\u957f\n   - \u53d1\u6563\uff1a\u9a8c\u8bc1\u5f3aWolfe\u6761\u4ef6\u662f\u5426\u6ee1\u8db3</p>\n</li>\n</ol>\n<h2 id=\"113-trust-region\">11.3 \u51e0\u4f55\u611f\u77e5\u7684Trust Region</h2>\n<h3 id=\"1131-trust-region\">11.3.1 \u6d41\u5f62Trust Region\u7684\u57fa\u672c\u6846\u67b6</h3>\n<p>Trust Region\u65b9\u6cd5\u5728\u6d41\u5f62\u4f18\u5316\u4e2d\u7279\u522b\u6709\u6548\uff0c\u56e0\u4e3a\u5b83\u81ea\u7136\u5730\u5904\u7406\u4e86\u66f2\u7387\u5e26\u6765\u7684\u975e\u7ebf\u6027\u3002\u57fa\u672c\u601d\u60f3\u662f\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d\u6c42\u89e3\u5b50\u95ee\u9898\uff1a\n$$\\min_{\\xi \\in T_x\\mathcal{M}} m_k(\\xi) \\quad \\text{s.t.} \\quad |\\xi|_x \\leq \\Delta_k$$\n\u5176\u4e2d$m_k(\\xi)$\u662f\u76ee\u6807\u51fd\u6570\u7684\u5c40\u90e8\u8fd1\u4f3c\u6a21\u578b\u3002</p>\n<h3 id=\"1132\">11.3.2 \u6a21\u578b\u6784\u9020\u7684\u827a\u672f</h3>\n<p>\u4e0d\u540c\u7684\u6a21\u578b\u9009\u62e9\u5bfc\u81f4\u4e0d\u540c\u7684\u7b97\u6cd5\u7279\u6027\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e00\u9636\u6a21\u578b</strong>\uff1a\n$$m_k(\\xi) = f(x_k) + \\langle \\text{grad} f(x_k), \\xi \\rangle_x$$</p>\n</li>\n<li>\n<p><strong>\u4e8c\u9636\u6a21\u578b</strong>\uff1a\n$$m_k(\\xi) = f(x_k) + \\langle \\text{grad} f(x_k), \\xi \\rangle_x + \\frac{1}{2}\\langle \\xi, \\text{Hess} f(x_k)[\\xi] \\rangle_x$$</p>\n</li>\n<li>\n<p><strong>\u62dfNewton\u6a21\u578b</strong>\uff1a\u4f7f\u7528RBFGS\u8fd1\u4f3c\u66ff\u4ee3\u771f\u5b9eHessian</p>\n</li>\n</ol>\n<h3 id=\"1133\">11.3.3 \u5b50\u95ee\u9898\u6c42\u89e3\u7b56\u7565</h3>\n<p>Trust Region\u5b50\u95ee\u9898\u5728\u6d41\u5f62\u4e0a\u7684\u6c42\u89e3\u9762\u4e34\u72ec\u7279\u6311\u6218\uff1a</p>\n<ol>\n<li>\n<p><strong>Cauchy\u70b9\u8ba1\u7b97</strong>\uff1a\n   - \u6cbf\u8d1f\u68af\u5ea6\u65b9\u5411\u7684\u6700\u4f18\u6b65\u957f\n   - \u63d0\u4f9b\u4e0b\u754c\u4fdd\u8bc1</p>\n</li>\n<li>\n<p><strong>\u622a\u65ad\u5171\u8f6d\u68af\u5ea6\u6cd5</strong> (tCG)\uff1a\n   - \u5728\u5207\u7a7a\u95f4\u4e2d\u8fed\u4ee3\u6c42\u89e3\n   - \u9047\u5230\u8d1f\u66f2\u7387\u65f6\u63d0\u524d\u7ec8\u6b62</p>\n</li>\n<li>\n<p><strong>Steihaug-Toint\u7b97\u6cd5\u7684\u6d41\u5f62\u63a8\u5e7f</strong>\uff1a\n   - \u7ed3\u5408CG\u8fed\u4ee3\u4e0eTrust Region\u7ea6\u675f\n   - \u81ea\u9002\u5e94\u5904\u7406\u8d1f\u66f2\u7387</p>\n</li>\n</ol>\n<h3 id=\"1134\">11.3.4 \u56de\u7f29\u6620\u5c04\u7684\u9009\u62e9\u4e0e\u5f71\u54cd</h3>\n<p>\u56de\u7f29\u6620\u5c04$\\mathcal{R}_x$\u5c06\u5207\u5411\u91cf\u6620\u5c04\u56de\u6d41\u5f62\uff0c\u5176\u9009\u62e9\u5f71\u54cd\uff1a</p>\n<ol>\n<li><strong>\u8ba1\u7b97\u6548\u7387</strong>\uff1a\u6307\u6570\u6620\u5c04vs\u6295\u5f71\u56de\u7f29</li>\n<li><strong>\u8fd1\u4f3c\u8d28\u91cf</strong>\uff1a\u4e8c\u9636vs\u4e00\u9636\u56de\u7f29</li>\n<li><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\u5927\u6b65\u957f\u65f6\u7684\u884c\u4e3a</li>\n</ol>\n<p>\u5173\u952e\u6027\u8d28\uff1a\n$$\\mathcal{R}_x(t\\xi) = \\gamma(t)$$\n\u5176\u4e2d$\\gamma$\u662f\u4ece$x$\u51fa\u53d1\u3001\u521d\u59cb\u901f\u5ea6\u4e3a$\\xi$\u7684\u6d4b\u5730\u7ebf\u3002</p>\n<h3 id=\"1135\">11.3.5 \u81ea\u9002\u5e94\u534a\u5f84\u8c03\u6574</h3>\n<p>Trust Region\u534a\u5f84$\\Delta_k$\u7684\u8c03\u6574\u7b56\u7565\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9884\u6d4b\u6bd4\u7387</strong>\uff1a\n$$\\rho_k = \\frac{f(x_k) - f(\\mathcal{R}_{x_k}(\\xi_k))}{m_k(0) - m_k(\\xi_k)}$$</p>\n</li>\n<li>\n<p><strong>\u66f4\u65b0\u89c4\u5219</strong>\uff1a\n   - \u82e5$\\rho_k &lt; 0.25$\uff1a$\\Delta_{k+1} = 0.25\\Delta_k$\n   - \u82e5$\\rho_k &gt; 0.75$\u4e14$|\\xi_k| = \\Delta_k$\uff1a$\\Delta_{k+1} = 2\\Delta_k$\n   - \u5426\u5219\uff1a$\\Delta_{k+1} = \\Delta_k$</p>\n</li>\n<li>\n<p><strong>\u51e0\u4f55\u8003\u8651</strong>\uff1a\n   - \u8003\u8651\u6d41\u5f62\u7684\u5185\u8574\u66f2\u7387\n   - \u5728\u9ad8\u66f2\u7387\u533a\u57df\u4f7f\u7528\u66f4\u4fdd\u5b88\u7684\u534a\u5f84</p>\n</li>\n</ol>\n<h3 id=\"1136\">11.3.6 \u6536\u655b\u6027\u5206\u6790</h3>\n<p>Trust Region\u65b9\u6cd5\u5728\u6d41\u5f62\u4e0a\u7684\u6536\u655b\u6027\u8d28\uff1a</p>\n<ol>\n<li><strong>\u5168\u5c40\u6536\u655b</strong>\uff1a\u4ece\u4efb\u610f\u521d\u59cb\u70b9\u6536\u655b\u5230\u4e00\u9636\u9a7b\u70b9</li>\n<li><strong>\u5c40\u90e8\u6536\u655b\u901f\u5ea6</strong>\uff1a\n   - \u4f7f\u7528\u7cbe\u786eHessian\uff1a\u4e8c\u6b21\u6536\u655b\n   - \u4f7f\u7528RBFGS\u8fd1\u4f3c\uff1a\u8d85\u7ebf\u6027\u6536\u655b</li>\n</ol>\n<p>\u5173\u952e\u5047\u8bbe\uff1a</p>\n<ul>\n<li>\u76ee\u6807\u51fd\u6570\u5728\u56de\u7f29\u90bb\u57df\u5185Lipschitz\u8fde\u7eed</li>\n<li>\u6a21\u578b\u5145\u5206\u8fd1\u4f3c\u771f\u5b9e\u51fd\u6570</li>\n</ul>\n<h3 id=\"1137\">11.3.7 \u4e0e\u7ebf\u641c\u7d22\u65b9\u6cd5\u7684\u6bd4\u8f83</h3>\n<p>Trust Region vs \u7ebf\u641c\u7d22\u5728\u6d41\u5f62\u4f18\u5316\u4e2d\u7684\u6743\u8861\uff1a</p>\n<ol>\n<li>\n<p><strong>Trust Region\u4f18\u52bf</strong>\uff1a\n   - \u81ea\u7136\u5904\u7406\u8d1f\u66f2\u7387\n   - \u5bf9\u75c5\u6001\u95ee\u9898\u66f4\u7a33\u5065\n   - \u7406\u8bba\u4fdd\u8bc1\u66f4\u5f3a</p>\n</li>\n<li>\n<p><strong>\u7ebf\u641c\u7d22\u4f18\u52bf</strong>\uff1a\n   - \u5b9e\u73b0\u76f8\u5bf9\u7b80\u5355\n   - \u6bcf\u6b65\u8ba1\u7b97\u4ee3\u4ef7\u8f83\u4f4e\n   - \u5bf9\u67d0\u4e9b\u6d41\u5f62\u7ed3\u6784\u66f4\u81ea\u7136</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7b56\u7565</strong>\uff1a\n   - \u5728Trust Region\u6846\u67b6\u4e2d\u4f7f\u7528\u7ebf\u641c\u7d22\n   - \u81ea\u9002\u5e94\u5207\u6362\u7b56\u7565</p>\n</li>\n</ol>\n<h3 id=\"1138\">11.3.8 \u9ad8\u7ea7\u5b50\u95ee\u9898\u6c42\u89e3\u6280\u672f</h3>\n<p>Trust Region\u5b50\u95ee\u9898\u7684\u6c42\u89e3\u662f\u7b97\u6cd5\u6548\u7387\u7684\u5173\u952e\uff1a</p>\n<ol>\n<li>\n<p><strong>Lanczos\u65b9\u6cd5\u7528\u4e8e\u5927\u89c4\u6a21\u95ee\u9898</strong>\uff1a\n   - \u5c06Hessian\u6295\u5f71\u5230Krylov\u5b50\u7a7a\u95f4\n   - \u5728\u4f4e\u7ef4\u7a7a\u95f4\u6c42\u89e3\u5b50\u95ee\u9898\n   - \u7279\u522b\u9002\u5408Hessian-\u5411\u91cf\u79ef\u4fbf\u5b9c\u7684\u60c5\u51b5</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u5316\u65b9\u6cd5</strong>\uff1a\n   - \u4f7f\u7528\u968f\u673a\u6295\u5f71\u964d\u7ef4\n   - Johnson-Lindenstrauss\u5f15\u7406\u4fdd\u8bc1\u8fd1\u4f3c\u8d28\u91cf\n   - \u5728\u8d85\u9ad8\u7ef4\u6d41\u5f62\u4e0a\u7684\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u6d41\u5f62\u7279\u5b9a\u7684\u52a0\u901f\u6280\u5de7</strong>\uff1a\n   - Grassmann\u6d41\u5f62\uff1a\u5229\u7528\u5546\u7a7a\u95f4\u7ed3\u6784\n   - \u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\u6d41\u5f62\uff1aCholesky\u5206\u89e3\u6280\u5de7\n   - \u56fa\u5b9a\u79e9\u77e9\u9635\u6d41\u5f62\uff1aSVD\u66f4\u65b0\u516c\u5f0f</p>\n</li>\n</ol>\n<h3 id=\"1139-trust-region\">11.3.9 Trust Region\u7684\u73b0\u4ee3\u53d8\u4f53</h3>\n<p>\u8fd1\u5e74\u6765\u53d1\u5c55\u7684\u521b\u65b0\u65b9\u6cd5\uff1a</p>\n<ol>\n<li><strong>\u7acb\u65b9\u6b63\u5219\u5316\u65b9\u6cd5 (ARC)</strong>\uff1a\n$$\\min_{\\xi} m_k(\\xi) + \\frac{\\sigma_k}{3}|\\xi|^3$$</li>\n</ol>\n<ul>\n<li>\u66f4\u597d\u7684\u7406\u8bba\u590d\u6742\u5ea6\uff1a$O(\\epsilon^{-3/2})$ vs $O(\\epsilon^{-2})$</li>\n<li>\u81ea\u9002\u5e94\u8c03\u6574\u4e09\u6b21\u9879\u7cfb\u6570$\\sigma_k$</li>\n<li>\u5728\u6d41\u5f62\u4e0a\u7684\u63a8\u5e7f\u9700\u8981\u8c28\u614e\u5904\u7406\u8303\u6570</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u6982\u7387Trust Region</strong>\uff1a\n   - \u4f7f\u7528\u968f\u673a\u6a21\u578b\u8fd1\u4f3c\n   - \u9002\u5408\u566a\u58f0\u4f18\u5316\u548c\u5927\u89c4\u6a21\u5b66\u4e60\n   - \u6536\u655b\u6027\u5206\u6790\u57fa\u4e8e\u9785\u7406\u8bba</p>\n</li>\n<li>\n<p><strong>\u591a\u7ea7Trust Region</strong>\uff1a\n   - \u4e0d\u540c\u7cbe\u5ea6\u7684\u6a21\u578b\u5c42\u6b21\n   - \u7c97\u7f51\u683c\u5230\u7ec6\u7f51\u683c\u7684\u9012\u5f52\u7b56\u7565\n   - \u5728PDE\u7ea6\u675f\u4f18\u5316\u4e2d\u7279\u522b\u6709\u6548</p>\n</li>\n</ol>\n<h3 id=\"11310-trust-region\">11.3.10 Trust Region\u4e0e\u6d41\u5f62\u7ed3\u6784\u7684\u6df1\u5ea6\u7ed3\u5408</h3>\n<p>\u5982\u4f55\u5145\u5206\u5229\u7528\u6d41\u5f62\u7684\u51e0\u4f55\u7279\u6027\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6d4b\u5730\u51f8\u6027\u7684\u5229\u7528</strong>\uff1a\n   - \u5f53\u76ee\u6807\u51fd\u6570\u6d4b\u5730\u51f8\u65f6\uff0c\u5b50\u95ee\u9898\u5168\u5c40\u6700\u4f18\n   - \u8bbe\u8ba1\u4fdd\u8bc1\u6d4b\u5730\u51f8\u6027\u7684\u6a21\u578b\n   - \u51f8\u6027\u534a\u5f84\u5185\u7684\u5feb\u901f\u6536\u655b</p>\n</li>\n<li>\n<p><strong>\u66f2\u7387\u81ea\u9002\u5e94\u7b56\u7565</strong>\uff1a\n   ```\n   \u66f2\u7387\u611f\u77e5\u7684\u534a\u5f84\u8c03\u6574\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u8ba1\u7b97\u622a\u9762\u66f2\u7387\u03ba(x,\u03be)</li>\n<li>\u8c03\u6574\u6709\u6548\u534a\u5f84\uff1a\u0394_eff = min(\u0394, \u03c0/(2\u221a\u03ba_max))</li>\n<li>\u907f\u514d\u8d85\u51fa\u51f8\u6027\u534a\u5f84\n   ```</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5bf9\u79f0\u6027\u5229\u7528</strong>\uff1a\n   - \u7b49\u53d8\u4f18\u5316\uff1a\u5229\u7528Lie\u7fa4\u4f5c\u7528\n   - \u964d\u4f4e\u6709\u6548\u7ef4\u6570\n   - \u5728\u7269\u7406\u7cfb\u7edf\u4f18\u5316\u4e2d\u5e38\u89c1</li>\n</ol>\n<h3 id=\"11311\">11.3.11 \u6570\u503c\u5b9e\u9a8c\u6df1\u5165\u5206\u6790</h3>\n<p>\u5178\u578b\u95ee\u9898\u4e0a\u7684\u8be6\u7ec6\u6027\u80fd\u5206\u6790\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e3b\u6210\u5206\u5206\u6790\u7684\u51e0\u4f55\u4f18\u5316</strong>\uff1a\n   - Stiefel\u6d41\u5f62$St(k,n)$\u4e0a\u6700\u5927\u5316\u8ff9\n   - Trust Region vs \u6807\u51c6\u7279\u5f81\u503c\u7b97\u6cd5\n   - \u7ed3\u679c\uff1a\u4e2d\u7b49\u89c4\u6a21\u95ee\u9898\u4e0a\u5feb2-3\u500d</p>\n</li>\n<li>\n<p><strong>\u6700\u8fd1\u6b63\u5b9a\u77e9\u9635\u95ee\u9898</strong>\uff1a\n   - \u5728$S_+^n$\uff08\u6b63\u5b9a\u77e9\u9635\u6d41\u5f62\uff09\u4e0a\u6295\u5f71\n   - \u51e0\u4f55Trust Region\u4fdd\u6301\u6b63\u5b9a\u6027\n   - \u907f\u514d\u4e86\u4f20\u7edf\u65b9\u6cd5\u7684\u7279\u5f81\u503c\u5206\u89e3</p>\n</li>\n<li>\n<p><strong>\u540c\u6b65\u95ee\u9898</strong>\uff08\u76f8\u4f4d\u6062\u590d\uff09\uff1a\n   - \u5728$(S^1)^n$\uff08\u73af\u9762\uff09\u4e0a\u4f18\u5316\n   - Trust Region\u5904\u7406\u975e\u51f8\u6027\n   - \u76f8\u6bd4SDP\u677e\u5f1b\u65b9\u6cd5\u6548\u7387\u63d0\u534710\u500d</p>\n</li>\n</ol>\n<h3 id=\"11312\">11.3.12 \u7406\u8bba\u6df1\u5ea6\uff1a\u6700\u4f18\u6027\u6761\u4ef6\u4e0e\u5bf9\u5076\u7406\u8bba</h3>\n<p>Trust Region\u5728\u6d41\u5f62\u4e0a\u7684KKT\u6761\u4ef6\uff1a</p>\n<ol>\n<li><strong>\u4e00\u9636\u5fc5\u8981\u6761\u4ef6</strong>\uff1a\n   \u5b58\u5728$\\lambda \\geq 0$\u4f7f\u5f97\uff1a</li>\n</ol>\n<ul>\n<li>$(H + \\lambda I)\\xi^* = -g$</li>\n<li>$\\lambda(|\\xi^*| - \\Delta) = 0$</li>\n<li>$H + \\lambda I \\succeq 0$\uff08\u5728\u6d41\u5f62\u5ea6\u91cf\u4e0b\uff09</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u4e8c\u9636\u5145\u5206\u6761\u4ef6</strong>\uff1a\n   - \u68c0\u67e5\u7f29\u51cfHessian\u7684\u6b63\u5b9a\u6027\n   - \u5728\u5207\u7a7a\u95f4\u7684\u5b50\u7a7a\u95f4\u4e2d\u9a8c\u8bc1\n   - \u4e0e\u7ea6\u675f\u4f18\u5316\u7406\u8bba\u7684\u8054\u7cfb</p>\n</li>\n<li>\n<p><strong>\u5bf9\u5076\u95ee\u9898</strong>\uff1a\n$$\\max_{\\lambda \\geq 0} \\min_{|\\xi| \\leq \\Delta} L(\\xi, \\lambda)$$</p>\n</li>\n</ol>\n<ul>\n<li>\u5f3a\u5bf9\u5076\u6027\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\u6210\u7acb</li>\n<li>\u5bf9\u5076\u95f4\u9699\u63d0\u4f9b\u6700\u4f18\u6027\u5ea6\u91cf</li>\n</ul>\n<h3 id=\"11313\">11.3.13 \u8f6f\u4ef6\u5de5\u7a0b\u89c6\u89d2</h3>\n<p>Trust Region\u65b9\u6cd5\u7684\u6a21\u5757\u5316\u5b9e\u73b0\uff1a</p>\n<ol>\n<li><strong>\u63a5\u53e3\u8bbe\u8ba1</strong>\uff1a\n   ```\n   TrustRegionSolver\u63a5\u53e3\uff1a</li>\n</ol>\n<ul>\n<li>solve_subproblem(model, radius)</li>\n<li>compute_rho(actual_decrease, predicted_decrease)  </li>\n<li>update_radius(rho, step_norm, radius)\n   ```</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u6d41\u5f62\u62bd\u8c61</strong>\uff1a\n   ```\n   Manifold\u63a5\u53e3\u9700\u8981\u63d0\u4f9b\uff1a</li>\n</ol>\n<ul>\n<li>retraction(x, v)</li>\n<li>inverse_retraction(x, y)</li>\n<li>vector_transport(x, y, v)</li>\n<li>norm(x, v)\n   ```</li>\n</ul>\n<ol start=\"3\">\n<li>\n<p><strong>\u53ef\u6269\u5c55\u6027\u8003\u8651</strong>\uff1a\n   - \u63d2\u4ef6\u5f0f\u5b50\u95ee\u9898\u6c42\u89e3\u5668\n   - \u81ea\u5b9a\u4e49\u505c\u6b62\u51c6\u5219\n   - \u6027\u80fd\u76d1\u63a7\u94a9\u5b50</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406\u7b56\u7565</strong>\uff1a\n   ```\n   \u5185\u5b58\u6c60\u8bbe\u8ba1\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u9884\u5206\u914d\u5207\u5411\u91cf\u7f13\u51b2\u533a</li>\n<li>\u91cd\u7528\u4e34\u65f6\u77e9\u9635\u5b58\u50a8</li>\n<li>\u61d2\u60f0\u8ba1\u7b97\u4e0e\u7f13\u5b58\u5931\u6548\n   ```</li>\n</ul>\n<ol start=\"5\">\n<li>\n<p><strong>\u6570\u503c\u7cbe\u5ea6\u63a7\u5236</strong>\uff1a\n   - \u4f7f\u7528Kahan\u6c42\u548c\u51cf\u5c11\u820d\u5165\u8bef\u5dee\n   - \u5173\u952e\u8fd0\u7b97\u7684\u9ad8\u7cbe\u5ea6\u5b9e\u73b0\n   - \u6761\u4ef6\u6570\u76d1\u63a7\u4e0e\u8b66\u544a\u7cfb\u7edf</p>\n</li>\n<li>\n<p><strong>\u8c03\u8bd5\u4e0e\u8bca\u65ad\u5de5\u5177</strong>\uff1a\n   ```\n   \u8bca\u65ad\u8f93\u51fa\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u6bcf\u6b65\u7684\u6a21\u578b\u7cbe\u5ea6\u03c1</li>\n<li>Trust Region\u534a\u5f84\u5386\u53f2</li>\n<li>\u5b50\u95ee\u9898\u6c42\u89e3\u8fed\u4ee3\u6570</li>\n<li>\u68af\u5ea6\u8303\u6570\u6f14\u5316\n   ```</li>\n</ul>\n<h3 id=\"11314-trust-region\">11.3.14 \u524d\u6cbf\u5e94\u7528\uff1a\u673a\u5668\u5b66\u4e60\u4e2d\u7684Trust Region</h3>\n<ol>\n<li>\n<p><strong>\u795e\u7ecf\u7f51\u7edc\u8bad\u7ec3</strong>\uff1a\n   - \u4e8c\u9636\u4fe1\u606f\u7684\u9ad8\u6548\u8fd1\u4f3c\n   - \u4e0eK-FAC\u7b49\u65b9\u6cd5\u7ed3\u5408\n   - \u5728\u5173\u952e\u5c42\u4f7f\u7528Trust Region</p>\n</li>\n<li>\n<p><strong>\u5f3a\u5316\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</strong> (TRPO)\uff1a\n   - \u7b56\u7565\u7a7a\u95f4\u7684\u81ea\u7136\u53c2\u6570\u5316\n   - KL\u6563\u5ea6\u4f5c\u4e3aTrust Region\u7ea6\u675f\n   - \u5355\u8c03\u6539\u8fdb\u4fdd\u8bc1</p>\n</li>\n<li>\n<p><strong>\u5143\u5b66\u4e60\u4e0e\u5c11\u6837\u672c\u5b66\u4e60</strong>\uff1a\n   - \u53c2\u6570\u7a7a\u95f4\u7684\u5feb\u901f\u9002\u5e94\n   - Trust Region\u63a7\u5236\u9002\u5e94\u6b65\u5e45\n   - \u907f\u514d\u707e\u96be\u6027\u9057\u5fd8</p>\n</li>\n</ol>\n<h3 id=\"11315\">11.3.15 \u5f00\u653e\u7814\u7a76\u95ee\u9898</h3>\n<p>\u503c\u5f97\u6df1\u5165\u63a2\u7d22\u7684\u65b9\u5411\uff1a</p>\n<ol>\n<li>\n<p><strong>\u975e\u5149\u6ed1\u6d41\u5f62\u4f18\u5316\u7684Trust Region</strong>\uff1a\n   - \u5904\u7406\u4e0d\u53ef\u5fae\u70b9\n   - \u675f\u65b9\u6cd5\u7684\u63a8\u5e7f\n   - \u5e94\u7528\u4e8e\u7a00\u758f\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u4f18\u5316\u4e2d\u7684Trust Region</strong>\uff1a\n   - \u91cf\u5b50\u6001\u7a7a\u95f4\u7684\u51e0\u4f55\u7ed3\u6784\n   - \u91cf\u5b50\u8fd1\u4f3c\u4f18\u5316\u7b97\u6cd5(QAOA)\u6539\u8fdb\n   - \u4e0e\u53d8\u5206\u91cf\u5b50\u7b97\u6cd5\u7ed3\u5408</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0fTrust Region</strong>\uff1a\n   - \u5b50\u95ee\u9898\u7684\u5206\u5e03\u5f0f\u6c42\u89e3\n   - \u5f02\u6b65\u534a\u5f84\u66f4\u65b0\n   - \u62dc\u5360\u5ead\u5bb9\u9519\u8bbe\u8ba1</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6d41\u5f62Trust Region</strong>\uff1a\n   - \u52a8\u6001\u8c03\u6574\u5de5\u4f5c\u6d41\u5f62\n   - \u57fa\u4e8e\u66f2\u7387\u7684\u534a\u5f84\u81ea\u9002\u5e94\n   - \u591a\u5c3a\u5ea6Trust Region\u7b56\u7565</p>\n</li>\n</ol>\n<h2 id=\"114\">11.4 \u4e0e\u6b27\u6c0f\u7a7a\u95f4\u65b9\u6cd5\u7684\u6027\u80fd\u5bf9\u6bd4</h2>\n<h3 id=\"1141\">11.4.1 \u7406\u8bba\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p>\u6bd4\u8f83\u6d41\u5f62\u65b9\u6cd5\u4e0e\u6295\u5f71\u65b9\u6cd5\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\uff1a</p>\n<ol>\n<li><strong>\u6bcf\u6b21\u8fed\u4ee3\u6210\u672c</strong>\uff1a\n   - \u6b27\u6c0f\u6295\u5f71\u65b9\u6cd5\uff1a$\\mathcal{O}(n^2) + $ \u6295\u5f71\u6210\u672c\n   - Riemannian\u65b9\u6cd5\uff1a$\\mathcal{O}(n^2) + $ \u56de\u7f29\u6210\u672c</li>\n</ol>\n<p>\u5173\u952e\u89c2\u5bdf\uff1a\u5bf9\u8bb8\u591a\u6d41\u5f62\uff0c\u56de\u7f29\u548c\u6295\u5f71\u7684\u6210\u672c\u76f8\u5f53\u3002</p>\n<ol start=\"2\">\n<li>\n<p><strong>\u6536\u655b\u901f\u5ea6</strong>\uff1a\n   - \u6b27\u6c0f\u65b9\u6cd5\uff1a\u7ebf\u6027\u5230\u8d85\u7ebf\u6027\uff08\u53d6\u51b3\u4e8e\u66f2\u7387\uff09\n   - Riemannian\u65b9\u6cd5\uff1a\u4fdd\u6301\u539f\u59cb\u6536\u655b\u7387</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u9700\u6c42</strong>\uff1a\n   - L-BFGS vs L-RBFGS\uff1a\u76f8\u540c\u7684$\\mathcal{O}(mn)$\n   - Trust Region\uff1a\u989d\u5916\u7684\u5b50\u95ee\u9898\u6c42\u89e3\u5668\u5185\u5b58</p>\n</li>\n</ol>\n<h3 id=\"1142\">11.4.2 \u6570\u503c\u5b9e\u9a8c\u57fa\u51c6</h3>\n<p>\u5178\u578b\u6d4b\u8bd5\u95ee\u9898\u7684\u6027\u80fd\u5bf9\u6bd4\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4f4e\u79e9\u77e9\u9635\u8865\u5168</strong>\uff08Grassmann\u6d41\u5f62\uff09\uff1a\n   - \u95ee\u9898\u89c4\u6a21\uff1a$1000 \\times 1000$\uff0c\u79e9$r=10$\n   - Riemannian\u65b9\u6cd5\u901a\u5e38\u5feb2-5\u500d\n   - \u5728\u9ad8\u566a\u58f0\u60c5\u51b5\u4e0b\u4f18\u52bf\u66f4\u660e\u663e</p>\n</li>\n<li>\n<p><strong>\u7279\u5f81\u503c\u4f18\u5316</strong>\uff08Stiefel\u6d41\u5f62\uff09\uff1a\n   - \u5bfb\u627e\u4e3b\u7279\u5f81\u7a7a\u95f4\n   - \u51e0\u4f55\u65b9\u6cd5\u907f\u514d\u4e86\u91cd\u590d\u6b63\u4ea4\u5316\n   - \u6570\u503c\u7a33\u5b9a\u6027\u663e\u8457\u63d0\u5347</p>\n</li>\n<li>\n<p><strong>\u5f20\u91cf\u5206\u89e3</strong>\uff08\u4e58\u79ef\u6d41\u5f62\uff09\uff1a\n   - Tucker\u5206\u89e3\u3001CP\u5206\u89e3\n   - \u5229\u7528\u6d41\u5f62\u7ed3\u6784\u51cf\u5c11\u7ea6\u675f\u8fdd\u53cd</p>\n</li>\n</ol>\n<h3 id=\"1143\">11.4.3 \u7b97\u6cd5\u9009\u62e9\u6307\u5357</h3>\n<p>\u4f55\u65f6\u4f7f\u7528\u6d41\u5f62\u9884\u6761\u4ef6\u65b9\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f3a\u70c8\u63a8\u8350\u573a\u666f</strong>\uff1a\n   - \u7ea6\u675f\u66f2\u7387\u5927\n   - \u95ee\u9898\u5177\u6709\u81ea\u7136\u7684\u51e0\u4f55\u7ed3\u6784\n   - \u9700\u8981\u9ad8\u7cbe\u5ea6\u89e3\n   - \u6b27\u6c0f\u65b9\u6cd5\u6536\u655b\u7f13\u6162</p>\n</li>\n<li>\n<p><strong>\u8c28\u614e\u4f7f\u7528\u573a\u666f</strong>\uff1a\n   - \u6d41\u5f62\u8fd0\u7b97\uff08\u5982\u56de\u7f29\uff09\u4ee3\u4ef7\u8fc7\u9ad8\n   - \u95ee\u9898\u89c4\u6a21\u6781\u5927\uff0c\u5185\u5b58\u53d7\u9650\n   - \u53ea\u9700\u8981\u4f4e\u7cbe\u5ea6\u89e3\n   - \u7f3a\u4e4f\u9ad8\u6548\u7684\u6d41\u5f62\u8fd0\u7b97\u5b9e\u73b0</p>\n</li>\n</ol>\n<h3 id=\"1144\">11.4.4 \u5b9e\u73b0\u4f18\u5316\u6280\u5de7</h3>\n<p>\u63d0\u5347\u6d41\u5f62\u65b9\u6cd5\u6027\u80fd\u7684\u5173\u952e\u6280\u5de7\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7f13\u5b58\u51e0\u4f55\u91cf</strong>\uff1a\n   - \u5ea6\u91cf\u5f20\u91cf\u7684Cholesky\u5206\u89e3\n   - \u5e38\u7528\u7684\u6295\u5f71\u7b97\u5b50\n   - Christoffel\u7b26\u53f7\uff08\u5982\u9700\u8981\uff09</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6</strong>\uff1a\n   - \u521d\u671f\u4f7f\u7528\u4f4e\u7cbe\u5ea6\u56de\u7f29\n   - \u63a5\u8fd1\u6536\u655b\u65f6\u63d0\u9ad8\u7cbe\u5ea6\n   - \u52a8\u6001\u8c03\u6574\u5b50\u95ee\u9898\u6c42\u89e3\u7cbe\u5ea6</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u673a\u4f1a</strong>\uff1a\n   - \u5411\u91cf\u4f20\u8f93\u7684\u6279\u5904\u7406\n   - \u591a\u4e2a\u641c\u7d22\u65b9\u5411\u7684\u5e76\u884c\u8bc4\u4f30\n   - Trust Region\u5b50\u95ee\u9898\u7684\u5e76\u884c\u6c42\u89e3</p>\n</li>\n</ol>\n<h3 id=\"1145\">11.4.5 \u9c81\u68d2\u6027\u6bd4\u8f83</h3>\n<p>\u6570\u503c\u7a33\u5b9a\u6027\u548c\u9c81\u68d2\u6027\u5206\u6790\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u654f\u611f\u6027</strong>\uff1a\n   - \u6b27\u6c0f\u65b9\u6cd5\uff1a\u53d7\u73af\u5883\u7a7a\u95f4\u6761\u4ef6\u6570\u5f71\u54cd\n   - \u6d41\u5f62\u65b9\u6cd5\uff1a\u4ec5\u53d7\u5185\u8574\u6761\u4ef6\u6570\u5f71\u54cd</p>\n</li>\n<li>\n<p><strong>\u521d\u59cb\u5316\u654f\u611f\u6027</strong>\uff1a\n   - \u6d41\u5f62\u65b9\u6cd5\u901a\u5e38\u6709\u66f4\u5927\u7684\u6536\u655b\u57df\n   - \u51e0\u4f55\u7ed3\u6784\u63d0\u4f9b\u4e86\u81ea\u7136\u7684\u6b63\u5219\u5316</p>\n</li>\n<li>\n<p><strong>\u53c2\u6570\u8c03\u4f18</strong>\uff1a\n   - \u6d41\u5f62\u65b9\u6cd5\u7684\u8d85\u53c2\u6570\u901a\u5e38\u66f4\u5c11\n   - \u9ed8\u8ba4\u53c2\u6570\u7684\u9c81\u68d2\u6027\u66f4\u597d</p>\n</li>\n</ol>\n<h3 id=\"1146\">11.4.6 \u524d\u6cbf\u7814\u7a76\u65b9\u5411</h3>\n<ol>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6d41\u5f62\u9009\u62e9</strong>\uff1a\n   - \u52a8\u6001\u8c03\u6574\u5de5\u4f5c\u6d41\u5f62\n   - \u591a\u6d41\u5f62\u878d\u5408\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u786c\u4ef6\u52a0\u901f</strong>\uff1a\n   - GPU\u4e0a\u7684\u6d41\u5f62\u8fd0\u7b97\n   - \u4e13\u7528\u786c\u4ef6\u8bbe\u8ba1</p>\n</li>\n<li>\n<p><strong>\u4e0e\u6df1\u5ea6\u5b66\u4e60\u7684\u7ed3\u5408</strong>\uff1a\n   - \u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u6d41\u5f62\u5c42\n   - \u51e0\u4f55\u6df1\u5ea6\u5b66\u4e60\u7684\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u6d41\u5f62\u65b9\u6cd5</strong>\uff1a\n   - \u6d41\u5f62\u4e0a\u7684SGD\u53d8\u4f53\n   - \u65b9\u5dee\u7f29\u51cf\u6280\u672f\u7684\u63a8\u5e7f</p>\n</li>\n</ol>\n<h2 id=\"115\">11.5 \u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u6d41\u5f62\u4f18\u5316\u4e2d\u7684\u9884\u6761\u4ef6\u6280\u672f\uff0c\u6db5\u76d6\u4e86\u4e09\u4e2a\u6838\u5fc3\u65b9\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>Natural Gradient\u65b9\u6cd5</strong>\uff1a\n   - \u5229\u7528\u4fe1\u606f\u51e0\u4f55\u7ed3\u6784\u52a0\u901f\u6536\u655b\n   - Fisher\u4fe1\u606f\u77e9\u9635\u4f5c\u4e3a\u81ea\u7136\u5ea6\u91cf\n   - \u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684K-FAC\u3001Shampoo\u7b49\u5b9e\u7528\u53d8\u4f53</p>\n</li>\n<li>\n<p><strong>Riemannian BFGS\u65b9\u6cd5</strong>\uff1a\n   - \u5c06\u7ecf\u5178\u62dfNewton\u65b9\u6cd5\u63a8\u5e7f\u5230\u6d41\u5f62\n   - \u901a\u8fc7\u5411\u91cf\u4f20\u8f93\u7ef4\u62a4Hessian\u8fd1\u4f3c\n   - \u6709\u9650\u5185\u5b58\u7248\u672c\u9002\u5408\u5927\u89c4\u6a21\u95ee\u9898</p>\n</li>\n<li>\n<p><strong>\u51e0\u4f55\u611f\u77e5Trust Region</strong>\uff1a\n   - \u5728\u66f2\u7ebf\u7a7a\u95f4\u4e2d\u81ea\u7136\u5904\u7406\u975e\u7ebf\u6027\n   - \u5b50\u95ee\u9898\u6c42\u89e3\u4e0e\u56de\u7f29\u6620\u5c04\u7684\u7ed3\u5408\n   - \u5f3a\u5927\u7684\u5168\u5c40\u6536\u655b\u4fdd\u8bc1</p>\n</li>\n</ol>\n<p>\u5173\u952e\u6d1e\u5bdf\uff1a</p>\n<ul>\n<li>\u9884\u6761\u4ef6\u6280\u672f\u7684\u6838\u5fc3\u662f\u5229\u7528\u95ee\u9898\u7684\u51e0\u4f55\u7ed3\u6784</li>\n<li>\u6070\u5f53\u7684\u5ea6\u91cf\u9009\u62e9\u53ef\u4ee5\u663e\u8457\u6539\u5584\u6761\u4ef6\u6570</li>\n<li>\u6d41\u5f62\u65b9\u6cd5\u901a\u5e38\u6bd4\u6295\u5f71\u65b9\u6cd5\u66f4\u9ad8\u6548\u3001\u66f4\u7a33\u5b9a</li>\n</ul>\n<h2 id=\"116\">11.6 \u7ec3\u4e60\u9898</h2>\n<h3 id=\"_1\">\u57fa\u7840\u9898</h3>\n<p><strong>\u7ec3\u4e6011.1</strong> \u8bc1\u660eNatural Gradient\u65b9\u5411\u662f\u5207\u7a7a\u95f4\u4e2d\u7684\u6700\u9661\u4e0b\u964d\u65b9\u5411\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u5728Riemannian\u5ea6\u91cf\u4e0b\u7684\u4f18\u5316\u95ee\u9898 $\\min_{|\\xi|_g=1} \\langle \\text{grad} f(x), \\xi \\rangle$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe$g$\u662fRiemannian\u5ea6\u91cf\uff0c\u76ee\u6807\u662f\u6c42\u89e3\uff1a\n$$\\min_{\\xi} \\langle \\text{grad} f(x), \\xi \\rangle \\quad \\text{s.t. } g(\\xi,\\xi) = 1$$\n\u4f7f\u7528Lagrange\u4e58\u6570\u6cd5\uff0c\u8bbe$L(\\xi,\\lambda) = \\langle \\text{grad} f(x), \\xi \\rangle + \\lambda(g(\\xi,\\xi) - 1)$\u3002</p>\n<p>\u4e00\u9636\u6761\u4ef6\u7ed9\u51fa\uff1a\n$$\\text{grad} f(x) + 2\\lambda G\\xi = 0$$</p>\n<p>\u56e0\u6b64 $\\xi = -\\frac{1}{2\\lambda}G^{-1}\\text{grad} f(x)$\uff0c\u8fd9\u6b63\u662fNatural Gradient\u65b9\u5411\uff08\u5ffd\u7565\u5f52\u4e00\u5316\u5e38\u6570\uff09\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6011.2</strong> \u63a8\u5bfcStiefel\u6d41\u5f62\u4e0a\u7684RBFGS\u66f4\u65b0\u516c\u5f0f\uff0c\u7279\u522b\u6ce8\u610f\u5411\u91cf\u4f20\u8f93\u7684\u4f5c\u7528\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4ece\u62dfNewton\u6761\u4ef6 $\\mathcal{H}_{k+1}s_k = y_k$ \u51fa\u53d1\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Stiefel\u6d41\u5f62$\\text{St}(p,n)$\u4e0a\u7684RBFGS\u66f4\u65b0\u9700\u8981\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97 $s_k = \\mathcal{T}_{X_k}^{X_{k+1}} \\eta_k$\uff0c\u5176\u4e2d$\\eta_k$\u662f\u641c\u7d22\u65b9\u5411</li>\n<li>\u8ba1\u7b97 $y_k = \\text{grad} f(X_{k+1}) - \\mathcal{T}_{X_k}^{X_{k+1}} \\text{grad} f(X_k)$</li>\n<li>\u786e\u4fdd\u6240\u6709\u8fd0\u7b97\u5728\u5207\u7a7a\u95f4$T_{X_{k+1}}\\text{St}(p,n)$\u4e2d\u8fdb\u884c</li>\n<li>\u66f4\u65b0\u516c\u5f0f\u4fdd\u6301\u6807\u51c6BFGS\u5f62\u5f0f\uff0c\u4f46\u6240\u6709\u5185\u79ef\u4f7f\u7528\u6d41\u5f62\u5ea6\u91cf</li>\n</ol>\n<p>\u5173\u952e\u662f\u5411\u91cf\u4f20\u8f93\u4fdd\u8bc1\u4e86$s_k$\u548c$y_k$\u5728\u540c\u4e00\u5207\u7a7a\u95f4\u4e2d\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6011.3</strong> \u8bf4\u660e\u4e3a\u4ec0\u4e48Trust Region\u65b9\u6cd5\u5728\u5904\u7406\u8d1f\u66f2\u7387\u65f6\u6bd4\u7ebf\u641c\u7d22\u65b9\u6cd5\u66f4\u6709\u4f18\u52bf\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651Hessian\u6709\u8d1f\u7279\u5f81\u503c\u65f6\u4e24\u79cd\u65b9\u6cd5\u7684\u884c\u4e3a\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Trust Region\u65b9\u6cd5\u7684\u4f18\u52bf\uff1a</p>\n<ol>\n<li>\u5b50\u95ee\u9898\u6c42\u89e3\u81ea\u7136\u53d1\u73b0\u8d1f\u66f2\u7387\u65b9\u5411</li>\n<li>\u5f53\u9047\u5230\u8d1f\u66f2\u7387\u65f6\uff0c\u6cbf\u8be5\u65b9\u5411\u79fb\u52a8\u5230Trust Region\u8fb9\u754c</li>\n<li>\u4e0d\u9700\u8981\u989d\u5916\u7684\u8d1f\u66f2\u7387\u68c0\u6d4b\u673a\u5236</li>\n</ol>\n<p>\u7ebf\u641c\u7d22\u65b9\u6cd5\u7684\u5c40\u9650\uff1a</p>\n<ol>\n<li>\u6807\u51c6\u7ebf\u641c\u7d22\u6cbf\u56fa\u5b9a\u65b9\u5411\uff0c\u53ef\u80fd\u9519\u8fc7\u8d1f\u66f2\u7387</li>\n<li>\u9700\u8981\u989d\u5916\u4fee\u6539\uff08\u5982\u8d1f\u66f2\u7387\u65b9\u5411\u641c\u7d22\uff09</li>\n<li>\u5728\u978d\u70b9\u9644\u8fd1\u53ef\u80fd\u505c\u6ede</li>\n</ol>\n<p>Trust Region\u901a\u8fc7\u7ea6\u675f\u6b65\u957f\u81ea\u7136\u5730\u5e73\u8861\u4e86\u4e0b\u964d\u548c\u66f2\u7387\u5229\u7528\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6011.4</strong> \u8ba1\u7b97\u7403\u9762$S^{n-1}$\u4e0a\u7684Natural Gradient\uff0c\u5176\u4e2d\u5ea6\u91cf\u662f\u6807\u51c6\u7403\u9762\u5ea6\u91cf\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u7403\u9762\u7684\u5207\u7a7a\u95f4\u662f $T_xS^{n-1} = {v \\in \\mathbb{R}^n : x^Tv = 0}$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e$x \\in S^{n-1}$\uff0c\u7403\u9762\u5ea6\u91cf\u5728\u5207\u7a7a\u95f4\u4e0a\u5c31\u662f\u6b27\u6c0f\u5185\u79ef\u9650\u5236\u3002\u56e0\u6b64\uff1a</p>\n<ol>\n<li>\u6b27\u6c0f\u68af\u5ea6\uff1a$\\nabla f(x)$</li>\n<li>Riemannian\u68af\u5ea6\uff1a$\\text{grad} f(x) = \\nabla f(x) - (x^T\\nabla f(x))x$</li>\n<li>\u7531\u4e8e\u5ea6\u91cf\u662f\u6052\u7b49\u7684\uff0cNatural Gradient\u5c31\u662fRiemannian\u68af\u5ea6</li>\n<li>\u66f4\u65b0\uff1a$x_{k+1} = \\frac{x_k - \\alpha \\text{grad} f(x_k)}{|x_k - \\alpha \\text{grad} f(x_k)|}$\uff08\u5f52\u4e00\u5316\u56de\u7403\u9762\uff09</li>\n</ol>\n</details>\n<h3 id=\"_2\">\u6311\u6218\u9898</h3>\n<p><strong>\u7ec3\u4e6011.5</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u9009\u62e9\u5ea6\u91cf\u7684Natural Gradient\u7b97\u6cd5\uff0c\u4f7f\u5176\u80fd\u591f\u5728\u4f18\u5316\u8fc7\u7a0b\u4e2d\u52a8\u6001\u8c03\u6574\u5ea6\u91cf\u4ee5\u6539\u5584\u6761\u4ef6\u6570\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4f7f\u7528\u5386\u53f2\u68af\u5ea6\u4fe1\u606f\u6216\u5c40\u90e8\u66f2\u7387\u4fe1\u606f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u5ea6\u91cfNatural Gradient\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5ea6\u91cf\u66f4\u65b0\u7b56\u7565</strong>\uff1a\n   - \u6536\u96c6\u6700\u8fd1$m$\u6b65\u7684\u68af\u5ea6\uff1a${\\text{grad} f(x_{k-i})}_{i=0}^{m-1}$\n   - \u4f30\u8ba1\u5c40\u90e8\u534f\u65b9\u5dee\uff1a$C_k = \\frac{1}{m}\\sum_{i=0}^{m-1} g_i g_i^T$\n   - \u66f4\u65b0\u5ea6\u91cf\uff1a$G_{k+1} = \\beta G_k + (1-\\beta)(C_k + \\epsilon I)$</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u76d1\u63a7</strong>\uff1a\n   - \u8ba1\u7b97$\\kappa(G_k) = \\lambda_{\\max}(G_k)/\\lambda_{\\min}(G_k)$\n   - \u82e5$\\kappa &gt; \\kappa_{\\max}$\uff0c\u589e\u52a0\u6b63\u5219\u5316$\\epsilon$</p>\n</li>\n<li>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\n   - \u5ea6\u91cf\u4fdd\u6301\u6b63\u5b9a\u6027\n   - \u6536\u655b\u6027\u901a\u8fc7Lipschitz\u8fde\u7eed\u6027\u8bba\u8bc1\n   - \u81ea\u9002\u5e94\u6027\u901a\u8fc7regret\u5206\u6790\u91cf\u5316</p>\n</li>\n<li>\n<p><strong>\u5b9e\u73b0\u8003\u8651</strong>\uff1a\n   - \u4f7f\u7528\u6ed1\u52a8\u7a97\u53e3\u51cf\u5c11\u5185\u5b58\n   - \u589e\u91cf\u66f4\u65b0\u7279\u5f81\u503c\u5206\u89e3\n   - \u5728\u7ebf\u4f30\u8ba1\u4e3b\u8981\u66f2\u7387\u65b9\u5411</p>\n</li>\n</ol>\n</details>\n<p><strong>\u7ec3\u4e6011.6</strong> \u5206\u6790\u5728Grassmann\u6d41\u5f62\u4e0a\uff0cRBFGS\u4e0eRiemannian\u5171\u8f6d\u68af\u5ea6\u7684\u6027\u80fd\u5dee\u5f02\uff0c\u7279\u522b\u5173\u6ce8\u8fed\u4ee3\u6b21\u6570\u4e0e\u6bcf\u6b21\u8fed\u4ee3\u6210\u672c\u7684\u6743\u8861\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4e0d\u540c\u95ee\u9898\u89c4\u6a21\u548c\u6761\u4ef6\u6570\u4e0b\u7684\u8868\u73b0\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6027\u80fd\u5206\u6790\u8981\u70b9\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8fed\u4ee3\u6b21\u6570\u6bd4\u8f83</strong>\uff1a\n   - RBFGS\uff1a\u901a\u5e38\u9700\u8981\u66f4\u5c11\u8fed\u4ee3\uff08\u5229\u7528\u4e8c\u9636\u4fe1\u606f\uff09\n   - RCG\uff1a\u7ebf\u6027\u6536\u655b\uff0c\u8fed\u4ee3\u6570\u4f9d\u8d56\u4e8e\u6761\u4ef6\u6570\n   - \u7ecf\u9a8c\u89c4\u5f8b\uff1aRBFGS\u8fed\u4ee3\u6570\u7ea6\u4e3aRCG\u76841/3\u52301/2</p>\n</li>\n<li>\n<p><strong>\u6bcf\u6b21\u8fed\u4ee3\u6210\u672c</strong>\uff1a\n   - RBFGS\uff1a$O(np + m^2)$\uff0c\u5176\u4e2d$m$\u662f\u5b58\u50a8\u7684\u5411\u91cf\u5bf9\u6570\n   - RCG\uff1a$O(np)$\uff0c\u4e3b\u8981\u662f\u77e9\u9635\u5411\u91cf\u4e58\u6cd5\n   - Grassmann\u4e0a\u7684\u7279\u6b8a\u7ed3\u6784\u53ef\u4ee5\u8fdb\u4e00\u6b65\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u9700\u6c42</strong>\uff1a\n   - L-RBFGS\uff1a$O(mn)$\n   - RCG\uff1a$O(n)$\n   - \u5f53\u5185\u5b58\u53d7\u9650\u65f6RCG\u6709\u4f18\u52bf</p>\n</li>\n<li>\n<p><strong>\u5b9e\u9645\u5efa\u8bae</strong>\uff1a\n   - \u4e2d\u7b49\u89c4\u6a21\u9ad8\u7cbe\u5ea6\uff1a\u9009\u62e9RBFGS\n   - \u8d85\u5927\u89c4\u6a21\u4f4e\u7cbe\u5ea6\uff1a\u9009\u62e9RCG\n   - \u75c5\u6001\u95ee\u9898\uff1aRBFGS\u914d\u5408\u9884\u6761\u4ef6</p>\n</li>\n</ol>\n</details>\n<p><strong>\u7ec3\u4e6011.7</strong> \u63a8\u5bfc\u6d41\u5f62Trust Region\u65b9\u6cd5\u7684\u6700\u574f\u60c5\u51b5\u8fed\u4ee3\u590d\u6742\u5ea6\uff0c\u5e76\u4e0e\u6b27\u6c0f\u7a7a\u95f4\u7684\u7ed3\u679c\u6bd4\u8f83\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u7acb\u65b9\u6b63\u5219\u5316\u6a21\u578b\u7684\u5206\u6790\u6280\u672f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6700\u574f\u60c5\u51b5\u590d\u6742\u5ea6\u5206\u6790\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e00\u9636\u9a7b\u70b9</strong>\uff1a\n   - \u6d41\u5f62TR\uff1a$O(\\epsilon^{-2})$\u6b21\u8fed\u4ee3\u8fbe\u5230$|\\text{grad} f(x)| \\leq \\epsilon$\n   - \u4e0e\u6b27\u6c0f\u7a7a\u95f4\u76f8\u540c\u7684\u590d\u6742\u5ea6</p>\n</li>\n<li>\n<p><strong>\u4e8c\u9636\u9a7b\u70b9</strong>\uff1a\n   - \u9700\u8981$O(\\epsilon^{-3})$\u6b21\u8fed\u4ee3\u8fbe\u5230\u8fd1\u4f3c\u4e8c\u9636\u9a7b\u70b9\n   - \u7acb\u65b9\u6b63\u5219\u5316\u53ef\u6539\u8fdb\u5230$O(\\epsilon^{-3/2})$</p>\n</li>\n<li>\n<p><strong>\u5173\u952e\u5047\u8bbe</strong>\uff1a\n   - Lipschitz\u8fde\u7eed\u68af\u5ea6\uff08\u5e38\u6570$L_g$\uff09\n   - Lipschitz\u8fde\u7eedHessian\uff08\u5e38\u6570$L_H$\uff09\n   - \u8fd9\u4e9b\u5e38\u6570\u5728\u6d41\u5f62\u4e0a\u53ef\u80fd\u4e0e\u6b27\u6c0f\u7a7a\u95f4\u4e0d\u540c</p>\n</li>\n<li>\n<p><strong>\u6d41\u5f62\u7279\u6709\u56e0\u7d20</strong>\uff1a\n   - \u66f2\u7387\u5f71\u54cd\u6709\u6548Lipschitz\u5e38\u6570\n   - \u9700\u8981\u8003\u8651\u56de\u7f29\u6620\u5c04\u7684\u8fd1\u4f3c\u8bef\u5dee\n   - \u5728\u9ad8\u66f2\u7387\u533a\u57df\u53ef\u80fd\u9700\u8981\u66f4\u591a\u8fed\u4ee3</p>\n</li>\n</ol>\n<p>\u603b\u7ed3\uff1a\u7406\u8bba\u590d\u6742\u5ea6\u76f8\u540c\uff0c\u4f46\u5e38\u6570\u56e0\u5b50\u53ef\u80fd\u4e0d\u540c\u3002</p>\n</details>\n<h2 id=\"117\">11.7 \u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<h3 id=\"1171-natural-gradient\">11.7.1 Natural Gradient\u5b9e\u73b0\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>Fisher\u77e9\u9635\u7684\u9519\u8bef\u4f30\u8ba1</strong>\uff1a\n   - \u9519\u8bef\uff1a\u4f7f\u7528\u5355\u4e2a\u6837\u672c\u4f30\u8ba1Fisher\u77e9\u9635\n   - \u6b63\u786e\uff1a\u4f7f\u7528\u6279\u91cf\u6837\u672c\u6216\u79fb\u52a8\u5e73\u5747\n   - \u5f71\u54cd\uff1a\u5355\u6837\u672c\u4f30\u8ba1\u65b9\u5dee\u8fc7\u5927\uff0c\u5bfc\u81f4\u4e0d\u7a33\u5b9a</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898</strong>\uff1a\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u6c42\u9006$G^{-1}$\n   - \u6b63\u786e\uff1a\u6dfb\u52a0\u6b63\u5219\u5316$G + \\lambda I$\u6216\u4f7f\u7528Cholesky\u5206\u89e3\n   - \u5f71\u54cd\uff1a\u77e9\u9635\u63a5\u8fd1\u5947\u5f02\u65f6\u6570\u503c\u9519\u8bef</p>\n</li>\n<li>\n<p><strong>\u5ea6\u91cf\u66f4\u65b0\u9891\u7387</strong>\uff1a\n   - \u9519\u8bef\uff1a\u6bcf\u6b65\u90fd\u91cd\u65b0\u8ba1\u7b97\u5b8c\u6574Fisher\u77e9\u9635\n   - \u6b63\u786e\uff1a\u5468\u671f\u6027\u66f4\u65b0\u6216\u4f7f\u7528\u589e\u91cf\u66f4\u65b0\n   - \u5f71\u54cd\uff1a\u8ba1\u7b97\u5f00\u9500\u8fc7\u5927</p>\n</li>\n</ol>\n<h3 id=\"1172-rbfgs\">11.7.2 RBFGS\u5e38\u89c1\u9519\u8bef</h3>\n<ol>\n<li>\n<p><strong>\u5411\u91cf\u4f20\u8f93\u7684\u5ffd\u89c6</strong>\uff1a\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u4f7f\u7528\u6b27\u6c0f\u7a7a\u95f4\u7684BFGS\u516c\u5f0f\n   - \u6b63\u786e\uff1a\u6240\u6709\u5411\u91cf\u5fc5\u987b\u4f20\u8f93\u5230\u540c\u4e00\u5207\u7a7a\u95f4\n   - \u5f71\u54cd\uff1a\u7834\u574f\u7b97\u6cd5\u6536\u655b\u6027</p>\n</li>\n<li>\n<p><strong>\u66f2\u7387\u6761\u4ef6\u8fdd\u53cd</strong>\uff1a\n   - \u9519\u8bef\uff1a\u4e0d\u68c0\u67e5$y_k^Ts_k &gt; 0$\n   - \u6b63\u786e\uff1a\u4f7f\u7528damping\u6216\u8df3\u8fc7\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u66f4\u65b0\n   - \u5f71\u54cd\uff1aHessian\u8fd1\u4f3c\u5931\u53bb\u6b63\u5b9a\u6027</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406\u9519\u8bef</strong>\uff1a\n   - \u9519\u8bef\uff1a\u5b58\u50a8\u8fc7\u591a\u5386\u53f2\u5411\u91cf\u5bf9\n   - \u6b63\u786e\uff1a\u9650\u5236\u5b58\u50a8\u6570\u91cf\uff0c\u4f7f\u7528\u5faa\u73af\u7f13\u51b2\n   - \u5f71\u54cd\uff1a\u5185\u5b58\u6ea2\u51fa\u6216cache miss\u589e\u52a0</p>\n</li>\n</ol>\n<h3 id=\"1173-trust-region\">11.7.3 Trust Region\u5b9e\u73b0\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>\u5b50\u95ee\u9898\u6c42\u89e3\u7cbe\u5ea6</strong>\uff1a\n   - \u9519\u8bef\uff1a\u8fc7\u5ea6\u6c42\u89e3\u5b50\u95ee\u9898\n   - \u6b63\u786e\uff1a\u4f7f\u7528\u76f8\u5bf9\u7cbe\u5ea6\u51c6\u5219\uff0c\u8fdc\u79bb\u6700\u4f18\u65f6\u53ef\u4ee5\u7c97\u7cd9\n   - \u5f71\u54cd\uff1a\u6d6a\u8d39\u8ba1\u7b97\u8d44\u6e90</p>\n</li>\n<li>\n<p><strong>\u534a\u5f84\u66f4\u65b0\u7b56\u7565</strong>\uff1a\n   - \u9519\u8bef\uff1a\u534a\u5f84\u8c03\u6574\u8fc7\u4e8e\u6fc0\u8fdb\n   - \u6b63\u786e\uff1a\u4f7f\u7528\u4fdd\u5b88\u7684\u66f4\u65b0\u56e0\u5b50\uff08\u59820.25\u548c2.0\uff09\n   - \u5f71\u54cd\uff1a\u7b97\u6cd5\u9707\u8361\u6216\u8fdb\u5c55\u7f13\u6162</p>\n</li>\n<li>\n<p><strong>\u56de\u7f29\u6620\u5c04\u9009\u62e9</strong>\uff1a\n   - \u9519\u8bef\uff1a\u603b\u662f\u4f7f\u7528\u6307\u6570\u6620\u5c04\n   - \u6b63\u786e\uff1a\u6839\u636e\u6d41\u5f62\u7279\u6027\u9009\u62e9\u9ad8\u6548\u56de\u7f29\n   - \u5f71\u54cd\uff1a\u4e0d\u5fc5\u8981\u7684\u8ba1\u7b97\u5f00\u9500</p>\n</li>\n</ol>\n<h3 id=\"1174\">11.7.4 \u6d41\u5f62\u7279\u5b9a\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>Stiefel\u6d41\u5f62\u4e0a\u7684\u6b63\u4ea4\u6027\u4e22\u5931</strong>\uff1a\n   - \u9519\u8bef\uff1a\u6570\u503c\u8bef\u5dee\u7d2f\u79ef\u5bfc\u81f4\u6b63\u4ea4\u6027\u635f\u5931\n   - \u6b63\u786e\uff1a\u5468\u671f\u6027\u91cd\u6b63\u4ea4\u5316\u6216\u4f7f\u7528\u7a33\u5b9a\u7684\u53c2\u6570\u5316\n   - \u5f71\u54cd\uff1a\u7ea6\u675f\u8fdd\u53cd\uff0c\u7ed3\u679c\u65e0\u6548</p>\n</li>\n<li>\n<p><strong>Grassmann\u6d41\u5f62\u7684\u5546\u7a7a\u95f4\u5904\u7406</strong>\uff1a\n   - \u9519\u8bef\uff1a\u5ffd\u7565\u7b49\u4ef7\u7c7b\u7ed3\u6784\n   - \u6b63\u786e\uff1a\u9009\u62e9\u6807\u51c6\u4ee3\u8868\u5143\uff0c\u4fdd\u6301\u4e00\u81f4\u6027\n   - \u5f71\u54cd\uff1a\u7b97\u6cd5\u884c\u4e3a\u4e0d\u786e\u5b9a</p>\n</li>\n<li>\n<p><strong>\u6b63\u5b9a\u77e9\u9635\u6d41\u5f62\u7684\u6570\u503c\u95ee\u9898</strong>\uff1a\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u53c2\u6570\u5316\u53ef\u80fd\u4ea7\u751f\u975e\u6b63\u5b9a\u77e9\u9635\n   - \u6b63\u786e\uff1a\u4f7f\u7528Cholesky\u56e0\u5b50\u6216\u5176\u4ed6\u4fdd\u8bc1\u6b63\u5b9a\u6027\u7684\u53c2\u6570\u5316\n   - \u5f71\u54cd\uff1a\u4f18\u5316\u8fc7\u7a0b\u4e2d\u8fdd\u53cd\u6d41\u5f62\u7ea6\u675f</p>\n</li>\n</ol>\n<h3 id=\"1175\">11.7.5 \u6027\u80fd\u8c03\u4f18\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>\u8fc7\u65e9\u4f18\u5316</strong>\uff1a\n   - \u9519\u8bef\uff1a\u4e00\u5f00\u59cb\u5c31\u8ffd\u6c42\u6700\u4f18\u5b9e\u73b0\n   - \u6b63\u786e\uff1a\u5148\u4fdd\u8bc1\u6b63\u786e\u6027\uff0c\u518d\u4f18\u5316\u6027\u80fd\n   - \u5f71\u54cd\uff1a\u5f15\u5165\u96be\u4ee5\u8c03\u8bd5\u7684\u9519\u8bef</p>\n</li>\n<li>\n<p><strong>\u5ffd\u89c6\u7f13\u5b58\u5c40\u90e8\u6027</strong>\uff1a\n   - \u9519\u8bef\uff1a\u968f\u673a\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\n   - \u6b63\u786e\uff1a\u8bbe\u8ba1cache-friendly\u7684\u6570\u636e\u5e03\u5c40\n   - \u5f71\u54cd\uff1a\u6027\u80fd\u4e0b\u964d10\u500d\u4ee5\u4e0a</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u9519\u8bef</strong>\uff1a\n   - \u9519\u8bef\uff1a\u7ec6\u7c92\u5ea6\u5e76\u884c\u5316\u5bfc\u81f4\u540c\u6b65\u5f00\u9500\n   - \u6b63\u786e\uff1a\u8bc6\u522b\u5408\u9002\u7684\u5e76\u884c\u7c92\u5ea6\n   - \u5f71\u54cd\uff1a\u5e76\u884c\u6548\u7387\u4f4e\u4e0b</p>\n</li>\n</ol>\n<h2 id=\"118\">11.8 \u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"1181\">11.8.1 \u7b97\u6cd5\u9009\u62e9\u68c0\u67e5\u6e05\u5355</h3>\n<p>\u25a1 <strong>\u95ee\u9898\u89c4\u6a21\u8bc4\u4f30</strong></p>\n<ul>\n<li>\u6d41\u5f62\u7ef4\u6570\u662f\u5426\u9002\u4e2d\uff08&lt;10000\uff09\uff1f</li>\n<li>\u662f\u5426\u9700\u8981\u9ad8\u7cbe\u5ea6\u89e3\uff1f</li>\n<li>\u5185\u5b58\u9650\u5236\u662f\u5426\u4e25\u683c\uff1f</li>\n</ul>\n<p>\u25a1 <strong>\u51e0\u4f55\u7ed3\u6784\u5206\u6790</strong></p>\n<ul>\n<li>\u6d41\u5f62\u66f2\u7387\u662f\u5426\u5df2\u77e5\uff1f</li>\n<li>\u662f\u5426\u6709\u9ad8\u6548\u7684\u56de\u7f29\u6620\u5c04\uff1f</li>\n<li>\u5207\u7a7a\u95f4\u8fd0\u7b97\u6210\u672c\u5982\u4f55\uff1f</li>\n</ul>\n<p>\u25a1 <strong>\u6536\u655b\u9700\u6c42\u786e\u8ba4</strong></p>\n<ul>\n<li>\u662f\u5426\u9700\u8981\u5168\u5c40\u6536\u655b\u4fdd\u8bc1\uff1f</li>\n<li>\u5c40\u90e8\u6536\u655b\u901f\u5ea6\u8981\u6c42\uff1f</li>\n<li>\u5bf9\u521d\u59cb\u70b9\u654f\u611f\u6027\uff1f</li>\n</ul>\n<h3 id=\"1182\">11.8.2 \u5b9e\u73b0\u8d28\u91cf\u68c0\u67e5\u6e05\u5355</h3>\n<p>\u25a1 <strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u8bc1</strong></p>\n<ul>\n<li>\u6240\u6709\u77e9\u9635\u8fd0\u7b97\u662f\u5426\u6709\u6761\u4ef6\u6570\u68c0\u67e5\uff1f</li>\n<li>\u662f\u5426\u5904\u7406\u4e86\u63a5\u8fd1\u96f6\u7684\u9664\u6cd5\uff1f</li>\n<li>\u8fed\u4ee3\u66f4\u65b0\u662f\u5426\u4fdd\u6301\u6d41\u5f62\u7ea6\u675f\uff1f</li>\n</ul>\n<p>\u25a1 <strong>\u6027\u80fd\u4f18\u5316\u9a8c\u8bc1</strong></p>\n<ul>\n<li>\u662f\u5426profile\u786e\u8ba4\u4e86\u6027\u80fd\u74f6\u9888\uff1f</li>\n<li>\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u662f\u5426\u4f18\u5316\uff1f</li>\n<li>\u5e76\u884c\u5316\u662f\u5426\u5e26\u6765\u5b9e\u9645\u52a0\u901f\uff1f</li>\n</ul>\n<p>\u25a1 <strong>\u8c03\u8bd5\u5de5\u5177\u5b8c\u5907</strong></p>\n<ul>\n<li>\u662f\u5426\u6709\u6536\u655b\u8bca\u65ad\u8f93\u51fa\uff1f</li>\n<li>\u80fd\u5426\u53ef\u89c6\u5316\u4f18\u5316\u8f68\u8ff9\uff1f</li>\n<li>\u662f\u5426\u4fdd\u5b58\u4e86\u4e2d\u95f4\u7ed3\u679c\u7528\u4e8e\u5206\u6790\uff1f</li>\n</ul>\n<h3 id=\"1183\">11.8.3 \u53c2\u6570\u8c03\u4f18\u68c0\u67e5\u6e05\u5355</h3>\n<p>\u25a1 <strong>Natural Gradient\u53c2\u6570</strong></p>\n<ul>\n<li>Fisher\u77e9\u9635\u6b63\u5219\u5316\u53c2\u6570$\\lambda$\u9009\u62e9\u5408\u7406\uff1f</li>\n<li>\u6279\u91cf\u5927\u5c0f\u662f\u5426\u8db3\u591f\u4f30\u8ba1Fisher\u77e9\u9635\uff1f</li>\n<li>\u5ea6\u91cf\u66f4\u65b0\u9891\u7387\u662f\u5426\u5408\u9002\uff1f</li>\n</ul>\n<p>\u25a1 <strong>RBFGS\u53c2\u6570</strong></p>\n<ul>\n<li>\u5b58\u50a8\u7684\u5411\u91cf\u5bf9\u6570\u91cf$m$\u662f\u5426\u5408\u9002\uff1f</li>\n<li>\u7ebf\u641c\u7d22\u53c2\u6570\uff08Wolfe\u6761\u4ef6\uff09\u662f\u5426\u8c03\u6574\uff1f</li>\n<li>\u521d\u59cbHessian\u8fd1\u4f3c\u662f\u5426\u5408\u7406\uff1f</li>\n</ul>\n<p>\u25a1 <strong>Trust Region\u53c2\u6570</strong></p>\n<ul>\n<li>\u521d\u59cb\u534a\u5f84$\\Delta_0$\u662f\u5426\u4e0e\u95ee\u9898\u89c4\u6a21\u5339\u914d\uff1f</li>\n<li>\u534a\u5f84\u66f4\u65b0\u9608\u503c\u662f\u5426\u9700\u8981\u8c03\u6574\uff1f</li>\n<li>\u5b50\u95ee\u9898\u6c42\u89e3\u7cbe\u5ea6\u662f\u5426\u81ea\u9002\u5e94\uff1f</li>\n</ul>\n<h3 id=\"1184\">11.8.4 \u9a8c\u8bc1\u4e0e\u6d4b\u8bd5\u68c0\u67e5\u6e05\u5355</h3>\n<p>\u25a1 <strong>\u7b97\u6cd5\u6b63\u786e\u6027\u9a8c\u8bc1</strong></p>\n<ul>\n<li>\u662f\u5426\u5728\u5df2\u77e5\u89e3\u7684\u95ee\u9898\u4e0a\u6d4b\u8bd5\uff1f</li>\n<li>\u68af\u5ea6/Hessian\u662f\u5426\u901a\u8fc7\u6709\u9650\u5dee\u5206\u9a8c\u8bc1\uff1f</li>\n<li>\u662f\u5426\u6d4b\u8bd5\u4e86\u8fb9\u754c\u60c5\u51b5\uff1f</li>\n</ul>\n<p>\u25a1 <strong>\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5</strong></p>\n<ul>\n<li>\u662f\u5426\u4e0e\u6807\u51c6\u65b9\u6cd5\u6bd4\u8f83\uff1f</li>\n<li>\u662f\u5426\u6d4b\u8bd5\u4e86\u4e0d\u540c\u95ee\u9898\u89c4\u6a21\uff1f</li>\n<li>\u662f\u5426\u8bc4\u4f30\u4e86\u9c81\u68d2\u6027\uff1f</li>\n</ul>\n<p>\u25a1 <strong>\u53ef\u91cd\u73b0\u6027\u4fdd\u8bc1</strong></p>\n<ul>\n<li>\u968f\u673a\u79cd\u5b50\u662f\u5426\u56fa\u5b9a\uff1f</li>\n<li>\u6d6e\u70b9\u8fd0\u7b97\u987a\u5e8f\u662f\u5426\u786e\u5b9a\uff1f</li>\n<li>\u7ed3\u679c\u662f\u5426\u8de8\u5e73\u53f0\u4e00\u81f4\uff1f</li>\n</ul>\n<p><strong>\u7ec3\u4e6011.8</strong> \u8bbe\u8ba1\u4e00\u4e2a\u7ed3\u5408Natural Gradient\u548cTrust Region\u601d\u60f3\u7684\u6df7\u5408\u7b97\u6cd5\uff0c\u5e76\u5206\u6790\u5176\u7406\u8bba\u6027\u8d28\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u5728Trust Region\u6846\u67b6\u4e2d\u4f7f\u7528Natural Gradient\u5ea6\u91cf\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Natural Gradient Trust Region (NGTR)\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a\n   <code>\u5b50\u95ee\u9898\uff1amin_{||\u03be||_G \u2264 \u0394} &lt;grad f(x), \u03be&gt; + (1/2)&lt;\u03be, H[\u03be]&gt;\n   \u5176\u4e2d||\u03be||_G^2 = &lt;\u03be, G\u03be&gt;\uff0cG\u662fFisher\u4fe1\u606f\u77e9\u9635</code></p>\n</li>\n<li>\n<p><strong>\u5173\u952e\u7279\u6027</strong>\uff1a\n   - \u7ed3\u5408\u4e86NG\u7684\u51e0\u4f55\u9002\u5e94\u6027\u548cTR\u7684\u7a33\u5065\u6027\n   - Trust Region\u5728\u81ea\u7136\u5ea6\u91cf\u4e0b\u5b9a\u4e49\n   - \u5b50\u95ee\u9898\u5728\u4fe1\u606f\u51e0\u4f55\u610f\u4e49\u4e0b\u6c42\u89e3</p>\n</li>\n<li>\n<p><strong>\u7406\u8bba\u6027\u8d28</strong>\uff1a\n   - \u5168\u5c40\u6536\u655b\u5230\u4e00\u9636\u9a7b\u70b9\n   - \u5c40\u90e8\u4e8c\u6b21\u6536\u655b\uff08\u4f7f\u7528\u7cbe\u786eHessian\u65f6\uff09\n   - \u5bf9\u75c5\u6001Fisher\u77e9\u9635\u7684\u9c81\u68d2\u6027</p>\n</li>\n<li>\n<p><strong>\u5b9e\u73b0\u8981\u70b9</strong>\uff1a\n   - \u5b50\u95ee\u9898\u53ef\u901a\u8fc7\u53d8\u91cf\u66ff\u6362$\\tilde{\\xi} = G^{1/2}\\xi$\u7b80\u5316\n   - \u4f7f\u7528Lanczos\u65b9\u6cd5\u5904\u7406\u5927\u89c4\u6a21\u60c5\u5f62\n   - \u81ea\u9002\u5e94\u8c03\u6574Fisher\u77e9\u9635\u6b63\u5219\u5316</p>\n</li>\n<li>\n<p><strong>\u5e94\u7528\u524d\u666f</strong>\uff1a\n   - \u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u4e8c\u9636\u4f18\u5316\n   - \u53d8\u5206\u63a8\u65ad\u4e2d\u7684\u81ea\u7136\u53c2\u6570\u66f4\u65b0\n   - \u5f3a\u5316\u5b66\u4e60\u7684\u7b56\u7565\u4f18\u5316</p>\n</li>\n</ol>\n</details>"
  },
  "../chapter5.md": {
    "hash": "19b1848f5b6cae45e754a91adc4b2c7c",
    "content": "<h1 id=\"5schur\">\u7b2c5\u7ae0\uff1aSchur\u8865\u7684\u5999\u7528</h1>\n<p>Schur\u8865\u662f\u77e9\u9635\u5206\u6790\u4e2d\u7684\u4e00\u9897\u660e\u73e0\uff0c\u5b83\u4e0d\u4ec5\u63d0\u4f9b\u4e86\u5206\u5757\u77e9\u9635\u6c42\u9006\u7684\u4f18\u96c5\u65b9\u6cd5\uff0c\u66f4\u5728\u73b0\u4ee3\u5927\u89c4\u6a21\u8ba1\u7b97\u4e2d\u626e\u6f14\u7740\u5173\u952e\u89d2\u8272\u3002\u4ece\u5206\u5e03\u5f0f\u4f18\u5316\u5230\u57df\u5206\u89e3\u65b9\u6cd5\uff0c\u4ece\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\u5230\u5e76\u884c\u7b97\u6cd5\uff0cSchur\u8865\u7684\u601d\u60f3\u65e0\u5904\u4e0d\u5728\u3002\u672c\u7ae0\u5c06\u6df1\u5165\u63a2\u8ba8Schur\u8865\u7684\u6570\u5b66\u672c\u8d28\u3001\u8ba1\u7b97\u6280\u5de7\u4ee5\u53ca\u5728\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u521b\u65b0\u5e94\u7528\u3002\u6211\u4eec\u5c06\u7279\u522b\u5173\u6ce8\u90a3\u4e9b\u5728AI\u548c\u79d1\u5b66\u8ba1\u7b97\u4e2d\u5c1a\u672a\u5145\u5206\u5f00\u53d1\u7684\u6f5c\u529b\u3002</p>\n<h2 id=\"51\">5.1 \u5206\u5757\u77e9\u9635\u6c42\u9006\u7684\u9012\u5f52\u7b56\u7565</h2>\n<h3 id=\"511-schur\">5.1.1 Schur\u8865\u7684\u5b9a\u4e49\u4e0e\u57fa\u672c\u6027\u8d28</h3>\n<p>\u8003\u8651\u5206\u5757\u77e9\u9635\uff1a\n$$\\mathbf{M} = \\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{C} &amp; \\mathbf{D} \\end{pmatrix}$$\n\u5f53$\\mathbf{A}$\u53ef\u9006\u65f6\uff0c\u5173\u4e8e$\\mathbf{A}$\u7684Schur\u8865\u5b9a\u4e49\u4e3a\uff1a\n$$\\mathbf{S}_A = \\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$$\n\u8fd9\u4e2a\u770b\u4f3c\u7b80\u5355\u7684\u5b9a\u4e49\u8574\u542b\u7740\u6df1\u523b\u7684\u6570\u5b66\u7ed3\u6784\u3002\u4e8b\u5b9e\u4e0a\uff0cSchur\u8865\u53ef\u4ee5\u4ece\u591a\u4e2a\u89d2\u5ea6\u7406\u89e3\uff1a</p>\n<ul>\n<li><strong>\u4ee3\u6570\u89c6\u89d2</strong>\uff1a\u6d88\u5143\u8fc7\u7a0b\u7684\u77e9\u9635\u8868\u793a</li>\n<li><strong>\u51e0\u4f55\u89c6\u89d2</strong>\uff1a\u5b50\u7a7a\u95f4\u6295\u5f71\u7684\u5ea6\u91cf</li>\n<li><strong>\u6982\u7387\u89c6\u89d2</strong>\uff1a\u6761\u4ef6\u534f\u65b9\u5dee\u77e9\u9635</li>\n<li><strong>\u4f18\u5316\u89c6\u89d2</strong>\uff1a\u7ea6\u675f\u6d88\u9664\u540e\u7684Hessian</li>\n</ul>\n<p><strong>\u5386\u53f2\u6ce8\u8bb0</strong>\uff1aSchur\u8865\u5f97\u540d\u4e8eIssai Schur\uff081917\u5e74\uff09\uff0c\u4f46\u5176\u601d\u60f3\u53ef\u8ffd\u6eaf\u5230\u66f4\u65e9\u7684\u9ad8\u65af\u6d88\u5143\u6cd5\u3002\u5728\u73b0\u4ee3\u5e94\u7528\u4e2d\uff0c\u4ece\u5927\u89c4\u6a21\u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3\u5230\u673a\u5668\u5b66\u4e60\u6a21\u578b\u8bad\u7ec3\uff0cSchur\u8865\u65e0\u5904\u4e0d\u5728\uff1a</p>\n<ol>\n<li><strong>\u884c\u5217\u5f0f\u5206\u89e3</strong>\uff1a$\\det(\\mathbf{M}) = \\det(\\mathbf{A})\\det(\\mathbf{S}_A)$</li>\n<li>\n<p><strong>\u9006\u77e9\u9635\u7684\u5206\u5757\u8868\u793a</strong>\uff1a\n$$\\mathbf{M}^{-1} = \\begin{pmatrix} \\mathbf{A}^{-1} + \\mathbf{A}^{-1}\\mathbf{B}\\mathbf{S}_A^{-1}\\mathbf{C}\\mathbf{A}^{-1} &amp; -\\mathbf{A}^{-1}\\mathbf{B}\\mathbf{S}_A^{-1} \\ -\\mathbf{S}_A^{-1}\\mathbf{C}\\mathbf{A}^{-1} &amp; \\mathbf{S}_A^{-1} \\end{pmatrix}$$</p>\n</li>\n<li>\n<p><strong>LDU\u5206\u89e3\u7684\u8054\u7cfb</strong>\uff1a\n$$\\mathbf{M} = \\begin{pmatrix} \\mathbf{I} &amp; \\mathbf{0} \\ \\mathbf{C}\\mathbf{A}^{-1} &amp; \\mathbf{I} \\end{pmatrix} \\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{0} \\ \\mathbf{0} &amp; \\mathbf{S}_A \\end{pmatrix} \\begin{pmatrix} \\mathbf{I} &amp; \\mathbf{A}^{-1}\\mathbf{B} \\ \\mathbf{0} &amp; \\mathbf{I} \\end{pmatrix}$$</p>\n</li>\n<li>\n<p><strong>\u8c31\u6027\u8d28</strong>\uff1aSchur\u8865\u4fdd\u6301\u4e86\u539f\u77e9\u9635\u7684\u91cd\u8981\u8c31\u4fe1\u606f\n   - \u5982\u679c$\\mathbf{M}$\u662f\u5bf9\u79f0\u6b63\u5b9a\u7684\uff0c\u5219$\\mathbf{S}_A$\u4e5f\u662f\u5bf9\u79f0\u6b63\u5b9a\u7684\n   - Schur\u8865\u7684\u7279\u5f81\u503c\u4e0e\u539f\u77e9\u9635\u7279\u5f81\u503c\u6ee1\u8db3\u4ea4\u9519\u5b9a\u7406</p>\n</li>\n<li>\n<p><strong>\u53d8\u5206\u7279\u5f81</strong>\uff1a\n$$\\mathbf{v}^T\\mathbf{S}_A\\mathbf{v} = \\min_{\\mathbf{u}} \\begin{pmatrix} \\mathbf{u} \\ \\mathbf{v} \\end{pmatrix}^T \\mathbf{M} \\begin{pmatrix} \\mathbf{u} \\ \\mathbf{v} \\end{pmatrix}$$\n\u8fd9\u4e2a\u6027\u8d28\u5728\u4f18\u5316\u7406\u8bba\u4e2d\u6709\u6df1\u8fdc\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u6982\u7387\u89e3\u91ca</strong>\uff1a\n   \u5728\u9ad8\u65af\u5206\u5e03$\\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$\u4e2d\uff0c\u82e5$\\mathbf{\\Sigma}^{-1} = \\mathbf{M}$\uff0c\u5219$\\mathbf{S}_A^{-1}$\u8868\u793a\u5728\u7ed9\u5b9a\u7b2c\u4e00\u7ec4\u53d8\u91cf\u6761\u4ef6\u4e0b\uff0c\u7b2c\u4e8c\u7ec4\u53d8\u91cf\u7684\u6761\u4ef6\u534f\u65b9\u5dee</p>\n</li>\n<li>\n<p><strong>\u80fd\u91cf\u6700\u5c0f\u5316</strong>\uff1a\n   Schur\u8865\u8868\u793a\u6d88\u9664\u67d0\u4e9b\u81ea\u7531\u5ea6\u540e\u7684\u6709\u6548\u80fd\u91cf\u51fd\u6570\uff0c\u8fd9\u5728\u7269\u7406\u7cfb\u7edf\u7684\u7ea6\u5316\u5efa\u6a21\u4e2d\u81f3\u5173\u91cd\u8981</p>\n</li>\n</ol>\n<p><strong>\u6df1\u5165\u7406\u89e3\uff1aSchur\u8865\u7684\u51e0\u4f55\u610f\u4e49</strong></p>\n<p>\u4ece\u7ebf\u6027\u53d8\u6362\u7684\u89d2\u5ea6\uff0c\u8003\u8651\u6620\u5c04\uff1a\n$$\\begin{pmatrix} \\mathbf{x} \\ \\mathbf{y} \\end{pmatrix} \\mapsto \\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{C} &amp; \\mathbf{D} \\end{pmatrix} \\begin{pmatrix} \\mathbf{x} \\ \\mathbf{y} \\end{pmatrix}$$\nSchur\u8865$\\mathbf{S}_A$\u63cf\u8ff0\u4e86\u5728$\\mathbf{x}$-\u5b50\u7a7a\u95f4\u88ab\"\u56fa\u5b9a\"\u540e\uff0c$\\mathbf{y}$-\u5b50\u7a7a\u95f4\u4e2d\u7684\u6709\u6548\u53d8\u6362\u3002\u8fd9\u79cd\u51e0\u4f55\u76f4\u89c9\u5728\uff1a</p>\n<ul>\n<li>\u7ea6\u675f\u4f18\u5316\u95ee\u9898\u7684\u964d\u7ef4</li>\n<li>\u504f\u5fae\u5206\u65b9\u7a0b\u7684\u8fb9\u754c\u6d88\u9664</li>\n<li>\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u6d88\u606f\u4f20\u9012\n\u7b49\u9886\u57df\u63d0\u4f9b\u4e86\u6df1\u523b\u6d1e\u5bdf</li>\n</ul>\n<h3 id=\"512\">5.1.2 \u9012\u5f52\u5206\u5757\u6c42\u9006\u7b97\u6cd5</h3>\n<p>\u9012\u5f52\u5229\u7528Schur\u8865\u53ef\u4ee5\u5c06\u5927\u89c4\u6a21\u77e9\u9635\u6c42\u9006\u8f6c\u5316\u4e3a\u4e00\u7cfb\u5217\u5c0f\u89c4\u6a21\u95ee\u9898\uff1a</p>\n<p><strong>\u7b97\u6cd5\uff1a\u9012\u5f52Schur\u5206\u89e3</strong></p>\n<ol>\n<li>\u5c06\u77e9\u9635$\\mathbf{M}$\u5206\u6210$2 \\times 2$\u5757</li>\n<li>\u9012\u5f52\u6c42\u89e3$\\mathbf{A}^{-1}$</li>\n<li>\u8ba1\u7b97Schur\u8865$\\mathbf{S}_A$</li>\n<li>\u9012\u5f52\u6c42\u89e3$\\mathbf{S}_A^{-1}$</li>\n<li>\u7ec4\u5408\u5f97\u5230$\\mathbf{M}^{-1}$</li>\n</ol>\n<p>\u8fd9\u79cd\u9012\u5f52\u7b56\u7565\u7684\u4f18\u52bf\u5728\u4e8e\uff1a</p>\n<ul>\n<li>\u53ef\u4ee5\u81ea\u7136\u5730\u9002\u5e94\u77e9\u9635\u7684\u5c42\u6b21\u7ed3\u6784</li>\n<li>\u4fbf\u4e8e\u5e76\u884c\u5316\u5b9e\u73b0</li>\n<li>\u80fd\u591f\u5229\u7528\u5757\u7684\u7a00\u758f\u6027</li>\n<li>\u5185\u5b58\u8bbf\u95ee\u5c40\u90e8\u6027\u66f4\u597d</li>\n</ul>\n<p><strong>\u4f2a\u4ee3\u7801\u5b9e\u73b0\uff08\u6982\u5ff5\uff09</strong></p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">RecursiveSchurInverse</span><span class=\"p\">(</span>M, level<span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nb\">size</span><span class=\"p\">(</span><span class=\"n\">M</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">threshold</span><span class=\"w\"> </span><span class=\"n\">then</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">DirectInverse</span><span class=\"p\">(</span><span class=\"n\">M</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">end</span><span class=\"w\"> </span><span class=\"k\">if</span>\n\n<span class=\"w\">    </span><span class=\"p\">[</span><span class=\"n\">A</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">D</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">BlockPartition</span><span class=\"p\">(</span><span class=\"n\">M</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">A_inv</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">RecursiveSchurInverse</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">level</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u5173\u952e\u6b65\u9aa4\uff1a\u9ad8\u6548\u8ba1\u7b97<span class=\"n\">Schur\u8865</span>\n<span class=\"w\">    </span><span class=\"n\">CA_inv</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">SolveLinearSystem</span><span class=\"p\">(</span><span class=\"n\">A</span>^<span class=\"n\">T</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">C</span>^<span class=\"n\">T</span><span class=\"p\">)</span>^<span class=\"n\">T</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u907f\u514d\u663e\u5f0f\u6c42\u9006\n<span class=\"w\">    </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">CA_inv</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">B</span>\n<span class=\"w\">    </span><span class=\"n\">S_inv</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">RecursiveSchurInverse</span><span class=\"p\">(</span><span class=\"n\">S</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">level</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6784\u9020\u9006\u77e9\u9635\u7684\u5404\u4e2a\u5757\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">AssembleInverse</span><span class=\"p\">(</span><span class=\"n\">A_inv</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">S_inv</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">CA_inv</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"p\">)</span>\n<span class=\"k\">end</span><span class=\"w\"> </span><span class=\"k\">function</span>\n</code></pre></div>\n\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong></p>\n<p>\u9012\u5f52Schur\u5206\u89e3\u7684\u5e76\u884c\u6027\u6765\u6e90\u4e8e\uff1a</p>\n<ol>\n<li><strong>\u4efb\u52a1\u5e76\u884c</strong>\uff1a$\\mathbf{A}^{-1}$\u548c\u5176\u4ed6\u8ba1\u7b97\u53ef\u4ee5\u5e76\u884c\u6267\u884c</li>\n<li><strong>\u6570\u636e\u5e76\u884c</strong>\uff1a\u77e9\u9635\u4e58\u6cd5$\\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$\u53ef\u4ee5\u5206\u5757\u5e76\u884c</li>\n<li><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong>\uff1a\u4e0d\u540c\u5c42\u7ea7\u7684\u8ba1\u7b97\u53ef\u4ee5\u91cd\u53e0</li>\n</ol>\n<p><strong>\u6df1\u5165\u5206\u6790\uff1a\u6700\u4f18\u5206\u5757\u7b56\u7565</strong></p>\n<p>\u5206\u5757\u5927\u5c0f\u7684\u9009\u62e9\u5bf9\u7b97\u6cd5\u6027\u80fd\u6709\u91cd\u8981\u5f71\u54cd\u3002\u8bbe\u77e9\u9635\u89c4\u6a21\u4e3a$n$\uff0c\u5206\u5757\u5927\u5c0f\u4e3a$k$\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a\n   - \u8ba1\u7b97$\\mathbf{A}^{-1}\\mathbf{B}$\uff1a$O(k^2(n-k))$\n   - \u8ba1\u7b97Schur\u8865\uff1a$O(k(n-k)^2)$\n   - \u603b\u590d\u6742\u5ea6\uff1a$O(k^2(n-k) + k(n-k)^2)$\n   - \u6700\u4f18\u5206\u5757\uff1a$k \\approx n/2$\u65f6\u590d\u6742\u5ea6\u5e73\u8861</p>\n</li>\n<li>\n<p><strong>\u7f13\u5b58\u6548\u7387\u8003\u8651</strong>\uff1a\n   - \u5757\u5927\u5c0f\u5e94\u9002\u914d\u7f13\u5b58\u5c42\u6b21\n   - \u5178\u578b\u9009\u62e9\uff1a$k = \\sqrt{\\text{cache size}/8}$\uff08\u53cc\u7cbe\u5ea6\uff09\n   - \u591a\u7ea7\u7f13\u5b58\u9700\u8981\u591a\u7ea7\u5206\u5757</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u7c92\u5ea6\u6743\u8861</strong>\uff1a\n   - \u8fc7\u5c0f\u7684\u5757\u5bfc\u81f4\u901a\u4fe1\u5f00\u9500\u589e\u5927\n   - \u8fc7\u5927\u7684\u5757\u9650\u5236\u5e76\u884c\u5ea6\n   - \u52a8\u6001\u8c03\u6574\u7b56\u7565\uff1a\u6839\u636e\u53ef\u7528\u5904\u7406\u5668\u6570\u91cf\u81ea\u9002\u5e94</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u6280\u5de7\uff1a\u9009\u62e9\u6027\u6c42\u9006</strong></p>\n<p>\u5728\u8bb8\u591a\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9006\u77e9\u9635\u7684\u7279\u5b9a\u5143\u7d20\u6216\u5757\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5bf9\u89d2\u5143\u7d20</strong>\uff1a\u8ba1\u7b97$[(\\mathbf{M}^{-1})]_{ii}$\n   - \u5229\u7528Schur\u8865\u516c\u5f0f\u7684\u9012\u5f52\u7ed3\u6784\n   - \u590d\u6742\u5ea6\uff1a$O(n^2)$\u800c\u975e$O(n^3)$</p>\n</li>\n<li>\n<p><strong>\u5b50\u5757\u6c42\u9006</strong>\uff1a\u53ea\u8ba1\u7b97$\\mathbf{M}^{-1}$\u7684\u67d0\u4e2a\u5b50\u5757\n   - \u5e94\u7528\uff1a\u534f\u65b9\u5dee\u77e9\u9635\u7684\u8fb9\u9645\u5316\n   - \u5728\u8d1d\u53f6\u65af\u63a8\u65ad\u4e2d\u7684\u6761\u4ef6\u5206\u5e03\u8ba1\u7b97</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u6a21\u5f0f\u4fdd\u6301</strong>\uff1a\n   - \u5229\u7528\u7b26\u53f7Schur\u8865\u5206\u6790\n   - \u9884\u6d4b\u975e\u96f6\u5143\u7d20\u4f4d\u7f6e\n   - \u907f\u514d\u4e0d\u5fc5\u8981\u7684\u8ba1\u7b97\u548c\u5b58\u50a8</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u6848\u4f8b\uff1a\u5927\u89c4\u6a21\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635</strong></p>\n<p>\u8003\u8651\u56fe$G=(V,E)$\u7684\u62c9\u666e\u62c9\u65af\u77e9\u9635$\\mathbf{L}$\u3002\u5728\u591a\u5c42\u56fe\u5206\u5272\u4e2d\uff1a</p>\n<ol>\n<li>\n<p><strong>\u56fe\u5206\u5272\u7b56\u7565</strong>\uff1a\n   - \u4f7f\u7528\u8c31\u5206\u5272\u6216METIS\u7b97\u6cd5\n   - \u6700\u5c0f\u5316\u8fb9\u754c\u8282\u70b9\u6570\u91cf\n   - \u4fdd\u6301\u5b50\u56fe\u5e73\u8861</p>\n</li>\n<li>\n<p><strong>\u5206\u5757\u7ed3\u6784</strong>\uff1a\n$$\\mathbf{L} = \\begin{pmatrix} \\mathbf{L}_{11} &amp; \\mathbf{0} &amp; \\mathbf{B}_1 \\ \\mathbf{0} &amp; \\mathbf{L}_{22} &amp; \\mathbf{B}_2 \\ \\mathbf{B}_1^T &amp; \\mathbf{B}_2^T &amp; \\mathbf{L}_{SS} \\end{pmatrix}$$\n\u5176\u4e2d$\\mathbf{L}_{11}, \\mathbf{L}_{22}$\u5bf9\u5e94\u5185\u90e8\u8282\u70b9\uff0c$\\mathbf{L}_{SS}$\u5bf9\u5e94\u5206\u9694\u8282\u70b9</p>\n</li>\n<li>\n<p><strong>Schur\u8865\u8ba1\u7b97</strong>\uff1a\n$$\\mathbf{S} = \\mathbf{L}_{SS} - \\mathbf{B}_1^T\\mathbf{L}_{11}^{-1}\\mathbf{B}_1 - \\mathbf{B}_2^T\\mathbf{L}_{22}^{-1}\\mathbf{B}_2$$</p>\n</li>\n<li>\n<p><strong>\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a\n   - \u5bf9\u4e8e\u5e73\u9762\u56fe\uff1a$O(n^{3/2})$\n   - \u5bf9\u4e8e3D\u7f51\u683c\uff1a$O(n^2)$\n   - \u901a\u7528\u7a00\u758f\u56fe\uff1a$O(n^{\\omega})$\uff0c\u5176\u4e2d$\\omega &lt; 3$</p>\n</li>\n</ol>\n<h3 id=\"513\">5.1.3 \u6570\u503c\u7a33\u5b9a\u6027\u5206\u6790</h3>\n<p>Schur\u8865\u8ba1\u7b97\u7684\u6570\u503c\u7a33\u5b9a\u6027\u4f9d\u8d56\u4e8e\u51e0\u4e2a\u5173\u952e\u56e0\u7d20\uff1a</p>\n<ol>\n<li><strong>\u6761\u4ef6\u6570\u4f20\u64ad</strong>\uff1a\n$$\\kappa(\\mathbf{S}_A) \\leq \\kappa(\\mathbf{D})(1 + |\\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}\\mathbf{D}^{-1}|)$$\n\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u63ed\u793a\u4e86\u4e00\u4e2a\u91cd\u8981\u4e8b\u5b9e\uff1aSchur\u8865\u7684\u6761\u4ef6\u6570\u53ef\u80fd\u6bd4\u539f\u77e9\u9635\u66f4\u5dee\u3002\u7279\u522b\u5730\uff1a</li>\n</ol>\n<ul>\n<li>\u5f53$\\mathbf{A}$\u63a5\u8fd1\u5947\u5f02\u65f6\uff0c$|\\mathbf{A}^{-1}|$\u5f88\u5927</li>\n<li>\u5f53$\\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$\u63a5\u8fd1$\\mathbf{D}$\u65f6\uff0cSchur\u8865\u63a5\u8fd1\u5947\u5f02</li>\n<li>\u8026\u5408\u7cfb\u6570$|\\mathbf{C}||\\mathbf{B}|$\u5927\u65f6\uff0c\u6761\u4ef6\u6570\u6076\u5316\u4e25\u91cd</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u67a2\u8f74\u9009\u62e9\u7b56\u7565</strong>\uff1a\u9009\u62e9\u6761\u4ef6\u6570\u8f83\u5c0f\u7684\u5757\u4f5c\u4e3a\u67a2\u8f74\u53ef\u4ee5\u663e\u8457\u6539\u5584\u6570\u503c\u7a33\u5b9a\u6027</li>\n</ol>\n<p><strong>\u5e38\u7528\u67a2\u8f74\u9009\u62e9\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li><strong>\u5bf9\u89d2\u5360\u4f18\u6cd5</strong>\uff1a\u9009\u62e9\u5bf9\u89d2\u5143\u7d20\u8f83\u5927\u7684\u5757</li>\n<li><strong>\u6700\u5c0f\u5ea6\u6cd5</strong>\uff1a\u5728\u7a00\u758f\u77e9\u9635\u4e2d\u9009\u62e9fill-in\u6700\u5c11\u7684\u5757</li>\n<li><strong>\u8c31\u5206\u6790\u6cd5</strong>\uff1a\u57fa\u4e8e\u8fd1\u4f3c\u7279\u5f81\u503c\u5206\u5e03</li>\n<li><strong>\u9884\u6d4b\u6a21\u578b</strong>\uff1a\u4f7f\u7528\u673a\u5668\u5b66\u4e60\u9884\u6d4b\u6700\u4f73\u5206\u5757</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u6b8b\u5dee\u6821\u6b63</strong>\uff1a\u4f7f\u7528\u8fed\u4ee3\u7cbe\u5316\u6280\u672f\u53ef\u4ee5\u8865\u507f\u820d\u5165\u8bef\u5dee\u7684\u7d2f\u79ef</li>\n</ol>\n<p><strong>\u8fed\u4ee3\u7cbe\u5316\u7b97\u6cd5</strong>\uff1a\n   <code>\u8ba1\u7b97\u521d\u59cb\u89e3: x_0 = M^{-1}b\n   for k = 0, 1, 2, ... do\n       r_k = b - M*x_k        // \u6b8b\u5dee\n       d_k = M^{-1}*r_k       // \u6821\u6b63\u91cf\n       x_{k+1} = x_k + d_k    // \u66f4\u65b0\u89e3\n       if ||r_k|| &lt; tol then break\n   end for</code></p>\n<p><strong>\u6df1\u5165\u8ba8\u8bba\uff1a\u8bef\u5dee\u7d2f\u79ef\u673a\u5236</strong></p>\n<p>\u5728\u6709\u9650\u7cbe\u5ea6\u7b97\u672f\u4e0b\uff0cSchur\u8865\u8ba1\u7b97\u7684\u8bef\u5dee\u4e3b\u8981\u6765\u6e90\u4e8e\uff1a</p>\n<ol>\n<li>\n<p><strong>\u524d\u5411\u8bef\u5dee\u5206\u6790</strong>\uff1a\n   \u8bbe$\\hat{\\mathbf{S}}_A$\u4e3a\u8ba1\u7b97\u5f97\u5230\u7684Schur\u8865\uff0c\u5219\uff1a\n$$|\\hat{\\mathbf{S}}_A - \\mathbf{S}_A| \\leq \\epsilon_{\\text{machine}} \\cdot p(n) \\cdot |\\mathbf{S}_A|$$\n\u5176\u4e2d$p(n)$\u662f\u5173\u4e8e\u95ee\u9898\u89c4\u6a21\u7684\u591a\u9879\u5f0f</p>\n</li>\n<li>\n<p><strong>\u5411\u540e\u8bef\u5dee\u89c2\u70b9</strong>\uff1a\n   \u8ba1\u7b97\u5f97\u5230\u7684Schur\u8865\u7b49\u4ef7\u4e8e\u7cbe\u786e\u8ba1\u7b97\u6270\u52a8\u540e\u77e9\u9635\u7684Schur\u8865\uff1a\n$$\\hat{\\mathbf{S}}_A = (\\mathbf{D} + \\Delta\\mathbf{D}) - (\\mathbf{C} + \\Delta\\mathbf{C})(\\mathbf{A} + \\Delta\\mathbf{A})^{-1}(\\mathbf{B} + \\Delta\\mathbf{B})$$\n\u5176\u4e2d$|\\Delta\\mathbf{X}| \\leq \\epsilon_{\\text{machine}} \\cdot |\\mathbf{X}|$</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565</strong>\uff1a\n   - \u5173\u952e\u8ba1\u7b97\uff08\u5982\u5c0f\u89c4\u6a21Schur\u8865\uff09\u4f7f\u7528\u9ad8\u7cbe\u5ea6\n   - \u5927\u89c4\u6a21\u77e9\u9635\u4e58\u6cd5\u4f7f\u7528\u4f4e\u7cbe\u5ea6\n   - \u57fa\u4e8e\u8bef\u5dee\u4f30\u8ba1\u7684\u81ea\u9002\u5e94\u7cbe\u5ea6\u9009\u62e9</p>\n</li>\n</ol>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u5b9e\u73b0\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>FP64\u7528\u4e8eSchur\u8865\u8ba1\u7b97\u548c\u6c42\u9006</li>\n<li>FP32/FP16\u7528\u4e8e\u77e9\u9635\u4e58\u6cd5</li>\n<li>BFloat16\u7528\u4e8e\u673a\u5668\u5b66\u4e60\u5e94\u7528</li>\n<li>\u52a8\u6001\u7cbe\u5ea6\u9009\u62e9\u57fa\u4e8e\u6761\u4ef6\u6570\u4f30\u8ba1</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u6280\u672f\uff1a\u533a\u95f4\u7b97\u672f\u4e0e\u9a8c\u8bc1\u8ba1\u7b97</strong></p>\n<p>\u4e3a\u4e86\u4e25\u683c\u4fdd\u8bc1\u6570\u503c\u7ed3\u679c\u7684\u53ef\u9760\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a</p>\n<ol>\n<li>\n<p><strong>\u533a\u95f4\u7b97\u672f</strong>\uff1a\n   - \u8ba1\u7b97\u7ed3\u679c\u7684\u4e0a\u4e0b\u754c\n   - \u81ea\u52a8\u8ddf\u8e2a\u8bef\u5dee\u4f20\u64ad\n   - \u9002\u7528\u4e8e\u5173\u952e\u5e94\u7528\uff08\u5982\u5b89\u5168\u8ba1\u7b97\uff09</p>\n</li>\n<li>\n<p><strong>\u9a8c\u8bc1\u8ba1\u7b97</strong>\uff1a\n   - \u4f7f\u7528\u4e0d\u540c\u7b97\u6cd5\u8ba1\u7b97\u540c\u4e00\u7ed3\u679c\n   - \u6bd4\u8f83\u7ed3\u679c\u4e00\u81f4\u6027\n   - \u68c0\u6d4b\u6570\u503c\u4e0d\u7a33\u5b9a\u6027</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u7528\u6280\u672f\uff1a\u589e\u91cf\u5f0fSchur\u8865\u66f4\u65b0</strong></p>\n<p>\u5f53\u77e9\u9635\u53d1\u751f\u5c40\u90e8\u4fee\u6539\u65f6\uff0c\u53ef\u4ee5\u9ad8\u6548\u66f4\u65b0Schur\u8865\uff1a</p>\n<ol>\n<li>\n<p><strong>\u79e91\u66f4\u65b0</strong>\uff1a$\\mathbf{M} \\rightarrow \\mathbf{M} + \\mathbf{u}\\mathbf{v}^T$\n   - Sherman-Morrison-Woodbury\u516c\u5f0f\u7684\u5e94\u7528\n   - $O(n^2)$\u590d\u6742\u5ea6\u800c\u975e\u91cd\u65b0\u8ba1\u7b97\u7684$O(n^3)$</p>\n</li>\n<li>\n<p><strong>\u5757\u66f4\u65b0</strong>\uff1a\u5b50\u5757$\\mathbf{A}$\u53d8\u4e3a$\\mathbf{A} + \\Delta\\mathbf{A}$\n   - \u5229\u7528\u77e9\u9635\u6444\u52a8\u7406\u8bba\n   - \u4fdd\u6301\u6570\u503c\u7a33\u5b9a\u6027\u7684\u5173\u952e\uff1a$|\\Delta\\mathbf{A}| &lt; 1/|\\mathbf{A}^{-1}|$</p>\n</li>\n<li>\n<p><strong>\u6d41\u5f0f\u8ba1\u7b97</strong>\uff1a\n   - \u6570\u636e\u5206\u6279\u5230\u8fbe\u65f6\u7684\u5728\u7ebf\u66f4\u65b0\n   - \u4e0eKalman\u6ee4\u6ce2\u7684\u6570\u5b66\u8054\u7cfb\n   - \u5728\u5b9e\u65f6\u7cfb\u7edf\u4e2d\u7684\u5e94\u7528</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u6848\u4f8b\uff1a\u6709\u9650\u5143\u5206\u6790\u4e2d\u7684\u6570\u503c\u7a33\u5b9a\u6027</strong></p>\n<p>\u5728\u7ed3\u6784\u529b\u5b66\u7684\u6709\u9650\u5143\u5206\u6790\u4e2d\uff0c\u521a\u5ea6\u77e9\u9635\u5f80\u5f80\u5177\u6709\uff1a</p>\n<ul>\n<li>\u9ad8\u5ea6\u75c5\u6001\uff08\u6761\u4ef6\u6570$10^6$-$10^{12}$\uff09</li>\n<li>\u5206\u5757\u7ed3\u6784\uff08\u6309\u7269\u7406\u5b50\u7ed3\u6784\uff09</li>\n<li>\u7a00\u758f\u6027\uff08\u975e\u96f6\u5143&lt; 1%\uff09</li>\n</ul>\n<p>\u6570\u503c\u7a33\u5b9a\u6027\u7b56\u7565\uff1a</p>\n<ol>\n<li><strong>\u7269\u7406\u57fa\u5206\u5757</strong>\uff1a\u6309\u7ed3\u6784\u90e8\u4ef6\u5206\u5757</li>\n<li><strong>\u5c40\u90e8\u9884\u6761\u4ef6</strong>\uff1a\u5bf9\u6bcf\u4e2a\u5b50\u5757\u4f7f\u7528\u4e13\u95e8\u9884\u6761\u4ef6\u5b50</li>\n<li><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6</strong>\uff1a\u6839\u636e\u5c40\u90e8\u6761\u4ef6\u6570\u8c03\u6574\u8ba1\u7b97\u7cbe\u5ea6</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u5982\u4f55\u81ea\u9002\u5e94\u5730\u9009\u62e9\u5206\u5757\u7b56\u7565\u4ee5\u6700\u5c0f\u5316\u6761\u4ef6\u6570\u589e\u957f\u4ecd\u662f\u4e00\u4e2a\u5f00\u653e\u95ee\u9898</li>\n<li>\u91cf\u5b50\u542f\u53d1\u7684\u7b97\u6cd5\u80fd\u5426\u6539\u5584Schur\u8865\u7684\u6761\u4ef6\u6570\u654f\u611f\u6027</li>\n<li>\u673a\u5668\u5b66\u4e60\u65b9\u6cd5\u9884\u6d4b\u6700\u4f18\u5206\u5757\u7b56\u7565\u7684\u53ef\u884c\u6027</li>\n<li>\u52a8\u6001\u56fe\u7ed3\u6784\u4e2d\u7684\u589e\u91cfSchur\u8865\u66f4\u65b0</li>\n<li>GPU/TPU\u4e0a\u7684\u9ad8\u6548\u5b9e\u73b0\u7b56\u7565</li>\n<li>\u968f\u673a\u820d\u5165\u7b97\u672f\u5728Schur\u8865\u8ba1\u7b97\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h2 id=\"52\">5.2 \u5728\u5206\u5e03\u5f0f\u4f18\u5316\u4e2d\u7684\u5e94\u7528</h2>\n<h3 id=\"521-admmschur\">5.2.1 ADMM\u4e2d\u7684Schur\u8865</h3>\n<p>\u4ea4\u66ff\u65b9\u5411\u4e58\u5b50\u6cd5\uff08ADMM\uff09\u7684\u6838\u5fc3\u8ba1\u7b97\u5f80\u5f80\u6d89\u53caSchur\u8865\u3002\u8003\u8651\u6807\u51c6ADMM\u95ee\u9898\uff1a\n$$\\min_{\\mathbf{x}, \\mathbf{z}} f(\\mathbf{x}) + g(\\mathbf{z}) \\quad \\text{s.t.} \\quad \\mathbf{A}\\mathbf{x} + \\mathbf{B}\\mathbf{z} = \\mathbf{c}$$\nx-\u66f4\u65b0\u6b65\u9aa4\u9700\u8981\u6c42\u89e3\uff1a\n$$(\\mathbf{H}_f + \\rho\\mathbf{A}^T\\mathbf{A})\\mathbf{x} = \\mathbf{b}$$\n\u5f53$\\mathbf{H}_f$\u5177\u6709\u7279\u6b8a\u7ed3\u6784\u65f6\uff0c\u53ef\u4ee5\u5229\u7528Schur\u8865\u52a0\u901f\u6c42\u89e3\u3002</p>\n<p><strong>\u6df1\u5165\u5206\u6790\uff1a\u4e00\u81f4\u6027ADMM\u4e2d\u7684Schur\u8865\u6280\u5de7</strong></p>\n<p>\u8003\u8651\u4e00\u81f4\u6027\u4f18\u5316\u95ee\u9898\uff1a\n$$\\min_{\\mathbf{x}_1, \\ldots, \\mathbf{x}_N} \\sum_{i=1}^N f_i(\\mathbf{x}_i) \\quad \\text{s.t.} \\quad \\mathbf{x}_i = \\mathbf{z}, \\forall i$$\nADMM\u8fed\u4ee3\u4e2d\u7684\u4e3b\u8981\u8ba1\u7b97\u74f6\u9888\u662f\u6c42\u89e3\uff1a\n$$\\left(\\sum_{i=1}^N \\mathbf{H}_i + N\\rho\\mathbf{I}\\right)\\mathbf{z} = \\sum_{i=1}^N (\\mathbf{H}_i\\mathbf{x}_i + \\rho\\mathbf{x}_i + \\mathbf{y}_i)$$\n\u5f53\u5404$\\mathbf{H}_i$\u5177\u6709\u7279\u5b9a\u7ed3\u6784\u65f6\uff08\u5982\u5bf9\u89d2\u52a0\u4f4e\u79e9\uff09\uff0c\u53ef\u4ee5\u5229\u7528Schur\u8865\u5c06\u5176\u8f6c\u5316\u4e3a\u66f4\u5c0f\u89c4\u6a21\u7684\u7cfb\u7edf\u3002</p>\n<p><strong>\u5e94\u7528\u5b9e\u4f8b\uff1a\u5927\u89c4\u6a21\u7f51\u7edcLasso</strong></p>\n<p>\u7f51\u7edcLasso\u95ee\u9898\uff1a\n$$\\min_{\\mathbf{x}_1, \\ldots, \\mathbf{x}_N} \\sum_{i=1}^N \\left(\\frac{1}{2}|\\mathbf{A}_i\\mathbf{x}_i - \\mathbf{b}_i|^2 + \\lambda|\\mathbf{x}_i|_1\\right) + \\sum_{(i,j) \\in \\mathcal{E}} \\rho_{ij}|\\mathbf{x}_i - \\mathbf{x}_j|^2$$\n\u5229\u7528Schur\u8865\u7684\u5206\u5e03\u5f0fADMM\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u6bcf\u4e2a\u8282\u70b9$i$\u7ef4\u62a4\u5c40\u90e8\u53d8\u91cf$\\mathbf{x}_i$\u548c\u8fb9\u7f18\u53d8\u91cf$\\mathbf{z}_{ij}$</li>\n<li>\u5c40\u90e8\u66f4\u65b0\u4ec5\u6d89\u53ca\u90bb\u5c45\u4fe1\u606f</li>\n<li>\u5168\u5c40\u4e00\u81f4\u6027\u901a\u8fc7Schur\u8865\u7cfb\u7edf\u5b9e\u73b0</li>\n</ol>\n<p><strong>\u6536\u655b\u6027\u5206\u6790\u7684\u65b0\u89c6\u89d2</strong></p>\n<p>\u901a\u8fc7Schur\u8865\u7684\u8c31\u6027\u8d28\uff0c\u53ef\u4ee5\u7cbe\u786e\u523b\u753bADMM\u7684\u6536\u655b\u901f\u5ea6\uff1a\n$$|\\mathbf{x}^{k+1} - \\mathbf{x}^*| \\leq \\frac{\\kappa(\\mathbf{S}) - 1}{\\kappa(\\mathbf{S}) + 1} |\\mathbf{x}^k - \\mathbf{x}^*|$$\n\u5176\u4e2d$\\mathbf{S}$\u662f\u76f8\u5173\u7684Schur\u8865\u77e9\u9635\u3002\u8fd9\u63d0\u4f9b\u4e86\uff1a</p>\n<ul>\n<li>\u9009\u62e9\u7f5a\u53c2\u6570$\\rho$\u7684\u7406\u8bba\u6307\u5bfc</li>\n<li>\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\u7684\u65b0\u601d\u8def</li>\n<li>\u81ea\u9002\u5e94\u53c2\u6570\u8c03\u6574\u7684\u57fa\u7840</li>\n</ul>\n<h3 id=\"522-newton\">5.2.2 \u5206\u5e03\u5f0fNewton\u6cd5</h3>\n<p>\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\uff0c\u5168\u5c40Hessian\u77e9\u9635\u901a\u5e38\u5177\u6709\u7bad\u5934\u7ed3\u6784\uff1a\n$$\\mathbf{H} = \\begin{pmatrix} \\mathbf{H}_{11} &amp; &amp; &amp; \\mathbf{B}_1 \\ &amp; \\mathbf{H}_{22} &amp; &amp; \\mathbf{B}_2 \\ &amp; &amp; \\ddots &amp; \\vdots \\ \\mathbf{B}_1^T &amp; \\mathbf{B}_2^T &amp; \\cdots &amp; \\mathbf{H}_{gg} \\end{pmatrix}$$\n\u5229\u7528Schur\u8865\uff0c\u53ef\u4ee5\u5c06Newton\u65b9\u5411\u7684\u8ba1\u7b97\u5206\u89e3\u4e3a\uff1a</p>\n<ol>\n<li>\u5404\u8282\u70b9\u5e76\u884c\u8ba1\u7b97\u5c40\u90e8Schur\u8865</li>\n<li>\u4e3b\u8282\u70b9\u6c42\u89e3reduced\u7cfb\u7edf</li>\n<li>\u5404\u8282\u70b9\u5e76\u884c\u6062\u590d\u5b8c\u6574\u89e3</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u7b97\u6cd5\uff1a\u5206\u5e03\u5f0fSchur-Newton\u65b9\u6cd5</strong></p>\n<p>\u8bbe\u6709$p$\u4e2a\u8ba1\u7b97\u8282\u70b9\uff0c\u7b2c$i$\u4e2a\u8282\u70b9\u62e5\u6709\u5c40\u90e8\u53d8\u91cf$\\mathbf{x}_i \\in \\mathbb{R}^{n_i}$\uff0c\u5168\u5c40\u5171\u4eab\u53d8\u91cf$\\mathbf{z} \\in \\mathbb{R}^m$\u3002</p>\n<p><strong>\u7b97\u6cd5\u6b65\u9aa4</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5c40\u90e8\u8ba1\u7b97</strong>\uff08\u5e76\u884c\uff09\uff1a\n   - \u6bcf\u4e2a\u8282\u70b9$i$\u8ba1\u7b97\uff1a$\\mathbf{S}_i = \\mathbf{B}_i^T\\mathbf{H}_{ii}^{-1}\\mathbf{B}_i$\n   - \u540c\u65f6\u8ba1\u7b97\uff1a$\\mathbf{v}_i = \\mathbf{B}_i^T\\mathbf{H}_{ii}^{-1}\\mathbf{g}_i$</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u9636\u6bb5</strong>\uff1a\n   - \u5404\u8282\u70b9\u5411\u4e3b\u8282\u70b9\u53d1\u9001$(\\mathbf{S}_i, \\mathbf{v}_i)$\n   - \u901a\u4fe1\u91cf\uff1a$O(pm^2)$</p>\n</li>\n<li>\n<p><strong>\u5168\u5c40\u6c42\u89e3</strong>\uff08\u4e3b\u8282\u70b9\uff09\uff1a\n   - \u6784\u9020\u5e76\u6c42\u89e3\uff1a$(\\mathbf{H}_{gg} - \\sum_{i=1}^p \\mathbf{S}_i)\\Delta\\mathbf{z} = -\\mathbf{g}_g + \\sum_{i=1}^p \\mathbf{v}_i$\n   - \u8fd9\u662f\u4e00\u4e2a$m \\times m$\u7684\u7cfb\u7edf\uff0c\u901a\u5e38$m \\ll \\sum_i n_i$</p>\n</li>\n<li>\n<p><strong>\u5c40\u90e8\u6062\u590d</strong>\uff08\u5e76\u884c\uff09\uff1a\n   - \u6bcf\u4e2a\u8282\u70b9\u8ba1\u7b97\uff1a$\\Delta\\mathbf{x}_i = \\mathbf{H}_{ii}^{-1}(\\mathbf{g}_i - \\mathbf{B}_i\\Delta\\mathbf{z})$</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u4f18\u5316\u6280\u5de7</strong></p>\n<ol>\n<li>\n<p><strong>\u9690\u5f0f\u8868\u793a</strong>\uff1a\n   - \u4e0d\u663e\u5f0f\u6784\u9020$\\mathbf{H}_{ii}^{-1}$\n   - \u4f7f\u7528Krylov\u5b50\u7a7a\u95f4\u65b9\u6cd5\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf\n   - \u5229\u7528\u7279\u6b8a\u7ed3\u6784\uff08\u5982\u7a00\u758f\u6027\u3001Toeplitz\u7ed3\u6784\u7b49\uff09</p>\n</li>\n<li>\n<p><strong>\u8fd1\u4f3cSchur\u8865</strong>\uff1a\n   - \u4f7f\u7528\u4f4e\u79e9\u8fd1\u4f3c\uff1a$\\mathbf{S}_i \\approx \\mathbf{U}_i\\mathbf{V}_i^T$\n   - \u51cf\u5c11\u901a\u4fe1\u548c\u5b58\u50a8\u5f00\u9500\n   - \u63a7\u5236\u8fd1\u4f3c\u8bef\u5dee\u5bf9\u6536\u655b\u6027\u7684\u5f71\u54cd</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0</strong>\uff1a\n   - \u5141\u8bb8\u8282\u70b9\u4f7f\u7528\u8fc7\u671f\u7684Schur\u8865\u4fe1\u606f\n   - \u5206\u6790\u5ef6\u8fdf\u5bf9\u6536\u655b\u901f\u5ea6\u7684\u5f71\u54cd\n   - \u8bbe\u8ba1\u81ea\u9002\u5e94\u7684\u540c\u6b65\u7b56\u7565</p>\n</li>\n</ol>\n<p><strong>\u5e94\u7528\u6848\u4f8b\uff1a\u5206\u5e03\u5f0f\u6df1\u5ea6\u5b66\u4e60</strong></p>\n<p>\u5728\u5927\u89c4\u6a21\u795e\u7ecf\u7f51\u7edc\u8bad\u7ec3\u4e2d\uff1a</p>\n<ul>\n<li>\u5c40\u90e8\u53d8\u91cf\uff1a\u5404\u5c42\u7684\u6743\u91cd</li>\n<li>\u5168\u5c40\u53d8\u91cf\uff1a\u6279\u5f52\u4e00\u5316\u53c2\u6570\u3001\u5168\u5c40\u7279\u5f81</li>\n<li>Schur\u8865\u7ed3\u6784\u81ea\u7136\u5bf9\u5e94\u4e8e\u7f51\u7edc\u7684\u5206\u5c42\u7ed3\u6784</li>\n</ul>\n<p>\u7814\u7a76\u53d1\u73b0\uff0c\u5229\u7528Schur\u8865\u7684\u4e8c\u9636\u65b9\u6cd5\u53ef\u4ee5\uff1a</p>\n<ul>\n<li>\u51cf\u5c11\u901a\u4fe1\u8f6e\u6b21</li>\n<li>\u66f4\u597d\u5730\u5904\u7406\u75c5\u6001\u6761\u4ef6</li>\n<li>\u5728\u975e\u51f8\u4f18\u5316\u4e2d\u63d0\u4f9b\u66f4\u7a33\u5b9a\u7684\u6536\u655b</li>\n</ul>\n<h3 id=\"523\">5.2.3 \u901a\u4fe1\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p>\u8bbe\u6709$p$\u4e2a\u8ba1\u7b97\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u62e5\u6709$n/p$\u4e2a\u53d8\u91cf\uff0c\u5171\u4eab$m$\u4e2a\u8026\u5408\u53d8\u91cf\uff1a</p>\n<ul>\n<li><strong>\u6734\u7d20\u65b9\u6cd5</strong>\uff1a$O(n^2)$\u901a\u4fe1\u91cf</li>\n<li><strong>Schur\u8865\u65b9\u6cd5</strong>\uff1a$O(pm^2)$\u901a\u4fe1\u91cf</li>\n</ul>\n<p>\u5f53$m \\ll n/p$\u65f6\uff0cSchur\u8865\u65b9\u6cd5\u5177\u6709\u663e\u8457\u7684\u901a\u4fe1\u4f18\u52bf\u3002</p>\n<p><strong>\u6df1\u5165\u5206\u6790\uff1a\u901a\u4fe1\u6a21\u5f0f\u4e0e\u7f51\u7edc\u62d3\u6251</strong></p>\n<ol>\n<li>\n<p><strong>\u70b9\u5bf9\u70b9\u901a\u4fe1</strong>\uff1a\n   - \u603b\u901a\u4fe1\u91cf\uff1a$O(pm^2)$\n   - \u5e26\u5bbd\u9700\u6c42\uff1a$O(m^2)$\u6bcf\u8fde\u63a5\n   - \u5ef6\u8fdf\uff1a$O(\\log p)$\u8f6e\u6b21\uff08\u4f7f\u7528\u6811\u5f62\u5f52\u7ea6\uff09</p>\n</li>\n<li>\n<p><strong>\u5168\u5f52\u7ea6\u6a21\u5f0f</strong>\uff1a\n   - All-reduce\u64cd\u4f5c\uff1a$O(m^2 \\log p)$\n   - \u5229\u7528\u73af\u5f62\u6216\u8776\u5f62\u7f51\u7edc\u62d3\u6251\n   - \u5e26\u5bbd\u6700\u4f18\u5229\u7528</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u901a\u4fe1</strong>\uff1a\n   - \u591a\u7ea7Schur\u8865\uff1a$O(m^2 \\log p)$\u603b\u901a\u4fe1\n   - \u6bcf\u7ea7\u53ea\u4e0e\u76f8\u90bb\u5c42\u901a\u4fe1\n   - \u9002\u5408\u5206\u5c42\u7f51\u7edc\u67b6\u6784</p>\n</li>\n</ol>\n<p><strong>\u538b\u7f29\u6280\u672f</strong></p>\n<ol>\n<li><strong>\u4f4e\u79e9\u8fd1\u4f3c</strong>\uff1a\n$$\\mathbf{S}_i \\approx \\mathbf{U}_i\\mathbf{\\Sigma}_i\\mathbf{V}_i^T, \\quad \\text{rank}(\\mathbf{U}_i) = r \\ll m$$</li>\n</ol>\n<ul>\n<li>\u901a\u4fe1\u91cf\u51cf\u5c11\u5230$O(prm)$</li>\n<li>\u4f7f\u7528\u968f\u673aSketch\u6280\u672f</li>\n<li>\u81ea\u9002\u5e94\u79e9\u9009\u62e9</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u91cf\u5316\u4e0e\u7a00\u758f\u5316</strong>\uff1a\n   - \u68af\u5ea6\u91cf\u5316\uff1a1-bit SGD\u601d\u60f3\u7684\u63a8\u5e7f\n   - Top-k\u7a00\u758f\u5316\uff1a\u53ea\u4f20\u8f93\u6700\u5927\u7684$k$\u4e2a\u5143\u7d20\n   - \u8bef\u5dee\u8865\u507f\u673a\u5236</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u907f\u514d\u7b97\u6cd5</strong>\uff1a\n   - \u5c40\u90e8\u8fed\u4ee3\u51cf\u5c11\u540c\u6b65\u9891\u7387\n   - \u5f02\u6b65Schur\u8865\u66f4\u65b0\n   - \u6536\u655b\u6027\u4e0e\u901a\u4fe1\u6548\u7387\u7684\u6743\u8861</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u7cfb\u7edf\u8003\u8651</strong></p>\n<ol>\n<li>\n<p><strong>\u5f02\u6784\u73af\u5883</strong>\uff1a\n   - \u4e0d\u540c\u8282\u70b9\u8ba1\u7b97\u80fd\u529b\u4e0d\u540c\n   - \u52a8\u6001\u8d1f\u8f7d\u5747\u8861\n   - Schur\u8865\u5927\u5c0f\u7684\u81ea\u9002\u5e94\u8c03\u6574</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a\n   - \u8282\u70b9\u5931\u6548\u65f6\u7684\u6062\u590d\n   - \u68c0\u67e5\u70b9\u4e0e\u91cd\u542f\u7b56\u7565\n   - \u5197\u4f59Schur\u8865\u8ba1\u7b97</p>\n</li>\n<li>\n<p><strong>\u80fd\u6548\u4f18\u5316</strong>\uff1a\n   - \u901a\u4fe1\u4e0e\u8ba1\u7b97\u7684\u91cd\u53e0\n   - \u52a8\u6001\u7535\u538b\u9891\u7387\u8c03\u6574\n   - \u7eff\u8272\u8ba1\u7b97\u8003\u8651</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u5982\u4f55\u5728\u901a\u4fe1\u53d7\u9650\u7684\u73af\u5883\u4e2d\u81ea\u9002\u5e94\u5730\u9009\u62e9\u8026\u5408\u53d8\u91cf\u7684\u6570\u91cf\u548c\u5206\u5e03</li>\n<li>\u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u7684\u901a\u4fe1\u6a21\u5f0f\u9884\u6d4b\u4e0e\u4f18\u5316</li>\n<li>\u91cf\u5b50\u901a\u4fe1\u7f51\u7edc\u4e2d\u7684Schur\u8865\u7b97\u6cd5\u8bbe\u8ba1</li>\n</ul>\n<h2 id=\"53\">5.3 \u6761\u4ef6\u6570\u6539\u5584\u6280\u672f</h2>\n<h3 id=\"531-schur\">5.3.1 Schur\u8865\u4e0e\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</h3>\n<p>Schur\u8865\u63d0\u4f9b\u4e86\u6784\u9020\u9ad8\u6548\u9884\u6761\u4ef6\u5b50\u7684\u7cfb\u7edf\u65b9\u6cd5\u3002\u5bf9\u4e8e\u978d\u70b9\u7cfb\u7edf\uff1a\n$$\\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B}^T \\ \\mathbf{B} &amp; -\\mathbf{C} \\end{pmatrix} \\begin{pmatrix} \\mathbf{x} \\ \\mathbf{y} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f} \\ \\mathbf{g} \\end{pmatrix}$$\n\u4e00\u7c7b\u91cd\u8981\u7684\u9884\u6761\u4ef6\u5b50\u57fa\u4e8e\u8fd1\u4f3cSchur\u8865\uff1a\n$$\\mathbf{P} = \\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B}^T \\ \\mathbf{0} &amp; -\\tilde{\\mathbf{S}} \\end{pmatrix}$$\n\u5176\u4e2d$\\tilde{\\mathbf{S}} \\approx \\mathbf{C} + \\mathbf{B}\\mathbf{A}^{-1}\\mathbf{B}^T$\u3002</p>\n<h3 id=\"532\">5.3.2 \u8c31\u5206\u6790\u4e0e\u6761\u4ef6\u6570\u4f30\u8ba1</h3>\n<p>Schur\u8865\u7684\u7279\u5f81\u503c\u4e0e\u539f\u77e9\u9635\u7279\u5f81\u503c\u4e4b\u95f4\u5b58\u5728\u7cbe\u5999\u7684\u5173\u7cfb\uff1a</p>\n<p><strong>\u5b9a\u7406\uff08Schur\u8865\u7684\u8c31\u6027\u8d28\uff09</strong>\uff1a\u8bbe$\\mathbf{M}$\u7684\u7279\u5f81\u503c\u4e3a${\\lambda_i}$\uff0c$\\mathbf{A}$\u7684\u7279\u5f81\u503c\u4e3a${\\mu_j}$\uff0c\u5219Schur\u8865$\\mathbf{S}_A$\u7684\u7279\u5f81\u503c\u6ee1\u8db3\u4ea4\u9519\u6027\u8d28\u3002</p>\n<p>\u8fd9\u4e00\u6027\u8d28\u53ef\u7528\u4e8e\uff1a</p>\n<ul>\n<li>\u4f30\u8ba1\u9884\u6761\u4ef6\u540e\u7cfb\u7edf\u7684\u6761\u4ef6\u6570</li>\n<li>\u8bbe\u8ba1\u81ea\u9002\u5e94\u7684\u5206\u5757\u7b56\u7565</li>\n<li>\u5206\u6790\u6536\u655b\u901f\u5ea6</li>\n</ul>\n<h3 id=\"533\">5.3.3 \u81ea\u9002\u5e94\u5206\u5757\u7b56\u7565</h3>\n<p>\u57fa\u4e8e\u8c31\u4fe1\u606f\u7684\u81ea\u9002\u5e94\u5206\u5757\uff1a</p>\n<ol>\n<li><strong>\u8c31\u805a\u7c7b</strong>\uff1a\u5c06\u5f3a\u8026\u5408\u7684\u53d8\u91cf\u5206\u5728\u540c\u4e00\u5757</li>\n<li><strong>\u5e73\u8861\u6761\u4ef6\u6570</strong>\uff1a\u9009\u62e9\u5206\u5757\u4f7f\u5404\u5757\u7684\u6761\u4ef6\u6570\u76f8\u8fd1</li>\n<li><strong>\u6700\u5c0f\u5316fill-in</strong>\uff1a\u8003\u8651\u7a00\u758f\u6027\u4fdd\u6301</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a\u5982\u4f55\u5728\u7ebf\u5b66\u4e60\u6700\u4f18\u5206\u5757\u7b56\u7565\uff0c\u7279\u522b\u662f\u5728\u95ee\u9898\u7ed3\u6784\u968f\u65f6\u95f4\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\u3002</p>\n<h2 id=\"54\">5.4 \u4e0e\u57df\u5206\u89e3\u65b9\u6cd5\u7684\u8054\u7cfb</h2>\n<h3 id=\"541-schur\">5.4.1 Schur\u8865\u5728\u57df\u5206\u89e3\u4e2d\u7684\u6838\u5fc3\u4f5c\u7528</h3>\n<p>\u57df\u5206\u89e3\u65b9\u6cd5\u7684\u6570\u5b66\u57fa\u7840\u6b63\u662fSchur\u8865\u3002\u8003\u8651\u504f\u5fae\u5206\u65b9\u7a0b\u79bb\u6563\u5316\u540e\u7684\u7ebf\u6027\u7cfb\u7edf\uff0c\u6309\u5b50\u57df\u5212\u5206\uff1a\n$$\\begin{pmatrix} \\mathbf{A}_{II} &amp; \\mathbf{A}_{I\\Gamma} \\ \\mathbf{A}_{\\Gamma I} &amp; \\mathbf{A}_{\\Gamma\\Gamma} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u}_I \\ \\mathbf{u}_\\Gamma \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f}_I \\ \\mathbf{f}_\\Gamma \\end{pmatrix}$$\n\u5176\u4e2d$I$\u8868\u793a\u5185\u90e8\u81ea\u7531\u5ea6\uff0c$\\Gamma$\u8868\u793a\u754c\u9762\u81ea\u7531\u5ea6\u3002Schur\u8865\u7cfb\u7edf\uff1a\n$$\\mathbf{S}\\mathbf{u}_\\Gamma = \\mathbf{f}_\\Gamma - \\mathbf{A}_{\\Gamma I}\\mathbf{A}_{II}^{-1}\\mathbf{f}_I$$\n\u6b63\u662f\u9700\u8981\u6c42\u89e3\u7684\u754c\u9762\u95ee\u9898\u3002</p>\n<h3 id=\"542\">5.4.2 \u754c\u9762\u95ee\u9898\u7684\u9ad8\u6548\u6c42\u89e3</h3>\n<p>\u754c\u9762Schur\u8865\u7cfb\u7edf\u901a\u5e38\u5177\u6709\u7279\u6b8a\u6027\u8d28\uff1a</p>\n<ul>\n<li>\u76f8\u5bf9\u4e8e\u539f\u95ee\u9898\u89c4\u6a21\u66f4\u5c0f</li>\n<li>\u6761\u4ef6\u6570\u53ef\u80fd\u66f4\u5dee</li>\n<li>\u5177\u6709\u7279\u6b8a\u7684\u7a00\u758f\u7ed3\u6784</li>\n</ul>\n<p>\u9ad8\u6548\u6c42\u89e3\u7b56\u7565\u5305\u62ec\uff1a</p>\n<ol>\n<li><strong>Neumann-Neumann\u9884\u6761\u4ef6\u5b50</strong></li>\n<li><strong>FETI\u65b9\u6cd5</strong>\uff08\u6709\u9650\u5143\u6495\u88c2\u4e92\u8054\uff09</li>\n<li><strong>\u5e73\u8861\u57df\u5206\u89e3</strong>\uff08BDD\uff09</li>\n</ol>\n<h3 id=\"543\">5.4.3 \u591a\u5c42\u57df\u5206\u89e3\u65b9\u6cd5</h3>\n<p>\u9012\u5f52\u5e94\u7528Schur\u8865\u601d\u60f3\u53ef\u4ee5\u6784\u9020\u591a\u5c42\u65b9\u6cd5\uff1a</p>\n<p><strong>\u7b97\u6cd5\uff1a\u591a\u5c42Schur\u8865</strong></p>\n<ol>\n<li>\u5c06\u57df\u5206\u89e3\u4e3a\u591a\u4e2a\u5b50\u57df</li>\n<li>\u5728\u6bcf\u4e2a\u5b50\u57df\u5185\u9012\u5f52\u5206\u89e3</li>\n<li>\u81ea\u5e95\u5411\u4e0a\u6784\u9020Schur\u8865\u5c42\u6b21</li>\n<li>\u81ea\u9876\u5411\u4e0b\u6c42\u89e3</li>\n</ol>\n<p>\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\uff1a</p>\n<ul>\n<li>$O(n\\log n)$\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\uff08\u5bf9\u4e8e\u89c4\u5219\u7f51\u683c\uff09</li>\n<li>\u81ea\u7136\u7684\u5e76\u884c\u6027</li>\n<li>\u826f\u597d\u7684\u53ef\u6269\u5c55\u6027</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a\u5982\u4f55\u5c06\u591a\u5c42\u57df\u5206\u89e3\u65b9\u6cd5\u63a8\u5e7f\u5230\u56fe\u7ed3\u6784\u548c\u975e\u89c4\u5219\u7f51\u683c\uff0c\u7279\u522b\u662f\u5728\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u5927\u89c4\u6a21\u8bad\u7ec3\u4e2d\u3002</p>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86Schur\u8865\u5728\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u6838\u5fc3\u4f5c\u7528\u3002\u4e3b\u8981\u5185\u5bb9\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u7840\u7406\u8bba</strong>\uff1aSchur\u8865\u63d0\u4f9b\u4e86\u5206\u5757\u77e9\u9635\u6c42\u9006\u7684\u4f18\u96c5\u6846\u67b6\uff0c\u5176\u9012\u5f52\u6027\u8d28\u4f7f\u5f97\u5927\u89c4\u6a21\u95ee\u9898\u53ef\u4ee5\u5206\u89e3\u4e3a\u5c0f\u89c4\u6a21\u5b50\u95ee\u9898\u3002</p>\n</li>\n<li>\n<p><strong>\u5173\u952e\u516c\u5f0f</strong>\uff1a\n   - Schur\u8865\u5b9a\u4e49\uff1a$\\mathbf{S}_A = \\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$\n   - \u884c\u5217\u5f0f\u5206\u89e3\uff1a$\\det(\\mathbf{M}) = \\det(\\mathbf{A})\\det(\\mathbf{S}_A)$\n   - \u9006\u77e9\u9635\u5206\u5757\u516c\u5f0f</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u4f18\u52bf</strong>\uff1a\n   - \u5c06$O(n^3)$\u7684\u77e9\u9635\u6c42\u9006\u8f6c\u5316\u4e3a\u591a\u4e2a\u8f83\u5c0f\u89c4\u6a21\u7684\u95ee\u9898\n   - \u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u663e\u8457\u51cf\u5c11\u901a\u4fe1\u5f00\u9500\n   - \u63d0\u4f9b\u4e86\u6784\u9020\u9ad8\u6548\u9884\u6761\u4ef6\u5b50\u7684\u7cfb\u7edf\u65b9\u6cd5</p>\n</li>\n<li>\n<p><strong>\u5e94\u7528\u9886\u57df</strong>\uff1a\n   - ADMM\u548c\u5206\u5e03\u5f0f\u4f18\u5316\n   - \u57df\u5206\u89e3\u65b9\u6cd5\n   - \u978d\u70b9\u7cfb\u7edf\u6c42\u89e3\n   - \u5927\u89c4\u6a21\u7a00\u758f\u7ebf\u6027\u7cfb\u7edf</p>\n</li>\n<li>\n<p><strong>\u672a\u6765\u7814\u7a76\u65b9\u5411</strong>\uff1a\n   - \u81ea\u9002\u5e94\u5206\u5757\u7b56\u7565\u7684\u5728\u7ebf\u5b66\u4e60\n   - \u975e\u7ed3\u6784\u5316\u7f51\u683c\u4e0a\u7684\u9ad8\u6548\u5b9e\u73b0\n   - \u4e0e\u73b0\u4ee3AI\u67b6\u6784\uff08\u5982Transformer\uff09\u7684\u7ed3\u5408\n   - \u91cf\u5b50\u8ba1\u7b97\u4e2d\u7684Schur\u8865\u7b97\u6cd5</p>\n</li>\n</ol>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u98985.1</strong> \u8bc1\u660eSchur\u8865\u7684\u884c\u5217\u5f0f\u6027\u8d28\uff1a$\\det(\\mathbf{M}) = \\det(\\mathbf{A})\\det(\\mathbf{S}_A)$\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u5206\u5757LU\u5206\u89e3\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8003\u8651\u5206\u5757LU\u5206\u89e3\uff1a\n$$\\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{C} &amp; \\mathbf{D} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{I} &amp; \\mathbf{0} \\ \\mathbf{C}\\mathbf{A}^{-1} &amp; \\mathbf{I} \\end{pmatrix} \\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{0} &amp; \\mathbf{S}_A \\end{pmatrix}$$\n\u4e24\u8fb9\u53d6\u884c\u5217\u5f0f\uff0c\u6ce8\u610f\u5230\u4e0b\u4e09\u89d2\u5757\u77e9\u9635\u7684\u884c\u5217\u5f0f\u4e3a1\uff0c\u4e0a\u4e09\u89d2\u5757\u77e9\u9635\u7684\u884c\u5217\u5f0f\u4e3a\u5bf9\u89d2\u5757\u7684\u884c\u5217\u5f0f\u4e4b\u79ef\u3002</p>\n</details>\n<p><strong>\u4e60\u98985.2</strong> \u7ed9\u5b9a\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635$\\mathbf{M}$\u7684\u5206\u5757\u5f62\u5f0f\uff0c\u8bc1\u660e\u5176Schur\u8865$\\mathbf{S}_A$\u4e5f\u662f\u5bf9\u79f0\u6b63\u5b9a\u7684\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5229\u7528\u6b63\u5b9a\u77e9\u9635\u7684Schur\u8865\u6027\u8d28\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635$\\mathbf{M}$\uff0c\u5b58\u5728\u5411\u91cf$\\mathbf{v} \\neq \\mathbf{0}$\u4f7f\u5f97\uff1a\n$$\\mathbf{v}^T\\mathbf{S}_A\\mathbf{v} = \\min_{\\mathbf{u}} \\begin{pmatrix} \\mathbf{u} \\ \\mathbf{v} \\end{pmatrix}^T \\mathbf{M} \\begin{pmatrix} \\mathbf{u} \\ \\mathbf{v} \\end{pmatrix} &gt; 0$$\n\u8fd9\u4e2a\u6700\u5c0f\u503c\u5728$\\mathbf{u} = -\\mathbf{A}^{-1}\\mathbf{B}\\mathbf{v}$\u65f6\u53d6\u5f97\uff0c\u4e14\u4e25\u683c\u5927\u4e8e\u96f6\uff08\u56e0\u4e3a$\\mathbf{M}$\u6b63\u5b9a\uff09\u3002</p>\n</details>\n<p><strong>\u4e60\u98985.3</strong> \u8bbe\u8ba1\u4e00\u4e2a\u9012\u5f52\u7b97\u6cd5\uff0c\u5229\u7528Schur\u8865\u8ba1\u7b97\u4e09\u5bf9\u89d2\u77e9\u9635\u7684\u9006\u3002\u5206\u6790\u5176\u8ba1\u7b97\u590d\u6742\u5ea6\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5229\u7528\u4e09\u5bf9\u89d2\u77e9\u9635\u7684\u7279\u6b8a\u7ed3\u6784\uff0cSchur\u8865\u4e5f\u662f\u4e09\u5bf9\u89d2\u7684\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5c06$n \\times n$\u4e09\u5bf9\u89d2\u77e9\u9635\u5206\u6210\u56db\u5757\uff0c\u5176\u4e2d$\\mathbf{A}$\u662f$(n/2) \\times (n/2)$\u7684\u4e09\u5bf9\u89d2\u77e9\u9635\u3002\u7531\u4e8e\u4e09\u5bf9\u89d2\u7ed3\u6784\uff0c$\\mathbf{B}$\u548c$\\mathbf{C}$\u90fd\u5f88\u7a00\u758f\u3002\u9012\u5f52\u8ba1\u7b97$\\mathbf{A}^{-1}$\u548cSchur\u8865\u7684\u9006\u3002</p>\n<p>\u590d\u6742\u5ea6\u5206\u6790\uff1a$T(n) = 2T(n/2) + O(n)$\uff0c\u89e3\u5f97$T(n) = O(n\\log n)$\uff0c\u4f18\u4e8e\u76f4\u63a5\u6c42\u9006\u7684$O(n)$\uff08\u5bf9\u4e8e\u4e09\u5bf9\u89d2\u77e9\u9635\u7684\u7279\u6b8a\u7b97\u6cd5\uff09\u3002\u4f46\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\u5728\u4e8e\u5e76\u884c\u6027\u3002</p>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u98985.4</strong> \u8003\u8651\u5e7f\u4e49Schur\u8865\uff1a\u5f53$\\mathbf{A}$\u5947\u5f02\u4f46$\\mathbf{M}$\u975e\u5947\u5f02\u65f6\uff0c\u5982\u4f55\u5b9a\u4e49\u548c\u8ba1\u7b97Schur\u8865\uff1f\u63a2\u8ba8\u5176\u5728\u534a\u6b63\u5b9a\u89c4\u5212\u4e2d\u7684\u5e94\u7528\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651Moore-Penrose\u4f2a\u9006\u6216\u6b63\u5219\u5316\u65b9\u6cd5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5f53$\\mathbf{A}$\u5947\u5f02\u65f6\uff0c\u53ef\u4ee5\u5b9a\u4e49\u5e7f\u4e49Schur\u8865\uff1a\n$$\\mathbf{S}_A^+ = \\mathbf{D} - \\mathbf{C}\\mathbf{A}^+\\mathbf{B}$$\n\u5176\u4e2d$\\mathbf{A}^+$\u662fMoore-Penrose\u4f2a\u9006\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u6b63\u5219\u5316\uff1a\n$$\\mathbf{S}_A^\\epsilon = \\mathbf{D} - \\mathbf{C}(\\mathbf{A} + \\epsilon\\mathbf{I})^{-1}\\mathbf{B}$$\n\u5728\u534a\u6b63\u5b9a\u89c4\u5212\u7684\u5185\u70b9\u6cd5\u4e2d\uff0c\u5f53\u63a5\u8fd1\u6700\u4f18\u89e3\u65f6\uff0c\u67d0\u4e9b\u5757\u53ef\u80fd\u53d8\u5f97\u63a5\u8fd1\u5947\u5f02\uff0c\u8fd9\u65f6\u5e7f\u4e49Schur\u8865\u63d0\u4f9b\u4e86\u6570\u503c\u7a33\u5b9a\u7684\u5904\u7406\u65b9\u6cd5\u3002</p>\n</details>\n<p><strong>\u4e60\u98985.5</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7b97\u6cd5\uff0c\u6839\u636e\u77e9\u9635\u7684\u8c31\u6027\u8d28\u52a8\u6001\u9009\u62e9Schur\u8865\u7684\u5206\u5757\u7b56\u7565\u3002\u76ee\u6807\u662f\u6700\u5c0f\u5316\u6761\u4ef6\u6570\u7684\u589e\u957f\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4f7f\u7528\u8fd1\u4f3c\u7279\u5f81\u503c\u5206\u89e3\u548c\u56fe\u5206\u5272\u7b97\u6cd5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u4f7f\u7528Lanczos\u65b9\u6cd5\u4f30\u8ba1\u77e9\u9635\u7684\u4e3b\u8981\u7279\u5f81\u5411\u91cf</li>\n<li>\u57fa\u4e8e\u7279\u5f81\u5411\u91cf\u6784\u9020\u4eb2\u548c\u77e9\u9635</li>\n<li>\u4f7f\u7528\u8c31\u805a\u7c7b\u786e\u5b9a\u5206\u5757</li>\n<li>\u4f30\u8ba1\u4e0d\u540c\u5206\u5757\u65b9\u6848\u7684\u6761\u4ef6\u6570\uff08\u4f7f\u7528\u6761\u4ef6\u6570\u7684\u4e0a\u754c\uff09</li>\n<li>\u9009\u62e9\u4f7f\u6761\u4ef6\u6570\u589e\u957f\u6700\u5c0f\u7684\u65b9\u6848</li>\n</ol>\n<p>\u5173\u952e\u89c2\u5bdf\uff1a\u5c06\u5f3a\u8026\u5408\uff08\u5bf9\u5e94\u4e8e\u7279\u5f81\u5411\u91cf\u4e2d\u76f8\u8fd1\u7684\u5206\u91cf\uff09\u7684\u53d8\u91cf\u5206\u5728\u540c\u4e00\u5757\u53ef\u4ee5\u51cf\u5c11Schur\u8865\u4e2d\u7684\"\u4fe1\u606f\u635f\u5931\"\u3002</p>\n</details>\n<p><strong>\u4e60\u98985.6</strong> \u5728\u6709\u9650\u7cbe\u5ea6\u7b97\u672f\u4e0b\uff0c\u5206\u6790Schur\u8865\u65b9\u6cd5\u7684\u8bef\u5dee\u4f20\u64ad\u3002\u7279\u522b\u5730\uff0c\u5f53$\\mathbf{A}$\u63a5\u8fd1\u5947\u5f02\u65f6\uff0c\u5982\u4f55\u63a7\u5236\u6570\u503c\u8bef\u5dee\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u5411\u540e\u8bef\u5dee\u5206\u6790\u548c\u6761\u4ef6\u6570\u7684\u7ec4\u5408\u754c\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bef\u5dee\u754c\uff1a\n$$|\\Delta\\mathbf{S}_A| \\lesssim \\epsilon_{\\text{machine}} \\cdot \\kappa(\\mathbf{A}) \\cdot (|\\mathbf{C}| |\\mathbf{B}| + \\kappa(\\mathbf{A})|\\mathbf{D}|)$$</p>\n<p>\u5f53$\\kappa(\\mathbf{A})$\u5f88\u5927\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528\uff1a</p>\n<ol>\n<li>\u8fed\u4ee3\u7cbe\u5316</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\uff08\u5728\u5173\u952e\u6b65\u9aa4\u4f7f\u7528\u9ad8\u7cbe\u5ea6\uff09</li>\n<li>\u6b63\u5219\u5316\u6216\u622a\u65ad\u7b56\u7565</li>\n<li>\u57fa\u4e8e\u6b8b\u5dee\u7684\u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236</li>\n</ol>\n</details>\n<p><strong>\u4e60\u98985.7</strong> \u63a2\u8ba8Schur\u8865\u5728\u91cf\u5b50\u7ebf\u6027\u7cfb\u7edf\u7b97\u6cd5\uff08HHL\u7b97\u6cd5\uff09\u7ecf\u5178\u6a21\u62df\u4e2d\u7684\u4f5c\u7528\u3002\u5982\u4f55\u5229\u7528Schur\u8865\u52a0\u901f\u5757\u7f16\u7801\u7684\u6784\u9020\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u91cf\u5b50\u7b97\u6cd5\u4e2d\u7684\u5757\u7f16\u7801\u6280\u672f\u548c\u7ecf\u5178\u9884\u5904\u7406\u7684\u7ed3\u5408\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5728HHL\u7b97\u6cd5\u7684\u7ecf\u5178\u6a21\u62df\u4e2d\uff0cSchur\u8865\u53ef\u4ee5\u7528\u4e8e\uff1a</p>\n<ol>\n<li>\u6784\u9020\u66f4\u7d27\u51d1\u7684\u5757\u7f16\u7801\uff0c\u51cf\u5c11\u91cf\u5b50\u6bd4\u7279\u6570</li>\n<li>\u9884\u5904\u7406\u7cfb\u7edf\uff0c\u6539\u5584\u6761\u4ef6\u6570</li>\n<li>\u5c06\u5927\u7cfb\u7edf\u5206\u89e3\u4e3a\u53ef\u4ee5\u72ec\u7acb\u5904\u7406\u7684\u5b50\u7cfb\u7edf</li>\n</ol>\n<p>\u5177\u4f53\u5730\uff0c\u5982\u679c\u539f\u7cfb\u7edf\u7684\u5757\u7f16\u7801\u9700\u8981$O(\\log n)$\u8f85\u52a9\u91cf\u5b50\u6bd4\u7279\uff0c\u901a\u8fc7Schur\u8865\u9884\u5904\u7406\uff0c\u53ef\u80fd\u51cf\u5c11\u5230$O(\\log(n/k))$\uff0c\u5176\u4e2d$k$\u662f\u5757\u7684\u6570\u91cf\u3002</p>\n</details>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef\uff08Gotchas\uff09</h2>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u9677\u9631</strong>\n   - \u274c \u76f4\u63a5\u8ba1\u7b97$\\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$\uff08\u5148\u6c42\u9006\u518d\u4e58\uff09\n   - \u2705 \u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf$\\mathbf{A}\\mathbf{X} = \\mathbf{B}$\uff0c\u7136\u540e\u8ba1\u7b97$\\mathbf{C}\\mathbf{X}$</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u6076\u5316</strong>\n   - \u274c \u76f2\u76ee\u9009\u62e9\u5de6\u4e0a\u89d2\u4f5c\u4e3a\u67a2\u8f74\u5757\n   - \u2705 \u57fa\u4e8e\u6761\u4ef6\u6570\u4f30\u8ba1\u6216\u5bf9\u89d2\u5360\u4f18\u6027\u9009\u62e9\u67a2\u8f74</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u6027\u7834\u574f</strong>\n   - \u274c \u5ffd\u89c6fill-in\u73b0\u8c61\n   - \u2705 \u4f7f\u7528\u7b26\u53f7\u5206\u6790\u9884\u6d4b\u7a00\u758f\u6a21\u5f0f</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u6548\u7387</strong>\n   - \u274c \u4e32\u884c\u8ba1\u7b97\u6240\u6709Schur\u8865\n   - \u2705 \u8bc6\u522b\u72ec\u7acb\u7684\u5b50\u4efb\u52a1\u5e76\u884c\u5316</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406</strong>\n   - \u274c \u5b58\u50a8\u5b8c\u6574\u7684\u4e2d\u95f4\u77e9\u9635\n   - \u2705 \u4f7f\u7528\u5ef6\u8fdf\u8ba1\u7b97\u548c\u5185\u5b58\u590d\u7528\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u7cbe\u5ea6\u63a7\u5236</strong>\n   - \u274c \u4f7f\u7528\u56fa\u5b9a\u7cbe\u5ea6\u9608\u503c\n   - \u2705 \u57fa\u4e8e\u95ee\u9898\u89c4\u6a21\u548c\u6761\u4ef6\u6570\u81ea\u9002\u5e94\u8c03\u6574\u7cbe\u5ea6</p>\n</li>\n</ol>\n<h2 id=\"_5\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_6\">\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5206\u6790\u77e9\u9635\u7ed3\u6784\uff0c\u8bc6\u522b\u81ea\u7136\u7684\u5206\u5757</li>\n<li>[ ] \u4f30\u8ba1\u5404\u5757\u7684\u6761\u4ef6\u6570\u548c\u7a00\u758f\u6027</li>\n<li>[ ] \u8bc4\u4f30\u5e76\u884c\u5316\u7684\u6f5c\u529b\u548c\u901a\u4fe1\u5f00\u9500</li>\n<li>[ ] \u8003\u8651\u6570\u503c\u7a33\u5b9a\u6027\u9700\u6c42</li>\n</ul>\n<h3 id=\"_7\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u7a33\u5b9a\u7684\u7ebf\u6027\u6c42\u89e3\u5668\u800c\u975e\u663e\u5f0f\u6c42\u9006</li>\n<li>[ ] \u5b9e\u73b0\u6761\u4ef6\u6570\u76d1\u63a7\u673a\u5236</li>\n<li>[ ] \u91c7\u7528\u5206\u5c42\u5b58\u50a8\u7b56\u7565\u4f18\u5316\u5185\u5b58\u8bbf\u95ee</li>\n<li>[ ] \u9884\u7559\u63a5\u53e3\u7528\u4e8e\u4e0d\u540c\u7684\u67a2\u8f74\u9009\u62e9\u7b56\u7565</li>\n</ul>\n<h3 id=\"_8\">\u4f18\u5316\u9636\u6bb5</h3>\n<ul>\n<li>[ ] Profile\u786e\u5b9a\u6027\u80fd\u74f6\u9888</li>\n<li>[ ] \u5b9e\u73b0\u8fd1\u4f3cSchur\u8865\u7528\u4e8e\u9884\u6761\u4ef6</li>\n<li>[ ] \u63a2\u7d22\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7684\u53ef\u80fd\u6027</li>\n<li>[ ] \u8003\u8651\u4e0e\u786c\u4ef6\u67b6\u6784\u7684\u9002\u914d\uff08\u5982GPU\u4e0a\u7684\u5b9e\u73b0\uff09</li>\n</ul>\n<h3 id=\"_9\">\u9a8c\u8bc1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6d4b\u8bd5\u4e0d\u540c\u89c4\u6a21\u548c\u6761\u4ef6\u6570\u7684\u95ee\u9898</li>\n<li>[ ] \u9a8c\u8bc1\u5e76\u884c\u6548\u7387\u548c\u53ef\u6269\u5c55\u6027</li>\n<li>[ ] \u68c0\u67e5\u6570\u503c\u7cbe\u5ea6\u548c\u7a33\u5b9a\u6027</li>\n<li>[ ] \u4e0e\u5176\u4ed6\u65b9\u6cd5\u8fdb\u884c\u6027\u80fd\u6bd4\u8f83</li>\n</ul>"
  },
  "../chapter15.md": {
    "hash": "941ccf5b3dd63cd8279f974c2d2f4d95",
    "content": "<h1 id=\"15\">\u7b2c15\u7ae0\uff1a\u5b9e\u65f6\u63a8\u8350\u7684\u589e\u91cf\u77e9\u9635\u65b9\u6cd5</h1>\n<p>\u5728\u73b0\u4ee3\u63a8\u8350\u7cfb\u7edf\u4e2d\uff0c\u7528\u6237\u884c\u4e3a\u6570\u636e\u4ee5\u6d41\u7684\u5f62\u5f0f\u4e0d\u65ad\u4ea7\u751f\uff0c\u7cfb\u7edf\u9700\u8981\u5b9e\u65f6\u54cd\u5e94\u5e76\u66f4\u65b0\u63a8\u8350\u7ed3\u679c\u3002\u4f20\u7edf\u7684\u6279\u5904\u7406\u77e9\u9635\u5206\u89e3\u65b9\u6cd5\u5df2\u65e0\u6cd5\u6ee1\u8db3\u6beb\u79d2\u7ea7\u5ef6\u8fdf\u7684\u9700\u6c42\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5982\u4f55\u8bbe\u8ba1\u9ad8\u6548\u7684\u589e\u91cf\u7b97\u6cd5\uff0c\u5728\u4fdd\u8bc1\u63a8\u8350\u8d28\u91cf\u7684\u540c\u65f6\u5b9e\u73b0\u5feb\u901f\u66f4\u65b0\u3002\u6211\u4eec\u5c06\u5206\u6790\u5728\u7ebf\u5b66\u4e60\u7684\u7406\u8bba\u4fdd\u8bc1\u3001\u6570\u503c\u7a33\u5b9a\u6027\u6311\u6218\uff0c\u4ee5\u53ca\u5de5\u7a0b\u5b9e\u73b0\u7684\u6700\u4f73\u5b9e\u8df5\u3002</p>\n<h2 id=\"151\">15.1 \u5728\u7ebf\u77e9\u9635\u5206\u89e3\u7684\u9057\u5fd8\u673a\u5236</h2>\n<h3 id=\"1511\">15.1.1 \u65f6\u95f4\u8870\u51cf\u7684\u6570\u5b66\u5efa\u6a21</h3>\n<p>\u5728\u5b9e\u65f6\u63a8\u8350\u573a\u666f\u4e2d\uff0c\u7528\u6237\u5174\u8da3\u968f\u65f6\u95f4\u6f14\u5316\uff0c\u65e7\u6570\u636e\u7684\u91cd\u8981\u6027\u9010\u6e10\u964d\u4f4e\u3002\u6211\u4eec\u9700\u8981\u8bbe\u8ba1\u5408\u7406\u7684\u9057\u5fd8\u673a\u5236\u6765\u5e73\u8861\u5386\u53f2\u4fe1\u606f\u4e0e\u65b0\u9c9c\u5ea6\u3002\u9057\u5fd8\u673a\u5236\u7684\u8bbe\u8ba1\u76f4\u63a5\u5f71\u54cd\u6a21\u578b\u5bf9\u8d8b\u52bf\u53d8\u5316\u7684\u654f\u611f\u5ea6\u548c\u7a33\u5b9a\u6027\u3002</p>\n<p><strong>\u6307\u6570\u9057\u5fd8\u6a21\u578b</strong></p>\n<p>\u8003\u8651\u77e9\u9635\u5206\u89e3\u7684\u76ee\u6807\u51fd\u6570\uff1a\n$$\\mathcal{L}_t = \\sum_{(i,j) \\in \\Omega_t} w_{ij}^{(t)} (r_{ij} - \\mathbf{u}_i^T \\mathbf{v}_j)^2 + \\lambda (|\\mathbf{U}|_F^2 + |\\mathbf{V}|_F^2)$$\n\u5176\u4e2d\u65f6\u95f4\u6743\u91cd $w_{ij}^{(t)} = \\exp(-\\beta(t - t_{ij}))$\uff0c$t_{ij}$ \u662f\u89c2\u6d4b\u65f6\u95f4\uff0c$\\beta$ \u63a7\u5236\u9057\u5fd8\u901f\u7387\u3002</p>\n<p>\u6307\u6570\u9057\u5fd8\u7684\u4f18\u52bf\u5728\u4e8e\uff1a</p>\n<ul>\n<li>\u5e73\u6ed1\u7684\u6743\u91cd\u8870\u51cf\uff0c\u907f\u514d\u7a81\u53d8</li>\n<li>\u53c2\u6570 $\\beta$ \u5177\u6709\u660e\u786e\u7684\u7269\u7406\u610f\u4e49\uff08\u534a\u8870\u671f $t_{1/2} = \\ln(2)/\\beta$\uff09</li>\n<li>\u4e0e\u5728\u7ebf\u5b66\u4e60\u7406\u8bba\u4e2d\u7684\u6307\u6570\u52a0\u6743\u5e73\u5747\uff08EWA\uff09\u76f8\u8054\u7cfb</li>\n<li>\u6ee1\u8db3\u65f6\u95f4\u4e00\u81f4\u6027\uff1a$w_{ij}^{(t+\\Delta t)} = w_{ij}^{(t)} \\cdot e^{-\\beta\\Delta t}$</li>\n</ul>\n<p><strong>\u6570\u5b66\u6027\u8d28\u5206\u6790</strong></p>\n<p>\u6307\u6570\u9057\u5fd8\u7684\u6709\u6548\u6837\u672c\u91cf\uff08Effective Sample Size, ESS\uff09\uff1a\n$$\\text{ESS}_t = \\frac{\\left(\\sum_{s=1}^t e^{-\\beta(t-s)}\\right)^2}{\\sum_{s=1}^t e^{-2\\beta(t-s)}} \\approx \\frac{1}{2\\beta}$$\n\u8fd9\u63d0\u4f9b\u4e86\u9009\u62e9 $\\beta$ \u7684\u7406\u8bba\u6307\u5bfc\uff1a\u82e5\u5e0c\u671b\u6709\u6548\u5229\u7528\u7ea6 $N$ \u4e2a\u65f6\u95f4\u5355\u4f4d\u7684\u5386\u53f2\u6570\u636e\uff0c\u5e94\u8bbe\u7f6e $\\beta \\approx 1/(2N)$\u3002</p>\n<p><strong>\u6ed1\u52a8\u7a97\u53e3\u65b9\u6cd5</strong></p>\n<p>\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u53ea\u8003\u8651\u6700\u8fd1 $W$ \u4e2a\u65f6\u95f4\u5355\u4f4d\u7684\u6570\u636e\uff1a\n$$w_{ij}^{(t)} = \\begin{cases} \n1 &amp; \\text{if } t - t_{ij} \\leq W \\\n0 &amp; \\text{otherwise}\n\\end{cases}$$\n\u8fd9\u79cd\u786c\u622a\u65ad\u867d\u7136\u7b80\u5355\uff0c\u4f46\u53ef\u80fd\u5bfc\u81f4\u4fe1\u606f\u7a81\u53d8\u3002\u5b9e\u8df5\u4e2d\u5e38\u7528\u8f6f\u7a97\u53e3\u53d8\u4f53\uff1a\n$$w_{ij}^{(t)} = \\sigma\\left(\\frac{W - (t - t_{ij})}{\\tau}\\right)$$\n\u5176\u4e2d $\\sigma$ \u662fsigmoid\u51fd\u6570\uff0c$\\tau$ \u63a7\u5236\u8fc7\u6e21\u7684\u5e73\u6ed1\u5ea6\u3002</p>\n<p><strong>\u5206\u6bb5\u7ebf\u6027\u9057\u5fd8</strong></p>\n<p>\u4ecb\u4e8e\u6307\u6570\u548c\u7a97\u53e3\u4e4b\u95f4\u7684\u6298\u4e2d\u65b9\u6848\uff1a\n$$w_{ij}^{(t)} = \\begin{cases}\n1 &amp; \\text{if } t - t_{ij} \\leq W_1 \\\n1 - \\alpha(t - t_{ij} - W_1)/(W_2 - W_1) &amp; \\text{if } W_1 &lt; t - t_{ij} \\leq W_2 \\\n1 - \\alpha &amp; \\text{if } t - t_{ij} &gt; W_2\n\\end{cases}$$\n\u8fd9\u79cd\u65b9\u6cd5\u4fdd\u7559\u8fd1\u671f\u6570\u636e\u7684\u5b8c\u6574\u6743\u91cd\uff0c\u5bf9\u4e2d\u671f\u6570\u636e\u7ebf\u6027\u8870\u51cf\uff0c\u5bf9\u8fdc\u671f\u6570\u636e\u4fdd\u6301\u6700\u5c0f\u6743\u91cd\u3002</p>\n<p><strong>\u81ea\u9002\u5e94\u9057\u5fd8\u6a21\u578b</strong></p>\n<p>\u66f4\u9ad8\u7ea7\u7684\u65b9\u6cd5\u662f\u8ba9\u9057\u5fd8\u7387\u968f\u6570\u636e\u7279\u6027\u52a8\u6001\u8c03\u6574\uff1a\n$$\\beta_{ij}(t) = \\beta_0 \\cdot f(\\text{volatility}_i, \\text{popularity}_j, \\text{sparsity}_{ij})$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\text{volatility}_i$ \u8861\u91cf\u7528\u6237\u5174\u8da3\u7684\u53d8\u5316\u901f\u5ea6</li>\n<li>$\\text{popularity}_j$ \u53cd\u6620\u7269\u54c1\u7684\u6d41\u884c\u5ea6\u8d8b\u52bf</li>\n<li>$\\text{sparsity}_{ij}$ \u8003\u8651\u6570\u636e\u7a00\u758f\u6027</li>\n</ul>\n<p><strong>\u6ce2\u52a8\u6027\u4f30\u8ba1</strong></p>\n<p>\u7528\u6237\u5174\u8da3\u6ce2\u52a8\u6027\u53ef\u901a\u8fc7\u6ed1\u52a8\u7a97\u53e3\u5185\u7684\u8bc4\u5206\u65b9\u5dee\u4f30\u8ba1\uff1a\n$$\\text{volatility}_i(t) = \\sqrt{\\frac{1}{|\\mathcal{W}_i|} \\sum_{(j,s) \\in \\mathcal{W}_i} (r_{ij}^{(s)} - \\bar{r}_i^{(t)})^2}$$\n\u5176\u4e2d $\\mathcal{W}_i$ \u662f\u7528\u6237 $i$ \u5728\u65f6\u95f4\u7a97\u53e3\u5185\u7684\u4ea4\u4e92\u96c6\u5408\u3002</p>\n<p><strong>\u591a\u5c3a\u5ea6\u9057\u5fd8</strong></p>\n<p>\u5b9e\u9645\u7cfb\u7edf\u4e2d\uff0c\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\u7684\u6a21\u5f0f\u5171\u5b58\uff1a\n$$w_{ij}^{(t)} = \\sum_{k=1}^K \\alpha_k \\exp(-\\beta_k(t - t_{ij}))$$\n\u5176\u4e2d $\\sum_k \\alpha_k = 1$\uff0c\u4e0d\u540c\u7684 $\\beta_k$ \u5bf9\u5e94\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\uff08\u5c0f\u65f6\u3001\u5929\u3001\u5468\u3001\u6708\uff09\u3002</p>\n<h3 id=\"1512-sgd\">15.1.2 \u589e\u91cfSGD\u7684\u6536\u655b\u6027\u5206\u6790</h3>\n<p>\u5bf9\u4e8e\u6d41\u5f0f\u6570\u636e $(i_t, j_t, r_t)$\uff0c\u6807\u51c6SGD\u66f4\u65b0\u4e3a\uff1a\n$$\\mathbf{u}_{i_t} \\leftarrow \\mathbf{u}_{i_t} - \\eta_t \\nabla_{\\mathbf{u}_{i_t}} \\ell_t$$\n$$\\mathbf{v}_{j_t} \\leftarrow \\mathbf{v}_{j_t} - \\eta_t \\nabla_{\\mathbf{v}_{j_t}} \\ell_t$$\n\u5176\u4e2d $\\ell_t = (r_t - \\mathbf{u}_{i_t}^T \\mathbf{v}_{j_t})^2 + \\lambda(|\\mathbf{u}_{i_t}|^2 + |\\mathbf{v}_{j_t}|^2)$\u3002</p>\n<p><strong>\u6536\u655b\u6027\u5b9a\u7406</strong>\uff08\u975e\u51f8\u60c5\u51b5\uff09</p>\n<p>\u5728\u4ee5\u4e0b\u6761\u4ef6\u4e0b\uff1a</p>\n<ol>\n<li>\u635f\u5931\u51fd\u6570 $\\ell_t$ \u662f $L$-\u5149\u6ed1\u7684</li>\n<li>\u68af\u5ea6\u6709\u754c\uff1a$|\\nabla \\ell_t| \\leq G$</li>\n<li>\u5b66\u4e60\u7387\u6ee1\u8db3\uff1a$\\eta_t = \\eta_0/\\sqrt{t}$</li>\n</ol>\n<p>\u5219\u589e\u91cfSGD\u6536\u655b\u5230\u7a33\u5b9a\u70b9\u7684\u901f\u7387\u4e3a\uff1a\n$$\\mathbb{E}\\left[\\frac{1}{T}\\sum_{t=1}^T |\\nabla \\mathcal{L}_t|^2\\right] = O\\left(\\frac{1}{\\sqrt{T}}\\right)$$\n<strong>\u6539\u8fdb\u7684\u6536\u655b\u6027\u5206\u6790</strong></p>\n<p>\u8003\u8651\u77e9\u9635\u5206\u89e3\u7684\u7279\u6b8a\u7ed3\u6784\uff0c\u53ef\u4ee5\u5f97\u5230\u66f4\u7d27\u7684\u754c\u3002\u5b9a\u4e49 Lyapunov \u51fd\u6570\uff1a\n$$V_t = |\\mathbf{U}_t - \\mathbf{U}^*|_F^2 + |\\mathbf{V}_t - \\mathbf{V}^*|_F^2$$\n\u5728\u9002\u5f53\u7684\u6b65\u957f\u6761\u4ef6\u4e0b\uff1a\n$$\\mathbb{E}[V_T] \\leq \\frac{V_0}{T^\\alpha} + O\\left(\\frac{\\sigma^2}{T^{1-\\alpha}}\\right)$$\n\u5176\u4e2d $\\alpha \\in (0.5, 1)$ \u53d6\u51b3\u4e8e\u95ee\u9898\u7684\u5f3a\u51f8\u6027\u7a0b\u5ea6\uff0c$\\sigma^2$ \u662f\u566a\u58f0\u65b9\u5dee\u3002</p>\n<p><strong>\u5e26\u9057\u5fd8\u7684SGD\u5206\u6790</strong></p>\n<p>\u8003\u8651\u6307\u6570\u9057\u5fd8\u6743\u91cd\uff0c\u4fee\u6b63\u7684\u66f4\u65b0\u89c4\u5219\u53d8\u4e3a\uff1a\n$$\\mathbf{u}_{i_t} \\leftarrow (1-\\gamma)\\mathbf{u}_{i_t} - \\eta_t e^{-\\beta(t-t_{ij})} \\nabla_{\\mathbf{u}_{i_t}} \\ell_t$$\n\u5176\u4e2d $\\gamma$ \u662f\u8870\u51cf\u56e0\u5b50\uff0c\u9632\u6b62\u5386\u53f2\u4fe1\u606f\u5b8c\u5168\u4e3b\u5bfc\u3002</p>\n<p><strong>\u8ffd\u8e2a\u8bef\u5dee\u5206\u6790</strong></p>\n<p>\u5728\u975e\u5e73\u7a33\u73af\u5883\u4e0b\uff0c\u5b9a\u4e49\u8ffd\u8e2a\u8bef\u5dee\uff1a\n$$\\text{TE}_T = \\frac{1}{T}\\sum_{t=1}^T |\\mathbf{U}_t\\mathbf{V}_t^T - \\mathbf{M}_t^*|_F^2$$\n\u5176\u4e2d $\\mathbf{M}_t^*$ \u662f\u65f6\u523b $t$ \u7684\u771f\u5b9e\u77e9\u9635\u3002\u53ef\u4ee5\u8bc1\u660e\uff1a\n$$\\mathbb{E}[\\text{TE}_T] \\leq O\\left(\\frac{1}{\\sqrt{T}}\\right) + O(\\beta) + O(\\Delta_T)$$\n\u5176\u4e2d $\\Delta_T$ \u8861\u91cf\u73af\u5883\u53d8\u5316\u901f\u5ea6\u3002\u8fd9\u8868\u660e\u9057\u5fd8\u7387 $\\beta$ \u9700\u8981\u5728\u9002\u5e94\u6027\u548c\u7a33\u5b9a\u6027\u4e4b\u95f4\u6743\u8861\u3002</p>\n<p><strong>\u65b9\u5dee\u51cf\u5c11\u6280\u672f</strong></p>\n<p>\u4e3a\u4e86\u52a0\u901f\u6536\u655b\uff0c\u53ef\u4ee5\u4f7f\u7528\u65b9\u5dee\u51cf\u5c11\u7684SGD\u53d8\u4f53\uff1a</p>\n<ol>\n<li>\n<p><strong>SVRG-style\u66f4\u65b0</strong>\uff1a\n$$\\mathbf{g}_t = \\nabla \\ell_t(\\mathbf{u}_t) - \\nabla \\ell_t(\\tilde{\\mathbf{u}}) + \\tilde{\\mathbf{g}}$$\n\u5176\u4e2d $\\tilde{\\mathbf{u}}$ \u662f\u5feb\u7167\u70b9\uff0c$\\tilde{\\mathbf{g}}$ \u662f\u5728\u5feb\u7167\u70b9\u7684\u5b8c\u6574\u68af\u5ea6\u3002</p>\n</li>\n<li>\n<p><strong>\u52a8\u91cf\u65b9\u6cd5</strong>\uff1a\n$$\\mathbf{m}_t = \\beta_1 \\mathbf{m}_{t-1} + (1-\\beta_1)\\nabla \\ell_t$$\n   $$\\mathbf{u}_t = \\mathbf{u}_{t-1} - \\eta_t \\mathbf{m}_t$$\n<strong>\u5173\u952e\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u975e\u51f8\u4f18\u5316\u7684\u5728\u7ebfregret\u754c\uff08\u7279\u522b\u662f\u77e9\u9635\u5206\u89e3\u7684\u4f4e\u79e9\u7ea6\u675f\uff09</li>\n<li>\u81ea\u9002\u5e94\u5b66\u4e60\u7387\uff08AdaGrad\u3001Adam\uff09\u5728\u77e9\u9635\u5206\u89e3\u4e2d\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u7a00\u758f\u6570\u636e\u6d41\u4e0b\u7684\u6837\u672c\u590d\u6742\u5ea6</li>\n<li>\u65f6\u53d8\u73af\u5883\u4e0b\u7684\u8ffd\u8e2a\u8bef\u5dee\uff08tracking error\uff09\u5206\u6790</li>\n<li>\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u901a\u4fe1\u590d\u6742\u5ea6\u4f18\u5316</li>\n<li>\u9690\u79c1\u4fdd\u62a4\u7ea6\u675f\u4e0b\u7684\u6536\u655b\u6027\uff08\u5dee\u5206\u9690\u79c1SGD\uff09</li>\n</ul>\n<h3 id=\"1513\">15.1.3 \u52a8\u6001\u6b63\u5219\u5316\u7b56\u7565</h3>\n<p>\u968f\u7740\u6570\u636e\u7d2f\u79ef\uff0c\u4e0d\u540c\u7528\u6237/\u7269\u54c1\u7684\u6837\u672c\u6570\u5dee\u5f02\u5de8\u5927\u3002\u52a8\u6001\u6b63\u5219\u5316\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\n$$\\lambda_i^{(t)} = \\lambda_0 / \\sqrt{n_i^{(t)} + 1}$$\n\u5176\u4e2d $n_i^{(t)}$ \u662f\u7528\u6237 $i$ \u5230\u65f6\u523b $t$ \u7684\u4ea4\u4e92\u6b21\u6570\u3002</p>\n<p><strong>\u7406\u8bba\u57fa\u7840</strong></p>\n<p>\u8fd9\u79cd\u8bbe\u8ba1\u57fa\u4e8e\u8d1d\u53f6\u65af\u89c2\u70b9\uff1a</p>\n<ul>\n<li>\u5148\u9a8c\uff1a$\\mathbf{u}_i \\sim \\mathcal{N}(0, \\sigma^2\\mathbf{I})$</li>\n<li>\u540e\u9a8c\u7cbe\u5ea6\u968f\u89c2\u6d4b\u6570\u589e\u52a0\uff1a$\\text{precision} \\propto n_i^{(t)}$</li>\n<li>\u7b49\u4ef7\u4e8e\u81ea\u9002\u5e94\u6b63\u5219\u5316</li>\n</ul>\n<p>\u66f4\u7cbe\u786e\u5730\uff0c\u540e\u9a8c\u5206\u5e03\u4e3a\uff1a\n$$p(\\mathbf{u}_i | \\mathcal{D}_i) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}|\\mathbf{u}_i|^2 - \\frac{1}{2\\sigma_r^2}\\sum_{j \\in \\mathcal{D}_i}(r_{ij} - \\mathbf{u}_i^T\\mathbf{v}_j)^2\\right)$$\n<strong>\u6cdb\u5316\u8bef\u5dee\u754c</strong></p>\n<p>\u52a8\u6001\u6b63\u5219\u5316\u7684\u6cdb\u5316\u6027\u80fd\u53ef\u4ee5\u901a\u8fc7PAC-Bayes\u7406\u8bba\u5206\u6790\uff1a\n$$\\mathbb{E}[\\mathcal{L}_{\\text{test}}] \\leq \\mathcal{L}_{\\text{train}} + O\\left(\\sqrt{\\frac{\\text{KL}(q|p) + \\log(1/\\delta)}{n}}\\right)$$\n\u5176\u4e2d KL \u6563\u5ea6\u9879\u53d7\u6b63\u5219\u5316\u63a7\u5236\u3002</p>\n<p><strong>\u591a\u5c3a\u5ea6\u6b63\u5219\u5316</strong></p>\n<p>\u8003\u8651\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\u7684\u884c\u4e3a\uff1a\n$$\\lambda_i^{(t)} = \\lambda_{\\text{long}} / \\sqrt{n_i^{\\text{all}}} + \\lambda_{\\text{short}} / \\sqrt{n_i^{\\text{recent}}}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$n_i^{\\text{all}}$ \u662f\u5386\u53f2\u603b\u4ea4\u4e92\u6570</li>\n<li>$n_i^{\\text{recent}}$ \u662f\u8fd1\u671f\uff08\u5982\u6700\u8fd17\u5929\uff09\u4ea4\u4e92\u6570</li>\n</ul>\n<p><strong>\u4fe1\u606f\u8bba\u89c6\u89d2</strong></p>\n<p>\u4ece\u6700\u5c0f\u63cf\u8ff0\u957f\u5ea6\uff08MDL\uff09\u539f\u7406\uff0c\u6700\u4f18\u6b63\u5219\u5316\u5e94\u5e73\u8861\u6a21\u578b\u590d\u6742\u5ea6\u548c\u6570\u636e\u62df\u5408\uff1a\n$$\\text{MDL} = -\\log p(\\mathcal{D}|\\mathbf{u}_i) + \\text{KL}(\\mathbf{u}_i | \\mathbf{u}_{\\text{prior}})$$\n\u8fd9\u5bfc\u51fa\u81ea\u9002\u5e94\u6b63\u5219\u5316\uff1a\n$$\\lambda_i^{(t)} = \\frac{\\sigma_r^2}{\\sigma^2} \\cdot \\frac{1}{n_i^{(t)}}$$\n<strong>\u7a00\u758f\u611f\u77e5\u6b63\u5219\u5316</strong></p>\n<p>\u5bf9\u4e8e\u6781\u7a00\u758f\u7528\u6237\uff0c\u6807\u51c6\u6b63\u5219\u5316\u53ef\u80fd\u8fc7\u5f3a\u3002\u4e00\u79cd\u6539\u8fdb\u662f\uff1a\n$$\\lambda_i^{(t)} = \\lambda_0 \\cdot \\left(\\frac{n_{\\text{median}}}{n_i^{(t)} + n_{\\text{median}}}\\right)^\\alpha$$\n\u5176\u4e2d $n_{\\text{median}}$ \u662f\u4e2d\u4f4d\u6570\u4ea4\u4e92\u6b21\u6570\uff0c$\\alpha \\in [0.5, 1]$ \u63a7\u5236\u8c03\u6574\u5f3a\u5ea6\u3002</p>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u9632\u6b62\u9664\u96f6\u9519\u8bef\uff1a\u4f7f\u7528 $n_i^{(t)} + \\epsilon$\uff0c$\\epsilon \\sim 0.1$</li>\n<li>\u6b63\u5219\u5316\u53c2\u6570\u7684\u4e0a\u4e0b\u754c\u9650\u5236\uff1a$\\lambda_{\\min} \\leq \\lambda_i^{(t)} \\leq \\lambda_{\\max}$</li>\n<li>\u589e\u91cf\u7edf\u8ba1\u91cf\u7684\u7cbe\u786e\u7ef4\u62a4\uff1a\u4f7f\u7528Welford\u7b97\u6cd5\u8ba1\u7b97\u5728\u7ebf\u5747\u503c\u548c\u65b9\u5dee</li>\n<li>\u6570\u503c\u4e0b\u6ea2\u5904\u7406\uff1a\u5bf9\u6781\u5c0f\u7684\u6b63\u5219\u5316\u503c\u4f7f\u7528\u5bf9\u6570\u7a7a\u95f4\u8ba1\u7b97</li>\n<li>\u6761\u4ef6\u6570\u76d1\u63a7\uff1a\u786e\u4fdd $\\kappa(\\mathbf{A}_i) &lt; \\kappa_{\\max}$</li>\n</ul>\n<h3 id=\"1514\">15.1.4 \u6df7\u5408\u9057\u5fd8\u7b56\u7565</h3>\n<p>\u5b9e\u8df5\u4e2d\uff0c\u5355\u4e00\u9057\u5fd8\u673a\u5236\u5f80\u5f80\u4e0d\u591f\u7075\u6d3b\u3002\u6df7\u5408\u7b56\u7565\u7ed3\u5408\u591a\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\uff1a</p>\n<p><strong>\u5206\u5c42\u9057\u5fd8\u6a21\u578b</strong>\n$$w_{ij}^{(t)} = \\alpha \\cdot w_{\\text{exp}}^{(t)} + (1-\\alpha) \\cdot w_{\\text{window}}^{(t)}$$\n\u5176\u4e2d $\\alpha$ \u53ef\u4ee5\u81ea\u9002\u5e94\u8c03\u6574\uff1a\n$$\\alpha(t) = \\sigma\\left(\\frac{\\text{MSE}_{\\text{exp}} - \\text{MSE}_{\\text{window}}}{\\tau}\\right)$$\n<strong>\u5728\u7ebf\u6a21\u578b\u9009\u62e9</strong></p>\n<p>\u4f7f\u7528\u4e13\u5bb6\u7b97\u6cd5\uff08Multiplicative Weights\uff09\u52a8\u6001\u9009\u62e9\u6700\u4f73\u9057\u5fd8\u7b56\u7565\uff1a\n$$p_k^{(t+1)} = \\frac{p_k^{(t)} \\exp(-\\eta L_k^{(t)})}{\\sum_{k'} p_{k'}^{(t)} \\exp(-\\eta L_{k'}^{(t)})}$$\n\u5176\u4e2d $L_k^{(t)}$ \u662f\u7b56\u7565 $k$ \u7684\u7d2f\u79ef\u635f\u5931\uff0c$p_k^{(t)}$ \u662f\u9009\u62e9\u6982\u7387\u3002</p>\n<p><strong>\u4e8b\u4ef6\u9a71\u52a8\u9057\u5fd8</strong></p>\n<p>\u67d0\u4e9b\u4e8b\u4ef6\uff08\u5982\u8282\u5047\u65e5\u3001\u4fc3\u9500\uff09\u4f1a\u5bfc\u81f4\u7528\u6237\u884c\u4e3a\u7a81\u53d8\uff1a\n$$\\beta(t) = \\begin{cases}\n\\beta_{\\text{normal}} &amp; \\text{\u5e38\u89c4\u65f6\u671f} \\\n\\beta_{\\text{fast}} &amp; \\text{\u4e8b\u4ef6\u671f\u95f4} \\\n\\beta_{\\text{recovery}} &amp; \\text{\u4e8b\u4ef6\u540e\u6062\u590d\u671f}\n\\end{cases}$$\n<strong>\u53d8\u70b9\u68c0\u6d4b\u7b97\u6cd5</strong></p>\n<p>\u4f7f\u7528\u8d1d\u53f6\u65af\u5728\u7ebf\u53d8\u70b9\u68c0\u6d4b\uff08BOCD\uff09\uff1a\n$$p(r_t | r_{1:t-1}) = \\sum_{\\tau} p(r_t | r_{\\tau:t-1}) p(\\tau | r_{1:t-1})$$\n\u5176\u4e2d $\\tau$ \u662f\u6700\u8fd1\u53d8\u70b9\u7684\u4f4d\u7f6e\u3002</p>\n<p><strong>\u7814\u7a76\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u52a8\u68c0\u6d4b\u884c\u4e3a\u6a21\u5f0f\u53d8\u5316\u70b9</li>\n<li>\u591a\u7528\u6237\u7fa4\u4f53\u7684\u5dee\u5f02\u5316\u9057\u5fd8\u7b56\u7565</li>\n<li>\u9057\u5fd8\u673a\u5236\u4e0e\u63a8\u8350\u591a\u6837\u6027\u7684\u5173\u7cfb</li>\n<li>\u5bf9\u6297\u6027\u73af\u5883\u4e0b\u7684\u9c81\u68d2\u9057\u5fd8</li>\n</ul>\n<h3 id=\"1515\">15.1.5 \u7406\u8bba\u4fdd\u8bc1\u4e0e\u4f18\u5316\u754c</h3>\n<p><strong>\u7ade\u4e89\u6bd4\u5206\u6790</strong></p>\n<p>\u5b9a\u4e49\u5728\u7ebf\u7b97\u6cd5\u7684\u7ade\u4e89\u6bd4\uff1a\n$$\\rho = \\sup_{\\text{sequence}} \\frac{\\text{ALG}_{\\text{online}}}{\\text{OPT}_{\\text{offline}}}$$\n\u5bf9\u4e8e\u6307\u6570\u9057\u5fd8\u7684\u5728\u7ebf\u77e9\u9635\u5206\u89e3\uff1a\n$$\\rho \\leq 1 + O(\\sqrt{\\beta T})$$\n\u8fd9\u8868\u660e\u9057\u5fd8\u7387 $\\beta$ \u4e0d\u80fd\u592a\u5927\u3002</p>\n<p><strong>Regret\u754c</strong></p>\n<p>\u8003\u8651\u4e0e\u6700\u4f73\u56fa\u5b9a\u9057\u5fd8\u7387\u7684\u6bd4\u8f83\uff1a\n$$R_T = \\sum_{t=1}^T \\ell_t^{\\beta_t} - \\min_{\\beta^*} \\sum_{t=1}^T \\ell_t^{\\beta^*}$$\n\u4f7f\u7528\u5728\u7ebf\u955c\u50cf\u4e0b\u964d\u53ef\u5f97\uff1a\n$$R_T \\leq O(\\sqrt{T \\log K})$$\n\u5176\u4e2d $K$ \u662f\u5019\u9009\u9057\u5fd8\u7387\u7684\u6570\u91cf\u3002</p>\n<p><strong>\u6837\u672c\u590d\u6742\u5ea6</strong></p>\n<p>\u8fbe\u5230 $\\epsilon$-\u8fd1\u4f3c\u89e3\u9700\u8981\u7684\u6837\u672c\u6570\uff1a\n$$m = O\\left(\\frac{r(n_1 + n_2)\\log(1/\\epsilon)}{\\epsilon^2} \\cdot \\frac{1}{1-e^{-\\beta T}}\\right)$$\n\u9057\u5fd8\u673a\u5236\u589e\u52a0\u4e86\u6709\u6548\u6837\u672c\u590d\u6742\u5ea6\u3002</p>\n<p><strong>\u8ba1\u7b97-\u7edf\u8ba1\u6743\u8861</strong></p>\n<p>\u5b9a\u4e49\u8ba1\u7b97\u9884\u7b97\u7ea6\u675f\u4e0b\u7684\u8fd1\u4f3c\u8bef\u5dee\uff1a\n$$\\text{Error}(T, B) = \\underbrace{O(1/\\sqrt{T})}_{\\text{\u7edf\u8ba1\u8bef\u5dee}} + \\underbrace{O(B^{-\\gamma})}_{\\text{\u8ba1\u7b97\u8bef\u5dee}}$$\n\u5176\u4e2d $B$ \u662f\u8ba1\u7b97\u9884\u7b97\uff0c$\\gamma$ \u53d6\u51b3\u4e8e\u7b97\u6cd5\u6548\u7387\u3002</p>\n<h2 id=\"152\">15.2 \u7528\u6237/\u7269\u54c1\u5d4c\u5165\u7684\u5feb\u901f\u66f4\u65b0</h2>\n<h3 id=\"1521-sherman-morrison\">15.2.1 \u79e9\u4e00\u66f4\u65b0\u7684Sherman-Morrison\u516c\u5f0f</h3>\n<p>\u5f53\u65b0\u589e\u4e00\u4e2a\u8bc4\u5206\u65f6\uff0c\u53ef\u4ee5\u5229\u7528\u79e9\u4e00\u66f4\u65b0\u907f\u514d\u5b8c\u5168\u91cd\u65b0\u8ba1\u7b97\u3002\u8fd9\u5728\u5b9e\u65f6\u7cfb\u7edf\u4e2d\u81f3\u5173\u91cd\u8981\uff0c\u5c06\u66f4\u65b0\u590d\u6742\u5ea6\u4ece $O(r^3)$ \u964d\u81f3 $O(r^2)$\u3002</p>\n<p>\u7ed9\u5b9a $\\mathbf{A} = \\mathbf{X}^T\\mathbf{X} + \\lambda\\mathbf{I}$\uff0c\u65b0\u589e\u6837\u672c $(\\mathbf{x}, y)$ \u540e\uff1a\n$$\\mathbf{A}' = \\mathbf{A} + \\mathbf{x}\\mathbf{x}^T$$\n\u5229\u7528Sherman-Morrison\u516c\u5f0f\uff1a\n$$(\\mathbf{A}')^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{x}\\mathbf{x}^T\\mathbf{A}^{-1}}{1 + \\mathbf{x}^T\\mathbf{A}^{-1}\\mathbf{x}}$$\n<strong>\u6570\u503c\u7a33\u5b9a\u6027\u589e\u5f3a</strong></p>\n<p>\u6807\u51c6Sherman-Morrison\u516c\u5f0f\u5728 $1 + \\mathbf{x}^T\\mathbf{A}^{-1}\\mathbf{x} \\approx 0$ \u65f6\u4e0d\u7a33\u5b9a\u3002\u7a33\u5b9a\u7248\u672c\uff1a\n$$(\\mathbf{A}')^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{u}\\mathbf{u}^T}{1 + |\\mathbf{u}|^2}$$\n\u5176\u4e2d $\\mathbf{u} = \\mathbf{A}^{-1/2}\\mathbf{x}$</p>\n<p><strong>\u57fa\u4e8eCholesky\u5206\u89e3\u7684\u7a33\u5b9a\u5b9e\u73b0</strong></p>\n<p>\u7ef4\u62a4Cholesky\u5206\u89e3 $\\mathbf{A} = \\mathbf{L}\\mathbf{L}^T$\uff0c\u66f4\u65b0\u8fc7\u7a0b\uff1a</p>\n<ol>\n<li>\u6c42\u89e3 $\\mathbf{L}\\mathbf{w} = \\mathbf{x}$\uff0c\u5f97\u5230 $\\mathbf{w}$</li>\n<li>\u8ba1\u7b97 $\\alpha = \\sqrt{1 + |\\mathbf{w}|^2}$</li>\n<li>\u66f4\u65b0 $\\mathbf{L}' = \\begin{bmatrix} \\mathbf{L} &amp; \\mathbf{0} \\ \\mathbf{w}^T &amp; \\alpha \\end{bmatrix}$</li>\n</ol>\n<p>\u8fd9\u79cd\u65b9\u6cd5\u6570\u503c\u7a33\u5b9a\u4e14\u4fdd\u6301\u6b63\u5b9a\u6027\u3002</p>\n<p><strong>\u5220\u9664\u64cd\u4f5c\u7684\u5904\u7406</strong></p>\n<p>\u5f53\u9700\u8981\u5220\u9664\u65e7\u6570\u636e\uff08\u9057\u5fd8\uff09\u65f6\uff0c\u4f7f\u7528\u51cf\u6cd5\u7248\u672c\uff1a\n$$(\\mathbf{A} - \\mathbf{x}\\mathbf{x}^T)^{-1} = \\mathbf{A}^{-1} + \\frac{\\mathbf{A}^{-1}\\mathbf{x}\\mathbf{x}^T\\mathbf{A}^{-1}}{1 - \\mathbf{x}^T\\mathbf{A}^{-1}\\mathbf{x}}$$\n\u6ce8\u610f\uff1a\u9700\u8981\u68c0\u67e5 $\\mathbf{x}^T\\mathbf{A}^{-1}\\mathbf{x} &lt; 1$ \u4ee5\u4fdd\u8bc1\u6b63\u5b9a\u6027\u3002</p>\n<p><strong>\u52a0\u6743\u66f4\u65b0\u6269\u5c55</strong></p>\n<p>\u5bf9\u4e8e\u5e26\u65f6\u95f4\u6743\u91cd\u7684\u66f4\u65b0\uff1a\n$$\\mathbf{A}' = \\mathbf{A} + w_t \\mathbf{x}\\mathbf{x}^T$$\n\u4fee\u6b63\u7684Sherman-Morrison\u516c\u5f0f\uff1a\n$$(\\mathbf{A}')^{-1} = \\mathbf{A}^{-1} - \\frac{w_t \\mathbf{A}^{-1}\\mathbf{x}\\mathbf{x}^T\\mathbf{A}^{-1}}{1 + w_t \\mathbf{x}^T\\mathbf{A}^{-1}\\mathbf{x}}$$\n<strong>\u5e94\u7528\u4e8e\u77e9\u9635\u5206\u89e3</strong></p>\n<p>\u5bf9\u4e8e\u7528\u6237\u5d4c\u5165\u66f4\u65b0\uff1a\n$$\\mathbf{u}_i = (\\mathbf{V}_{\\Omega_i}^T\\mathbf{V}_{\\Omega_i} + \\lambda\\mathbf{I})^{-1}\\mathbf{V}_{\\Omega_i}^T\\mathbf{r}_i$$\n\u65b0\u589e\u8bc4\u5206 $(i,j,r_{ij})$ \u540e\uff0c\u53ea\u9700\u66f4\u65b0\uff1a</p>\n<ol>\n<li>$\\mathbf{A}_i' = \\mathbf{A}_i + \\mathbf{v}_j\\mathbf{v}_j^T$</li>\n<li>$\\mathbf{b}_i' = \\mathbf{b}_i + r_{ij}\\mathbf{v}_j$</li>\n<li>$\\mathbf{u}_i' = (\\mathbf{A}_i')^{-1}\\mathbf{b}_i'$</li>\n</ol>\n<p><strong>\u8bef\u5dee\u7d2f\u79ef\u5206\u6790</strong></p>\n<p>\u7ecf\u8fc7 $k$ \u6b21\u66f4\u65b0\u540e\u7684\u8bef\u5dee\u754c\uff1a\n$$|(\\mathbf{A}_k)^{-1} - (\\mathbf{A}_k)^{-1}_{\\text{exact}}|_F \\leq k \\epsilon_{\\text{machine}} \\kappa(\\mathbf{A}_0)^2$$\n\u5efa\u8bae\u6bcf $O(1/\\epsilon_{\\text{machine}})$ \u6b21\u66f4\u65b0\u540e\u91cd\u65b0\u8ba1\u7b97\u7cbe\u786e\u9006\u3002</p>\n<p><strong>\u7f13\u5b58\u53cb\u597d\u7684\u5b9e\u73b0</strong></p>\n<p>\u4e3a\u4e86\u4f18\u5316\u7f13\u5b58\u6027\u80fd\uff0c\u4f7f\u7528\u5206\u5757\u66f4\u65b0\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">BlockSize</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">32</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">L1</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">line</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">block</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"nl\">blocks</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"n\">prefetch</span><span class=\"p\">(</span><span class=\"n\">A_inv</span><span class=\"o\">[</span><span class=\"n\">block</span><span class=\"o\">]</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">update</span><span class=\"p\">(</span><span class=\"n\">A_inv</span><span class=\"o\">[</span><span class=\"n\">block</span><span class=\"o\">]</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<h3 id=\"1522\">15.2.2 \u5757\u66f4\u65b0\u4e0e\u5e76\u884c\u5316</h3>\n<p>\u5bf9\u4e8e\u6279\u91cf\u66f4\u65b0\uff0cWoodbury\u77e9\u9635\u6052\u7b49\u5f0f\u63d0\u4f9b\u4e86\u9ad8\u6548\u65b9\u6848\uff1a\n$$(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{U}(\\mathbf{C}^{-1} + \\mathbf{V}^T\\mathbf{A}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{A}^{-1}$$\n<strong>\u6279\u91cf\u8bc4\u5206\u66f4\u65b0</strong></p>\n<p>\u5f53\u540c\u65f6\u5230\u8fbe $k$ \u4e2a\u65b0\u8bc4\u5206\u65f6\uff1a</p>\n<ul>\n<li>$\\mathbf{U} = [\\mathbf{v}_{j_1}, ..., \\mathbf{v}_{j_k}]$</li>\n<li>$\\mathbf{C} = \\text{diag}(1, ..., 1)$</li>\n<li>$\\mathbf{V} = \\mathbf{U}$</li>\n</ul>\n<p>\u590d\u6742\u5ea6\uff1a$O(r^2k + k^3)$\uff0c\u5f53 $k \\ll r$ \u65f6\u9ad8\u6548\u3002</p>\n<p><strong>\u4f18\u5316\u7684Woodbury\u5b9e\u73b0</strong></p>\n<p>\u4e3a\u907f\u514d\u6570\u503c\u4e0d\u7a33\u5b9a\uff0c\u4f7f\u7528QR\u5206\u89e3\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97 $\\mathbf{Q}\\mathbf{R} = \\mathbf{A}^{-1/2}\\mathbf{U}$</li>\n<li>\u5f62\u6210 $\\mathbf{S} = \\mathbf{C}^{-1} + \\mathbf{R}^T\\mathbf{R}$</li>\n<li>Cholesky\u5206\u89e3 $\\mathbf{S} = \\mathbf{L}_S\\mathbf{L}_S^T$</li>\n<li>\u66f4\u65b0 $(\\mathbf{A}')^{-1} = \\mathbf{A}^{-1} - \\mathbf{Q}(\\mathbf{L}_S^{-T}\\mathbf{L}_S^{-1})\\mathbf{Q}^T$</li>\n</ol>\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong></p>\n<ol>\n<li>\n<p><strong>\u7528\u6237\u7ea7\u5e76\u884c</strong>\uff1a\u4e0d\u540c\u7528\u6237\u7684\u5d4c\u5165\u53ef\u72ec\u7acb\u66f4\u65b0\n   <code>parallel for each user i:\n       update A_i and u_i</code></p>\n</li>\n<li>\n<p><strong>\u6279\u5185\u5e76\u884c</strong>\uff1a\u5229\u7528\u77e9\u9635\u4e58\u6cd5\u7684\u5e76\u884c\u6027\n   - BLAS Level 3\u64cd\u4f5c\uff1a<code>gemm</code>, <code>syrk</code>\n   - GPU\u52a0\u901f\uff1a\u9002\u5408\u5927\u6279\u91cf\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong>\uff1a\n   - Stage 1: \u6536\u96c6\u66f4\u65b0\uff0c\u5f62\u6210\u6279\n   - Stage 2: \u8ba1\u7b97\u77e9\u9635\u66f4\u65b0\n   - Stage 3: \u66f4\u65b0\u5d4c\u5165\u5411\u91cf</p>\n</li>\n</ol>\n<p><strong>\u7ec6\u7c92\u5ea6\u5e76\u884c\u4f18\u5316</strong></p>\n<p>\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\u907f\u514d\u9501\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">atomic_add</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">i,j</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">delta</span><span class=\"p\">)</span>\n<span class=\"n\">memory_fence</span><span class=\"p\">()</span>\n<span class=\"n\">atomic_add</span><span class=\"p\">(</span><span class=\"n\">b</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"n\">j</span><span class=\"o\">]</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>NUMA\u611f\u77e5\u7684\u6570\u636e\u5e03\u5c40</strong></p>\n<p>\u5728\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e2d\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>UserData {\n    A_inv: aligned to NUMA node\n    embeddings: interleaved across nodes\n    update_queue: per-node queue\n}\n</code></pre></div>\n\n<p><strong>\u6279\u5927\u5c0f\u7684\u81ea\u9002\u5e94\u8c03\u6574</strong></p>\n<p>\u6839\u636e\u7cfb\u7edf\u8d1f\u8f7d\u52a8\u6001\u8c03\u6574\uff1a\n$$k_{\\text{opt}} = \\arg\\min_k \\left(\\frac{T_{\\text{collect}}(k)}{k} + T_{\\text{compute}}(k)\\right)$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$T_{\\text{collect}}(k)$ \u662f\u6536\u96c6 $k$ \u4e2a\u66f4\u65b0\u7684\u65f6\u95f4</li>\n<li>$T_{\\text{compute}}(k) = O(r^2k + k^3)$ \u662f\u8ba1\u7b97\u65f6\u95f4</li>\n</ul>\n<p><strong>\u5b9e\u73b0\u8981\u70b9</strong>\uff1a</p>\n<ul>\n<li>\u7f13\u5b58 $\\mathbf{A}^{-1}$ \u7684\u5206\u89e3\u5f62\u5f0f\uff08\u5982Cholesky\uff09</li>\n<li>\u5f02\u6b65\u66f4\u65b0\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1\uff1a\u4f7f\u7528\u7248\u672c\u63a7\u5236</li>\n<li>\u6570\u503c\u8bef\u5dee\u7d2f\u79ef\u7684\u5b9a\u671f\u4fee\u6b63\uff1a\u6bcf $N$ \u6b21\u66f4\u65b0\u540e\u91cd\u65b0\u8ba1\u7b97</li>\n<li>\u5185\u5b58\u5c40\u90e8\u6027\u4f18\u5316\uff1a\u6309\u7528\u6237\u5206\u7ec4\u5b58\u50a8\u76f8\u5173\u77e9\u9635</li>\n<li>\u4f7f\u7528\u5185\u5b58\u6c60\u51cf\u5c11\u5206\u914d\u5f00\u9500</li>\n</ul>\n<h3 id=\"1523\">15.2.3 \u61d2\u60f0\u6c42\u503c\u4e0e\u7f13\u5b58\u7b56\u7565</h3>\n<p>\u4e0d\u662f\u6240\u6709\u5d4c\u5165\u90fd\u9700\u8981\u5b9e\u65f6\u66f4\u65b0\u3002\u61d2\u60f0\u6c42\u503c\u7b56\u7565\u5927\u5e45\u51cf\u5c11\u8ba1\u7b97\u91cf\uff1a</p>\n<p><strong>\u4e09\u7ea7\u66f4\u65b0\u7b56\u7565</strong></p>\n<ol>\n<li>\n<p><strong>\u7acb\u5373\u66f4\u65b0</strong>\uff08\u70ed\u7528\u6237\uff09\uff1a\n   - \u6d3b\u8dc3\u7528\u6237\uff08\u6700\u8fd11\u5c0f\u65f6\u6709\u4ea4\u4e92\uff09\n   - \u9ad8\u4ef7\u503c\u7528\u6237\uff08VIP\u3001\u4ed8\u8d39\u7528\u6237\uff09\n   - \u66f4\u65b0\u5ef6\u8fdf &lt; 100ms</p>\n</li>\n<li>\n<p><strong>\u5ef6\u8fdf\u66f4\u65b0</strong>\uff08\u6e29\u7528\u6237\uff09\uff1a\n   - \u5468\u671f\u6027\u6d3b\u8dc3\u7528\u6237\n   - \u6279\u91cf\u805a\u5408\u540e\u66f4\u65b0\n   - \u66f4\u65b0\u5ef6\u8fdf &lt; 1\u5206\u949f</p>\n</li>\n<li>\n<p><strong>\u61d2\u60f0\u66f4\u65b0</strong>\uff08\u51b7\u7528\u6237\uff09\uff1a\n   - \u4f4e\u6d3b\u8dc3\u7528\u6237\n   - \u4ec5\u5728\u67e5\u8be2\u65f6\u66f4\u65b0\n   - \u53ef\u63a5\u53d7\u9648\u65e7\u7ed3\u679c</p>\n</li>\n</ol>\n<p><strong>\u667a\u80fd\u7f13\u5b58\u7ba1\u7406</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>CacheEntry {\n    embedding: Vector\n    last_update: Timestamp\n    pending_updates: Queue&lt;Update&gt;\n    access_count: int\n    update_cost: float\n}\n</code></pre></div>\n\n<p><strong>\u66f4\u65b0\u51b3\u7b56\u51fd\u6570</strong>\uff1a\n$$\\text{should_update} = \\frac{\\text{staleness} \\times \\text{importance}}{\\text{update_cost}} &gt; \\theta$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\text{staleness} = t_{\\text{now}} - t_{\\text{last_update}}$</li>\n<li>$\\text{importance} = f(\\text{access_frequency}, \\text{user_value})$</li>\n<li>$\\text{update_cost}$ \u8003\u8651\u8ba1\u7b97\u590d\u6742\u5ea6\u548c\u5f53\u524d\u8d1f\u8f7d</li>\n</ul>\n<p><strong>\u6210\u672c\u6a21\u578b</strong></p>\n<p>\u66f4\u7cbe\u786e\u7684\u66f4\u65b0\u6210\u672c\u4f30\u8ba1\uff1a\n$$\\text{cost}(i) = c_{\\text{compute}} \\cdot |\\Omega_i| + c_{\\text{memory}} \\cdot r^2 + c_{\\text{sync}}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$c_{\\text{compute}}$ \u662f\u6bcf\u4e2a\u6837\u672c\u7684\u8ba1\u7b97\u6210\u672c</li>\n<li>$c_{\\text{memory}}$ \u662f\u5185\u5b58\u8bbf\u95ee\u6210\u672c</li>\n<li>$c_{\\text{sync}}$ \u662f\u540c\u6b65\u5f00\u9500</li>\n</ul>\n<p><strong>LRU-K\u7f13\u5b58\u7b56\u7565</strong></p>\n<p>\u8003\u8651\u8bbf\u95ee\u6a21\u5f0f\u7684\u65f6\u95f4\u5c40\u90e8\u6027\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>access_score(i) = \u03a3_{k=1}^K w_k * time_since_kth_access(i)\nevict_score(i) = staleness(i) / access_score(i)\n</code></pre></div>\n\n<p><strong>\u7248\u672c\u5316\u7f13\u5b58</strong></p>\n<p>\u652f\u6301\u591a\u7248\u672c\u8bfb\u53d6\uff0c\u907f\u514d\u66f4\u65b0\u963b\u585e\u67e5\u8be2\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>VersionedEmbedding {\n    versions: RingBuffer&lt;(Version, Embedding)&gt;\n    current_version: AtomicInt\n}\n</code></pre></div>\n\n<p><strong>\u8fd1\u4f3c\u66f4\u65b0\u7406\u8bba</strong></p>\n<p>\u5b9a\u4e49\u8fd1\u4f3c\u56e0\u5b50 $\\alpha$\uff1a\n$$\\mathbf{u}_{\\text{approx}} = \\alpha \\mathbf{u}_{\\text{old}} + (1-\\alpha) \\mathbf{u}_{\\text{increment}}$$\n\u8bef\u5dee\u754c\uff1a\n$$|\\mathbf{u}_{\\text{approx}} - \\mathbf{u}_{\\text{exact}}| \\leq \\frac{\\alpha}{1-\\alpha} \\cdot |\\Delta \\mathbf{u}|$$\n<strong>\u5206\u5c42\u7f13\u5b58\u67b6\u6784</strong></p>\n<ol>\n<li><strong>L1\u7f13\u5b58</strong>\uff1a\u6700\u70ed\u7684\u5d4c\u5165\uff0c\u5b8c\u5168\u5728\u5185\u5b58</li>\n<li><strong>L2\u7f13\u5b58</strong>\uff1aSSD\u5b58\u50a8\uff0c\u6beb\u79d2\u7ea7\u8bbf\u95ee</li>\n<li><strong>L3\u5b58\u50a8</strong>\uff1a\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u7528\u4e8e\u51b7\u6570\u636e</li>\n</ol>\n<p>\u7f13\u5b58\u63d0\u5347\u51b3\u7b56\uff1a\n$$\\text{promote}(i) = \\frac{\\text{access_rate}(i) \\times \\text{value}(i)}{\\text{size}(i)} &gt; \\tau_{\\text{level}}$$\n<strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a</p>\n<ul>\n<li>\u7f13\u5b58\u547d\u4e2d\u7387\u4e0e\u63a8\u8350\u8d28\u91cf\u7684\u6743\u8861</li>\n<li>\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u7f13\u5b58\u4e00\u81f4\u6027\uff08\u4f7f\u7528Raft\u6216Paxos\uff09</li>\n<li>\u8fd1\u4f3c\u66f4\u65b0\u7684\u8bef\u5dee\u754c\uff1a$|\\mathbf{u}_{\\text{approx}} - \\mathbf{u}_{\\text{exact}}| \\leq \\epsilon$</li>\n<li>\u81ea\u9002\u5e94\u7f13\u5b58\u5927\u5c0f\uff1a\u57fa\u4e8e\u5185\u5b58\u538b\u529b\u548c\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>\u673a\u5668\u5b66\u4e60\u9884\u6d4b\u7684\u7f13\u5b58\u9884\u53d6</li>\n</ul>\n<h3 id=\"1524\">15.2.4 \u589e\u91cf\u77e9\u9635\u5206\u89e3\u7684\u5e76\u884c\u7b97\u6cd5</h3>\n<p><strong>Lock-Free\u66f4\u65b0\u7b97\u6cd5</strong></p>\n<p>\u907f\u514d\u9501\u7ade\u4e89\u7684\u65e0\u9501\u66f4\u65b0\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">AtomicUpdate</span><span class=\"p\">(</span><span class=\"nf\">user_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">item_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">rating</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">    </span><span class=\"nl\">loop</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"n\">old_A</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">load</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">user_id</span><span class=\"o\">]</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">new_A</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">old_A</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"n\">item_id</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">[</span><span class=\"n\">item_id</span><span class=\"o\">]</span><span class=\"err\">&#39;</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">CAS</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">user_id</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">old_A</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">new_A</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">            </span><span class=\"k\">break</span>\n</code></pre></div>\n\n<p><strong>Compare-And-Swap\u4f18\u5316</strong></p>\n<p>\u4f7f\u7528\u53cc\u91cd\u68c0\u67e5\u51cf\u5c11CAS\u5931\u8d25\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">FastUpdate</span><span class=\"p\">(</span><span class=\"nf\">user_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">item_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">rating</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">    </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">load</span><span class=\"p\">(</span><span class=\"n\">version</span><span class=\"o\">[</span><span class=\"n\">user_id</span><span class=\"o\">]</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">new_A</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">compute_update</span><span class=\"p\">(...)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"k\">load</span><span class=\"p\">(</span><span class=\"n\">version</span><span class=\"o\">[</span><span class=\"n\">user_id</span><span class=\"o\">]</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"nl\">expected</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">CAS</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">user_id</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">old_A</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">new_A</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">            </span><span class=\"n\">increment</span><span class=\"p\">(</span><span class=\"n\">version</span><span class=\"o\">[</span><span class=\"n\">user_id</span><span class=\"o\">]</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>\u5f02\u6b65SGD\u7684\u7406\u8bba\u4fdd\u8bc1</strong></p>\n<p>\u5728\u5ef6\u8fdf $\\tau$ \u6709\u754c\u7684\u60c5\u51b5\u4e0b\uff1a\n$$\\mathbb{E}[|\\mathbf{u}_T - \\mathbf{u}^*|^2] \\leq O\\left(\\frac{1}{\\sqrt{T}} + \\frac{\\tau}{T}\\right)$$\n\u8fd9\u8868\u660e\u9002\u5ea6\u7684\u5f02\u6b65\u4e0d\u4f1a\u663e\u8457\u5f71\u54cd\u6536\u655b\u6027\u3002</p>\n<p><strong>Hogwild!\u7b97\u6cd5\u5206\u6790</strong></p>\n<p>\u5bf9\u4e8e\u7a00\u758f\u6570\u636e\uff0c\u65e0\u9501\u5e76\u884cSGD\u7684\u6536\u655b\u901f\u7387\uff1a\n$$\\mathbb{E}[\\mathcal{L}_T] - \\mathcal{L}^* \\leq O\\left(\\frac{L\\sigma^2}{T} + \\frac{L^2\\tau^2\\sigma^2}{T^2}\\right)$$\n\u5176\u4e2d $L$ \u662fLipschitz\u5e38\u6570\uff0c$\\sigma^2$ \u662f\u68af\u5ea6\u65b9\u5dee\u3002</p>\n<p><strong>\u5ef6\u8fdf\u8865\u507f\u673a\u5236</strong></p>\n<p>\u8003\u8651\u68af\u5ea6\u5ef6\u8fdf\u7684\u5f71\u54cd\uff1a\n$$\\mathbf{g}_{\\text{comp}} = \\mathbf{g}_t + \\sum_{s=t-\\tau}^{t-1} \\mathbf{H}_s (\\mathbf{w}_s - \\mathbf{w}_{t-\\tau-1})$$\n\u5176\u4e2d $\\mathbf{H}_s$ \u662fHessian\u8fd1\u4f3c\u3002</p>\n<p><strong>\u5206\u5e03\u5f0f\u5feb\u7167</strong></p>\n<p>\u4f7f\u7528Chandy-Lamport\u7b97\u6cd5\u5b9e\u73b0\u4e00\u81f4\u6027\u5feb\u7167\uff1a</p>\n<ol>\n<li>\u4e3b\u8282\u70b9\u53d1\u8d77\u5feb\u7167</li>\n<li>\u5404\u8282\u70b9\u8bb0\u5f55\u672c\u5730\u72b6\u6001</li>\n<li>\u8bb0\u5f55\u4f20\u8f93\u4e2d\u7684\u6d88\u606f</li>\n<li>\u7ec4\u5408\u5f62\u6210\u5168\u5c40\u4e00\u81f4\u72b6\u6001</li>\n</ol>\n<p>\u8fd9\u5141\u8bb8\u5728\u4e0d\u505c\u6b62\u7cfb\u7edf\u7684\u60c5\u51b5\u4e0b\u8fdb\u884ccheckpoint\u548c\u6062\u590d\u3002</p>\n<p><strong>\u5411\u91cf\u65f6\u949f\u540c\u6b65</strong></p>\n<p>\u7ef4\u62a4\u56e0\u679c\u4e00\u81f4\u6027\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">VectorClock</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">    </span><span class=\"nl\">clocks</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"k\">Map</span><span class=\"o\">&lt;</span><span class=\"n\">NodeId</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">LogicalTime</span><span class=\"o\">&gt;</span>\n\n<span class=\"w\">    </span><span class=\"k\">update</span><span class=\"p\">(</span><span class=\"n\">node_id</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">        </span><span class=\"n\">clocks</span><span class=\"o\">[</span><span class=\"n\">node_id</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"w\">    </span><span class=\"k\">merge</span><span class=\"p\">(</span><span class=\"nl\">other</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">VectorClock</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">        </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nc\">time</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"n\">other</span><span class=\"p\">.</span><span class=\"nl\">clocks</span><span class=\"p\">:</span>\n<span class=\"w\">            </span><span class=\"n\">clocks</span><span class=\"o\">[</span><span class=\"n\">id</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">clocks</span><span class=\"o\">[</span><span class=\"n\">id</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nc\">time</span><span class=\"p\">)</span>\n<span class=\"err\">}</span>\n</code></pre></div>\n\n<h3 id=\"1525\">15.2.5 \u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1</h3>\n<p><strong>\u6700\u7ec8\u4e00\u81f4\u6027\u6a21\u578b</strong></p>\n<p>\u5b9a\u4e49\u6536\u655b\u6761\u4ef6\uff1a\n$$\\lim_{t \\to \\infty} \\mathbb{E}[|\\mathbf{U}_i^{(t)} - \\mathbf{U}_j^{(t)}|_F] = 0$$\n\u5bf9\u6240\u6709\u8282\u70b9 $i, j$\u3002</p>\n<p><strong>\u53c2\u6570\u670d\u52a1\u5668\u67b6\u6784</strong></p>\n<ol>\n<li>\n<p><strong>\u540c\u6b65\u534f\u8bae</strong>\uff1a\n   - Pull: $\\mathbf{u}_i^{\\text{local}} \\leftarrow \\text{PS}.\\text{get}(i)$\n   - Compute: $\\Delta \\mathbf{u}_i = -\\eta \\nabla \\ell(\\mathbf{u}_i^{\\text{local}})$\n   - Push: $\\text{PS}.\\text{update}(i, \\Delta \\mathbf{u}_i)$</p>\n</li>\n<li>\n<p><strong>\u4e00\u81f4\u6027\u7ea7\u522b</strong>\uff1a\n   - \u5f3a\u4e00\u81f4\u6027\uff1a\u6240\u6709\u66f4\u65b0\u5e8f\u5217\u5316\n   - \u6709\u754c\u9648\u65e7\u6027\uff1a$|\\text{version}_i - \\text{version}_j| \\leq B$\n   - \u6700\u7ec8\u4e00\u81f4\u6027\uff1a\u65e0\u540c\u6b65\u4fdd\u8bc1</p>\n</li>\n</ol>\n<p><strong>\u51b2\u7a81\u89e3\u51b3\u7b56\u7565</strong></p>\n<p>\u5f53\u591a\u4e2a\u8282\u70b9\u540c\u65f6\u66f4\u65b0\u540c\u4e00\u5d4c\u5165\uff1a</p>\n<ol>\n<li><strong>Last-Writer-Wins</strong>\uff1a\u57fa\u4e8e\u65f6\u95f4\u6233</li>\n<li>\n<p><strong>CRDT</strong>\uff08\u65e0\u51b2\u7a81\u590d\u5236\u6570\u636e\u7c7b\u578b\uff09\uff1a\n$$\\mathbf{u}_{\\text{merged}} = \\frac{1}{|\\mathcal{N}|} \\sum_{n \\in \\mathcal{N}} \\mathbf{u}_n$$</p>\n</li>\n<li>\n<p><strong>\u52a0\u6743\u5e73\u5747</strong>\uff1a\u57fa\u4e8e\u66f4\u65b0\u8d28\u91cf\n$$\\mathbf{u}_{\\text{merged}} = \\frac{\\sum_n w_n \\mathbf{u}_n}{\\sum_n w_n}$$\n<strong>\u901a\u4fe1\u4f18\u5316</strong></p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u538b\u7f29</strong>\uff1a\n   - Top-k\u7a00\u758f\u5316\uff1a\u53ea\u4f20\u8f93\u6700\u5927\u7684 $k$ \u4e2a\u68af\u5ea6\u5206\u91cf\n   - \u91cf\u5316\uff1a\u4f7f\u7528\u4f4e\u7cbe\u5ea6\u8868\u793a\n   - \u8bef\u5dee\u53cd\u9988\uff1a\u7d2f\u79ef\u538b\u7f29\u8bef\u5dee</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u901a\u4fe1</strong>\uff1a\n   <code>async_push(gradient):\n       compressed = compress(gradient)\n       future = send_async(compressed)\n       error_buffer += gradient - decompress(compressed)</code></p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong></p>\n<p>\u5206\u5e03\u5f0fSGD\u7684\u6536\u655b\u901f\u7387\uff1a\n$$\\mathbb{E}[|\\nabla \\mathcal{L}_T|^2] \\leq O\\left(\\frac{1}{\\sqrt{nT}} + \\frac{\\sigma^2}{nT} + \\frac{G^2\\tau^2}{T^2}\\right)$$\n\u5176\u4e2d $n$ \u662f\u8282\u70b9\u6570\uff0c\u5c55\u793a\u4e86\u7ebf\u6027\u52a0\u901f\u76f4\u5230\u901a\u4fe1\u74f6\u9888\u3002</p>\n<h2 id=\"153\">15.3 \u51b7\u542f\u52a8\u95ee\u9898\u7684\u77e9\u9635\u8865\u5168\u89c6\u89d2</h2>\n<h3 id=\"1531\">15.3.1 \u8fc1\u79fb\u5b66\u4e60\u6846\u67b6</h3>\n<p>\u5c06\u51b7\u542f\u52a8\u89c6\u4e3a\u5c11\u6837\u672c\u77e9\u9635\u8865\u5168\u95ee\u9898\uff0c\u5229\u7528\u5df2\u6709\u7528\u6237/\u7269\u54c1\u7684\u77e5\u8bc6\u6784\u5efa\u6709\u6548\u7684\u5148\u9a8c\u3002\u8fd9\u79cd\u65b9\u6cd5\u5c06\u51b7\u542f\u52a8\u4ece\"\u65e0\u4e2d\u751f\u6709\"\u8f6c\u53d8\u4e3a\"\u77e5\u8bc6\u8fc1\u79fb\"\u3002</p>\n<p><strong>\u5171\u4eab\u9690\u7a7a\u95f4\u6a21\u578b</strong></p>\n<p>\u57fa\u672c\u5047\u8bbe\uff1a\u65b0\u7528\u6237\u7684\u9690\u5411\u91cf\u53ef\u4ee5\u4ece\u5176\u7279\u5f81\u9884\u6d4b\uff1a\n$$\\mathbf{u}_{\\text{new}} = \\mathbf{W}_u \\mathbf{f}_u + \\boldsymbol{\\epsilon}_u$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathbf{f}_u \\in \\mathbb{R}^d$ \u662f\u7528\u6237\u7279\u5f81\uff08\u4eba\u53e3\u7edf\u8ba1\u5b66\u3001\u6ce8\u518c\u4fe1\u606f\u7b49\uff09</li>\n<li>$\\mathbf{W}_u \\in \\mathbb{R}^{r \\times d}$ \u662f\u5b66\u4e60\u7684\u6620\u5c04\u77e9\u9635</li>\n<li>$\\boldsymbol{\\epsilon}_u$ \u662f\u4e2a\u6027\u5316\u504f\u5dee</li>\n</ul>\n<p><strong>\u5206\u5c42\u8d1d\u53f6\u65af\u6a21\u578b</strong></p>\n<p>\u66f4\u7cbe\u7ec6\u7684\u5efa\u6a21\u8003\u8651\u4e0d\u786e\u5b9a\u6027\uff1a\n$$\\begin{aligned}\n\\mathbf{u}_i &amp;\\sim \\mathcal{N}(\\mathbf{W}_u \\mathbf{f}_i, \\boldsymbol{\\Sigma}_u) \\\n\\mathbf{W}_u &amp;\\sim \\mathcal{MN}(\\mathbf{M}_0, \\boldsymbol{\\Sigma}_u, \\boldsymbol{\\Omega}) \\\nr_{ij} &amp;\\sim \\mathcal{N}(\\mathbf{u}_i^T \\mathbf{v}_j, \\sigma^2)\n\\end{aligned}$$\n\u8fd9\u63d0\u4f9b\u4e86\u9884\u6d4b\u7684\u4e0d\u786e\u5b9a\u6027\u4f30\u8ba1\uff0c\u5bf9\u4e3b\u52a8\u5b66\u4e60\u81f3\u5173\u91cd\u8981\u3002</p>\n<p><strong>\u5143\u5b66\u4e60\u89c6\u89d2</strong></p>\n<p>\u5c06\u51b7\u542f\u52a8\u89c6\u4e3afew-shot learning\u95ee\u9898\uff1a</p>\n<ol>\n<li><strong>\u5143\u8bad\u7ec3</strong>\uff1a\u5728\u5386\u53f2\u7528\u6237\u4e0a\u5b66\u4e60\"\u5982\u4f55\u5feb\u901f\u5b66\u4e60\"</li>\n<li><strong>\u5143\u6d4b\u8bd5</strong>\uff1a\u5bf9\u65b0\u7528\u6237\u5feb\u901f\u9002\u5e94</li>\n</ol>\n<p>\u4f7f\u7528MAML\uff08Model-Agnostic Meta-Learning\uff09\u6846\u67b6\uff1a\n$$\\mathbf{W}^* = \\arg\\min_{\\mathbf{W}} \\sum_{i \\in \\mathcal{T}_{\\text{train}}} \\mathcal{L}(\\mathbf{W} - \\alpha\\nabla_{\\mathbf{W}}\\mathcal{L}_i(\\mathbf{W}))$$\n<strong>\u591a\u4efb\u52a1\u5b66\u4e60</strong></p>\n<p>\u4e0d\u540c\u7528\u6237\u7fa4\u4f53\u5171\u4eab\u90e8\u5206\u7ed3\u6784\uff1a\n$$\\mathbf{U} = \\mathbf{U}_{\\text{shared}} + \\sum_{k=1}^K \\mathbf{U}_k \\odot \\mathbf{Z}_k$$\n\u5176\u4e2d $\\mathbf{Z}_k$ \u662f\u7fa4\u4f53\u6307\u793a\u77e9\u9635\u3002</p>\n<h3 id=\"1532\">15.3.2 \u4e3b\u52a8\u5b66\u4e60\u7b56\u7565</h3>\n<p>\u9009\u62e9\u6700\u4f18\u7684\u521d\u59cb\u4ea4\u4e92\u6765\u5feb\u901f\u5b66\u4e60\u65b0\u7528\u6237\u504f\u597d\u3002\u5173\u952e\u662f\u5e73\u8861\u63a2\u7d22\uff08\u51cf\u5c11\u4e0d\u786e\u5b9a\u6027\uff09\u4e0e\u5229\u7528\uff08\u63d0\u4f9b\u597d\u7684\u63a8\u8350\uff09\u3002</p>\n<p><strong>\u4e0d\u786e\u5b9a\u6027\u91c7\u6837</strong></p>\n<p>\u57fa\u4e8e\u540e\u9a8c\u65b9\u5dee\u9009\u62e9\u7269\u54c1\uff1a\n$$j^* = \\arg\\max_j \\text{Var}[\\hat{r}_{ij} | \\mathcal{D}]$$\n\u5bf9\u4e8e\u7ebf\u6027\u6a21\u578b\uff0c\u65b9\u5dee\u53ef\u89e3\u6790\u8ba1\u7b97\uff1a\n$$\\text{Var}[\\hat{r}_{ij}] = \\mathbf{v}_j^T (\\mathbf{V}_{\\mathcal{D}}^T\\mathbf{V}_{\\mathcal{D}} + \\lambda\\mathbf{I})^{-1} \\mathbf{v}_j$$\n<strong>\u4fe1\u606f\u589e\u76ca\u6700\u5927\u5316</strong></p>\n<p>\u9009\u62e9\u6700\u5927\u5316\u4e92\u4fe1\u606f\u7684\u7269\u54c1\uff1a\n$$j^* = \\arg\\max_j I(\\mathbf{u}_i; r_{ij} | \\mathcal{D})$$\n\u5bf9\u4e8e\u9ad8\u65af\u5206\u5e03\uff1a\n$$I(\\mathbf{u}_i; r_{ij}) = \\frac{1}{2}\\log\\left(1 + \\frac{\\mathbf{v}_j^T\\boldsymbol{\\Sigma}_{\\mathbf{u}|i}\\mathbf{v}_j}{\\sigma^2}\\right)$$\n<strong>Thompson\u91c7\u6837</strong></p>\n<p>\u5e73\u8861\u63a2\u7d22\u4e0e\u5229\u7528\u7684\u8d1d\u53f6\u65af\u65b9\u6cd5\uff1a</p>\n<ol>\n<li>\u4ece\u540e\u9a8c\u91c7\u6837\uff1a$\\tilde{\\mathbf{u}}_i \\sim p(\\mathbf{u}_i | \\mathcal{D})$</li>\n<li>\u9009\u62e9\u671f\u671b\u56de\u62a5\u6700\u9ad8\u7684\u7269\u54c1\uff1a$j^* = \\arg\\max_j \\tilde{\\mathbf{u}}_i^T \\mathbf{v}_j$</li>\n</ol>\n<p><strong>\u6279\u91cf\u4e3b\u52a8\u5b66\u4e60</strong></p>\n<p>\u540c\u65f6\u9009\u62e9 $k$ \u4e2a\u7269\u54c1\u7684\u6b21\u6a21\u4f18\u5316\u95ee\u9898\uff1a\n$$\\mathcal{S}^* = \\arg\\max_{|\\mathcal{S}|=k} f(\\mathcal{S})$$\n\u5176\u4e2d $f(\\mathcal{S})$ \u662f\u6b21\u6a21\u51fd\u6570\uff08\u5982\u4fe1\u606f\u589e\u76ca\uff09\u3002\u8d2a\u5fc3\u7b97\u6cd5\u63d0\u4f9b $(1-1/e)$ \u8fd1\u4f3c\u4fdd\u8bc1\u3002</p>\n<p><strong>\u4e0a\u4e0b\u6587\u76f8\u5173\u7684\u4e3b\u52a8\u5b66\u4e60</strong></p>\n<p>\u8003\u8651\u65f6\u95f4\u3001\u4f4d\u7f6e\u7b49\u4e0a\u4e0b\u6587\uff1a\n$$j^* = \\arg\\max_j g(\\text{uncertainty}_j, \\text{context}_t, \\text{diversity}(\\mathcal{S} \\cup {j}))$$</p>\n<h3 id=\"1533\">15.3.3 \u7406\u8bba\u4fdd\u8bc1</h3>\n<p><strong>\u6837\u672c\u590d\u6742\u5ea6\u754c</strong></p>\n<p>\u7ed9\u5b9a\u79e9-$r$ \u77e9\u9635\uff0c\u8fbe\u5230 $\\epsilon$-\u7cbe\u5ea6\u9700\u8981\u7684\u6837\u672c\u6570\uff1a</p>\n<p><strong>\u5747\u5300\u91c7\u6837\u60c5\u51b5</strong>\uff1a\n$$m = O(r(n_1 + n_2)\\log(1/\\epsilon))$$\n<strong>\u975e\u5747\u5300\u91c7\u6837\u7684\u6539\u8fdb\u754c</strong>\uff1a\n$$m = O(\\mu r \\log(n_1 + n_2) \\log(1/\\epsilon))$$\n\u5176\u4e2d $\\mu$ \u662f\u76f8\u5e72\u6027\u53c2\u6570\u3002</p>\n<p><strong>\u5728\u7ebf\u5b66\u4e60\u7684regret\u754c</strong></p>\n<p>\u5bf9\u4e8e\u51b7\u542f\u52a8\u7528\u6237\u7684\u7d2f\u79efregret\uff1a\n$$R_T = \\sum_{t=1}^T (r^* - r_t) = O(\\sqrt{rT\\log T})$$\n\u5176\u4e2d $r^*$ \u662f\u6700\u4f18\u63a8\u8350\u7684\u56de\u62a5\u3002</p>\n<p><strong>\u4e3b\u52a8\u5b66\u4e60\u7684\u52a0\u901f</strong></p>\n<p>\u76f8\u6bd4\u968f\u673a\u9009\u62e9\uff0c\u4e3b\u52a8\u5b66\u4e60\u53ef\u4ee5\u6307\u6570\u7ea7\u51cf\u5c11\u6837\u672c\u9700\u6c42\uff1a</p>\n<ul>\n<li>\u968f\u673a\uff1a$m_{\\text{random}} = O(r^2/\\epsilon^2)$</li>\n<li>\u4e3b\u52a8\uff1a$m_{\\text{active}} = O(r\\log(1/\\epsilon))$</li>\n</ul>\n<p><strong>\u77e9\u9635\u8865\u5168\u7684\u4fe1\u606f\u8bba\u4e0b\u754c</strong></p>\n<p>\u4efb\u4f55\u7b97\u6cd5\u81f3\u5c11\u9700\u8981\uff1a\n$$m \\geq c \\cdot r(n_1 + n_2 - r)$$\n\u4e2a\u89c2\u6d4b\u624d\u80fd\u7cbe\u786e\u6062\u590d\u79e9-$r$ \u77e9\u9635\u3002</p>\n<p><strong>\u5173\u952e\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u975e\u5747\u5300\u7f3a\u5931\u6a21\u5f0f\u4e0b\u7684\u7406\u8bba\u5206\u6790</li>\n<li>\u5728\u7ebf\u8bbe\u7f6e\u4e0b\u7684\u81ea\u9002\u5e94\u91c7\u6837</li>\n<li>\u9690\u79c1\u4fdd\u62a4\u7ea6\u675f\u4e0b\u7684\u51b7\u542f\u52a8\uff08\u5dee\u5206\u9690\u79c1\uff09</li>\n<li>\u5bf9\u6297\u6027\u73af\u5883\u4e0b\u7684\u9c81\u68d2\u6027\u4fdd\u8bc1</li>\n</ul>\n<h3 id=\"1534\">15.3.4 \u5b9e\u7528\u6280\u672f\u4e0e\u4f18\u5316</h3>\n<p><strong>\u6df7\u5408\u65b9\u6cd5</strong></p>\n<p>\u7ed3\u5408\u591a\u79cd\u4fe1\u606f\u6e90\uff1a</p>\n<ol>\n<li><strong>\u5185\u5bb9\u7279\u5f81</strong>\uff1a\u4f7f\u7528\u6df1\u5ea6\u5b66\u4e60\u63d0\u53d6</li>\n<li><strong>\u793e\u4ea4\u4fe1\u53f7</strong>\uff1a\u5229\u7528\u7528\u6237\u5173\u7cfb\u7f51\u7edc</li>\n<li><strong>\u9690\u5f0f\u53cd\u9988</strong>\uff1a\u6d4f\u89c8\u3001\u641c\u7d22\u7b49\u5f31\u4fe1\u53f7</li>\n<li><strong>\u8de8\u57df\u4fe1\u606f</strong>\uff1a\u4ece\u5176\u4ed6\u4ea7\u54c1\u8fc1\u79fb\u77e5\u8bc6</li>\n</ol>\n<p><strong>\u6e10\u8fdb\u5f0f\u4e2a\u6027\u5316</strong></p>\n<p>\u968f\u7740\u6570\u636e\u79ef\u7d2f\u9010\u6b65\u8fc7\u6e21\uff1a\n$$\\mathbf{u}_i(t) = \\alpha(t) \\cdot \\mathbf{u}_{\\text{prior}} + (1-\\alpha(t)) \\cdot \\mathbf{u}_{\\text{learned}}$$\n\u5176\u4e2d $\\alpha(t) = \\exp(-\\gamma \\cdot n_i(t))$\u3002</p>\n<p><strong>\u7fa4\u4f53\u5148\u9a8c</strong></p>\n<p>\u5229\u7528\u76f8\u4f3c\u7528\u6237\u7fa4\u4f53\uff1a\n$$\\mathbf{u}_{\\text{prior}} = \\frac{1}{|\\mathcal{N}_i|}\\sum_{k \\in \\mathcal{N}_i} \\mathbf{u}_k$$\n\u5176\u4e2d $\\mathcal{N}_i$ \u662f\u57fa\u4e8e\u7279\u5f81\u7684\u6700\u8fd1\u90bb\u3002</p>\n<p><strong>\u5728\u7ebf\u66f4\u65b0\u7684\u6570\u503c\u6280\u5de7</strong></p>\n<ol>\n<li><strong>\u589e\u91cfSVD</strong>\uff1a\u907f\u514d\u91cd\u65b0\u5206\u89e3</li>\n<li><strong>\u7a00\u758f\u66f4\u65b0</strong>\uff1a\u53ea\u66f4\u65b0\u76f8\u5173\u7ef4\u5ea6</li>\n<li><strong>\u91cf\u5316\u5d4c\u5165</strong>\uff1a\u51cf\u5c11\u5b58\u50a8\u548c\u8ba1\u7b97</li>\n<li><strong>\u5206\u7ea7\u7cbe\u5ea6</strong>\uff1a\u65b0\u7528\u6237\u7528\u4f4e\u7cbe\u5ea6\uff0c\u9010\u6b65\u63d0\u5347</li>\n</ol>\n<h2 id=\"154\">15.4 \u65f6\u5e8f\u52a8\u6001\u7684\u77e9\u9635\u5efa\u6a21</h2>\n<h3 id=\"1541\">15.4.1 \u65f6\u53d8\u9690\u56e0\u5b50\u6a21\u578b</h3>\n<p>\u7528\u6237\u548c\u7269\u54c1\u7684\u9690\u56e0\u5b50\u968f\u65f6\u95f4\u6f14\u5316\uff1a\n$$\\mathbf{u}_i(t) = \\mathbf{u}_i(t-1) + \\mathbf{w}_i(t)$$\n$$\\mathbf{v}_j(t) = \\mathbf{v}_j(t-1) + \\mathbf{z}_j(t)$$\n\u5176\u4e2d $\\mathbf{w}_i(t), \\mathbf{z}_j(t)$ \u662f\u6f14\u5316\u566a\u58f0\u3002</p>\n<h3 id=\"1542-kalman\">15.4.2 Kalman\u6ee4\u6ce2\u7684\u5e94\u7528</h3>\n<p>\u5c06\u9690\u56e0\u5b50\u6f14\u5316\u5efa\u6a21\u4e3a\u72b6\u6001\u7a7a\u95f4\u6a21\u578b\uff1a</p>\n<p><strong>\u72b6\u6001\u65b9\u7a0b</strong>\uff1a\n$$\\mathbf{x}_t = \\mathbf{F}\\mathbf{x}_t + \\mathbf{w}_t$$\n<strong>\u89c2\u6d4b\u65b9\u7a0b</strong>\uff1a\n$$r_t = \\mathbf{h}_t^T \\mathbf{x}_t + v_t$$\nKalman\u6ee4\u6ce2\u63d0\u4f9b\u4e86\u6700\u4f18\u7684\u5728\u7ebf\u4f30\u8ba1\u3002</p>\n<h3 id=\"1543\">15.4.3 \u5468\u671f\u6027\u6a21\u5f0f\u6355\u83b7</h3>\n<p>\u8bb8\u591a\u63a8\u8350\u573a\u666f\u5b58\u5728\u5468\u671f\u6027\uff08\u65e5\u3001\u5468\u3001\u5b63\u8282\uff09\uff1a</p>\n<p><strong>\u5085\u91cc\u53f6\u57fa\u5c55\u5f00</strong>\uff1a\n$$\\mathbf{u}_i(t) = \\mathbf{u}_i^{(0)} + \\sum_{k=1}^K (\\mathbf{a}_{ik} \\cos(\\omega_k t) + \\mathbf{b}_{ik} \\sin(\\omega_k t))$$\n<strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u9891\u7387\u68c0\u6d4b</li>\n<li>\u975e\u5e73\u7a33\u5468\u671f\u6027\u5efa\u6a21</li>\n<li>\u591a\u5c3a\u5ea6\u65f6\u95f4\u52a8\u6001\u7684\u8054\u5408\u5efa\u6a21</li>\n</ul>\n<h3 id=\"1544\">15.4.4 \u53d8\u70b9\u68c0\u6d4b</h3>\n<p>\u7528\u6237\u5174\u8da3\u7684\u7a81\u53d8\u9700\u8981\u53ca\u65f6\u68c0\u6d4b\uff1a</p>\n<p><strong>CUSUM\u7b97\u6cd5</strong>\u7684\u77e9\u9635\u7248\u672c\uff1a\n$$S_t = \\max(0, S_{t-1} + |\\mathbf{r}_t - \\mathbf{U}_t\\mathbf{V}_t^T|_F - \\delta)$$\n\u5f53 $S_t &gt; h$ \u65f6\u89e6\u53d1\u53d8\u70b9\u8b66\u62a5\u3002</p>\n<p><strong>\u9ad8\u7ea7\u4e3b\u9898</strong>\uff1a</p>\n<ul>\n<li>\u5728\u7ebf\u8d1d\u53f6\u65af\u53d8\u70b9\u68c0\u6d4b</li>\n<li>\u591a\u7528\u6237\u534f\u540c\u53d8\u70b9\u68c0\u6d4b</li>\n<li>\u5047\u9633\u6027\u7387\u4e0e\u68c0\u6d4b\u5ef6\u8fdf\u7684\u6743\u8861</li>\n</ul>\n<h2 id=\"155-gotchas\">15.5 \u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef\uff08Gotchas\uff09</h2>\n<h3 id=\"1551\">15.5.1 \u6570\u503c\u7a33\u5b9a\u6027\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>\u68af\u5ea6\u7206\u70b8/\u6d88\u5931</strong>\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u4f7f\u7528\u56fa\u5b9a\u5b66\u4e60\u7387\n   - \u6b63\u786e\uff1a\u81ea\u9002\u5e94\u5b66\u4e60\u7387 + \u68af\u5ea6\u88c1\u526a\n   - \u8bca\u65ad\uff1a\u76d1\u63a7\u68af\u5ea6\u8303\u6570 $|\\nabla\\mathcal{L}|$</p>\n</li>\n<li>\n<p><strong>\u77e9\u9635\u5947\u5f02\u6027</strong>\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u6c42\u9006 $(\\mathbf{X}^T\\mathbf{X})^{-1}$\n   - \u6b63\u786e\uff1a\u6dfb\u52a0\u6b63\u5219\u5316 $(\\mathbf{X}^T\\mathbf{X} + \\lambda\\mathbf{I})^{-1}$\n   - \u8bca\u65ad\uff1a\u68c0\u67e5\u6761\u4ef6\u6570 $\\kappa(\\mathbf{A})$</p>\n</li>\n<li>\n<p><strong>\u6d6e\u70b9\u8bef\u5dee\u7d2f\u79ef</strong>\n   - \u9519\u8bef\uff1a\u65e0\u9650\u7d2f\u79ef\u589e\u91cf\u66f4\u65b0\n   - \u6b63\u786e\uff1a\u5b9a\u671f\u91cd\u65b0\u8ba1\u7b97\u57fa\u51c6\u503c\n   - \u8bca\u65ad\uff1a\u6bd4\u8f83\u589e\u91cf\u7ed3\u679c\u4e0e\u6279\u5904\u7406\u7ed3\u679c</p>\n</li>\n</ol>\n<h3 id=\"1552\">15.5.2 \u7b97\u6cd5\u8bbe\u8ba1\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>\u8fc7\u5ea6\u9057\u5fd8</strong>\n   - \u75c7\u72b6\uff1a\u6a21\u578b\u6027\u80fd\u5267\u70c8\u6ce2\u52a8\n   - \u539f\u56e0\uff1a\u9057\u5fd8\u7387 $\\beta$ \u8bbe\u7f6e\u8fc7\u5927\n   - \u89e3\u51b3\uff1a\u81ea\u9002\u5e94\u9057\u5fd8\u7387\uff0c\u8003\u8651\u6570\u636e\u7a00\u758f\u6027</p>\n</li>\n<li>\n<p><strong>\u51b7\u542f\u52a8\u8fc7\u62df\u5408</strong>\n   - \u75c7\u72b6\uff1a\u65b0\u7528\u6237\u63a8\u8350\u6781\u7aef\u5316\n   - \u539f\u56e0\uff1a\u6837\u672c\u8fc7\u5c11\u65f6\u8fc7\u5ea6\u66f4\u65b0\n   - \u89e3\u51b3\uff1a\u8bbe\u7f6e\u6700\u5c0f\u6837\u672c\u9608\u503c\uff0c\u4f7f\u7528\u5148\u9a8c</p>\n</li>\n<li>\n<p><strong>\u5e76\u53d1\u66f4\u65b0\u51b2\u7a81</strong>\n   - \u75c7\u72b6\uff1a\u7ed3\u679c\u4e0d\u786e\u5b9a\u6027\n   - \u539f\u56e0\uff1a\u591a\u7ebf\u7a0b\u540c\u65f6\u66f4\u65b0\u540c\u4e00\u5d4c\u5165\n   - \u89e3\u51b3\uff1a\u7ec6\u7c92\u5ea6\u9501\u6216\u65e0\u9501\u7b97\u6cd5</p>\n</li>\n</ol>\n<h3 id=\"1553\">15.5.3 \u7cfb\u7edf\u5b9e\u73b0\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>\u5185\u5b58\u6cc4\u6f0f</strong>\n   - \u539f\u56e0\uff1a\u5386\u53f2\u6570\u636e\u65e0\u9650\u589e\u957f\n   - \u89e3\u51b3\uff1a\u5b9e\u73b0\u4e25\u683c\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\n   - \u5de5\u5177\uff1a\u5185\u5b58profiler\u5b9a\u671f\u68c0\u67e5</p>\n</li>\n<li>\n<p><strong>\u7f13\u5b58\u5931\u6548\u98ce\u66b4</strong>\n   - \u539f\u56e0\uff1a\u5927\u89c4\u6a21\u66f4\u65b0\u89e6\u53d1\u5168\u5c40\u5931\u6548\n   - \u89e3\u51b3\uff1a\u6e10\u8fdb\u5f0f\u5931\u6548\u7b56\u7565\n   - \u76d1\u63a7\uff1a\u7f13\u5b58\u547d\u4e2d\u7387\u5b9e\u65f6\u76d1\u63a7</p>\n</li>\n</ol>\n<h2 id=\"156\">15.6 \u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"1561\">15.6.1 \u7b97\u6cd5\u8bbe\u8ba1\u5ba1\u67e5</h3>\n<ul>\n<li>[ ] <strong>\u9057\u5fd8\u673a\u5236\u8bbe\u8ba1</strong></li>\n<li>\u662f\u5426\u8003\u8651\u4e86\u6570\u636e\u5206\u5e03\u7684\u975e\u5e73\u7a33\u6027\uff1f</li>\n<li>\u9057\u5fd8\u7387\u662f\u5426\u81ea\u9002\u5e94\u8c03\u6574\uff1f</li>\n<li>\n<p>\u662f\u5426\u4fdd\u7559\u4e86\u5173\u952e\u5386\u53f2\u4fe1\u606f\uff1f</p>\n</li>\n<li>\n<p>[ ] <strong>\u66f4\u65b0\u7b56\u7565\u4f18\u5316</strong></p>\n</li>\n<li>\u662f\u5426\u5229\u7528\u4e86\u77e9\u9635\u7ed3\u6784\uff08\u4f4e\u79e9\u3001\u7a00\u758f\uff09\uff1f</li>\n<li>\u589e\u91cf\u66f4\u65b0\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\u662f\u5426\u4f18\u4e8e\u91cd\u65b0\u8bad\u7ec3\uff1f</li>\n<li>\n<p>\u662f\u5426\u5b9e\u73b0\u4e86\u61d2\u60f0\u6c42\u503c\uff1f</p>\n</li>\n<li>\n<p>[ ] <strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u8bc1</strong></p>\n</li>\n<li>\u662f\u5426\u6dfb\u52a0\u4e86\u9002\u5f53\u7684\u6b63\u5219\u5316\uff1f</li>\n<li>\u662f\u5426\u5b9e\u73b0\u4e86\u68af\u5ea6\u88c1\u526a\uff1f</li>\n<li>\u662f\u5426\u5b9a\u671f\u68c0\u67e5\u6570\u503c\u5065\u5eb7\u5ea6\uff1f</li>\n</ul>\n<h3 id=\"1562\">15.6.2 \u7cfb\u7edf\u5b9e\u73b0\u5ba1\u67e5</h3>\n<ul>\n<li>[ ] <strong>\u5e76\u53d1\u63a7\u5236</strong></li>\n<li>\u662f\u5426\u6b63\u786e\u5904\u7406\u4e86\u5e76\u53d1\u66f4\u65b0\uff1f</li>\n<li>\u9501\u7c92\u5ea6\u662f\u5426\u5408\u7406\uff1f</li>\n<li>\n<p>\u662f\u5426\u8003\u8651\u4e86\u65e0\u9501\u7b97\u6cd5\uff1f</p>\n</li>\n<li>\n<p>[ ] <strong>\u8d44\u6e90\u7ba1\u7406</strong></p>\n</li>\n<li>\u5185\u5b58\u4f7f\u7528\u662f\u5426\u6709\u4e0a\u754c\uff1f</li>\n<li>\u662f\u5426\u5b9e\u73b0\u4e86\u4f18\u96c5\u964d\u7ea7\uff1f</li>\n<li>\n<p>\u662f\u5426\u6709\u8d44\u6e90\u6cc4\u6f0f\u68c0\u6d4b\uff1f</p>\n</li>\n<li>\n<p>[ ] <strong>\u76d1\u63a7\u4e0e\u8c03\u8bd5</strong></p>\n</li>\n<li>\u662f\u5426\u8bb0\u5f55\u4e86\u5173\u952e\u6027\u80fd\u6307\u6807\uff1f</li>\n<li>\u662f\u5426\u53ef\u4ee5\u56de\u653e\u5386\u53f2\u66f4\u65b0\uff1f</li>\n<li>\u662f\u5426\u6709\u5f02\u5e38\u68c0\u6d4b\u673a\u5236\uff1f</li>\n</ul>\n<h3 id=\"1563\">15.6.3 \u6027\u80fd\u4f18\u5316\u5ba1\u67e5</h3>\n<ul>\n<li>[ ] <strong>\u8ba1\u7b97\u4f18\u5316</strong></li>\n<li>\u662f\u5426\u4f7f\u7528\u4e86SIMD\u6307\u4ee4\uff1f</li>\n<li>\u77e9\u9635\u8fd0\u7b97\u662f\u5426cache-friendly\uff1f</li>\n<li>\n<p>\u662f\u5426\u8003\u8651\u4e86GPU\u52a0\u901f\uff1f</p>\n</li>\n<li>\n<p>[ ] <strong>\u5b58\u50a8\u4f18\u5316</strong></p>\n</li>\n<li>\u662f\u5426\u4f7f\u7528\u4e86\u7d27\u51d1\u7684\u6570\u636e\u7ed3\u6784\uff1f</li>\n<li>\u70ed\u6570\u636e\u662f\u5426\u5728\u5185\u5b58\u4e2d\uff1f</li>\n<li>\u662f\u5426\u5b9e\u73b0\u4e86\u5206\u5c42\u5b58\u50a8\uff1f</li>\n</ul>\n<h2 id=\"157\">15.7 \u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u5b9e\u65f6\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u589e\u91cf\u77e9\u9635\u65b9\u6cd5\uff0c\u4e3b\u8981\u8d21\u732e\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7406\u8bba\u6846\u67b6</strong>\uff1a\u5efa\u7acb\u4e86\u5728\u7ebf\u77e9\u9635\u5206\u89e3\u7684\u7edf\u4e00\u5206\u6790\u6846\u67b6\uff0c\u5305\u62ec\u9057\u5fd8\u673a\u5236\u3001\u6536\u655b\u6027\u4fdd\u8bc1\u548cregret\u754c\u3002</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u521b\u65b0</strong>\uff1a\n   - \u81ea\u9002\u5e94\u9057\u5fd8\u7387\u7684\u5728\u7ebfSGD\n   - \u57fa\u4e8eSherman-Morrison\u7684\u5feb\u901f\u5d4c\u5165\u66f4\u65b0\n   - \u77e9\u9635\u8865\u5168\u89c6\u89d2\u7684\u51b7\u542f\u52a8\u89e3\u51b3\u65b9\u6848\n   - Kalman\u6ee4\u6ce2\u7684\u65f6\u5e8f\u5efa\u6a21</p>\n</li>\n<li>\n<p><strong>\u5b9e\u8df5\u6307\u5bfc</strong>\uff1a\u603b\u7ed3\u4e86\u5e38\u89c1\u9677\u9631\u3001\u6700\u4f73\u5b9e\u8df5\u548c\u6027\u80fd\u4f18\u5316\u6280\u5de7\u3002</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u516c\u5f0f\u6c47\u603b</strong>\uff1a</p>\n<ul>\n<li>\u6307\u6570\u9057\u5fd8\u6743\u91cd\uff1a$w_{ij}^{(t)} = \\exp(-\\beta(t - t_{ij}))$</li>\n<li>Sherman-Morrison\u66f4\u65b0\uff1a$(\\mathbf{A} + \\mathbf{x}\\mathbf{x}^T)^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{x}\\mathbf{x}^T\\mathbf{A}^{-1}}{1 + \\mathbf{x}^T\\mathbf{A}^{-1}\\mathbf{x}}$</li>\n<li>\u52a8\u6001\u6b63\u5219\u5316\uff1a$\\lambda_i^{(t)} = \\lambda_0 / \\sqrt{n_i^{(t)} + 1}$</li>\n<li>\u65f6\u53d8\u9690\u56e0\u5b50\uff1a$\\mathbf{u}_i(t) = \\mathbf{u}_i(t-1) + \\mathbf{w}_i(t)$</li>\n</ul>\n<p><strong>\u672a\u6765\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u6df1\u5ea6\u5b66\u4e60\u4e0e\u589e\u91cf\u77e9\u9635\u65b9\u6cd5\u7684\u7ed3\u5408</li>\n<li>\u8054\u90a6\u5b66\u4e60\u573a\u666f\u4e0b\u7684\u5206\u5e03\u5f0f\u589e\u91cf\u66f4\u65b0</li>\n<li>\u56e0\u679c\u63a8\u65ad\u5728\u52a8\u6001\u63a8\u8350\u4e2d\u7684\u5e94\u7528</li>\n<li>\u91cf\u5b50\u7b97\u6cd5\u52a0\u901f\u77e9\u9635\u66f4\u65b0</li>\n</ul>\n<h2 id=\"158\">15.8 \u7ec3\u4e60\u9898</h2>\n<h3 id=\"_1\">\u57fa\u7840\u9898</h3>\n<p><strong>\u7ec3\u4e6015.1</strong> \u8bc1\u660e\u6307\u6570\u9057\u5fd8\u6743\u91cd\u4e0b\u7684SGD\u66f4\u65b0\u7b49\u4ef7\u4e8e\u6c42\u89e3\u4e00\u4e2a\u52a0\u6743\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u7d2f\u79ef\u635f\u5931\u51fd\u6570 $\\sum_{s=1}^t \\beta^{t-s} \\ell_s$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5b9a\u4e49\u7d2f\u79ef\u635f\u5931\uff1a\n$$\\mathcal{L}_t = \\sum_{s=1}^t \\beta^{t-s} (r_s - \\mathbf{u}_{i_s}^T \\mathbf{v}_{j_s})^2$$\n\u5bf9 $\\mathbf{u}_i$ \u6c42\u5bfc\uff1a\n$$\\nabla_{\\mathbf{u}_i} \\mathcal{L}_t = -2 \\sum_{s: i_s=i} \\beta^{t-s} (r_s - \\mathbf{u}_i^T \\mathbf{v}_{j_s}) \\mathbf{v}_{j_s}$$\n\u8fd9\u6b63\u662f\u52a0\u6743\u6700\u5c0f\u4e8c\u4e58\u7684\u68af\u5ea6\uff0c\u6743\u91cd\u4e3a $w_s = \\beta^{t-s}$\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6015.2</strong> \u7ed9\u5b9a\u79e9\u4e3a $r$ \u7684 $m \\times n$ \u77e9\u9635\uff0c\u4f7f\u7528Sherman-Morrison\u516c\u5f0f\u8ba1\u7b97\u6dfb\u52a0\u4e00\u4e2a\u65b0\u884c\u540e\u7684SVD\u66f4\u65b0\u590d\u6742\u5ea6\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u589e\u91cfSVD\u7684\u8ba1\u7b97\u6b65\u9aa4\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u539f\u59cbSVD\uff1a$\\mathbf{M} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^T$</p>\n<p>\u6dfb\u52a0\u65b0\u884c $\\mathbf{a}^T$ \u540e\uff1a\n$$\\mathbf{M}' = \\begin{bmatrix} \\mathbf{M} \\ \\mathbf{a}^T \\end{bmatrix}$$\n\u8ba1\u7b97\u6b65\u9aa4\uff1a</p>\n<ol>\n<li>\u6295\u5f71\uff1a$\\mathbf{p} = \\mathbf{V}^T\\mathbf{a}$\uff0c\u590d\u6742\u5ea6 $O(nr)$</li>\n<li>\u6b63\u4ea4\u5206\u91cf\uff1a$\\mathbf{q} = \\mathbf{a} - \\mathbf{V}\\mathbf{p}$\uff0c\u590d\u6742\u5ea6 $O(nr)$</li>\n<li>\u66f4\u65b0\u5c0f\u77e9\u9635SVD\uff1a$O(r^2)$</li>\n</ol>\n<p>\u603b\u590d\u6742\u5ea6\uff1a$O(nr + r^2)$\uff0c\u8fdc\u5c0f\u4e8e\u91cd\u65b0\u8ba1\u7b97 $O(mn\\min(m,n))$\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6015.3</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u9057\u5fd8\u7387\u7b97\u6cd5\uff0c\u4f7f\u5f97\u7a00\u758f\u7528\u6237\u7684\u6570\u636e\u4fdd\u7559\u66f4\u4e45\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u9057\u5fd8\u7387\u5e94\u8be5\u4e0e\u7528\u6237\u6d3b\u8dc3\u5ea6\u6210\u53cd\u6bd4\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u9057\u5fd8\u7387\uff1a\n$$\\beta_i(t) = \\beta_0 \\cdot \\frac{\\bar{n}}{n_i(t) + \\epsilon}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$n_i(t)$ \u662f\u7528\u6237 $i$ \u5728\u65f6\u95f4\u7a97\u53e3\u5185\u7684\u4ea4\u4e92\u6b21\u6570</li>\n<li>$\\bar{n}$ \u662f\u6240\u6709\u7528\u6237\u7684\u5e73\u5747\u4ea4\u4e92\u6b21\u6570</li>\n<li>$\\epsilon$ \u9632\u6b62\u9664\u96f6</li>\n</ul>\n<p>\u8fd9\u6837\u7a00\u758f\u7528\u6237\uff08$n_i(t)$ \u5c0f\uff09\u7684 $\\beta_i(t)$ \u66f4\u5c0f\uff0c\u6570\u636e\u4fdd\u7559\u66f4\u4e45\u3002</p>\n</details>\n<h3 id=\"_2\">\u6311\u6218\u9898</h3>\n<p><strong>\u7ec3\u4e6015.4</strong> \u63a8\u5bfc\u5728\u7ebf\u77e9\u9635\u5206\u89e3\u7684regret\u754c\uff0c\u8003\u8651\u6570\u636e\u6d41\u662f\u5bf9\u6297\u6027\u9009\u62e9\u7684\u60c5\u51b5\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u5206\u6790\u6846\u67b6\uff0c\u6ce8\u610f\u77e9\u9635\u5206\u89e3\u7684\u975e\u51f8\u6027\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5b9a\u4e49regret\uff1a\n$$R_T = \\sum_{t=1}^T \\ell_t(\\mathbf{U}_t, \\mathbf{V}_t) - \\min_{\\mathbf{U},\\mathbf{V}} \\sum_{t=1}^T \\ell_t(\\mathbf{U}, \\mathbf{V})$$\n\u5173\u952e\u6b65\u9aa4\uff1a</p>\n<ol>\n<li>\u9650\u5236\u5728\u6709\u754c\u96c6\u5408\uff1a$|\\mathbf{U}|_F \\leq B_U$\uff0c$|\\mathbf{V}|_F \\leq B_V$</li>\n<li>\u4f7f\u7528Online Gradient Descent\u7684regret\u754c</li>\n<li>\u5904\u7406\u975e\u51f8\u6027\uff1a\u8003\u8651\u5c40\u90e8\u7ebf\u6027\u5316</li>\n</ol>\n<p>\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\uff0c\u53ef\u5f97\uff1a\n$$R_T = O(\\sqrt{T}(B_U + B_V))$$\n\u6ce8\u610f\uff1a\u8fd9\u662f\u5c40\u90e8regret\uff0c\u5168\u5c40\u6700\u4f18\u9700\u8981\u989d\u5916\u5047\u8bbe\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6015.5</strong> \u8bbe\u8ba1\u4e00\u4e2a\u5206\u5e03\u5f0f\u589e\u91cf\u77e9\u9635\u5206\u89e3\u7b97\u6cd5\uff0c\u652f\u6301\u5f02\u6b65\u66f4\u65b0\u4e14\u4fdd\u8bc1\u6700\u7ec8\u4e00\u81f4\u6027\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u53c2\u6570\u670d\u52a1\u5668\u67b6\u6784\u548c\u5ef6\u8fdf\u8865\u507f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li><strong>\u53c2\u6570\u670d\u52a1\u5668</strong>\u5b58\u50a8\u5168\u5c40\u5d4c\u5165 $\\mathbf{U}, \\mathbf{V}$</li>\n<li><strong>\u5de5\u4f5c\u8282\u70b9</strong>\u5904\u7406\u672c\u5730\u6570\u636e\u6d41</li>\n</ol>\n<p>\u5f02\u6b65\u66f4\u65b0\u534f\u8bae\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>Worker k:\n1. Pull: \u83b7\u53d6\u76f8\u5173\u5d4c\u5165 u_i, v_j\n2. Compute: \u8ba1\u7b97\u68af\u5ea6 g_u, g_v\n3. Push: \u53d1\u9001\u5e26\u65f6\u95f4\u6233\u7684\u66f4\u65b0 (g_u, g_v, \u03c4)\n\nServer:\n1. \u63a5\u6536\u66f4\u65b0 (g, \u03c4)\n2. \u5ef6\u8fdf\u8865\u507f\uff1ag&#39; = g <span class=\"gs\">* decay(t - \u03c4)</span>\n<span class=\"gs\">3. \u5e94\u7528\u66f4\u65b0\uff1aparam += -\u03b7 *</span> g&#39;\n</code></pre></div>\n\n<p>\u4e00\u81f4\u6027\u4fdd\u8bc1\uff1a</p>\n<ul>\n<li>\u6709\u754c\u5ef6\u8fdf\uff1a$t - \u03c4 \\leq \\Delta$</li>\n<li>\u8870\u51cf\u51fd\u6570\uff1a$\\text{decay}(\\delta) = \\exp(-\\alpha\\delta)$</li>\n<li>\u6536\u655b\u6761\u4ef6\uff1a$\\eta &lt; \\frac{1}{L(1 + \\alpha\\Delta)}$</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e6015.6</strong> \u5206\u6790Kalman\u6ee4\u6ce2\u5728\u9690\u56e0\u5b50\u6f14\u5316\u4e2d\u7684\u8ba1\u7b97\u74f6\u9888\uff0c\u63d0\u51fa\u4e00\u4e2a\u8fd1\u4f3c\u7b97\u6cd5\u5c06\u590d\u6742\u5ea6\u4ece $O(r^3)$ \u964d\u5230 $O(r)$\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5229\u7528\u534f\u65b9\u5dee\u77e9\u9635\u7684\u7279\u6b8a\u7ed3\u6784\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6807\u51c6Kalman\u66f4\u65b0\u7684\u74f6\u9888\u5728\u534f\u65b9\u5dee\u66f4\u65b0\uff1a\n$$\\mathbf{P}_t = \\mathbf{P}_{t|t-1} - \\mathbf{K}_t\\mathbf{H}_t\\mathbf{P}_{t|t-1}$$\n\u8fd1\u4f3c\u65b9\u6848\uff1a</p>\n<ol>\n<li><strong>\u5bf9\u89d2\u8fd1\u4f3c</strong>\uff1a\u5047\u8bbe $\\mathbf{P}_t \\approx \\text{diag}(p_1, ..., p_r)$</li>\n<li>\n<p><strong>\u66f4\u65b0\u516c\u5f0f</strong>\uff1a\n$$p_i^{(t)} = \\frac{p_i^{(t-1)} + q}{1 + h_i^2(p_i^{(t-1)} + q)/r}$$</p>\n</li>\n<li>\n<p><strong>\u8bef\u5dee\u8865\u507f</strong>\uff1a\u5b9a\u671f\uff08\u6bcf $k$ \u6b65\uff09\u8fd0\u884c\u5b8c\u6574\u66f4\u65b0</p>\n</li>\n</ol>\n<p>\u590d\u6742\u5ea6\u5206\u6790\uff1a</p>\n<ul>\n<li>\u5bf9\u89d2\u66f4\u65b0\uff1a$O(r)$ per step</li>\n<li>\u5b8c\u6574\u66f4\u65b0\uff1a$O(r^3)$ every $k$ steps</li>\n<li>\u5747\u644a\u590d\u6742\u5ea6\uff1a$O(r + r^3/k)$</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e6015.7</strong> \u63a8\u5bfc\u591a\u4efb\u52a1\u5b66\u4e60\u6846\u67b6\u4e0b\u7684\u589e\u91cf\u77e9\u9635\u5206\u89e3\uff0c\u5176\u4e2d\u4e0d\u540c\u4efb\u52a1\u5171\u4eab\u90e8\u5206\u9690\u7a7a\u95f4\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u5206\u5757\u77e9\u9635\u8868\u793a\u5171\u4eab\u548c\u7279\u5b9a\u7ed3\u6784\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u591a\u4efb\u52a1\u9690\u56e0\u5b50\u5206\u89e3\uff1a\n$$\\mathbf{U}_i^{(k)} = [\\mathbf{U}_i^{(\\text{shared})}, \\mathbf{U}_i^{(k,\\text{specific})}]$$\n\u76ee\u6807\u51fd\u6570\uff1a\n$$\\mathcal{L} = \\sum_{k=1}^K \\sum_{(i,j) \\in \\Omega_k} (r_{ij}^{(k)} - (\\mathbf{U}_i^{(k)})^T \\mathbf{V}_j^{(k)})^2 + \\lambda |\\mathbf{U}^{(\\text{shared})}|_F^2$$\n\u589e\u91cf\u66f4\u65b0\u7b56\u7565\uff1a</p>\n<ol>\n<li>\n<p>\u5171\u4eab\u90e8\u5206\uff1a\u805a\u5408\u6240\u6709\u4efb\u52a1\u7684\u68af\u5ea6\n$$\\mathbf{u}_i^{(\\text{shared})} \\leftarrow \\mathbf{u}_i^{(\\text{shared})} - \\eta \\sum_k \\alpha_k \\nabla_{\\text{shared}} \\ell^{(k)}$$</p>\n</li>\n<li>\n<p>\u7279\u5b9a\u90e8\u5206\uff1a\u72ec\u7acb\u66f4\u65b0\n$$\\mathbf{u}_i^{(k,\\text{specific})} \\leftarrow \\mathbf{u}_i^{(k,\\text{specific})} - \\eta \\nabla_{\\text{specific}} \\ell^{(k)}$$\n\u5173\u952e\u6311\u6218\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u5e73\u8861\u5171\u4eab\u4e0e\u7279\u5b9a\u7684\u8d21\u732e</li>\n<li>\u4efb\u52a1\u6743\u91cd $\\alpha_k$ \u7684\u81ea\u9002\u5e94\u8c03\u6574</li>\n<li>\u5f02\u6784\u6570\u636e\u6d41\u7684\u5904\u7406</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e6015.8</strong> \u8bbe\u8ba1\u4e00\u4e2a\u5728\u7ebf\u7b97\u6cd5\u540c\u65f6\u5904\u7406\u663e\u5f0f\u8bc4\u5206\u548c\u9690\u5f0f\u53cd\u9988\uff0c\u8003\u8651\u4e24\u79cd\u6570\u636e\u7684\u4e0d\u540c\u566a\u58f0\u7279\u6027\u548c\u5230\u8fbe\u9891\u7387\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u591a\u76ee\u6807\u4f18\u5316\u6846\u67b6\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7edf\u4e00\u5efa\u6a21\u6846\u67b6\uff1a\n$$\\mathcal{L} = \\underbrace{\\sum_{(i,j) \\in \\Omega_e} (r_{ij} - \\mathbf{u}_i^T\\mathbf{v}_j)^2}_{\\text{\u663e\u5f0f\u8bc4\u5206}} + \\underbrace{\\sum_{(i,j) \\in \\Omega_i} c_{ij}(p_{ij} - \\mathbf{u}_i^T\\mathbf{v}_j)^2}_{\\text{\u9690\u5f0f\u53cd\u9988}}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$c_{ij} = 1 + \\alpha \\log(1 + \\text{count}_{ij})$ \u662f\u7f6e\u4fe1\u5ea6\u6743\u91cd</li>\n<li>$p_{ij} = 1$ \u8868\u793a\u6709\u4ea4\u4e92\uff0c$p_{ij} = 0$ \u8868\u793a\u91c7\u6837\u7684\u8d1f\u4f8b</li>\n</ul>\n<p>\u81ea\u9002\u5e94\u66f4\u65b0\u7b56\u7565\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">explicit_rating</span><span class=\"w\"> </span><span class=\"nx\">arrives</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nx\">\u03b7_e</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nx\">\u03b7_0</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nx\">sqrt</span><span class=\"p\">(</span><span class=\"nx\">n_explicit</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"nx\">update</span><span class=\"w\"> </span><span class=\"nx\">with</span><span class=\"w\"> </span><span class=\"nx\">weight</span><span class=\"w\"> </span><span class=\"nx\">w_e</span>\n\n<span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">implicit_feedback</span><span class=\"w\"> </span><span class=\"nx\">arrives</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nx\">\u03b7_i</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nx\">\u03b7_0</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nx\">sqrt</span><span class=\"p\">(</span><span class=\"nx\">n_implicit</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"nx\">update</span><span class=\"w\"> </span><span class=\"nx\">with</span><span class=\"w\"> </span><span class=\"nx\">weight</span><span class=\"w\"> </span><span class=\"nx\">w_i</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"nx\">c_ij</span>\n</code></pre></div>\n\n<p>\u52a8\u6001\u6743\u91cd\u8c03\u6574\uff1a\n$$w_e : w_i = \\frac{\\text{var}[\\text{implicit}]}{\\text{var}[\\text{explicit}]} \\cdot \\frac{|\\Omega_i|}{|\\Omega_e|}$$</p>\n<p>\u8fd9\u5e73\u8861\u4e86\u4e24\u79cd\u6570\u636e\u6e90\u7684\u8d21\u732e\uff0c\u8003\u8651\u4e86\u566a\u58f0\u6c34\u5e73\u548c\u6570\u636e\u91cf\u3002</p>\n</details>"
  },
  "../chapter21.md": {
    "hash": "a1c8e48abba50296402e6027de5497c3",
    "content": "<h1 id=\"c\">\u9644\u5f55C\uff1a\u5e38\u7528\u77e9\u9635\u6052\u7b49\u5f0f</h1>\n<p>\u5728\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\uff0c\u5de7\u5999\u8fd0\u7528\u77e9\u9635\u6052\u7b49\u5f0f\u5f80\u5f80\u80fd\u5c06\u539f\u672c\u4e0d\u53ef\u884c\u7684\u8ba1\u7b97\u8f6c\u5316\u4e3a\u9ad8\u6548\u7b97\u6cd5\u3002\u672c\u7ae0\u6c47\u603b\u4e86\u5b9e\u8df5\u4e2d\u6700\u91cd\u8981\u7684\u77e9\u9635\u6052\u7b49\u5f0f\uff0c\u5f3a\u8c03\u5b83\u4eec\u5728\u6570\u503c\u8ba1\u7b97\u4e2d\u7684\u5e94\u7528\u4ef7\u503c\u3002\u6bcf\u4e2a\u6052\u7b49\u5f0f\u4e0d\u4ec5\u7ed9\u51fa\u6570\u5b66\u8868\u8fbe\uff0c\u66f4\u91cd\u8981\u7684\u662f\u8bf4\u660e\u5176\u8ba1\u7b97\u590d\u6742\u5ea6\u7684\u6539\u8fdb\u548c\u6570\u503c\u7a33\u5b9a\u6027\u7684\u8003\u91cf\u3002</p>\n<h2 id=\"211\">21.1 \u77e9\u9635\u6c42\u9006\u6052\u7b49\u5f0f</h2>\n<h3 id=\"2111-woodbury\">21.1.1 Woodbury\u77e9\u9635\u6052\u7b49\u5f0f</h3>\n<p>\u6700\u91cd\u8981\u7684\u77e9\u9635\u6c42\u9006\u516c\u5f0f\u4e4b\u4e00\uff1a</p>\n<p>$$(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{U}(\\mathbf{C}^{-1} + \\mathbf{V}^T\\mathbf{A}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{A}^{-1}$$\n\u5176\u4e2d $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$\uff0c$\\mathbf{U} \\in \\mathbb{R}^{n \\times k}$\uff0c$\\mathbf{C} \\in \\mathbb{R}^{k \\times k}$\uff0c$\\mathbf{V} \\in \\mathbb{R}^{n \\times k}$\u3002</p>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u6539\u8fdb</strong>\uff1a\u5f53 $k \\ll n$ \u65f6\uff0c\u5c06 $O(n^3)$ \u7684\u76f4\u63a5\u6c42\u9006\u964d\u81f3 $O(n^2k)$\u3002</p>\n<p><strong>\u5178\u578b\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>\u589e\u91cf\u6700\u5c0f\u4e8c\u4e58\u66f4\u65b0</li>\n<li>\u4f4e\u79e9\u4fee\u6b63\u7684\u5feb\u901f\u6c42\u9006</li>\n<li>Schur\u8865\u8ba1\u7b97</li>\n<li>\u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5\u7684\u534f\u65b9\u5dee\u66f4\u65b0</li>\n</ul>\n<h3 id=\"2112-sherman-morrison\">21.1.2 Sherman-Morrison\u516c\u5f0f</h3>\n<p>Woodbury\u6052\u7b49\u5f0f\u7684\u7279\u4f8b\uff08$k=1$\uff09\uff1a\n$$(\\mathbf{A} + \\mathbf{u}\\mathbf{v}^T)^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{u}\\mathbf{v}^T\\mathbf{A}^{-1}}{1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}}$$\n<strong>\u6570\u503c\u7a33\u5b9a\u6027\u6ce8\u610f</strong>\uff1a\u5206\u6bcd $1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}$ \u63a5\u8fd1\u96f6\u65f6\u9700\u7279\u6b8a\u5904\u7406\u3002</p>\n<h3 id=\"2113\">21.1.3 \u5757\u77e9\u9635\u6c42\u9006</h3>\n<p>\u5bf9\u4e8e\u5206\u5757\u77e9\u9635\uff1a\n$$\\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{C} &amp; \\mathbf{D} \\end{pmatrix}^{-1} = \\begin{pmatrix} \\mathbf{A}^{-1} + \\mathbf{A}^{-1}\\mathbf{B}\\mathbf{S}^{-1}\\mathbf{C}\\mathbf{A}^{-1} &amp; -\\mathbf{A}^{-1}\\mathbf{B}\\mathbf{S}^{-1} \\ -\\mathbf{S}^{-1}\\mathbf{C}\\mathbf{A}^{-1} &amp; \\mathbf{S}^{-1} \\end{pmatrix}$$\n\u5176\u4e2d $\\mathbf{S} = \\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$ \u662fSchur\u8865\u3002</p>\n<p><strong>\u66ff\u4ee3\u5f62\u5f0f</strong>\uff08\u5f53 $\\mathbf{D}^{-1}$ \u66f4\u6613\u8ba1\u7b97\u65f6\uff09\uff1a\n$$\\begin{pmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{C} &amp; \\mathbf{D} \\end{pmatrix}^{-1} = \\begin{pmatrix} \\mathbf{T}^{-1} &amp; -\\mathbf{T}^{-1}\\mathbf{B}\\mathbf{D}^{-1} \\ -\\mathbf{D}^{-1}\\mathbf{C}\\mathbf{T}^{-1} &amp; \\mathbf{D}^{-1} + \\mathbf{D}^{-1}\\mathbf{C}\\mathbf{T}^{-1}\\mathbf{B}\\mathbf{D}^{-1} \\end{pmatrix}$$\n\u5176\u4e2d $\\mathbf{T} = \\mathbf{A} - \\mathbf{B}\\mathbf{D}^{-1}\\mathbf{C}$\u3002</p>\n<h3 id=\"2114-neumann\">21.1.4 Neumann\u7ea7\u6570</h3>\n<p>\u5f53 $|\\mathbf{B}| &lt; 1$ \u65f6\uff1a\n$$(\\mathbf{I} - \\mathbf{B})^{-1} = \\sum_{k=0}^{\\infty} \\mathbf{B}^k = \\mathbf{I} + \\mathbf{B} + \\mathbf{B}^2 + \\mathbf{B}^3 + \\cdots$$\n<strong>\u5b9e\u7528\u622a\u65ad\u5f62\u5f0f</strong>\uff1a\n$$(\\mathbf{I} - \\mathbf{B})^{-1} \\approx \\sum_{k=0}^{K} \\mathbf{B}^k$$\n\u8bef\u5dee\u754c\uff1a$|\\text{error}| \\leq \\frac{|\\mathbf{B}|^{K+1}}{1-|\\mathbf{B}|}$</p>\n<h2 id=\"212\">21.2 \u8ff9\u4e0e\u884c\u5217\u5f0f\u6052\u7b49\u5f0f</h2>\n<h3 id=\"2121\">21.2.1 \u8ff9\u7684\u5faa\u73af\u6027\u8d28</h3>\n<p>$$\\text{tr}(\\mathbf{A}\\mathbf{B}\\mathbf{C}) = \\text{tr}(\\mathbf{B}\\mathbf{C}\\mathbf{A}) = \\text{tr}(\\mathbf{C}\\mathbf{A}\\mathbf{B})$$\n<strong>\u8ba1\u7b97\u4f18\u5316\u5e94\u7528</strong>\uff1a\u9009\u62e9\u8ba1\u7b97\u91cf\u6700\u5c0f\u7684\u987a\u5e8f\u3002\u4f8b\u5982\uff0c\u82e5 $\\mathbf{A} \\in \\mathbb{R}^{n \\times k}$\uff0c$\\mathbf{B} \\in \\mathbb{R}^{k \\times m}$\uff0c$\\mathbf{C} \\in \\mathbb{R}^{m \\times n}$\uff0c\u4e14 $k \\ll n, m$\uff0c\u5219\u8ba1\u7b97 $\\text{tr}(\\mathbf{B}\\mathbf{C}\\mathbf{A})$ \u6700\u9ad8\u6548\u3002</p>\n<h3 id=\"2122\">21.2.2 \u8ff9\u7684\u7ebf\u6027\u6027\u8d28</h3>\n<p>$$\\text{tr}(\\mathbf{A} + \\mathbf{B}) = \\text{tr}(\\mathbf{A}) + \\text{tr}(\\mathbf{B})$$\n$$\\text{tr}(c\\mathbf{A}) = c \\cdot \\text{tr}(\\mathbf{A})$$</p>\n<h3 id=\"2123\">21.2.3 \u5185\u79ef\u7684\u8ff9\u8868\u793a</h3>\n<p>$$\\mathbf{x}^T\\mathbf{y} = \\text{tr}(\\mathbf{y}\\mathbf{x}^T)$$\n$$\\langle \\mathbf{A}, \\mathbf{B} \\rangle_F = \\text{tr}(\\mathbf{A}^T\\mathbf{B}) = \\text{tr}(\\mathbf{B}^T\\mathbf{A})$$</p>\n<h3 id=\"2124\">21.2.4 \u884c\u5217\u5f0f\u6052\u7b49\u5f0f</h3>\n<p><strong>\u77e9\u9635\u884c\u5217\u5f0f\u5f15\u7406</strong>\uff1a\n$$\\det(\\mathbf{A} + \\mathbf{u}\\mathbf{v}^T) = \\det(\\mathbf{A})(1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u})$$\n<strong>Sylvester\u884c\u5217\u5f0f\u5b9a\u7406</strong>\uff1a\n$$\\det(\\mathbf{I}_n + \\mathbf{A}\\mathbf{B}) = \\det(\\mathbf{I}_m + \\mathbf{B}\\mathbf{A})$$\n\u5176\u4e2d $\\mathbf{A} \\in \\mathbb{R}^{n \\times m}$\uff0c$\\mathbf{B} \\in \\mathbb{R}^{m \\times n}$\u3002</p>\n<h3 id=\"2125\">21.2.5 \u5bf9\u6570\u884c\u5217\u5f0f\u6280\u5de7</h3>\n<p>\u4e3a\u907f\u514d\u6570\u503c\u6ea2\u51fa\uff1a\n$$\\log\\det(\\mathbf{A}) = \\text{tr}(\\log(\\mathbf{A})) = \\sum_{i=1}^n \\log(\\lambda_i)$$\n\u5176\u4e2d $\\lambda_i$ \u662f $\\mathbf{A}$ \u7684\u7279\u5f81\u503c\u3002\u5b9e\u8df5\u4e2d\u901a\u8fc7Cholesky\u5206\u89e3\u8ba1\u7b97\uff1a\n$$\\log\\det(\\mathbf{A}) = 2\\sum_{i=1}^n \\log(L_{ii})$$\n\u5176\u4e2d $\\mathbf{L}$ \u662f $\\mathbf{A} = \\mathbf{L}\\mathbf{L}^T$ \u7684Cholesky\u56e0\u5b50\u3002</p>\n<h2 id=\"213\">21.3 \u7279\u5f81\u503c\u4e0e\u5947\u5f02\u503c\u6052\u7b49\u5f0f</h2>\n<h3 id=\"2131\">21.3.1 \u8c31\u5b9a\u7406\u5e94\u7528</h3>\n<p>\u5bf9\u79f0\u77e9\u9635 $\\mathbf{A} = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^T$\uff1a\n$$\\mathbf{A}^k = \\mathbf{Q}\\mathbf{\\Lambda}^k\\mathbf{Q}^T$$\n$$f(\\mathbf{A}) = \\mathbf{Q}f(\\mathbf{\\Lambda})\\mathbf{Q}^T$$\n\u5176\u4e2d $f(\\mathbf{\\Lambda}) = \\text{diag}(f(\\lambda_1), \\ldots, f(\\lambda_n))$\u3002</p>\n<h3 id=\"2132\">21.3.2 \u7279\u5f81\u503c\u6270\u52a8\u754c</h3>\n<p><strong>Weyl\u4e0d\u7b49\u5f0f</strong>\uff1a\u8bbe $\\lambda_i(\\mathbf{A})$ \u8868\u793a\u6309\u964d\u5e8f\u6392\u5217\u7684\u7279\u5f81\u503c\uff0c\u5219\uff1a\n$$|\\lambda_i(\\mathbf{A} + \\mathbf{E}) - \\lambda_i(\\mathbf{A})| \\leq |\\mathbf{E}|_2$$\n<strong>Hoffman-Wielandt\u5b9a\u7406</strong>\uff1a\n$$\\sum_{i=1}^n |\\lambda_i(\\mathbf{A} + \\mathbf{E}) - \\lambda_i(\\mathbf{A})|^2 \\leq |\\mathbf{E}|_F^2$$</p>\n<h3 id=\"2133\">21.3.3 \u4ea4\u7ec7\u5b9a\u7406</h3>\n<p>\u5bf9\u4e8e $n \\times n$ \u5bf9\u79f0\u77e9\u9635 $\\mathbf{A}$ \u53ca\u5176 $(n-1) \\times (n-1)$ \u4e3b\u5b50\u77e9\u9635 $\\mathbf{A}_{-i}$\uff1a\n$$\\lambda_1(\\mathbf{A}) \\geq \\lambda_1(\\mathbf{A}_{-i}) \\geq \\lambda_2(\\mathbf{A}) \\geq \\cdots \\geq \\lambda_{n-1}(\\mathbf{A}_{-i}) \\geq \\lambda_n(\\mathbf{A})$$</p>\n<h3 id=\"2134\">21.3.4 \u5947\u5f02\u503c\u6052\u7b49\u5f0f</h3>\n<p>$$\\sigma_i(\\mathbf{A}) = \\sqrt{\\lambda_i(\\mathbf{A}^T\\mathbf{A})} = \\sqrt{\\lambda_i(\\mathbf{A}\\mathbf{A}^T)}$$\n<strong>Eckart-Young\u5b9a\u7406</strong>\uff1a\u6700\u4f18\u79e9-$k$ \u8fd1\u4f3c\n$$\\min_{\\text{rank}(\\mathbf{B})=k} |\\mathbf{A} - \\mathbf{B}|_F = \\sqrt{\\sum_{i=k+1}^{\\min(m,n)} \\sigma_i^2}$$</p>\n<h3 id=\"2135\">21.3.5 \u8ff9\u4e0e\u7279\u5f81\u503c\u5173\u7cfb</h3>\n<p>$$\\text{tr}(\\mathbf{A}) = \\sum_{i=1}^n \\lambda_i(\\mathbf{A})$$\n$$\\text{tr}(\\mathbf{A}^k) = \\sum_{i=1}^n \\lambda_i^k(\\mathbf{A})$$</p>\n<h2 id=\"214-kroneckerhadamard\">21.4 Kronecker\u79ef\u4e0eHadamard\u79ef\u6052\u7b49\u5f0f</h2>\n<h3 id=\"2141-kronecker\">21.4.1 Kronecker\u79ef\u57fa\u672c\u6027\u8d28</h3>\n<p>$$(\\mathbf{A} \\otimes \\mathbf{B})^T = \\mathbf{A}^T \\otimes \\mathbf{B}^T$$\n$$(\\mathbf{A} \\otimes \\mathbf{B})^{-1} = \\mathbf{A}^{-1} \\otimes \\mathbf{B}^{-1}$$\n$$(\\mathbf{A} \\otimes \\mathbf{B})(\\mathbf{C} \\otimes \\mathbf{D}) = (\\mathbf{A}\\mathbf{C}) \\otimes (\\mathbf{B}\\mathbf{D})$$</p>\n<h3 id=\"2142\">21.4.2 \u6df7\u5408\u79ef\u89c4\u5219</h3>\n<p>$$(\\mathbf{A} \\otimes \\mathbf{B}) + (\\mathbf{C} \\otimes \\mathbf{D}) = (\\mathbf{A} + \\mathbf{C}) \\otimes \\mathbf{B} \\quad \\text{\uff08\u4ec5\u5f53} \\mathbf{B} = \\mathbf{D}\\text{\uff09}$$</p>\n<h3 id=\"2143\">21.4.3 \u5411\u91cf\u5316\u6280\u5de7</h3>\n<p>$$\\text{vec}(\\mathbf{A}\\mathbf{X}\\mathbf{B}) = (\\mathbf{B}^T \\otimes \\mathbf{A})\\text{vec}(\\mathbf{X})$$\n\u7279\u522b\u5730\uff1a\n$$\\text{vec}(\\mathbf{A}\\mathbf{X}) = (\\mathbf{I} \\otimes \\mathbf{A})\\text{vec}(\\mathbf{X})$$\n$$\\text{vec}(\\mathbf{X}\\mathbf{B}) = (\\mathbf{B}^T \\otimes \\mathbf{I})\\text{vec}(\\mathbf{X})$$</p>\n<h3 id=\"2144-hadamard\">21.4.4 Hadamard\u79ef\u6027\u8d28</h3>\n<p>$$(A \\odot B)^T = A^T \\odot B^T$$\n$$\\text{rank}(A \\odot B) \\leq \\text{rank}(A) \\cdot \\text{rank}(B)$$\n$$A \\odot (B + C) = (A \\odot B) + (A \\odot C)$$\n<strong>\u4e0eKronecker\u79ef\u7684\u5173\u7cfb</strong>\uff1a\n$$\\text{diag}(\\mathbf{a}) \\mathbf{B} \\text{diag}(\\mathbf{c}) = \\mathbf{B} \\odot (\\mathbf{a}\\mathbf{c}^T)$$</p>\n<h2 id=\"215\">21.5 \u77e9\u9635\u5bfc\u6570\u516c\u5f0f</h2>\n<h3 id=\"2151\">21.5.1 \u57fa\u672c\u5bfc\u6570\u89c4\u5219</h3>\n<p>$$\\frac{\\partial}{\\partial \\mathbf{X}} \\text{tr}(\\mathbf{A}\\mathbf{X}) = \\mathbf{A}^T$$\n$$\\frac{\\partial}{\\partial \\mathbf{X}} \\text{tr}(\\mathbf{X}^T\\mathbf{A}) = \\mathbf{A}$$\n$$\\frac{\\partial}{\\partial \\mathbf{X}} \\text{tr}(\\mathbf{A}\\mathbf{X}\\mathbf{B}) = \\mathbf{A}^T\\mathbf{B}^T$$\n$$\\frac{\\partial}{\\partial \\mathbf{X}} \\text{tr}(\\mathbf{X}^T\\mathbf{A}\\mathbf{X}) = (\\mathbf{A} + \\mathbf{A}^T)\\mathbf{X}$$</p>\n<h3 id=\"2152\">21.5.2 \u884c\u5217\u5f0f\u5bfc\u6570</h3>\n<p>$$\\frac{\\partial}{\\partial \\mathbf{X}} \\log\\det(\\mathbf{X}) = \\mathbf{X}^{-T}$$\n$$\\frac{\\partial}{\\partial \\mathbf{X}} \\det(\\mathbf{X}) = \\det(\\mathbf{X})\\mathbf{X}^{-T}$$</p>\n<h3 id=\"2153\">21.5.3 \u9006\u77e9\u9635\u5bfc\u6570</h3>\n<p>$$\\frac{\\partial}{\\partial t} \\mathbf{A}^{-1}(t) = -\\mathbf{A}^{-1}(t) \\frac{\\partial \\mathbf{A}(t)}{\\partial t} \\mathbf{A}^{-1}(t)$$</p>\n<h3 id=\"2154\">21.5.4 \u94fe\u5f0f\u6cd5\u5219</h3>\n<p>\u5bf9\u4e8e $f(\\mathbf{A}(\\mathbf{X}))$\uff1a\n$$\\frac{\\partial f}{\\partial X_{ij}} = \\text{tr}\\left(\\left(\\frac{\\partial f}{\\partial \\mathbf{A}}\\right)^T \\frac{\\partial \\mathbf{A}}{\\partial X_{ij}}\\right)$$</p>\n<h2 id=\"216\">21.6 \u7279\u6b8a\u7ed3\u6784\u77e9\u9635\u6052\u7b49\u5f0f</h2>\n<h3 id=\"2161\">21.6.1 \u5bf9\u79f0\u77e9\u9635\u6027\u8d28</h3>\n<p>\u5bf9\u4e8e\u5bf9\u79f0\u77e9\u9635 $\\mathbf{S}$\uff1a</p>\n<ul>\n<li>\u6240\u6709\u7279\u5f81\u503c\u4e3a\u5b9e\u6570</li>\n<li>\u5b58\u5728\u6b63\u4ea4\u5bf9\u89d2\u5316 $\\mathbf{S} = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^T$</li>\n<li>$\\mathbf{S}^{1/2} = \\mathbf{Q}\\mathbf{\\Lambda}^{1/2}\\mathbf{Q}^T$\uff08\u5f53 $\\mathbf{S} \\succeq 0$\uff09</li>\n</ul>\n<h3 id=\"2162\">21.6.2 \u6b63\u4ea4\u77e9\u9635\u6027\u8d28</h3>\n<p>\u5bf9\u4e8e\u6b63\u4ea4\u77e9\u9635 $\\mathbf{Q}$\uff08$\\mathbf{Q}^T\\mathbf{Q} = \\mathbf{I}$\uff09\uff1a</p>\n<ul>\n<li>$|\\mathbf{Q}\\mathbf{x}|_2 = |\\mathbf{x}|_2$\uff08\u4fdd\u8303\u6027\uff09</li>\n<li>$\\det(\\mathbf{Q}) = \\pm 1$</li>\n<li>\u6240\u6709\u7279\u5f81\u503c\u7684\u6a21\u4e3a1</li>\n<li>$\\mathbf{Q}^{-1} = \\mathbf{Q}^T$</li>\n</ul>\n<h3 id=\"2163\">21.6.3 \u6b63\u5b9a\u77e9\u9635\u6027\u8d28</h3>\n<p>\u5bf9\u4e8e\u6b63\u5b9a\u77e9\u9635 $\\mathbf{P} \\succ 0$\uff1a</p>\n<ul>\n<li>Cholesky\u5206\u89e3\u5b58\u5728\u4e14\u552f\u4e00\uff1a$\\mathbf{P} = \\mathbf{L}\\mathbf{L}^T$</li>\n<li>\u6240\u6709\u4e3b\u5b50\u77e9\u9635\u4e5f\u662f\u6b63\u5b9a\u7684</li>\n<li>$\\mathbf{A}^T\\mathbf{P}\\mathbf{A} \\succeq 0$\uff0c\u7b49\u53f7\u6210\u7acb\u5f53\u4e14\u4ec5\u5f53 $\\mathbf{A}\\mathbf{x} = 0$</li>\n</ul>\n<h3 id=\"2164\">21.6.4 \u6295\u5f71\u77e9\u9635\u6027\u8d28</h3>\n<p>\u5bf9\u4e8e\u6295\u5f71\u77e9\u9635 $\\mathbf{P}$\uff08$\\mathbf{P}^2 = \\mathbf{P}$\uff09\uff1a</p>\n<ul>\n<li>\u7279\u5f81\u503c\u53ea\u80fd\u662f0\u62161</li>\n<li>$\\text{rank}(\\mathbf{P}) = \\text{tr}(\\mathbf{P})$</li>\n<li>\u6b63\u4ea4\u6295\u5f71\u65f6\uff1a$\\mathbf{P} = \\mathbf{P}^T$</li>\n</ul>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6c47\u603b\u7684\u77e9\u9635\u6052\u7b49\u5f0f\u662f\u5927\u89c4\u6a21\u8ba1\u7b97\u7684\u57fa\u7840\u5de5\u5177\u3002\u5173\u952e\u8981\u70b9\uff1a</p>\n<ol>\n<li><strong>Woodbury\u6052\u7b49\u5f0f</strong>\u662f\u5904\u7406\u4f4e\u79e9\u66f4\u65b0\u7684\u6838\u5fc3\uff0c\u5c06\u9ad8\u7ef4\u6c42\u9006\u8f6c\u5316\u4e3a\u4f4e\u7ef4\u8ba1\u7b97</li>\n<li><strong>\u8ff9\u7684\u5faa\u73af\u6027\u8d28</strong>\u5141\u8bb8\u91cd\u6392\u77e9\u9635\u4e58\u79ef\u4ee5\u4f18\u5316\u8ba1\u7b97\u987a\u5e8f</li>\n<li><strong>Kronecker\u79ef\u7684\u5411\u91cf\u5316\u6280\u5de7</strong>\u5c06\u77e9\u9635\u65b9\u7a0b\u8f6c\u5316\u4e3a\u5411\u91cf\u5f62\u5f0f\uff0c\u4fbf\u4e8e\u6c42\u89e3</li>\n<li><strong>\u77e9\u9635\u5bfc\u6570\u516c\u5f0f</strong>\u662f\u4f18\u5316\u7b97\u6cd5\u548c\u81ea\u52a8\u5fae\u5206\u7684\u7406\u8bba\u57fa\u7840</li>\n<li><strong>\u7279\u6b8a\u7ed3\u6784</strong>\uff08\u5bf9\u79f0\u3001\u6b63\u4ea4\u3001\u6b63\u5b9a\uff09\u7684\u6027\u8d28\u53ef\u5927\u5e45\u7b80\u5316\u8ba1\u7b97</li>\n</ol>\n<p>\u8bb0\u4f4f\uff1a\u9009\u62e9\u5408\u9002\u7684\u6052\u7b49\u5f0f\u5f80\u5f80\u80fd\u5c06\u4e0d\u53ef\u884c\u7684\u8ba1\u7b97\u53d8\u4e3a\u5b9e\u9645\u53ef\u884c\uff0c\u7279\u522b\u662f\u5728\u5904\u7406\u5927\u89c4\u6a21\u7a00\u758f\u6216\u4f4e\u79e9\u7ed3\u6784\u65f6\u3002</p>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"211_1\">\u7ec3\u4e6021.1\uff08\u57fa\u7840\uff09</h3>\n<p>\u8bc1\u660eSherman-Morrison\u516c\u5f0f\u662fWoodbury\u6052\u7b49\u5f0f\u7684\u7279\u4f8b\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4ee4 $\\mathbf{U} = \\mathbf{u}$\uff0c$\\mathbf{V}^T = \\mathbf{v}^T$\uff0c$\\mathbf{C} = 1$\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5728Woodbury\u6052\u7b49\u5f0f\u4e2d\u8bbe\u7f6e $\\mathbf{U} = \\mathbf{u}$\uff08\u5217\u5411\u91cf\uff09\uff0c$\\mathbf{V}^T = \\mathbf{v}^T$\uff08\u884c\u5411\u91cf\uff09\uff0c$\\mathbf{C} = 1$\uff08\u6807\u91cf\uff09\u3002\u5219\uff1a\n$$(\\mathbf{A} + \\mathbf{u} \\cdot 1 \\cdot \\mathbf{v}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{u}(1^{-1} + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u})^{-1}\\mathbf{v}^T\\mathbf{A}^{-1}$$\n\u7531\u4e8e $(1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u})^{-1} = \\frac{1}{1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}}$\uff0c\u5f97\u5230Sherman-Morrison\u516c\u5f0f\u3002</p>\n</details>\n<h3 id=\"212_1\">\u7ec3\u4e6021.2\uff08\u57fa\u7840\uff09</h3>\n<p>\u5229\u7528\u8ff9\u7684\u5faa\u73af\u6027\u8d28\uff0c\u627e\u51fa\u8ba1\u7b97 $\\text{tr}(\\mathbf{A}\\mathbf{B}\\mathbf{C}\\mathbf{D})$ \u7684\u6700\u4f18\u987a\u5e8f\uff0c\u5176\u4e2d $\\mathbf{A} \\in \\mathbb{R}^{1000 \\times 10}$\uff0c$\\mathbf{B} \\in \\mathbb{R}^{10 \\times 1000}$\uff0c$\\mathbf{C} \\in \\mathbb{R}^{1000 \\times 10}$\uff0c$\\mathbf{D} \\in \\mathbb{R}^{10 \\times 1000}$\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u6bd4\u8f83\u4e0d\u540c\u987a\u5e8f\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\uff0c\u8003\u8651\u4e2d\u95f4\u77e9\u9635\u7684\u5927\u5c0f\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u53ef\u80fd\u7684\u8ba1\u7b97\u987a\u5e8f\u53ca\u590d\u6742\u5ea6\uff1a</p>\n<ol>\n<li>$\\text{tr}((\\mathbf{A}\\mathbf{B})(\\mathbf{C}\\mathbf{D}))$\uff1a$\\mathbf{A}\\mathbf{B}$ \u662f $1000 \\times 1000$\uff0c\u590d\u6742\u5ea6 $O(10^7)$</li>\n<li>$\\text{tr}(((\\mathbf{A}\\mathbf{B})\\mathbf{C})\\mathbf{D})$\uff1a\u540c\u6837\u9700\u8981\u8ba1\u7b97 $1000 \\times 1000$ \u77e9\u9635</li>\n<li>$\\text{tr}(\\mathbf{B}(\\mathbf{C}\\mathbf{D})\\mathbf{A})$\uff1a$\\mathbf{C}\\mathbf{D}$ \u662f $1000 \\times 1000$\uff0c\u590d\u6742\u5ea6\u9ad8</li>\n<li>$\\text{tr}((\\mathbf{B}\\mathbf{C})(\\mathbf{D}\\mathbf{A}))$\uff1a$\\mathbf{B}\\mathbf{C}$ \u548c $\\mathbf{D}\\mathbf{A}$ \u90fd\u662f $10 \\times 10$\uff0c\u590d\u6742\u5ea6 $O(10^5)$</li>\n</ol>\n<p>\u6700\u4f18\u987a\u5e8f\u662f\u7b2c4\u79cd\uff0c\u5148\u8ba1\u7b97 $\\mathbf{B}\\mathbf{C}$ \u548c $\\mathbf{D}\\mathbf{A}$\u3002</p>\n</details>\n<h3 id=\"213_1\">\u7ec3\u4e6021.3\uff08\u57fa\u7840\uff09</h3>\n<p>\u63a8\u5bfc\u6b63\u5b9a\u77e9\u9635 $\\mathbf{A}$ \u7684\u6761\u4ef6\u6570\u4e0e\u5176\u6700\u5927\u6700\u5c0f\u7279\u5f81\u503c\u7684\u5173\u7cfb\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u56de\u5fc6\u6761\u4ef6\u6570\u5b9a\u4e49 $\\kappa(\\mathbf{A}) = |\\mathbf{A}|_2 |\\mathbf{A}^{-1}|_2$\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e\u6b63\u5b9a\u77e9\u9635\uff1a</p>\n<ul>\n<li>$|\\mathbf{A}|_2 = \\lambda_{\\max}(\\mathbf{A})$</li>\n<li>$|\\mathbf{A}^{-1}|_2 = \\lambda_{\\max}(\\mathbf{A}^{-1}) = \\frac{1}{\\lambda_{\\min}(\\mathbf{A})}$</li>\n</ul>\n<p>\u56e0\u6b64\uff1a\n$$\\kappa(\\mathbf{A}) = \\lambda_{\\max}(\\mathbf{A}) \\cdot \\frac{1}{\\lambda_{\\min}(\\mathbf{A})} = \\frac{\\lambda_{\\max}(\\mathbf{A})}{\\lambda_{\\min}(\\mathbf{A})}$$</p>\n</details>\n<h3 id=\"214\">\u7ec3\u4e6021.4\uff08\u6311\u6218\uff09</h3>\n<p>\u8bbe $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ \u662f\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\uff0c$\\mathbf{B} \\in \\mathbb{R}^{n \\times k}$ \u4e14 $k \\ll n$\u3002\u63a8\u5bfc\u4e00\u4e2a\u9ad8\u6548\u7b97\u6cd5\u8ba1\u7b97 $(\\mathbf{A} + \\mathbf{B}\\mathbf{B}^T)^{-1}\\mathbf{B}$\uff0c\u907f\u514d\u663e\u5f0f\u8ba1\u7b97\u9006\u77e9\u9635\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4f7f\u7528Woodbury\u6052\u7b49\u5f0f\uff0c\u6ce8\u610f\u6700\u7ec8\u76ee\u6807\u662f\u8ba1\u7b97 $(\\mathbf{A} + \\mathbf{B}\\mathbf{B}^T)^{-1}\\mathbf{B}$\uff0c\u800c\u975e\u5355\u72ec\u7684\u9006\u77e9\u9635\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5e94\u7528Woodbury\u6052\u7b49\u5f0f\uff08$\\mathbf{U} = \\mathbf{V} = \\mathbf{B}$\uff0c$\\mathbf{C} = \\mathbf{I}_k$\uff09\uff1a\n$$(\\mathbf{A} + \\mathbf{B}\\mathbf{B}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{B}(\\mathbf{I}_k + \\mathbf{B}^T\\mathbf{A}^{-1}\\mathbf{B})^{-1}\\mathbf{B}^T\\mathbf{A}^{-1}$$\n\u56e0\u6b64\uff1a\n$$(\\mathbf{A} + \\mathbf{B}\\mathbf{B}^T)^{-1}\\mathbf{B} = \\mathbf{A}^{-1}\\mathbf{B} - \\mathbf{A}^{-1}\\mathbf{B}(\\mathbf{I}_k + \\mathbf{B}^T\\mathbf{A}^{-1}\\mathbf{B})^{-1}\\mathbf{B}^T\\mathbf{A}^{-1}\\mathbf{B}$$\n\u4ee4 $\\mathbf{Z} = \\mathbf{A}^{-1}\\mathbf{B}$\uff0c\u5219\uff1a\n$$(\\mathbf{A} + \\mathbf{B}\\mathbf{B}^T)^{-1}\\mathbf{B} = \\mathbf{Z} - \\mathbf{Z}(\\mathbf{I}_k + \\mathbf{B}^T\\mathbf{Z})^{-1}\\mathbf{B}^T\\mathbf{Z} = \\mathbf{Z}(\\mathbf{I}_k + \\mathbf{B}^T\\mathbf{Z})^{-1}$$\n\u8ba1\u7b97\u6b65\u9aa4\uff1a</p>\n<ol>\n<li>\u89e3\u7ebf\u6027\u7cfb\u7edf $\\mathbf{A}\\mathbf{Z} = \\mathbf{B}$ \u5f97\u5230 $\\mathbf{Z}$</li>\n<li>\u8ba1\u7b97 $k \\times k$ \u77e9\u9635 $\\mathbf{M} = \\mathbf{I}_k + \\mathbf{B}^T\\mathbf{Z}$</li>\n<li>\u89e3 $k \\times k$ \u7cfb\u7edf $\\mathbf{M}\\mathbf{Y} = \\mathbf{I}_k$</li>\n<li>\u8ba1\u7b97 $\\mathbf{Z}\\mathbf{Y}$</li>\n</ol>\n<p>\u603b\u590d\u6742\u5ea6\uff1a$O(n^2k + k^3)$\uff0c\u8fdc\u4f18\u4e8e\u76f4\u63a5\u6c42\u9006\u7684 $O(n^3)$\u3002</p>\n</details>\n<h3 id=\"215_1\">\u7ec3\u4e6021.5\uff08\u6311\u6218\uff09</h3>\n<p>\u8bc1\u660e\u5bf9\u4e8e\u4efb\u610f\u77e9\u9635 $\\mathbf{A}, \\mathbf{B} \\in \\mathbb{R}^{n \\times n}$\uff0c\u6709\uff1a\n$$\\text{eig}(\\mathbf{A} \\otimes \\mathbf{I} + \\mathbf{I} \\otimes \\mathbf{B}) = {\\lambda_i + \\mu_j : i,j = 1,\\ldots,n}$$\n\u5176\u4e2d $\\lambda_i$ \u548c $\\mu_j$ \u5206\u522b\u662f $\\mathbf{A}$ \u548c $\\mathbf{B}$ \u7684\u7279\u5f81\u503c\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651 $\\mathbf{A}$ \u548c $\\mathbf{B}$ \u7684\u7279\u5f81\u5411\u91cf\uff0c\u5229\u7528Kronecker\u79ef\u7684\u6027\u8d28\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe $\\mathbf{A}\\mathbf{v}_i = \\lambda_i\\mathbf{v}_i$\uff0c$\\mathbf{B}\\mathbf{w}_j = \\mu_j\\mathbf{w}_j$\u3002\u8003\u8651\u5411\u91cf $\\mathbf{v}_i \\otimes \\mathbf{w}_j$\uff1a\n$$(\\mathbf{A} \\otimes \\mathbf{I} + \\mathbf{I} \\otimes \\mathbf{B})(\\mathbf{v}_i \\otimes \\mathbf{w}_j)$$\n$$= (\\mathbf{A} \\otimes \\mathbf{I})(\\mathbf{v}_i \\otimes \\mathbf{w}_j) + (\\mathbf{I} \\otimes \\mathbf{B})(\\mathbf{v}_i \\otimes \\mathbf{w}_j)$$\n$$= (\\mathbf{A}\\mathbf{v}_i) \\otimes \\mathbf{w}_j + \\mathbf{v}_i \\otimes (\\mathbf{B}\\mathbf{w}_j)$$\n$$= \\lambda_i\\mathbf{v}_i \\otimes \\mathbf{w}_j + \\mathbf{v}_i \\otimes \\mu_j\\mathbf{w}_j$$\n$$= (\\lambda_i + \\mu_j)(\\mathbf{v}_i \\otimes \\mathbf{w}_j)$$\n\u56e0\u6b64 $\\mathbf{v}_i \\otimes \\mathbf{w}_j$ \u662f\u7279\u5f81\u5411\u91cf\uff0c\u5bf9\u5e94\u7279\u5f81\u503c $\\lambda_i + \\mu_j$\u3002\u7531\u4e8e\u8fd9\u7ed9\u51fa\u4e86 $n^2$ \u4e2a\u7ebf\u6027\u72ec\u7acb\u7684\u7279\u5f81\u5411\u91cf\uff0c\u6240\u4ee5\u8fd9\u662f\u5b8c\u6574\u7684\u7279\u5f81\u503c\u96c6\u5408\u3002</p>\n</details>\n<h3 id=\"216_1\">\u7ec3\u4e6021.6\uff08\u6311\u6218\uff09</h3>\n<p>\u7ed9\u5b9a $\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$ \u548c\u5bf9\u79f0\u77e9\u9635 $\\mathbf{S} \\in \\mathbb{R}^{p \\times p}$\uff0c\u63a8\u5bfc $\\frac{\\partial}{\\partial \\mathbf{S}} \\log\\det(\\mathbf{X}^T\\mathbf{X} + \\mathbf{S})$\uff0c\u5047\u8bbe $\\mathbf{X}^T\\mathbf{X} + \\mathbf{S} \\succ 0$\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4f7f\u7528\u94fe\u5f0f\u6cd5\u5219\u548c $\\frac{\\partial}{\\partial \\mathbf{A}} \\log\\det(\\mathbf{A}) = \\mathbf{A}^{-T}$\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4ee4 $\\mathbf{M} = \\mathbf{X}^T\\mathbf{X} + \\mathbf{S}$\u3002\u4f7f\u7528\u94fe\u5f0f\u6cd5\u5219\uff1a\n$$\\frac{\\partial}{\\partial \\mathbf{S}} \\log\\det(\\mathbf{M}) = \\text{tr}\\left(\\frac{\\partial \\log\\det(\\mathbf{M})}{\\partial \\mathbf{M}} \\frac{\\partial \\mathbf{M}}{\\partial \\mathbf{S}}\\right)$$\n\u5df2\u77e5 $\\frac{\\partial}{\\partial \\mathbf{M}} \\log\\det(\\mathbf{M}) = \\mathbf{M}^{-T} = \\mathbf{M}^{-1}$\uff08\u56e0\u4e3a $\\mathbf{M}$ \u5bf9\u79f0\uff09\u3002</p>\n<p>\u7531\u4e8e $\\mathbf{M} = \\mathbf{X}^T\\mathbf{X} + \\mathbf{S}$\uff0c\u6709 $\\frac{\\partial M_{ij}}{\\partial S_{kl}} = \\delta_{ik}\\delta_{jl}$\u3002</p>\n<p>\u8003\u8651\u5230 $\\mathbf{S}$ \u662f\u5bf9\u79f0\u7684\uff0c\u6700\u7ec8\u7ed3\u679c\u662f\uff1a\n$$\\frac{\\partial}{\\partial \\mathbf{S}} \\log\\det(\\mathbf{X}^T\\mathbf{X} + \\mathbf{S}) = (\\mathbf{X}^T\\mathbf{X} + \\mathbf{S})^{-1}$$</p>\n<p>\u6ce8\u610f\uff1a\u5982\u679c\u4e0d\u9650\u5236 $\\mathbf{S}$ \u5bf9\u79f0\uff0c\u5219\u9700\u8981\u5bf9\u7ed3\u679c\u8fdb\u884c\u5bf9\u79f0\u5316\u3002</p>\n</details>\n<h3 id=\"217\">\u7ec3\u4e6021.7\uff08\u5f00\u653e\u6027\u601d\u8003\uff09</h3>\n<p>\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\uff0c\u7ecf\u5e38\u9700\u8981\u8ba1\u7b97\u5f62\u5982 $(\\lambda\\mathbf{I} + \\mathbf{H})^{-1}\\mathbf{g}$ \u7684\u8868\u8fbe\u5f0f\uff0c\u5176\u4e2d $\\mathbf{H}$ \u662fHessian\u77e9\u9635\uff0c$\\mathbf{g}$ \u662f\u68af\u5ea6\u3002\u8ba8\u8bba\u5f53 $\\mathbf{H}$ \u5177\u6709\u4e0d\u540c\u7ed3\u6784\uff08\u4f4e\u79e9\u3001\u7a00\u758f\u3001Kronecker\u56e0\u5b50\u5206\u89e3\uff09\u65f6\uff0c\u5982\u4f55\u8bbe\u8ba1\u9ad8\u6548\u7b97\u6cd5\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u4e0d\u540c\u7ed3\u6784\u4e0b\u7684\u7279\u6b8a\u6c42\u89e3\u6280\u5de7\uff0c\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u663e\u5f0f\u5f62\u6210\u548c\u5b58\u50a8 $\\mathbf{H}$\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4e0d\u540c\u7ed3\u6784\u7684\u5904\u7406\u7b56\u7565\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4f4e\u79e9\u7ed3\u6784</strong> $\\mathbf{H} = \\mathbf{U}\\mathbf{U}^T$\uff1a\n   - \u4f7f\u7528Woodbury\u6052\u7b49\u5f0f\uff1a$(\\lambda\\mathbf{I} + \\mathbf{U}\\mathbf{U}^T)^{-1} = \\frac{1}{\\lambda}\\mathbf{I} - \\frac{1}{\\lambda^2}\\mathbf{U}(\\mathbf{I} + \\frac{1}{\\lambda}\\mathbf{U}^T\\mathbf{U})^{-1}\\mathbf{U}^T$\n   - \u53ea\u9700\u6c42\u89e3 $k \\times k$ \u7cfb\u7edf\uff08$k$ \u662f\u79e9\uff09</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u7ed3\u6784</strong>\uff1a\n   - \u4f7f\u7528\u5171\u8f6d\u68af\u5ea6\u6cd5\uff08CG\uff09\u8fed\u4ee3\u6c42\u89e3\n   - \u5229\u7528\u7a00\u758f\u77e9\u9635\u5411\u91cf\u4e58\u6cd5\n   - \u9884\u6761\u4ef6\u5b50\u9009\u62e9\uff1a\u4e0d\u5b8c\u5168Cholesky\u5206\u89e3</p>\n</li>\n<li>\n<p><strong>Kronecker\u56e0\u5b50\u5206\u89e3</strong> $\\mathbf{H} \\approx \\mathbf{A} \\otimes \\mathbf{B}$\uff1a\n   - $(\\lambda\\mathbf{I} + \\mathbf{A} \\otimes \\mathbf{B})^{-1}\\text{vec}(\\mathbf{G}) = \\text{vec}(\\mathbf{X})$\n   - \u7b49\u4ef7\u4e8e\u6c42\u89e3 Sylvester\u65b9\u7a0b\uff1a$\\lambda\\mathbf{X} + \\mathbf{A}\\mathbf{X}\\mathbf{B}^T = \\mathbf{G}$\n   - \u590d\u6742\u5ea6\u4ece $O(n^3)$ \u964d\u81f3 $O(n^{3/2})$</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7ed3\u6784</strong>\uff08\u4f4e\u79e9+\u5bf9\u89d2\uff09$\\mathbf{H} = \\mathbf{D} + \\mathbf{U}\\mathbf{U}^T$\uff1a\n   - \u518d\u6b21\u4f7f\u7528Woodbury\u6052\u7b49\u5f0f\n   - \u5bf9\u89d2\u90e8\u5206\u6613\u4e8e\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u9690\u5f0f\u8868\u793a</strong>\uff08\u53ea\u6709Hessian-\u5411\u91cf\u79ef\uff09\uff1a\n   - \u4f7f\u7528CG\u6cd5\uff0c\u53ea\u9700\u8981\u8ba1\u7b97 $\\mathbf{H}\\mathbf{v}$\n   - \u901a\u8fc7\u81ea\u52a8\u5fae\u5206\u5b9e\u73b0\uff0c\u907f\u514d\u5b58\u50a8 $\\mathbf{H}$</p>\n</li>\n</ol>\n<p>\u5b9e\u8df5\u5efa\u8bae\uff1a</p>\n<ul>\n<li>\u59cb\u7ec8\u907f\u514d\u663e\u5f0f\u5f62\u6210\u5b8c\u6574Hessian</li>\n<li>\u5229\u7528\u95ee\u9898\u7684\u7279\u6b8a\u7ed3\u6784</li>\n<li>\u8003\u8651\u7cbe\u5ea6-\u6548\u7387\u6743\u8861</li>\n<li>\u76d1\u63a7\u6761\u4ef6\u6570\uff0c\u5fc5\u8981\u65f6\u8c03\u6574 $\\lambda$</li>\n</ul>\n</details>\n<h2 id=\"_3\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u9677\u9631</strong>\n   - Sherman-Morrison\u516c\u5f0f\u4e2d\u5206\u6bcd\u63a5\u8fd1\u96f6\n   - \u89e3\u51b3\u65b9\u6848\uff1a\u68c0\u67e5 $|1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}| &gt; \\epsilon$\uff0c\u5426\u5219\u56de\u9000\u5230\u76f4\u63a5\u65b9\u6cd5</p>\n</li>\n<li>\n<p><strong>\u77e9\u9635\u6c42\u9006\u7684\u8bef\u7528</strong>\n   - \u9519\u8bef\uff1a\u8ba1\u7b97 $\\mathbf{A}^{-1}\\mathbf{b}$ \u65f6\u663e\u5f0f\u6c42\u9006\n   - \u6b63\u786e\uff1a\u89e3\u7ebf\u6027\u7cfb\u7edf $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$</p>\n</li>\n<li>\n<p><strong>Kronecker\u79ef\u7684\u5185\u5b58\u7206\u70b8</strong>\n   - \u9519\u8bef\uff1a\u663e\u5f0f\u5f62\u6210 $\\mathbf{A} \\otimes \\mathbf{B}$\n   - \u6b63\u786e\uff1a\u5229\u7528\u5411\u91cf\u5316\u6280\u5de7\u6216\u4fdd\u6301\u56e0\u5b50\u5f62\u5f0f</p>\n</li>\n<li>\n<p><strong>\u7279\u5f81\u503c\u8ba1\u7b97\u7684\u6761\u4ef6\u6570\u654f\u611f\u6027</strong>\n   - \u75c5\u6001\u77e9\u9635\u7684\u7279\u5f81\u503c\u8ba1\u7b97\u4e0d\u53ef\u9760\n   - \u4f7f\u7528SVD\u4f5c\u4e3a\u66f4\u7a33\u5b9a\u7684\u66ff\u4ee3</p>\n</li>\n<li>\n<p><strong>\u8ff9\u8fd0\u7b97\u7684\u8ba1\u7b97\u987a\u5e8f</strong>\n   - \u5ffd\u89c6\u5faa\u73af\u6027\u8d28\u5bfc\u81f4\u4e0d\u5fc5\u8981\u7684\u5927\u77e9\u9635\u8ba1\u7b97\n   - \u59cb\u7ec8\u9009\u62e9\u8ba1\u7b97\u91cf\u6700\u5c0f\u7684\u987a\u5e8f</p>\n</li>\n<li>\n<p><strong>\u5bf9\u79f0\u6027\u7684\u4e22\u5931</strong>\n   - \u6570\u503c\u8bef\u5dee\u53ef\u80fd\u7834\u574f\u5bf9\u79f0\u6027\n   - \u5b9a\u671f\u8fdb\u884c\u5bf9\u79f0\u5316\uff1a$\\mathbf{A} \\leftarrow (\\mathbf{A} + \\mathbf{A}^T)/2$</p>\n</li>\n</ol>\n<h2 id=\"_4\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<ul>\n<li>[ ] \u8bc6\u522b\u77e9\u9635\u7684\u7279\u6b8a\u7ed3\u6784\uff08\u7a00\u758f\u3001\u4f4e\u79e9\u3001\u5bf9\u79f0\u7b49\uff09</li>\n<li>[ ] \u9009\u62e9\u5229\u7528\u7ed3\u6784\u7684\u6052\u7b49\u5f0f</li>\n<li>[ ] \u907f\u514d\u663e\u5f0f\u77e9\u9635\u6c42\u9006\uff0c\u4f7f\u7528\u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3</li>\n<li>[ ] \u8003\u8651\u6570\u503c\u7a33\u5b9a\u6027\uff0c\u7279\u522b\u662f\u5728\u63a5\u8fd1\u5947\u5f02\u7684\u60c5\u51b5</li>\n<li>[ ] \u5229\u7528\u8ff9\u7684\u5faa\u73af\u6027\u8d28\u4f18\u5316\u8ba1\u7b97\u987a\u5e8f</li>\n<li>[ ] \u4fdd\u6301\u9690\u5f0f\u8868\u793a\u4ee5\u8282\u7701\u5185\u5b58\uff08\u5982Kronecker\u79ef\uff09</li>\n<li>[ ] \u5728\u8fed\u4ee3\u7b97\u6cd5\u4e2d\u76d1\u63a7\u6761\u4ef6\u6570</li>\n<li>[ ] \u4f7f\u7528\u5bf9\u6570\u884c\u5217\u5f0f\u907f\u514d\u6ea2\u51fa</li>\n<li>[ ] \u5b9a\u671f\u9a8c\u8bc1\u5bf9\u79f0\u6027\u548c\u6b63\u5b9a\u6027</li>\n<li>[ ] \u57fa\u51c6\u6d4b\u8bd5\u4e0d\u540c\u65b9\u6cd5\u7684\u6027\u80fd</li>\n</ul>"
  },
  "../chapter1.md": {
    "hash": "d67d802136a9226fc451d739c72de625",
    "content": "<h1 id=\"1\">\u7b2c1\u7ae0\uff1a\u4e8c\u9636\u4f18\u5316\u7684\u7edf\u4e00\u6846\u67b6</h1>\n<p>\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\u901a\u8fc7\u5229\u7528\u66f2\u7387\u4fe1\u606f\u6765\u52a0\u901f\u6536\u655b\uff0c\u662f\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u6838\u5fc3\u6280\u672f\u3002\u672c\u7ae0\u5efa\u7acb\u4e00\u4e2a\u7edf\u4e00\u7684\u6570\u5b66\u6846\u67b6\uff0c\u63ed\u793aNewton\u6cd5\u3001Gauss-Newton\u6cd5\u548cNatural Gradient\u4e4b\u95f4\u7684\u6df1\u523b\u8054\u7cfb\uff0c\u5e76\u63a2\u8ba8\u8fd9\u4e9b\u65b9\u6cd5\u5728\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\u4e0e\u6311\u6218\u3002</p>\n<h2 id=\"11-newtongauss-newtonnatural-gradient\">1.1 Newton\u6cd5\u3001Gauss-Newton\u6cd5\u4e0eNatural Gradient\u7684\u6570\u5b66\u8054\u7cfb</h2>\n<h3 id=\"111\">1.1.1 \u7edf\u4e00\u89c6\u89d2\uff1a\u4ece\u6cf0\u52d2\u5c55\u5f00\u5230\u51e0\u4f55\u89e3\u91ca</h3>\n<p>\u8003\u8651\u4f18\u5316\u95ee\u9898 $\\min_{\\mathbf{w}} f(\\mathbf{w})$\uff0c\u5176\u4e2d $\\mathbf{w} \\in \\mathbb{R}^n$\u3002\u4e8c\u9636\u65b9\u6cd5\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5229\u7528\u76ee\u6807\u51fd\u6570\u7684\u5c40\u90e8\u4e8c\u6b21\u8fd1\u4f3c\uff1a</p>\n<p>$$f(\\mathbf{w} + \\Delta\\mathbf{w}) \\approx f(\\mathbf{w}) + \\nabla f(\\mathbf{w})^T \\Delta\\mathbf{w} + \\frac{1}{2} \\Delta\\mathbf{w}^T \\mathbf{H} \\Delta\\mathbf{w}$$\n\u5176\u4e2d $\\mathbf{H}$ \u662f\u67d0\u79cd\u5f62\u5f0f\u7684\u66f2\u7387\u77e9\u9635\u3002\u4e0d\u540c\u65b9\u6cd5\u7684\u533a\u522b\u5728\u4e8e\u5982\u4f55\u5b9a\u4e49\u548c\u8fd1\u4f3c\u8fd9\u4e2a\u66f2\u7387\u77e9\u9635\u3002</p>\n<p><strong>Newton\u6cd5</strong>\uff1a\u76f4\u63a5\u4f7f\u7528Hessian\u77e9\u9635 $\\mathbf{H} = \\nabla^2 f(\\mathbf{w})$</p>\n<p>\u4e8c\u6b21\u6a21\u578b\uff1a$m_N(\\Delta\\mathbf{w}) = f(\\mathbf{w}) + \\nabla f(\\mathbf{w})^T \\Delta\\mathbf{w} + \\frac{1}{2} \\Delta\\mathbf{w}^T \\nabla^2 f(\\mathbf{w}) \\Delta\\mathbf{w}$</p>\n<p>\u66f4\u65b0\u89c4\u5219\uff1a$\\Delta\\mathbf{w} = -[\\nabla^2 f(\\mathbf{w})]^{-1} \\nabla f(\\mathbf{w})$</p>\n<p><strong>Gauss-Newton\u6cd5</strong>\uff1a\u5bf9\u4e8e\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898 $f(\\mathbf{w}) = \\frac{1}{2}|\\mathbf{r}(\\mathbf{w})|^2$\uff0c\u4f7f\u7528\u4e00\u9636\u8fd1\u4f3c</p>\n<p>\u5b8c\u6574Hessian\uff1a$\\nabla^2 f(\\mathbf{w}) = \\mathbf{J}^T\\mathbf{J} + \\sum_{i=1}^m r_i(\\mathbf{w})\\nabla^2 r_i(\\mathbf{w})$</p>\n<p>Gauss-Newton\u8fd1\u4f3c\uff1a$\\mathbf{H}_{GN} = \\mathbf{J}^T\\mathbf{J}$\uff08\u5ffd\u7565\u4e8c\u9636\u9879\uff09</p>\n<p>\u5176\u4e2d $\\mathbf{J} = \\nabla \\mathbf{r}(\\mathbf{w})$ \u662f\u6b8b\u5dee\u7684Jacobian\u77e9\u9635\u3002</p>\n<p><strong>Natural Gradient</strong>\uff1a\u4ece\u4fe1\u606f\u51e0\u4f55\u89d2\u5ea6\uff0c\u4f7f\u7528Fisher\u4fe1\u606f\u77e9\u9635</p>\n<p>\u53c2\u6570\u7a7a\u95f4\u7684Riemannian\u5ea6\u91cf\uff1a$ds^2 = \\mathbf{d}\\mathbf{w}^T \\mathbf{F}(\\mathbf{w}) \\mathbf{d}\\mathbf{w}$</p>\n<p>Fisher\u4fe1\u606f\u77e9\u9635\uff1a$\\mathbf{F} = \\mathbb{E}_{p(\\mathbf{x}|\\mathbf{w})}[\\nabla \\log p(\\mathbf{x}|\\mathbf{w}) \\nabla \\log p(\\mathbf{x}|\\mathbf{w})^T]$</p>\n<p>Natural gradient\uff1a$\\tilde{\\nabla}f(\\mathbf{w}) = \\mathbf{F}^{-1}(\\mathbf{w})\\nabla f(\\mathbf{w})$</p>\n<p><strong>\u51e0\u4f55\u89e3\u91ca\u7684\u6df1\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6b27\u6c0f\u7a7a\u95f4 vs \u7edf\u8ba1\u6d41\u5f62</strong>\uff1a\n   - Newton\u6cd5\uff1a\u5047\u8bbe\u53c2\u6570\u7a7a\u95f4\u662f\u5e73\u5766\u7684\u6b27\u6c0f\u7a7a\u95f4\n   - Natural Gradient\uff1a\u8003\u8651\u53c2\u6570\u5316\u5f15\u8d77\u7684\u6d41\u5f62\u5f2f\u66f2\n   - \u5ea6\u91cf\u5f20\u91cf\uff1a$g_{ij}(\\mathbf{w}) = \\mathbb{E}[\\partial_i \\ell(\\mathbf{x};\\mathbf{w}) \\partial_j \\ell(\\mathbf{x};\\mathbf{w})]$</p>\n</li>\n<li>\n<p><strong>KL\u6563\u5ea6\u7684\u4e8c\u9636\u8fd1\u4f3c</strong>\uff1a\n$$D_{KL}(p(\\cdot|\\mathbf{w})||p(\\cdot|\\mathbf{w}+\\Delta\\mathbf{w})) \\approx \\frac{1}{2}\\Delta\\mathbf{w}^T\\mathbf{F}(\\mathbf{w})\\Delta\\mathbf{w}$$\n\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48Natural Gradient\u5728\u6982\u7387\u6a21\u578b\u4e2d\u7279\u522b\u6709\u6548\u3002</p>\n</li>\n<li>\n<p><strong>\u5750\u6807\u53d8\u6362\u7684\u4e0d\u53d8\u6027</strong>\uff1a\n   - Newton\u6cd5\uff1a\u5bf9\u4eff\u5c04\u53d8\u6362\u4e0d\u53d8\n   - Natural Gradient\uff1a\u5bf9\u4efb\u610f\u53ef\u5fae\u540c\u80da\u53c2\u6570\u5316\u4e0d\u53d8\n   - \u5b9e\u8df5\u610f\u4e49\uff1a\u5bf9\u7f51\u7edc\u53c2\u6570\u7684\u91cd\u65b0\u7f29\u653e\u5177\u6709\u9c81\u68d2\u6027</p>\n</li>\n</ol>\n<h3 id=\"112\">1.1.2 \u6570\u5b66\u7b49\u4ef7\u6027\u7684\u6761\u4ef6</h3>\n<p><strong>\u5b9a\u7406 1.1</strong>\uff08Gauss-Newton\u4e0eNatural Gradient\u7684\u7b49\u4ef7\u6027\uff09\n\u5bf9\u4e8e\u6307\u6570\u65cf\u5206\u5e03\u7684\u8d1f\u5bf9\u6570\u4f3c\u7136\u6700\u5c0f\u5316\u95ee\u9898\uff0c\u5f53\u6a21\u578b\u6b63\u786e\u6307\u5b9a\u4e14\u5728\u6700\u4f18\u89e3\u5904\u65f6\uff0cGauss-Newton Hessian\u7b49\u4e8eFisher\u4fe1\u606f\u77e9\u9635\u3002</p>\n<p><strong>\u8bc1\u660e\u8981\u70b9</strong>\uff1a</p>\n<ol>\n<li>\u5bf9\u4e8e\u8d1f\u5bf9\u6570\u4f3c\u7136 $f(\\mathbf{w}) = -\\log p(\\mathbf{y}|\\mathbf{x}, \\mathbf{w})$</li>\n<li>\u5728\u6700\u4f18\u89e3\u5904\uff0c\u671f\u671bHessian\u7b49\u4e8eFisher\u4fe1\u606f\u77e9\u9635\uff08Bartlett\u6052\u7b49\u5f0f\uff09</li>\n<li>Gauss-Newton\u5ffd\u7565\u7684\u4e8c\u9636\u9879\u5728\u6700\u4f18\u89e3\u5904\u4e3a\u96f6</li>\n</ol>\n<p><strong>\u66f4\u6df1\u5165\u7684\u7b49\u4ef7\u6027\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u5b9a\u7406 1.1a</strong>\uff08\u5e7f\u4e49\u7ebf\u6027\u6a21\u578b\u4e2d\u7684\u7cbe\u786e\u7b49\u4ef7\uff09\n\u5bf9\u4e8e\u5e7f\u4e49\u7ebf\u6027\u6a21\u578b(GLM)\uff0c\u82e5\u94fe\u63a5\u51fd\u6570\u662fcanonical\u7684\uff0c\u5219\uff1a\n$$\\mathbf{H}_{GN} = \\mathbf{X}^T\\mathbf{W}\\mathbf{X} = \\mathbf{F}$$\n\u5176\u4e2d $\\mathbf{W} = \\text{diag}(w_1, ..., w_n)$ \u662f\u6743\u91cd\u77e9\u9635\u3002</p>\n<p><strong>\u5b9a\u7406 1.1b</strong>\uff08\u6df1\u5ea6\u7f51\u7edc\u4e2d\u7684\u8fd1\u4f3c\u7b49\u4ef7\uff09\n\u5728\u5bbd\u5ea6\u8d8b\u4e8e\u65e0\u7a77\u7684\u795e\u7ecf\u7f51\u7edc\u4e2d\uff0c\u8f93\u51fa\u5c42\u7684Gauss-Newton\u77e9\u9635\u6536\u655b\u5230Neural Tangent Kernel (NTK)\uff1a\n$$\\lim_{m \\to \\infty} \\mathbf{H}_{GN} = \\mathbf{K}_{NTK}$$\n<strong>\u7b49\u4ef7\u6027\u7834\u574f\u7684\u60c5\u5f62</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6a21\u578b\u8bef\u8bbe(Model Misspecification)</strong>\uff1a\n   - \u771f\u5b9e\u6570\u636e\u5206\u5e03 $q(\\mathbf{x})$ \u4e0d\u5728\u6a21\u578b\u65cf ${p(\\mathbf{x}|\\mathbf{w})}$ \u4e2d\n   - \u6b64\u65f6 $\\mathbf{F} \\neq \\mathbb{E}[\\nabla^2 \\ell]$\uff0c\u7b49\u4ef7\u6027\u4e0d\u6210\u7acb\n   - \u5b9e\u8df5\u5efa\u8bae\uff1a\u4f7f\u7528sandwich estimator\u6821\u6b63</p>\n</li>\n<li>\n<p><strong>\u6709\u9650\u6837\u672c\u6548\u5e94</strong>\uff1a\n   - Empirical Fisher: $\\hat{\\mathbf{F}}_n = \\frac{1}{n}\\sum_{i=1}^n \\mathbf{g}_i\\mathbf{g}_i^T$\n   - \u4e0e\u671f\u671bFisher\u7684\u5dee\u5f02\uff1a$|\\hat{\\mathbf{F}}_n - \\mathbf{F}| = O_p(n^{-1/2})$\n   - \u5c0f\u6837\u672c\u4fee\u6b63\uff1a\u4f7f\u7528bootstrap\u6216jackknife\u4f30\u8ba1</p>\n</li>\n<li>\n<p><strong>\u975e\u6e10\u8fd1\u533a\u57df</strong>\uff1a\n   - \u8fdc\u79bb\u6700\u4f18\u89e3\u65f6\uff0cGauss-Newton\u4e22\u5931\u7684\u4e8c\u9636\u9879\u53ef\u80fd\u5f88\u5927\n   - \u91cf\u5316\uff1a$|\\mathbf{H} - \\mathbf{H}_{GN}| \\leq L|\\mathbf{r}(\\mathbf{w})|$\n   - \u81ea\u9002\u5e94\u7b56\u7565\uff1a\u57fa\u4e8e\u6b8b\u5dee\u5927\u5c0f\u6df7\u5408\u4f7f\u7528</p>\n</li>\n</ol>\n<h3 id=\"113\">1.1.3 \u5b9e\u8df5\u4e2d\u7684\u7edf\u4e00\u6846\u67b6</h3>\n<p>\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u65b9\u6cd5\u7edf\u4e00\u4e3a\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf\uff1a\n$$\\mathbf{G}_k \\Delta\\mathbf{w}_k = -\\nabla f(\\mathbf{w}_k)$$\n\u5176\u4e2d $\\mathbf{G}_k$ \u662f\u5e7f\u4e49\u66f2\u7387\u77e9\u9635\uff1a</p>\n<ul>\n<li>Newton: $\\mathbf{G}_k = \\nabla^2 f(\\mathbf{w}_k)$</li>\n<li>Gauss-Newton: $\\mathbf{G}_k = \\mathbf{J}_k^T\\mathbf{J}_k$  </li>\n<li>Natural Gradient: $\\mathbf{G}_k = \\mathbf{F}_k + \\lambda\\mathbf{I}$ (\u5e26\u963b\u5c3c)</li>\n<li>Levenberg-Marquardt: $\\mathbf{G}_k = \\mathbf{J}_k^T\\mathbf{J}_k + \\lambda_k\\text{diag}(\\mathbf{J}_k^T\\mathbf{J}_k)$</li>\n</ul>\n<p><strong>\u6df1\u5165\u5206\u6790\uff1a\u9884\u6761\u4ef6\u5b50\u7684\u9009\u62e9</strong></p>\n<p>\u8fd9\u4e2a\u7edf\u4e00\u6846\u67b6\u7684\u6838\u5fc3\u5728\u4e8e\u5982\u4f55\u9009\u62e9\u5408\u9002\u7684\u9884\u6761\u4ef6\u5b50 $\\mathbf{G}_k$\u3002\u5173\u952e\u8003\u8651\u56e0\u7d20\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6b63\u5b9a\u6027\u4fdd\u8bc1</strong>\uff1a\n   - \u8c31\u4fee\u6b63\uff1a$\\mathbf{G}_k = \\mathbf{U}\\max(\\mathbf{\\Lambda}, \\epsilon\\mathbf{I})\\mathbf{U}^T$\n   - \u5bf9\u89d2\u52a0\u8f7d\uff1a$\\mathbf{G}_k + \\lambda\\mathbf{I}$\uff0c\u5176\u4e2d $\\lambda &gt; -\\lambda_{\\min}(\\mathbf{G}_k)$\n   - Cholesky\u4fee\u6b63\uff1a\u5c1d\u8bd5\u5206\u89e3\uff0c\u5931\u8d25\u65f6\u589e\u52a0\u5bf9\u89d2\u9879</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u63a7\u5236</strong>\uff1a\n   - \u76ee\u6807\uff1a$\\kappa(\\mathbf{G}_k) = \\lambda_{\\max}/\\lambda_{\\min} \\leq \\kappa_{\\max}$\n   - \u8c31\u622a\u65ad\uff1a\u5c06\u5c0f\u7279\u5f81\u503c\u66ff\u6362\u4e3a\u9608\u503c\n   - \u9884\u6761\u4ef6\u8fed\u4ee3\u6cd5\u7684\u6536\u655b\u901f\u5ea6\uff1a$\\rho \\approx 1 - 2/(\\sqrt{\\kappa} + 1)$</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6</strong>\uff1a\n   - \u76f4\u63a5\u6cd5\uff1a$O(n^3)$ for Cholesky\u5206\u89e3\n   - \u8fed\u4ee3\u6cd5\uff1a$O(n^2k)$ for $k$ \u6b21CG\u8fed\u4ee3\n   - \u4f4e\u79e9\u65b9\u6cd5\uff1a$O(nr^2)$ for \u79e9-$r$ \u8fd1\u4f3c</p>\n</li>\n<li>\n<p><strong>\u8fd1\u4f3c\u8d28\u91cf</strong>\uff1a\n   - \u5c40\u90e8\u6a21\u578b\u7cbe\u5ea6\uff1a$|f(\\mathbf{w}+\\Delta\\mathbf{w}) - m(\\Delta\\mathbf{w})| \\leq O(|\\Delta\\mathbf{w}|^3)$\n   - \u66f2\u7387\u8fd1\u4f3c\u8bef\u5dee\uff1a$|\\mathbf{G}_k - \\nabla^2 f| \\leq \\epsilon_G$\n   - \u6536\u655b\u901f\u5ea6\u5f71\u54cd\uff1a\u8d85\u7ebf\u6027 vs \u7ebf\u6027\u6536\u655b</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u53d8\u4f53\u4e0e\u6269\u5c55</strong>\uff1a</p>\n<ol>\n<li><strong>Kronecker-Factored Curvature (K-FAC)</strong>\uff1a\n$$\\mathbf{G}_k = \\mathbf{A}_k \\otimes \\mathbf{B}_k + \\lambda\\mathbf{I}$$\n\u4f18\u52bf\u5206\u6790\uff1a</li>\n</ol>\n<ul>\n<li>\u5b58\u50a8\uff1a\u4ece $O(n^2)$ \u964d\u81f3 $O(n)$</li>\n<li>\u6c42\u9006\uff1a\u5229\u7528 $(\\mathbf{A} \\otimes \\mathbf{B})^{-1} = \\mathbf{A}^{-1} \\otimes \\mathbf{B}^{-1}$</li>\n<li>\u8fd1\u4f3c\u8d28\u91cf\uff1a\u5bf9\u5177\u6709Kronecker\u7ed3\u6784\u7684\u7f51\u7edc\u662f\u7cbe\u786e\u7684</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>Quasi-Newton\u9884\u6761\u4ef6</strong>\uff1a\n$$\\mathbf{B}_{k+1} = \\mathbf{B}_k + \\frac{\\mathbf{y}_k\\mathbf{y}_k^T}{\\mathbf{y}_k^T\\mathbf{s}_k} - \\frac{\\mathbf{B}_k\\mathbf{s}_k\\mathbf{s}_k^T\\mathbf{B}_k}{\\mathbf{s}_k^T\\mathbf{B}_k\\mathbf{s}_k}$$\n\u5176\u4e2d $\\mathbf{s}_k = \\mathbf{w}_{k+1} - \\mathbf{w}_k$, $\\mathbf{y}_k = \\nabla f_{k+1} - \\nabla f_k$</p>\n</li>\n<li>\n<p><strong>Sketched Curvature</strong>\uff1a\n$$\\mathbf{G}_k = \\mathbf{S}_k^T\\nabla^2 f(\\mathbf{w}_k)\\mathbf{S}_k$$\n\u968f\u673a\u6295\u5f71\u9009\u62e9\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>Gaussian sketching: $\\mathbf{S}_{ij} \\sim \\mathcal{N}(0, 1/d)$</li>\n<li>Sparse embedding: \u7a00\u758f ${-1, 0, +1}$ \u77e9\u9635</li>\n<li>Subsampled randomized Hadamard transform (SRHT)</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u6846\u67b6\u7684\u6570\u5b66\u57fa\u7840</strong>\uff1a</p>\n<p>\u8003\u8651\u5e26\u6743\u91cd\u7684\u66f2\u7387\u7ec4\u5408\uff1a\n$$\\mathbf{G}_k = \\sum_{i=1}^m \\alpha_i^{(k)} \\mathbf{G}_i^{(k)}$$\n\u5176\u4e2d\u6743\u91cd $\\alpha_i^{(k)}$ \u53ef\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u786e\u5b9a\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8d1d\u53f6\u65af\u65b9\u6cd5</strong>\uff1a\n   - \u5148\u9a8c\uff1a$p(\\mathbf{G}) = \\prod_i p(\\mathbf{G}_i)^{\\alpha_i}$\n   - \u540e\u9a8c\u66f4\u65b0\uff1a\u57fa\u4e8e\u89c2\u6d4b\u7684\u6b65\u957f\u8d28\u91cf\n   - \u8ba1\u7b97\uff1a\u4f7f\u7528\u53d8\u5206\u63a8\u65ad\u6216MCMC</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u5b66\u4e60</strong>\uff1a\n   - Regret\u6700\u5c0f\u5316\uff1a$\\min_{\\alpha} \\sum_{t=1}^T \\ell_t(\\alpha)$\n   - \u4e13\u5bb6\u7b97\u6cd5\uff1a\u6bcf\u4e2a\u66f2\u7387\u77e9\u9635\u4f5c\u4e3a\u4e00\u4e2a\u4e13\u5bb6\n   - \u6743\u91cd\u66f4\u65b0\uff1a\u6307\u6570\u6743\u91cd\u6216Follow-the-Leader</p>\n</li>\n<li>\n<p><strong>\u8c31\u5206\u6790</strong>\uff1a\n   - \u7279\u5f81\u503c\u5206\u89e3\uff1a$\\mathbf{G}_i = \\mathbf{U}_i\\mathbf{\\Lambda}_i\\mathbf{U}_i^T$\n   - \u6743\u91cd\u9009\u62e9\uff1a\u57fa\u4e8e\u6761\u4ef6\u6570\u3001\u8c31gap\u7b49\u6307\u6807\n   - \u52a8\u6001\u8c03\u6574\uff1a\u8ffd\u8e2a\u7279\u5f81\u503c\u53d8\u5316</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u73b0\u8003\u8651\u4e0e\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u6280\u5de7</strong>\uff1a\n   <code># \u7a33\u5b9a\u7684Cholesky\u5206\u89e3\n   while True:\n       try:\n           L = cholesky(G + diag_shift * I)\n           break\n       except:\n           diag_shift *= 10</code></p>\n</li>\n<li>\n<p><strong>\u9ad8\u6548\u7ebf\u6027\u6c42\u89e3</strong>\uff1a\n   - \u9884\u6761\u4ef6\u5171\u8f6d\u68af\u5ea6(PCG)\n   - \u591a\u91cd\u7f51\u683c\u65b9\u6cd5\n   - \u4e0d\u5b8c\u5168\u5206\u89e3\u9884\u6761\u4ef6\u5b50</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0f\u5b9e\u73b0</strong>\uff1a\n   - \u6570\u636e\u5e76\u884c\uff1a\u5206\u7247\u8ba1\u7b97\u68af\u5ea6\u548c\u66f2\u7387\n   - \u6a21\u578b\u5e76\u884c\uff1a\u5206\u5757\u77e9\u9635\u8fd0\u7b97\n   - \u901a\u4fe1\u4f18\u5316\uff1a\u68af\u5ea6\u538b\u7f29\u548c\u5ef6\u8fdf\u66f4\u65b0</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u9009\u62e9\u66f2\u7387\u77e9\u9635\u7684\u5143\u5b66\u4e60\u65b9\u6cd5</li>\n<li>\u7ed3\u5408\u4e0d\u540c\u66f2\u7387\u8fd1\u4f3c\u7684\u6df7\u5408\u7b97\u6cd5\u7406\u8bba\u5206\u6790</li>\n<li>\u5728\u975e\u51f8\u4f18\u5316\u4e2d\u7684\u6536\u655b\u6027\u4fdd\u8bc1\u5f3a\u5316</li>\n<li>\u57fa\u4e8e\u786c\u4ef6\u611f\u77e5\u7684\u66f2\u7387\u77e9\u9635\u8bbe\u8ba1\uff08GPU/TPU\u4f18\u5316\uff09</li>\n<li>\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u66f2\u7387\u77e9\u9635\u8fd1\u4f3c\u4e0e\u901a\u4fe1\u4f18\u5316</li>\n<li>\u91cf\u5b50\u7b97\u6cd5\u52a0\u901f\u66f2\u7387\u77e9\u9635\u8ba1\u7b97\u7684\u53ef\u80fd\u6027</li>\n<li>\u795e\u7ecf\u67b6\u6784\u641c\u7d22(NAS)\u4e2d\u7684\u4e8c\u9636\u65b9\u6cd5\u5e94\u7528</li>\n</ul>\n<h2 id=\"12-fisherhessian\">1.2 Fisher\u4fe1\u606f\u77e9\u9635\u4e0eHessian\u7684\u5173\u7cfb</h2>\n<h3 id=\"121\">1.2.1 \u7406\u8bba\u8054\u7cfb</h3>\n<p>Fisher\u4fe1\u606f\u77e9\u9635\u548cHessian\u4e4b\u95f4\u5b58\u5728\u6df1\u523b\u7684\u6570\u5b66\u8054\u7cfb\uff0c\u8fd9\u79cd\u8054\u7cfb\u5728\u6982\u7387\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\u4e2d\u5c24\u4e3a\u91cd\u8981\u3002</p>\n<p><strong>\u5b9a\u7406 1.2</strong>\uff08Fisher-Hessian\u5173\u7cfb\uff09\n\u5bf9\u4e8e\u6982\u7387\u6a21\u578b $p(\\mathbf{x}|\\mathbf{w})$\uff0c\u8d1f\u5bf9\u6570\u4f3c\u7136\u7684\u671f\u671bHessian\u7b49\u4e8eFisher\u4fe1\u606f\u77e9\u9635\uff1a\n$$\\mathbb{E}_{\\mathbf{x} \\sim p(\\mathbf{x}|\\mathbf{w})}[\\nabla^2(-\\log p(\\mathbf{x}|\\mathbf{w}))] = \\mathbf{F}(\\mathbf{w})$$\n<strong>\u8bc1\u660e\u6838\u5fc3</strong>\uff1a\u5229\u7528score function\u7684\u6027\u8d28\n$$\\mathbb{E}[\\nabla \\log p(\\mathbf{x}|\\mathbf{w})] = 0$$\n$$\\text{Var}[\\nabla \\log p(\\mathbf{x}|\\mathbf{w})] = \\mathbf{F}(\\mathbf{w})$$\n<strong>\u6df1\u5c42\u8054\u7cfb\u7684\u591a\u4e2a\u89c6\u89d2</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4fe1\u606f\u51e0\u4f55\u89c6\u89d2</strong>\uff1a\n   - Fisher\u4fe1\u606f\u5b9a\u4e49\u4e86\u53c2\u6570\u7a7a\u95f4\u7684Riemannian\u5ea6\u91cf\n   - Hessian\u5728\u8be5\u5ea6\u91cf\u4e0b\u662fLevi-Civita\u8054\u7edc\u7684\u8868\u793a\n   - \u6d4b\u5730\u7ebf\u65b9\u7a0b\uff1a$\\ddot{\\mathbf{w}}^k + \\Gamma_{ij}^k \\dot{\\mathbf{w}}^i \\dot{\\mathbf{w}}^j = 0$</p>\n</li>\n<li>\n<p><strong>\u7edf\u8ba1\u7269\u7406\u7c7b\u6bd4</strong>\uff1a\n   - Fisher\u4fe1\u606f ~ \u7cfb\u7edf\u7684\"\u521a\u5ea6\"\uff08\u5bf9\u6270\u52a8\u7684\u54cd\u5e94\uff09\n   - Hessian ~ \u80fd\u91cf\u666f\u89c2\u7684\u5c40\u90e8\u66f2\u7387\n   - \u6e29\u5ea6\u53c2\u6570\u8fde\u63a5\u4e24\u8005\uff1a$\\mathbf{H} = \\beta\\mathbf{F} + \\text{\u6da8\u843d\u9879}$</p>\n</li>\n<li>\n<p><strong>\u4fe1\u606f\u8bba\u89e3\u91ca</strong>\uff1a\n   - Fisher\u4fe1\u606f\u91cf\u5316\u53c2\u6570\u7684\u53ef\u8fa8\u8bc6\u6027\n   - Cram\u00e9r-Rao\u754c\uff1a$\\text{Var}(\\hat{\\mathbf{w}}) \\geq \\mathbf{F}^{-1}$\n   - \u6548\u7387\uff1a\u4f30\u8ba1\u91cf\u63a5\u8fd1\u6b64\u754c\u7684\u7a0b\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u63a8\u5e7f\u5230\u975e\u6807\u51c6\u60c5\u5f62</strong>\uff1a</p>\n<p><strong>\u5b9a\u7406 1.2a</strong>\uff08\u52a0\u6743Fisher\u4fe1\u606f\uff09\n\u5bf9\u4e8e\u52a0\u6743\u635f\u5931 $L(\\mathbf{w}) = \\mathbb{E}_{q(\\mathbf{x})}[\\ell(p(\\mathbf{x}|\\mathbf{w}))]$\uff1a\n$$\\nabla^2 L(\\mathbf{w}) = \\mathbf{F}_q(\\mathbf{w}) + \\text{bias term}$$\n\u5176\u4e2d $\\mathbf{F}_q$ \u662f\u5173\u4e8e\u5206\u5e03 $q$ \u7684\u52a0\u6743Fisher\u4fe1\u606f\u3002</p>\n<p><strong>\u5b9a\u7406 1.2b</strong>\uff08\u6761\u4ef6Fisher\u4fe1\u606f\uff09\n\u5bf9\u4e8e\u6761\u4ef6\u6a21\u578b $p(\\mathbf{y}|\\mathbf{x}, \\mathbf{w})$\uff1a\n$$\\mathbf{F}_{cond} = \\mathbb{E}_{\\mathbf{x},\\mathbf{y}}[\\nabla_{\\mathbf{w}} \\log p(\\mathbf{y}|\\mathbf{x},\\mathbf{w}) \\nabla_{\\mathbf{w}} \\log p(\\mathbf{y}|\\mathbf{x},\\mathbf{w})^T]$$</p>\n<h3 id=\"122\">1.2.2 \u5b9e\u9645\u5dee\u5f02\u4e0e\u8fd1\u4f3c\u7b56\u7565</h3>\n<p>\u5c3d\u7ba1\u7406\u8bba\u4e0a\u5b58\u5728\u8054\u7cfb\uff0c\u4f46\u5728\u5b9e\u8df5\u4e2d\u4e8c\u8005\u5e38\u6709\u663e\u8457\u5dee\u5f02\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6709\u9650\u6837\u672c\u6548\u5e94</strong>\uff1a\n   - \u6837\u672cHessian\uff1a$\\hat{\\mathbf{H}}_n = \\frac{1}{n}\\sum_{i=1}^n \\nabla^2 \\ell_i(\\mathbf{w})$\n   - \u504f\u5dee\uff1a$\\mathbb{E}[\\hat{\\mathbf{H}}_n] - \\mathbf{F} = O(n^{-1})$\n   - \u65b9\u5dee\uff1a$\\text{Var}(\\hat{\\mathbf{H}}_n) = O(n^{-1})$\n   - \u4fee\u6b63\u65b9\u6cd5\uff1aBartlett\u6821\u6b63\u3001Bootstrap\u65b9\u5dee\u4f30\u8ba1</p>\n</li>\n<li>\n<p><strong>\u6a21\u578b\u8bef\u8bbe(Misspecification)</strong>\uff1a\n   - \u771f\u5b9e\u5206\u5e03\uff1a$q(\\mathbf{x})$ vs \u6a21\u578b\u65cf\uff1a${p(\\mathbf{x}|\\mathbf{w})}$\n   - Sandwich\u4f30\u8ba1\u91cf\uff1a$\\mathbf{V} = \\mathbf{H}^{-1}\\mathbf{F}\\mathbf{H}^{-1}$\n   - \u7a33\u5065\u63a8\u65ad\uff1a\u4f7f\u7528$\\mathbf{V}$\u800c\u975e$\\mathbf{H}^{-1}$\u6216$\\mathbf{F}^{-1}$\n   - \u8bca\u65ad\uff1a\u6bd4\u8f83$|\\mathbf{H} - \\mathbf{F}|$\u7684\u5927\u5c0f</p>\n</li>\n<li>\n<p><strong>\u975e\u51f8\u6027\u4e0e\u8d1f\u66f2\u7387</strong>\uff1a\n   - Hessian\u8c31\uff1a\u53ef\u80fd\u5305\u542b\u8d1f\u7279\u5f81\u503c\n   - Fisher\u4fe1\u606f\uff1a\u59cb\u7ec8\u534a\u6b63\u5b9a\uff08$\\mathbf{F} \\succeq 0$\uff09\n   - \u4fee\u6b63\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u8c31\u622a\u65ad\uff1a$\\mathbf{H}^+ = \\sum_{\\lambda_i &gt; 0} \\lambda_i \\mathbf{u}_i\\mathbf{u}_i^T$</li>\n<li>\u7edd\u5bf9\u503c\u4fee\u6b63\uff1a$|\\mathbf{H}| = \\mathbf{U}|\\mathbf{\\Lambda}|\\mathbf{U}^T$</li>\n<li>\u51f8\u7ec4\u5408\uff1a$\\alpha\\mathbf{H} + (1-\\alpha)\\mathbf{F}$</li>\n</ul>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u8fd1\u4f3c\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li><strong>Empirical Fisher\u53d8\u4f53</strong>\uff1a</li>\n</ol>\n<p><strong>\u6807\u51c6Empirical Fisher</strong>\uff1a\n$$\\hat{\\mathbf{F}} = \\frac{1}{N}\\sum_{i=1}^N \\mathbf{g}_i\\mathbf{g}_i^T, \\quad \\mathbf{g}_i = \\nabla \\log p(\\mathbf{x}_i|\\mathbf{w})$$\n<strong>Centered Empirical Fisher</strong>\uff1a\n$$\\hat{\\mathbf{F}}_c = \\frac{1}{N}\\sum_{i=1}^N (\\mathbf{g}_i - \\bar{\\mathbf{g}})(\\mathbf{g}_i - \\bar{\\mathbf{g}})^T$$\n<strong>Natural Empirical Fisher</strong>\uff08\u7528\u4e8e\u6df1\u5ea6\u5b66\u4e60\uff09\uff1a\n$$\\hat{\\mathbf{F}}_{nat} = \\frac{1}{N}\\sum_{i=1}^N \\nabla_{\\mathbf{w}} \\log p(\\mathbf{y}_i|\\mathbf{x}_i,\\mathbf{w}) \\nabla_{\\mathbf{w}} \\log p(\\mathbf{y}_i|\\mathbf{x}_i,\\mathbf{w})^T$$</p>\n<ol start=\"2\">\n<li><strong>Generalized Gauss-Newton (GGN)</strong>\uff1a</li>\n</ol>\n<p>\u5bf9\u4e8e\u590d\u5408\u635f\u5931 $L(\\mathbf{w}) = \\ell(f(\\mathbf{w}))$\uff1a\n$$\\mathbf{G}_{GGN} = \\mathbf{J}^T \\nabla^2\\ell(f(\\mathbf{w})) \\mathbf{J}$$\n\u7279\u6b8a\u60c5\u51b5\uff1a</p>\n<ul>\n<li>\u5e73\u65b9\u635f\u5931\uff1a$\\mathbf{G}_{GGN} = \\mathbf{J}^T\\mathbf{J}$\uff08\u6807\u51c6Gauss-Newton\uff09</li>\n<li>\u4ea4\u53c9\u71b5\uff1a$\\mathbf{G}_{GGN} = \\mathbf{J}^T\\text{diag}(p(1-p))\\mathbf{J}$</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u81ea\u9002\u5e94\u6df7\u5408\u7b56\u7565</strong>\uff1a</li>\n</ol>\n<p><strong>\u52a8\u6001\u6743\u91cd\u65b9\u6848</strong>\uff1a\n$$\\mathbf{G}_k = \\alpha_k\\mathbf{H}_k + (1-\\alpha_k)\\mathbf{F}_k$$\n\u6743\u91cd\u9009\u62e9\u51c6\u5219\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u6761\u4ef6\u6570\uff1a$\\alpha_k = \\min(1, \\kappa_{max}/\\kappa(\\mathbf{H}_k))$</li>\n<li>\u57fa\u4e8e\u8fdb\u5c55\uff1a$\\alpha_k = \\rho_k$\uff08\u5b9e\u9645vs\u9884\u6d4b\u4e0b\u964d\u6bd4\uff09</li>\n<li>\u57fa\u4e8e\u566a\u58f0\u6c34\u5e73\uff1a$\\alpha_k = 1/(1 + \\sigma_k^2)$</li>\n</ul>\n<h3 id=\"123\">1.2.3 \u8ba1\u7b97\u6548\u7387\u8003\u8651</h3>\n<p>Fisher\u4fe1\u606f\u77e9\u9635\u7684\u8ba1\u7b97\u901a\u5e38\u6bd4\u5b8c\u6574Hessian\u66f4\u9ad8\u6548\uff1a</p>\n<p><strong>\u57fa\u7840\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u53ea\u9700\u8981\u4e00\u9636\u5bfc\u6570\uff08\u901a\u8fc7\u5916\u79ef\uff09</li>\n<li>\u53ef\u4ee5\u4f7f\u7528Monte Carlo\u8fd1\u4f3c</li>\n<li>\u9002\u5408\u5206\u5e03\u5f0f\u8ba1\u7b97\u548c\u5728\u7ebf\u66f4\u65b0</li>\n<li>\u81ea\u52a8\u4fdd\u8bc1\u534a\u6b63\u5b9a\u6027</li>\n</ul>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5bf9\u6bd4</strong>\uff1a\n| \u65b9\u6cd5 | \u65f6\u95f4\u590d\u6742\u5ea6 | \u7a7a\u95f4\u590d\u6742\u5ea6 | \u5e76\u884c\u6027 |</p>\n<table>\n<thead>\n<tr>\n<th>\u65b9\u6cd5</th>\n<th>\u65f6\u95f4\u590d\u6742\u5ea6</th>\n<th>\u7a7a\u95f4\u590d\u6742\u5ea6</th>\n<th>\u5e76\u884c\u6027</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Full Hessian</td>\n<td>$O(n^2 \\cdot \\text{cost}(\\nabla^2))$</td>\n<td>$O(n^2)$</td>\n<td>\u56f0\u96be</td>\n</tr>\n<tr>\n<td>Fisher (\u5916\u79ef)</td>\n<td>$O(n^2 \\cdot \\text{cost}(\\nabla))$</td>\n<td>$O(n^2)$</td>\n<td>\u5bb9\u6613</td>\n</tr>\n<tr>\n<td>Block Fisher</td>\n<td>$O(b \\cdot n^2/b^2)$</td>\n<td>$O(n^2/b)$</td>\n<td>\u9ad8\u5ea6\u5e76\u884c</td>\n</tr>\n<tr>\n<td>Low-rank Fisher</td>\n<td>$O(nr \\cdot \\text{cost}(\\nabla))$</td>\n<td>$O(nr)$</td>\n<td>\u5bb9\u6613</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u9ad8\u7ea7\u8ba1\u7b97\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u7ed3\u6784\u5316Fisher\u8ba1\u7b97</strong>\uff1a</li>\n</ol>\n<p><strong>\u5c42\u7ea7\u5206\u89e3</strong>\uff08\u7528\u4e8e\u6df1\u5ea6\u7f51\u7edc\uff09\uff1a\n$$\\mathbf{F} = \\begin{pmatrix}\n   \\mathbf{F}_{11} &amp; \\mathbf{F}_{12} &amp; \\cdots \\\n   \\mathbf{F}_{21} &amp; \\mathbf{F}_{22} &amp; \\cdots \\\n   \\vdots &amp; \\vdots &amp; \\ddots\n   \\end{pmatrix}$$</p>\n<ul>\n<li>\u5757\u5bf9\u89d2\u8fd1\u4f3c\uff1a\u5ffd\u7565\u5c42\u95f4\u76f8\u5173\u6027</li>\n<li>\u4e09\u5bf9\u89d2\u8fd1\u4f3c\uff1a\u53ea\u4fdd\u7559\u76f8\u90bb\u5c42</li>\n<li>Kronecker\u8fd1\u4f3c\uff1a$\\mathbf{F}_l \\approx \\mathbf{A}_l \\otimes \\mathbf{G}_l$</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u52a8\u91cf\u65b9\u6cd5\u52a0\u901fFisher\u4f30\u8ba1</strong>\uff1a</li>\n</ol>\n<p><strong>\u6307\u6570\u79fb\u52a8\u5e73\u5747</strong>\uff1a\n$$\\mathbf{F}_t = \\beta\\mathbf{F}_{t-1} + (1-\\beta)\\mathbf{g}_t\\mathbf{g}_t^T$$\n<strong>\u4e8c\u9636\u52a8\u91cf</strong>\uff08\u7c7b\u4f3cAdam\uff09\uff1a\n$$\\mathbf{M}_t = \\beta_1\\mathbf{M}_{t-1} + (1-\\beta_1)\\mathbf{g}_t$$\n   $$\\mathbf{F}_t = \\beta_2\\mathbf{F}_{t-1} + (1-\\beta_2)\\mathbf{g}_t\\mathbf{g}_t^T$$</p>\n<ol start=\"3\">\n<li><strong>\u91c7\u6837\u7b56\u7565\u4f18\u5316</strong>\uff1a</li>\n</ol>\n<p><strong>\u91cd\u8981\u6027\u91c7\u6837</strong>\uff1a</p>\n<ul>\n<li>\u9009\u62e9\u4fe1\u606f\u91cf\u5927\u7684\u6837\u672c\uff1a$p_i \\propto |\\mathbf{g}_i|^2$</li>\n<li>\u65e0\u504f\u4f30\u8ba1\uff1a$\\hat{\\mathbf{F}} = \\sum_{i \\in S} \\frac{1}{Np_i}\\mathbf{g}_i\\mathbf{g}_i^T$</li>\n</ul>\n<p><strong>\u5206\u5c42\u91c7\u6837</strong>\uff1a</p>\n<ul>\n<li>\u6309\u68af\u5ea6\u8303\u6570\u5206\u5c42</li>\n<li>\u6bcf\u5c42\u5185\u5747\u5300\u91c7\u6837</li>\n<li>\u51cf\u5c11\u65b9\u5dee\u540c\u65f6\u4fdd\u6301\u4ee3\u8868\u6027</li>\n</ul>\n<p><strong>\u9ad8\u6548\u8ba1\u7b97\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>\u5206\u5757\u8ba1\u7b97\u4e0e\u7a00\u758f\u6027\u5229\u7528</strong>\uff1a\n   \u5bf9\u4e8e\u7ed3\u6784\u5316\u6a21\u578b\uff08\u5982\u6df1\u5ea6\u7f51\u7edc\uff09\uff0cFisher\u4fe1\u606f\u77e9\u9635\u5e38\u5448\u73b0\u5206\u5757\u5bf9\u89d2\u6216\u5757\u4e09\u5bf9\u89d2\u7ed3\u6784\uff1a\n$$\\mathbf{F} = \\begin{pmatrix}\n   \\mathbf{F}_{11} &amp; \\mathbf{F}_{12} &amp; \\cdots \\\n   \\mathbf{F}_{21} &amp; \\mathbf{F}_{22} &amp; \\cdots \\\n   \\vdots &amp; \\vdots &amp; \\ddots\n   \\end{pmatrix}$$\n\u53ef\u4ee5\u5229\u7528\u7684\u8ba1\u7b97\u4f18\u5316\uff1a</li>\n</ol>\n<ul>\n<li>\u53ea\u8ba1\u7b97\u548c\u5b58\u50a8\u975e\u96f6\u5757</li>\n<li>\u4f7f\u7528\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\u5e93\uff08\u5982<code>scipy.sparse.linalg</code>\uff09</li>\n<li>\u5e76\u884c\u8ba1\u7b97\u4e0d\u540c\u5757</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u4f4e\u79e9\u8fd1\u4f3c\u6280\u672f</strong>\uff1a</li>\n</ol>\n<p><strong>SVD\u5206\u89e3</strong>\uff1a$\\mathbf{F} \\approx \\mathbf{U}_k\\mathbf{\\Sigma}_k\\mathbf{U}_k^T$</p>\n<ul>\n<li>\u53ea\u4fdd\u7559\u524d $k$ \u4e2a\u4e3b\u6210\u5206</li>\n<li>\u5b58\u50a8\u590d\u6742\u5ea6\u4ece $O(n^2)$ \u964d\u81f3 $O(nk)$</li>\n</ul>\n<p><strong>Nystr\u00f6m\u8fd1\u4f3c</strong>\uff1a\n$$\\mathbf{F} \\approx \\mathbf{F}_{:,S}\\mathbf{F}_{S,S}^{-1}\\mathbf{F}_{S,:}$$\n\u5176\u4e2d $S$ \u662f\u968f\u673a\u9009\u62e9\u7684\u5217\u5b50\u96c6\u3002</p>\n<p><strong>\u68af\u5ea6\u5916\u79ef\u7684\u6d41\u5f0f\u66f4\u65b0</strong>\uff1a\n$$\\mathbf{F}_t = (1-\\beta)\\mathbf{F}_{t-1} + \\beta \\mathbf{g}_t\\mathbf{g}_t^T$$\n\u4f7f\u7528\u6307\u6570\u79fb\u52a8\u5e73\u5747\u7ef4\u62a4\u4f4e\u79e9\u5206\u89e3\u3002</p>\n<ol start=\"3\">\n<li><strong>Monte Carlo Fisher\u4f30\u8ba1</strong>\uff1a</li>\n</ol>\n<p><strong>\u65e0\u504f\u4f30\u8ba1\u5668</strong>\uff1a\n$$\\hat{\\mathbf{F}} = \\frac{1}{m}\\sum_{i=1}^m \\nabla_{\\mathbf{w}} \\log p(\\mathbf{x}_i|\\mathbf{w}) \\nabla_{\\mathbf{w}} \\log p(\\mathbf{x}_i|\\mathbf{w})^T$$\n<strong>\u65b9\u5dee\u7f29\u51cf\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li>\u91cd\u8981\u6027\u91c7\u6837\uff1a\u9009\u62e9\u4fe1\u606f\u91cf\u5927\u7684\u6837\u672c</li>\n<li>\u63a7\u5236\u53d8\u91cf\uff1a$\\hat{\\mathbf{F}}_{CV} = \\hat{\\mathbf{F}} + c(\\mathbf{F}_0 - \\hat{\\mathbf{F}}_0)$</li>\n<li>SVRG\u7c7b\u65b9\u6cd5\uff1a\u5468\u671f\u6027\u8ba1\u7b97\u5b8c\u6574Fisher\u4f5c\u4e3a\u951a\u70b9</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u5206\u5e03\u5f0f\u8ba1\u7b97\u6846\u67b6</strong>\uff1a</li>\n</ol>\n<p><strong>\u6570\u636e\u5e76\u884c</strong>\uff1a\u6bcf\u4e2a\u8282\u70b9\u8ba1\u7b97\u5c40\u90e8Fisher\uff0c\u7136\u540e\u805a\u5408\n$$\\mathbf{F} = \\frac{1}{N}\\sum_{j=1}^{P} n_j \\mathbf{F}_j$$\n<strong>\u6a21\u578b\u5e76\u884c</strong>\uff1a\u5206\u5757\u8ba1\u7b97Fisher\u7684\u4e0d\u540c\u90e8\u5206</p>\n<ul>\n<li>\u901a\u4fe1\u4f18\u5316\uff1a\u53ea\u4f20\u8f93\u5fc5\u8981\u7684\u8fb9\u754c\u4fe1\u606f</li>\n<li>\u5f02\u6b65\u66f4\u65b0\uff1a\u5bb9\u5fcd\u4e00\u5b9a\u7684\u5ef6\u8fdf</li>\n</ul>\n<p><strong>\u4e0eHessian\u8ba1\u7b97\u7684\u6df7\u5408\u7b56\u7565</strong>\uff1a</p>\n<p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u7ed3\u5408Fisher\u4fe1\u606f\u548cHessian\u4fe1\u606f\u53ef\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\uff1a</p>\n<ol>\n<li>\n<p><strong>Generalized Gauss-Newton (GGN)</strong>\uff1a\n$$\\mathbf{G}_{GGN} = \\mathbf{J}^T\\mathbf{H}_{\\text{loss}}\\mathbf{J}$$\n\u5176\u4e2d $\\mathbf{H}_{\\text{loss}}$ \u662f\u635f\u5931\u51fd\u6570\u5173\u4e8e\u8f93\u51fa\u7684Hessian\u3002</p>\n</li>\n<li>\n<p><strong>Fisher-Hessian\u5e73\u5747</strong>\uff1a\n$$\\mathbf{G} = \\alpha\\mathbf{F} + (1-\\alpha)\\mathbf{H}^+$$\n\u5176\u4e2d $\\mathbf{H}^+$ \u662fHessian\u7684\u6b63\u5b9a\u90e8\u5206\u3002</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u5207\u6362</strong>\uff1a\n   - \u5f53 $|\\nabla f|$ \u5927\u65f6\u4f7f\u7528Fisher\uff08\u66f4\u7a33\u5b9a\uff09\n   - \u63a5\u8fd1\u6700\u4f18\u65f6\u4f7f\u7528Hessian\uff08\u66f4\u7cbe\u786e\uff09</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a</p>\n<ul>\n<li>Fisher\u4fe1\u606f\u77e9\u9635\u7684\u4f4e\u79e9\u8fd1\u4f3c\u4e0e\u538b\u7f29</li>\n<li>\u57fa\u4e8e\u68af\u5ea6\u5386\u53f2\u7684Fisher\u4f30\u8ba1</li>\n<li>\u91cf\u5b50Fisher\u4fe1\u606f\u5728\u7ecf\u5178\u4f18\u5316\u4e2d\u7684\u5e94\u7528</li>\n<li>\u795e\u7ecf\u6b63\u5207\u6838(NTK)\u4e0eFisher\u4fe1\u606f\u7684\u8054\u7cfb</li>\n<li>\u81ea\u9002\u5e94\u91c7\u6837\u7b56\u7565for Fisher\u4f30\u8ba1</li>\n<li>\u9690\u79c1\u4fdd\u62a4\u7684\u5206\u5e03\u5f0fFisher\u8ba1\u7b97</li>\n</ul>\n<h2 id=\"13-trust-region\">1.3 Trust Region\u65b9\u6cd5\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u590d\u5174</h2>\n<h3 id=\"131-trust-region\">1.3.1 \u4ece\u7ecf\u5178\u5230\u73b0\u4ee3\uff1aTrust Region\u7684\u6f14\u53d8</h3>\n<p>Trust Region\u65b9\u6cd5\u901a\u8fc7\u9650\u5236\u6b65\u957f\u5728\u6a21\u578b\u53ef\u4fe1\u7684\u533a\u57df\u5185\uff0c\u63d0\u4f9b\u4e86\u6bd4\u7ebf\u641c\u7d22\u66f4\u7a33\u5065\u7684\u5168\u5c40\u5316\u7b56\u7565\u3002\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6b63\u7ecf\u5386\u590d\u5174\u3002</p>\n<p><strong>\u7ecf\u5178Trust Region\u5b50\u95ee\u9898</strong>\uff1a\n$$\\min_{|\\Delta\\mathbf{w}| \\leq \\delta} f(\\mathbf{w}) + \\nabla f(\\mathbf{w})^T \\Delta\\mathbf{w} + \\frac{1}{2} \\Delta\\mathbf{w}^T \\mathbf{H} \\Delta\\mathbf{w}$$</p>\n<h3 id=\"132\">1.3.2 \u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u9002\u5e94\u6027\u6539\u8fdb</h3>\n<p><strong>\u6311\u6218\u4e0e\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ol>\n<li><strong>\u9ad8\u7ef4\u95ee\u9898</strong>\uff1a\u4f7f\u7528Krylov\u5b50\u7a7a\u95f4\u65b9\u6cd5\uff08\u5982CG-Steihaug\uff09</li>\n<li><strong>\u968f\u673a\u6027</strong>\uff1a\u7ed3\u5408\u65b9\u5dee\u7f29\u51cf\u6280\u672f\uff08SVRG, SARAH\uff09</li>\n<li><strong>\u975e\u51f8\u6027</strong>\uff1a\u81ea\u9002\u5e94\u8c03\u6574trust region\u5f62\u72b6</li>\n</ol>\n<p><strong>\u73b0\u4ee3\u53d8\u4f53</strong>\uff1a</p>\n<ul>\n<li><strong>TRON</strong> (Trust Region Newton)\uff1a\u4e13\u4e3a\u5927\u89c4\u6a21\u95ee\u9898\u8bbe\u8ba1</li>\n<li><strong>TR-APG</strong> (Trust Region Accelerated Proximal Gradient)\uff1a\u7ed3\u5408\u4e00\u9636\u52a0\u901f</li>\n<li><strong>Saddle-Free Newton</strong>\uff1a\u68c0\u6d4b\u5e76\u9003\u79bb\u978d\u70b9\u7684trust region\u65b9\u6cd5</li>\n</ul>\n<h3 id=\"133\">1.3.3 \u4e0e\u5176\u4ed6\u65b9\u6cd5\u7684\u7ed3\u5408</h3>\n<p>Trust Region\u6846\u67b6\u53ef\u4ee5\u4e0e\u591a\u79cd\u6280\u672f\u7ed3\u5408\uff1a</p>\n<ul>\n<li><strong>\u4e0eNatural Gradient\u7ed3\u5408</strong>\uff1a\u4f7f\u7528Fisher\u5ea6\u91cf\u5b9a\u4e49trust region</li>\n<li><strong>\u4e0e\u52a8\u91cf\u65b9\u6cd5\u7ed3\u5408</strong>\uff1a\u5728trust region\u5185\u52a0\u5165\u52a8\u91cf\u9879</li>\n<li><strong>\u4e0e\u81ea\u9002\u5e94\u5b66\u4e60\u7387\u7ed3\u5408</strong>\uff1aper-parameter trust region (\u7c7b\u4f3cAdam)</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u7ed3\u5408\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>Riemannian Trust Region</strong>\uff1a\n   \u5728\u6d41\u5f62\u4f18\u5316\u4e2d\uff0ctrust region\u7684\u5b9a\u4e49\u9700\u8981\u8003\u8651\u6d41\u5f62\u7684\u51e0\u4f55\u7ed3\u6784\uff1a\n$$\\min_{\\eta \\in T_x\\mathcal{M}} m(\\eta) \\quad \\text{s.t.} \\quad |\\eta|_x \\leq \\delta$$\n\u5176\u4e2d $T_x\\mathcal{M}$ \u662f\u5207\u7a7a\u95f4\uff0c$|\\cdot|_x$ \u662fRiemannian\u5ea6\u91cf\u3002</li>\n</ol>\n<p>\u5e94\u7528\u573a\u666f\uff1a</p>\n<ul>\n<li>\u6b63\u5b9a\u77e9\u9635\u4f18\u5316\uff08\u4f7f\u7528Log-Euclidean\u5ea6\u91cf\uff09</li>\n<li>Stiefel\u6d41\u5f62\u4e0a\u7684\u4f18\u5316\uff08\u6b63\u4ea4\u7ea6\u675f\uff09</li>\n<li>\u4f4e\u79e9\u77e9\u9635\u6d41\u5f62\uff08\u56fa\u5b9a\u79e9\u7ea6\u675f\uff09</li>\n</ul>\n<ol start=\"2\">\n<li><strong>Stochastic Trust Region</strong>\uff1a\n   \u5904\u7406\u968f\u673a\u68af\u5ea6\u548cHessian\u4f30\u8ba1\u7684\u4e0d\u786e\u5b9a\u6027\uff1a</li>\n</ol>\n<p><strong>\u6982\u7387Trust Region</strong>\uff1a\n$$\\mathbb{P}[|\\Delta\\mathbf{w}| \\leq \\delta] \\geq 1-\\epsilon$$\n<strong>\u81ea\u9002\u5e94\u534a\u5f84\u8c03\u6574</strong>\uff1a\n$$\\delta_{k+1} = \\begin{cases}\n   \\gamma_{\\text{inc}} \\delta_k &amp; \\text{if } \\rho_k &gt; \\eta_1 \\text{ and } |\\Delta\\mathbf{w}_k| = \\delta_k \\\n   \\gamma_{\\text{dec}} \\delta_k &amp; \\text{if } \\rho_k &lt; \\eta_2 \\\n   \\delta_k &amp; \\text{otherwise}\n   \\end{cases}$$\n\u5176\u4e2d $\\rho_k$ \u662f\u6a21\u578b\u9884\u6d4b\u8d28\u91cf\u7684\u968f\u673a\u4f30\u8ba1\u3002</p>\n<ol start=\"3\">\n<li><strong>Adaptive Shape Trust Region</strong>\uff1a\n   \u4f7f\u7528\u692d\u7403\u800c\u975e\u7403\u5f62trust region\uff1a\n$${\\Delta\\mathbf{w} : \\Delta\\mathbf{w}^T\\mathbf{M}_k\\Delta\\mathbf{w} \\leq \\delta^2}$$\n<strong>\u5ea6\u91cf\u77e9\u9635\u9009\u62e9</strong>\uff1a</li>\n</ol>\n<ul>\n<li>\u5bf9\u89d2\u7f29\u653e\uff1a$\\mathbf{M}_k = \\text{diag}(|\\nabla f_i|^{\\alpha})$</li>\n<li>\u66f2\u7387\u611f\u77e5\uff1a$\\mathbf{M}_k = (\\mathbf{H}_k + \\lambda\\mathbf{I})^{1/2}$</li>\n<li>\u5386\u53f2\u4fe1\u606f\uff1a$\\mathbf{M}_k = \\sum_{i=1}^t \\beta^{t-i}\\mathbf{g}_i\\mathbf{g}_i^T$</li>\n</ul>\n<ol start=\"4\">\n<li><strong>Momentum-Enhanced Trust Region</strong>\uff1a\n   \u7ed3\u5408\u52a8\u91cf\u52a0\u901f\u7684trust region\u65b9\u6cd5\uff1a</li>\n</ol>\n<p><strong>Heavy-ball Trust Region</strong>\uff1a\n$$\\min_{\\Delta\\mathbf{w}} m(\\Delta\\mathbf{w}) + \\mu \\langle \\Delta\\mathbf{w}, \\mathbf{v}_{k-1} \\rangle$$\n   $$\\text{s.t.} \\quad |\\Delta\\mathbf{w}| \\leq \\delta$$\n\u5176\u4e2d $\\mathbf{v}_{k-1}$ \u662f\u5386\u53f2\u52a8\u91cf\u3002</p>\n<p><strong>Nesterov-style\u9884\u6d4b</strong>\uff1a\n   \u5148\u8fdb\u884c\u52a8\u91cf\u6b65\uff0c\u7136\u540e\u5728\u9884\u6d4b\u70b9\u6784\u5efatrust region\u6a21\u578b\u3002</p>\n<ol start=\"5\">\n<li><strong>Multi-level Trust Region</strong>\uff1a\n   \u9488\u5bf9\u5177\u6709\u5c42\u6b21\u7ed3\u6784\u7684\u95ee\u9898\uff08\u5982\u6df1\u5ea6\u7f51\u7edc\uff09\uff1a</li>\n</ol>\n<ul>\n<li>\u4e0d\u540c\u5c42\u4f7f\u7528\u4e0d\u540c\u7684trust region\u534a\u5f84</li>\n<li>\u57fa\u4e8e\u5c42\u7684\u654f\u611f\u5ea6\u81ea\u9002\u5e94\u8c03\u6574</li>\n<li>\u8003\u8651\u5c42\u95f4\u76f8\u4e92\u4f5c\u7528\u7684\u8026\u5408trust region</li>\n</ul>\n<p><strong>\u5b9e\u73b0\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Subproblem\u6c42\u89e3\u52a0\u901f</strong>\uff1a\n   - \u4f7f\u7528Lanczos\u65b9\u6cd5\u7684\u65e9\u505c\n   - \u57fa\u4e8e\u5386\u53f2\u4fe1\u606f\u7684\u6696\u542f\u52a8\n   - \u8fd1\u4f3c\u6c42\u89e3\u7684\u7406\u8bba\u4fdd\u8bc1</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong>\uff1a\n   - \u591a\u4e2atrust region\u534a\u5f84\u7684\u5e76\u884c\u5c1d\u8bd5\n   - \u5206\u5e03\u5f0f\u5b50\u95ee\u9898\u6c42\u89e3\n   - \u5f02\u6b65trust region\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u6548\u7387</strong>\uff1a\n   - \u4f7f\u7528implicit representations\u907f\u514d\u5b58\u50a8\u5b8c\u6574Hessian\n   - Hessian-free\u5b9e\u73b0using only Hessian-vector products\n   - \u589e\u91cf\u5f0ftrust region\u6a21\u578b\u66f4\u65b0</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u5c40\u90e8\u66f2\u7387\u7684\u81ea\u9002\u5e94trust region\u5f62\u72b6</li>\n<li>\u5206\u5e03\u5f0ftrust region\u7b97\u6cd5\u7684\u901a\u4fe1\u6548\u7387</li>\n<li>\u9690\u5f0ftrust region\u65b9\u6cd5\uff08\u901a\u8fc7\u6b63\u5219\u5316\u5b9e\u73b0\uff09</li>\n<li>\u975e\u6b27\u51e0\u91cc\u5fb7\u7a7a\u95f4\u7684trust region\u7406\u8bba</li>\n<li>\u4e0e\u5f3a\u5316\u5b66\u4e60\u4e2d\u7684PPO/TRPO\u7684\u7406\u8bba\u8054\u7cfb</li>\n<li>\u91cf\u5b50\u4f18\u5316\u4e2d\u7684trust region\u7c7b\u6bd4</li>\n</ul>\n<h2 id=\"14\">1.4 \u978d\u70b9\u9003\u9038\u7684\u7406\u8bba\u4e0e\u5b9e\u8df5</h2>\n<h3 id=\"141\">1.4.1 \u978d\u70b9\u7684\u6570\u5b66\u523b\u753b</h3>\n<p>\u5728\u9ad8\u7ef4\u975e\u51f8\u4f18\u5316\u4e2d\uff0c\u978d\u70b9\uff08\u7279\u5f81\u503c\u6709\u6b63\u6709\u8d1f\u7684\u9a7b\u70b9\uff09\u6bd4\u5c40\u90e8\u6781\u5c0f\u503c\u66f4\u5e38\u89c1\u3002\u4e25\u683c\u978d\u70b9\u6ee1\u8db3\uff1a\n$$\\lambda_{\\min}(\\nabla^2 f(\\mathbf{w}^*)) &lt; -\\epsilon &lt; 0$$</p>\n<h3 id=\"142\">1.4.2 \u9003\u9038\u673a\u5236\u7684\u7406\u8bba\u5206\u6790</h3>\n<p><strong>\u5b9a\u7406 1.3</strong>\uff08Perturbed Gradient Descent\u7684\u9003\u9038\u4fdd\u8bc1\uff09\n\u5728\u6e29\u548c\u6761\u4ef6\u4e0b\uff0c\u5e26\u6270\u52a8\u7684\u68af\u5ea6\u4e0b\u964d\u80fd\u4ee5\u9ad8\u6982\u7387\u5728\u591a\u9879\u5f0f\u65f6\u95f4\u5185\u9003\u79bb\u4e25\u683c\u978d\u70b9\u3002</p>\n<p><strong>\u4e3b\u8981\u9003\u9038\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>\u968f\u673a\u6270\u52a8</strong>\uff1a\u5728\u68af\u5ea6\u4e2d\u52a0\u5165\u566a\u58f0</li>\n<li><strong>\u8d1f\u66f2\u7387\u65b9\u5411</strong>\uff1a\u663e\u5f0f\u8ba1\u7b97\u5e76\u5229\u7528\u8d1f\u7279\u5f81\u503c\u65b9\u5411</li>\n<li><strong>\u4e8c\u9636\u65b9\u6cd5</strong>\uff1aNewton\u7c7b\u65b9\u6cd5\u81ea\u7136\u9003\u79bb\u978d\u70b9</li>\n</ol>\n<h3 id=\"143\">1.4.3 \u5b9e\u7528\u7b97\u6cd5\u4e0e\u6280\u5de7</h3>\n<p><strong>Negative Curvature Descent</strong>\uff1a</p>\n<ol>\n<li>\u4f7f\u7528Lanczos\u8fed\u4ee3\u627e\u5230\u8fd1\u4f3c\u6700\u5c0f\u7279\u5f81\u503c\u65b9\u5411</li>\n<li>\u5f53\u68c0\u6d4b\u5230\u8d1f\u66f2\u7387\u65f6\uff0c\u6cbf\u8be5\u65b9\u5411\u4e0b\u964d</li>\n<li>\u5426\u5219\u6267\u884c\u6807\u51c6\u68af\u5ea6\u6b65</li>\n</ol>\n<p><strong>\u52a0\u901f\u9003\u9038\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li><strong>Neon2</strong>: \u7ed3\u5408\u8d1f\u66f2\u7387\u548c\u52a0\u901f\u68af\u5ea6</li>\n<li><strong>Noisy Natural Gradient</strong>: \u5728Natural Gradient\u4e2d\u52a0\u5165\u5404\u5411\u5f02\u6027\u566a\u58f0</li>\n<li><strong>Cubic Regularization</strong>: \u4f7f\u7528\u4e09\u6b21\u6b63\u5219\u5316\u81ea\u52a8\u5904\u7406\u8d1f\u66f2\u7387</li>\n</ul>\n<h3 id=\"144\">1.4.4 \u6df1\u5ea6\u7f51\u7edc\u4e2d\u7684\u7279\u6b8a\u8003\u8651</h3>\n<p>\u6df1\u5ea6\u7f51\u7edc\u7684\u978d\u70b9\u5177\u6709\u7279\u6b8a\u7ed3\u6784\uff1a</p>\n<ul>\n<li>\u5927\u90e8\u5206\u978d\u70b9\u662f\u7531\u5bf9\u79f0\u6027\u5bfc\u81f4\u7684</li>\n<li>\u7f51\u7edc\u6df1\u5ea6\u589e\u52a0\u65f6\u978d\u70b9\u6570\u91cf\u6307\u6570\u589e\u957f</li>\n<li>\u4f46\u5927\u90e8\u5206\u978d\u70b9\u7684\u8d1f\u7279\u5f81\u503c\u6570\u91cf\u8f83\u5c11</li>\n</ul>\n<p><strong>\u978d\u70b9\u7ed3\u6784\u7684\u6df1\u5165\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li><strong>\u5bf9\u79f0\u6027\u5bfc\u81f4\u7684\u978d\u70b9</strong>\uff1a</li>\n</ol>\n<p><strong>\u7f6e\u6362\u5bf9\u79f0\u6027</strong>\uff1a\u795e\u7ecf\u5143\u7684\u53ef\u4ea4\u6362\u6027\u5bfc\u81f4\u5927\u91cf\u7b49\u4ef7\u978d\u70b9</p>\n<ul>\n<li>\u9690\u5c42\u795e\u7ecf\u5143\u7684\u91cd\u6392\u5217</li>\n<li>\u6743\u91cd\u7b26\u53f7\u7684\u7ffb\u8f6c\uff08\u5bf9\u4e8e\u5bf9\u79f0\u6fc0\u6d3b\u51fd\u6570\uff09</li>\n<li>\u8fd9\u7c7b\u978d\u70b9\u7684Hessian\u5177\u6709\u5927\u91cf\u96f6\u7279\u5f81\u503c</li>\n</ul>\n<p><strong>\u7f29\u653e\u5bf9\u79f0\u6027</strong>\uff1a\u5728\u67d0\u4e9b\u67b6\u6784\u4e2d\u5b58\u5728\n$$\\mathbf{W}_2 \\leftarrow \\alpha\\mathbf{W}_2, \\quad \\mathbf{W}_1 \\leftarrow \\mathbf{W}_1/\\alpha$$\n\u4fdd\u6301\u7f51\u7edc\u529f\u80fd\u4e0d\u53d8\u4f46\u521b\u5efa\u978d\u70b9\u8f68\u8ff9\u3002</p>\n<ol start=\"2\">\n<li><strong>\u978d\u70b9\u7684\u8c31\u7279\u6027</strong>\uff1a</li>\n</ol>\n<p><strong>\u7ecf\u9a8c\u89c2\u5bdf</strong>\uff1a</p>\n<ul>\n<li>\u8d1f\u7279\u5f81\u503c\u6570\u91cf\u901a\u5e38\u4e3a $O(\\sqrt{n})$\uff0c\u5176\u4e2d $n$ \u662f\u53c2\u6570\u6570\u91cf</li>\n<li>\u5927\u90e8\u5206\u7279\u5f81\u503c\u805a\u96c6\u5728\u96f6\u9644\u8fd1</li>\n<li>\u6781\u7aef\u7279\u5f81\u503c\uff08\u6700\u5927\u6b63/\u6700\u5c0f\u8d1f\uff09\u4e3b\u5bfc\u4f18\u5316\u52a8\u6001</li>\n</ul>\n<p><strong>\u7406\u8bba\u523b\u753b</strong>\uff1a\n   \u5bf9\u4e8e\u968f\u673a\u521d\u59cb\u5316\u7684\u7f51\u7edc\uff0cHessian\u8c31\u9075\u5faa\uff1a\n$$\\rho(\\lambda) \\approx \\frac{1}{2\\pi\\sigma^2}\\sqrt{4\\sigma^2 - \\lambda^2}$$\n\u5373Wigner\u534a\u5706\u5f8b\u7684\u53d8\u4f53\u3002</p>\n<ol start=\"3\">\n<li><strong>\u9ad8\u6548\u9003\u9038\u7b56\u7565</strong>\uff1a</li>\n</ol>\n<p><strong>Power Method\u7684\u52a0\u901f\u53d8\u4f53</strong>\uff1a\n   ```\n   \u8f93\u5165: \u5f53\u524d\u70b9 w, \u5bb9\u5fcd\u5ea6 \u03b5</p>\n<ol>\n<li>\u521d\u59cb\u5316\u968f\u673a\u5411\u91cf v</li>\n<li>\n<p>for k = 1 to K:\n      a. \u1e7d = Hv (\u4f7f\u7528Hessian-vector product)\n      b. \u03bc = v^T \u1e7d / ||v||\u00b2\n      c. if \u03bc &lt; -\u03b5: return v as escape direction\n      d. v = \u1e7d / ||\u1e7d||</p>\n</li>\n<li>\n<p>return null (no negative curvature found)\n   ```</p>\n</li>\n</ol>\n<p><strong>Lanczos\u52a0\u901f</strong>\uff1a</p>\n<ul>\n<li>\u6784\u5efaKrylov\u5b50\u7a7a\u95f4 $\\mathcal{K}_k(\\mathbf{H}, \\mathbf{v})$</li>\n<li>\u5728\u5b50\u7a7a\u95f4\u4e2d\u627e\u6700\u5c0f\u7279\u5f81\u503c</li>\n<li>\u901a\u5e38 $k \\ll n$ \u5373\u53ef\u627e\u5230\u597d\u7684\u8fd1\u4f3c</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u4e0e\u4f18\u5316\u5668\u7684\u96c6\u6210</strong>\uff1a</li>\n</ol>\n<p><strong>SGD with Negative Curvature</strong>\uff1a\n$$\\mathbf{w}_{t+1} = \\mathbf{w}_t - \\eta_t \\mathbf{g}_t - \\alpha_t \\mathbf{v}_t$$\n   \u5176\u4e2d $\\mathbf{v}_t$ \u662f\u8d1f\u66f2\u7387\u65b9\u5411\uff08\u5982\u679c\u5b58\u5728\uff09\u3002</p>\n<p><strong>Adam-NC (Adam with Negative Curvature)</strong>\uff1a</p>\n<ul>\n<li>\u7ef4\u62a4\u68af\u5ea6\u548c\u8d1f\u66f2\u7387\u65b9\u5411\u7684\u72ec\u7acb\u52a8\u91cf</li>\n<li>\u81ea\u9002\u5e94\u6df7\u5408\u4e24\u4e2a\u65b9\u5411</li>\n<li>\u5728\u978d\u70b9\u9644\u8fd1\u81ea\u52a8\u589e\u5927\u8d1f\u66f2\u7387\u6743\u91cd</li>\n</ul>\n<ol start=\"5\">\n<li><strong>\u7406\u8bba\u4fdd\u8bc1\u7684\u589e\u5f3a</strong>\uff1a</li>\n</ol>\n<p><strong>Fast Escaping via Coupling</strong>\uff1a\n   \u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u5e26\u4e0d\u540c\u6270\u52a8\u7684\u526f\u672c\uff1a</p>\n<ul>\n<li>\u8026\u5408\u5f3a\u5ea6\u968f\u65f6\u95f4\u8870\u51cf</li>\n<li>\u6700\u5feb\u9003\u79bb\u7684\u526f\u672c\u5e26\u52a8\u5176\u4ed6\u526f\u672c</li>\n<li>\u7406\u8bba\u4e0a\u6539\u8fdb\u9003\u9038\u65f6\u95f4\u590d\u6742\u5ea6</li>\n</ul>\n<p><strong>Correlated Negative Curvature</strong>\uff1a\n   \u5229\u7528\u53c2\u6570\u95f4\u7684\u76f8\u5173\u7ed3\u6784\uff1a</p>\n<ul>\n<li>\u5757\u5bf9\u89d2\u8fd1\u4f3c\u627e\u5230\u76f8\u5173\u7684\u8d1f\u66f2\u7387\u65b9\u5411</li>\n<li>\u51cf\u5c11\u8ba1\u7b97\u540c\u65f6\u4fdd\u6301\u9003\u9038\u6548\u7387</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u6280\u672f\u4e0e\u524d\u6cbf\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u62d3\u6251\u6570\u636e\u5206\u6790(TDA)\u65b9\u6cd5</strong>\uff1a\n   - \u4f7f\u7528\u6301\u7eed\u540c\u8c03(Persistent Homology)\u5206\u6790\u635f\u5931\u5730\u5f62\n   - \u8bc6\u522b\u978d\u70b9\u7684\u8fde\u901a\u5206\u91cf\n   - \u8bbe\u8ba1\u62d3\u6251\u611f\u77e5\u7684\u9003\u9038\u8def\u5f84</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u77e9\u9635\u7406\u8bba\u7684\u5e94\u7528</strong>\uff1a\n   - \u9884\u6d4b\u4e0d\u540c\u6df1\u5ea6/\u5bbd\u5ea6\u4e0b\u7684\u978d\u70b9\u5bc6\u5ea6\n   - \u8bbe\u8ba1\u67b6\u6784\u4ee5\u51cf\u5c11\u574f\u978d\u70b9\n   - \u7406\u89e3over-parameterization\u7684\u76ca\u5904</p>\n</li>\n<li>\n<p><strong>\u4e0e\u6cdb\u5316\u7684\u8054\u7cfb</strong>\uff1a\n   - Flat vs Sharp\u978d\u70b9\u7684\u6cdb\u5316\u5dee\u5f02\n   - \u9003\u9038\u8def\u5f84\u7684\u9690\u5f0f\u6b63\u5219\u5316\n   - PAC-Bayes\u6846\u67b6\u4e0b\u7684\u5206\u6790</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528\u7f51\u7edc\u7ed3\u6784\u52a0\u901f\u978d\u70b9\u9003\u9038</li>\n<li>\u978d\u70b9\u7684\u62d3\u6251\u7ed3\u6784\u4e0e\u6cdb\u5316\u6027\u80fd\u7684\u5173\u7cfb</li>\n<li>\u91cf\u5b50\u9000\u706b\u542f\u53d1\u7684\u9003\u9038\u7b97\u6cd5</li>\n<li>\u795e\u7ecf\u67b6\u6784\u641c\u7d22\u4e2d\u7684\u978d\u70b9\u8003\u8651</li>\n<li>\u8054\u90a6\u5b66\u4e60\u73af\u5883\u4e0b\u7684\u5206\u5e03\u5f0f\u978d\u70b9\u9003\u9038</li>\n<li>\u5bf9\u6297\u9c81\u68d2\u6027\u4e0e\u978d\u70b9\u7ed3\u6784\u7684\u5173\u7cfb</li>\n</ul>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u5efa\u7acb\u4e86\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\u7684\u7edf\u4e00\u6846\u67b6\uff0c\u6838\u5fc3\u8981\u70b9\u5305\u62ec\uff1a</p>\n<ol>\n<li><strong>\u7edf\u4e00\u89c6\u89d2</strong>\uff1aNewton\u6cd5\u3001Gauss-Newton\u6cd5\u548cNatural Gradient\u90fd\u53ef\u89c6\u4e3a\u4f7f\u7528\u4e0d\u540c\u66f2\u7387\u77e9\u9635\u7684\u4e8c\u9636\u65b9\u6cd5</li>\n<li><strong>Fisher-Hessian\u8054\u7cfb</strong>\uff1a\u5728\u671f\u671b\u610f\u4e49\u4e0b\u548c\u7279\u5b9a\u6761\u4ef6\u4e0b\uff0cFisher\u4fe1\u606f\u77e9\u9635\u7b49\u4ef7\u4e8eHessian</li>\n<li><strong>Trust Region\u590d\u5174</strong>\uff1a\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u91cd\u65b0\u53d1\u73b0\u4e86Trust Region\u65b9\u6cd5\u7684\u4ef7\u503c\uff0c\u7279\u522b\u662f\u5728\u5904\u7406\u975e\u51f8\u6027\u65b9\u9762</li>\n<li><strong>\u978d\u70b9\u9003\u9038</strong>\uff1a\u7406\u8bba\u4fdd\u8bc1\u4e0e\u5b9e\u7528\u7b97\u6cd5\u7684\u7ed3\u5408\uff0c\u4f7f\u4e8c\u9636\u65b9\u6cd5\u5728\u975e\u51f8\u4f18\u5316\u4e2d\u66f4\u52a0\u53ef\u9760</li>\n</ol>\n<p>\u5173\u952e\u516c\u5f0f\u56de\u987e\uff1a</p>\n<ul>\n<li>\u5e7f\u4e49\u66f4\u65b0\u89c4\u5219\uff1a$\\mathbf{G}_k \\Delta\\mathbf{w}_k = -\\nabla f(\\mathbf{w}_k)$</li>\n<li>Fisher\u4fe1\u606f\u77e9\u9635\uff1a$\\mathbf{F} = \\mathbb{E}[\\nabla \\log p \\nabla \\log p^T]$</li>\n<li>Trust Region\u5b50\u95ee\u9898\uff1a$\\min_{|\\Delta\\mathbf{w}| \\leq \\delta} m(\\Delta\\mathbf{w})$</li>\n<li>\u4e25\u683c\u978d\u70b9\u6761\u4ef6\uff1a$\\lambda_{\\min}(\\nabla^2 f) &lt; -\\epsilon$</li>\n</ul>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u98981.1</strong> \u8bc1\u660e\u5bf9\u4e8e\u7ebf\u6027\u56de\u5f52\u95ee\u9898 $f(\\mathbf{w}) = \\frac{1}{2}|\\mathbf{Xw} - \\mathbf{y}|^2$\uff0cGauss-Newton\u6cd5\u5728\u4e00\u6b65\u5185\u6536\u655b\u5230\u5168\u5c40\u6700\u4f18\u89e3\u3002</p>\n<p><em>Hint</em>: \u8ba1\u7b97Gauss-Newton Hessian\u5e76\u9a8c\u8bc1\u5b83\u4e0e\u771f\u5b9eHessian\u76f8\u7b49\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e\u7ebf\u6027\u56de\u5f52\uff0c\u6b8b\u5dee $\\mathbf{r}(\\mathbf{w}) = \\mathbf{Xw} - \\mathbf{y}$\uff0cJacobian\u4e3a $\\mathbf{J} = \\mathbf{X}$\u3002\n\u56e0\u6b64 $\\mathbf{H}_{GN} = \\mathbf{X}^T\\mathbf{X} = \\nabla^2 f$\uff0c\u5373Gauss-Newton Hessian\u7b49\u4e8e\u771f\u5b9eHessian\u3002\n\u7531\u4e8e\u76ee\u6807\u51fd\u6570\u662f\u51f8\u4e8c\u6b21\u7684\uff0cNewton\u6cd5\uff08\u6b64\u65f6\u7b49\u4ef7\u4e8eGauss-Newton\uff09\u4e00\u6b65\u6536\u655b\u3002</p>\n</details>\n<p><strong>\u4e60\u98981.2</strong> \u5bf9\u4e8eSoftmax\u56de\u5f52\uff0c\u63a8\u5bfcFisher\u4fe1\u606f\u77e9\u9635\u7684\u663e\u5f0f\u8868\u8fbe\u5f0f\u3002</p>\n<p><em>Hint</em>: \u5229\u7528Softmax\u51fd\u6570\u7684\u6027\u8d28\u548c\u5206\u7c7b\u5206\u5e03\u7684score function\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbeSoftmax\u6982\u7387\u4e3a $p_k = \\frac{\\exp(\\mathbf{w}_k^T\\mathbf{x})}{\\sum_j \\exp(\\mathbf{w}_j^T\\mathbf{x})}$\u3002\nFisher\u4fe1\u606f\u77e9\u9635\u7684\u5757 $(i,j)$ \u4e3a\uff1a</p>\n<ul>\n<li>\u5f53 $i = j$: $\\mathbf{F}_{ii} = \\mathbb{E}[p_i(1-p_i)\\mathbf{x}\\mathbf{x}^T]$</li>\n<li>\u5f53 $i \\neq j$: $\\mathbf{F}_{ij} = -\\mathbb{E}[p_ip_j\\mathbf{x}\\mathbf{x}^T]$</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98981.3</strong> \u5b9e\u73b0\u5e76\u6bd4\u8f83Steepest Descent\u548cConjugate Gradient\u6c42\u89e3Trust Region\u5b50\u95ee\u9898\u7684\u6548\u7387\u3002</p>\n<p><em>Hint</em>: \u4f7f\u7528Steihaug-Toint CG\u7b97\u6cd5\uff0c\u6ce8\u610f\u8fb9\u754c\u60c5\u51b5\u7684\u5904\u7406\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5173\u952e\u5b9e\u73b0\u8981\u70b9\uff1a</p>\n<ol>\n<li>CG\u8fed\u4ee3\u4e2d\u76d1\u6d4b\u662f\u5426\u5230\u8fbetrust region\u8fb9\u754c</li>\n<li>\u5982\u679c\u5230\u8fbe\u8fb9\u754c\uff0c\u6c42\u89e3\u4e8c\u6b21\u65b9\u7a0b\u627e\u5230\u8fb9\u754c\u4e0a\u7684\u4ea4\u70b9</li>\n<li>\u68c0\u6d4b\u8d1f\u66f2\u7387\u65b9\u5411\uff0c\u6b64\u65f6\u6cbf\u8be5\u65b9\u5411\u5230\u8fbe\u8fb9\u754c</li>\n<li>\u5bf9\u4e8e\u5178\u578b\u95ee\u9898\uff0cCG\u901a\u5e38\u5728\u8fdc\u5c11\u4e8e $n$ \u6b21\u8fed\u4ee3\u5185\u6536\u655b</li>\n</ol>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u98981.4</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7b97\u6cd5\uff0c\u6839\u636e\u5c40\u90e8\u66f2\u7387\u81ea\u52a8\u5728Newton\u3001Gauss-Newton\u548cNatural Gradient\u4e4b\u95f4\u5207\u6362\u3002</p>\n<p><em>Hint</em>: \u8003\u8651\u4f7f\u7528\u6761\u4ef6\u6570\u3001\u8d1f\u7279\u5f81\u503c\u6bd4\u4f8b\u7b49\u6307\u6807\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u4fbf\u5b9c\u7684\u66f2\u7387\u6307\u6807\uff08\u5982\u68af\u5ea6\u8303\u6570\u53d8\u5316\u7387\uff09</li>\n<li>\u5982\u679c\u68c0\u6d4b\u5230\u5f3a\u975e\u51f8\u6027\uff08\u8d1f\u7279\u5f81\u503c\uff09\uff0c\u4f7f\u7528\u4fee\u6b63Newton</li>\n<li>\u5bf9\u4e8e\u8fd1\u4f3c\u51f8\u7684\u533a\u57df\uff0c\u6bd4\u8f83GN\u8fd1\u4f3c\u8bef\u5dee</li>\n<li>\u5f53\u6a21\u578b\u63a5\u8fd1\u6982\u7387\u89e3\u91ca\u65f6\uff0c\u8003\u8651Natural Gradient</li>\n<li>\u4f7f\u7528\u6ed1\u52a8\u5e73\u5747\u5e73\u6ed1\u5207\u6362\u51b3\u7b56</li>\n</ol>\n</details>\n<p><strong>\u4e60\u98981.5</strong> \u5206\u6790\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\uff0cTrust Region\u65b9\u6cd5\u7684\u6536\u655b\u901f\u5ea6\u4f18\u4e8e\u7ebf\u641c\u7d22\u65b9\u6cd5\u3002\u6784\u9020\u5177\u4f53\u4f8b\u5b50\u3002</p>\n<p><em>Hint</em>: \u8003\u8651\u75c5\u6001Hessian\u548c\u975e\u51f8\u51fd\u6570\u7684\u60c5\u51b5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Trust Region\u4f18\u52bf\u60c5\u5f62\uff1a</p>\n<ol>\n<li>\u75c5\u6001\u95ee\u9898\uff1a\u5f53Hessian\u6761\u4ef6\u6570\u5f88\u5927\u65f6\uff0c\u7ebf\u641c\u7d22\u53ef\u80fd\u9700\u8981\u5f88\u591a\u6b21\u51fd\u6570\u8bc4\u4f30</li>\n<li>\u5f3a\u975e\u51f8\u6027\uff1aTrust Region\u80fd\u66f4\u597d\u5904\u7406\u8d1f\u66f2\u7387</li>\n<li>\u566a\u58f0\u68af\u5ea6\uff1aTrust Region\u5bf9\u6b65\u957f\u7684\u9c81\u68d2\u6027\u66f4\u597d\n\u5177\u4f53\u4f8b\u5b50\uff1aRosenbrock\u51fd\u6570\u5728\u72ed\u957f\u8c37\u5e95\uff0cTrust Region\u80fd\u81ea\u9002\u5e94\u8c03\u6574\u6b65\u957f\u65b9\u5411</li>\n</ol>\n</details>\n<p><strong>\u4e60\u98981.6</strong> \u8bc1\u660e\u5bf9\u4e8e\u8fc7\u53c2\u6570\u5316\u7684\u795e\u7ecf\u7f51\u7edc\uff0c\u5728\u9002\u5f53\u521d\u59cb\u5316\u4e0b\uff0cGauss-Newton\u6cd5\u7684\u66f4\u65b0\u65b9\u5411\u63a5\u8fd1Natural Gradient\u3002</p>\n<p><em>Hint</em>: \u5229\u7528\u795e\u7ecf\u5207\u7ebf\u6838(NTK)\u7406\u8bba\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5728\u5bbd\u5ea6\u8d8b\u4e8e\u65e0\u7a77\u7684\u6781\u9650\u4e0b\uff1a</p>\n<ol>\n<li>\u7f51\u7edc\u51fd\u6570\u7ebf\u6027\u5316\uff0cJacobian\u4fdd\u6301\u8fd1\u4f3c\u4e0d\u53d8</li>\n<li>Gauss-Newton\u77e9\u9635 $\\mathbf{J}^T\\mathbf{J}$ \u6536\u655b\u5230NTK</li>\n<li>\u5728\u5206\u7c7b\u4efb\u52a1\u4e2d\uff0cFisher\u4fe1\u606f\u4e5f\u6536\u655b\u5230\u76f8\u540c\u7684\u6838</li>\n<li>\u56e0\u6b64\u4e24\u79cd\u65b9\u6cd5\u7ed9\u51fa\u76f8\u8fd1\u7684\u66f4\u65b0\u65b9\u5411\n\u5173\u952e\u5047\u8bbe\uff1a\u9002\u5f53\u7684\u521d\u59cb\u5316scale\u548c\u8f93\u51fa\u5c42\u7684\u53c2\u6570\u5316</li>\n</ol>\n</details>\n<p><strong>\u4e60\u98981.7</strong>\uff08\u5f00\u653e\u95ee\u9898\uff09\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u7edf\u4e00\u7684\u9884\u6761\u4ef6\u5b50\uff0c\u80fd\u591f\u81ea\u9002\u5e94\u5730\u5728\u4e0d\u540c\u4f18\u5316\u9636\u6bb5\u63d0\u4f9b\u6700\u5408\u9002\u7684\u66f2\u7387\u4fe1\u606f\uff1f</p>\n<p><em>Hint</em>: \u8003\u8651\u5143\u5b66\u4e60\u3001\u5728\u7ebf\u5b66\u4e60\u7406\u8bba\u548c\u77e9\u9635\u5b66\u4e60\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ol>\n<li>\u57fa\u4e8e\u5386\u53f2\u4fe1\u606f\u7684\u5728\u7ebf\u66f2\u7387\u77e9\u9635\u5b66\u4e60</li>\n<li>\u4f7f\u7528\u5f3a\u5316\u5b66\u4e60\u9009\u62e9\u9884\u6761\u4ef6\u7b56\u7565</li>\n<li>\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784\u7684\u81ea\u9002\u5e94\u5206\u89e3</li>\n<li>\u8003\u8651\u8ba1\u7b97\u9884\u7b97\u7684\u6700\u4f18\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</li>\n<li>\u7406\u8bba\u5206\u6790\uff1aregret bounds\u548c\u6536\u655b\u6027\u4fdd\u8bc1</li>\n</ol>\n</details>\n<p><strong>\u4e60\u98981.8</strong> \u63a2\u8ba8\u91cf\u5b50\u8ba1\u7b97\u5bf9\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\u53ef\u80fd\u5e26\u6765\u7684\u52a0\u901f\u3002\u7279\u522b\u5173\u6ce8\u77e9\u9635\u6c42\u9006\u548c\u7279\u5f81\u503c\u8ba1\u7b97\u3002</p>\n<p><em>Hint</em>: \u7814\u7a76HHL\u7b97\u6cd5\u548c\u91cf\u5b50\u76f8\u4f4d\u4f30\u8ba1\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6f5c\u5728\u52a0\u901f\u70b9\uff1a</p>\n<ol>\n<li>HHL\u7b97\u6cd5\uff1a\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u6307\u6570\u52a0\u901f\u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3</li>\n<li>\u91cf\u5b50\u76f8\u4f4d\u4f30\u8ba1\uff1a\u52a0\u901f\u7279\u5f81\u503c\u8ba1\u7b97\uff0c\u6709\u52a9\u4e8e\u978d\u70b9\u68c0\u6d4b</li>\n<li>\u91cf\u5b50\u91c7\u6837\uff1a\u6539\u8fdb\u968f\u673a\u4e8c\u9636\u65b9\u6cd5\u7684\u65b9\u5dee\n\u6311\u6218\uff1a\u91cf\u5b50\u6001\u5236\u5907\u3001\u8bfb\u51fa\u5f00\u9500\u3001\u6709\u9650\u7684\u91cf\u5b50\u6bd4\u7279\u6570\n\u73b0\u5b9e\u8003\u8651\uff1a\u8fd1\u671f\u91cf\u5b50\u8bbe\u5907\u4e0a\u7684\u53d8\u5206\u91cf\u5b50\u7b97\u6cd5</li>\n</ol>\n</details>\n<h2 id=\"_5\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u4e0d\u7a33\u5b9a</strong>\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u6c42\u9006\u75c5\u6001\u77e9\u9635\n   - \u6b63\u786e\uff1a\u4f7f\u7528Cholesky\u5206\u89e3\u6216CG\u8fed\u4ee3\uff0c\u52a0\u5165\u9002\u5f53\u6b63\u5219\u5316</p>\n</li>\n<li>\n<p><strong>\u5ffd\u89c6\u8ba1\u7b97\u590d\u6742\u5ea6</strong>\n   - \u9519\u8bef\uff1a\u5728\u9ad8\u7ef4\u95ee\u9898\u4e2d\u6784\u9020\u5b8c\u6574Hessian\n   - \u6b63\u786e\uff1a\u4f7f\u7528Hessian-vector product\uff0c\u907f\u514d\u663e\u5f0f\u6784\u9020</p>\n</li>\n<li>\n<p><strong>Trust Region\u53c2\u6570\u8bbe\u7f6e</strong>\n   - \u9519\u8bef\uff1a\u56fa\u5b9atrust region\u534a\u5f84\n   - \u6b63\u786e\uff1a\u57fa\u4e8e\u6a21\u578b\u9884\u6d4b\u8d28\u91cf\u81ea\u9002\u5e94\u8c03\u6574</p>\n</li>\n<li>\n<p><strong>\u978d\u70b9\u68c0\u6d4b\u8bef\u5224</strong>\n   - \u9519\u8bef\uff1a\u4ec5\u4f9d\u636e\u68af\u5ea6\u8303\u6570\u5224\u65ad\n   - \u6b63\u786e\uff1a\u7ed3\u5408\u68af\u5ea6\u8303\u6570\u548c\u6700\u5c0f\u7279\u5f81\u503c\u4fe1\u606f</p>\n</li>\n<li>\n<p><strong>Natural Gradient\u5b9e\u73b0\u9519\u8bef</strong>\n   - \u9519\u8bef\uff1a\u4f7f\u7528\u6279\u91cfFisher\u800c\u975e\u671f\u671bFisher\n   - \u6b63\u786e\uff1a\u7406\u89e3Empirical Fisher vs True Fisher\u7684\u533a\u522b</p>\n</li>\n</ol>\n<h2 id=\"_6\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_7\">\u7b97\u6cd5\u9009\u62e9</h3>\n<ul>\n<li>[ ] \u95ee\u9898\u662f\u5426\u6709\u6982\u7387\u89e3\u91ca\uff1f\u8003\u8651Natural Gradient</li>\n<li>[ ] \u662f\u5426\u662f\u6700\u5c0f\u4e8c\u4e58\u7ed3\u6784\uff1f\u4f18\u5148Gauss-Newton</li>\n<li>[ ] \u8ba1\u7b97\u9884\u7b97\u5982\u4f55\uff1f\u6743\u8861\u7cbe\u786e\u5ea6\u4e0e\u6548\u7387</li>\n<li>[ ] \u975e\u51f8\u7a0b\u5ea6\uff1f\u9700\u8981\u978d\u70b9\u9003\u9038\u673a\u5236</li>\n</ul>\n<h3 id=\"_8\">\u5b9e\u73b0\u7ec6\u8282</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u8fed\u4ee3\u6cd5\u800c\u975e\u76f4\u63a5\u6c42\u9006</li>\n<li>[ ] \u5b9e\u73b0Hessian-vector product\u800c\u975e\u5b8c\u6574\u77e9\u9635</li>\n<li>[ ] \u52a0\u5165\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u62a4\uff08\u6761\u4ef6\u6570\u68c0\u67e5\uff09</li>\n<li>[ ] \u76d1\u63a7\u6536\u655b\u8bca\u65ad\u6307\u6807</li>\n</ul>\n<h3 id=\"_9\">\u6027\u80fd\u4f18\u5316</h3>\n<ul>\n<li>[ ] \u5229\u7528\u95ee\u9898\u7ed3\u6784\uff08\u7a00\u758f\u6027\u3001\u4f4e\u79e9\u6027\uff09</li>\n<li>[ ] \u5b9e\u73b0\u9ad8\u6548\u7684\u7ebf\u6027\u4ee3\u6570\u540e\u7aef</li>\n<li>[ ] \u8003\u8651\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</li>\n<li>[ ] \u5e76\u884c\u5316\u77e9\u9635\u8fd0\u7b97</li>\n</ul>\n<h3 id=\"_10\">\u7406\u8bba\u4fdd\u8bc1</h3>\n<ul>\n<li>[ ] \u9a8c\u8bc1\u6536\u655b\u6761\u4ef6\u662f\u5426\u6ee1\u8db3</li>\n<li>[ ] \u68c0\u67e5\u6b65\u957f\u662f\u5426\u5728\u7406\u8bba\u754c\u5185</li>\n<li>[ ] \u76d1\u63a7\u4f18\u5316\u8f68\u8ff9\u7684\u7a33\u5b9a\u6027</li>\n<li>[ ] \u8bb0\u5f55\u5173\u952e\u8bca\u65ad\u4fe1\u606f\u4f9b\u5206\u6790</li>\n</ul>"
  },
  "../chapter14.md": {
    "hash": "725481a49eddaef882349b4cbe6977ec",
    "content": "<h1 id=\"14\">\u7b2c14\u7ae0\uff1a\u5927\u89c4\u6a21\u534f\u540c\u8fc7\u6ee4\u7684\u77e9\u9635\u6280\u672f</h1>\n<p>\u63a8\u8350\u7cfb\u7edf\u662f\u73b0\u4ee3\u4e92\u8054\u7f51\u670d\u52a1\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u800c\u77e9\u9635\u5206\u89e3\u6280\u672f\u5219\u662f\u5176\u6570\u5b66\u57fa\u77f3\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5728\u5904\u7406\u6570\u5341\u4ebf\u7528\u6237\u548c\u6570\u767e\u4e07\u7269\u54c1\u65f6\uff0c\u5982\u4f55\u8bbe\u8ba1\u548c\u4f18\u5316\u77e9\u9635\u8ba1\u7b97\u65b9\u6cd5\u3002\u6211\u4eec\u5c06\u91cd\u70b9\u5173\u6ce8\u9690\u5f0f\u53cd\u9988\u573a\u666f\u2014\u2014\u8fd9\u662f\u5b9e\u9645\u7cfb\u7edf\u4e2d\u6700\u5e38\u89c1\u4f46\u4e5f\u6700\u5177\u6311\u6218\u6027\u7684\u8bbe\u7f6e\u3002\u901a\u8fc7\u5b66\u4e60\u672c\u7ae0\uff0c\u8bfb\u8005\u5c06\u638c\u63e1\u5de5\u4e1a\u7ea7\u63a8\u8350\u7cfb\u7edf\u80cc\u540e\u7684\u6838\u5fc3\u77e9\u9635\u6280\u672f\uff0c\u7406\u89e3\u4ece\u7406\u8bba\u5230\u5b9e\u8df5\u7684\u5173\u952e\u6743\u8861\uff0c\u5e76\u80fd\u591f\u8bbe\u8ba1\u9002\u5408\u7279\u5b9a\u573a\u666f\u7684\u9ad8\u6548\u7b97\u6cd5\u3002</p>\n<h2 id=\"141\">14.1 \u9690\u5f0f\u53cd\u9988\u77e9\u9635\u5206\u89e3\u7684\u52a0\u6743\u7b56\u7565</h2>\n<h3 id=\"1411\">14.1.1 \u9690\u5f0f\u53cd\u9988\u4e0e\u663e\u5f0f\u8bc4\u5206\u7684\u672c\u8d28\u5dee\u5f02</h3>\n<p>\u5728\u663e\u5f0f\u8bc4\u5206\u7cfb\u7edf\u4e2d\uff0c\u7528\u6237\u4e3b\u52a8\u4e3a\u7269\u54c1\u6253\u5206\uff08\u59821-5\u661f\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u8bc4\u5206\u77e9\u9635 $\\mathbf{R} \\in \\mathbb{R}^{m \\times n}$ \u5206\u89e3\u4e3a\uff1a\n$$\\mathbf{R} \\approx \\mathbf{P}\\mathbf{Q}^T$$\n\u5176\u4e2d $\\mathbf{P} \\in \\mathbb{R}^{m \\times k}$ \u662f\u7528\u6237\u56e0\u5b50\u77e9\u9635\uff0c$\\mathbf{Q} \\in \\mathbb{R}^{n \\times k}$ \u662f\u7269\u54c1\u56e0\u5b50\u77e9\u9635\u3002</p>\n<p>\u7136\u800c\uff0c\u9690\u5f0f\u53cd\u9988\uff08\u70b9\u51fb\u3001\u6d4f\u89c8\u3001\u8d2d\u4e70\u7b49\uff09\u5e26\u6765\u4e86\u6839\u672c\u6027\u7684\u6311\u6218\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6b63\u6837\u672c\u504f\u5dee</strong>\uff1a\u89c2\u5bdf\u5230\u7684\u4ea4\u4e92\u4e0d\u7b49\u540c\u4e8e\u504f\u597d\u5f3a\u5ea6\n   - \u9ad8\u9891\u70b9\u51fb\u53ef\u80fd\u6e90\u4e8eUI\u4f4d\u7f6e\u800c\u975e\u771f\u5b9e\u5174\u8da3\n   - \u8d2d\u4e70\u884c\u4e3a\u53d7\u4ef7\u683c\u3001\u5e93\u5b58\u7b49\u5916\u90e8\u56e0\u7d20\u5f71\u54cd\n   - \u6d4f\u89c8\u65f6\u957f\u53d7\u5185\u5bb9\u957f\u5ea6\u548c\u7528\u6237\u7a7a\u95f2\u65f6\u95f4\u5f71\u54cd\n   - \u6279\u91cf\u64cd\u4f5c\uff08\u5982\u6e05\u7a7a\u8d2d\u7269\u8f66\uff09\u5f15\u5165\u566a\u58f0\n   - \u5b63\u8282\u6027\u548c\u4fc3\u9500\u6d3b\u52a8\u9020\u6210\u7684\u884c\u4e3a\u5f02\u5e38</p>\n</li>\n<li>\n<p><strong>\u8d1f\u6837\u672c\u7f3a\u5931</strong>\uff1a\u672a\u4ea4\u4e92\u4e0d\u7b49\u4e8e\u4e0d\u611f\u5174\u8da3\n   - \u7528\u6237\u672a\u53d1\u73b0\u7684\u4f18\u8d28\u5185\u5bb9\uff08\u66dd\u5149\u504f\u5dee\uff09\n   - \u65f6\u95f4\u9650\u5236\u5bfc\u81f4\u7684\u672a\u6d88\u8d39\uff08\u673a\u4f1a\u6210\u672c\uff09\n   - \u5e73\u53f0\u63a8\u8350\u7b97\u6cd5\u9020\u6210\u7684\u8fc7\u6ee4\u6c14\u6ce1\n   - \u65b0\u7269\u54c1\u7684\u51b7\u542f\u52a8\u95ee\u9898\n   - \u5730\u7406\u9650\u5236\u6216\u5185\u5bb9\u6388\u6743\u5bfc\u81f4\u7684\u4e0d\u53ef\u8fbe</p>\n</li>\n<li>\n<p><strong>\u7f6e\u4fe1\u5ea6\u5dee\u5f02</strong>\uff1a\u4e0d\u540c\u7c7b\u578b\u4ea4\u4e92\u7684\u53ef\u9760\u6027\u4e0d\u540c\n   - \u8d2d\u4e70 &gt; \u6536\u85cf &gt; \u70b9\u8d5e &gt; \u70b9\u51fb &gt; \u66dd\u5149\n   - \u91cd\u590d\u884c\u4e3a\u6bd4\u5355\u6b21\u884c\u4e3a\u66f4\u53ef\u9760\n   - \u4e3b\u52a8\u641c\u7d22\u6bd4\u88ab\u52a8\u6d4f\u89c8\u66f4\u80fd\u53cd\u6620\u771f\u5b9e\u610f\u56fe\n   - \u6df1\u5ea6\u4ea4\u4e92\uff08\u8bc4\u8bba\u3001\u5206\u4eab\uff09\u6bd4\u6d45\u5c42\u4ea4\u4e92\u66f4\u6709\u4ef7\u503c\n   - \u4ed8\u8d39\u884c\u4e3a\u6bd4\u514d\u8d39\u884c\u4e3a\u66f4\u80fd\u53cd\u6620\u771f\u5b9e\u504f\u597d</p>\n</li>\n</ol>\n<p><strong>\u6570\u5b66\u5efa\u6a21\u7684\u8303\u5f0f\u8f6c\u53d8</strong>\uff1a</p>\n<p>\u4ece\u6982\u7387\u89d2\u5ea6\uff0c\u663e\u5f0f\u8bc4\u5206\u53ef\u4ee5\u5efa\u6a21\u4e3a\uff1a\n$$P(r_{ui} | \\mathbf{p}_u, \\mathbf{q}_i) = \\mathcal{N}(r_{ui}; \\mathbf{p}_u^T\\mathbf{q}_i, \\sigma^2)$$\n\u800c\u9690\u5f0f\u53cd\u9988\u9700\u8981\u8003\u8651\u4e24\u9636\u6bb5\u8fc7\u7a0b\uff1a</p>\n<ol>\n<li><strong>\u504f\u597d\u751f\u6210</strong>\uff1a$\\text{preference}_{ui} \\sim \\text{Bernoulli}(\\sigma(\\mathbf{p}_u^T\\mathbf{q}_i))$</li>\n<li><strong>\u89c2\u5bdf\u8fc7\u7a0b</strong>\uff1a$\\text{observed}_{ui} | \\text{preference}_{ui} \\sim \\text{Bernoulli}(p_{\\text{obs}})$</li>\n</ol>\n<p>\u8fd9\u5bfc\u81f4\u6211\u4eec\u9700\u8981\u91cd\u65b0\u8bbe\u8ba1\u76ee\u6807\u51fd\u6570\uff1a\n$$\\min_{\\mathbf{P},\\mathbf{Q}} \\sum_{(u,i) \\in \\mathcal{D}} c_{ui}(p_{ui} - \\mathbf{p}_u^T\\mathbf{q}_i)^2 + \\lambda(|\\mathbf{P}|_F^2 + |\\mathbf{Q}|_F^2)$$\n\u5176\u4e2d $c_{ui}$ \u662f\u7f6e\u4fe1\u5ea6\u6743\u91cd\uff0c$p_{ui}$ \u662f\u504f\u597d\u6307\u793a\u5668\uff08\u901a\u5e38\u4e8c\u503c\u5316\uff09\u3002</p>\n<p><strong>\u6570\u5b66\u672c\u8d28</strong>\uff1a\u4ece\u671f\u671b\u6700\u5927\u5316(EM)\u89d2\u5ea6\u7406\u89e3</p>\n<ul>\n<li>E\u6b65\uff1a\u57fa\u4e8e\u5f53\u524d\u6a21\u578b\u63a8\u65ad\u7f3a\u5931\u7684\u8d1f\u53cd\u9988</li>\n<li>M\u6b65\uff1a\u5728\u52a0\u6743\u7684\u5b8c\u6574\u6570\u636e\u4e0a\u66f4\u65b0\u53c2\u6570</li>\n<li>\u6743\u91cd $c_{ui}$ \u53cd\u6620\u4e86\u6211\u4eec\u5bf9\u89c2\u5bdf\u503c\u7684\u4fe1\u4efb\u7a0b\u5ea6</li>\n</ul>\n<p><strong>\u7406\u8bba\u8054\u7cfb</strong>\uff1a\u9690\u5f0f\u53cd\u9988\u77e9\u9635\u5206\u89e3\u4e0e\u5176\u4ed6\u673a\u5668\u5b66\u4e60\u65b9\u6cd5\u7684\u6df1\u5c42\u8054\u7cfb\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e0e\u6392\u5e8f\u5b66\u4e60\u7684\u5173\u7cfb</strong>\uff1a\n   \u9690\u5f0f\u53cd\u9988MF\u53ef\u4ee5\u89c6\u4e3a\u5168\u5c40\u6392\u5e8f\u6a21\u578b\uff1a\n$$P(i \\succ j | u) = \\sigma(\\mathbf{p}_u^T(\\mathbf{q}_i - \\mathbf{q}_j))$$</p>\n</li>\n<li>\n<p><strong>\u4e0e\u70b9\u8fc7\u7a0b\u7684\u8054\u7cfb</strong>\uff1a\n   \u7528\u6237\u884c\u4e3a\u5e8f\u5217\u53ef\u5efa\u6a21\u4e3a\u6807\u8bb0\u65f6\u7a7a\u70b9\u8fc7\u7a0b\uff1a\n$$\\lambda(t,i|u) = \\mu_i \\cdot \\exp(\\mathbf{p}_u^T\\mathbf{q}_i) \\cdot g(t-t_{\\text{last}})$$</p>\n</li>\n<li>\n<p><strong>\u4e0e\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u5bf9\u5e94</strong>\uff1a\n   \u77e9\u9635\u5206\u89e3\u7b49\u4ef7\u4e8e\u5728\u4e8c\u90e8\u56fe\u4e0a\u7684\u6d45\u5c42\u56fe\u5d4c\u5165\uff1a\n$$\\mathbf{h}_u = \\text{Aggregate}({\\mathbf{q}_i : i \\in \\mathcal{N}(u)})$$\n<strong>\u5b9e\u8df5\u8003\u8651</strong>\uff1a\u5de5\u4e1a\u7cfb\u7edf\u4e2d\u7684\u989d\u5916\u590d\u6742\u6027</p>\n</li>\n<li>\n<p><strong>\u591a\u8bbe\u5907\u884c\u4e3a\u805a\u5408</strong>\uff1a\n$$c_{ui} = f_{\\text{device}}({c_{ui}^{(d)} : d \\in \\text{devices}(u)})$$\n\u9700\u8981\u8bc6\u522b\u548c\u5408\u5e76\u8de8\u8bbe\u5907\u7684\u7528\u6237\u8eab\u4efd</p>\n</li>\n<li>\n<p><strong>\u4f1a\u8bdd\u5185\u884c\u4e3a\u5efa\u6a21</strong>\uff1a\n   \u77ed\u671f\u5174\u8da3\u4e0e\u957f\u671f\u504f\u597d\u7684\u5206\u79bb\uff1a\n$$\\mathbf{p}_u(t) = \\alpha \\mathbf{p}_u^{\\text{long}} + (1-\\alpha) \\mathbf{p}_u^{\\text{session}}(t)$$</p>\n</li>\n<li>\n<p><strong>\u4f4d\u7f6e\u504f\u5dee\u6821\u6b63</strong>\uff1a\n$$c_{ui} = c_{ui}^{\\text{raw}} \\cdot \\frac{1}{b_{\\text{position}}(k)}$$\n\u5176\u4e2d $k$ \u662f\u7269\u54c1\u5728\u5217\u8868\u4e2d\u7684\u4f4d\u7f6e</p>\n</li>\n</ol>\n<h3 id=\"1412\">14.1.2 \u7f6e\u4fe1\u5ea6\u77e9\u9635\u7684\u6784\u5efa\u539f\u7406</h3>\n<p>\u7f6e\u4fe1\u5ea6\u77e9\u9635 $\\mathbf{C}$ \u7684\u8bbe\u8ba1\u76f4\u63a5\u5f71\u54cd\u6a21\u578b\u8d28\u91cf\u3002\u7ecf\u5178\u7684Hu\u7b49\u4eba\u63d0\u51fa\u7684\u7ebf\u6027\u7f6e\u4fe1\u5ea6\u51fd\u6570\uff1a\n$$c_{ui} = 1 + \\alpha \\cdot r_{ui}$$\n\u5176\u4e2d $r_{ui}$ \u662f\u539f\u59cb\u4ea4\u4e92\u5f3a\u5ea6\uff08\u5982\u64ad\u653e\u6b21\u6570\uff09\u3002</p>\n<p><strong>\u7406\u8bba\u57fa\u7840</strong>\uff1a\u5c06\u7f6e\u4fe1\u5ea6\u89c6\u4e3a\u89c2\u6d4b\u566a\u58f0\u7684\u5012\u6570\n$$\\text{Var}[\\epsilon_{ui}] = \\frac{\\sigma^2}{c_{ui}}$$\n\u8fd9\u610f\u5473\u7740\u4ea4\u4e92\u6b21\u6570\u8d8a\u591a\uff0c\u89c2\u6d4b\u8d8a\u53ef\u9760\uff0c\u65b9\u5dee\u8d8a\u5c0f\u3002</p>\n<p><strong>\u4ece\u4fe1\u606f\u8bba\u89d2\u5ea6\u7406\u89e3\u7f6e\u4fe1\u5ea6</strong>\uff1a\n\u7f6e\u4fe1\u5ea6\u53ef\u4ee5\u89e3\u91ca\u4e3a\u6bcf\u6b21\u89c2\u5bdf\u63d0\u4f9b\u7684\u4fe1\u606f\u91cf\uff1a\n$$I(r_{ui}; r_{ui}^*) = \\frac{1}{2}\\log\\left(1 + \\frac{c_{ui}\\sigma_r^2}{\\sigma_\\epsilon^2}\\right)$$\n\u5176\u4e2d $r_{ui}^*$ \u662f\u771f\u5b9e\u504f\u597d\uff0c$\\sigma_r^2$ \u662f\u504f\u597d\u65b9\u5dee\uff0c$\\sigma_\\epsilon^2$ \u662f\u89c2\u6d4b\u566a\u58f0\u65b9\u5dee\u3002</p>\n<p><strong>\u9ad8\u7ea7\u7f6e\u4fe1\u5ea6\u8bbe\u8ba1\u8003\u8651\u56e0\u7d20</strong>\uff1a</p>\n<ol>\n<li><strong>\u65f6\u95f4\u8870\u51cf</strong>\uff1a\n$$c_{ui}(t) = c_{ui} \\cdot \\exp(-\\beta(t - t_{ui}))$$</li>\n</ol>\n<ul>\n<li>\u534a\u8870\u671f\u9009\u62e9\uff1a$t_{1/2} = \\frac{\\ln 2}{\\beta}$</li>\n<li>\u5178\u578b\u503c\uff1a\u65b0\u95fb\u7c7b $t_{1/2} = 1\\text{\u5929}$\uff0c\u7535\u5f71\u7c7b $t_{1/2} = 30\\text{\u5929}$</li>\n<li>\u81ea\u9002\u5e94\u8870\u51cf\u7387\uff1a$\\beta_i = \\beta_0 \\cdot (1 + \\text{entropy}({t_{ui}}_{u}))$</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u7528\u6237\u6d3b\u8dc3\u5ea6\u5f52\u4e00\u5316</strong>\uff1a\n$$\\tilde{c}_{ui} = \\frac{c_{ui}}{\\sqrt{\\sum_j c_{uj}}}$$</li>\n</ol>\n<ul>\n<li>\u9632\u6b62\u8d85\u7ea7\u6d3b\u8dc3\u7528\u6237\u4e3b\u5bfc\u6a21\u578b\u66f4\u65b0</li>\n<li>\u4fdd\u8bc1\u68af\u5ea6\u8d21\u732e\u7684\u516c\u5e73\u6027</li>\n<li>\u7406\u8bba\u4f9d\u636e\uff1a\u4fdd\u6301\u7528\u6237\u5bf9\u635f\u5931\u51fd\u6570\u7684\u8d21\u732e\u671f\u671b\u76f8\u7b49</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u7269\u54c1\u6d41\u884c\u5ea6\u60e9\u7f5a</strong>\uff1a\n$$\\hat{c}_{ui} = c_{ui} \\cdot \\left(\\frac{N}{\\text{count}(i)}\\right)^\\gamma$$</li>\n</ol>\n<ul>\n<li>\u964d\u4f4e\u70ed\u95e8\u7269\u54c1\u7684\u6743\u91cd\uff0c\u4fc3\u8fdb\u957f\u5c3e\u53d1\u73b0</li>\n<li>$\\gamma \\in [0, 0.5]$ \u63a7\u5236\u60e9\u7f5a\u5f3a\u5ea6</li>\n<li>\u52a8\u6001\u8c03\u6574\uff1a$\\gamma(t) = \\gamma_0 \\cdot (1 - \\text{coverage}(t))$</li>\n</ul>\n<p><strong>\u5b9e\u7528\u6027\u6269\u5c55</strong>\uff1a</p>\n<ol start=\"4\">\n<li><strong>\u4e0a\u4e0b\u6587\u611f\u77e5\u7f6e\u4fe1\u5ea6</strong>\uff1a\n$$c_{ui}(\\mathbf{x}) = c_{ui} \\cdot f_{\\theta}(\\mathbf{x}_{ui})$$\n\u5176\u4e2d $\\mathbf{x}_{ui}$ \u5305\u542b\uff1a</li>\n</ol>\n<ul>\n<li>\u8bbe\u5907\u7c7b\u578b\uff08\u79fb\u52a8\u7aef\u884c\u4e3a\u901a\u5e38\u566a\u58f0\u66f4\u5927\uff09</li>\n<li>\u65f6\u6bb5\uff08\u6df1\u591c\u6d4f\u89c8vs\u5de5\u4f5c\u65f6\u95f4\uff09</li>\n<li>\u5730\u7406\u4f4d\u7f6e\uff08\u672c\u5730\u5185\u5bb9vs\u5168\u7403\u5185\u5bb9\uff09</li>\n<li>\u7f51\u7edc\u72b6\u6001\uff08\u52a0\u8f7d\u901f\u5ea6\u5f71\u54cd\u5b8c\u6210\u7387\uff09</li>\n</ul>\n<ol start=\"5\">\n<li><strong>\u591a\u884c\u4e3a\u878d\u5408</strong>\uff1a\n$$c_{ui} = \\sum_{a \\in \\mathcal{A}} w_a \\cdot c_{ui}^{(a)}$$\n\u884c\u4e3a\u6743\u91cd\u7684\u5b66\u4e60\u65b9\u6cd5\uff1a</li>\n</ol>\n<ul>\n<li>\u57fa\u4e8eAUC\u7684\u6743\u91cd\u4f18\u5316\uff1a$w_a \\propto \\text{AUC}_a$</li>\n<li>\u4e92\u4fe1\u606f\u6700\u5927\u5316\uff1a$w_a \\propto I(a; \\text{purchase})$</li>\n<li>\u6ce8\u610f\u529b\u673a\u5236\uff1a$w_a = \\text{softmax}(\\mathbf{W}^T[\\mathbf{u}_a, \\mathbf{i}_a])$</li>\n</ul>\n<ol start=\"6\">\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7f6e\u4fe1\u5ea6\u5b66\u4e60</strong>\uff1a\n   \u4f7f\u7528\u5143\u5b66\u4e60\u4f18\u5316\u7f6e\u4fe1\u5ea6\u51fd\u6570\u53c2\u6570\uff1a\n$$\\alpha^* = \\arg\\min_\\alpha \\mathbb{E}_{\\mathcal{T} \\sim p(\\mathcal{T})}[\\mathcal{L}_{\\text{val}}(\\mathcal{T}, \\alpha)]$$\n<strong>MAML\u98ce\u683c\u7684\u7f6e\u4fe1\u5ea6\u5143\u5b66\u4e60</strong>\uff1a\n   ```\n   \u5bf9\u4e8e\u6bcf\u4e2a\u4efb\u52a1 T\uff08\u5982\u4e0d\u540c\u7c7b\u76ee\uff09\uff1a</p>\n</li>\n<li>\n<p>\u521d\u59cb\u5316\u7f6e\u4fe1\u5ea6\u53c2\u6570 \u03b1</p>\n</li>\n<li>\u5728T\u7684\u8bad\u7ec3\u96c6\u4e0a\u8fdb\u884ck\u6b65\u68af\u5ea6\u4e0b\u964d\u5f97\u5230 \u03b1'_T</li>\n<li>\u5728T\u7684\u9a8c\u8bc1\u96c6\u4e0a\u8bc4\u4f30 L(\u03b1'_T)</li>\n<li>\u66f4\u65b0\u5143\u53c2\u6570\uff1a\u03b1 \u2190 \u03b1 - \u03b7\u2207_\u03b1 \u03a3_T L(\u03b1'_T)\n   ```</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u7f6e\u4fe1\u5ea6\u5efa\u6a21\u6280\u672f</strong>\uff1a</p>\n<ol start=\"7\">\n<li>\n<p><strong>\u6982\u7387\u7f6e\u4fe1\u5ea6</strong>\uff1a\n   \u4f7f\u7528\u8d1d\u5854\u5206\u5e03\u5efa\u6a21\u4e0d\u786e\u5b9a\u6027\uff1a\n$$c_{ui} \\sim \\text{Beta}(\\alpha_{ui}, \\beta_{ui})$$\n\u5176\u4e2d $\\alpha_{ui} = 1 + n_{ui}^+$\uff08\u6b63\u4ea4\u4e92\u6b21\u6570\uff09\uff0c$\\beta_{ui} = 1 + n_{ui}^-$\uff08\u8d1f\u4ea4\u4e92\u6b21\u6570\uff09</p>\n</li>\n<li>\n<p><strong>\u795e\u7ecf\u7f6e\u4fe1\u5ea6\u7f51\u7edc</strong>\uff1a\n$$c_{ui} = \\text{NN}_\\phi([\\mathbf{u}_{\\text{feat}}, \\mathbf{i}_{\\text{feat}}, \\mathbf{x}_{ui}])$$\n\u7aef\u5230\u7aef\u5b66\u4e60\u590d\u6742\u7684\u7f6e\u4fe1\u5ea6\u6a21\u5f0f</p>\n</li>\n<li>\n<p><strong>\u56e0\u679c\u7f6e\u4fe1\u5ea6</strong>\uff1a\n   \u8003\u8651\u6df7\u6dc6\u56e0\u5b50\u7684\u5f71\u54cd\uff1a\n$$c_{ui} = \\frac{P(r_{ui}|do(expose_i))}{P(r_{ui}|expose_i)}$$\n\u901a\u8fc7\u56e0\u679c\u63a8\u65ad\u4f30\u8ba1\u771f\u5b9e\u7684\u5174\u8da3\u5f3a\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u7f6e\u4fe1\u5ea6\u7684\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u622a\u65ad\u5904\u7406</strong>\uff1a\n$$c_{ui} = \\min(\\max(c_{ui}, c_{\\min}), c_{\\max})$$\n\u5178\u578b\u503c\uff1a$c_{\\min} = 1$, $c_{\\max} = 1000$</p>\n</li>\n<li>\n<p><strong>\u5e73\u6ed1\u5904\u7406</strong>\uff1a\n$$c_{ui} = \\frac{c_{ui} + \\epsilon}{1 + \\epsilon}$$\n\u907f\u514d\u6781\u7aef\u503c\u5bfc\u81f4\u7684\u6570\u503c\u95ee\u9898</p>\n</li>\n<li>\n<p><strong>\u5bf9\u6570\u53d8\u6362</strong>\uff1a\n   \u5bf9\u4e8e\u91cd\u5c3e\u5206\u5e03\u7684\u4ea4\u4e92\u6b21\u6570\uff1a\n$$c_{ui} = 1 + \\alpha \\log(1 + r_{ui})$$</p>\n</li>\n</ol>\n<h3 id=\"1413\">14.1.3 \u52a0\u6743\u6b63\u5219\u5316\u7684\u6570\u5b66\u63a8\u5bfc</h3>\n<p>\u6807\u51c6L2\u6b63\u5219\u5316\u5047\u8bbe\u6240\u6709\u53c2\u6570\u540c\u7b49\u91cd\u8981\uff0c\u4f46\u5728\u9690\u5f0f\u53cd\u9988\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\uff1a</p>\n<ol>\n<li><strong>\u7528\u6237\u4fa7\u52a0\u6743\u6b63\u5219\u5316</strong>\uff1a\n$$R_u(\\mathbf{p}_u) = \\lambda_u |\\mathbf{p}_u|^2, \\quad \\lambda_u = \\lambda \\cdot n_u^{-\\beta}$$\n\u5176\u4e2d $n_u$ \u662f\u7528\u6237\u4ea4\u4e92\u6570\uff0c$\\beta \\in [0,1]$ \u63a7\u5236\u6b63\u5219\u5316\u5f3a\u5ea6\u7684\u8870\u51cf\u3002</li>\n</ol>\n<p><strong>\u63a8\u5bfc</strong>\uff1a\u4ece\u6700\u5927\u540e\u9a8c(MAP)\u4f30\u8ba1\u51fa\u53d1\n$$\\mathbf{p}_u^* = \\arg\\max_{\\mathbf{p}_u} p(\\mathbf{p}_u|\\mathcal{D}_u) = \\arg\\max_{\\mathbf{p}_u} p(\\mathcal{D}_u|\\mathbf{p}_u)p(\\mathbf{p}_u)$$\n\u7528\u6237\u6d3b\u8dc3\u5ea6\u8d8a\u9ad8\uff0c\u5148\u9a8c\u7684\u5f71\u54cd\u5e94\u8be5\u8d8a\u5c0f\uff1a\n$$p(\\mathbf{p}_u) = \\mathcal{N}(0, \\frac{\\sigma^2}{n_u^\\beta}\\mathbf{I})$$\n<strong>\u4fe1\u606f\u8bba\u89e3\u91ca</strong>\uff1a\n   \u7528\u6237\u4ea4\u4e92\u6570\u53ef\u89c6\u4e3a\u6709\u6548\u6837\u672c\u5927\u5c0f\uff0c\u6839\u636e\u6700\u5c0f\u63cf\u8ff0\u957f\u5ea6(MDL)\u539f\u7406\uff1a\n$$\\text{MDL} = -\\log p(\\mathcal{D}_u|\\mathbf{p}_u) + \\frac{k}{2}\\log n_u$$\n\u7b2c\u4e8c\u9879\u81ea\u7136\u5bfc\u51fa\u4e0e $n_u$ \u76f8\u5173\u7684\u6b63\u5219\u5316\u3002</p>\n<ol start=\"2\">\n<li><strong>\u7269\u54c1\u4fa7\u81ea\u9002\u5e94\u6b63\u5219\u5316</strong>\uff1a\n$$R_i(\\mathbf{q}_i) = \\lambda_i |\\mathbf{q}_i - \\mathbf{q}_i^{(0)}|^2$$\n\u5176\u4e2d $\\mathbf{q}_i^{(0)}$ \u662f\u57fa\u4e8e\u5185\u5bb9\u7684\u5148\u9a8c\u5d4c\u5165\u3002</li>\n</ol>\n<p><strong>\u5206\u5c42\u8d1d\u53f6\u65af\u89e3\u91ca</strong>\uff1a\n$$\\mathbf{q}_i \\sim \\mathcal{N}(\\mathbf{q}_i^{(0)}, \\sigma_i^2\\mathbf{I})$$\n   $$\\mathbf{q}_i^{(0)} = f_{\\text{content}}(\\mathbf{x}_i)$$\n<strong>\u5148\u9a8c\u5b66\u4e60</strong>\uff1a\n   \u4f7f\u7528\u53d8\u5206\u81ea\u7f16\u7801\u5668\u5b66\u4e60\u7269\u54c1\u5148\u9a8c\u5206\u5e03\uff1a\n$$q(\\mathbf{q}_i^{(0)}|\\mathbf{x}_i) = \\mathcal{N}(\\mu_\\phi(\\mathbf{x}_i), \\text{diag}(\\sigma^2_\\phi(\\mathbf{x}_i)))$$\n<strong>\u7406\u8bba\u4f9d\u636e</strong>\uff1a\u4ece\u8d1d\u53f6\u65af\u89d2\u5ea6\uff0c\u8fd9\u76f8\u5f53\u4e8e\u5bf9\u53c2\u6570\u65bd\u52a0\u4e0d\u540c\u65b9\u5dee\u7684\u9ad8\u65af\u5148\u9a8c\uff1a\n$$p(\\mathbf{p}_u) \\propto \\exp\\left(-\\frac{\\lambda_u}{2}|\\mathbf{p}_u|^2\\right)$$\n<strong>\u9ad8\u7ea7\u6b63\u5219\u5316\u6280\u672f</strong>\uff1a</p>\n<ol start=\"3\">\n<li><strong>\u7ed3\u6784\u5316\u7a00\u758f\u6b63\u5219\u5316</strong>\uff1a\n$$R(\\mathbf{p}_u) = \\lambda_1 |\\mathbf{p}_u|_1 + \\lambda_2 |\\mathbf{p}_u|_2^2 + \\lambda_3 \\sum_{g} |\\mathbf{p}_{u,g}|_2$$</li>\n</ol>\n<ul>\n<li>L1\u9879\uff1a\u5168\u5c40\u7a00\u758f\u6027</li>\n<li>L2\u9879\uff1a\u6570\u503c\u7a33\u5b9a\u6027</li>\n<li>\u7fa4\u7ec4\u8303\u6570\uff1a\u7ed3\u6784\u5316\u7a00\u758f\uff08\u5982\u4e3b\u9898\u76f8\u5173\u7684\u56e0\u5b50\u7ec4\uff09</li>\n</ul>\n<p><strong>\u8fd1\u7aef\u68af\u5ea6\u7b97\u6cd5\u6c42\u89e3</strong>\uff1a\n$$\\mathbf{p}_u^{(t+1)} = \\text{prox}_{\\lambda R}(\\mathbf{p}_u^{(t)} - \\eta \\nabla \\mathcal{L})$$\n\u5176\u4e2d\u8fd1\u7aef\u7b97\u5b50\u6709\u95ed\u5f0f\u89e3\u3002</p>\n<ol start=\"4\">\n<li>\n<p><strong>\u56fe\u6b63\u5219\u5316</strong>\uff1a\n   \u6784\u5efa\u7528\u6237-\u7528\u6237\u76f8\u4f3c\u56fe $\\mathcal{G}_u = (\\mathcal{V}_u, \\mathcal{E}_u, \\mathbf{W}_u)$\uff1a\n$$R_{\\text{graph}}(\\mathbf{P}) = \\frac{\\lambda_g}{2} \\sum_{(u,v) \\in \\mathcal{E}_u} w_{uv}|\\mathbf{p}_u - \\mathbf{p}_v|^2$$\n<strong>\u8c31\u5206\u6790</strong>\uff1a\n$$R_{\\text{graph}}(\\mathbf{P}) = \\lambda_g \\cdot \\text{tr}(\\mathbf{P}^T\\mathbf{L}_u\\mathbf{P})$$\n\u5176\u4e2d $\\mathbf{L}_u = \\mathbf{D}_u - \\mathbf{W}_u$ \u662f\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635\u3002</p>\n</li>\n<li>\n<p><strong>\u65f6\u53d8\u6b63\u5219\u5316</strong>\uff1a\n   \u8003\u8651\u7528\u6237\u5174\u8da3\u6f02\u79fb\uff1a\n$$R_t(\\mathbf{p}_u) = \\lambda_t |\\mathbf{p}_u^{(t)} - \\mathbf{p}_u^{(t-1)}|^2$$\n<strong>\u5361\u5c14\u66fc\u6ee4\u6ce2\u89c6\u89d2</strong>\uff1a\n   <code>\u72b6\u6001\u65b9\u7a0b\uff1ap_u(t) = p_u(t-1) + w_u(t), w_u ~ N(0, Q)\n   \u89c2\u6d4b\u65b9\u7a0b\uff1ar_ui(t) = p_u(t)^T q_i + v_ui(t), v_ui ~ N(0, R)</code></p>\n</li>\n<li>\n<p><strong>\u5bf9\u6297\u6b63\u5219\u5316</strong>\uff1a\n   \u63d0\u9ad8\u6a21\u578b\u9c81\u68d2\u6027\uff1a\n$$R_{\\text{adv}}(\\mathbf{P}, \\mathbf{Q}) = \\lambda_{\\text{adv}} \\max_{|\\delta|_2 \\leq \\epsilon} \\mathcal{L}(\\mathbf{P} + \\delta_P, \\mathbf{Q} + \\delta_Q)$$\n\u4f7f\u7528FGSM\u8fd1\u4f3c\uff1a\n$$\\delta_P = \\epsilon \\cdot \\text{sign}(\\nabla_P \\mathcal{L})$$\n<strong>\u6b63\u5219\u5316\u7684\u81ea\u9002\u5e94\u9009\u62e9</strong>\uff1a</p>\n</li>\n<li>\n<p><strong>\u7ecf\u9a8c\u8d1d\u53f6\u65af\u65b9\u6cd5</strong>\uff1a\n   \u901a\u8fc7\u6700\u5927\u5316\u8fb9\u9645\u4f3c\u7136\u81ea\u52a8\u786e\u5b9a\u6b63\u5219\u5316\u5f3a\u5ea6\uff1a\n$$\\lambda^* = \\arg\\max_\\lambda \\int p(\\mathcal{D}|\\mathbf{P}, \\mathbf{Q}) p(\\mathbf{P}, \\mathbf{Q}|\\lambda) d\\mathbf{P}d\\mathbf{Q}$$\n\u4f7f\u7528\u62c9\u666e\u62c9\u65af\u8fd1\u4f3c\uff1a\n$$\\log p(\\mathcal{D}|\\lambda) \\approx \\log p(\\mathcal{D}|\\hat{\\mathbf{P}}, \\hat{\\mathbf{Q}}) - \\frac{1}{2}\\log\\det(\\mathbf{H} + \\lambda\\mathbf{I})$$</p>\n</li>\n<li>\n<p><strong>\u591a\u4efb\u52a1\u5b66\u4e60\u6b63\u5219\u5316</strong>\uff1a\n   \u5f53\u6709\u591a\u4e2a\u76f8\u5173\u63a8\u8350\u4efb\u52a1\u65f6\uff1a\n$$R_{\\text{MTL}} = \\sum_{t=1}^T \\lambda_t |\\mathbf{P}^{(t)}|_F^2 + \\lambda_{\\text{share}}\\sum_{t \\neq s}|\\mathbf{P}^{(t)} - \\mathbf{P}^{(s)}|_F^2$$\n\u4fc3\u8fdb\u4efb\u52a1\u95f4\u7684\u77e5\u8bc6\u5171\u4eab\u3002</p>\n</li>\n</ol>\n<p><strong>\u6b63\u5219\u5316\u4e0e\u4f18\u5316\u7684\u4ea4\u4e92</strong>\uff1a</p>\n<ol start=\"9\">\n<li>\n<p><strong>\u9690\u5f0f\u6b63\u5219\u5316</strong>\uff1a\n   SGD\u672c\u8eab\u5177\u6709\u9690\u5f0f\u6b63\u5219\u5316\u6548\u679c\uff1a\n$$\\mathbf{p}_u^{(t+1)} = \\mathbf{p}_u^{(t)} - \\eta \\nabla_{\\mathcal{B}} \\mathcal{L}$$\n\u5176\u4e2d\u6279\u91cf\u5927\u5c0f $|\\mathcal{B}|$ \u548c\u5b66\u4e60\u7387 $\\eta$ \u7684\u6bd4\u503c $\\eta/|\\mathcal{B}|$ \u63a7\u5236\u9690\u5f0f\u6b63\u5219\u5316\u5f3a\u5ea6\u3002</p>\n</li>\n<li>\n<p><strong>\u6b63\u5219\u5316\u8def\u5f84\u7b97\u6cd5</strong>\uff1a\n    \u9ad8\u6548\u8ba1\u7b97\u4e0d\u540c $\\lambda$ \u4e0b\u7684\u89e3\uff1a\n$${\\mathbf{P}(\\lambda), \\mathbf{Q}(\\lambda)}_{\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]}$$\n\u5229\u7528\u89e3\u7684\u5206\u6bb5\u7ebf\u6027\u6027\u8d28\uff0c\u901a\u8fc7\u8ddf\u8e2a\u5173\u952e\u70b9\u9ad8\u6548\u6c42\u89e3\u3002</p>\n</li>\n</ol>\n<h3 id=\"1414\">14.1.4 \u7814\u7a76\u524d\u6cbf\uff1a\u56e0\u679c\u63a8\u65ad\u89c6\u89d2</h3>\n<p>\u6700\u65b0\u7814\u7a76\u5c06\u9690\u5f0f\u53cd\u9988\u5efa\u6a21\u4e3a\u5e26\u6709\u9009\u62e9\u504f\u5dee\u7684\u56e0\u679c\u63a8\u65ad\u95ee\u9898\uff1a</p>\n<ol>\n<li><strong>\u503e\u5411\u5206\u6570\u52a0\u6743</strong>\uff1a\n$$\\mathcal{L} = \\sum_{(u,i) \\in \\mathcal{D}} \\frac{1}{p(o_{ui}=1|u,i)} \\ell(r_{ui}, \\hat{r}_{ui})$$\n<strong>\u5173\u952e\u6311\u6218</strong>\uff1a</li>\n</ol>\n<ul>\n<li>\u503e\u5411\u5206\u6570 $p(o_{ui}=1|u,i)$ \u901a\u5e38\u672a\u77e5</li>\n<li>\u6781\u5c0f\u7684\u503e\u5411\u5206\u6570\u5bfc\u81f4\u65b9\u5dee\u7206\u70b8</li>\n<li>\u9700\u8981\u5e73\u8861\u504f\u5dee-\u65b9\u5dee\u6743\u8861</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u53cd\u4e8b\u5b9e\u98ce\u9669\u6700\u5c0f\u5316</strong>\uff1a\n$$\\mathcal{L}_{IPS} = \\frac{1}{|\\mathcal{D}|}\\sum_{(u,i) \\in \\mathcal{D}} \\frac{\\ell(r_{ui}, \\hat{r}_{ui})}{p(o_{ui}=1)} + \\lambda R(\\theta)$$\n<strong>\u7a33\u5b9a\u5316\u6280\u672f</strong>\uff1a</li>\n</ol>\n<ul>\n<li>\u622a\u65ad\u503e\u5411\u5206\u6570\uff1a$\\tilde{p} = \\max(p, \\epsilon)$</li>\n<li>\u81ea\u5f52\u4e00\u5316\u4f30\u8ba1\u5668\uff1a$\\hat{\\mathcal{L}}_{SNIPS} = \\frac{\\sum_{(u,i)} w_{ui}\\ell_{ui}}{\\sum_{(u,i)} w_{ui}}$</li>\n</ul>\n<ol start=\"3\">\n<li>\n<p><strong>\u53cc\u9c81\u68d2\u4f30\u8ba1</strong>\uff1a\n   \u7ed3\u5408\u76f4\u63a5\u65b9\u6cd5\u548c\u503e\u5411\u5206\u6570\u65b9\u6cd5\uff1a\n$$\\hat{r}_{DR} = \\hat{r}_{DM} + \\frac{o_{ui}}{p(o_{ui}=1)}(r_{ui} - \\hat{r}_{DM})$$\n\u5373\u4f7f\u503e\u5411\u5206\u6570\u6216\u76f4\u63a5\u6a21\u578b\u4e4b\u4e00\u6709\u8bef\u5dee\uff0c\u4ecd\u80fd\u4fdd\u6301\u4e00\u81f4\u6027</p>\n</li>\n<li>\n<p><strong>\u56e0\u679c\u5d4c\u5165</strong>\uff1a\n   \u5b66\u4e60\u6ee1\u8db3\u56e0\u679c\u7ea6\u675f\u7684\u8868\u793a\uff1a\n$$\\mathbf{p}_u \\perp!!!\\perp \\mathbf{e}_u | \\mathbf{z}_u$$\n\u5176\u4e2d $\\mathbf{e}_u$ \u662f\u6df7\u6dc6\u56e0\u5b50\uff0c$\\mathbf{z}_u$ \u662f\u56e0\u679c\u8868\u793a</p>\n</li>\n</ol>\n<p><strong>\u524d\u6cbf\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\n<p><strong>\u53bb\u6df7\u6dc6\u8868\u793a\u5b66\u4e60</strong>\uff1a\n$$\\min_{\\theta} \\mathcal{L}_{rec} + \\alpha \\cdot I(\\mathbf{Z}; \\mathbf{E})$$\n\u6700\u5c0f\u5316\u56e0\u679c\u8868\u793a\u4e0e\u6df7\u6dc6\u56e0\u5b50\u7684\u4e92\u4fe1\u606f</p>\n</li>\n<li>\n<p><strong>\u56e0\u679c\u6548\u5e94\u4f30\u8ba1</strong>\uff1a\n$$\\text{ATE} = \\mathbb{E}[Y(1) - Y(0)]$$\n\u4f30\u8ba1\u63a8\u8350\u67d0\u7269\u54c1\u7684\u5e73\u5747\u5904\u7406\u6548\u5e94</p>\n</li>\n<li>\n<p><strong>\u654f\u611f\u6027\u5206\u6790</strong>\uff1a\n  \u91cf\u5316\u672a\u89c2\u6d4b\u6df7\u6dc6\u7684\u5f71\u54cd\uff1a\n$$\\Gamma = \\max_{u,i,j} \\frac{p(o_{ui}=1|u,j)p(o_{uj}=1|u,i)}{p(o_{ui}=1|u,i)p(o_{uj}=1|u,j)}$$\n\u8fd9\u4e3a\u5904\u7406\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u504f\u5dee\u95ee\u9898\u5f00\u8f9f\u4e86\u65b0\u65b9\u5411\uff0c\u7279\u522b\u662f\u5728\u516c\u5e73\u6027\u548c\u53ef\u89e3\u91ca\u6027\u65e5\u76ca\u91cd\u8981\u7684\u80cc\u666f\u4e0b\u3002</p>\n</li>\n</ul>\n<h2 id=\"142-als-wr\">14.2 ALS-WR\u7b97\u6cd5\u7684\u5e76\u884c\u5316\u4e0e\u6570\u503c\u4f18\u5316</h2>\n<h3 id=\"1421\">14.2.1 \u4ea4\u66ff\u6700\u5c0f\u4e8c\u4e58\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p>ALS-WR (Alternating Least Squares with Weighted Regularization) \u7684\u6838\u5fc3\u662f\u4ea4\u66ff\u56fa\u5b9a\u4e00\u7ec4\u53c2\u6570\uff0c\u4f18\u5316\u53e6\u4e00\u7ec4\u3002\u5bf9\u4e8e\u7528\u6237 $u$\uff0c\u66f4\u65b0\u65b9\u7a0b\u4e3a\uff1a\n$$\\mathbf{p}_u = (\\mathbf{Q}^T\\mathbf{C}^u\\mathbf{Q} + \\lambda\\mathbf{I})^{-1}\\mathbf{Q}^T\\mathbf{C}^u\\mathbf{p}(u)$$\n\u5176\u4e2d $\\mathbf{C}^u$ \u662f\u7528\u6237 $u$ \u7684\u5bf9\u89d2\u7f6e\u4fe1\u5ea6\u77e9\u9635\u3002</p>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u89e3</strong>\uff1a</p>\n<ul>\n<li>\u6734\u7d20\u5b9e\u73b0\uff1a$O(n^2k + nk^2 + k^3)$ per user</li>\n<li>\u5229\u7528\u7a00\u758f\u6027\uff1a$O(n_u k^2 + k^3)$\uff0c\u5176\u4e2d $n_u \\ll n$</li>\n</ul>\n<p><strong>\u5173\u952e\u4f18\u5316</strong>\uff1a\u9884\u8ba1\u7b97 $\\mathbf{Q}^T\\mathbf{Q}$\uff0c\u590d\u6742\u5ea6\u964d\u81f3 $O(n_u k^2)$\u3002</p>\n<p><strong>\u8be6\u7ec6\u7b97\u6cd5\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u77e9\u9635\u5206\u89e3\u6280\u5de7</strong>\uff1a\n$$\\mathbf{Q}^T\\mathbf{C}^u\\mathbf{Q} = \\mathbf{Q}^T\\mathbf{Q} + \\mathbf{Q}^T(\\mathbf{C}^u - \\mathbf{I})\\mathbf{Q}$$\n\u7531\u4e8e $\\mathbf{C}^u - \\mathbf{I}$ \u53ea\u5728\u7528\u6237\u4ea4\u4e92\u7684\u7269\u54c1\u4e0a\u975e\u96f6\uff1a\n$$\\mathbf{Q}^T(\\mathbf{C}^u - \\mathbf{I})\\mathbf{Q} = \\sum_{i \\in \\mathcal{I}_u} (c_{ui} - 1)\\mathbf{q}_i\\mathbf{q}_i^T$$</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u6b65\u9aa4\u4f18\u5316</strong>\uff1a\n   ```\n   \u9884\u8ba1\u7b97\u9636\u6bb5 (\u4e00\u6b21\u6027)\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u8ba1\u7b97 G = Q^T Q: O(nk^2)</li>\n<li>\u5b58\u50a8\u9700\u6c42: O(k^2)</li>\n</ul>\n<p>\u7528\u6237\u66f4\u65b0\u9636\u6bb5 (\u6bcf\u4e2a\u7528\u6237)\uff1a</p>\n<ul>\n<li>\u6784\u5efa A_u = G + \u03bbI: O(k^2)</li>\n<li>\u7d2f\u52a0\u79e9-1\u66f4\u65b0: O(n_u k^2)</li>\n<li>Cholesky\u5206\u89e3: O(k^3)</li>\n<li>\u56de\u4ee3\u6c42\u89e3: O(k^2)</li>\n</ul>\n<p>\u603b\u590d\u6742\u5ea6: O(n_u k^2 + k^3)\n   ```</p>\n<ol start=\"3\">\n<li>\n<p><strong>\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u4f18\u5316</strong>\uff1a\n   - <strong>\u7f13\u5b58\u53cb\u597d\u7684\u77e9\u9635\u5b58\u50a8</strong>\uff1a\u7269\u54c1\u56e0\u5b50\u6309\u5217\u4e3b\u5e8f\u5b58\u50a8\n   - <strong>\u5206\u5757\u8ba1\u7b97</strong>\uff1a\u5c06 $\\mathbf{Q}$ \u5206\u5757\u4ee5\u9002\u5e94L3\u7f13\u5b58\n   - <strong>\u9884\u53d6\u7b56\u7565</strong>\uff1a\u5229\u7528\u7528\u6237\u8bbf\u95ee\u6a21\u5f0f\u9884\u53d6\u4e0b\u4e00\u6279\u7269\u54c1\u56e0\u5b50</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7cbe\u5ea6\u8003\u8651</strong>\uff1a\n   - \u4f7f\u7528Cholesky\u5206\u89e3\u4ee3\u66ff\u76f4\u63a5\u6c42\u9006\n   - \u6761\u4ef6\u6570\u76d1\u63a7\uff1a$\\kappa(\\mathbf{A}_u) &lt; 10^{10}$\n   - \u5fc5\u8981\u65f6\u589e\u52a0\u6b63\u5219\u5316\uff1a$\\lambda' = \\lambda + \\epsilon \\cdot \\text{trace}(\\mathbf{A}_u)/k$</p>\n</li>\n</ol>\n<h3 id=\"1422-als\">14.2.2 \u5206\u5e03\u5f0fALS\u7684\u901a\u4fe1\u6a21\u5f0f</h3>\n<p>\u5927\u89c4\u6a21\u90e8\u7f72\u9700\u8981\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u5206\u5e03\u5f0f\u7b56\u7565\uff1a</p>\n<ol>\n<li><strong>\u6570\u636e\u5e76\u884c\u6a21\u5f0f</strong>\uff1a\n   - \u7528\u6237\u5206\u7247\uff1a\u6bcf\u4e2a\u8282\u70b9\u8d1f\u8d23\u4e00\u90e8\u5206\u7528\u6237\n   - \u7269\u54c1\u56e0\u5b50\u5e7f\u64ad\uff1a$O(nk)$ \u901a\u4fe1\u91cf\n   - \u9002\u5408\u7528\u6237\u6570 $\\gg$ \u7269\u54c1\u6570\u7684\u573a\u666f</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u5b9e\u73b0</strong>\uff1a\n   ```\n   \u8282\u70b9 p \u8d1f\u8d23\u7528\u6237\u96c6 U_p\uff1a</p>\n<ol>\n<li>\u5e7f\u64ad\u63a5\u6536\u5168\u5c40 Q \u77e9\u9635</li>\n<li>\u5e76\u884c\u66f4\u65b0 P[U_p] </li>\n<li>\u8ba1\u7b97\u5c40\u90e8\u7269\u54c1\u68af\u5ea6 \u0394Q_p</li>\n<li>All-reduce \u805a\u5408 \u0394Q = \u03a3_p \u0394Q_p</li>\n<li>\u672c\u5730\u66f4\u65b0 Q \u77e9\u9635\n   ```</li>\n</ol>\n<p><strong>\u901a\u4fe1\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u73af\u5f62all-reduce\u51cf\u5c11\u5e26\u5bbd\u9700\u6c42</li>\n<li>\u68af\u5ea6\u538b\u7f29\uff1a\u53ea\u4f20\u8f93top-k\u68af\u5ea6\u5206\u91cf</li>\n<li>\u5f02\u6b65\u901a\u4fe1\u4e0e\u8ba1\u7b97\u91cd\u53e0</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u6a21\u578b\u5e76\u884c\u6a21\u5f0f</strong>\uff1a\n   - \u56e0\u5b50\u77e9\u9635\u5206\u5757\uff1a$\\mathbf{P} = [\\mathbf{P}_1, \\mathbf{P}_2, ..., \\mathbf{P}_p]$\n   - \u901a\u4fe1\u91cf\uff1a$O(mk/p)$ per iteration\n   - \u9002\u5408\u8d85\u5927\u89c4\u6a21\u56e0\u5b50\u7ef4\u5ea6</li>\n</ol>\n<p><strong>2D\u5206\u5757\u7b56\u7565</strong>\uff1a\n$$\\begin{bmatrix}\n   \\mathbf{P}_{11} &amp; \\mathbf{P}_{12} &amp; \\cdots \\\n   \\mathbf{P}_{21} &amp; \\mathbf{P}_{22} &amp; \\cdots \\\n   \\vdots &amp; \\vdots &amp; \\ddots\n   \\end{bmatrix}$$\n\u6bcf\u4e2a\u8282\u70b9 $(i,j)$ \u8d1f\u8d23 $\\mathbf{P}_{ij}$ \u548c $\\mathbf{Q}_{ij}$</p>\n<ol start=\"3\">\n<li>\n<p><strong>\u6df7\u5408\u5e76\u884c\u7b56\u7565</strong>\uff1a\n   ```\n   \u5c06\u7528\u6237\u5206\u6210 G \u7ec4\uff0c\u6bcf\u7ec4\u5185\u6267\u884c\uff1a</p>\n</li>\n<li>\n<p>\u672c\u5730\u66f4\u65b0\u7528\u6237\u56e0\u5b50</p>\n</li>\n<li>\u6536\u96c6\u5c40\u90e8\u7269\u54c1\u68af\u5ea6</li>\n<li>All-reduce \u805a\u5408\u68af\u5ea6</li>\n<li>\u66f4\u65b0\u7269\u54c1\u56e0\u5b50\n   ```</li>\n</ol>\n<p><strong>\u53c2\u6570\u670d\u52a1\u5668\u67b6\u6784</strong>\uff1a</p>\n<ul>\n<li>\u670d\u52a1\u5668\u8282\u70b9\uff1a\u5b58\u50a8\u548c\u66f4\u65b0\u7269\u54c1\u56e0\u5b50</li>\n<li>\u5de5\u4f5c\u8282\u70b9\uff1a\u8ba1\u7b97\u7528\u6237\u66f4\u65b0\u548c\u68af\u5ea6</li>\n<li>\u901a\u4fe1\u6a21\u5f0f\uff1aPull-Compute-Push</li>\n</ul>\n<p><strong>\u901a\u4fe1\u91cf\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>Pull\u9636\u6bb5\uff1a\u6bcf\u4e2aworker\u62c9\u53d6 $O(n_u k)$ \u6570\u636e</li>\n<li>Push\u9636\u6bb5\uff1a\u6bcf\u4e2aworker\u63a8\u9001 $O(n_u k)$ \u68af\u5ea6</li>\n<li>\u603b\u5e26\u5bbd\uff1a$O(Nnk/p)$\uff0c\u5176\u4e2d $N$ \u662f\u603b\u4ea4\u4e92\u6570</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a\n   - <strong>\u68c0\u67e5\u70b9</strong>\uff1a\u5468\u671f\u6027\u4fdd\u5b58\u56e0\u5b50\u77e9\u9635\u5feb\u7167\n   - <strong>\u590d\u5236</strong>\uff1a\u5173\u952e\u53c2\u6570\u591a\u526f\u672c\u5b58\u50a8\n   - <strong>\u5f02\u6b65\u5907\u4efd</strong>\uff1a\u4f7f\u7528\u9648\u65e7\u68af\u5ea6\u7ee7\u7eed\u8bad\u7ec3</li>\n</ol>\n<p><strong>\u4e00\u81f4\u6027\u4fdd\u8bc1</strong>\uff1a</p>\n<ul>\n<li>\u6700\u7ec8\u4e00\u81f4\u6027\uff1a\u5141\u8bb8\u77ed\u671f\u4e0d\u4e00\u81f4</li>\n<li>\u6709\u754c\u9648\u65e7\u6027\uff1a$\\tau$-iteration staleness</li>\n<li>\u6536\u655b\u6027\u8bc1\u660e\uff1a\u5728\u6709\u754c\u5ef6\u8fdf\u4e0b\u4ecd\u6536\u655b</li>\n</ul>\n<h3 id=\"1423\">14.2.3 \u6570\u503c\u7a33\u5b9a\u6027\u4e0e\u6536\u655b\u52a0\u901f\u6280\u5de7</h3>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u969c</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u63a7\u5236</strong>\uff1a\n$$\\kappa(\\mathbf{A}) = \\frac{\\lambda_{\\max}(\\mathbf{A})}{\\lambda_{\\min}(\\mathbf{A})} &lt; \\tau$$\n\u901a\u8fc7\u81ea\u9002\u5e94\u6b63\u5219\u5316\u4fdd\u8bc1\uff1a$\\lambda = \\max(\\lambda_0, \\epsilon \\cdot |\\mathbf{Q}^T\\mathbf{C}^u\\mathbf{Q}|_F)$</p>\n</li>\n<li>\n<p><strong>Cholesky\u5206\u89e3\u7684\u589e\u91cf\u66f4\u65b0</strong>\uff1a\n   \u5bf9\u4e8e\u7a00\u758f\u66f4\u65b0\uff0c\u4f7f\u7528 Sherman-Morrison \u516c\u5f0f\uff1a\n$$(\\mathbf{A} + \\mathbf{u}\\mathbf{v}^T)^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{u}\\mathbf{v}^T\\mathbf{A}^{-1}}{1 + \\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}}$$\n<strong>\u6536\u655b\u52a0\u901f\u6280\u672f</strong>\uff1a</p>\n</li>\n<li>\n<p><strong>\u52a8\u91cf\u65b9\u6cd5</strong>\uff1a\n$$\\mathbf{p}_u^{(t+1)} = \\mathbf{p}_u^{(t)} + \\alpha \\Delta\\mathbf{p}_u^{(t)} + \\beta(\\mathbf{p}_u^{(t)} - \\mathbf{p}_u^{(t-1)})$$</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u5b66\u4e60\u7387</strong>\uff1a\n   \u57fa\u4e8e\u5c40\u90e8Lipschitz\u5e38\u6570\u4f30\u8ba1\uff1a\n$$\\alpha_u = \\min\\left(1, \\frac{c}{|\\nabla_{\\mathbf{p}_u} \\mathcal{L}|}\\right)$$</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0\u534f\u8bae</strong>\uff1a\n   - Hogwild!\u98ce\u683c\u7684\u65e0\u9501\u66f4\u65b0\n   - \u5ef6\u8fdf\u8865\u507f\uff1a$\\mathbf{p}_u^{(t)} = \\mathbf{p}_u^{(t-\\tau)} + \\sum_{s=t-\\tau}^{t-1} \\Delta\\mathbf{p}_u^{(s)}$</p>\n</li>\n</ol>\n<h3 id=\"1424\">14.2.4 \u786c\u4ef6\u611f\u77e5\u4f18\u5316</h3>\n<p>\u73b0\u4ee3\u786c\u4ef6\u67b6\u6784\u9700\u8981\u7b97\u6cd5\u5c42\u9762\u7684\u9002\u914d\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7f13\u5b58\u4f18\u5316</strong>\uff1a\n   - \u5206\u5757\u77e9\u9635\u4e58\u6cd5\uff1a\u5757\u5927\u5c0f $b = \\sqrt{\\text{L3 cache} / (3 \\times \\text{sizeof}(float))}$\n   - \u5217\u4e3b\u5e8f\u5b58\u50a8\u7528\u4e8e\u7269\u54c1\u56e0\u5b50</p>\n</li>\n<li>\n<p><strong>SIMD\u5411\u91cf\u5316</strong>\uff1a\n   - \u5185\u79ef\u8ba1\u7b97\u4f7f\u7528 AVX-512\uff1a\u4e00\u6b21\u5904\u740616\u4e2afloat\n   - \u5bf9\u9f50\u5185\u5b58\u5206\u914d\uff1a<code>posix_memalign</code> \u786e\u4fdd64\u5b57\u8282\u5bf9\u9f50</p>\n</li>\n<li>\n<p><strong>GPU\u52a0\u901f\u8003\u8651</strong>\uff1a\n   - Warp\u7ea7\u522b\u7684\u8d1f\u8f7d\u5747\u8861\n   - \u4f7f\u7528 cuBLAS \u7684 <code>cublasXgemmBatched</code> \u6279\u91cf\u5c0f\u77e9\u9635\u8fd0\u7b97</p>\n</li>\n</ol>\n<h2 id=\"143\">14.3 \u8d1f\u91c7\u6837\u7684\u6570\u5b66\u539f\u7406\u4e0e\u504f\u5dee\u6821\u6b63</h2>\n<h3 id=\"1431\">14.3.1 \u91c7\u6837\u5206\u5e03\u7684\u7406\u8bba\u9009\u62e9</h3>\n<p>\u8d1f\u91c7\u6837\u662f\u9690\u5f0f\u53cd\u9988\u7cfb\u7edf\u7684\u6838\u5fc3\u6280\u672f\u3002\u7ed9\u5b9a\u6b63\u6837\u672c\u96c6 $\\mathcal{D}^+$\uff0c\u6211\u4eec\u9700\u8981\u4ece\u672a\u89c2\u5bdf\u5230\u7684 $(u,i)$ \u5bf9\u4e2d\u91c7\u6837\u8d1f\u4f8b\u3002</p>\n<p><strong>\u6d41\u884c\u7684\u91c7\u6837\u5206\u5e03</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5747\u5300\u91c7\u6837</strong>\uff1a\n$$P_{\\text{unif}}(i|u) = \\frac{1}{|\\mathcal{I} \\setminus \\mathcal{I}_u|}$$\n\u7b80\u5355\u4f46\u53ef\u80fd\u4f4e\u4f30\u6d41\u884c\u7269\u54c1\u7684\u8d1f\u9762\u4fe1\u53f7\u3002</p>\n</li>\n<li>\n<p><strong>\u6d41\u884c\u5ea6\u6bd4\u4f8b\u91c7\u6837</strong>\uff1a\n$$P_{\\text{pop}}(i|u) = \\frac{f_i^\\alpha}{\\sum_{j \\notin \\mathcal{I}_u} f_j^\\alpha}$$\n\u5176\u4e2d $f_i$ \u662f\u7269\u54c1\u9891\u7387\uff0c$\\alpha \\in [0,1]$ \u63a7\u5236\u504f\u659c\u7a0b\u5ea6\u3002</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u91c7\u6837</strong>\uff1a\n   \u57fa\u4e8e\u5f53\u524d\u6a21\u578b\u9884\u6d4b\uff1a\n$$P_{\\text{adapt}}(i|u) \\propto \\sigma(\\mathbf{p}_u^T\\mathbf{q}_i)$$\n\u7c7b\u4f3c\u4e8e\u91cd\u8981\u6027\u91c7\u6837\uff0c\u805a\u7126\u4e8e\"\u56f0\u96be\"\u8d1f\u4f8b\u3002</p>\n</li>\n</ol>\n<h3 id=\"1432\">14.3.2 \u91cd\u8981\u6027\u91c7\u6837\u4e0e\u65e0\u504f\u4f30\u8ba1</h3>\n<p>\u4f7f\u7528\u975e\u5747\u5300\u91c7\u6837\u65f6\uff0c\u9700\u8981\u6821\u6b63\u5f15\u5165\u7684\u504f\u5dee\uff1a</p>\n<p><strong>\u57fa\u7840\u91cd\u8981\u6027\u91c7\u6837</strong>\uff1a\n$$\\mathbb{E}_{i \\sim P}[\\frac{Q(i)}{P(i)} \\cdot \\ell(u,i)] = \\mathbb{E}_{i \\sim Q}[\\ell(u,i)]$$\n<strong>\u5728\u8d1f\u91c7\u6837\u4e2d\u7684\u5e94\u7528</strong>\uff1a\n$$\\mathcal{L}_{\\text{unbiased}} = \\sum_{(u,i) \\in \\mathcal{D}^+} \\ell^+(u,i) + \\sum_{j=1}^{K} \\frac{1}{P(i_j^-|u)} \\ell^-(u,i_j^-)$$\n\u5176\u4e2d $i_j^- \\sim P(\\cdot|u)$ \u662f\u91c7\u6837\u7684\u8d1f\u4f8b\u3002</p>\n<p><strong>\u65b9\u5dee\u51cf\u5c11\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u63a7\u5236\u53d8\u91cf\u6cd5</strong>\uff1a\n$$\\tilde{\\ell}(u,i) = \\ell(u,i) - c(\\ell(u,i) - \\mu)$$\n\u5176\u4e2d $\\mu = \\mathbb{E}[\\ell]$ \u53ef\u4ee5\u5728\u7ebf\u4f30\u8ba1\u3002</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u91c7\u6837</strong>\uff1a\n   \u5c06\u7269\u54c1\u6309\u6d41\u884c\u5ea6\u5206\u6876\uff0c\u6bcf\u6876\u72ec\u7acb\u91c7\u6837\uff1a\n$$\\mathcal{I} = \\bigcup_{b=1}^{B} \\mathcal{I}_b, \\quad K_b = K \\cdot \\frac{|\\mathcal{I}_b|}{|\\mathcal{I}|}$$</p>\n</li>\n</ol>\n<h3 id=\"1433\">14.3.3 \u81ea\u9002\u5e94\u91c7\u6837\u7b56\u7565</h3>\n<p><strong>\u52a8\u6001\u56f0\u96be\u5ea6\u611f\u77e5\u91c7\u6837</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u4e8e\u68af\u5ea6\u7684\u91cd\u8981\u6027</strong>\uff1a\n$$P(i|u) \\propto |\\nabla_{\\mathbf{q}_i} \\ell(u,i)|^2$$</p>\n</li>\n<li>\n<p><strong>\u4e0d\u786e\u5b9a\u6027\u91c7\u6837</strong>\uff1a\n   \u4f7f\u7528\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\uff1a\n$$P(i|u) \\propto \\text{Var}[\\mathbf{p}_u^T\\mathbf{q}_i]$$\n<strong>\u591a\u76ee\u6807\u91c7\u6837</strong>\uff1a\n\u540c\u65f6\u4f18\u5316\u591a\u4e2a\u76ee\u6807\uff08\u5982\u8986\u76d6\u5ea6\u3001\u591a\u6837\u6027\uff09\uff1a\n$$P(i|u) = \\sum_{k=1}^{K} w_k P_k(i|u)$$\n\u5176\u4e2d\u6743\u91cd $w_k$ \u53ef\u4ee5\u52a8\u6001\u8c03\u6574\u3002</p>\n</li>\n</ol>\n<h3 id=\"1434\">14.3.4 \u7406\u8bba\u5206\u6790\uff1a\u6536\u655b\u6027\u4e0e\u6837\u672c\u590d\u6742\u5ea6</h3>\n<p><strong>\u6536\u655b\u901f\u7387\u5206\u6790</strong>\uff1a\n\u5728\u9002\u5f53\u7684\u5047\u8bbe\u4e0b\uff0c\u4f7f\u7528 $K$ \u4e2a\u8d1f\u6837\u672c\u7684SGD\u6536\u655b\u901f\u7387\u4e3a\uff1a\n$$\\mathbb{E}[|\\mathbf{w}^{(t)} - \\mathbf{w}^*|^2] \\leq \\frac{C}{t} + \\frac{D}{K}$$\n\u5176\u4e2d\u7b2c\u4e8c\u9879\u53cd\u6620\u4e86\u8d1f\u91c7\u6837\u5f15\u5165\u7684\u504f\u5dee\u3002</p>\n<p><strong>\u6837\u672c\u590d\u6742\u5ea6\u754c</strong>\uff1a\n\u8fbe\u5230 $\\epsilon$-\u6700\u4f18\u89e3\u6240\u9700\u7684\u8d1f\u6837\u672c\u6570\uff1a\n$$K = O\\left(\\frac{n \\log n}{\\epsilon^2}\\right)$$\n\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u5b9e\u8df5\u4e2d $K=5-10$ \u901a\u5e38\u8db3\u591f\u3002</p>\n<h2 id=\"144\">14.4 \u7f6e\u4fe1\u5ea6\u52a0\u6743\u7684\u7406\u8bba\u57fa\u7840</h2>\n<h3 id=\"1441\">14.4.1 \u8d1d\u53f6\u65af\u89c6\u89d2\u4e0b\u7684\u7f6e\u4fe1\u5ea6\u5efa\u6a21</h3>\n<p>\u4ece\u8d1d\u53f6\u65af\u89d2\u5ea6\uff0c\u7f6e\u4fe1\u5ea6\u53cd\u6620\u4e86\u6211\u4eec\u5bf9\u89c2\u5bdf\u5230\u7684\u9690\u5f0f\u4fe1\u53f7\u7684\u4e0d\u786e\u5b9a\u6027\u3002</p>\n<p><strong>\u751f\u6210\u6a21\u578b</strong>\uff1a</p>\n<ol>\n<li>\u771f\u5b9e\u504f\u597d\uff1a$r_{ui}^* \\sim \\mathcal{N}(\\mathbf{p}_u^T\\mathbf{q}_i, \\sigma^2)$</li>\n<li>\u89c2\u5bdf\u8fc7\u7a0b\uff1a$r_{ui} = r_{ui}^* + \\epsilon_{ui}$</li>\n<li>\u7f6e\u4fe1\u5ea6\uff1a$c_{ui} = \\frac{1}{\\text{Var}[\\epsilon_{ui}]}$</li>\n</ol>\n<p><strong>\u540e\u9a8c\u63a8\u65ad</strong>\uff1a\n$$p(r_{ui}^*|r_{ui}) \\propto \\exp\\left(-\\frac{c_{ui}}{2}(r_{ui}^* - r_{ui})^2 - \\frac{1}{2\\sigma^2}(r_{ui}^* - \\mathbf{p}_u^T\\mathbf{q}_i)^2\\right)$$\n\u8fd9\u5bfc\u51fa\u4e86\u52a0\u6743\u6700\u5c0f\u4e8c\u4e58\u7684\u76ee\u6807\u51fd\u6570\u3002</p>\n<h3 id=\"1442\">14.4.2 \u65f6\u95f4\u8870\u51cf\u4e0e\u9891\u7387\u52a0\u6743</h3>\n<p><strong>\u65f6\u95f4\u52a8\u6001\u5efa\u6a21</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6307\u6570\u8870\u51cf\u6a21\u578b</strong>\uff1a\n$$c_{ui}(t) = c_{ui}^{(0)} \\exp(-\\lambda_t(t - t_{ui}))$$</p>\n</li>\n<li>\n<p><strong>\u5e42\u5f8b\u8870\u51cf</strong>\uff1a\n$$c_{ui}(t) = c_{ui}^{(0)} (1 + t - t_{ui})^{-\\alpha}$$\n<strong>\u9891\u7387\u7f6e\u4fe1\u5ea6</strong>\uff1a\n\u57fa\u4e8e\u89c2\u5bdf\u6b21\u6570\u7684\u7f6e\u4fe1\u5ea6\u4f30\u8ba1\uff1a\n$$c_{ui} = \\frac{n_{ui}}{n_{ui} + \\beta}$$\n\u8fd9\u662f\u8d1d\u5854-\u4e8c\u9879\u5f0f\u6a21\u578b\u7684\u540e\u9a8c\u5747\u503c\u3002</p>\n</li>\n</ol>\n<p><strong>\u8054\u5408\u5efa\u6a21</strong>\uff1a\n$$c_{ui}(t, n) = f_{\\text{time}}(t) \\cdot f_{\\text{freq}}(n) \\cdot f_{\\text{context}}(\\mathbf{x})$$</p>\n<h3 id=\"1443\">14.4.3 \u5728\u7ebf\u66f4\u65b0\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1</h3>\n<p><strong>\u589e\u91cf\u7f6e\u4fe1\u5ea6\u66f4\u65b0</strong>\uff1a\n\u65b0\u89c2\u5bdf\u5230\u8fbe\u65f6\uff1a\n$$c_{ui}^{(t+1)} = \\frac{c_{ui}^{(t)} \\cdot n_{ui}^{(t)} + \\Delta c_{ui}}{n_{ui}^{(t)} + 1}$$\n<strong>\u4e00\u81f4\u6027\u6761\u4ef6</strong>\uff1a</p>\n<ol>\n<li><strong>\u5355\u8c03\u6027</strong>\uff1a$c_{ui}^{(t+1)} \\geq c_{ui}^{(t)}$ \u5f53\u6709\u65b0\u6b63\u4ea4\u4e92</li>\n<li><strong>\u6709\u754c\u6027</strong>\uff1a$c_{ui}^{(t)} \\leq c_{\\max}$ \u9632\u6b62\u8fc7\u62df\u5408</li>\n<li><strong>\u6536\u655b\u6027</strong>\uff1a$\\lim_{t \\to \\infty} c_{ui}^{(t)} = c_{ui}^*$ \u5b58\u5728</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\n\u5728\u9002\u5f53\u7684\u6b63\u5219\u5316\u4e0b\uff0c\u5728\u7ebf\u66f4\u65b0\u7b97\u6cd5\u6ee1\u8db3\uff1a\n$$\\text{Regret}(T) = O(\\sqrt{T \\log n})$$</p>\n<h3 id=\"1444\">14.4.4 \u591a\u6e90\u7f6e\u4fe1\u5ea6\u878d\u5408</h3>\n<p>\u73b0\u4ee3\u7cfb\u7edf\u9700\u8981\u6574\u5408\u591a\u79cd\u4fe1\u53f7\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5c42\u6b21\u8d1d\u53f6\u65af\u6a21\u578b</strong>\uff1a\n$$c_{ui} \\sim \\text{Gamma}(\\alpha_s, \\beta_s), \\quad s \\in {\\text{click}, \\text{purchase}, ...}$$</p>\n</li>\n<li>\n<p><strong>\u6ce8\u610f\u529b\u673a\u5236\u878d\u5408</strong>\uff1a\n$$c_{ui} = \\sum_{s} a_s(\\mathbf{u}, \\mathbf{i}) \\cdot c_{ui}^{(s)}$$\n\u5176\u4e2d $a_s$ \u662f\u5b66\u4e60\u7684\u6ce8\u610f\u529b\u6743\u91cd\u3002</p>\n</li>\n<li>\n<p><strong>\u5143\u5b66\u4e60\u7f6e\u4fe1\u5ea6</strong>\uff1a\n   \u4f7f\u7528MAML\u6846\u67b6\u5b66\u4e60\u7f6e\u4fe1\u5ea6\u51fd\u6570\uff1a\n$$c_{ui} = f_\\phi(\\mathbf{x}_{ui}), \\quad \\phi^* = \\arg\\min_\\phi \\mathbb{E}_{\\mathcal{T}}[\\mathcal{L}_{\\mathcal{T}}(f_\\phi)]$$</p>\n</li>\n</ol>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u5927\u89c4\u6a21\u534f\u540c\u8fc7\u6ee4\u4e2d\u7684\u6838\u5fc3\u77e9\u9635\u6280\u672f\u3002\u4e3b\u8981\u8d21\u732e\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9690\u5f0f\u53cd\u9988\u7684\u6570\u5b66\u5efa\u6a21</strong>\uff1a\n   - \u7f6e\u4fe1\u5ea6\u52a0\u6743\u6846\u67b6\uff1a$\\min \\sum_{(u,i)} c_{ui}(p_{ui} - \\mathbf{p}_u^T\\mathbf{q}_i)^2$\n   - \u4ece\u663e\u5f0f\u8bc4\u5206\u5230\u9690\u5f0f\u53cd\u9988\u7684\u8303\u5f0f\u8f6c\u53d8\n   - \u591a\u6e90\u4fe1\u53f7\u7684\u7edf\u4e00\u5904\u7406\u6846\u67b6</p>\n</li>\n<li>\n<p><strong>ALS-WR\u7684\u5de5\u7a0b\u5316\u5b9e\u73b0</strong>\uff1a\n   - \u8ba1\u7b97\u590d\u6742\u5ea6\u4ece $O(mnk)$ \u964d\u81f3 $O((m+n)n_z k^2)$\n   - \u5206\u5e03\u5f0f\u5e76\u884c\u7684\u4e09\u79cd\u6a21\u5f0f\u53ca\u5176\u6743\u8861\n   - \u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u969c\u4e0e\u6536\u655b\u52a0\u901f</p>\n</li>\n<li>\n<p><strong>\u8d1f\u91c7\u6837\u7684\u7406\u8bba\u57fa\u7840</strong>\uff1a\n   - \u91cd\u8981\u6027\u91c7\u6837\u5b9e\u73b0\u65e0\u504f\u4f30\u8ba1\n   - \u6837\u672c\u590d\u6742\u5ea6\u754c\uff1a$K = O(\\frac{n \\log n}{\\epsilon^2})$\n   - \u81ea\u9002\u5e94\u91c7\u6837\u7b56\u7565\u7684\u8bbe\u8ba1\u539f\u5219</p>\n</li>\n<li>\n<p><strong>\u7f6e\u4fe1\u5ea6\u7684\u8d1d\u53f6\u65af\u89e3\u91ca</strong>\uff1a\n   - \u4e0d\u786e\u5b9a\u6027\u91cf\u5316\u7684\u539f\u5219\u6027\u65b9\u6cd5\n   - \u65f6\u95f4\u52a8\u6001\u4e0e\u591a\u6e90\u878d\u5408\n   - \u5728\u7ebf\u5b66\u4e60\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u6d1e\u5bdf</strong>\uff1a</p>\n<ul>\n<li>\u9690\u5f0f\u53cd\u9988\u7684\u6838\u5fc3\u6311\u6218\u662f<strong>\u7f3a\u5931\u5e76\u975e\u968f\u673a</strong>\uff08MNAR\uff09</li>\n<li>\u7f6e\u4fe1\u5ea6\u52a0\u6743\u63d0\u4f9b\u4e86\u5904\u7406\u4e0d\u786e\u5b9a\u6027\u7684\u7edf\u4e00\u6846\u67b6</li>\n<li>\u8d1f\u91c7\u6837\u6548\u7387\u51b3\u5b9a\u4e86\u7b97\u6cd5\u7684\u53ef\u6269\u5c55\u6027</li>\n<li>\u786c\u4ef6\u611f\u77e5\u7684\u4f18\u5316\u5bf9\u6027\u80fd\u81f3\u5173\u91cd\u8981</li>\n</ul>\n<p><strong>\u672a\u6765\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\u56e0\u679c\u63a8\u65ad\u65b9\u6cd5\u5904\u7406\u9009\u62e9\u504f\u5dee</li>\n<li>\u795e\u7ecf\u7f51\u7edc\u4e0e\u77e9\u9635\u5206\u89e3\u7684\u6df1\u5ea6\u878d\u5408</li>\n<li>\u8054\u90a6\u5b66\u4e60\u573a\u666f\u4e0b\u7684\u9690\u79c1\u4fdd\u62a4\u77e9\u9635\u5206\u89e3</li>\n<li>\u91cf\u5b50\u7b97\u6cd5\u52a0\u901f\u8d85\u5927\u89c4\u6a21\u77e9\u9635\u8fd0\u7b97</li>\n</ol>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"141_1\">\u7ec3\u4e60 14.1\uff1a\u7f6e\u4fe1\u5ea6\u51fd\u6570\u8bbe\u8ba1</h3>\n<p>\u8003\u8651\u4e00\u4e2a\u89c6\u9891\u63a8\u8350\u7cfb\u7edf\uff0c\u7528\u6237\u884c\u4e3a\u5305\u62ec\uff1a\u70b9\u51fb\uff08click\uff09\u3001\u89c2\u770b\u65f6\u957f\uff08watch_time\uff09\u3001\u70b9\u8d5e\uff08like\uff09\u3001\u5206\u4eab\uff08share\uff09\u3002\u8bbe\u8ba1\u4e00\u4e2a\u7efc\u5408\u7f6e\u4fe1\u5ea6\u51fd\u6570 $c_{ui}$\uff0c\u6ee1\u8db3\u4ee5\u4e0b\u8981\u6c42\uff1a</p>\n<ol>\n<li>\u4e0d\u540c\u884c\u4e3a\u7c7b\u578b\u6709\u4e0d\u540c\u6743\u91cd</li>\n<li>\u8003\u8651\u65f6\u95f4\u8870\u51cf</li>\n<li>\u9632\u6b62\u6781\u7aef\u503c</li>\n</ol>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u4f7f\u7528\u5bf9\u6570\u53d8\u6362\u5904\u7406\u957f\u5c3e\u5206\u5e03\u7684\u89c2\u770b\u65f6\u957f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4e00\u4e2a\u53ef\u80fd\u7684\u8bbe\u8ba1\uff1a\n$$c_{ui} = 1 + \\alpha_1 \\cdot \\mathbb{1}[\\text{click}] + \\alpha_2 \\cdot \\log(1 + \\text{watch_time}) + \\alpha_3 \\cdot \\mathbb{1}[\\text{like}] + \\alpha_4 \\cdot \\mathbb{1}[\\text{share}]$$\n\u52a0\u5165\u65f6\u95f4\u8870\u51cf\uff1a\n$$c_{ui}(t) = c_{ui} \\cdot \\exp(-\\lambda(t - t_{ui}))$$\n\u9632\u6b62\u6781\u7aef\u503c\uff1a\n$$\\tilde{c}_{ui} = \\min(c_{ui}, c_{\\max}) \\cdot \\frac{c_{ui}}{c_{ui} + \\beta}$$\n\u5176\u4e2d\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7\u4ea4\u53c9\u9a8c\u8bc1\u786e\u5b9a\uff0c\u5178\u578b\u503c\uff1a$\\alpha_1 = 1, \\alpha_2 = 0.5, \\alpha_3 = 3, \\alpha_4 = 5, \\lambda = 0.01, \\beta = 10, c_{\\max} = 100$\u3002</p>\n</details>\n<h3 id=\"142als\">\u7ec3\u4e60 14.2\uff1aALS\u66f4\u65b0\u7684\u5411\u91cf\u5316\u5b9e\u73b0</h3>\n<p>\u7ed9\u5b9a\u7528\u6237 $u$ \u7684\u4ea4\u4e92\u7269\u54c1\u96c6\u5408 $\\mathcal{I}_u = {i_1, i_2, ..., i_{n_u}}$ \u548c\u5bf9\u5e94\u7f6e\u4fe1\u5ea6 ${c_{ui_1}, c_{ui_2}, ..., c_{ui_{n_u}}}$\uff0c\u63a8\u5bfc\u5411\u91cf\u5316\u7684\u7528\u6237\u56e0\u5b50\u66f4\u65b0\u516c\u5f0f\uff0c\u907f\u514d\u663e\u5f0f\u6784\u9020\u5bf9\u89d2\u77e9\u9635 $\\mathbf{C}^u$\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u5229\u7528 $\\mathbf{Q}^T\\mathbf{C}^u\\mathbf{Q} = \\sum_{i \\in \\mathcal{I}_u} c_{ui}\\mathbf{q}_i\\mathbf{q}_i^T + \\mathbf{Q}^T\\mathbf{Q}$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5411\u91cf\u5316\u66f4\u65b0\u516c\u5f0f\uff1a\n$$\\mathbf{A}_u = \\mathbf{Q}^T\\mathbf{Q} + \\sum_{i \\in \\mathcal{I}_u} (c_{ui} - 1)\\mathbf{q}_i\\mathbf{q}_i^T + \\lambda\\mathbf{I}$$</p>\n<p>$$\\mathbf{b}_u = \\sum_{i \\in \\mathcal{I}_u} c_{ui} p_{ui} \\mathbf{q}_i$$</p>\n<p>$$\\mathbf{p}_u = \\mathbf{A}_u^{-1}\\mathbf{b}_u$$\n\u8ba1\u7b97\u6280\u5de7\uff1a</p>\n<ol>\n<li>\u9884\u8ba1\u7b97 $\\mathbf{Q}^T\\mathbf{Q}$ \u4e00\u6b21\uff0c\u6240\u6709\u7528\u6237\u5171\u4eab</li>\n<li>\u4f7f\u7528 BLAS \u7684 <code>syr</code> \u64cd\u4f5c\u9ad8\u6548\u8ba1\u7b97\u79e9-1\u66f4\u65b0</li>\n<li>\u5bf9\u4e8e\u7a00\u758f $\\mathcal{I}_u$\uff0c\u590d\u6742\u5ea6\u4e3a $O(|\\mathcal{I}_u|k^2 + k^3)$</li>\n</ol>\n</details>\n<h3 id=\"143_1\">\u7ec3\u4e60 14.3\uff1a\u8d1f\u91c7\u6837\u7684\u65b9\u5dee\u5206\u6790</h3>\n<p>\u8bc1\u660e\uff1a\u4f7f\u7528\u6d41\u884c\u5ea6\u6bd4\u4f8b\u91c7\u6837 $P(i) \\propto f_i^{0.75}$ \u76f8\u6bd4\u5747\u5300\u91c7\u6837\uff0c\u5728\u4f30\u8ba1\u5168\u5c40\u635f\u5931\u65f6\u5177\u6709\u66f4\u4f4e\u7684\u65b9\u5dee\u3002\u5047\u8bbe\u635f\u5931\u51fd\u6570\u4e3a $\\ell(u,i) = (\\mathbf{p}_u^T\\mathbf{q}_i)^2$\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8ba1\u7b97\u4e24\u79cd\u91c7\u6837\u7b56\u7565\u4e0b\u4f30\u8ba1\u91cf\u7684\u65b9\u5dee\uff0c\u5e76\u6bd4\u8f83\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe\u771f\u5b9e\u635f\u5931\u4e3a $L = \\sum_{i \\notin \\mathcal{I}_u} \\ell(u,i)$\u3002</p>\n<p>\u5747\u5300\u91c7\u6837\u4f30\u8ba1\u91cf\uff1a\n$$\\hat{L}_{\\text{unif}} = \\frac{|\\mathcal{I} \\setminus \\mathcal{I}_u|}{K} \\sum_{j=1}^K \\ell(u,i_j)$$\n\u5176\u65b9\u5dee\uff1a\n$$\\text{Var}[\\hat{L}_{\\text{unif}}] = \\frac{|\\mathcal{I} \\setminus \\mathcal{I}_u|^2}{K} \\text{Var}_{i \\sim \\text{Unif}}[\\ell(u,i)]$$\n\u6d41\u884c\u5ea6\u91c7\u6837\u4f30\u8ba1\u91cf\uff1a\n$$\\hat{L}_{\\text{pop}} = \\sum_{j=1}^K \\frac{\\ell(u,i_j)}{P(i_j)}$$\n\u5176\u65b9\u5dee\uff1a\n$$\\text{Var}[\\hat{L}_{\\text{pop}}] = \\frac{1}{K} \\sum_{i \\notin \\mathcal{I}_u} \\frac{\\ell(u,i)^2}{P(i)} - \\frac{L^2}{K}$$\n\u5f53 $\\ell(u,i)$ \u4e0e $f_i$ \u6b63\u76f8\u5173\u65f6\uff08\u6d41\u884c\u7269\u54c1\u5f97\u5206\u66f4\u9ad8\uff09\uff0c\u9009\u62e9 $P(i) \\propto f_i^{0.75}$ \u4f7f\u5f97 $\\ell(u,i)/P(i)$ \u66f4\u5747\u5300\uff0c\u4ece\u800c\u964d\u4f4e\u65b9\u5dee\u3002</p>\n</details>\n<h3 id=\"144als\">\u7ec3\u4e60 14.4\uff1a\u5206\u5e03\u5f0fALS\u7684\u901a\u4fe1\u4f18\u5316</h3>\n<p>\u5728\u5206\u5e03\u5f0fALS\u4e2d\uff0c\u5047\u8bbe\u6709 $p$ \u4e2a\u8ba1\u7b97\u8282\u70b9\uff0c$m$ \u4e2a\u7528\u6237\uff0c$n$ \u4e2a\u7269\u54c1\uff0c\u56e0\u5b50\u7ef4\u5ea6 $k$\u3002\u5206\u6790\u4ee5\u4e0b\u4e09\u79cd\u6570\u636e\u5206\u7247\u7b56\u7565\u7684\u901a\u4fe1\u590d\u6742\u5ea6\uff1a</p>\n<ol>\n<li>\u968f\u673a\u5206\u7247</li>\n<li>\u57fa\u4e8e\u56fe\u5206\u5272\u7684\u5206\u7247</li>\n<li>\u5757\u5faa\u73af\u5206\u7247</li>\n</ol>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u6bcf\u8f6e\u8fed\u4ee3\u9700\u8981\u4f20\u8f93\u7684\u56e0\u5b50\u77e9\u9635\u5927\u5c0f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<ol>\n<li>\n<p><strong>\u968f\u673a\u5206\u7247</strong>\uff1a\n   - \u6bcf\u4e2a\u8282\u70b9\u9700\u8981\u51e0\u4e4e\u6240\u6709\u7269\u54c1\u56e0\u5b50\n   - \u901a\u4fe1\u91cf\uff1a$O(pnk)$ per iteration</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u56fe\u5206\u5272</strong>\uff1a\n   - \u6700\u5c0f\u5316\u8de8\u5206\u533a\u8fb9\n   - \u8bbe\u8fb9\u5272\u6bd4\u4f8b\u4e3a $\\rho$\n   - \u901a\u4fe1\u91cf\uff1a$O(\\rho nk)$\uff0c\u5176\u4e2d $\\rho &lt; 1$</p>\n</li>\n<li>\n<p><strong>\u5757\u5faa\u73af\u5206\u7247</strong>\uff1a\n   - \u7528\u6237\u548c\u7269\u54c1\u90fd\u5206\u5757\n   - \u6bcf\u4e2a\u8282\u70b9\u8d1f\u8d23 $\\frac{m}{p} \\times \\frac{n}{p}$ \u7684\u5757\n   - \u901a\u4fe1\u91cf\uff1a$O(\\frac{(m+n)k}{\\sqrt{p}})$</p>\n</li>\n</ol>\n<p>\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u5927\u89c4\u6a21\u7cfb\u7edf\uff0c\u5757\u5faa\u73af\u5206\u7247\u5728 $p$ \u8f83\u5927\u65f6\u6700\u4f18\u3002</p>\n</details>\n<h3 id=\"145\">\u7ec3\u4e60 14.5\uff1a\u589e\u91cf\u66f4\u65b0\u7684\u8bef\u5dee\u7d2f\u79ef\uff08\u6311\u6218\u9898\uff09</h3>\n<p>\u5728\u6d41\u5f0f\u573a\u666f\u4e2d\uff0c\u4f7f\u7528\u589e\u91cfSherman-Morrison\u66f4\u65b0\u4ee3\u66ff\u5b8c\u5168\u91cd\u7b97\u3002\u5206\u6790\u7ecf\u8fc7 $T$ \u6b21\u66f4\u65b0\u540e\u7684\u6570\u503c\u8bef\u5dee\u7d2f\u79ef\uff0c\u5e76\u63d0\u51fa\u8bef\u5dee\u63a7\u5236\u7b56\u7565\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u6d6e\u70b9\u8fd0\u7b97\u7684\u820d\u5165\u8bef\u5dee\u548c\u6761\u4ef6\u6570\u7684\u5f71\u54cd\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Sherman-Morrison\u66f4\u65b0\uff1a\n$$\\mathbf{A}^{-1}_{t+1} = \\mathbf{A}^{-1}_t - \\frac{\\mathbf{A}^{-1}_t \\mathbf{u}\\mathbf{v}^T \\mathbf{A}^{-1}_t}{1 + \\mathbf{v}^T \\mathbf{A}^{-1}_t \\mathbf{u}}$$\n\u8bef\u5dee\u5206\u6790\uff1a</p>\n<ul>\n<li>\u6bcf\u6b65\u76f8\u5bf9\u8bef\u5dee\uff1a$\\epsilon_{\\text{rel}} \\approx \\kappa(\\mathbf{A}) \\cdot \\epsilon_{\\text{machine}}$</li>\n<li>$T$ \u6b65\u540e\uff1a$\\epsilon_T \\approx T \\cdot \\kappa(\\mathbf{A}) \\cdot \\epsilon_{\\text{machine}}$</li>\n</ul>\n<p>\u8bef\u5dee\u63a7\u5236\u7b56\u7565\uff1a</p>\n<ol>\n<li><strong>\u5468\u671f\u6027\u91cd\u7b97</strong>\uff1a\u6bcf $T_0 = \\frac{1}{\\kappa(\\mathbf{A}) \\cdot \\epsilon_{\\text{machine}}}$ \u6b65\u5b8c\u5168\u91cd\u7b97</li>\n<li><strong>\u6761\u4ef6\u6570\u76d1\u63a7</strong>\uff1a\u5f53 $\\kappa(\\mathbf{A}_t) &gt; \\tau$ \u65f6\u89e6\u53d1\u91cd\u7b97</li>\n<li><strong>\u6b8b\u5dee\u68c0\u9a8c</strong>\uff1a\u68c0\u67e5 $|\\mathbf{A}_t \\mathbf{A}_t^{-1} - \\mathbf{I}|_F &lt; \\delta$</li>\n</ol>\n</details>\n<h3 id=\"146\">\u7ec3\u4e60 14.6\uff1a\u591a\u76ee\u6807\u4f18\u5316\u7684\u5e15\u7d2f\u6258\u524d\u6cbf\uff08\u6311\u6218\u9898\uff09</h3>\n<p>\u63a8\u8350\u7cfb\u7edf\u9700\u8981\u540c\u65f6\u4f18\u5316\u51c6\u786e\u6027\uff08RMSE\uff09\u3001\u8986\u76d6\u5ea6\uff08Coverage\uff09\u548c\u591a\u6837\u6027\uff08Diversity\uff09\u3002\u8bbe\u8ba1\u4e00\u4e2a\u591a\u76ee\u6807\u77e9\u9635\u5206\u89e3\u6846\u67b6\uff0c\u5e76\u5206\u6790\u5e15\u7d2f\u6258\u6700\u4f18\u89e3\u7684\u6027\u8d28\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u52a0\u6743\u548c\u65b9\u6cd5\u548c\u7ea6\u675f\u4f18\u5316\u65b9\u6cd5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u591a\u76ee\u6807\u4f18\u5316\u6846\u67b6\uff1a\n$$\\min_{\\mathbf{P},\\mathbf{Q}} \\alpha_1 \\cdot \\text{RMSE} + \\alpha_2 \\cdot (1-\\text{Coverage}) + \\alpha_3 \\cdot (1-\\text{Diversity})$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\text{RMSE} = \\sqrt{\\frac{1}{|\\mathcal{D}|}\\sum_{(u,i) \\in \\mathcal{D}} (r_{ui} - \\mathbf{p}_u^T\\mathbf{q}_i)^2}$</li>\n<li>$\\text{Coverage} = \\frac{|{i: \\exists u, \\mathbf{p}_u^T\\mathbf{q}_i &gt; \\theta}|}{n}$</li>\n<li>$\\text{Diversity} = 1 - \\frac{1}{|\\mathcal{U}|}\\sum_u \\frac{\\sum_{i,j \\in \\text{Top-K}(u)} \\text{sim}(i,j)}{K(K-1)}$</li>\n</ul>\n<p>\u5e15\u7d2f\u6258\u524d\u6cbf\u7279\u6027\uff1a</p>\n<ol>\n<li>\u51f8\u6027\uff1a\u5728\u6e29\u548c\u5047\u8bbe\u4e0b\uff0c\u5e15\u7d2f\u6258\u524d\u6cbf\u5c40\u90e8\u51f8</li>\n<li>\u6743\u8861\u5173\u7cfb\uff1a$\\frac{\\partial \\text{Coverage}}{\\partial \\text{RMSE}} &lt; 0$</li>\n<li>\u951a\u70b9\u89e3\uff1a\u7eaf\u51c6\u786e\u6027\u4f18\u5316 vs \u7eaf\u591a\u6837\u6027\u4f18\u5316</li>\n</ol>\n<p>\u5b9e\u8df5\u5efa\u8bae\uff1a\u4f7f\u7528\u8fdb\u5316\u7b97\u6cd5\uff08\u5982NSGA-II\uff09\u63a2\u7d22\u5e15\u7d2f\u6258\u524d\u6cbf\u3002</p>\n</details>\n<h3 id=\"147\">\u7ec3\u4e60 14.7\uff1a\u8054\u90a6\u5b66\u4e60\u4e2d\u7684\u9690\u79c1\u4fdd\u62a4\u77e9\u9635\u5206\u89e3\uff08\u5f00\u653e\u9898\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u6ee1\u8db3\u5dee\u5206\u9690\u79c1\u7684\u5206\u5e03\u5f0f\u77e9\u9635\u5206\u89e3\u7b97\u6cd5\uff0c\u5176\u4e2d\u7528\u6237\u6570\u636e\u4e0d\u80fd\u79bb\u5f00\u672c\u5730\u8bbe\u5907\u3002\u5206\u6790\u9690\u79c1-\u6548\u7528\u6743\u8861\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u68af\u5ea6\u6270\u52a8\u548c\u5b89\u5168\u805a\u5408\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\n<p><strong>\u672c\u5730\u66f4\u65b0</strong>\uff1a\u7528\u6237 $u$ \u5728\u8bbe\u5907\u4e0a\u8ba1\u7b97\uff1a\n$$\\mathbf{p}_u^{(t+1)} = \\mathbf{p}_u^{(t)} - \\eta \\nabla_{\\mathbf{p}_u} \\mathcal{L}_u$$</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u6270\u52a8</strong>\uff1a\u6dfb\u52a0\u9ad8\u65af\u566a\u58f0\u5b9e\u73b0 $(\\epsilon, \\delta)$-\u5dee\u5206\u9690\u79c1\uff1a\n$$\\tilde{\\nabla} = \\nabla + \\mathcal{N}(0, \\sigma^2 \\mathbf{I})$$\n\u5176\u4e2d $\\sigma = \\frac{2\\Delta_f \\sqrt{2\\log(1.25/\\delta)}}{\\epsilon}$</p>\n</li>\n<li>\n<p><strong>\u5b89\u5168\u805a\u5408</strong>\uff1a\n   \u4f7f\u7528\u79d8\u5bc6\u5206\u4eab\u6216\u540c\u6001\u52a0\u5bc6\u805a\u5408\u7269\u54c1\u68af\u5ea6\uff1a\n$$\\nabla_{\\mathbf{q}_i} = \\sum_{u \\in \\mathcal{U}_i} \\tilde{\\nabla}_{u,i}$$\n\u9690\u79c1-\u6548\u7528\u5206\u6790\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u9690\u79c1\u635f\u5931\uff1a$\\epsilon_{\\text{total}} = \\sqrt{2T\\log(1/\\delta)} \\cdot \\epsilon$</li>\n<li>\u6548\u7528\u635f\u5931\uff1a$\\text{RMSE}_{\\text{private}} - \\text{RMSE}_{\\text{non-private}} \\approx O(\\frac{k\\sqrt{T}}{\\epsilon n})$</li>\n</ul>\n<p>\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ol>\n<li>\u81ea\u9002\u5e94\u9690\u79c1\u9884\u7b97\u5206\u914d</li>\n<li>\u4e2a\u6027\u5316\u9690\u79c1\u7ea7\u522b</li>\n<li>\u4e0e\u540c\u6001\u52a0\u5bc6\u7ed3\u5408\u51cf\u5c11\u566a\u58f0</li>\n</ol>\n</details>\n<h3 id=\"148\">\u7ec3\u4e60 14.8\uff1a\u56e0\u679c\u63a8\u65ad\u89c6\u89d2\u7684\u53bb\u504f\uff08\u7814\u7a76\u9898\uff09</h3>\n<p>\u5c06\u63a8\u8350\u7cfb\u7edf\u7684\u9009\u62e9\u504f\u5dee\u5efa\u6a21\u4e3a\u56e0\u679c\u56fe\uff0c\u4f7f\u7528do-calculus\u63a8\u5bfc\u65e0\u504f\u7684\u635f\u5931\u51fd\u6570\u3002\u8003\u8651\u89c2\u5bdf\u6982\u7387 $P(O=1|U,I,R)$ \u4f9d\u8d56\u4e8e\u771f\u5b9e\u8bc4\u5206 $R$ \u7684\u60c5\u51b5\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u6784\u5efa\u56e0\u679c\u56fe $U \\rightarrow R \\leftarrow I, R \\rightarrow O$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u56e0\u679c\u6a21\u578b\uff1a</p>\n<ul>\n<li>$U$\uff1a\u7528\u6237\u7279\u5f81</li>\n<li>$I$\uff1a\u7269\u54c1\u7279\u5f81</li>\n<li>$R$\uff1a\u771f\u5b9e\u8bc4\u5206</li>\n<li>$O$\uff1a\u662f\u5426\u89c2\u5bdf\u5230</li>\n</ul>\n<p>\u76ee\u6807\uff1a\u4f30\u8ba1 $\\mathbb{E}[R|U,I]$</p>\n<p>\u89c2\u5bdf\u5230\u7684\u6570\u636e\u5206\u5e03\uff1a\n$$P(R|U,I,O=1) = \\frac{P(O=1|U,I,R)P(R|U,I)}{P(O=1|U,I)}$$\n\u4f7f\u7528\u9006\u503e\u5411\u5206\u6570\u52a0\u6743\uff1a\n$$\\mathbb{E}[R|U,I] = \\frac{\\mathbb{E}[R \\cdot \\mathbb{1}[O=1] / P(O=1|U,I,R)|U,I]}{\\mathbb{E}[\\mathbb{1}[O=1] / P(O=1|U,I,R)|U,I]}$$</p>\n<p>\u5b9e\u8df5\u4e2d\u7684\u6311\u6218\uff1a</p>\n<ol>\n<li>\u4f30\u8ba1 $P(O=1|U,I,R)$ \u9700\u8981\u53cd\u4e8b\u5b9e\u63a8\u7406</li>\n<li>\u503e\u5411\u5206\u6570\u7684\u6781\u503c\u5bfc\u81f4\u9ad8\u65b9\u5dee</li>\n<li>\u6a21\u578b\u8bef\u8bbe\u7684\u654f\u611f\u6027</li>\n</ol>\n<p>\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ul>\n<li>\u53cc\u9c81\u68d2\u4f30\u8ba1</li>\n<li>\u654f\u611f\u6027\u5206\u6790</li>\n<li>\u4e0e\u5f3a\u5316\u5b66\u4e60\u7684\u7ed3\u5408</li>\n</ul>\n</details>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<h3 id=\"1\">1. \u6570\u503c\u7a33\u5b9a\u6027\u9677\u9631</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u76f4\u63a5\u8ba1\u7b97 $\\mathbf{Q}^T\\mathbf{C}^u\\mathbf{Q}$ \u5bfc\u81f4\u6570\u503c\u4e0d\u7a33\u5b9a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"gh\">#</span> \u9519\u8bef\u505a\u6cd5\nA = Q.T @ diag(C_u) @ Q  # \u5f53C_u\u5305\u542b\u6781\u5927\u503c\u65f6\u6761\u4ef6\u6570\u7206\u70b8\n</code></pre></div>\n\n<p><strong>\u6b63\u786e\u505a\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u589e\u91cf\u66f4\u65b0\uff1a$\\mathbf{A} = \\mathbf{Q}^T\\mathbf{Q} + \\sum_i (c_{ui}-1)\\mathbf{q}_i\\mathbf{q}_i^T$</li>\n<li>\u6dfb\u52a0\u81ea\u9002\u5e94\u6b63\u5219\u5316\uff1a$\\lambda = \\max(\\lambda_0, \\epsilon \\cdot \\text{trace}(\\mathbf{A}))$</li>\n</ul>\n<h3 id=\"2\">2. \u8d1f\u91c7\u6837\u504f\u5dee</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5747\u5300\u8d1f\u91c7\u6837\u5bfc\u81f4\u6d41\u884c\u7269\u54c1\u7684\u8d1f\u4fe1\u53f7\u4e0d\u8db3</p>\n<ul>\n<li>\u70ed\u95e8\u7269\u54c1\u88ab\u5927\u91cf\u7528\u6237\u5ffd\u7565\uff0c\u4f46\u91c7\u6837\u6982\u7387\u4e0e\u51b7\u95e8\u7269\u54c1\u76f8\u540c</li>\n<li>\u5bfc\u81f4\u6a21\u578b\u8fc7\u5ea6\u63a8\u8350\u6d41\u884c\u7269\u54c1</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u6d41\u884c\u5ea6\u52a0\u6743\u91c7\u6837\uff1a$P(i) \\propto f_i^{0.75}$</li>\n<li>\u5b9e\u65bd\u91cd\u8981\u6027\u6743\u91cd\u6821\u6b63</li>\n</ul>\n<h3 id=\"3\">3. \u51b7\u542f\u52a8\u8fc7\u62df\u5408</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u65b0\u7528\u6237/\u7269\u54c1\u7684\u56e0\u5b50\u5411\u91cf\u5feb\u901f\u8fc7\u62df\u5408\u5230\u5c11\u91cf\u4ea4\u4e92</p>\n<ul>\n<li>\u7f6e\u4fe1\u5ea6\u51fd\u6570\u5bf9\u521d\u59cb\u4ea4\u4e92\u8d4b\u4e88\u8fc7\u9ad8\u6743\u91cd</li>\n<li>\u6b63\u5219\u5316\u4e0d\u8db3\u5bfc\u81f4\u56e0\u5b50\u5411\u91cfnorm\u8fc7\u5927</li>\n</ul>\n<p><strong>\u7f13\u89e3\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u6b63\u5219\u5316\uff1a$\\lambda_u = \\lambda_0 \\cdot \\max(1, n_0/n_u)$</li>\n<li>\u4f7f\u7528\u5148\u9a8c\u4fe1\u606f\u521d\u59cb\u5316\u56e0\u5b50</li>\n</ul>\n<h3 id=\"4\">4. \u5206\u5e03\u5f0f\u8bad\u7ec3\u7684\u6570\u636e\u503e\u659c</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u7528\u6237\u6d3b\u8dc3\u5ea6\u7684\u5e42\u5f8b\u5206\u5e03\u5bfc\u81f4\u8ba1\u7b97\u8d1f\u8f7d\u4e0d\u5747</p>\n<ul>\n<li>\u67d0\u4e9b\u8282\u70b9\u5904\u7406\u8d85\u7ea7\u6d3b\u8dc3\u7528\u6237\uff0c\u6210\u4e3a\u74f6\u9888</li>\n<li>\u7b80\u5355\u7684\u54c8\u5e0c\u5206\u7247\u52a0\u5267\u95ee\u9898</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u8ba1\u7b97\u91cf\u7684\u52a8\u6001\u8d1f\u8f7d\u5747\u8861</li>\n<li>\u5c06\u8d85\u7ea7\u7528\u6237\u7684\u8ba1\u7b97\u5206\u6563\u5230\u591a\u4e2a\u8282\u70b9</li>\n</ul>\n<h3 id=\"5\">5. \u65f6\u95f4\u52a8\u6001\u7684\u8fc7\u5ea6\u62df\u5408</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u8fc7\u4e8e\u6fc0\u8fdb\u7684\u65f6\u95f4\u8870\u51cf\u5bfc\u81f4\u5386\u53f2\u4fe1\u606f\u4e22\u5931</p>\n<ul>\n<li>\u6307\u6570\u8870\u51cf\u53c2\u6570\u8bbe\u7f6e\u8fc7\u5927</li>\n<li>\u77ed\u671f\u884c\u4e3a\u4e3b\u5bfc\uff0c\u957f\u671f\u504f\u597d\u88ab\u5ffd\u7565</li>\n</ul>\n<p><strong>\u5e73\u8861\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u591a\u5c3a\u5ea6\u65f6\u95f4\u5efa\u6a21</li>\n<li>\u4fdd\u7559\u7528\u6237\u7684\"\u6838\u5fc3\u504f\u597d\"\u4e0d\u8870\u51cf</li>\n</ul>\n<h3 id=\"6\">6. \u9690\u5f0f\u5230\u663e\u5f0f\u7684\u8bef\u5bfc\u8f6c\u6362</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5c06\u9690\u5f0f\u53cd\u9988\u4e8c\u503c\u5316\u65f6\u4e22\u5931\u91cd\u8981\u4fe1\u606f</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"gh\">#</span> \u5371\u9669\u7684\u7b80\u5316\np_ui = 1 if r_ui &gt; 0 else 0  # \u5ffd\u7565\u4e86\u4ea4\u4e92\u5f3a\u5ea6\n</code></pre></div>\n\n<p><strong>\u66f4\u597d\u7684\u505a\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u4fdd\u7559\u8fde\u7eed\u503c\uff1a$p_{ui} = \\log(1 + r_{ui})$</li>\n<li>\u4f7f\u7528\u7f6e\u4fe1\u5ea6\u533a\u5206\u4e0d\u540c\u5f3a\u5ea6\u7684\u4fe1\u53f7</li>\n</ul>\n<h3 id=\"7\">7. \u5e76\u884c\u66f4\u65b0\u7684\u7ade\u6001\u6761\u4ef6</h3>\n<p><strong>\u95ee\u9898</strong>\uff1aHogwild!\u5f0f\u5e76\u884c\u66f4\u65b0\u5728\u9ad8\u7ade\u4e89\u533a\u57df\u5931\u6548</p>\n<ul>\n<li>\u70ed\u95e8\u7269\u54c1\u7684\u56e0\u5b50\u88ab\u9891\u7e41\u66f4\u65b0</li>\n<li>\u68af\u5ea6\u5ef6\u8fdf\u5bfc\u81f4\u6536\u655b\u4e0d\u7a33\u5b9a</li>\n</ul>\n<p><strong>\u7f13\u89e3\u63aa\u65bd</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u5ef6\u8fdf\u8865\u507fSGD</li>\n<li>\u5bf9\u9ad8\u7ade\u4e89\u53c2\u6570\u4f7f\u7528\u9501\u6216\u539f\u5b50\u64cd\u4f5c</li>\n</ul>\n<h3 id=\"8\">8. \u8bc4\u4f30\u6307\u6807\u7684\u8bef\u5bfc\u6027</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u79bb\u7ebf\u6307\u6807\uff08\u5982RMSE\uff09\u4e0e\u5728\u7ebf\u4e1a\u52a1\u6307\u6807\u8131\u8282</p>\n<ul>\n<li>RMSE\u4f18\u5316\u53ef\u80fd\u964d\u4f4e\u63a8\u8350\u591a\u6837\u6027</li>\n<li>\u5ffd\u7565\u4e86\u4f4d\u7f6e\u504f\u5dee\u548c\u5c55\u793a\u504f\u5dee</li>\n</ul>\n<p><strong>\u5168\u9762\u8bc4\u4f30</strong>\uff1a</p>\n<ul>\n<li>\u540c\u65f6\u76d1\u63a7\u51c6\u786e\u6027\u3001\u8986\u76d6\u5ea6\u3001\u591a\u6837\u6027</li>\n<li>\u8fdb\u884c\u5728\u7ebfA/B\u6d4b\u8bd5\u9a8c\u8bc1</li>\n</ul>\n<h2 id=\"_3\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_4\">\u6570\u636e\u9884\u5904\u7406</h3>\n<ul>\n<li>[ ] \u8bc6\u522b\u5e76\u5904\u7406\u5f02\u5e38\u7528\u6237\u884c\u4e3a\uff08\u5982\u673a\u5668\u4eba\uff09</li>\n<li>[ ] \u5bf9\u957f\u5c3e\u5206\u5e03\u7684\u4ea4\u4e92\u5f3a\u5ea6\u8fdb\u884c\u5bf9\u6570\u53d8\u6362</li>\n<li>[ ] \u5b9e\u65bd\u5408\u7406\u7684\u65f6\u95f4\u7a97\u53e3\u622a\u65ad</li>\n<li>[ ] \u9a8c\u8bc1\u7528\u6237-\u7269\u54c1\u4ea4\u4e92\u77e9\u9635\u7684\u7a00\u758f\u5ea6</li>\n</ul>\n<h3 id=\"_5\">\u7b97\u6cd5\u8bbe\u8ba1</h3>\n<ul>\n<li>[ ] \u7f6e\u4fe1\u5ea6\u51fd\u6570\u8003\u8651\u591a\u79cd\u4fe1\u53f7\u7c7b\u578b</li>\n<li>[ ] \u6b63\u5219\u5316\u53c2\u6570\u6839\u636e\u7528\u6237/\u7269\u54c1\u6d3b\u8dc3\u5ea6\u81ea\u9002\u5e94</li>\n<li>[ ] \u8d1f\u91c7\u6837\u7b56\u7565\u5e73\u8861\u6548\u7387\u4e0e\u65e0\u504f\u6027</li>\n<li>[ ] \u5b9e\u73b0\u589e\u91cf\u66f4\u65b0\u4ee5\u652f\u6301\u5728\u7ebf\u5b66\u4e60</li>\n</ul>\n<h3 id=\"_6\">\u6570\u503c\u8ba1\u7b97</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u6570\u503c\u7a33\u5b9a\u7684\u77e9\u9635\u8fd0\u7b97\uff08\u907f\u514d\u663e\u5f0f\u6c42\u9006\uff09</li>\n<li>[ ] \u76d1\u63a7\u6761\u4ef6\u6570\uff0c\u5fc5\u8981\u65f6\u589e\u52a0\u6b63\u5219\u5316</li>\n<li>[ ] \u5229\u7528\u7a00\u758f\u6027\u51cf\u5c11\u8ba1\u7b97\u590d\u6742\u5ea6</li>\n<li>[ ] \u5b9e\u65bd\u5468\u671f\u6027\u7684\u5b8c\u5168\u91cd\u7b97\u4ee5\u63a7\u5236\u8bef\u5dee\u7d2f\u79ef</li>\n</ul>\n<h3 id=\"_7\">\u5206\u5e03\u5f0f\u5b9e\u73b0</h3>\n<ul>\n<li>[ ] \u9009\u62e9\u9002\u5408\u6570\u636e\u7279\u5f81\u7684\u5206\u7247\u7b56\u7565</li>\n<li>[ ] \u5b9e\u73b0\u9ad8\u6548\u7684\u56e0\u5b50\u5e7f\u64ad/\u805a\u5408\u673a\u5236</li>\n<li>[ ] \u5904\u7406\u8282\u70b9\u6545\u969c\u548c\u7f51\u7edc\u5ef6\u8fdf</li>\n<li>[ ] \u76d1\u63a7\u548c\u5747\u8861\u8ba1\u7b97\u8d1f\u8f7d</li>\n</ul>\n<h3 id=\"_8\">\u6027\u80fd\u4f18\u5316</h3>\n<ul>\n<li>[ ] \u5229\u7528SIMD\u6307\u4ee4\u52a0\u901f\u5411\u91cf\u8fd0\u7b97</li>\n<li>[ ] \u4f18\u5316\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff08\u7f13\u5b58\u53cb\u597d\uff09</li>\n<li>[ ] \u4f7f\u7528\u5f02\u6b65I/O\u51cf\u5c11\u7b49\u5f85\u65f6\u95f4</li>\n<li>[ ] Profile\u8bc6\u522b\u6027\u80fd\u74f6\u9888</li>\n</ul>\n<h3 id=\"_9\">\u6a21\u578b\u8bc4\u4f30</h3>\n<ul>\n<li>[ ] \u8bbe\u8ba1\u8003\u8651\u65f6\u95f4\u56e0\u7d20\u7684\u8bad\u7ec3/\u6d4b\u8bd5\u96c6\u5212\u5206</li>\n<li>[ ] \u8bc4\u4f30\u591a\u4e2a\u7ef4\u5ea6\uff1a\u51c6\u786e\u6027\u3001\u8986\u76d6\u5ea6\u3001\u591a\u6837\u6027\u3001\u65b0\u9896\u6027</li>\n<li>[ ] \u8fdb\u884c\u6d88\u878d\u5b9e\u9a8c\u9a8c\u8bc1\u5404\u7ec4\u4ef6\u8d21\u732e</li>\n<li>[ ] \u76d1\u63a7\u6a21\u578b\u5728\u4e0d\u540c\u7528\u6237\u7fa4\u4f53\u4e0a\u7684\u516c\u5e73\u6027</li>\n</ul>\n<h3 id=\"_10\">\u751f\u4ea7\u90e8\u7f72</h3>\n<ul>\n<li>[ ] \u5b9e\u73b0\u6a21\u578b\u7248\u672c\u7ba1\u7406\u548c\u56de\u6eda\u673a\u5236</li>\n<li>[ ] \u8bbe\u7f6e\u5f02\u5e38\u68c0\u6d4b\u548c\u62a5\u8b66</li>\n<li>[ ] \u652f\u6301\u70ed\u66f4\u65b0without\u670d\u52a1\u4e2d\u65ad</li>\n<li>[ ] \u8bb0\u5f55\u8be6\u7ec6\u65e5\u5fd7\u7528\u4e8e\u95ee\u9898\u8bca\u65ad</li>\n</ul>\n<h3 id=\"_11\">\u6301\u7eed\u6539\u8fdb</h3>\n<ul>\n<li>[ ] \u6536\u96c6\u5728\u7ebf\u53cd\u9988\u7528\u4e8e\u6a21\u578b\u8fed\u4ee3</li>\n<li>[ ] \u5b9a\u671f\u91cd\u65b0\u8bc4\u4f30\u8d85\u53c2\u6570</li>\n<li>[ ] \u63a2\u7d22\u65b0\u7684\u7279\u5f81\u548c\u4fe1\u53f7\u6e90</li>\n<li>[ ] \u8ddf\u8e2a\u5b66\u672f\u754c\u6700\u65b0\u8fdb\u5c55\u5e76\u8bc4\u4f30\u9002\u7528\u6027</li>\n</ul>"
  },
  "../chapter20.md": {
    "hash": "f26c806b649dfc77abf1ff077dba0d42",
    "content": "<h1 id=\"b\">\u9644\u5f55B\uff1a\u6027\u80fd\u8c03\u4f18\u68c0\u67e5\u6e05\u5355</h1>\n<p>\u6027\u80fd\u4f18\u5316\u662f\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u7684\u6838\u5fc3\u6311\u6218\u3002\u672c\u7ae0\u63d0\u4f9b\u4e00\u4efd\u7cfb\u7edf\u5316\u7684\u6027\u80fd\u8c03\u4f18\u68c0\u67e5\u6e05\u5355\uff0c\u6db5\u76d6\u4ece\u7b97\u6cd5\u8bbe\u8ba1\u5230\u786c\u4ef6\u9002\u914d\u7684\u5404\u4e2a\u5c42\u9762\u3002\u4e0e\u4f20\u7edf\u7684\u6027\u80fd\u4f18\u5316\u6307\u5357\u4e0d\u540c\uff0c\u6211\u4eec\u7279\u522b\u5173\u6ce8\u77e9\u9635\u8ba1\u7b97\u7279\u6709\u7684\u4f18\u5316\u673a\u4f1a\uff0c\u4ee5\u53ca\u5728\u73b0\u4ee3\u5f02\u6784\u8ba1\u7b97\u73af\u5883\u4e0b\u7684\u65b0\u6311\u6218\u3002\u6bcf\u4e2a\u4f18\u5316\u5efa\u8bae\u90fd\u914d\u6709\u7406\u8bba\u4f9d\u636e\u548c\u5b9e\u8df5\u8003\u91cf\uff0c\u5e2e\u52a9\u8bfb\u8005\u5728\u590d\u6742\u7684\u6027\u80fd-\u7cbe\u5ea6-\u53ef\u6269\u5c55\u6027\u6743\u8861\u4e2d\u505a\u51fa\u660e\u667a\u51b3\u7b56\u3002</p>\n<h2 id=\"1\">1. \u5185\u5b58\u5c42\u6b21\u4f18\u5316</h2>\n<h3 id=\"11-cache-aware\">1.1 Cache-aware\u7b97\u6cd5\u8bbe\u8ba1</h3>\n<p>\u77e9\u9635\u8fd0\u7b97\u7684\u6027\u80fd\u5f80\u5f80\u53d7\u9650\u4e8e\u5185\u5b58\u5e26\u5bbd\u800c\u975e\u8ba1\u7b97\u80fd\u529b\u3002\u7406\u89e3\u5e76\u5229\u7528\u7f13\u5b58\u5c42\u6b21\u7ed3\u6784\u662f\u63d0\u5347\u6027\u80fd\u7684\u5173\u952e\u3002</p>\n<p><strong>\u5206\u5757\uff08Blocking\uff09\u7b56\u7565</strong></p>\n<ul>\n<li>\u9009\u62e9\u5408\u9002\u7684\u5757\u5927\u5c0f\uff1a$B \\approx \\sqrt{C/3}$\uff0c\u5176\u4e2d$C$\u662fL1\u7f13\u5b58\u5927\u5c0f</li>\n<li>\u591a\u7ea7\u5206\u5757\uff1a\u540c\u65f6\u4f18\u5316L1\u3001L2\u3001L3\u7f13\u5b58</li>\n<li>\u8003\u8651TLB\uff08Translation Lookaside Buffer\uff09\u7684\u5f71\u54cd</li>\n</ul>\n<p><strong>\u6570\u636e\u91cd\u7528\u6a21\u5f0f</strong></p>\n<ul>\n<li>\u65f6\u95f4\u5c40\u90e8\u6027\uff1a\u6700\u5927\u5316\u5355\u4e2a\u6570\u636e\u5143\u7d20\u7684\u91cd\u590d\u4f7f\u7528</li>\n<li>\u7a7a\u95f4\u5c40\u90e8\u6027\uff1a\u987a\u5e8f\u8bbf\u95ee\u8fde\u7eed\u5185\u5b58\u5730\u5740</li>\n<li>\u5206\u7ec4\u91cd\u7528\uff1a\u5c06\u76f8\u5173\u8ba1\u7b97\u805a\u96c6\u4ee5\u5171\u4eab\u6570\u636e</li>\n</ul>\n<h3 id=\"12-memory-alignmentpadding\">1.2 Memory Alignment\u4e0ePadding</h3>\n<p><strong>\u5bf9\u9f50\u7b56\u7565</strong></p>\n<ul>\n<li>SIMD\u53cb\u597d\u7684\u5185\u5b58\u5bf9\u9f50\uff08\u901a\u5e3816\u300132\u621664\u5b57\u8282\uff09</li>\n<li>\u907f\u514dfalse sharing\uff1a\u786e\u4fdd\u4e0d\u540c\u7ebf\u7a0b\u8bbf\u95ee\u7684\u6570\u636e\u5728\u4e0d\u540ccache line</li>\n<li>\u8003\u8651NUMA\u67b6\u6784\u4e0b\u7684\u5185\u5b58\u4eb2\u548c\u6027</li>\n</ul>\n<p><strong>\u667a\u80fdPadding</strong></p>\n<ul>\n<li>\u907f\u514dcache\u51b2\u7a81\uff1a$\\text{stride} \\neq 2^k \\times \\text{cache_line_size}$</li>\n<li>\u77e9\u9635\u7ef4\u5ea6\u8c03\u6574\uff1a\u5411\u4e0a\u53d6\u6574\u5230SIMD\u5bbd\u5ea6\u7684\u500d\u6570</li>\n<li>\u6743\u8861\u989d\u5916\u5185\u5b58\u5f00\u9500\u4e0e\u6027\u80fd\u63d0\u5347</li>\n</ul>\n<h3 id=\"13\">1.3 \u6570\u636e\u5e03\u5c40\u4f18\u5316</h3>\n<p><strong>\u5b58\u50a8\u683c\u5f0f\u9009\u62e9</strong></p>\n<ul>\n<li>Row-major vs Column-major\uff1a\u6839\u636e\u8bbf\u95ee\u6a21\u5f0f\u9009\u62e9</li>\n<li>\u5206\u5757\u5b58\u50a8\u683c\u5f0f\uff08Block Data Layout\uff09</li>\n<li>\u6df7\u5408\u683c\u5f0f\uff1a\u4e0d\u540c\u64cd\u4f5c\u4f7f\u7528\u4e0d\u540c\u5e03\u5c40</li>\n</ul>\n<p><strong>\u7a00\u758f\u77e9\u9635\u683c\u5f0f</strong></p>\n<ul>\n<li>CSR/CSC\uff1a\u9002\u5408\u77e9\u9635\u5411\u91cf\u4e58\u6cd5</li>\n<li>COO\uff1a\u9002\u5408\u77e9\u9635\u6784\u5efa\u9636\u6bb5</li>\n<li>Block-CSR\uff1a\u5229\u7528\u5757\u7ed3\u6784</li>\n<li>\u81ea\u9002\u5e94\u683c\u5f0f\uff1a\u6839\u636e\u7a00\u758f\u6a21\u5f0f\u52a8\u6001\u9009\u62e9</li>\n</ul>\n<h2 id=\"2\">2. \u5e76\u884c\u5316\u7b56\u7565</h2>\n<h3 id=\"21\">2.1 \u4efb\u52a1\u5206\u89e3\u7c92\u5ea6</h3>\n<p><strong>\u5de5\u4f5c\u5212\u5206\u539f\u5219</strong></p>\n<ul>\n<li>\u8ba1\u7b97/\u901a\u4fe1\u6bd4\uff1a\u786e\u4fdd $\\frac{\\text{computation}}{\\text{communication}} &gt; \\tau$\uff08\u9608\u503c\uff09</li>\n<li>\u8d1f\u8f7d\u5747\u8861\uff1a\u8003\u8651\u77e9\u9635\u7ed3\u6784\u7684\u4e0d\u89c4\u5219\u6027</li>\n<li>\u7f13\u5b58\u53cb\u597d\u7684\u5206\u89e3\uff1a\u4fdd\u6301\u6570\u636e\u5c40\u90e8\u6027</li>\n</ul>\n<p><strong>\u52a8\u6001vs\u9759\u6001\u8c03\u5ea6</strong></p>\n<ul>\n<li>\u9759\u6001\u8c03\u5ea6\uff1a\u5f00\u9500\u5c0f\uff0c\u9002\u5408\u89c4\u5219\u8ba1\u7b97</li>\n<li>\u52a8\u6001\u8c03\u5ea6\uff1a\u9002\u5e94\u4e0d\u89c4\u5219\u8d1f\u8f7d\uff0c\u4f46\u6709\u8c03\u5ea6\u5f00\u9500</li>\n<li>Guided\u8c03\u5ea6\uff1a\u6298\u4e2d\u65b9\u6848</li>\n</ul>\n<h3 id=\"22\">2.2 \u540c\u6b65\u5f00\u9500\u6700\u5c0f\u5316</h3>\n<p><strong>\u51cf\u5c11\u540c\u6b65\u70b9</strong></p>\n<ul>\n<li>\u5f02\u6b65\u7b97\u6cd5\u8bbe\u8ba1</li>\n<li>\u6279\u91cf\u540c\u6b65\u5e76\u884c\uff08BSP\uff09\u6a21\u578b</li>\n<li>\u65e0\u9501\u6570\u636e\u7ed3\u6784</li>\n</ul>\n<p><strong>\u7ec6\u7c92\u5ea6\u5e76\u884c\u4f18\u5316</strong></p>\n<ul>\n<li>\u539f\u5b50\u64cd\u4f5c\u4f18\u5316\uff1a\u4f7f\u7528compare-and-swap</li>\n<li>\u51cf\u5c11\u9501\u7c92\u5ea6\uff1a\u884c\u7ea7\u9501\u3001\u5206\u6bb5\u9501</li>\n<li>\u53cc\u7f13\u51b2\u6280\u672f\uff1a\u8ba1\u7b97\u4e0e\u901a\u4fe1\u91cd\u53e0</li>\n</ul>\n<h3 id=\"23-numa\">2.3 NUMA\u611f\u77e5\u4f18\u5316</h3>\n<p><strong>\u5185\u5b58\u5206\u914d\u7b56\u7565</strong></p>\n<ul>\n<li>First-touch policy\uff1a\u6570\u636e\u5206\u914d\u5230\u9996\u6b21\u8bbf\u95ee\u7684\u8282\u70b9</li>\n<li>\u663e\u5f0f\u7ed1\u5b9a\uff1a<code>numactl</code>\u6216\u7f16\u7a0b\u63a5\u53e3</li>\n<li>\u4ea4\u9519\u5206\u914d\uff1a\u9002\u5408\u5171\u4eab\u6570\u636e\u7ed3\u6784</li>\n</ul>\n<p><strong>\u7ebf\u7a0b\u7ed1\u5b9a</strong></p>\n<ul>\n<li>CPU\u4eb2\u548c\u6027\u8bbe\u7f6e</li>\n<li>\u907f\u514d\u8de8NUMA\u8282\u70b9\u7684\u5185\u5b58\u8bbf\u95ee</li>\n<li>\u8003\u8651\u8d85\u7ebf\u7a0b\u7684\u5f71\u54cd</li>\n</ul>\n<h2 id=\"3\">3. \u6570\u503c\u7a33\u5b9a\u6027\u4e0e\u7cbe\u5ea6</h2>\n<h3 id=\"31\">3.1 \u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</h3>\n<p><strong>\u7cbe\u5ea6\u9009\u62e9\u7b56\u7565</strong></p>\n<ul>\n<li>\u8fed\u4ee3\u7cbe\u5316\uff1a\u4f4e\u7cbe\u5ea6\u8ba1\u7b97 + \u9ad8\u7cbe\u5ea6\u4fee\u6b63</li>\n<li>\u81ea\u9002\u5e94\u7cbe\u5ea6\uff1a\u6839\u636e\u6536\u655b\u6027\u52a8\u6001\u8c03\u6574</li>\n<li>\u5173\u952e\u8def\u5f84\u8bc6\u522b\uff1a\u4ec5\u5728\u5fc5\u8981\u5904\u4f7f\u7528\u9ad8\u7cbe\u5ea6</li>\n</ul>\n<p><strong>\u8bef\u5dee\u5206\u6790</strong></p>\n<ul>\n<li>\u524d\u5411\u8bef\u5dee\u754c\uff1a$|\\hat{x} - x| \\leq \\kappa(A) \\cdot \\epsilon_{machine}$</li>\n<li>\u540e\u5411\u8bef\u5dee\u5206\u6790\uff1a$(A + \\Delta A)\\hat{x} = b$</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u4e0b\u7684\u8bef\u5dee\u4f20\u64ad</li>\n</ul>\n<h3 id=\"32\">3.2 \u6570\u503c\u7a33\u5b9a\u7b97\u6cd5\u9009\u62e9</h3>\n<p><strong>\u6761\u4ef6\u6570\u611f\u77e5</strong></p>\n<ul>\n<li>\u9884\u6761\u4ef6\u6280\u672f\uff1a\u964d\u4f4e\u6709\u6548\u6761\u4ef6\u6570</li>\n<li>\u8fed\u4ee3\u7cbe\u5316\uff1a\u6539\u5584\u89e3\u7684\u7cbe\u5ea6</li>\n<li>\u6b63\u4ea4\u5316\u65b9\u6cd5\uff1aHouseholder vs Gram-Schmidt</li>\n</ul>\n<p><strong>\u6ea2\u51fa/\u4e0b\u6ea2\u9884\u9632</strong></p>\n<ul>\n<li>\u7f29\u653e\u6280\u672f\uff1a\u5e73\u8861\u77e9\u9635\u5143\u7d20\u5927\u5c0f</li>\n<li>\u5bf9\u6570\u7a7a\u95f4\u8ba1\u7b97\uff1a\u907f\u514d\u6781\u5927/\u6781\u5c0f\u503c</li>\n<li>\u589e\u91cf\u66f4\u65b0\uff1a\u907f\u514d\u707e\u96be\u6027\u62b5\u6d88</li>\n</ul>\n<h2 id=\"4\">4. \u901a\u4fe1\u4f18\u5316</h2>\n<h3 id=\"41\">4.1 \u901a\u4fe1\u6a21\u5f0f\u4f18\u5316</h3>\n<p><strong>\u96c6\u5408\u901a\u4fe1</strong></p>\n<ul>\n<li>All-reduce\u4f18\u5316\uff1a\u6811\u5f62\u3001\u73af\u5f62\u3001\u8776\u5f62\u62d3\u6251</li>\n<li>Broadcast/Scatter\uff1a\u9009\u62e9\u5408\u9002\u7684\u7b97\u6cd5</li>\n<li>\u901a\u4fe1\u805a\u5408\uff1a\u51cf\u5c11\u6d88\u606f\u6570\u91cf</li>\n</ul>\n<p><strong>\u70b9\u5bf9\u70b9\u901a\u4fe1</strong></p>\n<ul>\n<li>\u975e\u963b\u585e\u901a\u4fe1\uff1a\u8ba1\u7b97\u4e0e\u901a\u4fe1\u91cd\u53e0</li>\n<li>\u6301\u4e45\u901a\u4fe1\uff1a\u91cd\u590d\u6a21\u5f0f\u7684\u4f18\u5316</li>\n<li>\u6d88\u606f\u6253\u5305\uff1a\u51cf\u5c11\u5ef6\u8fdf\u5f00\u9500</li>\n</ul>\n<h3 id=\"42\">4.2 \u901a\u4fe1\u9690\u85cf\u6280\u672f</h3>\n<p><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong></p>\n<ul>\n<li>\u8ba1\u7b97\u4e0e\u901a\u4fe1\u7684\u7cbe\u7ec6\u4ea4\u7ec7</li>\n<li>\u591a\u7f13\u51b2\u533a\u8f6e\u8f6c</li>\n<li>\u9884\u53d6\u673a\u5236</li>\n</ul>\n<p><strong>\u901a\u4fe1\u907f\u514d\u7b97\u6cd5</strong></p>\n<ul>\n<li>2.5D\u77e9\u9635\u4e58\u6cd5\uff1a\u989d\u5916\u5185\u5b58\u6362\u53d6\u901a\u4fe1\u51cf\u5c11</li>\n<li>Tall-skinny QR\uff1a\u6700\u5c0f\u5316\u901a\u4fe1\u8f6e\u6b21</li>\n<li>\u901a\u4fe1\u4e0b\u754c\u7406\u8bba</li>\n</ul>\n<h3 id=\"43\">4.3 \u7f51\u7edc\u62d3\u6251\u611f\u77e5</h3>\n<p><strong>\u62d3\u6251\u6620\u5c04</strong></p>\n<ul>\n<li>\u903b\u8f91\u62d3\u6251\u5230\u7269\u7406\u62d3\u6251\u7684\u6620\u5c04</li>\n<li>\u6700\u8fd1\u90bb\u901a\u4fe1\u4f18\u5316</li>\n<li>\u907f\u514d\u7f51\u7edc\u62e5\u585e</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u8def\u7531</strong></p>\n<ul>\n<li>\u52a8\u6001\u8d1f\u8f7d\u611f\u77e5</li>\n<li>\u591a\u8def\u5f84\u5229\u7528</li>\n<li>\u5bb9\u9519\u8003\u8651</li>\n</ul>\n<h2 id=\"5\">5. \u786c\u4ef6\u7279\u5b9a\u4f18\u5316</h2>\n<h3 id=\"51-simd\">5.1 SIMD\u6307\u4ee4\u4f18\u5316</h3>\n<p><strong>\u5411\u91cf\u5316\u53cb\u597d\u7684\u4ee3\u7801</strong></p>\n<ul>\n<li>\u5faa\u73af\u5c55\u5f00\u4e0e\u5411\u91cf\u5316</li>\n<li>\u6570\u636e\u5bf9\u9f50\u4fdd\u8bc1</li>\n<li>\u907f\u514d\u5206\u652f\uff1a\u4f7f\u7528\u63a9\u7801\u64cd\u4f5c</li>\n</ul>\n<p><strong>\u7f16\u8bd1\u5668\u534f\u52a9</strong></p>\n<ul>\n<li>\u5411\u91cf\u5316\u63d0\u793a\uff1a<code>#pragma simd</code></li>\n<li>\u7f16\u8bd1\u5668\u62a5\u544a\u5206\u6790</li>\n<li>\u624b\u52a8\u5411\u91cf\u5316\uff1aintrinsics\u4f7f\u7528</li>\n</ul>\n<h3 id=\"52-gpu\">5.2 GPU\u4f18\u5316</h3>\n<p><strong>\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</strong></p>\n<ul>\n<li>Coalesced access\uff1a\u8fde\u7eed\u7ebf\u7a0b\u8bbf\u95ee\u8fde\u7eed\u5730\u5740</li>\n<li>Bank conflict\u907f\u514d</li>\n<li>Shared memory\u4f18\u5316\u4f7f\u7528</li>\n</ul>\n<p><strong>\u5360\u7528\u7387\u4f18\u5316</strong></p>\n<ul>\n<li>Register pressure\u7ba1\u7406</li>\n<li>Block size\u8c03\u4f18</li>\n<li>\u52a8\u6001\u5e76\u884c\u5ea6</li>\n</ul>\n<p><strong>\u5f20\u91cf\u6838\u5fc3\u5229\u7528</strong></p>\n<ul>\n<li>\u6df7\u5408\u7cbe\u5ea6GEMM</li>\n<li>Tensor Core\u53cb\u597d\u7684\u6570\u636e\u5e03\u5c40</li>\n<li>Warp\u7ea7\u7f16\u7a0b</li>\n</ul>\n<h3 id=\"53\">5.3 \u4e13\u7528\u52a0\u901f\u5668</h3>\n<p><strong>TPU/NPU\u9002\u914d</strong></p>\n<ul>\n<li>Systolic array\u6620\u5c04</li>\n<li>\u6279\u5904\u7406\u4f18\u5316</li>\n<li>\u91cf\u5316\u611f\u77e5\u8bad\u7ec3</li>\n</ul>\n<p><strong>FPGA\u4f18\u5316</strong></p>\n<ul>\n<li>\u6d41\u6c34\u7ebf\u6df1\u5ea6\u6743\u8861</li>\n<li>\u8d44\u6e90\u5229\u7528\u7387</li>\n<li>\u5b9a\u5236\u6570\u636e\u901a\u8def</li>\n</ul>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u6027\u80fd\u8c03\u4f18\u662f\u4e00\u4e2a\u8fed\u4ee3\u8fc7\u7a0b\uff0c\u9700\u8981\u5728\u591a\u4e2a\u7ef4\u5ea6\u4e0a\u8fdb\u884c\u6743\u8861\uff1a</p>\n<ul>\n<li><strong>\u5185\u5b58\u4f18\u5316</strong>\u662f\u63d0\u5347\u77e9\u9635\u8ba1\u7b97\u6027\u80fd\u7684\u9996\u8981\u4efb\u52a1</li>\n<li><strong>\u5e76\u884c\u5316</strong>\u9700\u8981\u8003\u8651\u786c\u4ef6\u62d3\u6251\u548c\u901a\u4fe1\u5f00\u9500</li>\n<li><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\u4e0d\u5e94\u4e3a\u6027\u80fd\u800c\u727a\u7272</li>\n<li><strong>\u786c\u4ef6\u7279\u5b9a\u4f18\u5316</strong>\u53ef\u5e26\u6765\u6570\u91cf\u7ea7\u7684\u6027\u80fd\u63d0\u5347</li>\n</ul>\n<p>\u5173\u952e\u4f18\u5316\u516c\u5f0f\uff1a</p>\n<ul>\n<li>Roofline\u6a21\u578b\uff1a$P = \\min(P_{peak}, I \\cdot B_{mem})$</li>\n<li>Amdahl\u5b9a\u5f8b\uff1a$S = \\frac{1}{(1-p) + \\frac{p}{n}}$</li>\n<li>\u901a\u4fe1\u590d\u6742\u5ea6\uff1a$T = \\alpha \\cdot #messages + \\beta \\cdot #words$</li>\n</ul>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u7ec3\u4e6020.1</strong> \u7ed9\u5b9a\u4e00\u4e2a $10000 \\times 10000$ \u7684\u7a20\u5bc6\u77e9\u9635\u4e58\u6cd5\uff0cL1\u7f13\u5b58\u5927\u5c0f\u4e3a32KB\uff0cL2\u4e3a256KB\uff0cL3\u4e3a8MB\u3002\u8ba1\u7b97\u6700\u4f18\u7684\u5206\u5757\u5927\u5c0f\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4e09\u4e2a\u77e9\u9635\u5757\u9700\u8981\u540c\u65f6\u9a7b\u7559\u5728\u7f13\u5b58\u4e2d\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e\u77e9\u9635\u4e58\u6cd5 $C = A \\times B$\uff0c\u6bcf\u4e2a\u5757\u9700\u8981\u5b58\u50a8 $3B^2$ \u4e2a\u5143\u7d20\uff08\u5047\u8bbedouble\u7c7b\u578b\uff0c8\u5b57\u8282\uff09\u3002</p>\n<p>L1\u4f18\u5316\uff1a$3B^2 \\times 8 \\leq 32768$\uff0c\u5f97 $B \\leq 37$\nL2\u4f18\u5316\uff1a$3B^2 \\times 8 \\leq 262144$\uff0c\u5f97 $B \\leq 104$<br />\nL3\u4f18\u5316\uff1a$3B^2 \\times 8 \\leq 8388608$\uff0c\u5f97 $B \\leq 589$</p>\n<p>\u5b9e\u8df5\u4e2d\u901a\u5e38\u4f7f\u7528\u591a\u7ea7\u5206\u5757\uff1aL1\u5757\u5927\u5c0f32\uff0cL2\u5757\u5927\u5c0f96\uff0cL3\u5757\u5927\u5c0f512\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6020.2</strong> \u67d0\u7a00\u758f\u77e9\u9635\u6709 $n=10^6$ \u884c\uff0c\u5e73\u5747\u6bcf\u884c10\u4e2a\u975e\u96f6\u5143\u7d20\u3002\u6bd4\u8f83CSR\u548cCOO\u683c\u5f0f\u7684\u5185\u5b58\u5f00\u9500\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u7d22\u5f15\u5b58\u50a8\u7684\u5f00\u9500\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>CSR\u683c\u5f0f\uff1a</p>\n<ul>\n<li>\u503c\u6570\u7ec4\uff1a$10^7 \\times 8$ \u5b57\u8282\uff08double\uff09</li>\n<li>\u5217\u7d22\u5f15\uff1a$10^7 \\times 4$ \u5b57\u8282\uff08int\uff09</li>\n<li>\u884c\u6307\u9488\uff1a$(10^6 + 1) \\times 4$ \u5b57\u8282</li>\n<li>\u603b\u8ba1\uff1a\u7ea6124 MB</li>\n</ul>\n<p>COO\u683c\u5f0f\uff1a</p>\n<ul>\n<li>\u503c\u6570\u7ec4\uff1a$10^7 \\times 8$ \u5b57\u8282</li>\n<li>\u884c\u7d22\u5f15\uff1a$10^7 \\times 4$ \u5b57\u8282</li>\n<li>\u5217\u7d22\u5f15\uff1a$10^7 \\times 4$ \u5b57\u8282</li>\n<li>\u603b\u8ba1\uff1a\u7ea6160 MB</li>\n</ul>\n<p>CSR\u8282\u7701\u7ea622.5%\u7684\u5185\u5b58\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6020.3</strong> \u5728NUMA\u7cfb\u7edf\u4e0a\uff0c\u77e9\u9635 $A$ \u5206\u5e03\u57284\u4e2a\u8282\u70b9\u4e0a\u3002\u8bbe\u8ba1\u4e00\u79cd\u6570\u636e\u5206\u5e03\u7b56\u7565\uff0c\u4f7f\u5f97 $y = Ax$ \u7684\u8ba1\u7b97\u6700\u5c0f\u5316\u8de8\u8282\u70b9\u8bbf\u95ee\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u884c\u5206\u5757\u4e0e\u5217\u5206\u5757\u7684trade-off\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6700\u4f18\u7b56\u7565\uff1a1D\u884c\u5206\u5757</p>\n<ul>\n<li>\u5c06\u77e9\u9635 $A$ \u6309\u884c\u5747\u5300\u5206\u914d\u52304\u4e2a\u8282\u70b9</li>\n<li>\u5411\u91cf $x$ \u590d\u5236\u5230\u6240\u6709\u8282\u70b9</li>\n<li>\u6bcf\u4e2a\u8282\u70b9\u8ba1\u7b97\u5c40\u90e8 $y_i = A_i x$</li>\n<li>\u7ed3\u679c $y$ \u81ea\u7136\u5206\u5e03\u5728\u5404\u8282\u70b9</li>\n</ul>\n<p>\u4f18\u70b9\uff1a\u65e0\u8de8\u8282\u70b9\u7684\u77e9\u9635\u6570\u636e\u8bbf\u95ee\uff0c\u4ec5\u9700\u5e7f\u64ad\u5411\u91cf$x$\uff08\u901a\u4fe1\u91cf$O(n)$\uff09\u3002</p>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u7ec3\u4e6020.4</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7cbe\u5ea6\u7684\u77e9\u9635\u5206\u89e3\u7b97\u6cd5\uff0c\u5728\u4fdd\u8bc1 $|A - LU|_F &lt; \\epsilon$ \u7684\u524d\u63d0\u4e0b\u6700\u5927\u5316\u4f7f\u7528\u4f4e\u7cbe\u5ea6\u8ba1\u7b97\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4e0d\u540c\u77e9\u9635\u5757\u7684\u6761\u4ef6\u6570\u5dee\u5f02\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u7b56\u7565\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u4f7f\u7528FP16\u8fdb\u884c\u5206\u89e3</li>\n<li>\u8ba1\u7b97\u6b8b\u5dee $R = A - LU$</li>\n<li>\u8bc6\u522b\u9ad8\u6b8b\u5dee\u5757\uff1a$|R_{ij}|_F &gt; \\epsilon_{local}$</li>\n<li>\u5bf9\u8fd9\u4e9b\u5757\u4f7f\u7528FP32\u91cd\u65b0\u8ba1\u7b97</li>\n<li>\u8fed\u4ee3\u76f4\u5230\u5168\u5c40\u8bef\u5dee\u6ee1\u8db3\u8981\u6c42</li>\n</ol>\n<p>\u5173\u952e\u521b\u65b0\uff1a</p>\n<ul>\n<li>\u5757\u7ea7\u6761\u4ef6\u6570\u4f30\u8ba1\uff1a$\\kappa_{ij} \\approx |A_{ij}|_2 |A_{ij}^{-1}|_2$</li>\n<li>\u52a8\u6001\u7cbe\u5ea6\u6620\u5c04\u8868</li>\n<li>\u8bef\u5dee\u4f20\u64ad\u63a7\u5236</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e6020.5</strong> \u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u5b9e\u73b0\u4e00\u4e2a\u901a\u4fe1\u907f\u514d\u7684QR\u5206\u89e3\uff0c\u5206\u6790\u5176\u901a\u4fe1\u590d\u6742\u5ea6\u76f8\u6bd4\u4f20\u7edf\u65b9\u6cd5\u7684\u6539\u8fdb\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u7814\u7a76TSQR\uff08Tall Skinny QR\uff09\u7b97\u6cd5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>TSQR\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u5c40\u90e8QR\uff1a\u6bcf\u4e2a\u5904\u7406\u5668\u8ba1\u7b97 $A_i = Q_i R_i$</li>\n<li>\u6811\u5f62\u5f52\u7ea6\uff1a$R = \\prod R_i$ \u7684QR\u5206\u89e3</li>\n<li>\u540e\u5411\u4f20\u64ad\u66f4\u65b0Q</li>\n</ol>\n<p>\u901a\u4fe1\u590d\u6742\u5ea6\u5206\u6790\uff1a</p>\n<ul>\n<li>\u4f20\u7edf\u65b9\u6cd5\uff1a$O(n \\log P)$ \u8f6e\u901a\u4fe1\uff0c\u6bcf\u8f6e $O(n)$ \u6570\u636e</li>\n<li>TSQR\uff1a$O(\\log P)$ \u8f6e\u901a\u4fe1\uff0c\u6bcf\u8f6e $O(n)$ \u6570\u636e</li>\n<li>\u6539\u8fdb\u56e0\u5b50\uff1a$O(n)$</li>\n</ul>\n<p>\u5e26\u5bbd\u9700\u6c42\u4ece $O(n^2 \\log P)$ \u964d\u81f3 $O(n^2)$\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6020.6</strong> \u9488\u5bf9\u77e9\u9635\u8fde\u4e58 $A_1 A_2 ... A_k$\uff0c\u8bbe\u8ba1\u4e00\u4e2acache-oblivious\u7b97\u6cd5\uff0c\u65e0\u9700\u663e\u5f0f\u7f13\u5b58\u53c2\u6570\u5373\u53ef\u8fbe\u5230\u6700\u4f18\u7f13\u5b58\u590d\u6742\u5ea6\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u5206\u6cbb\u7b56\u7565\u548cStrassen\u98ce\u683c\u7684\u9012\u5f52\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Cache-oblivious\u77e9\u9635\u94fe\u4e58\u6cd5\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">MatrixChain</span><span class=\"p\">(</span>A[], i, j<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nb\">i</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"nb\">j</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"p\">[</span><span class=\"nb\">i</span><span class=\"p\">]</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u5bfb\u627e\u6700\u4f18\u5206\u5272\u70b9\uff08\u52a8\u6001\u89c4\u5212\uff09\n<span class=\"w\">    </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">OptimalSplit</span><span class=\"p\">(</span><span class=\"nb\">i</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">j</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u9012\u5f52\u8ba1\u7b97\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nb\">j</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nb\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">threshold</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span>\u4f20\u7edf\u4e58\u6cd5<span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">[</span><span class=\"nb\">i</span><span class=\"p\">..</span><span class=\"n\">j</span><span class=\"p\">])</span>\n<span class=\"w\">    </span><span class=\"k\">else</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">MatrixChain</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">i</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">MatrixChain</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">j</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">CacheObliviousMM</span><span class=\"p\">(</span><span class=\"n\">L</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p>\u5173\u952e\u7279\u6027\uff1a</p>\n<ul>\n<li>\u81ea\u52a8\u9002\u5e94\u4efb\u610f\u7f13\u5b58\u5c42\u6b21</li>\n<li>\u9012\u5f52\u6df1\u5ea6 $O(\\log n)$ \u4fdd\u8bc1\u6808\u5f00\u9500\u53ef\u63a7</li>\n<li>\u7f13\u5b58\u590d\u6742\u5ea6\uff1a$O(n^3/\\sqrt{M})$\uff0c\u5176\u4e2dM\u662f\u7f13\u5b58\u5927\u5c0f</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e6020.7</strong> \u5f00\u53d1\u4e00\u4e2a\u6027\u80fd\u6a21\u578b\uff0c\u9884\u6d4b\u7ed9\u5b9a\u786c\u4ef6\u914d\u7f6e\u4e0b\u77e9\u9635\u8fd0\u7b97\u7684\u5b9e\u9645\u6027\u80fd\uff0c\u8003\u8651\u5185\u5b58\u5e26\u5bbd\u3001\u7f13\u5b58\u5927\u5c0f\u3001\u5e76\u884c\u5ea6\u7b49\u56e0\u7d20\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u7ed3\u5408Roofline\u6a21\u578b\u548c\u6392\u961f\u8bba\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5c42\u6b21\u5316\u6027\u80fd\u6a21\u578b\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u5bc6\u96c6\u5ea6\uff1a$I = \\frac{Flops}{Bytes}$</li>\n<li>\u6709\u6548\u5e26\u5bbd\uff1a$B_{eff} = B_{peak} \\times \\eta_{mem}$\uff0c\u5176\u4e2d$\\eta_{mem}$\u662f\u5185\u5b58\u6548\u7387</li>\n<li>\u5e76\u884c\u6548\u7387\uff1a$\\eta_{par} = \\frac{1}{1 + \\alpha(P-1)}$\uff0c$\\alpha$\u662f\u540c\u6b65\u5f00\u9500</li>\n</ol>\n<p>\u7efc\u5408\u6a21\u578b\uff1a\n$$P_{actual} = \\min\\left(P_{peak} \\times \\eta_{par}, I \\times B_{eff}\\right) \\times \\eta_{cache}$$\n\u5176\u4e2d $\\eta_{cache}$ \u901a\u8fc7\u7f13\u5b58\u672a\u547d\u4e2d\u7387\u5efa\u6a21\uff1a\n$$\\eta_{cache} = 1 - \\sum_{i=1}^{L} miss_rate_i \\times penalty_i$$\n\u9a8c\u8bc1\uff1a\u4e0e\u5b9e\u6d4b\u6027\u80fd\u8bef\u5dee\u901a\u5e38\u572815%\u4ee5\u5185\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e6020.8</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u52a8\u8c03\u4f18\u6846\u67b6\uff0c\u80fd\u591f\u4e3a\u7279\u5b9a\u786c\u4ef6\u5e73\u53f0\u627e\u5230\u6700\u4f18\u7684\u77e9\u9635\u8fd0\u7b97\u53c2\u6570\uff08\u5757\u5927\u5c0f\u3001\u5e76\u884c\u5ea6\u3001\u6570\u636e\u5e03\u5c40\u7b49\uff09\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u8d1d\u53f6\u65af\u4f18\u5316\u6216\u5f3a\u5316\u5b66\u4e60\u65b9\u6cd5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u52a8\u8c03\u4f18\u6846\u67b6\u8bbe\u8ba1\uff1a</p>\n<ol>\n<li>\n<p><strong>\u53c2\u6570\u7a7a\u95f4\u5b9a\u4e49</strong>\uff1a\n   - \u5757\u5927\u5c0f\uff1a$B \\in {16, 32, 64, ..., 512}$\n   - \u5e76\u884c\u7ebf\u7a0b\uff1a$T \\in {1, 2, 4, ..., #cores}$\n   - \u6570\u636e\u5e03\u5c40\uff1a{row-major, column-major, blocked}</p>\n</li>\n<li>\n<p><strong>\u641c\u7d22\u7b56\u7565</strong>\uff1a\n   - \u521d\u59cb\u91c7\u6837\uff1aLatin Hypercube Sampling\n   - \u8d1d\u53f6\u65af\u4f18\u5316\uff1aGaussian Process\u5efa\u6a21\u6027\u80fd\n   - Acquisition function\uff1aExpected Improvement</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u9884\u6d4b\u6a21\u578b</strong>\uff1a\n$$f(B, T, L) = \\alpha_1 \\log B + \\alpha_2 T + \\alpha_3 L + interactions$$</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u9002\u5e94</strong>\uff1a\n   - \u8fd0\u884c\u65f6\u76d1\u6d4b\u6027\u80fd\u8ba1\u6570\u5668\n   - \u52a8\u6001\u8c03\u6574\u53c2\u6570\n   - \u589e\u91cf\u5b66\u4e60\u66f4\u65b0\u6a21\u578b</p>\n</li>\n</ol>\n<p>\u5178\u578b\u6539\u8fdb\uff1a\u76f8\u6bd4\u9ed8\u8ba4\u53c2\u6570\u63d0\u53472-5\u500d\u6027\u80fd\u3002</p>\n</details>\n<h2 id=\"_5\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<h3 id=\"_6\">\u5185\u5b58\u76f8\u5173\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>False Sharing</strong>\n   - \u95ee\u9898\uff1a\u4e0d\u540c\u7ebf\u7a0b\u4fee\u6539\u540c\u4e00cache line\u7684\u4e0d\u540c\u90e8\u5206\n   - \u75c7\u72b6\uff1a\u591a\u7ebf\u7a0b\u6027\u80fd\u53cd\u800c\u4e0b\u964d\n   - \u89e3\u51b3\uff1a\u4f7f\u7528padding\u6216thread-local\u5b58\u50a8</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u6cc4\u6f0f\u7684\u9690\u853d\u5f62\u5f0f</strong>\n   - \u95ee\u9898\uff1a\u4e34\u65f6\u77e9\u9635\u5728\u5f02\u5e38\u8def\u5f84\u672a\u91ca\u653e\n   - \u75c7\u72b6\uff1a\u957f\u65f6\u95f4\u8fd0\u884c\u540e\u6027\u80fd\u4e0b\u964d\n   - \u89e3\u51b3\uff1aRAII\u6a21\u5f0f\u6216\u667a\u80fd\u6307\u9488</p>\n</li>\n<li>\n<p><strong>NUMA\u4e0d\u611f\u77e5\u5206\u914d</strong>\n   - \u95ee\u9898\uff1a\u6570\u636e\u5206\u914d\u4e0e\u8ba1\u7b97\u4f4d\u7f6e\u4e0d\u5339\u914d\n   - \u75c7\u72b6\uff1a\u5185\u5b58\u5e26\u5bbd\u8fdc\u4f4e\u4e8e\u7406\u8bba\u503c\n   - \u89e3\u51b3\uff1aFirst-touch\u521d\u59cb\u5316\u6216\u663e\u5f0fNUMA\u7ed1\u5b9a</p>\n</li>\n</ol>\n<h3 id=\"_7\">\u5e76\u884c\u5316\u9677\u9631</h3>\n<ol start=\"4\">\n<li>\n<p><strong>\u8fc7\u5ea6\u5e76\u884c\u5316</strong>\n   - \u95ee\u9898\uff1a\u7ebf\u7a0b\u6570\u8d85\u8fc7\u6709\u6548\u5e76\u884c\u5ea6\n   - \u75c7\u72b6\uff1a\u7ebf\u7a0b\u5207\u6362\u5f00\u9500\u5927\u4e8e\u8ba1\u7b97\u6536\u76ca\n   - \u89e3\u51b3\uff1a\u52a8\u6001\u8c03\u6574\u7ebf\u7a0b\u6c60\u5927\u5c0f</p>\n</li>\n<li>\n<p><strong>\u8d1f\u8f7d\u4e0d\u5747\u8861\u7684\u7ec6\u5fae\u60c5\u5f62</strong>\n   - \u95ee\u9898\uff1a\u77e9\u9635\u7ed3\u6784\u5bfc\u81f4\u7684\u8ba1\u7b97\u91cf\u5dee\u5f02\n   - \u75c7\u72b6\uff1a\u90e8\u5206\u7ebf\u7a0b\u63d0\u524d\u7ed3\u675f\uff0c\u5176\u4ed6\u7ebf\u7a0b\u6210\u4e3a\u74f6\u9888\n   - \u89e3\u51b3\uff1a\u5de5\u4f5c\u7a83\u53d6\u6216\u52a8\u6001\u8c03\u5ea6</p>\n</li>\n<li>\n<p><strong>\u540c\u6b65\u539f\u8bed\u8bef\u7528</strong>\n   - \u95ee\u9898\uff1a\u4f7f\u7528mutex\u4fdd\u62a4\u53ea\u8bfb\u6570\u636e\n   - \u75c7\u72b6\uff1a\u4e0d\u5fc5\u8981\u7684\u4e32\u884c\u5316\n   - \u89e3\u51b3\uff1a\u8bfb\u5199\u9501\u6216\u65e0\u9501\u6570\u636e\u7ed3\u6784</p>\n</li>\n</ol>\n<h3 id=\"_8\">\u6570\u503c\u7a33\u5b9a\u6027\u9677\u9631</h3>\n<ol start=\"7\">\n<li>\n<p><strong>\u6761\u4ef6\u6570\u7206\u70b8\u7684\u5ffd\u89c6</strong>\n   - \u95ee\u9898\uff1a\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u6761\u4ef6\u6570\u6307\u6570\u589e\u957f\n   - \u75c7\u72b6\uff1a\u7ed3\u679c\u5b8c\u5168\u5931\u771f\n   - \u89e3\u51b3\uff1a\u5b9a\u671f\u91cd\u6b63\u4ea4\u5316\u6216\u9884\u6761\u4ef6\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u7684\u8bef\u5dee\u7d2f\u79ef</strong>\n   - \u95ee\u9898\uff1a\u4f4e\u7cbe\u5ea6\u8bef\u5dee\u5728\u8fed\u4ee3\u4e2d\u653e\u5927\n   - \u75c7\u72b6\uff1a\u6536\u655b\u505c\u6ede\u6216\u53d1\u6563\n   - \u89e3\u51b3\uff1a\u5173\u952e\u8def\u5f84\u4f7f\u7528\u9ad8\u7cbe\u5ea6</p>\n</li>\n</ol>\n<h3 id=\"_9\">\u6027\u80fd\u5206\u6790\u9677\u9631</h3>\n<ol start=\"9\">\n<li>\n<p><strong>\u5fae\u57fa\u51c6\u6d4b\u8bd5\u7684\u8bef\u5bfc</strong>\n   - \u95ee\u9898\uff1a\u6d4b\u8bd5\u573a\u666f\u8fc7\u4e8e\u7406\u60f3\u5316\n   - \u75c7\u72b6\uff1a\u5b9e\u9645\u5e94\u7528\u6027\u80fd\u8fdc\u4f4e\u4e8e\u6d4b\u8bd5\n   - \u89e3\u51b3\uff1a\u4f7f\u7528\u771f\u5b9e\u6570\u636e\u548c\u8bbf\u95ee\u6a21\u5f0f</p>\n</li>\n<li>\n<p><strong>\u5ffd\u89c6\u9884\u70ed\u6548\u5e94</strong></p>\n<ul>\n<li>\u95ee\u9898\uff1a\u51b7\u542f\u52a8\u5f71\u54cd\u6d4b\u91cf\u51c6\u786e\u6027</li>\n<li>\u75c7\u72b6\uff1a\u6027\u80fd\u6570\u636e\u65b9\u5dee\u8fc7\u5927</li>\n<li>\u89e3\u51b3\uff1a\u9002\u5f53\u7684\u9884\u70ed\u8fed\u4ee3</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"_10\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_11\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5206\u6790\u7b97\u6cd5\u7684\u8ba1\u7b97\u5bc6\u96c6\u5ea6\uff08arithmetic intensity\uff09</li>\n<li>[ ] \u8bc4\u4f30\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u7684\u89c4\u5f8b\u6027</li>\n<li>[ ] \u8003\u8651\u6570\u503c\u7a33\u5b9a\u6027\u9700\u6c42</li>\n<li>[ ] \u8bbe\u8ba1\u5bb9\u9519\u548c\u6062\u590d\u673a\u5236</li>\n</ul>\n<h3 id=\"_12\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u6570\u636e\u7ed3\u6784\u548c\u5b58\u50a8\u683c\u5f0f</li>\n<li>[ ] \u5b9e\u73b0\u591a\u7ea7\u5206\u5757\u7b56\u7565</li>\n<li>[ ] \u6dfb\u52a0\u5411\u91cf\u5316\u53cb\u597d\u7684\u4ee3\u7801\u6807\u6ce8</li>\n<li>[ ] \u9884\u7559\u6027\u80fd\u5173\u952e\u53c2\u6570\u7684\u8c03\u4f18\u63a5\u53e3</li>\n</ul>\n<h3 id=\"_13\">\u4f18\u5316\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u4f7f\u7528profiler\u8bc6\u522b\u6027\u80fd\u74f6\u9888</li>\n<li>[ ] \u9a8c\u8bc1\u7f13\u5b58\u547d\u4e2d\u7387\u548c\u5185\u5b58\u5e26\u5bbd\u5229\u7528\u7387</li>\n<li>[ ] \u6d4b\u8bd5\u4e0d\u540c\u95ee\u9898\u89c4\u6a21\u7684\u6269\u5c55\u6027</li>\n<li>[ ] \u68c0\u67e5\u5e76\u884c\u6548\u7387\u548c\u8d1f\u8f7d\u5747\u8861</li>\n</ul>\n<h3 id=\"_14\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u9488\u5bf9\u76ee\u6807\u786c\u4ef6\u8fdb\u884c\u53c2\u6570\u8c03\u4f18</li>\n<li>[ ] \u8bbe\u7f6e\u6027\u80fd\u76d1\u63a7\u548c\u544a\u8b66</li>\n<li>[ ] \u51c6\u5907\u6027\u80fd\u9000\u5316\u7684\u5e94\u5bf9\u65b9\u6848</li>\n<li>[ ] \u6587\u6863\u5316\u6027\u80fd\u7279\u5f81\u548c\u9650\u5236</li>\n</ul>\n<h3 id=\"_15\">\u6301\u7eed\u6539\u8fdb</h3>\n<ul>\n<li>[ ] \u6536\u96c6\u751f\u4ea7\u73af\u5883\u7684\u6027\u80fd\u6570\u636e</li>\n<li>[ ] \u5b9a\u671f\u8bc4\u4f30\u65b0\u786c\u4ef6\u7279\u6027\u7684\u5229\u7528</li>\n<li>[ ] \u8ddf\u8e2a\u6570\u503c\u7b97\u6cd5\u7684\u6700\u65b0\u8fdb\u5c55</li>\n<li>[ ] \u7ef4\u62a4\u6027\u80fd\u56de\u5f52\u6d4b\u8bd5\u5957\u4ef6</li>\n</ul>\n<h2 id=\"_16\">\u6df1\u5165\u7814\u7a76\u65b9\u5411</h2>\n<ol>\n<li><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6\u8ba1\u7b97\u6846\u67b6</strong>\uff1a\u5982\u4f55\u81ea\u52a8\u786e\u5b9a\u4e0d\u540c\u8ba1\u7b97\u9636\u6bb5\u7684\u6700\u4f18\u7cbe\u5ea6\uff1f</li>\n<li><strong>\u901a\u4fe1\u907f\u514d\u7b97\u6cd5\u7684\u6781\u9650</strong>\uff1a\u662f\u5426\u5b58\u5728\u901a\u7528\u7684\u901a\u4fe1\u4e0b\u754c\uff1f</li>\n<li><strong>\u5f02\u6784\u8ba1\u7b97\u7684\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\u5982\u4f55\u5728CPU/GPU/FPGA\u95f4\u52a8\u6001\u5206\u914d\u4efb\u52a1\uff1f</li>\n<li><strong>\u91cf\u5b50-\u7ecf\u5178\u6df7\u5408\u7b97\u6cd5</strong>\uff1a\u5982\u4f55\u8bbe\u8ba1\u8fc7\u6e21\u671f\u7684\u6df7\u5408\u8ba1\u7b97\u6846\u67b6\uff1f</li>\n<li><strong>\u795e\u7ecf\u7f51\u7edc\u8f85\u52a9\u7684\u6027\u80fd\u9884\u6d4b</strong>\uff1a\u80fd\u5426\u7528\u6df1\u5ea6\u5b66\u4e60\u9884\u6d4b\u4f18\u5316\u53c2\u6570\uff1f</li>\n</ol>"
  },
  "../chapter10.md": {
    "hash": "e75cc68214e879a835fc15c54396f8f0",
    "content": "<h1 id=\"10riemannian\">\u7b2c10\u7ae0\uff1aRiemannian\u4f18\u5316\u57fa\u7840</h1>\n<p>\u8bb8\u591a\u5927\u89c4\u6a21\u77e9\u9635\u4f18\u5316\u95ee\u9898\u5929\u7136\u5730\u5b9a\u4e49\u5728\u5177\u6709\u7279\u5b9a\u51e0\u4f55\u7ed3\u6784\u7684\u7ea6\u675f\u96c6\u4e0a\u3002\u4f20\u7edf\u7684\u6b27\u6c0f\u7a7a\u95f4\u4f18\u5316\u65b9\u6cd5\u9700\u8981\u53cd\u590d\u6295\u5f71\u4ee5\u7ef4\u6301\u7ea6\u675f\uff0c\u800cRiemannian\u4f18\u5316\u76f4\u63a5\u5728\u7ea6\u675f\u6d41\u5f62\u4e0a\u5de5\u4f5c\uff0c\u5c06\u7ea6\u675f\u9690\u5f0f\u5730\u7f16\u7801\u5728\u6d41\u5f62\u7684\u51e0\u4f55\u7ed3\u6784\u4e2d\u3002\u672c\u7ae0\u4ecb\u7ecd\u6d41\u5f62\u4f18\u5316\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u91cd\u70b9\u5173\u6ce8\u5728\u673a\u5668\u5b66\u4e60\u548c\u6570\u503c\u8ba1\u7b97\u4e2d\u5e38\u89c1\u7684\u77e9\u9635\u6d41\u5f62\u3002\u6211\u4eec\u5c06\u63a2\u8ba8\u5982\u4f55\u5229\u7528\u6d41\u5f62\u7684\u5185\u5728\u51e0\u4f55\u7ed3\u6784\u8bbe\u8ba1\u9ad8\u6548\u7684\u4f18\u5316\u7b97\u6cd5\uff0c\u4ee5\u53ca\u8fd9\u4e9b\u65b9\u6cd5\u5728\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u7b49\u5b9e\u9645\u95ee\u9898\u4e2d\u7684\u5e94\u7528\u3002</p>\n<h2 id=\"101\">10.1 \u77e9\u9635\u6d41\u5f62\u4e0a\u7684\u51e0\u4f55\u7ed3\u6784</h2>\n<p>\u77e9\u9635\u6d41\u5f62\u662f\u6ee1\u8db3\u7279\u5b9a\u4ee3\u6570\u7ea6\u675f\u7684\u77e9\u9635\u96c6\u5408\uff0c\u914d\u5907\u4e86\u4f7f\u5176\u6210\u4e3a\u5149\u6ed1\u6d41\u5f62\u7684\u5fae\u5206\u7ed3\u6784\u3002\u7406\u89e3\u8fd9\u4e9b\u6d41\u5f62\u7684\u51e0\u4f55\u6027\u8d28\u662f\u8bbe\u8ba1\u9ad8\u6548\u4f18\u5316\u7b97\u6cd5\u7684\u57fa\u7840\u3002\u6d41\u5f62\u4f18\u5316\u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5c06\u7ea6\u675f\u9690\u5f0f\u7f16\u7801\u5728\u51e0\u4f55\u7ed3\u6784\u4e2d\uff0c\u4ece\u800c\u907f\u514d\u4e86\u4f20\u7edf\u65b9\u6cd5\u4e2d\u53cd\u590d\u6295\u5f71\u7684\u8ba1\u7b97\u5f00\u9500\u3002</p>\n<h3 id=\"1011\">10.1.1 \u5e38\u89c1\u7684\u77e9\u9635\u6d41\u5f62</h3>\n<p><strong>Stiefel\u6d41\u5f62</strong> $\\mathcal{V}_k(\\mathbb{R}^n)$\uff1a\u6240\u6709$n \\times k$\u5217\u6b63\u4ea4\u77e9\u9635\u7684\u96c6\u5408\n$$\\mathcal{V}_k(\\mathbb{R}^n) = {\\mathbf{X} \\in \\mathbb{R}^{n \\times k} : \\mathbf{X}^T\\mathbf{X} = \\mathbf{I}_k}$$\n\u5f53$k = n$\u65f6\uff0cStiefel\u6d41\u5f62\u9000\u5316\u4e3a\u6b63\u4ea4\u7fa4$O(n)$\u3002\u5f53$k = 1$\u65f6\uff0c\u5f97\u5230\u5355\u4f4d\u7403\u9762$S^{n-1}$\u3002Stiefel\u6d41\u5f62\u5728\u4e3b\u6210\u5206\u5206\u6790\u3001\u6b63\u4ea4Procrustes\u95ee\u9898\u3001\u7279\u5f81\u503c\u8ba1\u7b97\u548c\u6df1\u5ea6\u5b66\u4e60\u7684\u6b63\u4ea4\u521d\u59cb\u5316\u4e2d\u5e7f\u6cdb\u5e94\u7528\u3002\u5176\u7ef4\u6570\u4e3a$nk - k(k+1)/2$\uff0c\u53cd\u6620\u4e86\u6b63\u4ea4\u7ea6\u675f\u7684\u6570\u91cf\u3002</p>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1aStiefel\u6d41\u5f62\u4e0a\u7684\u6982\u7387\u5206\u5e03\uff08\u5982von Mises-Fisher\u5206\u5e03\uff09\u5728\u65b9\u5411\u7edf\u8ba1\u548c\u8d1d\u53f6\u65af\u63a8\u65ad\u4e2d\u6709\u91cd\u8981\u5e94\u7528\uff0c\u4f46\u9ad8\u7ef4\u60c5\u51b5\u4e0b\u7684\u91c7\u6837\u7b97\u6cd5\u4ecd\u9700\u6539\u8fdb\u3002</p>\n<p><strong>Grassmann\u6d41\u5f62</strong> $\\mathcal{G}_k(\\mathbb{R}^n)$\uff1a$\\mathbb{R}^n$\u4e2d\u6240\u6709$k$\u7ef4\u5b50\u7a7a\u95f4\u7684\u96c6\u5408\u3002\u53ef\u4ee5\u89c6\u4e3aStiefel\u6d41\u5f62\u5728\u6b63\u4ea4\u7b49\u4ef7\u5173\u7cfb\u4e0b\u7684\u5546\u7a7a\u95f4\uff1a\n$$\\mathcal{G}_k(\\mathbb{R}^n) = \\mathcal{V}_k(\\mathbb{R}^n) / O(k)$$\nGrassmann\u6d41\u5f62\u7684\u7ef4\u6570\u4e3a$k(n-k)$\uff0c\u6bd4Stiefel\u6d41\u5f62\u4f4e\uff0c\u8fd9\u79cd\u7ef4\u6570\u7f29\u51cf\u6765\u6e90\u4e8e\u6d88\u9664\u4e86\u5b50\u7a7a\u95f4\u57fa\u7684\u9009\u62e9\u81ea\u7531\u5ea6\u3002\u5728\u5b50\u7a7a\u95f4\u8ffd\u8e2a\u3001\u964d\u7ef4\u3001\u8ba1\u7b97\u673a\u89c6\u89c9\uff08\u5982\u591a\u89c6\u89d2\u51e0\u4f55\uff09\u548c\u91cf\u5b50\u4fe1\u606f\u7406\u8bba\u4e2d\u626e\u6f14\u91cd\u8981\u89d2\u8272\u3002</p>\n<p><strong>\u56fa\u5b9a\u79e9\u77e9\u9635\u6d41\u5f62</strong> $\\mathcal{M}_r^{m \\times n}$\uff1a\u6240\u6709\u79e9\u4e3a$r$\u7684$m \\times n$\u77e9\u9635\u7684\u96c6\u5408\n$$\\mathcal{M}_r^{m \\times n} = {\\mathbf{X} \\in \\mathbb{R}^{m \\times n} : \\text{rank}(\\mathbf{X}) = r}$$\n\u8fd9\u662f\u4e00\u4e2a$(m + n - r)r$\u7ef4\u7684\u5d4c\u5165\u5b50\u6d41\u5f62\uff0c\u5728\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u3001\u6a21\u578b\u538b\u7f29\u548c\u7cfb\u7edf\u8bc6\u522b\u4e2d\u81f3\u5173\u91cd\u8981\u3002\u56fa\u5b9a\u79e9\u6d41\u5f62\u4e0d\u662f\u95ed\u96c6\uff08\u5176\u95ed\u5305\u5305\u542b\u66f4\u4f4e\u79e9\u7684\u77e9\u9635\uff09\uff0c\u8fd9\u7ed9\u6570\u503c\u8ba1\u7b97\u5e26\u6765\u72ec\u7279\u6311\u6218\u3002</p>\n<p><strong>\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\u9525</strong> $\\mathcal{S}_{++}^n$\uff1a\u6240\u6709$n \\times n$\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\u7684\u96c6\u5408\u3002\u867d\u7136\u6280\u672f\u4e0a\u662f\u5f00\u96c6\u800c\u975e\u6d41\u5f62\uff0c\u4f46\u53ef\u4ee5\u8d4b\u4e88\u5176\u591a\u79cdRiemannian\u51e0\u4f55\u7ed3\u6784\uff1a</p>\n<ul>\n<li>\u6807\u51c6\u6b27\u6c0f\u5ea6\u91cf\uff1a\u7ee7\u627f\u81ea\u77e9\u9635\u7a7a\u95f4</li>\n<li>\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf\uff1a$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\text{tr}(\\mathbf{X}^{-1}\\boldsymbol{\\xi}\\mathbf{X}^{-1}\\boldsymbol{\\eta})$</li>\n<li>Log-Euclidean\u5ea6\u91cf\uff1a\u901a\u8fc7\u77e9\u9635\u5bf9\u6570\u6620\u5c04\u5230\u6b27\u6c0f\u7a7a\u95f4</li>\n</ul>\n<p>\u5728\u534f\u65b9\u5dee\u77e9\u9635\u4f30\u8ba1\u3001\u5ea6\u91cf\u5b66\u4e60\u3001\u8111\u7535\u56fe\u4fe1\u53f7\u5904\u7406\u548c\u91d1\u878d\u98ce\u9669\u5efa\u6a21\u4e2d\u5e94\u7528\u5e7f\u6cdb\u3002</p>\n<p><strong>\u5176\u4ed6\u91cd\u8981\u6d41\u5f62</strong>\uff1a</p>\n<ul>\n<li><strong>\u5bf9\u79f0\u77e9\u9635\u6d41\u5f62</strong> $\\mathcal{S}^n$\uff1a\u56fe\u62c9\u666e\u62c9\u65af\u4f18\u5316\u3001\u8c31\u805a\u7c7b</li>\n<li><strong>\u659c\u5bf9\u79f0\u77e9\u9635\u6d41\u5f62</strong> $\\mathfrak{so}(n)$\uff1a\u521a\u4f53\u52a8\u529b\u5b66\u3001\u674e\u7fa4\u7b97\u6cd5</li>\n<li><strong>\u5355\u4f4d\u5bf9\u89d2\u5360\u4f18\u77e9\u9635\u6d41\u5f62</strong>\uff1a\u9a6c\u5c14\u53ef\u592b\u94fe\u3001\u968f\u673a\u77e9\u9635\u7406\u8bba</li>\n<li><strong>\u53cc\u968f\u673a\u77e9\u9635\u6d41\u5f62</strong>\uff1a\u6700\u4f18\u4f20\u8f93\u3001\u56fe\u5339\u914d</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u6df7\u5408\u7ea6\u675f\u6d41\u5f62\uff08\u5982\u540c\u65f6\u6ee1\u8db3\u6b63\u4ea4\u6027\u548c\u7a00\u758f\u6027\u7ea6\u675f\uff09\u7684\u51e0\u4f55\u7ed3\u6784\u548c\u7b97\u6cd5\u8bbe\u8ba1\u662f\u4e00\u4e2a\u6d3b\u8dc3\u7684\u7814\u7a76\u65b9\u5411\u3002</p>\n<h3 id=\"1012\">10.1.2 \u5207\u7a7a\u95f4\u7684\u523b\u753b</h3>\n<p>\u5207\u7a7a\u95f4$T_{\\mathbf{X}}\\mathcal{M}$\u662f\u6d41\u5f62$\\mathcal{M}$\u5728\u70b9$\\mathbf{X}$\u5904\u7684\u7ebf\u6027\u5316\uff0c\u5305\u542b\u4e86\u6240\u6709\u53ef\u884c\u7684\"\u65e0\u7a77\u5c0f\u79fb\u52a8\u65b9\u5411\"\u3002\u7406\u89e3\u5207\u7a7a\u95f4\u7684\u7ed3\u6784\u5bf9\u4e8e\u68af\u5ea6\u8ba1\u7b97\u3001\u7ea6\u675f\u4fdd\u6301\u548c\u7b97\u6cd5\u8bbe\u8ba1\u81f3\u5173\u91cd\u8981\u3002\u5207\u7a7a\u95f4\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u7b49\u4ef7\u65b9\u5f0f\u523b\u753b\uff1a\u901f\u5ea6\u5411\u91cf\u3001\u7ea6\u675f\u7684\u6838\u7a7a\u95f4\u6216\u5c40\u90e8\u53c2\u6570\u5316\u7684\u5bfc\u6570\u50cf\u3002</p>\n<p><strong>\u51e0\u4f55\u76f4\u89c9</strong>\uff1a\u60f3\u8c61\u6d41\u5f62\u4e3a\u5d4c\u5165\u5728\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u66f2\u9762\uff0c\u5207\u7a7a\u95f4\u5c31\u662f\u5728\u67d0\u70b9\u5904\"\u8d34\u5408\"\u6d41\u5f62\u7684\u5e73\u9762\u3002\u8fd9\u4e2a\u5e73\u9762\u5305\u542b\u4e86\u6240\u6709\u5728\u8be5\u70b9\u5904\u6cbf\u6d41\u5f62\u7684\u53ef\u80fd\u79fb\u52a8\u65b9\u5411\u3002\u5bf9\u4e8e\u7ea6\u675f\u4f18\u5316\uff0c\u5207\u7a7a\u95f4\u6b63\u662f\u6ee1\u8db3\u7ebf\u6027\u5316\u7ea6\u675f\u7684\u65b9\u5411\u96c6\u5408\u3002</p>\n<p><strong>Stiefel\u6d41\u5f62\u7684\u5207\u7a7a\u95f4</strong>\uff1a\n$$T_{\\mathbf{X}}\\mathcal{V}_k(\\mathbb{R}^n) = {\\boldsymbol{\\xi} \\in \\mathbb{R}^{n \\times k} : \\mathbf{X}^T\\boldsymbol{\\xi} + \\boldsymbol{\\xi}^T\\mathbf{X} = \\mathbf{0}}$$\n\u8fd9\u4e2a\u6761\u4ef6\u786e\u4fdd$\\mathbf{X} + t\\boldsymbol{\\xi}$\u5728\u4e00\u9636\u8fd1\u4f3c\u4e0b\u4fdd\u6301\u5217\u6b63\u4ea4\u6027\u3002\u7b49\u4ef7\u5730\uff0c\u53ef\u4ee5\u5199\u6210\uff1a\n$$T_{\\mathbf{X}}\\mathcal{V}_k(\\mathbb{R}^n) = {\\mathbf{X}\\mathbf{A} + \\mathbf{X}_\\perp\\mathbf{B} : \\mathbf{A} \\in \\mathbb{R}^{k \\times k}, \\mathbf{A}^T = -\\mathbf{A}, \\mathbf{B} \\in \\mathbb{R}^{(n-k) \\times k}}$$\n\u5176\u4e2d$\\mathbf{X}_\\perp \\in \\mathbb{R}^{n \\times (n-k)}$\u662f$\\mathbf{X}$\u7684\u6b63\u4ea4\u8865\u3002\u8fd9\u79cd\u8868\u793a\u63ed\u793a\u4e86\u5207\u7a7a\u95f4\u7684\u7ef4\u6570\uff1a$k(k-1)/2 + k(n-k) = nk - k(k+1)/2$\u3002</p>\n<p><strong>Grassmann\u6d41\u5f62\u7684\u5207\u7a7a\u95f4</strong>\uff1a\u4f5c\u4e3a\u5546\u6d41\u5f62\uff0c\u5176\u5207\u7a7a\u95f4\u7ee7\u627f\u81eaStiefel\u6d41\u5f62\u4f46\u9700\u8981\u6a21\u53bb\u5782\u76f4\u7a7a\u95f4\uff1a\n$$T_{[\\mathbf{X}]}\\mathcal{G}_k(\\mathbb{R}^n) = {\\mathbf{X}_\\perp\\mathbf{B} : \\mathbf{B} \\in \\mathbb{R}^{(n-k) \\times k}}$$\n\u8fd9\u91cc$[\\mathbf{X}]$\u8868\u793a\u5305\u542b$\\mathbf{X}$\u5217\u7a7a\u95f4\u7684\u7b49\u4ef7\u7c7b\u3002\u6ce8\u610f\u5207\u5411\u91cf\u5fc5\u987b\u4e0e\u5f53\u524d\u5b50\u7a7a\u95f4\u6b63\u4ea4\uff0c\u7ef4\u6570\u4e3a$k(n-k)$\u3002</p>\n<p><strong>\u56fa\u5b9a\u79e9\u6d41\u5f62\u7684\u5207\u7a7a\u95f4</strong>\uff1a\u5bf9\u4e8e$\\mathbf{X} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^T$\u7684SVD\u5206\u89e3\uff0c\n$$T_{\\mathbf{X}}\\mathcal{M}_r^{m \\times n} = {\\mathbf{U}\\mathbf{M}\\mathbf{V}^T + \\mathbf{U}_\\perp\\mathbf{N}\\mathbf{V}^T + \\mathbf{U}\\mathbf{P}^T\\mathbf{V}_\\perp^T : \\mathbf{M} \\in \\mathbb{R}^{r \\times r}, \\mathbf{N} \\in \\mathbb{R}^{(m-r) \\times r}, \\mathbf{P} \\in \\mathbb{R}^{(n-r) \\times r}}$$\n\u5176\u4e2d$\\mathbf{U}_\\perp$\u548c$\\mathbf{V}_\\perp$\u5206\u522b\u662f$\\mathbf{U}$\u548c$\\mathbf{V}$\u7684\u6b63\u4ea4\u8865\u3002\u8fd9\u79cd\u5206\u89e3\u53cd\u6620\u4e86\u4e09\u4e2a\u72ec\u7acb\u7684\u53d8\u5316\u65b9\u5411\uff1a</p>\n<ul>\n<li>$\\mathbf{U}\\mathbf{M}\\mathbf{V}^T$\uff1a\u4fdd\u6301\u884c\u5217\u7a7a\u95f4\u4e0d\u53d8\uff0c\u53ea\u6539\u53d8\u5947\u5f02\u503c\u548c\u6df7\u5408</li>\n<li>$\\mathbf{U}_\\perp\\mathbf{N}\\mathbf{V}^T$\uff1a\u6269\u5c55\u884c\u7a7a\u95f4</li>\n<li>$\\mathbf{U}\\mathbf{P}^T\\mathbf{V}_\\perp^T$\uff1a\u6269\u5c55\u5217\u7a7a\u95f4</li>\n</ul>\n<p><strong>\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\u7684\u5207\u7a7a\u95f4</strong>\uff1a\n$$T_{\\mathbf{X}}\\mathcal{S}_{++}^n = \\mathcal{S}^n = {\\boldsymbol{\\xi} \\in \\mathbb{R}^{n \\times n} : \\boldsymbol{\\xi}^T = \\boldsymbol{\\xi}}$$\n\u7531\u4e8e$\\mathcal{S}_{++}^n$\u662f\u5f00\u96c6\uff0c\u5176\u5207\u7a7a\u95f4\u5c31\u662f\u6240\u6709\u5bf9\u79f0\u77e9\u9635\u7684\u7a7a\u95f4\u3002</p>\n<p><strong>\u5207\u7a7a\u95f4\u7684\u6570\u503c\u8868\u793a</strong>\uff1a\u5b9e\u8df5\u4e2d\uff0c\u5b58\u50a8\u548c\u64cd\u4f5c\u5207\u5411\u91cf\u9700\u8981\u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784\uff1a</p>\n<ul>\n<li><strong>\u538b\u7f29\u8868\u793a</strong>\uff1a\u5bf9Stiefel\u6d41\u5f62\uff0c\u53ea\u5b58\u50a8$\\mathbf{A}$\u548c$\\mathbf{B}$\u800c\u975e\u5b8c\u6574\u7684$\\boldsymbol{\\xi}$</li>\n<li>\u5185\u5b58\u8282\u7701\uff1a\u4ece$O(nk)$\u964d\u81f3$O(k^2 + k(n-k))$</li>\n<li>\u9002\u7528\u573a\u666f\uff1a$k \\ll n$\u65f6\u6548\u679c\u663e\u8457</li>\n<li>\u5b9e\u73b0\u6280\u5de7\uff1a\u4f7f\u7528\u7a00\u758f\u77e9\u9635\u683c\u5f0f\u5b58\u50a8</li>\n<li><strong>\u6b63\u4ea4\u57fa</strong>\uff1a\u9884\u8ba1\u7b97\u5207\u7a7a\u95f4\u7684\u6b63\u4ea4\u57fa\uff0c\u4fbf\u4e8e\u6295\u5f71\u548c\u5185\u79ef\u8ba1\u7b97</li>\n<li>\u6784\u9020\u65b9\u6cd5\uff1a\u901a\u8fc7\u7ea6\u675f\u7684\u96c5\u53ef\u6bd4\u77e9\u9635\u7684\u96f6\u7a7a\u95f4</li>\n<li>\u66f4\u65b0\u7b56\u7565\uff1a\u4f7f\u7528Gram-Schmidt\u6b63\u4ea4\u5316\u6216Householder\u53d8\u6362</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\uff1a\u5b9a\u671f\u91cd\u6b63\u4ea4\u5316\u9632\u6b62\u57fa\u6f02\u79fb</li>\n<li><strong>\u9690\u5f0f\u8868\u793a</strong>\uff1a\u901a\u8fc7\u7ebf\u6027\u7b97\u5b50\u907f\u514d\u663e\u5f0f\u6784\u9020\u5927\u77e9\u9635</li>\n<li>\u7b97\u5b50\u5f62\u5f0f\uff1a\u5b9a\u4e49<code>apply_T(v)</code>\u548c<code>apply_T_transpose(v)</code></li>\n<li>\u4f18\u52bf\uff1a\u907f\u514d\u5b58\u50a8\u5927\u578b\u5bc6\u96c6\u77e9\u9635</li>\n<li>\u5e94\u7528\uff1aKrylov\u5b50\u7a7a\u95f4\u65b9\u6cd5\u3001\u8fed\u4ee3\u6c42\u89e3\u5668</li>\n</ul>\n<p><strong>\u5207\u7a7a\u95f4\u7684\u51e0\u4f55\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li><strong>\u7ef4\u6570\u516c\u5f0f</strong>\uff1a$\\dim(T_\\mathbf{X}\\mathcal{M}) = \\dim(\\mathcal{M})$\uff0c\u7531\u7ea6\u675f\u4e2a\u6570\u51b3\u5b9a</li>\n<li><strong>\u6b63\u4ea4\u5206\u89e3</strong>\uff1a\u73af\u5883\u7a7a\u95f4 = \u5207\u7a7a\u95f4 \u2295 \u6cd5\u7a7a\u95f4</li>\n<li><strong>\u5c40\u90e8\u5e73\u5766\u6027</strong>\uff1a\u5728\u8db3\u591f\u5c0f\u7684\u90bb\u57df\u5185\uff0c\u6d41\u5f62\u53ef\u4ee5\u7528\u5207\u7a7a\u95f4\u8fd1\u4f3c</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u5207\u7a7a\u95f4\u7684\u51e0\u4f55\u6027\u8d28\uff08\u5982\u622a\u9762\u66f2\u7387\uff09\u5982\u4f55\u5f71\u54cd\u4f18\u5316\u7b97\u6cd5\u7684\u6536\u655b\u901f\u5ea6\u662f\u4e00\u4e2a\u91cd\u8981\u4f46\u5c1a\u672a\u5145\u5206\u7814\u7a76\u7684\u95ee\u9898\u3002\u7279\u522b\u662f\u5728\u9ad8\u7ef4\u60c5\u51b5\u4e0b\uff0c\u5c40\u90e8\u51e0\u4f55\u7684\u7edf\u8ba1\u6027\u8d28\u53ef\u80fd\u63d0\u4f9b\u65b0\u7684\u7b97\u6cd5\u8bbe\u8ba1\u601d\u8def\u3002</p>\n<h3 id=\"1013-riemannian\">10.1.3 Riemannian\u5ea6\u91cf</h3>\n<p>Riemannian\u5ea6\u91cf\u4e3a\u6bcf\u4e2a\u5207\u7a7a\u95f4\u8d4b\u4e88\u5185\u79ef\u7ed3\u6784\uff0c\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u6d4b\u91cf\u5207\u5411\u91cf\u7684\u957f\u5ea6\u548c\u5939\u89d2\u3002\u9009\u62e9\u5408\u9002\u7684\u5ea6\u91cf\u5bf9\u7b97\u6cd5\u6027\u80fd\u5f71\u54cd\u91cd\u5927\uff0c\u4e0d\u540c\u7684\u5ea6\u91cf\u5bfc\u81f4\u4e0d\u540c\u7684\u68af\u5ea6\u3001Hessian\u548c\u6d4b\u5730\u7ebf\uff0c\u4ece\u800c\u5f71\u54cd\u6536\u655b\u901f\u5ea6\u548c\u6570\u503c\u7a33\u5b9a\u6027\u3002</p>\n<p><strong>\u5ea6\u91cf\u7684\u4f5c\u7528</strong>\uff1a</p>\n<ol>\n<li><strong>\u5b9a\u4e49\u957f\u5ea6\u548c\u89d2\u5ea6</strong>\uff1a$|\\boldsymbol{\\xi}|_\\mathbf{X} = \\sqrt{g_\\mathbf{X}(\\boldsymbol{\\xi}, \\boldsymbol{\\xi})}$</li>\n<li><strong>\u786e\u5b9a\u6700\u9661\u65b9\u5411</strong>\uff1a\u68af\u5ea6\u662f\u4f7f\u65b9\u5411\u5bfc\u6570\u6700\u5927\u7684\u5355\u4f4d\u5411\u91cf</li>\n<li><strong>\u5f71\u54cd\u7b97\u6cd5\u52a8\u529b\u5b66</strong>\uff1a\u4e0d\u540c\u5ea6\u91cf\u4e0b\u7684\u68af\u5ea6\u6d41\u6709\u4e0d\u540c\u7684\u8f68\u8ff9</li>\n<li><strong>\u7f16\u7801\u95ee\u9898\u7ed3\u6784</strong>\uff1a\u81ea\u7136\u5ea6\u91cfoften\u53cd\u6620\u95ee\u9898\u7684\u5185\u5728\u5bf9\u79f0\u6027</li>\n</ol>\n<p><strong>\u6807\u51c6\u5ea6\u91cf</strong>\uff1a\u6700\u5e38\u7528\u7684\u662f\u4ece\u73af\u5883\u7a7a\u95f4\u7ee7\u627f\u7684Euclidean\u5ea6\u91cf\n$$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\langle \\boldsymbol{\\xi}, \\boldsymbol{\\eta} \\rangle_F = \\text{tr}(\\boldsymbol{\\xi}^T\\boldsymbol{\\eta})$$\n\u4f18\u70b9\uff1a\u8ba1\u7b97\u7b80\u5355\uff0c\u4e0e\u6b27\u6c0f\u7a7a\u95f4\u7b97\u6cd5\u517c\u5bb9\u6027\u597d\u3002\u7f3a\u70b9\uff1a\u53ef\u80fd\u4e0d\u53cd\u6620\u95ee\u9898\u7684\u5185\u5728\u51e0\u4f55\uff0c\u5bf9\u4e8e\u75c5\u6001\u95ee\u9898\u6536\u655b\u6162\u3002</p>\n<p><strong>\u89c4\u8303\u4e0d\u53d8\u5ea6\u91cf</strong>\uff1a\u5bf9\u4e8eGrassmann\u6d41\u5f62\uff0c\u53ef\u4ee5\u5b9a\u4e49\u5bf9\u5b50\u7a7a\u95f4\u57fa\u7684\u9009\u62e9\u4e0d\u53d8\u7684\u5ea6\u91cf\n$$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\text{tr}(\\boldsymbol{\\xi}^T(\\mathbf{I} - \\mathbf{X}\\mathbf{X}^T)\\boldsymbol{\\eta})$$\n\u8fd9\u786e\u4fdd\u4e86\u5ea6\u91cf\u53ea\u4f9d\u8d56\u4e8e\u5b50\u7a7a\u95f4\u672c\u8eab\u800c\u975e\u5176\u7279\u5b9a\u8868\u793a\u3002\u5728\u4e3b\u89d2\u5ea6\u610f\u4e49\u4e0b\uff0c\u8fd9\u4e2a\u5ea6\u91cf\u8bf1\u5bfc\u7684\u6d4b\u5730\u8ddd\u79bb\u6709\u660e\u786e\u7684\u51e0\u4f55\u89e3\u91ca\u3002</p>\n<p><strong>\u4fe1\u606f\u51e0\u4f55\u5ea6\u91cf</strong>\uff1a\u5bf9\u4e8e\u6b63\u5b9a\u77e9\u9635\u9525\uff0cFisher\u4fe1\u606f\u5ea6\u91cf\uff08\u4e5f\u79f0\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf\uff09\n$$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\text{tr}(\\mathbf{X}^{-1}\\boldsymbol{\\xi}\\mathbf{X}^{-1}\\boldsymbol{\\eta})$$\n\u63d0\u4f9b\u4e86\u5bf9\u77e9\u9635\u6c42\u9006\u548c\u7f29\u653e\u7684\u81ea\u7136\u4e0d\u53d8\u6027\u3002\u8fd9\u4e2a\u5ea6\u91cf\u4e0b\u7684\u6d4b\u5730\u7ebf\u662f\u77e9\u9635\u51e0\u4f55\u5e73\u5747\uff0c\u5728\u534f\u65b9\u5dee\u77e9\u9635\u63d2\u503c\u548c\u6269\u6563\u5f20\u91cf\u6210\u50cf\u4e2d\u6709\u91cd\u8981\u5e94\u7528\u3002</p>\n<p><strong>\u5176\u4ed6\u91cd\u8981\u5ea6\u91cf</strong>\uff1a</p>\n<ul>\n<li><strong>Bures-Wasserstein\u5ea6\u91cf</strong>\uff1a$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\frac{1}{2}\\text{tr}(\\boldsymbol{\\xi}\\mathbf{X}^{-1}\\boldsymbol{\\eta} + \\boldsymbol{\\eta}\\mathbf{X}^{-1}\\boldsymbol{\\xi})$\uff0c\u5728\u91cf\u5b50\u4fe1\u606f\u548c\u6700\u4f18\u4f20\u8f93\u4e2d\u4f7f\u7528</li>\n<li><strong>Log-Euclidean\u5ea6\u91cf</strong>\uff1a\u901a\u8fc7\u5bf9\u6570\u6620\u5c04\u8f6c\u6362\u5230\u6b27\u6c0f\u7a7a\u95f4\uff0c$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\langle d\\log_{\\mathbf{X}}(\\boldsymbol{\\xi}), d\\log_{\\mathbf{X}}(\\boldsymbol{\\eta}) \\rangle$</li>\n<li><strong>\u52a0\u6743\u5ea6\u91cf</strong>\uff1a$g_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\boldsymbol{\\eta}) = \\text{tr}(\\boldsymbol{\\xi}^T\\mathbf{W}\\boldsymbol{\\eta})$\uff0c\u5176\u4e2d$\\mathbf{W}$\u7f16\u7801\u95ee\u9898\u7279\u5b9a\u7684\u91cd\u8981\u6027</li>\n</ul>\n<p><strong>\u5ea6\u91cf\u9009\u62e9\u7684\u5f71\u54cd</strong>\uff1a</p>\n<ol>\n<li><strong>\u6761\u4ef6\u6570</strong>\uff1a\u9002\u5f53\u7684\u5ea6\u91cf\u53ef\u4ee5\u6539\u5584\u4f18\u5316\u95ee\u9898\u7684\u6761\u4ef6\u6570\n   - \u4f8b\u5b50\uff1a\u5bf9\u4e8e\u6b63\u5b9a\u77e9\u9635\u4f18\u5316\uff0c\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf\u5c06\u6761\u4ef6\u6570\u4ece$\\kappa(\\mathbf{X})^2$\u6539\u5584\u5230$\\kappa(\\mathbf{X})$\n   - \u673a\u5236\uff1a\u5ea6\u91cfacts as\u9690\u5f0f\u9884\u6761\u4ef6\u5b50\n   - \u91cf\u5316\uff1a\u53ef\u4ee5\u901a\u8fc7Hessian\u7684\u7279\u5f81\u503c\u5206\u5e03\u8bc4\u4f30</li>\n<li><strong>\u6536\u655b\u901f\u5ea6</strong>\uff1aNatural gradient\uff08\u4f7f\u7528Fisher\u4fe1\u606f\u5ea6\u91cf\uff09\u5728\u8bb8\u591a\u7edf\u8ba1\u95ee\u9898\u4e2d\u5c55\u73b0\u4e8c\u9636\u6536\u655b\u6027\u8d28\n   - \u7406\u8bba\u4fdd\u8bc1\uff1a\u5728\u6307\u6570\u65cf\u5206\u5e03\u4e2d\u8fbe\u5230Fisher\u6548\u7387\n   - \u5b9e\u8df5\u8868\u73b0\uff1atypically\u6bd4\u6807\u51c6\u68af\u5ea6\u5feb2-10\u500d\n   - \u4ee3\u4ef7\uff1a\u6bcf\u6b65\u8ba1\u7b97\u65f6\u95f4\u589e\u52a0$O(n^2)$\u5230$O(n^3)$</li>\n<li><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\u67d0\u4e9b\u5ea6\u91cf\uff08\u5982Log-Euclidean\uff09\u901a\u8fc7\u907f\u514d\u77e9\u9635\u6c42\u9006\u63d0\u9ad8\u6570\u503c\u7a33\u5b9a\u6027\n   - \u95ee\u9898\u573a\u666f\uff1a\u5f53\u77e9\u9635\u63a5\u8fd1\u5947\u5f02\u65f6\n   - \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u77e9\u9635\u5bf9\u6570/\u6307\u6570\u800c\u975e\u76f4\u63a5\u6c42\u9006\n   - \u7cbe\u5ea6\u63d0\u5347\uff1a\u53ef\u4ee5\u5904\u7406\u6761\u4ef6\u6570\u9ad8\u8fbe$10^{15}$\u7684\u95ee\u9898</li>\n<li><strong>\u8ba1\u7b97\u590d\u6742\u5ea6</strong>\uff1a\u6807\u51c6\u5ea6\u91cf\u8ba1\u7b97\u6700\u5feb\uff0c\u800c\u4fe1\u606f\u51e0\u4f55\u5ea6\u91cf\u9700\u8981\u989d\u5916\u7684\u77e9\u9635\u8fd0\u7b97\n   - \u6807\u51c6\u5ea6\u91cf\uff1a$O(nk)$\u7528\u4e8e\u5185\u79ef\u8ba1\u7b97\n   - \u4eff\u5c04\u4e0d\u53d8\uff1a\u9700\u8981$O(n^3)$\u7684\u77e9\u9635\u6c42\u9006\n   - \u6298\u4e2d\u65b9\u6848\uff1a\u4f7f\u7528\u5bf9\u89d2\u6216\u5757\u5bf9\u89d2\u8fd1\u4f3c</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u5ea6\u91cf\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li><strong>\u95ee\u9898\u76f8\u5173\u5ea6\u91cf</strong>\uff1a\u6839\u636e\u76ee\u6807\u51fd\u6570\u7684\u5c40\u90e8\u7ed3\u6784\u8c03\u6574</li>\n<li><strong>\u6df7\u5408\u5ea6\u91cf</strong>\uff1a\u5728\u4e0d\u540c\u4f18\u5316\u9636\u6bb5\u4f7f\u7528\u4e0d\u540c\u5ea6\u91cf</li>\n<li><strong>\u5b66\u4e60\u5ea6\u91cf</strong>\uff1a\u901a\u8fc7\u5386\u53f2\u4fe1\u606f\u5b66\u4e60\u6700\u4f18\u5ea6\u91cf\u53c2\u6570</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u81ea\u9002\u5e94\u5ea6\u91cf\u9009\u62e9\u2014\u2014\u6839\u636e\u95ee\u9898\u7684\u5c40\u90e8\u51e0\u4f55\u52a8\u6001\u8c03\u6574\u5ea6\u91cf\u2014\u2014\u662f\u4e00\u4e2a\u6709\u524d\u666f\u7684\u7814\u7a76\u65b9\u5411\u3002\u8fd9\u53ef\u80fd\u7ed3\u5408\u4e86\u4e0d\u540c\u5ea6\u91cf\u7684\u4f18\u70b9\uff0c\u4f46\u7406\u8bba\u5206\u6790\u4ecd\u7136\u56f0\u96be\u3002</p>\n<h3 id=\"1014\">10.1.4 \u6d4b\u5730\u7ebf\u4e0e\u6307\u6570\u6620\u5c04</h3>\n<p>\u6d4b\u5730\u7ebf\u662f\u6d41\u5f62\u4e0a\u7684\"\u76f4\u7ebf\"\uff0c\u5373\u5c40\u90e8\u6700\u77ed\u8def\u5f84\u3002\u6307\u6570\u6620\u5c04$\\exp_{\\mathbf{X}}: T_{\\mathbf{X}}\\mathcal{M} \\to \\mathcal{M}$\u5c06\u5207\u5411\u91cf\u6620\u5c04\u5230\u6cbf\u6d4b\u5730\u7ebf\u7684\u70b9\u3002\u7406\u89e3\u6d4b\u5730\u7ebf\u7684\u6027\u8d28\u5bf9\u4e8e\u8bbe\u8ba1\u9ad8\u6548\u7684\u4f18\u5316\u7b97\u6cd5\u548c\u5206\u6790\u6536\u655b\u6027\u81f3\u5173\u91cd\u8981\u3002</p>\n<p><strong>\u7269\u7406\u7c7b\u6bd4</strong>\uff1a\u6d4b\u5730\u7ebf\u5982\u540c\u5728\u66f2\u9762\u4e0a\u62c9\u7d27\u7684\u6a61\u76ae\u7b4b\u2014\u2014\u5b83\u4eec\u81ea\u7136\u5730\u627e\u5230\u6700\u77ed\u8def\u5f84\u3002\u5728\u7403\u9762\u4e0a\uff0c\u6d4b\u5730\u7ebf\u662f\u5927\u5706\u5f27\uff1b\u5728\u5e73\u9762\u4e0a\uff0c\u6d4b\u5730\u7ebf\u662f\u76f4\u7ebf\u3002\u8fd9\u79cd\u51e0\u4f55\u7ed3\u6784\u76f4\u63a5\u5f71\u54cd\u4f18\u5316\u7b97\u6cd5\u7684\u8f68\u8ff9\u3002</p>\n<p><strong>\u6d4b\u5730\u7ebf\u7684\u523b\u753b</strong>\uff1a\u6d4b\u5730\u7ebf$\\gamma(t)$\u6ee1\u8db3\u6d4b\u5730\u7ebf\u65b9\u7a0b\n$$\\nabla_{\\dot{\\gamma}}\\dot{\\gamma} = 0$$\n\u5176\u4e2d$\\nabla$\u662fLevi-Civita\u8054\u7edc\u3002\u8fd9\u610f\u5473\u7740\u6d4b\u5730\u7ebf\u7684\"\u52a0\u901f\u5ea6\"\uff08\u5728\u6d41\u5f62\u610f\u4e49\u4e0b\uff09\u4e3a\u96f6\u3002</p>\n<p>\u5bf9\u4e8e\u914d\u5907\u6807\u51c6\u5ea6\u91cf\u7684Stiefel\u6d41\u5f62\uff0c\u6307\u6570\u6620\u5c04\u6709\u95ed\u5f0f\u8868\u8fbe\uff1a\n$$\\exp_{\\mathbf{X}}(\\boldsymbol{\\xi}) = [\\mathbf{X}, \\mathbf{Q}]\\exp\\left(\\begin{bmatrix} \\mathbf{A} &amp; -\\mathbf{R}^T \\ \\mathbf{R} &amp; \\mathbf{0} \\end{bmatrix}\\right)\\begin{bmatrix} \\mathbf{I}_k \\ \\mathbf{0} \\end{bmatrix}$$\n\u5176\u4e2d$\\mathbf{Q}\\mathbf{R} = (\\mathbf{I} - \\mathbf{X}\\mathbf{X}^T)\\boldsymbol{\\xi}$\u662f\u7626QR\u5206\u89e3\uff0c$\\mathbf{A} = \\mathbf{X}^T\\boldsymbol{\\xi}$\u662f\u659c\u5bf9\u79f0\u77e9\u9635\u3002</p>\n<p><strong>\u5176\u4ed6\u6d41\u5f62\u7684\u6307\u6570\u6620\u5c04</strong>\uff1a</p>\n<ul>\n<li><strong>\u6b63\u5b9a\u77e9\u9635\uff08\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf\uff09</strong>\uff1a$\\exp_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\mathbf{X}^{1/2}\\exp(\\mathbf{X}^{-1/2}\\boldsymbol{\\xi}\\mathbf{X}^{-1/2})\\mathbf{X}^{1/2}$</li>\n<li><strong>Grassmann\u6d41\u5f62</strong>\uff1a\u901a\u8fc7Stiefel\u6d41\u5f62\u7684\u6307\u6570\u6620\u5c04\u548c\u6295\u5f71\u83b7\u5f97</li>\n<li><strong>\u56fa\u5b9a\u79e9\u6d41\u5f62</strong>\uff1a\u4e00\u822c\u65e0\u95ed\u5f0f\u8868\u8fbe\uff0c\u9700\u8981\u6570\u503c\u6c42\u89e3\u5e38\u5fae\u5206\u65b9\u7a0b</li>\n</ul>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>Stiefel\u6d41\u5f62\uff1a$O(nk^2 + k^3)$\uff0c\u4e3b\u8981\u5f00\u9500\u5728\u77e9\u9635\u6307\u6570</li>\n<li>\u77e9\u9635\u6307\u6570\u8ba1\u7b97\uff1aPad\u00e9\u8fd1\u4f3c\u6216\u7f29\u653e\u548c\u5e73\u65b9\u6cd5</li>\n<li>\u7279\u6b8a\u60c5\u51b5\uff1a\u5f53$k=1$\u65f6\u7b80\u5316\u4e3a$O(n)$</li>\n<li>\u5e76\u884c\u5316\uff1a\u77e9\u9635\u6307\u6570\u53ef\u4ee5\u9ad8\u6548\u5e76\u884c\u8ba1\u7b97</li>\n<li>\u6b63\u5b9a\u77e9\u9635\uff1a$O(n^3)$\uff0c\u9700\u8981\u7279\u5f81\u5206\u89e3</li>\n<li>\u4f18\u5316\u6280\u5de7\uff1a\u4f7f\u7528Cholesky\u5206\u89e3\u66ff\u4ee3\u5b8c\u6574\u7279\u5f81\u5206\u89e3</li>\n<li>\u589e\u91cf\u66f4\u65b0\uff1a\u5229\u7528Sherman-Morrison\u516c\u5f0f</li>\n<li>\u7a00\u758f\u60c5\u51b5\uff1a\u590d\u6742\u5ea6\u53ef\u964d\u81f3$O(n^2)$\u6216\u66f4\u4f4e</li>\n<li>\u56fa\u5b9a\u79e9\u6d41\u5f62\uff1a$O(r^2(m+n))$\u6bcf\u6b65\uff0c\u9700\u8981\u591a\u6b65\u6570\u503c\u79ef\u5206</li>\n<li>\u9002\u5e94\u6b65\u957f\uff1a\u4f7f\u7528Runge-Kutta\u65b9\u6cd5</li>\n<li>\u65e9\u505c\u7b56\u7565\uff1a\u5f53\u8fbe\u5230\u8db3\u591f\u7cbe\u5ea6\u65f6\u7ec8\u6b62</li>\n<li>\u7279\u6b8a\u7ed3\u6784\uff1a\u5229\u7528\u4f4e\u79e9\u7ed3\u6784\u52a0\u901f</li>\n</ul>\n<p>\u7136\u800c\uff0c\u6307\u6570\u6620\u5c04\u7684\u8ba1\u7b97\u901a\u5e38\u5f00\u9500\u8f83\u5927\uff0c\u5b9e\u8df5\u4e2d\u5e38\u7528\u66f4\u7b80\u5355\u7684\u56de\u7f29\u6620\u5c04\u66ff\u4ee3\u3002\u5173\u952e\u89c2\u5bdf\u662f\uff1a\u5bf9\u4e8e\u4e00\u9636\u65b9\u6cd5\uff0c\u53ea\u9700\u8981\u4fdd\u8bc1\u4e00\u9636\u8fd1\u4f3c\u7684\u6b63\u786e\u6027\uff1b\u5bf9\u4e8e\u4e8c\u9636\u65b9\u6cd5\uff0c\u56de\u7f29\u7684\u4e8c\u9636\u8fd1\u4f3c\u901a\u5e38\u5c31\u8db3\u591f\u4e86\u3002</p>\n<p><strong>\u6307\u6570\u6620\u5c04vs\u56de\u7f29\u7684\u6743\u8861</strong>\uff1a</p>\n<ul>\n<li><strong>\u7cbe\u5ea6\u8981\u6c42</strong>\uff1a\u9ad8\u7cbe\u5ea6\u573a\u666f\uff08\u5982\u7269\u7406\u6a21\u62df\uff09\u9700\u8981\u6307\u6570\u6620\u5c04</li>\n<li><strong>\u8ba1\u7b97\u9884\u7b97</strong>\uff1a\u5927\u89c4\u6a21\u95ee\u9898\u503e\u5411\u4e8e\u4f7f\u7528\u7b80\u5355\u56de\u7f29</li>\n<li><strong>\u6536\u655b\u4fdd\u8bc1</strong>\uff1a\u7406\u8bba\u5206\u6790\u65f6\u6307\u6570\u6620\u5c04\u63d0\u4f9b\u66f4\u5f3a\u4fdd\u8bc1</li>\n<li><strong>\u5b9e\u73b0\u590d\u6742\u5ea6</strong>\uff1a\u56de\u7f29\u901a\u5e38\u66f4\u5bb9\u6613\u5b9e\u73b0\u548c\u8c03\u8bd5</li>\n</ul>\n<p><strong>\u5bf9\u6570\u6620\u5c04\u4e0e\u5185\u5c04\u534a\u5f84</strong>\uff1a\u5bf9\u6570\u6620\u5c04$\\log_{\\mathbf{X}}: \\mathcal{M} \\to T_{\\mathbf{X}}\\mathcal{M}$\u662f\u6307\u6570\u6620\u5c04\u7684\uff08\u5c40\u90e8\uff09\u9006\u3002\u5185\u5c04\u534a\u5f84$\\text{inj}(\\mathbf{X})$\u662f\u4f7f\u5f97\u6307\u6570\u6620\u5c04\u4e3a\u5fae\u5206\u540c\u80da\u7684\u6700\u5927\u534a\u5f84\u3002</p>\n<p>\u4e86\u89e3\u5185\u5c04\u534a\u5f84\u5bf9\u4e8e\uff1a</p>\n<ul>\n<li>\u786e\u5b9a\u4fe1\u8d56\u57df\u7b97\u6cd5\u7684\u6700\u5927\u6b65\u957f</li>\n<li>\u5b89\u5168\u8303\u56f4\uff1a$\\Delta &lt; \\text{inj}(\\mathbf{X})$\u4fdd\u8bc1\u5c40\u90e8\u51f8\u6027</li>\n<li>\u81ea\u9002\u5e94\u7b56\u7565\uff1a\u6839\u636e\u5c40\u90e8\u66f2\u7387\u4f30\u8ba1\u5185\u5c04\u534a\u5f84</li>\n<li>\u5206\u6790\u5168\u5c40\u6536\u655b\u6027</li>\n<li>\u5438\u5f15\u57df\uff1a\u5185\u5c04\u534a\u5f84\u51b3\u5b9a\u5c40\u90e8\u6700\u5c0f\u503c\u7684\u5438\u5f15\u57df\u5927\u5c0f</li>\n<li>\u9003\u79bb\u7b56\u7565\uff1a\u5f53\u6b65\u957f\u8d85\u8fc7\u5185\u5c04\u534a\u5f84\u65f6\u53ef\u80fd\u9003\u79bb\u5c40\u90e8\u6700\u5c0f</li>\n<li>\u8bbe\u8ba1\u6d4b\u5730\u7ebf\u641c\u7d22\u7b97\u6cd5</li>\n<li>\u641c\u7d22\u8303\u56f4\uff1a\u9650\u5236\u5728\u5185\u5c04\u534a\u5f84\u5185\u4fdd\u8bc1\u5355\u8c03\u6027</li>\n<li>\u52a0\u901f\u6280\u5de7\uff1a\u5229\u7528\u6d4b\u5730\u7ebf\u7684\u5bf9\u79f0\u6027\u51cf\u5c11\u8ba1\u7b97</li>\n</ul>\n<p><strong>\u5177\u4f53\u6d41\u5f62\u7684\u5185\u5c04\u534a\u5f84</strong>\uff1a</p>\n<ul>\n<li>\u7403\u9762$S^n$\uff1a$\\text{inj} = \\pi$\uff08\u5168\u5c40\u5e38\u6570\uff09</li>\n<li>Stiefel\u6d41\u5f62\uff1a$\\text{inj}(\\mathbf{X}) = \\pi/2$</li>\n<li>Grassmann\u6d41\u5f62\uff1a$\\text{inj} = \\pi/2$</li>\n<li>\u6b63\u5b9a\u77e9\u9635\uff1a$\\text{inj}(\\mathbf{X}) = \\infty$\uff08\u5b8c\u5907\u5355\u8fde\u901a\uff09</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u5bf9\u4e8e\u8bb8\u591a\u5b9e\u9645\u5e94\u7528\u7684\u6d41\u5f62\uff0c\u7cbe\u786e\u8ba1\u7b97\u6216\u6709\u6548\u8fd1\u4f3c\u5185\u5c04\u534a\u5f84\u4ecd\u662f\u5f00\u653e\u95ee\u9898\u3002\u8fd9\u9650\u5236\u4e86\u67d0\u4e9b\u7406\u8bba\u4fdd\u8bc1\u7684\u5b9e\u7528\u6027\u3002</p>\n<h2 id=\"102-riemannianhessian\">10.2 Riemannian\u68af\u5ea6\u4e0eHessian</h2>\n<p>\u5c06\u6b27\u6c0f\u7a7a\u95f4\u7684\u68af\u5ea6\u548cHessian\u6982\u5ff5\u63a8\u5e7f\u5230\u6d41\u5f62\u4e0a\uff0c\u662f\u6784\u5efa\u6d41\u5f62\u4f18\u5316\u7b97\u6cd5\u7684\u5173\u952e\u6b65\u9aa4\u3002\u8fd9\u4e9b\u6982\u5ff5\u4e0d\u4ec5\u63d0\u4f9b\u4e86\u4f18\u5316\u7684\u57fa\u672c\u5de5\u5177\uff0c\u8fd8\u63ed\u793a\u4e86\u6d41\u5f62\u51e0\u4f55\u4e0e\u4f18\u5316\u6027\u80fd\u4e4b\u95f4\u7684\u6df1\u523b\u8054\u7cfb\u3002</p>\n<h3 id=\"1021-riemannian\">10.2.1 Riemannian\u68af\u5ea6\u7684\u8ba1\u7b97</h3>\n<p>\u7ed9\u5b9a\u5b9a\u4e49\u5728\u6d41\u5f62$\\mathcal{M}$\u4e0a\u7684\u5149\u6ed1\u51fd\u6570$f: \\mathcal{M} \\to \\mathbb{R}$\uff0c\u5176\u5728\u70b9$\\mathbf{X}$\u7684Riemannian\u68af\u5ea6$\\text{grad} f(\\mathbf{X})$\u662f\u552f\u4e00\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u5207\u5411\u91cf\uff1a\n$$g_{\\mathbf{X}}(\\text{grad} f(\\mathbf{X}), \\boldsymbol{\\xi}) = \\text{D}f(\\mathbf{X})[\\boldsymbol{\\xi}], \\quad \\forall \\boldsymbol{\\xi} \\in T_{\\mathbf{X}}\\mathcal{M}$$\n\u5176\u4e2d$\\text{D}f(\\mathbf{X})[\\boldsymbol{\\xi}]$\u662f$f$\u5728$\\mathbf{X}$\u6cbf\u65b9\u5411$\\boldsymbol{\\xi}$\u7684\u65b9\u5411\u5bfc\u6570\u3002</p>\n<p><strong>Riesz\u8868\u793a\u5b9a\u7406\u7684\u6d41\u5f62\u7248\u672c</strong>\uff1aRiemannian\u68af\u5ea6\u662f\u51fd\u6570\u5fae\u5206$df$\u5728\u5ea6\u91cf$g$\u4e0b\u7684Riesz\u8868\u793a\u3002\u8fd9\u79cd\u89c2\u70b9\u5c06\u4f59\u5207\u5411\u91cf\uff08\u5fae\u5206\u5f62\u5f0f\uff09\u8f6c\u6362\u4e3a\u5207\u5411\u91cf\uff0c\u4f53\u73b0\u4e86\u5ea6\u91cf\u7684\u6838\u5fc3\u4f5c\u7528\u3002</p>\n<p><strong>\u6295\u5f71\u65b9\u6cd5</strong>\uff1a\u82e5$f$\u53ef\u4ee5\u6269\u5c55\u5230\u73af\u5883\u7a7a\u95f4\uff0c\u5219Riemannian\u68af\u5ea6\u662fEuclidean\u68af\u5ea6\u5728\u5207\u7a7a\u95f4\u4e0a\u7684\u6b63\u4ea4\u6295\u5f71\uff08\u76f8\u5bf9\u4e8e\u6240\u9009\u5ea6\u91cf\uff09\uff1a\n$$\\text{grad} f(\\mathbf{X}) = \\text{Proj}_{T_{\\mathbf{X}}\\mathcal{M}}^g(\\nabla f(\\mathbf{X}))$$\n\u5bf9\u4e8e\u6807\u51c6\u5ea6\u91cf\uff0c\u8fd9\u7b80\u5316\u4e3a\u6b63\u4ea4\u6295\u5f71\u3002\u5bf9\u4e8eStiefel\u6d41\u5f62\uff0c\u6295\u5f71\u7b97\u5b50\u4e3a\uff1a\n$$\\text{Proj}_{T_{\\mathbf{X}}\\mathcal{V}}(\\mathbf{Z}) = \\mathbf{Z} - \\mathbf{X}\\text{sym}(\\mathbf{X}^T\\mathbf{Z})$$\n\u5176\u4e2d$\\text{sym}(\\mathbf{A}) = (\\mathbf{A} + \\mathbf{A}^T)/2$\u3002</p>\n<p><strong>\u5177\u4f53\u6d41\u5f62\u7684\u68af\u5ea6\u516c\u5f0f</strong>\uff1a</p>\n<p><em>Grassmann\u6d41\u5f62</em>\uff1a\u5bf9\u4e8e$f([\\mathbf{X}])$\uff0c\n$$\\text{grad} f([\\mathbf{X}]) = (\\mathbf{I} - \\mathbf{X}\\mathbf{X}^T)\\nabla \\tilde{f}(\\mathbf{X})$$\n\u5176\u4e2d$\\tilde{f}$\u662f$f$\u5728Stiefel\u6d41\u5f62\u4e0a\u7684\u63d0\u5347\u3002</p>\n<p><em>\u56fa\u5b9a\u79e9\u6d41\u5f62</em>\uff1a\u8bbe$\\mathbf{X} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^T$\uff0c\n$$\\text{grad} f(\\mathbf{X}) = \\mathbf{U}\\mathbf{U}^T\\nabla f(\\mathbf{X})\\mathbf{V}\\mathbf{V}^T + \\mathbf{U}_\\perp\\mathbf{U}_\\perp^T\\nabla f(\\mathbf{X})\\mathbf{V}\\mathbf{V}^T + \\mathbf{U}\\mathbf{U}^T\\nabla f(\\mathbf{X})\\mathbf{V}_\\perp\\mathbf{V}_\\perp^T$$\n<em>\u6b63\u5b9a\u77e9\u9635\uff08\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf\uff09</em>\uff1a\n$$\\text{grad} f(\\mathbf{X}) = \\mathbf{X}\\text{sym}(\\nabla f(\\mathbf{X}))\\mathbf{X}$$\n<strong>\u8ba1\u7b97\u6280\u5de7\u4e0e\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u5229\u7528\u7a00\u758f\u6027</strong>\uff1a\u5f53$\\nabla f(\\mathbf{X})$\u7a00\u758f\u65f6\uff0c\u6295\u5f71\u53ef\u4ee5\u9ad8\u6548\u8ba1\u7b97\n   - \u77e9\u9635\u8865\u5168\uff1a\u53ea\u5904\u7406\u89c2\u6d4b\u4f4d\u7f6e$\\Omega$\n   - \u7a00\u758f\u68af\u5ea6\uff1a$O(|\\Omega|r)$\u590d\u6742\u5ea6\u800c\u975e$O(mnr)$\n   - \u6570\u636e\u7ed3\u6784\uff1aCSR/CSC\u683c\u5f0f\u5b58\u50a8</li>\n<li><strong>\u907f\u514d\u663e\u5f0f\u6b63\u4ea4\u8865</strong>\uff1a\u4f7f\u7528$\\mathbf{I} - \\mathbf{U}\\mathbf{U}^T$\u800c\u975e\u5b58\u50a8$\\mathbf{U}_\\perp$\n   - \u5185\u5b58\u8282\u7701\uff1a$O((n-k)k)$\u7a7a\u95f4\n   - \u8ba1\u7b97\u6a21\u5f0f\uff1a\u5148\u8ba1\u7b97$\\mathbf{U}^T\\mathbf{v}$\uff0c\u518d\u8ba1\u7b97$\\mathbf{U}(\\mathbf{U}^T\\mathbf{v})$\n   - \u6570\u503c\u7a33\u5b9a\uff1a\u907f\u514d\u5927\u77e9\u9635\u76f8\u51cf</li>\n<li><strong>\u7f13\u5b58\u91cd\u7528</strong>\uff1a\u5728\u8fed\u4ee3\u7b97\u6cd5\u4e2d\u91cd\u7528QR\u5206\u89e3\u6216SVD\n   - \u589e\u91cf\u66f4\u65b0\uff1a\u4f7f\u7528rank-1\u66f4\u65b0\u516c\u5f0f\n   - lazy evaluation\uff1a\u5ef6\u8fdf\u8ba1\u7b97\u76f4\u5230\u5fc5\u8981\u65f6\n   - \u5468\u671f\u5237\u65b0\uff1a\u6bcf$k$\u6b21\u8fed\u4ee3\u91cd\u65b0\u8ba1\u7b97\u9632\u6b62\u7d2f\u79ef\u8bef\u5dee</li>\n<li><strong>\u81ea\u52a8\u5fae\u5206</strong>\uff1a\u73b0\u4ee3\u6846\u67b6\uff08PyTorch, JAX\uff09\u53ef\u4ee5\u81ea\u52a8\u8ba1\u7b97\u6d41\u5f62\u68af\u5ea6\n   - \u81ea\u5b9a\u4e49\u64cd\u4f5c\uff1a\u5b9a\u4e49\u6295\u5f71\u548c\u56de\u7f29\u7684\u68af\u5ea6\u89c4\u5219\n   - \u9ad8\u9636\u5bfc\u6570\uff1a\u652f\u6301Hessian-\u5411\u91cf\u79ef\u8ba1\u7b97\n   - GPU\u52a0\u901f\uff1a\u81ea\u52a8\u5229\u7528\u5e76\u884c\u8ba1\u7b97</li>\n</ol>\n<p><strong>\u68af\u5ea6\u7684\u51e0\u4f55\u610f\u4e49</strong>\uff1aRiemannian\u68af\u5ea6\u6307\u5411\u51fd\u6570\u5728\u6d41\u5f62\u4e0a\u589e\u957f\u6700\u5feb\u7684\u65b9\u5411\uff0c\u5176\u6a21\u957f\u53cd\u6620\u589e\u957f\u7387\u3002\u4e0e\u6b27\u6c0f\u60c5\u51b5\u4e0d\u540c\uff0c\u8fd9\u4e2a\u65b9\u5411\u4f9d\u8d56\u4e8e\u6240\u9009\u7684\u5ea6\u91cf\uff0c\u4f53\u73b0\u4e86\"\u6700\u9661\"\u7684\u76f8\u5bf9\u6027\u3002</p>\n<p><strong>\u68af\u5ea6\u8ba1\u7b97\u7684\u9677\u9631</strong>\uff1a</p>\n<ul>\n<li><strong>\u6295\u5f71\u987a\u5e8f</strong>\uff1a\u5fc5\u987b\u5148\u8ba1\u7b97Euclidean\u68af\u5ea6\uff0c\u518d\u6295\u5f71</li>\n<li><strong>\u5ea6\u91cf\u4e00\u81f4\u6027</strong>\uff1a\u786e\u4fdd\u6295\u5f71\u4f7f\u7528\u4e0e\u95ee\u9898\u76f8\u540c\u7684\u5ea6\u91cf</li>\n<li><strong>\u6570\u503c\u7cbe\u5ea6</strong>\uff1a\u63a5\u8fd1\u7ea6\u675f\u8fb9\u754c\u65f6\u6295\u5f71\u53ef\u80fd\u4e0d\u7a33\u5b9a</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u5bf9\u4e8e\u975e\u5149\u6ed1\u51fd\u6570\u7684\u6d41\u5f62\u6b21\u68af\u5ea6\u7406\u8bba\u4ecd\u5728\u53d1\u5c55\u4e2d\uff0c\u8fd9\u5bf9\u4e8e\u7a00\u758f\u4f18\u5316\u548c\u9c81\u68d2\u7edf\u8ba1\u7279\u522b\u91cd\u8981\u3002</p>\n<h3 id=\"1022-riemannian-hessian\">10.2.2 Riemannian Hessian</h3>\n<p>Riemannian Hessian\u63cf\u8ff0\u68af\u5ea6\u573a\u5728\u6d41\u5f62\u4e0a\u7684\u53d8\u5316\u7387\u3002\u5bf9\u4e8e\u5207\u5411\u91cf$\\boldsymbol{\\xi} \\in T_{\\mathbf{X}}\\mathcal{M}$\uff0cHessian\u4f5c\u7528\u5b9a\u4e49\u4e3a\uff1a\n$$\\text{Hess} f(\\mathbf{X})[\\boldsymbol{\\xi}] = \\nabla_{\\boldsymbol{\\xi}} \\text{grad} f(\\mathbf{X})$$\n\u5176\u4e2d$\\nabla$\u662fLevi-Civita\u8054\u7edc\uff0c\u5b83\u552f\u4e00\u5730\u7531\u5ea6\u91cf\u51b3\u5b9a\u5e76\u4fdd\u6301\u5ea6\u91cf\u76f8\u5bb9\u6027\u548c\u65e0\u6320\u6027\u3002</p>\n<p><strong>\u4e0e\u6b27\u6c0fHessian\u7684\u5173\u7cfb</strong>\uff1aRiemannian Hessian = Euclidean Hessian\u7684\u5207\u5411\u90e8\u5206 + \u6d41\u5f62\u66f2\u7387\u7684\u8d21\u732e\u3002\u8fd9\u79cd\u5206\u89e3\u63ed\u793a\u4e86\u5185\u5728\u66f2\u7387\u5982\u4f55\u5f71\u54cd\u4e8c\u9636\u4fe1\u606f\u3002</p>\n<p><strong>\u8ba1\u7b97\u7684\u4e09\u6b65\u6846\u67b6</strong>\uff1a</p>\n<ol>\n<li><strong>\u68af\u5ea6\u573a\u7684\u6269\u5c55</strong>\uff1a\u5c06$\\text{grad} f$\u4ece\u5355\u70b9\u6269\u5c55\u5230\u90bb\u57df\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u5316\u6216\u5d4c\u5165\u5b9e\u73b0</li>\n<li><strong>\u65b9\u5411\u5bfc\u6570</strong>\uff1a\u8ba1\u7b97\u6269\u5c55\u68af\u5ea6\u573a\u6cbf$\\boldsymbol{\\xi}$\u7684\u5bfc\u6570</li>\n<li><strong>\u6295\u5f71</strong>\uff1a\u5c06\u7ed3\u679c\u6295\u5f71\u56de\u5207\u7a7a\u95f4\uff0c\u56e0\u4e3a\u534f\u53d8\u5bfc\u6570\u5fc5\u987b\u662f\u5207\u5411\u91cf</li>\n</ol>\n<p>\u5bf9\u4e8e\u5d4c\u5165\u5b50\u6d41\u5f62\uff0cWeingarten\u516c\u5f0f\u63d0\u4f9b\u4e86\u5b9e\u7528\u7684\u8ba1\u7b97\u65b9\u6cd5\uff1a\n$$\\text{Hess} f(\\mathbf{X})[\\boldsymbol{\\xi}] = \\text{Proj}_{T_{\\mathbf{X}}\\mathcal{M}}(\\text{D}(\\nabla f)(\\mathbf{X})[\\boldsymbol{\\xi}]) - \\text{II}_{\\mathbf{X}}(\\boldsymbol{\\xi}, \\text{grad} f(\\mathbf{X}))$$\n\u5176\u4e2d$\\text{II}_{\\mathbf{X}}$\u662f\u7b2c\u4e8c\u57fa\u672c\u5f62\u5f0f\uff0c\u523b\u753b\u4e86\u6d41\u5f62\u7684\u5916\u5728\u66f2\u7387\u3002\u7b2c\u4e8c\u9879\u53cd\u6620\u4e86\u6d41\u5f62\u5f2f\u66f2\u5bf9Hessian\u7684\u8d21\u732e\u3002</p>\n<p><strong>\u5177\u4f53\u6d41\u5f62\u7684Hessian\u8ba1\u7b97</strong>\uff1a</p>\n<p><em>Stiefel\u6d41\u5f62</em>\uff1a\u5bf9\u4e8e$\\boldsymbol{\\xi} \\in T_{\\mathbf{X}}\\mathcal{V}$\uff0c\n$$\\text{Hess} f(\\mathbf{X})[\\boldsymbol{\\xi}] = \\text{Proj}_{T_{\\mathbf{X}}\\mathcal{V}}(\\text{D}^2f(\\mathbf{X})[\\boldsymbol{\\xi}]) + \\mathbf{X}\\text{sym}(\\boldsymbol{\\xi}^T\\nabla f(\\mathbf{X}))$$\n\u7b2c\u4e8c\u9879\u6765\u81ea\u7b2c\u4e8c\u57fa\u672c\u5f62\u5f0f\uff0c\u53cd\u6620\u4e86\u6b63\u4ea4\u7ea6\u675f\u7684\u5f71\u54cd\u3002</p>\n<p><em>\u6b63\u5b9a\u77e9\u9635\uff08\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf\uff09</em>\uff1a\n$$\\text{Hess} f(\\mathbf{X})[\\boldsymbol{\\xi}] = \\mathbf{X}\\text{sym}(\\text{D}^2f(\\mathbf{X})[\\boldsymbol{\\xi}] - \\text{D}f(\\mathbf{X})[\\mathbf{X}^{-1}\\boldsymbol{\\xi}])\\mathbf{X}$$\n\u8fd9\u4e2a\u516c\u5f0f\u5c55\u793a\u4e86\u5ea6\u91cf\u9009\u62e9\u5982\u4f55\u5f71\u54cdHessian\u7684\u5f62\u5f0f\u3002</p>\n<p><strong>Hessian-\u5411\u91cf\u79ef\u7684\u9ad8\u6548\u8ba1\u7b97</strong>\uff1a\u76f4\u63a5\u6784\u9020Hessian\u77e9\u9635\u5728\u9ad8\u7ef4\u60c5\u51b5\u4e0b\u4e0d\u53ef\u884c\u3002\u5b9e\u8df5\u4e2d\u4f7f\u7528\uff1a</p>\n<ol>\n<li><strong>\u6709\u9650\u5dee\u5206\u8fd1\u4f3c</strong>\uff1a\n$$\\text{Hess} f(\\mathbf{X})[\\boldsymbol{\\xi}] \\approx \\frac{1}{\\epsilon}[\\text{grad} f(\\mathcal{R}_{\\mathbf{X}}(\\epsilon\\boldsymbol{\\xi})) - \\mathcal{T}_{\\epsilon\\boldsymbol{\\xi}}^{-1}(\\text{grad} f(\\mathbf{X}))]$$</li>\n</ol>\n<ul>\n<li>\u6b65\u957f\u9009\u62e9\uff1a$\\epsilon = \\sqrt{\\text{machine precision}} \\cdot |\\boldsymbol{\\xi}|$</li>\n<li>\u8bef\u5dee\u5206\u6790\uff1a$O(\\epsilon)$\u622a\u65ad\u8bef\u5dee + $O(1/\\epsilon)$\u820d\u5165\u8bef\u5dee</li>\n<li>\u4e2d\u5fc3\u5dee\u5206\uff1a\u66f4\u9ad8\u7cbe\u5ea6\u4f46\u9700\u8981\u4e24\u6b21\u8bc4\u4f30</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u81ea\u52a8\u5fae\u5206</strong>\uff1a\u5229\u7528\u53cd\u5411\u6a21\u5f0f\u81ea\u52a8\u5fae\u5206\u8ba1\u7b97\u7cbe\u786e\u7684Hessian-\u5411\u91cf\u79ef\n   - \u590d\u6742\u5ea6\uff1a$O(n)$\u5185\u5b58\uff0c$O(n)$\u65f6\u95f4\n   - \u5b9e\u73b0\uff1a<code>torch.autograd.grad</code>\u4e8c\u6b21\u8c03\u7528\n   - \u4f18\u52bf\uff1a\u7cbe\u786e\u4e14\u65e0\u9700\u8c03\u53c2</p>\n</li>\n<li>\n<p><strong>BFGS\u8fd1\u4f3c</strong>\uff1a\u7ef4\u62a4Hessian\u7684\u4f4e\u79e9\u8fd1\u4f3c\uff0c\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u95ee\u9898\n   - L-BFGS\uff1a\u53ea\u5b58\u50a8$m$\u5bf9\u5411\u91cf\uff0c$O(mn)$\u5185\u5b58\n   - \u66f4\u65b0\u516c\u5f0f\uff1a\u4fdd\u6301\u6b63\u5b9a\u6027\u548c\u5bf9\u79f0\u6027\n   - \u521d\u59cb\u5316\uff1a\u4f7f\u7528\u5ea6\u91cf\u4fe1\u606f\u6539\u5584\u6027\u80fd</p>\n</li>\n</ol>\n<p><strong>Hessian\u7684\u6027\u8d28\u4e0e\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li><strong>\u81ea\u4f34\u6027</strong>\uff1a\u76f8\u5bf9\u4e8e\u6240\u9009\u5ea6\u91cf\uff0cHessian\u662f\u81ea\u4f34\u7b97\u5b50</li>\n<li>\u610f\u4e49\uff1a$g(\\text{Hess}f[\\boldsymbol{\\xi}], \\boldsymbol{\\eta}) = g(\\boldsymbol{\\xi}, \\text{Hess}f[\\boldsymbol{\\eta}])$</li>\n<li>\u5e94\u7528\uff1a\u4fdd\u8bc1\u7279\u5f81\u503c\u4e3a\u5b9e\u6570</li>\n<li><strong>\u4e34\u754c\u70b9\u5206\u7c7b</strong>\uff1a\u6b63\u5b9aHessian\u8868\u793a\u5c40\u90e8\u6700\u5c0f\u503c</li>\n<li>\u5145\u5206\u6761\u4ef6\uff1a$\\lambda_{\\min}(\\text{Hess}f) &gt; 0$</li>\n<li>\u978d\u70b9\u68c0\u6d4b\uff1a\u5b58\u5728\u8d1f\u7279\u5f81\u503c</li>\n<li>\u9000\u5316\u60c5\u51b5\uff1a\u96f6\u7279\u5f81\u503c\u9700\u8981\u9ad8\u9636\u68c0\u9a8c</li>\n<li><strong>\u6536\u655b\u901f\u5ea6</strong>\uff1aHessian\u7684\u6761\u4ef6\u6570\u5f71\u54cdNewton\u6cd5\u7684\u6536\u655b\u901f\u5ea6</li>\n<li>\u4e8c\u6b21\u6536\u655b\u57df\uff1a$|\\mathbf{X} - \\mathbf{X}^*| &lt; \\frac{2\\mu}{3L}$</li>\n<li>\u6536\u655b\u7387\uff1a$|\\mathbf{X}_{k+1} - \\mathbf{X}^*| \\leq C|\\mathbf{X}_k - \\mathbf{X}^*|^2$</li>\n<li><strong>\u8d1f\u66f2\u7387\u5229\u7528</strong>\uff1a\u5728\u975e\u51f8\u4f18\u5316\u4e2d\uff0c\u8d1f\u7279\u5f81\u503c\u65b9\u5411\u53ef\u7528\u4e8e\u9003\u79bb\u978d\u70b9</li>\n<li>\u4fe1\u8d56\u57df\u65b9\u6cd5\uff1a\u81ea\u7136\u5904\u7406\u8d1f\u66f2\u7387</li>\n<li>cubic regularization\uff1a\u7406\u8bba\u4fdd\u8bc1\u9003\u79bb</li>\n<li>\u968f\u673a\u6270\u52a8\uff1a\u5b9e\u7528\u7684\u9003\u79bb\u7b56\u7565</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u6d41\u5f62\u4e0a\u7684\u62dfNewton\u65b9\u6cd5\u5982\u4f55\u6700\u4f18\u5730\u5229\u7528\u66f2\u7387\u4fe1\u606f\u4ecd\u6709\u6539\u8fdb\u7a7a\u95f4\u3002\u7279\u522b\u662f\uff0c\u5982\u4f55\u8bbe\u8ba1\u4fdd\u6301\u6d41\u5f62\u7ed3\u6784\u7684\u79e9-1\u6216\u79e9-2\u66f4\u65b0\u516c\u5f0f\u3002</p>\n<h3 id=\"1023\">10.2.3 \u4e8c\u9636\u4f18\u5316\u7b97\u6cd5</h3>\n<p>\u4e8c\u9636\u65b9\u6cd5\u5229\u7528Hessian\u4fe1\u606f\u5b9e\u73b0\u66f4\u5feb\u7684\u5c40\u90e8\u6536\u655b\u3002\u5728\u6d41\u5f62\u4e0a\u5b9e\u73b0\u8fd9\u4e9b\u65b9\u6cd5\u9700\u8981\u4ed4\u7ec6\u5904\u7406\u51e0\u4f55\u7ed3\u6784\u3002</p>\n<p><strong>\u4e8c\u9636\u65b9\u6cd5\u7684\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li><strong>\u8d85\u7ebf\u6027\u6536\u655b</strong>\uff1a\u5728\u6700\u5c0f\u503c\u9644\u8fd1\u8fdc\u5feb\u4e8e\u4e00\u9636\u65b9\u6cd5</li>\n<li><strong>\u5c3a\u5ea6\u4e0d\u53d8\u6027</strong>\uff1a\u5bf9\u53d8\u91cf\u7ebf\u6027\u53d8\u6362\u4e0d\u654f\u611f</li>\n<li><strong>\u9002\u5e94\u6027</strong>\uff1a\u81ea\u52a8\u9002\u5e94\u95ee\u9898\u7684\u5c40\u90e8\u51e0\u4f55</li>\n</ul>\n<p><strong>Riemannian Newton\u6cd5</strong>\uff1a\u6c42\u89e3\u5207\u7a7a\u95f4\u4e2d\u7684Newton\u65b9\u7a0b\n$$\\text{Hess} f(\\mathbf{X}_k)[\\boldsymbol{\\eta}_k] = -\\text{grad} f(\\mathbf{X}_k)$$\n\u7136\u540e\u6cbf\u56de\u7f29\u66f4\u65b0\uff1a$\\mathbf{X}_{k+1} = \\mathcal{R}_{\\mathbf{X}_k}(\\alpha_k \\boldsymbol{\\eta}_k)$</p>\n<p>\u5173\u952e\u5b9e\u73b0\u7ec6\u8282\uff1a</p>\n<ul>\n<li><strong>\u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3</strong>\uff1a\u5229\u7528\u5171\u8f6d\u68af\u5ea6\u6cd5\u6c42\u89e3Newton\u65b9\u7a0b\uff0c\u907f\u514d\u663e\u5f0f\u6784\u9020Hessian</li>\n<li><strong>\u6b63\u5219\u5316</strong>\uff1a\u6dfb\u52a0$\\lambda\\mathbf{I}$\u786e\u4fdd\u6b63\u5b9a\u6027\uff0c$(\\text{Hess} f + \\lambda\\mathbf{I})[\\boldsymbol{\\eta}] = -\\text{grad} f$</li>\n<li><strong>\u6b65\u957f\u9009\u62e9</strong>\uff1aArmijo\u56de\u6eaf\u6216\u7cbe\u786e\u7ebf\u641c\u7d22\uff0c\u6ce8\u610f\u5728\u6d41\u5f62\u4e0a\u8bc4\u4f30\u51fd\u6570\u503c</li>\n</ul>\n<p><strong>Riemannian\u4fe1\u8d56\u57df\u6cd5</strong>\uff1a\u5728\u5207\u7a7a\u95f4\u4e2d\u6c42\u89e3\u5b50\u95ee\u9898\n$$\\min_{\\boldsymbol{\\eta} \\in T_{\\mathbf{X}}\\mathcal{M}} m_{\\mathbf{X}}(\\boldsymbol{\\eta}) = f(\\mathbf{X}) + g_{\\mathbf{X}}(\\text{grad} f(\\mathbf{X}), \\boldsymbol{\\eta}) + \\frac{1}{2}g_{\\mathbf{X}}(\\text{Hess} f(\\mathbf{X})[\\boldsymbol{\\eta}], \\boldsymbol{\\eta})$$\nsubject to $|\\boldsymbol{\\eta}|_{\\mathbf{X}} \\leq \\Delta$</p>\n<p>\u4fe1\u8d56\u57df\u65b9\u6cd5\u5bf9\u975e\u51f8\u95ee\u9898\u7279\u522b\u6709\u6548\uff0c\u80fd\u591f\u5229\u7528\u8d1f\u66f2\u7387\u65b9\u5411\u3002\u5b50\u95ee\u9898\u6c42\u89e3\u7b56\u7565\uff1a</p>\n<ul>\n<li><strong>Steihaug-Toint CG</strong>\uff1a\u5f53\u9047\u5230\u8d1f\u66f2\u7387\u6216\u8fbe\u5230\u4fe1\u8d56\u57df\u8fb9\u754c\u65f6\u63d0\u524d\u7ec8\u6b62</li>\n<li><strong>Lanczos\u65b9\u6cd5</strong>\uff1a\u6784\u9020Krylov\u5b50\u7a7a\u95f4\u4e2d\u7684\u8fd1\u4f3c\u89e3</li>\n<li><strong>\u7cbe\u786e\u6c42\u89e3</strong>\uff1a\u5bf9\u4e8e\u5c0f\u89c4\u6a21\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u7279\u5f81\u5206\u89e3\u7cbe\u786e\u6c42\u89e3</li>\n</ul>\n<p><strong>Riemannian BFGS</strong>\uff1a\u7ef4\u62a4Hessian\u9006\u7684\u8fd1\u4f3c$\\mathbf{H}_k$\uff0c\u66f4\u65b0\u516c\u5f0f\u9700\u8981\u8003\u8651\u5411\u91cf\u4f20\u8f93\uff1a\n$$\\mathbf{H}_{k+1} = \\mathcal{T}_{\\alpha_k\\boldsymbol{\\eta}_k}(\\mathbf{H}_k) + \\text{\u79e9-2\u4fee\u6b63}$$\n\u5176\u4e2d\u79e9-2\u4fee\u6b63\u786e\u4fdd\u5272\u7ebf\u6761\u4ef6\uff1a$\\mathbf{H}_{k+1}\\mathbf{y}_k = \\mathbf{s}_k$\uff0c\u8fd9\u91cc$\\mathbf{s}_k$\u548c$\\mathbf{y}_k$\u662f\u4f20\u8f93\u540e\u7684\u6b65\u957f\u548c\u68af\u5ea6\u5dee\u3002</p>\n<p><strong>Limited-memory BFGS (L-BFGS)</strong>\uff1a\u53ea\u5b58\u50a8\u6700\u8fd1$m$\u5bf9\u5411\u91cf${\\mathbf{s}_i, \\mathbf{y}_i}$\uff0c\u901a\u8fc7\u4e24\u904d\u9012\u5f52\u8ba1\u7b97\u641c\u7d22\u65b9\u5411\u3002\u6d41\u5f62\u7248\u672c\u9700\u8981\uff1a</p>\n<ul>\n<li>\u5386\u53f2\u5411\u91cf\u7684\u4f20\u8f93</li>\n<li>\u521d\u59cbHessian\u8fd1\u4f3c\u7684\u9009\u62e9\uff08\u53ef\u4ee5\u5229\u7528\u6d41\u5f62\u5ea6\u91cf\uff09</li>\n<li>\u5904\u7406\u66f2\u7387\u4fe1\u606f\u7684\u7b56\u7565</li>\n</ul>\n<p><strong>\u6536\u655b\u6027\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li><strong>\u5c40\u90e8\u6536\u655b</strong>\uff1aNewton\u6cd5\u5728\u975e\u9000\u5316\u6700\u5c0f\u503c\u9644\u8fd1\u8fbe\u5230\u4e8c\u6b21\u6536\u655b</li>\n<li>\u6536\u655b\u6761\u4ef6\uff1a$\\mu I \\preceq \\text{Hess}f \\preceq LI$</li>\n<li>\u6536\u655b\u901f\u7387\uff1a$|\\mathbf{X}_{k+1} - \\mathbf{X}^*| \\leq \\frac{L}{2\\mu^2}|\\mathbf{X}_k - \\mathbf{X}^*|^2$</li>\n<li>\u6536\u655b\u57df\uff1a\u4f9d\u8d56\u4e8e$L/\\mu$\u548c\u5185\u5c04\u534a\u5f84</li>\n<li><strong>\u5168\u5c40\u6536\u655b</strong>\uff1a\u4fe1\u8d56\u57df\u65b9\u6cd5\u4fdd\u8bc1\u6536\u655b\u5230\u4e00\u9636\u9a7b\u70b9</li>\n<li>Cauchy\u70b9\u6761\u4ef6\uff1a\u4fdd\u8bc1\u5145\u5206\u4e0b\u964d</li>\n<li>\u4fe1\u8d56\u57df\u8c03\u6574\uff1a\u57fa\u4e8e\u6a21\u578b\u51c6\u786e\u6027</li>\n<li>\u6700\u7ec8\u6536\u655b\uff1a$\\liminf_{k\\to\\infty} |\\text{grad}f(\\mathbf{X}_k)| = 0$</li>\n<li><strong>\u590d\u6742\u5ea6</strong>\uff1a\u6bcf\u6b21\u8fed\u4ee3$O(n^3)$\uff08Newton\uff09\u6216$O(mn)$\uff08L-BFGS\uff09</li>\n<li>\u5185\u5b58\u9700\u6c42\uff1aNewton $O(n^2)$\uff0cL-BFGS $O(mn)$</li>\n<li>\u8fed\u4ee3\u6b21\u6570\uff1aNewton\u901a\u5e38\u66f4\u5c11</li>\n<li>\u5b9e\u9645\u9009\u62e9\uff1a\u4f9d\u8d56\u4e8e\u95ee\u9898\u89c4\u6a21\u548c\u7cbe\u5ea6\u8981\u6c42</li>\n</ul>\n<h3 id=\"1024\">10.2.4 \u66f2\u7387\u7684\u5f71\u54cd</h3>\n<p>\u6d41\u5f62\u7684\u5185\u5728\u66f2\u7387\u6df1\u523b\u5f71\u54cd\u4f18\u5316\u7b97\u6cd5\u7684\u884c\u4e3a\u3002\u7406\u89e3\u8fd9\u79cd\u5f71\u54cd\u5bf9\u4e8e\u7b97\u6cd5\u8bbe\u8ba1\u548c\u5206\u6790\u81f3\u5173\u91cd\u8981\u3002</p>\n<p><strong>\u66f2\u7387\u7684\u51e0\u4f55\u5b66\u8d77\u6e90</strong>\uff1a\u66f2\u7387\u6d4b\u91cf\u6d41\u5f62\u504f\u79bb\u5e73\u5766\u7a7a\u95f4\u7684\u7a0b\u5ea6\u3002\u5728\u4f18\u5316\u4e2d\uff0c\u5b83\u5f71\u54cd\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u6d41\u7684\u53d1\u6563/\u6536\u655b\u884c\u4e3a</li>\n<li>\u5e73\u884c\u79fb\u52a8\u7684\u53d8\u5f62</li>\n<li>\u5c40\u90e8\u51f8\u6027\u7684\u4fdd\u6301\u8303\u56f4</li>\n</ul>\n<p><strong>\u622a\u9762\u66f2\u7387\u7684\u4f5c\u7528</strong>\uff1a</p>\n<ul>\n<li><strong>\u6b63\u66f2\u7387</strong>\uff08\u5982\u7403\u9762\uff09\uff1a\u68af\u5ea6\u6d41\u8d8b\u5411\u4e8e\u6bd4\u6b27\u6c0f\u7a7a\u95f4\u66f4\u5feb\u5730\u6536\u655b\uff0c\u56e0\u4e3a\u6d4b\u5730\u7ebf\u4f1a\u805a</li>\n<li><strong>\u8d1f\u66f2\u7387</strong>\uff08\u5982\u53cc\u66f2\u7a7a\u95f4\uff09\uff1a\u53ef\u80fd\u5bfc\u81f4\u4e0d\u7a33\u5b9a\uff0c\u6d4b\u5730\u7ebf\u53d1\u6563</li>\n<li><strong>\u6df7\u5408\u66f2\u7387</strong>\uff1a\u5927\u591a\u6570\u5b9e\u9645\u6d41\u5f62\uff0c\u9700\u8981\u5c40\u90e8\u5206\u6790</li>\n</ul>\n<p><strong>Rayleigh\u5546\u4f18\u5316</strong>\uff1a\u5728\u5355\u4f4d\u7403\u9762$S^{n-1}$\u4e0a\u6700\u5c0f\u5316$f(\\mathbf{x}) = \\mathbf{x}^T\\mathbf{A}\\mathbf{x}$\u3002\u7403\u9762\u7684\u5e38\u6b63\u66f2\u7387$\\kappa = 1$\u52a0\u901f\u6536\u655b\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u6d41\u7684\u5438\u5f15\u76c6\u66f4\u5927</li>\n<li>\u9003\u79bb\u978d\u70b9\u66f4\u5bb9\u6613</li>\n<li>\u6536\u655b\u901f\u5ea6\u4f9d\u8d56\u4e8e\u7279\u5f81\u503c\u95f4\u9699\u548c\u66f2\u7387\u7684\u76f8\u4e92\u4f5c\u7528</li>\n</ul>\n<p><strong>\u66f2\u7387\u4fee\u6b63\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li><strong>\u52a8\u91cf\u4fee\u6b63</strong>\uff1aRiemannian\u52a0\u901f\u68af\u5ea6\u4e2d\uff0c\u52a8\u91cf\u9879\u9700\u8981\u6839\u636e\u66f2\u7387\u8c03\u6574\n$$\\boldsymbol{\\mu}_{k+1} = \\gamma\\mathcal{T}_{\\alpha_k\\boldsymbol{\\xi}_k}(\\boldsymbol{\\mu}_k) - \\alpha_k\\text{grad} f(\\mathbf{X}_{k+1}) + \\mathcal{K}(\\boldsymbol{\\mu}_k, \\boldsymbol{\\xi}_k)$$\n\u5176\u4e2d$\\mathcal{K}$\u662f\u66f2\u7387\u4fee\u6b63\u7b97\u5b50\uff1a</li>\n</ol>\n<ul>\n<li>\u4e00\u9636\u8fd1\u4f3c\uff1a$\\mathcal{K} = O(|\\boldsymbol{\\xi}|^2)$</li>\n<li>\u5b9e\u7528\u5f62\u5f0f\uff1a\u57fa\u4e8eRicci\u66f2\u7387\u7684\u4f30\u8ba1</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u9884\u6761\u4ef6\u8bbe\u8ba1</strong>\uff1a\u5229\u7528Ricci\u66f2\u7387\u4fe1\u606f\u8bbe\u8ba1\u66f4\u597d\u7684\u9884\u6761\u4ef6\u5b50\n   - \u66f2\u7387\u81ea\u9002\u5e94\uff1a$\\mathbf{P} = \\mathbf{I} + \\beta\\text{Ric}$\n   - \u5b9e\u73b0\u6311\u6218\uff1a\u9ad8\u6548\u8ba1\u7b97Ricci\u66f2\u7387\n   - \u8fd1\u4f3c\u65b9\u6cd5\uff1a\u4f7f\u7528\u91c7\u6837\u4f30\u8ba1</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7b97\u6cd5</strong>\uff1a\u6839\u636e\u5c40\u90e8\u66f2\u7387\u4f30\u8ba1\u52a8\u6001\u8c03\u6574\u6b65\u957f\u548c\u5176\u4ed6\u53c2\u6570\n   - \u66f2\u7387\u4f30\u8ba1\uff1a\u901a\u8fc7\u6d4b\u5730\u7ebf\u504f\u5dee\n   - \u6b65\u957f\u9009\u62e9\uff1a$\\alpha_k = \\min(\\bar{\\alpha}, c/\\sqrt{|\\kappa|})$\n   - \u6536\u655b\u4fdd\u8bc1\uff1a\u5728\u6709\u754c\u66f2\u7387\u5047\u8bbe\u4e0b</p>\n</li>\n</ol>\n<p><strong>\u66f2\u7387\u4e0e\u4f18\u5316landscape\u7684\u5173\u7cfb</strong>\uff1a</p>\n<ul>\n<li><strong>\u6b63\u66f2\u7387\u533a\u57df</strong>\uff1a\u901a\u5e38\u5bf9\u5e94\u51f8\u533a\u57df\uff0c\u4f18\u5316\u76f8\u5bf9\u5bb9\u6613</li>\n<li>\u7403\u9762\u4f8b\u5b50\uff1a\u5e38\u6b63\u66f2\u7387\u52a0\u901f\u7279\u5f81\u503c\u8ba1\u7b97</li>\n<li>\u5b9a\u91cf\u5206\u6790\uff1a\u6536\u655b\u901f\u7387\u63d0\u5347$(1 + \\kappa)$\u500d</li>\n<li><strong>\u8d1f\u66f2\u7387\u533a\u57df</strong>\uff1a\u53ef\u80fd\u5b58\u5728\u591a\u4e2a\u5c40\u90e8\u6700\u4f18\uff0c\u9700\u8981\u5168\u5c40\u7b56\u7565</li>\n<li>\u53cc\u66f2\u9762\u4f8b\u5b50\uff1a\u6307\u6570\u53d1\u6563\u5bfc\u81f4\u4e0d\u7a33\u5b9a</li>\n<li>\u5e94\u5bf9\u7b56\u7565\uff1a\u8f83\u5c0f\u6b65\u957f\u6216\u9002\u5e94\u6027\u9884\u6761\u4ef6</li>\n<li><strong>\u96f6\u66f2\u7387\u65b9\u5411</strong>\uff1a\u53ef\u80fd\u5bfc\u81f4\u6536\u655b\u53d8\u6162\uff0c\u9700\u8981\u7279\u6b8a\u5904\u7406</li>\n<li>\u5e73\u5766\u533a\u57df\uff1a\u4f7f\u7528\u52a8\u91cf\u6216\u81ea\u9002\u5e94\u65b9\u6cd5</li>\n<li>\u9000\u5316\u60c5\u51b5\uff1a\u53ef\u80fd\u9700\u8981\u6b63\u5219\u5316</li>\n</ul>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u5982\u4f55\u7cfb\u7edf\u5730\u5229\u7528\u6d41\u5f62\u7684\u5168\u5c40\u62d3\u6251\u548c\u51e0\u4f55\u4fe1\u606f\u6765\u8bbe\u8ba1\u66f4\u667a\u80fd\u7684\u4f18\u5316\u7b97\u6cd5\u4ecd\u662f\u5f00\u653e\u95ee\u9898\u3002\u7279\u522b\u662f\uff0c\u80fd\u5426\u901a\u8fc7\u5b66\u4e60\u6d41\u5f62\u7684\u51e0\u4f55\u6765\u52a0\u901f\u4f18\u5316\uff1f</p>\n<h2 id=\"103\">10.3 \u56de\u7f29\u4e0e\u5411\u91cf\u4f20\u8f93</h2>\n<p>\u867d\u7136\u6307\u6570\u6620\u5c04\u63d0\u4f9b\u4e86\u7406\u8bba\u4e0a\u4f18\u96c5\u7684\u6d41\u5f62\u66f4\u65b0\u65b9\u5f0f\uff0c\u4f46\u5176\u8ba1\u7b97\u6210\u672c\u5f80\u5f80\u8fc7\u9ad8\u3002\u56de\u7f29\uff08retraction\uff09\u63d0\u4f9b\u4e86\u8ba1\u7b97\u53cb\u597d\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u800c\u5411\u91cf\u4f20\u8f93\uff08vector transport\uff09\u5219\u662f\u5b9e\u73b0\u9ad8\u6548\u8fed\u4ee3\u7b97\u6cd5\u7684\u5173\u952e\u7ec4\u4ef6\u3002\u8fd9\u4e24\u4e2a\u6982\u5ff5\u7684\u5de7\u5999\u8bbe\u8ba1\u5f80\u5f80\u51b3\u5b9a\u4e86\u6d41\u5f62\u4f18\u5316\u7b97\u6cd5\u7684\u5b9e\u7528\u6027\u3002</p>\n<p><strong>\u6838\u5fc3\u601d\u60f3</strong>\uff1a\u56de\u7f29\u548c\u5411\u91cf\u4f20\u8f93\u662f\u6307\u6570\u6620\u5c04\u548c\u5e73\u884c\u79fb\u52a8\u7684\u201c\u5de5\u7a0b\u8fd1\u4f3c\u201d\u3002\u5b83\u4eec\u727a\u7272\u4e00\u4e9b\u7406\u8bba\u7f8e\u611f\u6765\u6362\u53d6\u8ba1\u7b97\u6548\u7387\uff0c\u4f46\u4fdd\u7559\u4e86\u8db3\u591f\u7684\u51e0\u4f55\u7ed3\u6784\u4ee5\u4fdd\u8bc1\u7b97\u6cd5\u6536\u655b\u6027\u3002</p>\n<h3 id=\"1031\">10.3.1 \u56de\u7f29\u6620\u5c04</h3>\n<p>\u56de\u7f29$\\mathcal{R}: T\\mathcal{M} \\to \\mathcal{M}$\u662f\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u5149\u6ed1\u6620\u5c04\uff1a</p>\n<ol>\n<li>$\\mathcal{R}_{\\mathbf{X}}(\\mathbf{0}) = \\mathbf{X}$\uff08\u4fdd\u6301\u539f\u70b9\uff09</li>\n<li>$\\text{D}\\mathcal{R}_{\\mathbf{X}}(\\mathbf{0})[\\boldsymbol{\\xi}] = \\boldsymbol{\\xi}$\uff08\u5c40\u90e8\u521a\u6027\uff09</li>\n</ol>\n<p>\u56de\u7f29\u63d0\u4f9b\u4e86\u4ece\u5207\u7a7a\u95f4\"\u56de\u5230\"\u6d41\u5f62\u7684\u65b9\u5f0f\uff0c\u4e14\u4fdd\u8bc1\u4e86\u4e00\u9636\u8fd1\u4f3c\u7684\u6b63\u786e\u6027\u3002\u5bf9\u4e8e\u4e8c\u9636\u65b9\u6cd5\uff0c\u53ef\u80fd\u9700\u8981\u66f4\u5f3a\u7684\u6027\u8d28\uff1a</p>\n<ul>\n<li><strong>\u4e8c\u9636\u56de\u7f29</strong>\uff1a$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\exp_{\\mathbf{X}}(\\boldsymbol{\\xi}) + O(|\\boldsymbol{\\xi}|^3)$</li>\n<li><strong>\u51f8\u7ec4\u5408\u6027\u8d28</strong>\uff1a\u67d0\u4e9b\u56de\u7f29\u4fdd\u6301\u6d4b\u5730\u51f8\u7ec4\u5408\u7684\u6027\u8d28</li>\n</ul>\n<p><strong>\u5e38\u7528\u56de\u7f29\u6620\u5c04</strong>\uff1a</p>\n<p><em>QR\u56de\u7f29</em>\uff08Stiefel\u6d41\u5f62\uff09\uff1a\n$$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\text{qf}(\\mathbf{X} + \\boldsymbol{\\xi})$$\n\u5176\u4e2d$\\text{qf}(\\cdot)$\u8868\u793a\u8584QR\u5206\u89e3\u7684Q\u56e0\u5b50\u3002</p>\n<p>\u4f18\u70b9\uff1a</p>\n<ul>\n<li>\u6570\u503c\u7a33\u5b9a\uff0c\u57fa\u4e8eHouseholder\u6216Givens\u53d8\u6362</li>\n<li>\u8ba1\u7b97\u9ad8\u6548\uff1a$O(nk^2)$</li>\n<li>\u81ea\u7136\u5904\u7406$k \\ll n$\u7684\u60c5\u51b5</li>\n</ul>\n<p>\u5b9e\u73b0\u7ec6\u8282\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u5217\u4e3b\u5bfc\u7684\u4fee\u6b63Gram-Schmidt\u4ee5\u63d0\u9ad8\u7a33\u5b9a\u6027</li>\n<li>\u5f53$\\mathbf{X} + \\boldsymbol{\\xi}$\u63a5\u8fd1\u79e9\u4e8f\u65f6\u9700\u8981\u7279\u6b8a\u5904\u7406</li>\n</ul>\n<p><em>\u6781\u56de\u7f29</em>\uff08Stiefel\u6d41\u5f62\uff09\uff1a\n$$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = (\\mathbf{X} + \\boldsymbol{\\xi})(\\mathbf{I} + \\boldsymbol{\\xi}^T\\boldsymbol{\\xi})^{-1/2}$$\n\u57fa\u4e8e\u6781\u5206\u89e3\uff0c\u4fdd\u6301\u4e86\u66f4\u591a\u51e0\u4f55\u6027\u8d28\uff1a</p>\n<ul>\n<li>\u6700\u77ed\u8def\u5f84\u6027\u8d28\uff1a\u5728\u67d0\u79cd\u610f\u4e49\u4e0b\u6700\u5c0f\u5316$|\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) - (\\mathbf{X} + \\boldsymbol{\\xi})|_F$</li>\n<li>\u4fdd\u6301\u5947\u5f02\u503c\u7684\u5355\u8c03\u6027</li>\n<li>\u8ba1\u7b97\uff1a$O(nk^2 + k^3)$\uff0c\u77e9\u9635\u5e73\u65b9\u6839\u53ef\u7528Denman-Beavers\u8fed\u4ee3</li>\n</ul>\n<p><em>\u6295\u5f71\u56de\u7f29</em>\uff08\u56fa\u5b9a\u79e9\u6d41\u5f62\uff09\uff1a\u8bbe$\\mathbf{Y} = \\mathbf{X} + \\boldsymbol{\\xi}$\uff0c\u8ba1\u7b97\u5176\u622a\u65adSVD\n$$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\mathcal{P}_r(\\mathbf{Y}) = \\sum_{i=1}^r \\sigma_i \\mathbf{u}_i \\mathbf{v}_i^T$$\n\u5173\u952e\u4f18\u5316\uff1a\u5229\u7528$\\boldsymbol{\\xi}$\u7684\u7ed3\u6784\u907f\u514d\u5b8c\u6574SVD\uff1a</p>\n<ol>\n<li>\u82e5$\\boldsymbol{\\xi} = \\mathbf{U}_X\\mathbf{M}\\mathbf{V}_X^T + \\mathbf{U}_\\perp\\mathbf{N}\\mathbf{V}_X^T + \\mathbf{U}_X\\mathbf{P}^T\\mathbf{V}_\\perp^T$</li>\n<li>\u5219\u53ea\u9700\u5bf9$(2r) \\times (2r)$\u77e9\u9635\u8fdb\u884cSVD</li>\n<li>\u603b\u590d\u6742\u5ea6\uff1a$O((m+n)r^2)$\u800c\u975e$O(mn\\min(m,n))$</li>\n</ol>\n<p><em>\u6d4b\u5730\u56de\u7f29</em>\uff08\u6b63\u5b9a\u77e9\u9635\uff09\uff1a\n$$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\mathbf{X}^{1/2}\\exp(\\mathbf{X}^{-1/2}\\boldsymbol{\\xi}\\mathbf{X}^{-1/2})\\mathbf{X}^{1/2}$$\n\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\u6307\u6570\u6620\u5c04\uff0c\u5c55\u793a\u4e86\u67d0\u4e9b\u6d41\u5f62\u4e0a\u56de\u7f29\u53ef\u4ee5\u9ad8\u6548\u8ba1\u7b97\u3002</p>\n<p><strong>\u56de\u7f29\u7684\u9009\u62e9\u539f\u5219</strong>\uff1a</p>\n<ol>\n<li><strong>\u8ba1\u7b97\u6548\u7387</strong>\uff1aQR\u56de\u7f29\u901a\u5e38\u6700\u5feb</li>\n<li><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\u907f\u514d\u77e9\u9635\u6c42\u9006\u548c\u75c5\u6001\u8fd0\u7b97</li>\n<li><strong>\u51e0\u4f55\u6027\u8d28</strong>\uff1a\u67d0\u4e9b\u5e94\u7528\u9700\u8981\u4fdd\u6301\u7279\u5b9a\u7684\u51e0\u4f55\u4e0d\u53d8\u91cf</li>\n<li><strong>\u5e76\u884c\u6027</strong>\uff1a\u8003\u8651GPU\u5b9e\u73b0\u7684\u53ef\u884c\u6027</li>\n</ol>\n<p><strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a\u8bbe\u8ba1\u4fdd\u6301\u66f4\u591a\u51e0\u4f55\u6027\u8d28\u540c\u65f6\u8ba1\u7b97\u9ad8\u6548\u7684\u56de\u7f29\u4ecd\u662f\u6d3b\u8dc3\u7814\u7a76\u65b9\u5411\u3002\u7279\u522b\u662f\u5bf9\u4e8e\u4e58\u79ef\u6d41\u5f62\u548c\u590d\u5408\u7ea6\u675f\u7684\u60c5\u51b5\u3002</p>\n<h3 id=\"1032\">10.3.2 \u5411\u91cf\u4f20\u8f93</h3>\n<p>\u5411\u91cf\u4f20\u8f93$\\mathcal{T}_{\\boldsymbol{\\eta}}: T_{\\mathbf{X}}\\mathcal{M} \\to T_{\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\eta})}\\mathcal{M}$\u5c06\u5207\u5411\u91cf\u4ece\u4e00\u4e2a\u5207\u7a7a\u95f4\"\u8fd0\u8f93\"\u5230\u53e6\u4e00\u4e2a\u3002\u8fd9\u5bf9\u4e8e\u9700\u8981\u5386\u53f2\u4fe1\u606f\u7684\u7b97\u6cd5\uff08\u5982\u5171\u8f6d\u68af\u5ea6\u3001BFGS\u3001\u52a8\u91cf\u65b9\u6cd5\uff09\u81f3\u5173\u91cd\u8981\u3002\u5411\u91cf\u4f20\u8f93\u7684\u8d28\u91cf\u76f4\u63a5\u5f71\u54cd\u8fd9\u4e9b\u7b97\u6cd5\u7684\u6536\u655b\u6027\u3002</p>\n<p><strong>\u5e73\u884c\u79fb\u52a8vs\u5411\u91cf\u4f20\u8f93</strong>\uff1a</p>\n<ul>\n<li><strong>\u5e73\u884c\u79fb\u52a8</strong>\uff1a\u4fdd\u6301\u5411\u91cf\u5728Levi-Civita\u8054\u7edc\u610f\u4e49\u4e0b\"\u5e73\u884c\"\uff0c\u4fdd\u6301\u5185\u79ef\u548c\u957f\u5ea6\uff0c\u4f46\u8ba1\u7b97\u590d\u6742</li>\n<li><strong>\u5411\u91cf\u4f20\u8f93</strong>\uff1a\u53ea\u9700\u6ee1\u8db3\u8f83\u5f31\u7684\u76f8\u5bb9\u6027\u6761\u4ef6\uff0c\u5141\u8bb8\u66f4\u9ad8\u6548\u7684\u5b9e\u73b0</li>\n<li><strong>\u5173\u952e\u6027\u8d28</strong>\uff1a\u5bf9\u4e8e\u6536\u655b\u6027\uff0c\u901a\u5e38\u53ea\u9700\u8981\u4f20\u8f93\u662f\u7b49\u8ddd\u7684\u52a0\u4e0a\u4e00\u4e9b\u8fde\u7eed\u6027\u6761\u4ef6</li>\n</ul>\n<p><strong>\u5411\u91cf\u4f20\u8f93\u7684\u5fc5\u8981\u6761\u4ef6</strong>\uff1a</p>\n<ol>\n<li><strong>\u76f8\u5bb9\u6027</strong>\uff1a$\\mathcal{T}_{\\mathbf{0}}(\\boldsymbol{\\zeta}) = \\boldsymbol{\\zeta}$</li>\n<li><strong>\u7ebf\u6027</strong>\uff1a$\\mathcal{T}_{\\boldsymbol{\\eta}}(a\\boldsymbol{\\zeta}_1 + b\\boldsymbol{\\zeta}_2) = a\\mathcal{T}_{\\boldsymbol{\\eta}}(\\boldsymbol{\\zeta}_1) + b\\mathcal{T}_{\\boldsymbol{\\eta}}(\\boldsymbol{\\zeta}_2)$</li>\n<li><strong>\u4e0e\u56de\u7f29\u76f8\u5bb9</strong>\uff1a\u4f20\u8f93\u540e\u7684\u5411\u91cf\u786e\u5b9e\u5728\u76ee\u6807\u5207\u7a7a\u95f4\u4e2d</li>\n</ol>\n<p><strong>\u5e38\u7528\u5411\u91cf\u4f20\u8f93</strong>\uff1a</p>\n<p><em>\u6295\u5f71\u4f20\u8f93</em>\uff1a\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u76f4\u63a5\u6295\u5f71\u5230\u76ee\u6807\u5207\u7a7a\u95f4\n$$\\mathcal{T}_{\\boldsymbol{\\eta}}(\\boldsymbol{\\zeta}) = \\text{Proj}_{T_{\\mathbf{Y}}\\mathcal{M}}(\\boldsymbol{\\zeta}), \\quad \\mathbf{Y} = \\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\eta})$$\n\u4f18\u70b9\uff1a\u5b9e\u73b0\u7b80\u5355\uff0c\u8ba1\u7b97\u5feb\u901f\n\u7f3a\u70b9\uff1a\u4e0d\u4fdd\u6301\u5411\u91cf\u957f\u5ea6\uff0c\u53ef\u80fd\u635f\u5931\u6b63\u4ea4\u6027\n\u9002\u7528\uff1a\u5f53\u8fed\u4ee3\u6b21\u6570\u8f83\u5c11\u6216\u7cbe\u5ea6\u8981\u6c42\u4e0d\u9ad8\u65f6</p>\n<p><em>\u5fae\u5206\u56de\u7f29\u4f20\u8f93</em>\uff1a\u5229\u7528\u56de\u7f29\u7684\u5fae\u5206\u7ed3\u6784\n$$\\mathcal{T}_{\\boldsymbol{\\eta}}(\\boldsymbol{\\zeta}) = \\text{D}\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\eta})[\\boldsymbol{\\zeta}]$$\n\u5bf9\u4e8eQR\u56de\u7f29\uff0c\u6709\u95ed\u5f0f\u8868\u8fbe\uff1a\u8bbe$\\mathbf{X} + \\boldsymbol{\\eta} = \\mathbf{Q}\\mathbf{R}$\uff0c\u5219\n$$\\mathcal{T}_{\\boldsymbol{\\eta}}(\\boldsymbol{\\zeta}) = \\mathbf{Q}\\text{skew}(\\mathbf{Q}^T\\boldsymbol{\\zeta}\\mathbf{R}^{-T}) + (\\mathbf{I} - \\mathbf{Q}\\mathbf{Q}^T)\\boldsymbol{\\zeta}\\mathbf{R}^{-T}$$\n\u5176\u4e2d$\\text{skew}(\\mathbf{A}) = (\\mathbf{A} - \\mathbf{A}^T)/2$\u3002</p>\n<p><em>\u5e73\u884c\u79fb\u52a8\u7684\u8fd1\u4f3c</em>\uff1a\u5bf9\u4e8eStiefel\u6d41\u5f62\uff0cRing-Wirth\u516c\u5f0f\u63d0\u4f9b$O(nk^2)$\u7684\u8fd1\u4f3c\uff1a\n$$\\mathcal{T}_{\\boldsymbol{\\eta}}^{\\text{par}}(\\boldsymbol{\\zeta}) \\approx \\boldsymbol{\\zeta} - \\frac{1}{2}\\mathbf{Y}(\\mathbf{Y}^T\\boldsymbol{\\zeta} + \\boldsymbol{\\zeta}^T\\mathbf{Y})$$\n\u5176\u4e2d$\\mathbf{Y} = \\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\eta})$\u3002</p>\n<p><strong>\u56fa\u5b9a\u79e9\u6d41\u5f62\u7684\u5411\u91cf\u4f20\u8f93</strong>\uff1a\u9700\u8981\u7279\u522b\u6ce8\u610f\u4fdd\u6301\u5207\u5411\u91cf\u7684\u4e09\u90e8\u5206\u7ed3\u6784\u3002\u8bbe\n$$\\boldsymbol{\\zeta} = \\mathbf{U}_X\\mathbf{M}_\\zeta\\mathbf{V}_X^T + \\mathbf{U}_\\perp\\mathbf{N}_\\zeta\\mathbf{V}_X^T + \\mathbf{U}_X\\mathbf{P}_\\zeta^T\\mathbf{V}_\\perp^T$$\n\u4f20\u8f93\u9700\u8981\u66f4\u65b0$\\mathbf{U}_X, \\mathbf{V}_X$\u53ca\u5176\u6b63\u4ea4\u8865\uff0c\u540c\u65f6\u9002\u5f53\u53d8\u6362\u7cfb\u6570\u77e9\u9635$\\mathbf{M}_\\zeta, \\mathbf{N}_\\zeta, \\mathbf{P}_\\zeta$\u3002</p>\n<h3 id=\"1033\">10.3.3 \u7b97\u6cd5\u5b9e\u73b0\u8003\u8651</h3>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u6743\u8861</strong>\uff1a</p>\n<ul>\n<li>\u6307\u6570\u6620\u5c04\uff1a\u7406\u8bba\u6700\u4f18\u4f46\u8ba1\u7b97\u6700\u8d35\uff0c$O(n^3)$\u6216\u66f4\u9ad8</li>\n<li>\u6781\u56de\u7f29\uff1a\u826f\u597d\u7684\u51e0\u4f55\u6027\u8d28\uff0c$O(nk^2 + k^3)$</li>\n<li>QR\u56de\u7f29\uff1a\u5feb\u901f\u7a33\u5b9a\uff0c$O(nk^2)$</li>\n<li>\u6295\u5f71\u4f20\u8f93\uff1a\u6700\u5feb\u4f46\u53ef\u80fd\u635f\u5931\u4fe1\u606f\uff0c$O(nk^2)$</li>\n<li>\u5fae\u5206\u56de\u7f29\u4f20\u8f93\uff1a\u4e2d\u7b49\u590d\u6742\u5ea6\uff0c$O(nk^2)$\uff0c\u4fdd\u6301\u66f4\u591a\u6027\u8d28</li>\n</ul>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>QR\u5206\u89e3</strong>\uff1a\n   - \u4f7f\u7528Householder\u53d8\u6362\u800c\u975eGram-Schmidt\n   - \u5bf9\u4e8e\u9ad8\u7626\u77e9\u9635\uff0c\u8003\u8651TSQR\uff08Tall-Skinny QR\uff09\n   - \u76d1\u63a7$\\mathbf{R}$\u7684\u6761\u4ef6\u6570</p>\n</li>\n<li>\n<p><strong>\u6781\u5206\u89e3</strong>\uff1a\n   - Newton-Schulz\u8fed\u4ee3\uff1a$\\mathbf{X}_{k+1} = \\frac{1}{2}\\mathbf{X}_k(3\\mathbf{I} - \\mathbf{X}_k^T\\mathbf{X}_k)$\n   - \u5f53$|\\boldsymbol{\\xi}|$\u8f83\u5927\u65f6\u5207\u6362\u5230\u7279\u5f81\u5206\u89e3\u65b9\u6cd5\n   - \u4f7f\u7528Halley\u65b9\u6cd5\u83b7\u5f97\u4e09\u9636\u6536\u655b</p>\n</li>\n<li>\n<p><strong>\u6b63\u4ea4\u5316\u7ef4\u62a4</strong>\uff1a\n   - \u5b9a\u671f\u91cd\u6b63\u4ea4\u5316\u9632\u6b62\u6570\u503c\u6f02\u79fb\n   - \u4f7f\u7528\u8fed\u4ee3refinement\uff1a$\\mathbf{X} \\leftarrow \\mathbf{X} - \\frac{1}{2}\\mathbf{X}(\\mathbf{X}^T\\mathbf{X} - \\mathbf{I})$</p>\n</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u9009\u62e9\u51b3\u7b56\u6811</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u95ee\u9898\u89c4\u6a21\uff1f\n\u251c\u2500 \u5c0f\u89c4\u6a21 (n &lt; 1000)\n\u2502  \u2514\u2500 \u4f7f\u7528\u6307\u6570\u6620\u5c04\u548c\u5e73\u884c\u79fb\u52a8\n\u251c\u2500 \u4e2d\u7b49\u89c4\u6a21 (1000 &lt; n &lt; 10000)\n\u2502  \u251c\u2500 \u4e00\u9636\u65b9\u6cd5\uff1aQR\u56de\u7f29 + \u6295\u5f71\u4f20\u8f93\n\u2502  \u2514\u2500 \u4e8c\u9636\u65b9\u6cd5\uff1a\u6781\u56de\u7f29 + \u5fae\u5206\u4f20\u8f93\n\u2514\u2500 \u5927\u89c4\u6a21 (n &gt; 10000)\n   \u251c\u2500 \u7a00\u758f\u7ed3\u6784\uff1f\u2192 \u4e13\u95e8\u8bbe\u8ba1\u7684\u56de\u7f29\n   \u251c\u2500 \u4f4e\u79e9\u7ed3\u6784\uff1f\u2192 \u5229\u7528SVD\u7684\u589e\u91cf\u66f4\u65b0\n   \u2514\u2500 \u4e00\u822c\u60c5\u51b5 \u2192 QR\u56de\u7f29 + \u6295\u5f71\u4f20\u8f93\n</code></pre></div>\n\n<p><strong>\u6027\u80fd\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7f13\u5b58\u7b56\u7565</strong>\uff1a\n   - \u91cd\u7528QR/SVD\u5206\u89e3\u7ed3\u679c\n   - \u5b58\u50a8\u6b63\u4ea4\u8865\u7684\u6295\u5f71\u7b97\u5b50\n   - \u9884\u8ba1\u7b97\u5e38\u7528\u7684\u77e9\u9635\u4e58\u79ef</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316</strong>\uff1a\n   - \u77e9\u9635\u4e58\u6cd5\u4f7f\u7528BLAS Level 3\n   - QR\u5206\u89e3\u7684\u5757\u7b97\u6cd5\n   - \u591a\u4e2a\u5411\u91cf\u7684\u6279\u91cf\u4f20\u8f93</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6</strong>\uff1a\n   - \u521d\u671f\u8fed\u4ee3\u4f7f\u7528\u4f4e\u7cbe\u5ea6\u56de\u7f29\n   - \u63a5\u8fd1\u6536\u655b\u65f6\u63d0\u9ad8\u7cbe\u5ea6\n   - \u57fa\u4e8e\u68af\u5ea6\u8303\u6570\u52a8\u6001\u8c03\u6574</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u8df5\u5efa\u8bae</strong>\uff1a</p>\n<ul>\n<li>\u5148\u7528\u7b80\u5355\u65b9\u6cd5\uff08QR+\u6295\u5f71\uff09\u5efa\u7acbbaseline</li>\n<li>\u4ec5\u5728\u5fc5\u8981\u65f6\u5347\u7ea7\u5230\u590d\u6742\u65b9\u6cd5</li>\n<li>\u59cb\u7ec8\u76d1\u63a7\u7ea6\u675f\u8fdd\u53cd\u7a0b\u5ea6</li>\n<li>\u8003\u8651\u6df7\u5408\u7b56\u7565\uff1a\u4e0d\u540c\u9636\u6bb5\u7528\u4e0d\u540c\u65b9\u6cd5</li>\n</ul>\n<h3 id=\"1034\">10.3.4 \u6536\u655b\u6027\u4fdd\u8bc1</h3>\n<p>\u4f7f\u7528\u56de\u7f29\u548c\u5411\u91cf\u4f20\u8f93\u7684\u7b97\u6cd5\u4ecd\u80fd\u4fdd\u6301\u826f\u597d\u7684\u6536\u655b\u6027\u8d28\uff0c\u5173\u952e\u662f\u7406\u89e3\u51e0\u4f55\u8fd1\u4f3c\u5982\u4f55\u5f71\u54cd\u6536\u655b\u5206\u6790\u3002</p>\n<p><strong>\u4e00\u9636\u65b9\u6cd5\u7684\u6536\u655b\u6027</strong>\uff1a</p>\n<p><em>\u68af\u5ea6\u4e0b\u964d</em>\uff1a\u4f7f\u7528\u4efb\u610f\u56de\u7f29\u7684Riemannian\u68af\u5ea6\u4e0b\u964d</p>\n<ul>\n<li><strong>\u51f8\u51fd\u6570</strong>\uff1a\u4fdd\u6301$O(1/k)$\u6536\u655b\u7387</li>\n<li><strong>\u5f3a\u51f8\u51fd\u6570</strong>\uff1a\u4fdd\u6301\u7ebf\u6027\u6536\u655b\u7387$O(\\rho^k)$\uff0c\u5176\u4e2d$\\rho &lt; 1$</li>\n<li><strong>\u975e\u51f8\u51fd\u6570</strong>\uff1a\u4fdd\u8bc1\u6536\u655b\u5230\u4e00\u9636\u9a7b\u70b9\uff0c$\\min_{i \\leq k} |\\text{grad} f(\\mathbf{X}_i)| = O(1/\\sqrt{k})$</li>\n</ul>\n<p>\u5173\u952e\u5047\u8bbe\uff1a\u56de\u7f29\u5728\u7d27\u96c6\u4e0aLipschitz\u8fde\u7eed\u3002</p>\n<p><strong>\u4e8c\u9636\u65b9\u6cd5\u7684\u6536\u655b\u6027</strong>\uff1a</p>\n<p><em>Newton\u6cd5</em>\uff1a\u9700\u8981\u66f4\u5f3a\u7684\u6761\u4ef6</p>\n<ul>\n<li><strong>\u56de\u7f29\u6761\u4ef6</strong>\uff1a\u4e8c\u9636\u56de\u7f29\uff0c\u5373$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\exp_{\\mathbf{X}}(\\boldsymbol{\\xi}) + O(|\\boldsymbol{\\xi}|^3)$</li>\n<li><strong>\u5c40\u90e8\u6536\u655b</strong>\uff1a\u5728\u975e\u9000\u5316\u6700\u5c0f\u503c\u9644\u8fd1\u4fdd\u6301\u4e8c\u6b21\u6536\u655b</li>\n<li><strong>\u6536\u655b\u57df</strong>\uff1a\u6536\u655b\u57df\u7684\u5927\u5c0f\u4f9d\u8d56\u4e8e\u56de\u7f29\u7684\u8fd1\u4f3c\u8d28\u91cf</li>\n</ul>\n<p><em>\u4fe1\u8d56\u57df\u6cd5</em>\uff1a\u66f4\u9c81\u68d2\u7684\u5168\u5c40\u6536\u655b\u6027</p>\n<ul>\n<li>\u4e00\u9636\u56de\u7f29\u5373\u53ef\u4fdd\u8bc1\u6536\u655b\u5230\u4e00\u9636\u9a7b\u70b9</li>\n<li>\u4e8c\u9636\u56de\u7f29\u65f6\u53ef\u4ee5\u4fdd\u8bc1\u6536\u655b\u5230\u4e8c\u9636\u9a7b\u70b9</li>\n<li>\u81ea\u9002\u5e94\u4fe1\u8d56\u57df\u534a\u5f84\u81ea\u52a8\u5904\u7406\u56de\u7f29\u7684\u8fd1\u4f3c\u8bef\u5dee</li>\n</ul>\n<p><strong>\u52a0\u901f\u65b9\u6cd5\u7684\u6536\u655b\u6027</strong>\uff1a</p>\n<p><em>Nesterov\u52a0\u901f</em>\uff1a\u9700\u8981\u4ed4\u7ec6\u5904\u7406\u5411\u91cf\u4f20\u8f93</p>\n<ul>\n<li><strong>\u51f8\u51fd\u6570</strong>\uff1a\u4f7f\u7528\u7b49\u8ddd\u5411\u91cf\u4f20\u8f93\u53ef\u8fbe\u5230$O(1/k^2)$</li>\n<li><strong>\u5f3a\u51f8\u51fd\u6570</strong>\uff1a\u52a0\u901f\u7ebf\u6027\u6536\u655b\u7387</li>\n<li><strong>\u5173\u952e\u6280\u672f</strong>\uff1a\u52a8\u91cf\u9879\u7684\u6b63\u786e\u4f20\u8f93\u548cmomentum restart\u7b56\u7565</li>\n</ul>\n<p>Recent\u7ed3\u679c\uff082023\uff09\u8868\u660e\uff0c\u5373\u4f7f\u4f7f\u7528\u7b80\u5355\u7684\u6295\u5f71\u4f20\u8f93\uff0c\u901a\u8fc7\u9002\u5f53\u7684\u7b97\u6cd5\u8bbe\u8ba1\u4ecd\u80fd\u4fdd\u6301\u52a0\u901f\u6536\u655b\u7387\u3002</p>\n<p><strong>\u5171\u8f6d\u68af\u5ea6\u7684\u6536\u655b\u6027</strong>\uff1a</p>\n<p>\u7ebf\u6027CG\u7684\u6d41\u5f62\u63a8\u5e7f\uff1a</p>\n<ul>\n<li><strong>\u6709\u9650\u6b65\u7ec8\u6b62</strong>\uff1a\u5728\u7cbe\u786e\u7b97\u672f\u4e0b\uff0c$n$\u6b65\u5185\u6536\u655b\uff08$n$\u662f\u5207\u7a7a\u95f4\u7ef4\u6570\uff09</li>\n<li><strong>\u5b9e\u9645\u6536\u655b</strong>\uff1a\u4f9d\u8d56\u4e8eHessian\u7684\u6761\u4ef6\u6570$\\kappa$\uff0c$O(\\sqrt{\\kappa}\\log(1/\\epsilon))$</li>\n<li><strong>\u5411\u91cf\u4f20\u8f93\u7684\u5f71\u54cd</strong>\uff1a\u4f7f\u7528\u5e73\u884c\u79fb\u52a8\u6216\u5176\u826f\u597d\u8fd1\u4f3c\u4fdd\u6301\u5171\u8f6d\u6027</li>\n</ul>\n<p><strong>BFGS\u7684\u6536\u655b\u6027</strong>\uff1a</p>\n<p><em>\u8d85\u7ebf\u6027\u6536\u655b</em>\uff1a\u5728\u9002\u5f53\u6761\u4ef6\u4e0b</p>\n<ul>\n<li>Dennis-Mor\u00e9\u6761\u4ef6\u7684\u6d41\u5f62\u7248\u672c</li>\n<li>\u9700\u8981\u5411\u91cf\u4f20\u8f93\u4fdd\u6301\u5272\u7ebf\u6761\u4ef6</li>\n<li>L-BFGS\uff1a\u4fdd\u6301R-\u7ebf\u6027\u6536\u655b\uff0c\u5185\u5b58\u53d7\u9650\u65f6\u7684\u5b9e\u7528\u9009\u62e9</li>\n</ul>\n<p><strong>\u6536\u655b\u6027\u5206\u6790\u7684\u5173\u952e\u5de5\u5177</strong>\uff1a</p>\n<ol>\n<li><strong>\u0141ojasiewicz\u4e0d\u7b49\u5f0f</strong>\uff1a\u6d41\u5f62\u7248\u672c\u7528\u4e8e\u5206\u6790\u975e\u51f8\u60c5\u51b5</li>\n<li><strong>\u6d4b\u5730\u51f8\u6027</strong>\uff1a\u6bd4\u6b27\u6c0f\u51f8\u6027\u66f4\u5f31\u4f46\u4ecd\u4fdd\u8bc1\u826f\u597d\u6027\u8d28</li>\n<li><strong>\u66f2\u7387\u754c</strong>\uff1a\u622a\u9762\u66f2\u7387\u7684\u754c\u5f71\u54cd\u6536\u655b\u5e38\u6570</li>\n</ol>\n<p><strong>\u5b9e\u7528\u6307\u5bfc</strong>\uff1a</p>\n<ul>\n<li>\u4e00\u9636\u65b9\u6cd5\u5bf9\u56de\u7f29\u548c\u4f20\u8f93\u7684\u8981\u6c42\u6700\u4f4e</li>\n<li>\u4e8c\u9636\u65b9\u6cd5\u7684superior\u6536\u655b\u503c\u5f97\u989d\u5916\u7684\u8ba1\u7b97\u6295\u5165</li>\n<li>\u5728\u5b9e\u8df5\u4e2d\uff0c\u7b80\u5355\u7684\u56de\u7f29+\u4f20\u8f93often sufficient</li>\n<li>\u76d1\u63a7\u7b97\u6cd5\u8fdb\u5c55\uff0c\u5fc5\u8981\u65f6\u63d0\u9ad8\u51e0\u4f55\u8fd1\u4f3c\u7684\u7cbe\u5ea6</li>\n</ul>\n<h2 id=\"104\">10.4 \u5728\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u4e2d\u7684\u5e94\u7528</h2>\n<p>\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u662f\u6d41\u5f62\u4f18\u5316\u6700\u6210\u529f\u7684\u5e94\u7528\u4e4b\u4e00\u3002\u7ed9\u5b9a\u90e8\u5206\u89c2\u6d4b\u7684\u77e9\u9635\uff0c\u76ee\u6807\u662f\u6062\u590d\u5b8c\u6574\u7684\u4f4e\u79e9\u77e9\u9635\u3002\u4f20\u7edf\u7684\u6838\u8303\u6570\u6700\u5c0f\u5316\u65b9\u6cd5\u9700\u8981\u5b8c\u6574\u7684SVD\uff0c\u800c\u6d41\u5f62\u65b9\u6cd5\u76f4\u63a5\u5728\u56fa\u5b9a\u79e9\u77e9\u9635\u6d41\u5f62\u4e0a\u5de5\u4f5c\uff0c\u663e\u8457\u63d0\u5347\u4e86\u53ef\u6269\u5c55\u6027\u3002</p>\n<h3 id=\"1041\">10.4.1 \u95ee\u9898\u8868\u8ff0</h3>\n<p>\u7ed9\u5b9a\u89c2\u6d4b\u96c6$\\Omega \\subset {1,\\ldots,m} \\times {1,\\ldots,n}$\u548c\u5bf9\u5e94\u7684\u89c2\u6d4b\u503c${M_{ij}: (i,j) \\in \\Omega}$\uff0c\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u95ee\u9898\u4e3a\uff1a\n$$\\min_{\\mathbf{X} \\in \\mathcal{M}_r^{m \\times n}} f(\\mathbf{X}) = \\frac{1}{2}\\sum_{(i,j) \\in \\Omega} (X_{ij} - M_{ij})^2$$\n\u5173\u952e\u6d1e\u5bdf\uff1a\u5c06\u95ee\u9898\u9650\u5236\u5728\u56fa\u5b9a\u79e9\u6d41\u5f62\u4e0a\u907f\u514d\u4e86\u79e9\u7ea6\u675f\u7684\u7ec4\u5408\u7279\u6027\u3002</p>\n<p><strong>\u53c2\u6570\u5316\u9009\u62e9</strong>\uff1a</p>\n<ol>\n<li><strong>SVD\u53c2\u6570\u5316</strong>\uff1a$\\mathbf{X} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^T$\uff0c\u5176\u4e2d$\\mathbf{U} \\in \\mathcal{V}_r(\\mathbb{R}^m)$\uff0c$\\mathbf{V} \\in \\mathcal{V}_r(\\mathbb{R}^n)$\uff0c$\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{r \\times r}_{++}$</li>\n<li><strong>\u56e0\u5b50\u53c2\u6570\u5316</strong>\uff1a$\\mathbf{X} = \\mathbf{L}\\mathbf{R}^T$\uff0c\u5176\u4e2d$\\mathbf{L} \\in \\mathbb{R}^{m \\times r}$\uff0c$\\mathbf{R} \\in \\mathbb{R}^{n \\times r}$</li>\n<li><strong>\u5546\u6d41\u5f62\u8868\u793a</strong>\uff1a\u8003\u8651\u7b49\u4ef7\u7c7b$[(\\mathbf{L}, \\mathbf{R})] = {(\\mathbf{L}\\mathbf{Q}, \\mathbf{R}\\mathbf{Q}): \\mathbf{Q} \\in GL(r)}$</li>\n</ol>\n<h3 id=\"1042-riemannian\">10.4.2 Riemannian\u68af\u5ea6\u8ba1\u7b97</h3>\n<p>\u5bf9\u4e8eSVD\u53c2\u6570\u5316\uff0cEuclidean\u68af\u5ea6\u7684\u7a00\u758f\u7ed3\u6784\u4e3a\uff1a\n$$\\nabla f(\\mathbf{X}) = \\mathcal{P}_\\Omega(\\mathbf{X} - \\mathbf{M})$$\n\u5176\u4e2d$\\mathcal{P}_\\Omega$\u662f\u5230\u89c2\u6d4b\u4f4d\u7f6e\u7684\u6295\u5f71\u3002</p>\n<p>Riemannian\u68af\u5ea6\u5728\u5207\u7a7a\u95f4\u4e2d\u7684\u8868\u793a\uff1a\n$$\\text{grad} f(\\mathbf{X}) = \\mathbf{U}\\mathbf{U}^T\\nabla f(\\mathbf{X})\\mathbf{V}\\mathbf{V}^T + \\mathbf{U}_\\perp\\mathbf{U}_\\perp^T\\nabla f(\\mathbf{X})\\mathbf{V}\\mathbf{V}^T + \\mathbf{U}\\mathbf{U}^T\\nabla f(\\mathbf{X})\\mathbf{V}_\\perp\\mathbf{V}_\\perp^T$$\n\u5173\u952e\u4f18\u5316\uff1a\u5229\u7528\u7a00\u758f\u6027\uff0c\u53ea\u9700\u8ba1\u7b97$\\nabla f(\\mathbf{X})$\u4e0e\u76f8\u5173\u5b50\u7a7a\u95f4\u7684\u4f5c\u7528\uff0c\u590d\u6742\u5ea6$O(|\\Omega|r)$\u800c\u975e$O(mnr)$\u3002</p>\n<h3 id=\"1043\">10.4.3 \u7b97\u6cd5\u5b9e\u73b0</h3>\n<p><strong>Riemannian\u68af\u5ea6\u4e0b\u964d</strong>\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97sparse\u68af\u5ea6\uff1a$\\mathbf{G} = \\mathcal{P}_\\Omega(\\mathbf{X}_k - \\mathbf{M})$</li>\n<li>\u6295\u5f71\u5230\u5207\u7a7a\u95f4\uff1a$\\boldsymbol{\\xi}_k = \\text{Proj}_{T_{\\mathbf{X}_k}}(\\mathbf{G})$</li>\n<li>\u7ebf\u641c\u7d22\u786e\u5b9a\u6b65\u957f$\\alpha_k$</li>\n<li>\u56de\u7f29\u66f4\u65b0\uff1a$\\mathbf{X}_{k+1} = \\mathcal{R}_{\\mathbf{X}_k}(-\\alpha_k\\boldsymbol{\\xi}_k)$</li>\n</ol>\n<p><strong>Riemannian\u5171\u8f6d\u68af\u5ea6</strong>\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\uff1a$\\boldsymbol{\\eta}_0 = -\\text{grad} f(\\mathbf{X}_0)$</li>\n<li>\u8fed\u4ee3\uff1a\n   - \u7ebf\u641c\u7d22\uff1a$\\alpha_k = \\arg\\min_\\alpha f(\\mathcal{R}_{\\mathbf{X}_k}(\\alpha\\boldsymbol{\\eta}_k))$\n   - \u66f4\u65b0\uff1a$\\mathbf{X}_{k+1} = \\mathcal{R}_{\\mathbf{X}_k}(\\alpha_k\\boldsymbol{\\eta}_k)$\n   - \u4f20\u8f93\uff1a$\\boldsymbol{\\xi}_{k+1} = -\\text{grad} f(\\mathbf{X}_{k+1})$\n   - \u5171\u8f6d\u65b9\u5411\uff1a$\\boldsymbol{\\eta}_{k+1} = \\boldsymbol{\\xi}_{k+1} + \\beta_k\\mathcal{T}_{\\alpha_k\\boldsymbol{\\eta}_k}(\\boldsymbol{\\eta}_k)$</li>\n</ol>\n<p>\u5176\u4e2d$\\beta_k$\u53ef\u9009\u62e9Fletcher-Reeves\u6216Polak-Ribi\u00e8re\u516c\u5f0f\u3002</p>\n<h3 id=\"1044\">10.4.4 \u6536\u655b\u6027\u4e0e\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p><strong>\u91c7\u6837\u590d\u6742\u5ea6</strong>\uff1a\u5728\u9002\u5f53\u7684\u975e\u76f8\u5e72\u6027\u5047\u8bbe\u4e0b\uff0c\u5f53\u89c2\u6d4b\u6570$|\\Omega| \\geq Cr(m+n)\\log(m+n)$\u65f6\uff0cwith high probability\u53ef\u4ee5\u7cbe\u786e\u6062\u590d\u79e9$r$\u77e9\u9635\u3002</p>\n<p><strong>\u8fed\u4ee3\u590d\u6742\u5ea6</strong>\uff1a</p>\n<ul>\n<li>\u6bcf\u6b21\u8fed\u4ee3\uff1a$O(|\\Omega|r + (m+n)r^2)$</li>\n<li>\u5185\u5b58\u9700\u6c42\uff1a$O((m+n)r + |\\Omega|)$</li>\n<li>\u6536\u655b\u7387\uff1a\u7ebf\u6027\u6536\u655b\u5230\u5c40\u90e8\u6700\u4f18\uff08\u5728\u9002\u5f53\u5047\u8bbe\u4e0b\uff09</li>\n</ul>\n<p><strong>\u5b9e\u8df5\u52a0\u901f\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li><strong>\u81ea\u9002\u5e94\u79e9\u589e\u52a0</strong>\uff1a\u4ece\u5c0f\u79e9\u5f00\u59cb\uff0c\u9010\u6b65\u589e\u52a0\u4ee5\u907f\u514d\u5c40\u90e8\u6700\u4f18</li>\n<li><strong>\u9884\u6761\u4ef6</strong>\uff1a\u5229\u7528Hessian\u7684\u5757\u7ed3\u6784\u8bbe\u8ba1\u9ad8\u6548\u9884\u6761\u4ef6\u5b50</li>\n<li><strong>\u5e76\u884c\u5316</strong>\uff1a\u68af\u5ea6\u8ba1\u7b97\u548c\u56de\u7f29\u6b65\u9aa4\u90fd\u6613\u4e8e\u5e76\u884c</li>\n<li><strong>warm start</strong>\uff1a\u5229\u7528\u76f8\u8fd1\u95ee\u9898\u7684\u89e3\u4f5c\u4e3a\u521d\u59cb\u5316</li>\n</ol>\n<h3 id=\"1045\">10.4.5 \u6269\u5c55\u4e0e\u53d8\u4f53</h3>\n<p><strong>\u9c81\u68d2\u77e9\u9635\u8865\u5168</strong>\uff1a\u5904\u7406\u79bb\u7fa4\u503c\n$$\\min_{\\mathbf{X} \\in \\mathcal{M}_r, \\mathbf{S}} \\sum_{(i,j) \\in \\Omega} \\rho(X_{ij} + S_{ij} - M_{ij}) + \\lambda|S|_1$$\n\u5176\u4e2d$\\rho$\u662f\u9c81\u68d2\u635f\u5931\u51fd\u6570\u3002\u6d41\u5f62\u7ea6\u675f\u81ea\u7136\u5730\u6b63\u5219\u5316\u4e86\u95ee\u9898\u3002</p>\n<p><strong>\u65f6\u5e8f\u77e9\u9635\u8865\u5168</strong>\uff1a\u5229\u7528\u65f6\u95f4\u5e73\u6ed1\u6027\n$$\\min_{{\\mathbf{X}_t} \\in \\mathcal{M}_r} \\sum_t \\left[\\sum_{(i,j) \\in \\Omega_t} (X_{t,ij} - M_{t,ij})^2 + \\mu|\\mathbf{X}_t - \\mathbf{X}_{t-1}|_F^2\\right]$$\n\u6d41\u5f62\u7ed3\u6784\u4f7f\u5f97\u65f6\u95f4\u5e73\u6ed1\u9879\u7684\u8ba1\u7b97\u66f4\u52a0\u9ad8\u6548\u3002</p>\n<p><strong>\u591a\u4efb\u52a1\u5b66\u4e60</strong>\uff1a\u5171\u4eab\u4f4e\u79e9\u7ed3\u6784\n$$\\min_{\\mathbf{U} \\in \\mathcal{V}_r, {\\mathbf{V}_k}} \\sum_{k=1}^K \\sum_{(i,j) \\in \\Omega_k} ([\\mathbf{U}\\mathbf{V}_k^T]_{ij} - M_{k,ij})^2$$\nStiefel\u6d41\u5f62\u7ea6\u675f\u786e\u4fdd\u4e86\u5171\u4eab\u5b50\u7a7a\u95f4\u7684\u6b63\u4ea4\u6027\u3002</p>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u4ecb\u7ecd\u4e86Riemannian\u4f18\u5316\u7684\u6838\u5fc3\u6982\u5ff5\u548c\u5b9e\u8df5\u6280\u672f\uff1a</p>\n<p><strong>\u5173\u952e\u6982\u5ff5</strong>\uff1a</p>\n<ul>\n<li>\u77e9\u9635\u6d41\u5f62\u63d0\u4f9b\u4e86\u7f16\u7801\u7ea6\u675f\u7684\u81ea\u7136\u51e0\u4f55\u7ed3\u6784</li>\n<li>Riemannian\u68af\u5ea6\u901a\u8fc7\u6295\u5f71Euclidean\u68af\u5ea6\u5230\u5207\u7a7a\u95f4\u83b7\u5f97\uff1a$\\text{grad} f = \\text{Proj}_{T_\\mathbf{X}\\mathcal{M}}(\\nabla f)$</li>\n<li>\u56de\u7f29\u6620\u5c04\u63d0\u4f9b\u4e86\u8ba1\u7b97\u9ad8\u6548\u7684\u6d41\u5f62\u66f4\u65b0\u65b9\u5f0f\uff1a$\\mathbf{X}_{k+1} = \\mathcal{R}_{\\mathbf{X}_k}(\\alpha_k\\boldsymbol{\\xi}_k)$</li>\n<li>\u5411\u91cf\u4f20\u8f93\u5b9e\u73b0\u4e86\u5207\u5411\u91cf\u5728\u4e0d\u540c\u5207\u7a7a\u95f4\u4e4b\u95f4\u7684\u8f6c\u79fb</li>\n</ul>\n<p><strong>\u4e3b\u8981\u6d41\u5f62\u53ca\u5176\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>Stiefel\u6d41\u5f62$\\mathcal{V}_k(\\mathbb{R}^n)$\uff1a\u6b63\u4ea4\u7ea6\u675f\u4f18\u5316\u3001\u7279\u5f81\u503c\u95ee\u9898</li>\n<li>Grassmann\u6d41\u5f62$\\mathcal{G}_k(\\mathbb{R}^n)$\uff1a\u5b50\u7a7a\u95f4\u5b66\u4e60\u3001\u964d\u7ef4</li>\n<li>\u56fa\u5b9a\u79e9\u6d41\u5f62$\\mathcal{M}_r^{m \\times n}$\uff1a\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u3001\u6a21\u578b\u538b\u7f29</li>\n<li>\u6b63\u5b9a\u77e9\u9635\u9525$\\mathcal{S}_{++}^n$\uff1a\u534f\u65b9\u5dee\u4f30\u8ba1\u3001\u5ea6\u91cf\u5b66\u4e60</li>\n</ul>\n<p><strong>\u7b97\u6cd5\u8bbe\u8ba1\u539f\u5219</strong>\uff1a</p>\n<ol>\n<li>\u5229\u7528\u95ee\u9898\u7684\u51e0\u4f55\u7ed3\u6784\u9009\u62e9\u5408\u9002\u7684\u6d41\u5f62\u548c\u5ea6\u91cf</li>\n<li>\u5728\u8ba1\u7b97\u6548\u7387\u548c\u7406\u8bba\u6027\u8d28\u4e4b\u95f4\u6743\u8861\u9009\u62e9\u56de\u7f29\u548c\u4f20\u8f93</li>\n<li>\u8003\u8651\u6d41\u5f62\u66f2\u7387\u5bf9\u6536\u655b\u6027\u7684\u5f71\u54cd</li>\n<li>\u5145\u5206\u5229\u7528\u95ee\u9898\u7684\u7a00\u758f\u6027\u548c\u7279\u6b8a\u7ed3\u6784</li>\n</ol>\n<p><strong>\u672a\u6765\u53d1\u5c55\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u6d41\u5f62\u4f18\u5316</li>\n<li>\u968f\u673a\u548c\u5728\u7ebf\u6d41\u5f62\u7b97\u6cd5</li>\n<li>\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u6d41\u5f62\u7ed3\u6784\u5229\u7528</li>\n<li>\u4e0e\u5176\u4ed6\u7ea6\u675f\u4f18\u5316\u65b9\u6cd5\u7684\u878d\u5408</li>\n</ul>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u989810.1</strong>\uff1a\u8bc1\u660eStiefel\u6d41\u5f62\u7684\u5207\u7a7a\u95f4\u8868\u5f81\n$$T_{\\mathbf{X}}\\mathcal{V}_k(\\mathbb{R}^n) = {\\boldsymbol{\\xi} \\in \\mathbb{R}^{n \\times k} : \\mathbf{X}^T\\boldsymbol{\\xi} + \\boldsymbol{\\xi}^T\\mathbf{X} = \\mathbf{0}}$$\n<em>\u63d0\u793a</em>\uff1a\u5229\u7528\u7ea6\u675f$\\mathbf{X}^T\\mathbf{X} = \\mathbf{I}$\u5bf9\u65f6\u95f4\u6c42\u5bfc\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe$\\mathbf{X}(t)$\u662f\u6d41\u5f62\u4e0a\u8fc7$\\mathbf{X}(0) = \\mathbf{X}$\u7684\u5149\u6ed1\u66f2\u7ebf\uff0c\u6ee1\u8db3$\\mathbf{X}(t)^T\\mathbf{X}(t) = \\mathbf{I}$\u3002\u5bf9\u65f6\u95f4\u6c42\u5bfc\uff1a\n$$\\frac{d}{dt}[\\mathbf{X}(t)^T\\mathbf{X}(t)]|_{t=0} = \\dot{\\mathbf{X}}(0)^T\\mathbf{X} + \\mathbf{X}^T\\dot{\\mathbf{X}}(0) = 0$$\n\u7531\u4e8e\u5207\u5411\u91cf$\\boldsymbol{\\xi} = \\dot{\\mathbf{X}}(0)$\uff0c\u5f97\u5230\u5207\u7a7a\u95f4\u6761\u4ef6\u3002\u53cd\u4e4b\uff0c\u4efb\u4f55\u6ee1\u8db3\u6b64\u6761\u4ef6\u7684$\\boldsymbol{\\xi}$\u90fd\u53ef\u4ee5\u901a\u8fc7\u6d4b\u5730\u7ebf\u6216\u56de\u7f29\u6784\u9020\u76f8\u5e94\u7684\u66f2\u7ebf\u3002</p>\n</details>\n<p><strong>\u4e60\u989810.2</strong>\uff1a\u8ba1\u7b97\u51fd\u6570$f(\\mathbf{X}) = \\text{tr}(\\mathbf{A}^T\\mathbf{X})$\u5728Stiefel\u6d41\u5f62\u4e0a\u7684Riemannian\u68af\u5ea6\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5148\u8ba1\u7b97Euclidean\u68af\u5ea6\uff0c\u7136\u540e\u6295\u5f71\u5230\u5207\u7a7a\u95f4\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Euclidean\u68af\u5ea6\uff1a$\\nabla f(\\mathbf{X}) = \\mathbf{A}$</p>\n<p>Riemannian\u68af\u5ea6\uff1a\n$$\\text{grad} f(\\mathbf{X}) = \\text{Proj}_{T_{\\mathbf{X}}\\mathcal{V}}(\\mathbf{A}) = \\mathbf{A} - \\mathbf{X}\\text{sym}(\\mathbf{X}^T\\mathbf{A})$$\n\u9a8c\u8bc1\uff1a$\\mathbf{X}^T\\text{grad} f + (\\text{grad} f)^T\\mathbf{X} = \\mathbf{X}^T\\mathbf{A} - \\mathbf{X}^T\\mathbf{A} - \\mathbf{A}^T\\mathbf{X} + \\mathbf{A}^T\\mathbf{X} = 0$\u3002</p>\n</details>\n<p><strong>\u4e60\u989810.3</strong>\uff1a\u8bc1\u660eQR\u5206\u89e3\u5b9a\u4e49\u7684\u6620\u5c04$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = \\text{qf}(\\mathbf{X} + \\boldsymbol{\\xi})$\u662fStiefel\u6d41\u5f62\u4e0a\u7684\u56de\u7f29\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u9a8c\u8bc1\u56de\u7f29\u7684\u4e24\u4e2a\u5b9a\u4e49\u6761\u4ef6\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<ol>\n<li>\n<p>$\\mathcal{R}_{\\mathbf{X}}(\\mathbf{0}) = \\text{qf}(\\mathbf{X}) = \\mathbf{X}$\uff08\u56e0\u4e3a$\\mathbf{X}$\u5df2\u7ecf\u5217\u6b63\u4ea4\uff09</p>\n</li>\n<li>\n<p>\u8bbe$\\mathbf{X} + t\\boldsymbol{\\xi} = \\mathbf{Q}(t)\\mathbf{R}(t)$\uff0c\u5219\uff1a\n$$\\frac{d}{dt}\\mathcal{R}_{\\mathbf{X}}(t\\boldsymbol{\\xi})|_{t=0} = \\frac{d\\mathbf{Q}(t)}{dt}|_{t=0}$$\n\u7531QR\u5206\u89e3\u7684\u552f\u4e00\u6027\u548c\u8fde\u7eed\u6027\uff0c\u5f53$t \\to 0$\u65f6\uff0c$\\mathbf{R}(t) \\to \\mathbf{I}$\uff0c\u56e0\u6b64$\\frac{d\\mathbf{Q}}{dt}|_{t=0} = \\boldsymbol{\\xi}$\u3002</p>\n</li>\n</ol>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u989810.4</strong>\uff1a\u8bbe\u8ba1\u56fa\u5b9a\u79e9\u6d41\u5f62$\\mathcal{M}_r^{m \\times n}$\u4e0a\u7684\u9ad8\u6548\u56de\u7f29\u6620\u5c04\uff0c\u8981\u6c42\u907f\u514d\u5b8c\u6574SVD\u8ba1\u7b97\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u5229\u7528\u5207\u7a7a\u95f4\u7684\u7279\u6b8a\u7ed3\u6784\u548c\u589e\u91cfSVD\u6280\u672f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e$\\mathbf{X} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^T$\u548c\u5207\u5411\u91cf$\\boldsymbol{\\xi} = \\mathbf{U}\\mathbf{M}\\mathbf{V}^T + \\mathbf{U}_\\perp\\mathbf{N}\\mathbf{V}^T + \\mathbf{U}\\mathbf{P}^T\\mathbf{V}_\\perp^T$\uff1a</p>\n<ol>\n<li>\n<p>\u8ba1\u7b97$\\mathbf{Y} = \\mathbf{X} + \\boldsymbol{\\xi}$\u7684\u7d27\u51d1\u8868\u793a\uff1a\n$$\\mathbf{Y} = [\\mathbf{U}, \\mathbf{U}_\\perp]\\begin{bmatrix}\\boldsymbol{\\Sigma} + \\mathbf{M} &amp; \\mathbf{P}^T \\ \\mathbf{N} &amp; \\mathbf{0}\\end{bmatrix}[\\mathbf{V}, \\mathbf{V}_\\perp]^T$$</p>\n</li>\n<li>\n<p>\u5bf9\u4e2d\u95f4$(2r) \\times (2r)$\u77e9\u9635\u8fdb\u884cSVD\uff1a\n$$\\begin{bmatrix}\\boldsymbol{\\Sigma} + \\mathbf{M} &amp; \\mathbf{P}^T \\ \\mathbf{N} &amp; \\mathbf{0}\\end{bmatrix} = \\mathbf{U}_s\\boldsymbol{\\Sigma}_s\\mathbf{V}_s^T$$</p>\n</li>\n<li>\n<p>\u56de\u7f29\u7ed3\u679c\uff1a$\\mathcal{R}_{\\mathbf{X}}(\\boldsymbol{\\xi}) = ([\\mathbf{U}, \\mathbf{U}_\\perp]\\mathbf{U}_s)_{:,1:r}\\boldsymbol{\\Sigma}_{s,1:r}([\\mathbf{V}, \\mathbf{V}_\\perp]\\mathbf{V}_s)_{:,1:r}^T$</p>\n</li>\n</ol>\n<p>\u590d\u6742\u5ea6\uff1a$O((m+n)r^2)$\uff0c\u907f\u514d\u4e86$O(mn\\min(m,n))$\u7684\u5b8c\u6574SVD\u3002</p>\n</details>\n<p><strong>\u4e60\u989810.5</strong>\uff1a\u5206\u6790Grassmann\u6d41\u5f62\u4e0a\u7684\u6d4b\u5730\u8ddd\u79bb\u4e0e\u4e3b\u89d2\u5ea6\u7684\u5173\u7cfb\uff0c\u5e76\u8bbe\u8ba1\u57fa\u4e8e\u6b64\u7684\u7ebf\u641c\u7d22\u7b56\u7565\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1aGrassmann\u6d41\u5f62\u4e0a\u4e24\u4e2a\u5b50\u7a7a\u95f4\u4e4b\u95f4\u7684\u6d4b\u5730\u8ddd\u79bb\u7531\u4e3b\u89d2\u5ea6\u51b3\u5b9a\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe$\\mathcal{X}, \\mathcal{Y}$\u662f\u4e24\u4e2a$k$\u7ef4\u5b50\u7a7a\u95f4\uff0c\u4e3b\u89d2\u5ea6$0 \\leq \\theta_1 \\leq \\cdots \\leq \\theta_k \\leq \\pi/2$\u5b9a\u4e49\u4e3a\uff1a\n$$\\cos\\theta_i = \\max_{\\mathbf{x} \\in \\mathcal{X}, \\mathbf{y} \\in \\mathcal{Y}} \\mathbf{x}^T\\mathbf{y}$$\nsubject to\u6b63\u4ea4\u7ea6\u675f\u3002</p>\n<p>\u6d4b\u5730\u8ddd\u79bb\uff1a$d_g(\\mathcal{X}, \\mathcal{Y}) = |\\boldsymbol{\\theta}|_2 = \\sqrt{\\sum_{i=1}^k \\theta_i^2}$</p>\n<p>\u7ebf\u641c\u7d22\u7b56\u7565\uff1a</p>\n<ol>\n<li>\u5bf9\u4e8e\u641c\u7d22\u65b9\u5411$\\boldsymbol{\\eta}$\uff0c\u53c2\u6570\u5316\u6d4b\u5730\u7ebf$\\gamma(t) = \\text{Exp}_{\\mathcal{X}}(t\\boldsymbol{\\eta})$</li>\n<li>\u5229\u7528\u4e3b\u89d2\u5ea6\u7684\u5355\u8c03\u6027\u8d28\uff0c\u91c7\u7528\u9ec4\u91d1\u5206\u5272\u641c\u7d22</li>\n<li>\u7ec8\u6b62\u51c6\u5219\u57fa\u4e8e\u89d2\u5ea6\u53d8\u5316\uff1a$|\\boldsymbol{\\theta}(t) - \\boldsymbol{\\theta}(t-\\Delta t)| &lt; \\epsilon$</li>\n</ol>\n<p>\u6b64\u7b56\u7565\u7279\u522b\u9002\u5408\u5b50\u7a7a\u95f4\u8ffd\u8e2a\u548c\u6b63\u4ea4Procrustes\u95ee\u9898\u3002</p>\n</details>\n<p><strong>\u4e60\u989810.6</strong>\uff1a\u63a8\u5bfc\u56fa\u5b9a\u79e9\u6d41\u5f62\u4e0a\u7684Riemannian Hessian-\u5411\u91cf\u79ef\u7684\u9ad8\u6548\u8ba1\u7b97\u65b9\u6cd5\uff0c\u7528\u4e8e\u4fe1\u8d56\u57df\u5b50\u95ee\u9898\u6c42\u89e3\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5229\u7528\u4e8c\u9636\u5bfc\u6570\u7684\u94fe\u5f0f\u6cd5\u5219\u548c\u6295\u5f71\u7b97\u5b50\u7684\u5bfc\u6570\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e$f(\\mathbf{X})$\u548c\u5207\u5411\u91cf$\\boldsymbol{\\xi}, \\boldsymbol{\\eta} \\in T_{\\mathbf{X}}\\mathcal{M}_r$\uff1a</p>\n<ol>\n<li>\n<p>Euclidean Hessian\u4f5c\u7528\uff1a$\\mathbf{H}[\\boldsymbol{\\eta}] = \\text{D}^2f(\\mathbf{X})[\\boldsymbol{\\eta}]$</p>\n</li>\n<li>\n<p>\u66f2\u7387\u6821\u6b63\u9879\uff1a\u5229\u7528Weingarten\u6620\u5c04\n$$\\mathcal{W}_{\\boldsymbol{\\xi}}(\\boldsymbol{\\eta}) = -\\text{Proj}_{T_{\\mathbf{X}}\\mathcal{M}}(\\text{D}(\\text{Proj}_{N_{\\mathbf{X}}\\mathcal{M}})(\\mathbf{X})[\\boldsymbol{\\eta}][\\boldsymbol{\\xi}])$$</p>\n</li>\n<li>\n<p>Riemannian Hessian\uff1a\n$$\\text{Hess}f(\\mathbf{X})[\\boldsymbol{\\eta}] = \\text{Proj}_{T_{\\mathbf{X}}\\mathcal{M}}(\\mathbf{H}[\\boldsymbol{\\eta}]) + \\mathcal{W}_{\\text{grad}f(\\mathbf{X})}(\\boldsymbol{\\eta})$$</p>\n</li>\n</ol>\n<p>\u9ad8\u6548\u5b9e\u73b0\uff1a</p>\n<ul>\n<li>\u5229\u7528\u81ea\u52a8\u5fae\u5206\u8ba1\u7b97Hessian-\u5411\u91cf\u79ef</li>\n<li>\u7f13\u5b58\u6295\u5f71\u7b97\u5b50\u7684\u4e2d\u95f4\u7ed3\u679c</li>\n<li>\u5bf9\u4e8e\u4e8c\u6b21\u51fd\u6570\uff0c\u66f2\u7387\u9879\u53ef\u4ee5\u9884\u8ba1\u7b97</li>\n</ul>\n<p>\u590d\u6742\u5ea6\uff1a$O(|\\Omega|r + (m+n)r^2)$\u7528\u4e8e\u77e9\u9635\u8865\u5168\u95ee\u9898\u3002</p>\n</details>\n<p><strong>\u4e60\u989810.7</strong>\uff1a\u8bbe\u8ba1\u6d41\u5f62\u7ea6\u675f\u4e0b\u7684\u968f\u673a\u68af\u5ea6\u7b97\u6cd5\uff0c\u5206\u6790\u5176\u6536\u655b\u6027\u8d28\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u968f\u673a\u68af\u5ea6\u7684\u65e0\u504f\u6027\u548c\u56de\u7f29\u7684\u5f71\u54cd\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Riemannian SGD\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u91c7\u6837mini-batch $\\mathcal{B}_k$</li>\n<li>\u8ba1\u7b97\u968f\u673a\u68af\u5ea6\uff1a$\\tilde{\\mathbf{g}}_k = \\frac{1}{|\\mathcal{B}_k|}\\sum_{i \\in \\mathcal{B}_k}\\nabla f_i(\\mathbf{X}_k)$</li>\n<li>\u6295\u5f71\uff1a$\\tilde{\\boldsymbol{\\xi}}_k = \\text{Proj}_{T_{\\mathbf{X}_k}\\mathcal{M}}(\\tilde{\\mathbf{g}}_k)$</li>\n<li>\u66f4\u65b0\uff1a$\\mathbf{X}_{k+1} = \\mathcal{R}_{\\mathbf{X}_k}(-\\alpha_k\\tilde{\\boldsymbol{\\xi}}_k)$</li>\n</ol>\n<p>\u6536\u655b\u6027\u5206\u6790\uff1a</p>\n<ul>\n<li>\u65e0\u504f\u6027\uff1a$\\mathbb{E}[\\tilde{\\boldsymbol{\\xi}}_k | \\mathbf{X}_k] = \\text{grad}f(\\mathbf{X}_k)$</li>\n<li>\u65b9\u5dee\u754c\uff1a\u9700\u8981\u5047\u8bbe$\\mathbb{E}[|\\tilde{\\mathbf{g}}_k - \\nabla f(\\mathbf{X}_k)|^2] \\leq \\sigma^2$</li>\n<li>\u6536\u655b\u7387\uff1a\u5728\u5f3a\u51f8\u6761\u4ef6\u4e0b\uff08\u76f8\u5bf9\u4e8e\u6d41\u5f62\u5ea6\u91cf\uff09\uff0c$\\mathbb{E}[f(\\mathbf{X}_k) - f^*] = O(1/k)$</li>\n</ul>\n<p>\u5173\u952e\u6311\u6218\uff1a</p>\n<ol>\n<li>\u6d41\u5f62\u66f2\u7387\u5f71\u54cd\u65b9\u5dee\u754c</li>\n<li>\u56de\u7f29\u7684\u975e\u7ebf\u6027\u53ef\u80fd\u7834\u574f\u67d0\u4e9b\u6027\u8d28</li>\n<li>\u81ea\u9002\u5e94\u6b65\u957f\u9700\u8981\u8003\u8651\u5ea6\u91cf\u53d8\u5316</li>\n</ol>\n<p>\u5b9e\u8df5\u5efa\u8bae\uff1a\u4f7f\u7528\u65b9\u5dee\u7f29\u51cf\u6280\u672f\uff08SVRG\u3001SAGA\u7684\u6d41\u5f62\u7248\u672c\uff09\u3002</p>\n</details>\n<h2 id=\"_5\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<ol>\n<li>\n<p><strong>\u5ea6\u91cf\u9009\u62e9\u4e0d\u5f53</strong>\n   - \u9519\u8bef\uff1a\u76f2\u76ee\u4f7f\u7528Euclidean\u5ea6\u91cf\n   - \u6b63\u786e\uff1a\u6839\u636e\u95ee\u9898\u7684\u4e0d\u53d8\u6027\u9009\u62e9\u5408\u9002\u5ea6\u91cf\n   - \u4f8b\u5982\uff1a\u6b63\u5b9a\u77e9\u9635\u4f7f\u7528\u4eff\u5c04\u4e0d\u53d8\u5ea6\u91cf</p>\n</li>\n<li>\n<p><strong>\u5ffd\u89c6\u6570\u503c\u7a33\u5b9a\u6027</strong>\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u8ba1\u7b97$(\\mathbf{I} + \\boldsymbol{\\xi}^T\\boldsymbol{\\xi})^{-1/2}$\n   - \u6b63\u786e\uff1a\u4f7f\u7528Cholesky\u5206\u89e3\u6216\u8fed\u4ee3\u65b9\u6cd5\n   - \u7279\u522b\u6ce8\u610f\uff1a\u63a5\u8fd1\u5947\u5f02\u65f6\u7684\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u5207\u7a7a\u95f4\u6295\u5f71\u9519\u8bef</strong>\n   - \u9519\u8bef\uff1a\u5fd8\u8bb0\u5bf9\u79f0\u5316\u6216\u4f7f\u7528\u9519\u8bef\u7684\u6295\u5f71\u516c\u5f0f\n   - \u6b63\u786e\uff1a\u4ed4\u7ec6\u9a8c\u8bc1\u6295\u5f71\u540e\u786e\u5b9e\u5728\u5207\u7a7a\u95f4\u5185\n   - \u8c03\u8bd5\u6280\u5de7\uff1a\u68c0\u67e5$|\\text{Proj}(\\boldsymbol{\\xi}) - \\boldsymbol{\\xi}|$</p>\n</li>\n<li>\n<p><strong>\u56de\u7f29\u9009\u62e9\u4e0d\u5f53</strong>\n   - \u9519\u8bef\uff1a\u603b\u662f\u4f7f\u7528\u6700\u7b80\u5355\u7684\u56de\u7f29\n   - \u6b63\u786e\uff1a\u6743\u8861\u8ba1\u7b97\u6210\u672c\u548c\u6536\u655b\u6027\u80fd\n   - \u539f\u5219\uff1a\u4e8c\u9636\u65b9\u6cd5\u9700\u8981\u66f4\u7cbe\u786e\u7684\u56de\u7f29</p>\n</li>\n<li>\n<p><strong>\u5411\u91cf\u4f20\u8f93\u7f3a\u5931</strong>\n   - \u9519\u8bef\uff1a\u5728CG\u6216BFGS\u4e2d\u5ffd\u7565\u5411\u91cf\u4f20\u8f93\n   - \u6b63\u786e\uff1a\u5373\u4f7f\u4f7f\u7528\u7b80\u5355\u6295\u5f71\u4e5f\u8981\u4f20\u8f93\n   - \u5f71\u54cd\uff1a\u53ef\u80fd\u5bfc\u81f4\u6536\u655b\u53d8\u6162\u6216\u53d1\u6563</p>\n</li>\n<li>\n<p><strong>\u521d\u59cb\u5316\u95ee\u9898</strong>\n   - \u9519\u8bef\uff1a\u968f\u673a\u521d\u59cb\u5316\u53ef\u80fd\u4e0d\u5728\u6d41\u5f62\u4e0a\n   - \u6b63\u786e\uff1a\u4f7f\u7528\u6295\u5f71\u6216\u7279\u5b9a\u6784\u9020\u786e\u4fdd\u53ef\u884c\u6027\n   - \u6280\u5de7\uff1a\u5229\u7528\u95ee\u9898\u7ed3\u6784\u9009\u62e9\u597d\u7684\u521d\u59cb\u70b9</p>\n</li>\n<li>\n<p><strong>\u6b65\u957f\u9009\u62e9</strong>\n   - \u9519\u8bef\uff1a\u4f7f\u7528\u56fa\u5b9a\u6b65\u957f\n   - \u6b63\u786e\uff1a\u8003\u8651\u6d41\u5f62\u66f2\u7387\u7684\u81ea\u9002\u5e94\u6b65\u957f\n   - \u6ce8\u610f\uff1aArmijo\u89c4\u5219\u9700\u8981\u9002\u5e94\u6d41\u5f62\u7ed3\u6784</p>\n</li>\n<li>\n<p><strong>\u79e9\u9009\u62e9</strong>\n   - \u9519\u8bef\uff1a\u56fa\u5b9a\u79e9\u53ef\u80fd\u8fc7\u5c0f\u6216\u8fc7\u5927\n   - \u6b63\u786e\uff1a\u81ea\u9002\u5e94\u79e9\u9009\u62e9\u6216\u4ea4\u53c9\u9a8c\u8bc1\n   - \u7b56\u7565\uff1a\u4ece\u5c0f\u79e9\u5f00\u59cb\u9010\u6b65\u589e\u52a0</p>\n</li>\n</ol>\n<h2 id=\"_6\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_7\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u8bc6\u522b\u95ee\u9898\u7684\u81ea\u7136\u51e0\u4f55\u7ed3\u6784</li>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u6d41\u5f62\u548c\u53c2\u6570\u5316</li>\n<li>[ ] \u786e\u5b9a\u8ba1\u7b97\u6548\u7387vs\u7406\u8bba\u6027\u8d28\u7684\u6743\u8861</li>\n<li>[ ] \u8bbe\u8ba1\u5229\u7528\u95ee\u9898\u7a00\u758f\u6027\u7684\u7b56\u7565</li>\n</ul>\n<h3 id=\"_8\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u9a8c\u8bc1\u6240\u6709\u64cd\u4f5c\u4fdd\u6301\u6d41\u5f62\u7ea6\u675f</li>\n<li>[ ] \u5b9e\u73b0\u6570\u503c\u7a33\u5b9a\u7684\u6295\u5f71\u548c\u56de\u7f29</li>\n<li>[ ] \u6dfb\u52a0\u8c03\u8bd5\u65ad\u8a00\u68c0\u67e5\u5207\u7a7a\u95f4\u6761\u4ef6</li>\n<li>[ ] \u4f18\u5316\u5185\u5b58\u4f7f\u7528\u548c\u8ba1\u7b97\u987a\u5e8f</li>\n</ul>\n<h3 id=\"_9\">\u8c03\u4f18\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6bd4\u8f83\u4e0d\u540c\u56de\u7f29\u7684\u6027\u80fd</li>\n<li>[ ] \u6d4b\u8bd5\u5404\u79cd\u7ebf\u641c\u7d22\u7b56\u7565</li>\n<li>[ ] \u8c03\u6574\u7b97\u6cd5\u53c2\u6570\uff08\u4fe1\u8d56\u57df\u534a\u5f84\u7b49\uff09</li>\n<li>[ ] \u5206\u6790\u4e0d\u540c\u521d\u59cb\u5316\u7684\u5f71\u54cd</li>\n</ul>\n<h3 id=\"_10\">\u9a8c\u8bc1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u68c0\u67e5\u6536\u655b\u5230\u7684\u89e3\u786e\u5b9e\u5728\u6d41\u5f62\u4e0a</li>\n<li>[ ] \u9a8c\u8bc1\u4e00\u9636\u5fc5\u8981\u6761\u4ef6</li>\n<li>[ ] \u4e0e\u5176\u4ed6\u65b9\u6cd5\u6bd4\u8f83\u89e3\u7684\u8d28\u91cf</li>\n<li>[ ] \u8bc4\u4f30\u8ba1\u7b97\u65f6\u95f4\u548c\u53ef\u6269\u5c55\u6027</li>\n</ul>\n<h2 id=\"_11\">\u7814\u7a76\u65b9\u5411</h2>\n<ol>\n<li>\n<p><strong>\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u6d41\u5f62\u4f18\u5316</strong>\n   - \u5982\u4f55\u8bbe\u8ba1\u901a\u4fe1\u9ad8\u6548\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\n   - \u5f02\u6b65\u66f4\u65b0\u5728\u6d41\u5f62\u4e0a\u7684\u6536\u655b\u6027\u4fdd\u8bc1\n   - \u8054\u90a6\u5b66\u4e60\u4e2d\u7684\u6d41\u5f62\u7ea6\u675f\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u6d41\u5f62\u7ed3\u6784</strong>\n   - \u795e\u7ecf\u7f51\u7edc\u6743\u91cd\u7684\u5185\u5728\u6d41\u5f62\u7ed3\u6784\n   - \u5f52\u4e00\u5316\u5c42\u7684\u6d41\u5f62interpretation\n   - \u6d41\u5f62\u6b63\u5219\u5316\u7684\u65b0\u65b9\u6cd5</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u6574\u6570\u6d41\u5f62\u4f18\u5316</strong>\n   - \u79bb\u6563\u9009\u62e9\u4e0e\u8fde\u7eed\u6d41\u5f62\u7ea6\u675f\u7684\u7ed3\u5408\n   - \u7ec4\u5408\u6d41\u5f62\u7684\u7b97\u6cd5\u8bbe\u8ba1\n   - \u5728\u7279\u5f81\u9009\u62e9\u4e2d\u7684\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u6d41\u5f62\u4f18\u5316</strong>\n   - \u65f6\u53d8\u6d41\u5f62\u4e0a\u7684\u8ffd\u8e2a\u7b97\u6cd5\n   - \u5728\u7ebf\u5b66\u4e60\u7684\u6d41\u5f62\u9002\u5e94\n   - \u975e\u5e73\u7a33\u73af\u5883\u4e0b\u7684\u7406\u8bba\u4fdd\u8bc1</p>\n</li>\n<li>\n<p><strong>\u9ad8\u9636\u6d41\u5f62\u65b9\u6cd5</strong>\n   - \u4e09\u9636\u53ca\u4ee5\u4e0a\u4fe1\u606f\u7684\u5229\u7528\n   - \u6d41\u5f62\u4e0a\u7684\u5185\u70b9\u6cd5\n   - \u4e0e\u4f20\u7edf\u9ad8\u9636\u65b9\u6cd5\u7684\u6bd4\u8f83</p>\n</li>\n<li>\n<p><strong>\u6d41\u5f62\u4e0a\u7684\u968f\u673a\u4f18\u5316</strong>\n   - Heavy-tail\u566a\u58f0\u4e0b\u7684\u9c81\u68d2\u7b97\u6cd5\n   - \u6d41\u5f62MCMC\u91c7\u6837\n   - \u8d1d\u53f6\u65af\u4f18\u5316\u7684\u6d41\u5f62\u6269\u5c55</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u6d41\u5f62\u7b97\u6cd5</strong>\n   - \u91cf\u5b50\u8ba1\u7b97\u52a0\u901f\u7684\u53ef\u80fd\u6027\n   - \u6d41\u5f62\u7ed3\u6784\u7684\u91cf\u5b50\u8868\u793a\n   - \u6df7\u5408\u7ecf\u5178-\u91cf\u5b50\u7b97\u6cd5</p>\n</li>\n</ol>"
  },
  "../chapter4.md": {
    "hash": "38ff08c7e490ba778b2d99228d684d2f",
    "content": "<h1 id=\"4hessian\">\u7b2c4\u7ae0\uff1a\u589e\u91cfHessian\u8ba1\u7b97</h1>\n<p>\u5728\u5927\u89c4\u6a21\u4f18\u5316\u95ee\u9898\u4e2d\uff0cHessian\u77e9\u9635\u7684\u8ba1\u7b97\u548c\u5b58\u50a8\u5f80\u5f80\u6210\u4e3a\u8ba1\u7b97\u74f6\u9888\u3002\u5f53\u6570\u636e\u4ee5\u6d41\u5f0f\u65b9\u5f0f\u5230\u8fbe\uff0c\u6216\u5f53\u6211\u4eec\u9700\u8981\u5728\u7ebf\u66f4\u65b0\u6a21\u578b\u65f6\uff0c\u5b8c\u5168\u91cd\u65b0\u8ba1\u7b97Hessian\u77e9\u9635\u65e2\u4e0d\u73b0\u5b9e\u4e5f\u4e0d\u9ad8\u6548\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u589e\u91cfHessian\u8ba1\u7b97\u6280\u672f\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u901a\u8fc7\u5de7\u5999\u5229\u7528\u77e9\u9635\u7ed3\u6784\u548c\u66f4\u65b0\u6a21\u5f0f\uff0c\u80fd\u591f\u4ee5\u8fdc\u4f4e\u4e8e$\\mathcal{O}(n^3)$\u7684\u590d\u6742\u5ea6\u7ef4\u62a4Hessian\u77e9\u9635\u6216\u5176\u9006\u7684\u8fd1\u4f3c\u3002\u6211\u4eec\u5c06\u4ece\u7ecf\u5178\u7684Woodbury\u516c\u5f0f\u51fa\u53d1\uff0c\u9010\u6b65\u6df1\u5165\u5230\u73b0\u4ee3\u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5\u4e2d\u7684\u4e8c\u9636\u4fe1\u606f\u5229\u7528\uff0c\u63ed\u793a\u770b\u4f3c\u4e0d\u540c\u7684\u7b97\u6cd5\u80cc\u540e\u7684\u6570\u5b66\u7edf\u4e00\u6027\u3002</p>\n<h2 id=\"41-woodbury\">4.1 Woodbury\u77e9\u9635\u6052\u7b49\u5f0f\u7684\u9ad8\u7ea7\u5e94\u7528</h2>\n<h3 id=\"411-woodbury\">4.1.1 \u57fa\u7840Woodbury\u516c\u5f0f\u56de\u987e</h3>\n<p>Woodbury\u77e9\u9635\u6052\u7b49\u5f0f\u662f\u589e\u91cf\u8ba1\u7b97\u7684\u57fa\u77f3\uff0c\u5b83\u4f18\u96c5\u5730\u89e3\u51b3\u4e86\u4f4e\u79e9\u6270\u52a8\u4e0b\u7684\u77e9\u9635\u9006\u66f4\u65b0\u95ee\u9898\uff1a</p>\n<p>$$(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{U}(\\mathbf{C}^{-1} + \\mathbf{V}^T\\mathbf{A}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{A}^{-1}$$\n\u5176\u4e2d$\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$\uff0c$\\mathbf{U}, \\mathbf{V} \\in \\mathbb{R}^{n \\times k}$\uff0c$\\mathbf{C} \\in \\mathbb{R}^{k \\times k}$\uff0c\u4e14$k \\ll n$\u3002</p>\n<p><strong>\u5173\u952e\u6d1e\u5bdf</strong>\uff1a\u5f53$k$\u8fdc\u5c0f\u4e8e$n$\u65f6\uff0c\u53f3\u4fa7\u53ea\u9700\u8981\u6c42\u89e3\u4e00\u4e2a$k \\times k$\u7684\u7ebf\u6027\u7cfb\u7edf\uff0c\u5c06\u8ba1\u7b97\u590d\u6742\u5ea6\u4ece$\\mathcal{O}(n^3)$\u964d\u81f3$\\mathcal{O}(n^2k + k^3)$\u3002</p>\n<p><strong>\u5386\u53f2\u8109\u7edc\u4e0e\u73b0\u4ee3\u610f\u4e49</strong>\uff1a</p>\n<ul>\n<li>Woodbury\u516c\u5f0f\u6700\u521d\u7531Max Woodbury\u57281950\u5e74\u63d0\u51fa\uff0c\u7528\u4e8e\u7edf\u8ba1\u8ba1\u7b97</li>\n<li>Sherman-Morrison\u516c\u5f0f\uff081949\uff09\u662f\u5176\u79e9-1\u7279\u4f8b</li>\n<li>\u5728\u73b0\u4ee3\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u5b83\u6210\u4e3a\u5904\u7406\u6d41\u5f0f\u6570\u636e\u548c\u5728\u7ebf\u5b66\u4e60\u7684\u6838\u5fc3\u5de5\u5177</li>\n<li>\u4e0eSchur\u8865\u3001\u77e9\u9635\u6c42\u9006\u5f15\u7406(Matrix Inversion Lemma)\u672c\u8d28\u7b49\u4ef7</li>\n</ul>\n<p><strong>\u51e0\u4f55\u89e3\u91ca</strong>\uff1a\nWoodbury\u516c\u5f0f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5728\u539f\u7a7a\u95f4$\\mathbb{R}^n$\u4e2d\uff0c\u901a\u8fc7$k$\u7ef4\u5b50\u7a7a\u95f4\u7684\u6270\u52a8\u6765\u66f4\u65b0\u9006\u6620\u5c04\u3002\u8fd9\u79cd\u4f4e\u7ef4\u4fee\u6b63\u4fdd\u6301\u4e86\u5927\u90e8\u5206\u539f\u59cb\u7ed3\u6784\uff0c\u53ea\u5728\u7279\u5b9a\u65b9\u5411\u4e0a\u8fdb\u884c\u8c03\u6574\u3002</p>\n<h3 id=\"412-k\">4.1.2 \u79e9k\u66f4\u65b0\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p>\u8003\u8651Hessian\u77e9\u9635\u7684\u589e\u91cf\u66f4\u65b0\u573a\u666f\uff1a\n$$\\mathbf{H}_{new} = \\mathbf{H}_{old} + \\sum_{i=1}^{k} \\mathbf{g}_i\\mathbf{g}_i^T$$\n\u5176\u4e2d$\\mathbf{g}_i$\u662f\u65b0\u5230\u8fbe\u7684\u68af\u5ea6\u5411\u91cf\u3002\u76f4\u63a5\u5e94\u7528Woodbury\u516c\u5f0f\uff1a</p>\n<ol>\n<li><strong>\u9884\u8ba1\u7b97\u5f00\u9500</strong>\uff1a$\\mathcal{O}(n^2k)$\u7528\u4e8e\u8ba1\u7b97$\\mathbf{H}_{old}^{-1}\\mathbf{G}$\uff0c\u5176\u4e2d$\\mathbf{G} = [\\mathbf{g}_1, ..., \\mathbf{g}_k]$</li>\n<li><strong>\u4e2d\u95f4\u77e9\u9635\u6784\u9020</strong>\uff1a$\\mathcal{O}(nk^2)$\u7528\u4e8e\u5f62\u6210$\\mathbf{G}^T\\mathbf{H}_{old}^{-1}\\mathbf{G}$</li>\n<li><strong>\u5c0f\u89c4\u6a21\u6c42\u9006</strong>\uff1a$\\mathcal{O}(k^3)$\u7528\u4e8e\u6c42\u89e3$(\\mathbf{I}_k + \\mathbf{G}^T\\mathbf{H}_{old}^{-1}\\mathbf{G})^{-1}$</li>\n<li><strong>\u6700\u7ec8\u66f4\u65b0</strong>\uff1a$\\mathcal{O}(n^2k)$\u7528\u4e8e\u5916\u79ef\u66f4\u65b0</li>\n</ol>\n<p><strong>\u5185\u5b58\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u901a\u8fc7\u7ef4\u62a4$\\mathbf{L}\\mathbf{L}^T = \\mathbf{H}_{old}^{-1}$\u7684Cholesky\u5206\u89e3\uff0c\u53ef\u4ee5\u5c06\u5b58\u50a8\u9700\u6c42\u4ece$\\mathcal{O}(n^2)$\u964d\u81f3$\\mathcal{O}(n^2/2)$</li>\n<li>\u4f7f\u7528\u5757\u5b58\u50a8\u683c\u5f0f\uff0c\u5229\u7528CPU\u7f13\u5b58\u5c42\u6b21\u7ed3\u6784</li>\n<li>\u5bf9\u4e8e\u7a00\u758fHessian\uff0c\u4f7f\u7528\u538b\u7f29\u5b58\u50a8\u683c\u5f0f\uff08CSR/CSC\uff09</li>\n</ul>\n<p><strong>\u6279\u91cf\u66f4\u65b0\u7684\u4f18\u5316</strong>\uff1a\n\u5f53$k$\u8f83\u5927\u65f6\uff0c\u53ef\u4ee5\u5c06\u66f4\u65b0\u5206\u6279\u8fdb\u884c\uff1a\n$$\\mathbf{H}_{new} = ((\\mathbf{H}_{old} + \\sum_{i=1}^{k_1} \\mathbf{g}_i\\mathbf{g}_i^T) + \\sum_{i=k_1+1}^{k_1+k_2} \\mathbf{g}_i\\mathbf{g}_i^T) + ...$$\n\u6bcf\u6279\u4f7f\u7528\u8f83\u5c0f\u7684$k_i$\uff0c\u5e73\u8861\u8ba1\u7b97\u548c\u6570\u503c\u7a33\u5b9a\u6027\u3002</p>\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li><strong>\u77e9\u9635-\u5411\u91cf\u79ef\u5e76\u884c</strong>\uff1a$\\mathbf{H}_{old}^{-1}\\mathbf{G}$\u53ef\u4ee5\u6309\u5217\u5e76\u884c\u8ba1\u7b97</li>\n<li><strong>\u6279\u91cfGEMM\u4f18\u5316</strong>\uff1a\u5229\u7528\u9ad8\u5ea6\u4f18\u5316\u7684BLAS\u4f8b\u7a0b</li>\n<li><strong>GPU\u52a0\u901f</strong>\uff1a\u7279\u522b\u9002\u5408\u5927\u89c4\u6a21\u7a20\u5bc6\u77e9\u9635\u8fd0\u7b97</li>\n</ul>\n<h3 id=\"413\">4.1.3 \u6570\u503c\u7a33\u5b9a\u6027\u8003\u91cf</h3>\n<p>Woodbury\u516c\u5f0f\u7684\u6570\u503c\u7a33\u5b9a\u6027\u4f9d\u8d56\u4e8e\u51e0\u4e2a\u5173\u952e\u56e0\u7d20\uff1a</p>\n<ol>\n<li><strong>\u6761\u4ef6\u6570\u653e\u5927</strong>\uff1a\u5982\u679c$\\mathbf{A}$\u63a5\u8fd1\u5947\u5f02\uff0c\u5373$\\kappa(\\mathbf{A}) \\gg 1$\uff0c\u5219\u66f4\u65b0\u540e\u7684\u77e9\u9635\u6761\u4ef6\u6570\u53ef\u80fd\u8fdb\u4e00\u6b65\u6076\u5316\u3002\u76d1\u63a7\u6307\u6807\uff1a\n$$\\kappa(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T) \\leq \\kappa(\\mathbf{A})(1 + |\\mathbf{U}|_2|\\mathbf{C}|_2|\\mathbf{V}|_2|\\mathbf{A}^{-1}|_2)$$\n<strong>\u5b9e\u9645\u76d1\u63a7\u7b56\u7565</strong>\uff1a</li>\n</ol>\n<ul>\n<li>\u8ba1\u7b97\u6709\u6548\u6761\u4ef6\u6570\uff1a$\\kappa_{eff} = |\\mathbf{A}|_2|\\mathbf{A}^{-1}|_2$</li>\n<li>\u8bbe\u7f6e\u9884\u8b66\u9608\u503c\uff1a\u5f53$\\kappa_{eff} &gt; 10^8$\u65f6\u53d1\u51fa\u8b66\u544a</li>\n<li>\u4f7f\u7528\u589e\u91cf\u5f0f\u6761\u4ef6\u6570\u4f30\u8ba1\u907f\u514d\u6602\u8d35\u7684\u5b8c\u6574\u8ba1\u7b97</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u6b63\u5b9a\u6027\u4fdd\u6301</strong>\uff1a\u5bf9\u4e8eHessian\u66f4\u65b0\uff0c\u6211\u4eec\u9700\u8981\u786e\u4fdd\uff1a\n   - \u4f7f\u7528\u6b63\u5219\u5316\uff1a$\\mathbf{H} + \\lambda\\mathbf{I}$\uff0c\u5176\u4e2d$\\lambda &gt; 0$\n   - \u9a8c\u8bc1\u66f4\u65b0\u540e\u7684\u6700\u5c0f\u7279\u5f81\u503c\uff1a$\\lambda_{min}(\\mathbf{H}_{new}) &gt; \\epsilon$\n   - \u91c7\u7528\u4fee\u6b63\u7684Cholesky\u5206\u89e3\u5904\u7406\u63a5\u8fd1\u5947\u5f02\u7684\u60c5\u51b5</li>\n</ol>\n<p><strong>Levenberg-Marquardt\u578b\u81ea\u9002\u5e94\u6b63\u5219\u5316</strong>\uff1a\n$$\\lambda_k = \\begin{cases}\n   \\lambda_k / \\beta &amp; \\text{if } \\rho_k &gt; 0.75 \\\n   \\lambda_k &amp; \\text{if } 0.25 \\leq \\rho_k \\leq 0.75 \\\n   \\lambda_k \\cdot \\beta &amp; \\text{if } \\rho_k &lt; 0.25\n   \\end{cases}$$\n\u5176\u4e2d$\\rho_k$\u662f\u5b9e\u9645\u4e0b\u964d\u4e0e\u9884\u6d4b\u4e0b\u964d\u7684\u6bd4\u503c\uff0c$\\beta \\approx 2-10$\u3002</p>\n<ol start=\"3\">\n<li><strong>\u589e\u91cf\u8bef\u5dee\u7d2f\u79ef</strong>\uff1a\u591a\u6b21\u8fde\u7eed\u66f4\u65b0\u4f1a\u7d2f\u79ef\u820d\u5165\u8bef\u5dee\u3002\u5b9e\u8df5\u5efa\u8bae\uff1a\n   - \u6bcf\u9694$T$\u6b21\u66f4\u65b0\u540e\u91cd\u65b0\u8ba1\u7b97\u5b8c\u6574\u7684Hessian\n   - \u4f7f\u7528\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\uff0c\u5173\u952e\u6b65\u9aa4\u4f7f\u7528\u53cc\u7cbe\u5ea6\n   - \u5b9e\u65bdKahan\u6c42\u548c\u7b97\u6cd5\u51cf\u5c11\u6d6e\u70b9\u8bef\u5dee\u7d2f\u79ef</li>\n</ol>\n<p><strong>\u8bef\u5dee\u754c\u5206\u6790</strong>\uff1a\n   \u8bbe\u673a\u5668\u7cbe\u5ea6\u4e3a$\\epsilon_{mach}$\uff0c\u7ecf\u8fc7$k$\u6b21\u66f4\u65b0\u540e\u7684\u7d2f\u79ef\u8bef\u5dee\uff1a\n$$|\\tilde{\\mathbf{H}}_k - \\mathbf{H}_k|_F \\leq k \\cdot \\epsilon_{mach} \\cdot (c_1|\\mathbf{H}_0|_F + c_2\\sum_{i=1}^k |\\mathbf{u}_i|_2|\\mathbf{v}_i|_2)$$\n\u5176\u4e2d$c_1, c_2$\u662f\u4e0e\u7b97\u6cd5\u76f8\u5173\u7684\u5e38\u6570\u3002</p>\n<p><strong>\u7a33\u5b9a\u6027\u589e\u5f3a\u6280\u672f</strong>\uff1a</p>\n<p><strong>\u6280\u672f1\uff1a\u9884\u6761\u4ef6Woodbury\u516c\u5f0f</strong>\n\u5f15\u5165\u9884\u6761\u4ef6\u77e9\u9635$\\mathbf{P}$\uff1a\n$$(\\mathbf{P}^{-1}\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)^{-1} = \\mathbf{A}^{-1}\\mathbf{P} - \\mathbf{A}^{-1}\\mathbf{P}\\mathbf{U}(\\mathbf{C}^{-1} + \\mathbf{V}^T\\mathbf{P}^{-1}\\mathbf{A}^{-1}\\mathbf{P}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{P}^{-1}\\mathbf{A}^{-1}\\mathbf{P}$$\n\u9009\u62e9\u9002\u5f53\u7684$\\mathbf{P}$\u53ef\u4ee5\u6539\u5584\u6761\u4ef6\u6570\u3002</p>\n<p><strong>\u9884\u6761\u4ef6\u77e9\u9635\u7684\u9009\u62e9\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li><strong>\u5bf9\u89d2\u9884\u6761\u4ef6</strong>\uff1a$\\mathbf{P} = \\text{diag}(\\mathbf{A})$\uff0c\u6613\u4e8e\u8ba1\u7b97\u548c\u5b58\u50a8</li>\n<li><strong>\u4e0d\u5b8c\u5168Cholesky</strong>\uff1a$\\mathbf{P} = \\mathbf{L}\\mathbf{L}^T$\uff0c\u5176\u4e2d$\\mathbf{L}$\u662f\u7a00\u758f\u4e0b\u4e09\u89d2\u77e9\u9635</li>\n<li><strong>\u591a\u7ea7\u9884\u6761\u4ef6</strong>\uff1a\u7ed3\u5408\u7c97\u7f51\u683c\u6821\u6b63\u548c\u7ec6\u7f51\u683c\u5e73\u6ed1</li>\n<li><strong>\u7269\u7406\u542f\u53d1\u9884\u6761\u4ef6</strong>\uff1a\u57fa\u4e8e\u95ee\u9898\u7684\u7269\u7406\u7279\u6027\u8bbe\u8ba1\uff08\u5982\u62c9\u666e\u62c9\u65af\u7b97\u5b50\u7684\u9006\uff09</li>\n</ul>\n<p><strong>\u6280\u672f2\uff1a\u8fed\u4ee3\u7ec6\u5316(Iterative Refinement)</strong>\n\u5bf9\u4e8e\u7ebf\u6027\u7cfb\u7edf$(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)\\mathbf{x} = \\mathbf{b}$\uff1a</p>\n<ol>\n<li>\u4f7f\u7528Woodbury\u516c\u5f0f\u8ba1\u7b97\u521d\u59cb\u89e3$\\mathbf{x}_0$</li>\n<li>\u8ba1\u7b97\u6b8b\u5dee$\\mathbf{r}_i = \\mathbf{b} - (\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)\\mathbf{x}_i$</li>\n<li>\u89e3\u4fee\u6b63\u65b9\u7a0b\u5f97\u5230$\\delta\\mathbf{x}_i$</li>\n<li>\u66f4\u65b0$\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\delta\\mathbf{x}_i$</li>\n</ol>\n<p><strong>\u6536\u655b\u6027\u5206\u6790</strong>\uff1a\n\u8bbe$\\mathbf{E} = \\mathbf{I} - (\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)^{-1}_{approx}(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)$\u4e3a\u8fed\u4ee3\u77e9\u9635\uff0c\u5219\uff1a</p>\n<ul>\n<li>\u6536\u655b\u6761\u4ef6\uff1a$\\rho(\\mathbf{E}) &lt; 1$\uff08\u8c31\u534a\u5f84\u5c0f\u4e8e1\uff09</li>\n<li>\u6536\u655b\u901f\u5ea6\uff1a$|\\mathbf{x}_i - \\mathbf{x}^*| \\leq \\rho(\\mathbf{E})^i |\\mathbf{x}_0 - \\mathbf{x}^*|$</li>\n<li>\u5b9e\u8df5\u4e2d\u901a\u5e382-3\u6b21\u8fed\u4ee3\u5373\u53ef\u8fbe\u5230\u673a\u5668\u7cbe\u5ea6</li>\n</ul>\n<p><strong>\u6280\u672f3\uff1a\u5206\u5c42Woodbury\u66f4\u65b0</strong>\n\u5bf9\u4e8e\u591a\u4e2a\u4f4e\u79e9\u66f4\u65b0\uff0c\u4f7f\u7528\u4e8c\u53c9\u6811\u7ed3\u6784\u7ec4\u7ec7\u8ba1\u7b97\uff1a\n$$\\mathbf{A} + \\sum_{i=1}^{2^m} \\mathbf{u}_i\\mathbf{v}_i^T = ((\\mathbf{A} + \\sum_{i=1}^{2^{m-1}} \\mathbf{u}_i\\mathbf{v}_i^T) + \\sum_{i=2^{m-1}+1}^{2^m} \\mathbf{u}_i\\mathbf{v}_i^T)$$\n\u8fd9\u79cd\u5206\u5c42\u65b9\u6cd5\u53ef\u4ee5\u66f4\u597d\u5730\u63a7\u5236\u6570\u503c\u8bef\u5dee\u4f20\u64ad\u3002</p>\n<p><strong>\u5206\u5c42\u7b56\u7565\u7684\u4f18\u52bf</strong>\uff1a</p>\n<ol>\n<li><strong>\u8bef\u5dee\u5c40\u90e8\u5316</strong>\uff1a\u6bcf\u5c42\u7684\u820d\u5165\u8bef\u5dee\u4e0d\u4f1a\u76f4\u63a5\u4f20\u64ad\u5230\u5176\u4ed6\u5206\u652f</li>\n<li><strong>\u5e76\u884c\u53cb\u597d</strong>\uff1a\u4e0d\u540c\u5206\u652f\u53ef\u4ee5\u72ec\u7acb\u8ba1\u7b97</li>\n<li><strong>\u5185\u5b58\u6548\u7387</strong>\uff1a\u53ef\u4ee5\u9010\u5c42\u91ca\u653e\u4e2d\u95f4\u7ed3\u679c</li>\n<li><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6</strong>\uff1a\u4e0d\u540c\u5206\u652f\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u7cbe\u5ea6\u7ea7\u522b</li>\n</ol>\n<p><strong>\u6700\u4f18\u5206\u5c42\u6df1\u5ea6</strong>\uff1a\n\u7ed9\u5b9a$n$\u4e2a\u79e9-1\u66f4\u65b0\uff0c\u6700\u4f18\u6811\u6df1\u5ea6$d^* \\approx \\log_2(n/k^*)$\uff0c\u5176\u4e2d$k^*$\u662f\u5355\u6b21Woodbury\u66f4\u65b0\u7684\u6700\u4f18\u79e9\uff0c\u901a\u5e38$k^* \\in [10, 100]$\u53d6\u51b3\u4e8e\u77e9\u9635\u7ef4\u5ea6\u548c\u786c\u4ef6\u7279\u6027\u3002</p>\n<h3 id=\"414-quasi-newton\">4.1.4 \u5728quasi-Newton\u65b9\u6cd5\u4e2d\u7684\u5e94\u7528</h3>\n<p>BFGS\u66f4\u65b0\u53ef\u4ee5\u4f18\u96c5\u5730\u8868\u793a\u4e3aWoodbury\u5f62\u5f0f\u3002\u7ed9\u5b9a\u4f4d\u79fb$\\mathbf{s}_k = \\mathbf{x}_{k+1} - \\mathbf{x}_k$\u548c\u68af\u5ea6\u53d8\u5316$\\mathbf{y}_k = \\mathbf{g}_{k+1} - \\mathbf{g}_k$\uff1a\n$$\\mathbf{B}_{k+1}^{-1} = \\mathbf{B}_k^{-1} + \\frac{(\\mathbf{s}_k^T\\mathbf{y}_k + \\mathbf{y}_k^T\\mathbf{B}_k^{-1}\\mathbf{y}_k)(\\mathbf{s}_k\\mathbf{s}_k^T)}{(\\mathbf{s}_k^T\\mathbf{y}_k)^2} - \\frac{\\mathbf{B}_k^{-1}\\mathbf{y}_k\\mathbf{s}_k^T + \\mathbf{s}_k\\mathbf{y}_k^T\\mathbf{B}_k^{-1}}{\\mathbf{s}_k^T\\mathbf{y}_k}$$\n<strong>\u6df1\u5165\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u8fd9\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u79e9-2\u66f4\u65b0\uff0c\u53ef\u4ee5\u5206\u89e3\u4e3a\u4e24\u4e2a\u79e9-1\u66f4\u65b0</li>\n<li>L-BFGS\u901a\u8fc7\u9650\u5236\u5b58\u50a8\u7684$(\\mathbf{s}_i, \\mathbf{y}_i)$\u5bf9\u6570\u91cf\uff0c\u5b9e\u73b0\u4e86\u5185\u5b58\u53d7\u9650\u7684Hessian\u9006\u8fd1\u4f3c</li>\n<li>\u4e24\u5faa\u73af\u9012\u5f52(two-loop recursion)\u7b97\u6cd5\u907f\u514d\u4e86\u663e\u5f0f\u77e9\u9635\u5b58\u50a8</li>\n</ul>\n<p><strong>BFGS\u66f4\u65b0\u7684\u51e0\u4f55\u89e3\u91ca</strong>\uff1a\nBFGS\u66f4\u65b0\u6ee1\u8db3\u62df\u725b\u987f\u6761\u4ef6\uff08secant equation\uff09\uff1a\n$$\\mathbf{B}_{k+1}\\mathbf{s}_k = \\mathbf{y}_k$$\n\u8fd9\u786e\u4fdd\u4e86\u65b0\u7684Hessian\u8fd1\u4f3c\u5728\u6700\u8fd1\u7684\u641c\u7d22\u65b9\u5411\u4e0a\u7cbe\u786e\u5339\u914d\u66f2\u7387\u4fe1\u606f\u3002\u66f4\u65b0\u516c\u5f0f\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a</p>\n<ol>\n<li><strong>\u4fdd\u6301\u5bf9\u79f0\u6027</strong>\uff1a\u901a\u8fc7\u79e9-2\u66f4\u65b0\u786e\u4fdd$\\mathbf{B}_{k+1} = \\mathbf{B}_{k+1}^T$</li>\n<li><strong>\u6700\u5c0f\u6539\u53d8\u539f\u5219</strong>\uff1a\u5728\u6ee1\u8db3secant\u6761\u4ef6\u4e0b\uff0c\u4f7f$|\\mathbf{B}_{k+1} - \\mathbf{B}_k|_W$\u6700\u5c0f\uff08\u67d0\u79cd\u52a0\u6743\u8303\u6570\u4e0b\uff09</li>\n<li><strong>\u6b63\u5b9a\u6027\u4fdd\u6301</strong>\uff1a\u5f53$\\mathbf{s}_k^T\\mathbf{y}_k &gt; 0$\uff08Wolfe\u6761\u4ef6\uff09\u65f6\uff0c\u4fdd\u8bc1\u6b63\u5b9a\u6027</li>\n</ol>\n<p><strong>L-BFGS\u7684Woodbury\u89c6\u89d2</strong>\uff1a\nL-BFGS\u7ef4\u62a4$m$\u4e2a\u6700\u8fd1\u7684$(\\mathbf{s}_i, \\mathbf{y}_i)$\u5bf9\uff0c\u9690\u5f0f\u8868\u793a\uff1a\n$$\\mathbf{B}_k^{-1} \\approx \\mathbf{H}_0 + \\sum_{i=k-m+1}^{k} \\alpha_i \\mathbf{s}_i\\mathbf{s}_i^T - \\sum_{i=k-m+1}^{k} \\beta_i \\mathbf{B}_i^{-1}\\mathbf{y}_i(\\mathbf{B}_i^{-1}\\mathbf{y}_i)^T$$\n\u5176\u4e2d\u7cfb\u6570$\\alpha_i, \\beta_i$\u7531\u66f2\u7387\u6761\u4ef6\u51b3\u5b9a\u3002</p>\n<p><strong>\u6709\u9650\u5185\u5b58BFGS\u7684\u53d8\u4f53</strong>\uff1a</p>\n<ol>\n<li><strong>\u7d27\u51d1\u8868\u793aL-BFGS</strong>\uff1a\n   \u5c06\u6240\u6709\u66f4\u65b0\u7ec4\u7ec7\u4e3a\u7d27\u51d1\u5f62\u5f0f\uff1a\n$$\\mathbf{B}_k^{-1} = \\mathbf{H}_0 + [\\mathbf{S}_k \\quad \\mathbf{H}_0\\mathbf{Y}_k] \\begin{bmatrix} \\mathbf{D}_k + \\mathbf{L}_k + \\mathbf{L}_k^T &amp; \\mathbf{L}_k \\ \\mathbf{L}_k^T &amp; -\\mathbf{D}_k^{-1} \\end{bmatrix}^{-1} \\begin{bmatrix} \\mathbf{S}_k^T \\ \\mathbf{Y}_k^T\\mathbf{H}_0 \\end{bmatrix}$$\n\u5176\u4e2d$\\mathbf{S}_k = [\\mathbf{s}_{k-m+1}, ..., \\mathbf{s}_k]$\uff0c$\\mathbf{Y}_k = [\\mathbf{y}_{k-m+1}, ..., \\mathbf{y}_k]$\u3002</li>\n</ol>\n<p><strong>\u7d27\u51d1\u8868\u793a\u7684\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u77e9\u9635-\u5411\u91cf\u79ef\u8ba1\u7b97\uff1a$\\mathcal{O}(nm)$\u800c\u975e$\\mathcal{O}(n^2)$</li>\n<li>\u53ef\u4ee5\u5229\u7528\u9ad8\u5ea6\u4f18\u5316\u7684BLAS-3\u64cd\u4f5c</li>\n<li>\u4fbf\u4e8e\u5e76\u884c\u5316\u548cGPU\u52a0\u901f</li>\n<li>\u652f\u6301\u9ad8\u6548\u7684\u9884\u6761\u4ef6\u5b50\u6784\u9020</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u81ea\u9002\u5e94L-BFGS</strong>\uff1a\n   - \u52a8\u6001\u8c03\u6574\u5185\u5b58\u5927\u5c0f$m$\u57fa\u4e8e\u53ef\u7528\u5185\u5b58\u548c\u95ee\u9898\u7ef4\u5ea6\n   - \u6839\u636e\u66f2\u7387\u4fe1\u606f\u9009\u62e9\u6027\u4fdd\u7559$(\\mathbf{s}_i, \\mathbf{y}_i)$\u5bf9\n   - \u4f7f\u7528\u91cd\u8981\u6027\u91c7\u6837\u7b56\u7565\u7ba1\u7406\u5386\u53f2\u4fe1\u606f</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u7b56\u7565\u8be6\u89e3</strong>\uff1a</p>\n<ul>\n<li><strong>\u66f2\u7387\u53d8\u5316\u68c0\u6d4b</strong>\uff1a\u5f53$|\\mathbf{s}_i^T\\mathbf{y}_i - \\mathbf{s}_{i-1}^T\\mathbf{y}_{i-1}| &gt; \\tau$\u65f6\u589e\u52a0$m$</li>\n<li><strong>\u5185\u5b58\u538b\u529b\u54cd\u5e94</strong>\uff1a\u76d1\u63a7\u7cfb\u7edf\u5185\u5b58\u4f7f\u7528\uff0c\u5fc5\u8981\u65f6\u51cf\u5c11$m$</li>\n<li><strong>\u6536\u655b\u9636\u6bb5\u8bc6\u522b</strong>\uff1a\u63a5\u8fd1\u6700\u4f18\u65f6\u51cf\u5c11$m$\u4ee5\u52a0\u5feb\u8ba1\u7b97</li>\n<li><strong>\u91cd\u8981\u6027\u5ea6\u91cf</strong>\uff1a$w_i = \\frac{|\\mathbf{y}_i|^2}{\\mathbf{s}_i^T\\mathbf{y}_i}$\uff0c\u4fdd\u7559\u6743\u91cd\u5927\u7684\u5bf9</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5206\u5e03\u5f0fL-BFGS</strong>\uff1a\n   - \u5c06$(\\mathbf{s}_i, \\mathbf{y}_i)$\u5bf9\u5206\u5e03\u5b58\u50a8\u5728\u4e0d\u540c\u8282\u70b9\n   - \u4f7f\u7528AllReduce\u64cd\u4f5c\u540c\u6b65\u4e24\u5faa\u73af\u9012\u5f52\u7684\u4e2d\u95f4\u7ed3\u679c\n   - \u5f02\u6b65\u66f4\u65b0\u7b56\u7565\u5904\u7406\u901a\u4fe1\u5ef6\u8fdf</li>\n</ol>\n<p><strong>\u901a\u4fe1\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li><strong>\u5411\u91cf\u805a\u5408</strong>\uff1a\u6279\u91cf\u53d1\u9001\u591a\u4e2a\u5411\u91cf\u51cf\u5c11\u901a\u4fe1\u8f6e\u6570</li>\n<li><strong>\u538b\u7f29\u6280\u672f</strong>\uff1a\u4f7f\u7528\u91cf\u5316\u6216\u7a00\u758f\u5316\u51cf\u5c11\u901a\u4fe1\u91cf</li>\n<li><strong>\u91cd\u53e0\u901a\u4fe1\u4e0e\u8ba1\u7b97</strong>\uff1a\u5728\u7b49\u5f85\u901a\u4fe1\u65f6\u6267\u884c\u672c\u5730\u8ba1\u7b97</li>\n<li><strong>\u5206\u5c42\u901a\u4fe1\u62d3\u6251</strong>\uff1a\u5229\u7528\u7f51\u7edc\u62d3\u6251\u4f18\u5316\u6570\u636e\u8def\u7531</li>\n</ul>\n<p><strong>\u4e0e\u5176\u4ed6quasi-Newton\u65b9\u6cd5\u7684\u8054\u7cfb</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>DFP (Davidon-Fletcher-Powell)</strong>\uff1a\n   DFP\u66f4\u65b0Hessian\u8fd1\u4f3c\u800c\u975e\u5176\u9006\uff1a\n$$\\mathbf{B}_{k+1} = \\mathbf{B}_k - \\frac{\\mathbf{B}_k\\mathbf{s}_k\\mathbf{s}_k^T\\mathbf{B}_k}{\\mathbf{s}_k^T\\mathbf{B}_k\\mathbf{s}_k} + \\frac{\\mathbf{y}_k\\mathbf{y}_k^T}{\\mathbf{y}_k^T\\mathbf{s}_k}$$\n\u8fd9\u4e5f\u662f\u79e9-2\u66f4\u65b0\uff0c\u53ef\u7528Woodbury\u516c\u5f0f\u5904\u7406\u3002</p>\n</li>\n<li>\n<p><strong>SR1 (Symmetric Rank-1)</strong>\uff1a\n$$\\mathbf{B}_{k+1} = \\mathbf{B}_k + \\frac{(\\mathbf{y}_k - \\mathbf{B}_k\\mathbf{s}_k)(\\mathbf{y}_k - \\mathbf{B}_k\\mathbf{s}_k)^T}{(\\mathbf{y}_k - \\mathbf{B}_k\\mathbf{s}_k)^T\\mathbf{s}_k}$$\nSR1\u662f\u79e9-1\u66f4\u65b0\uff0c\u76f4\u63a5\u5e94\u7528Sherman-Morrison\u516c\u5f0f\u3002</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\u5982\u4f55\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u9ad8\u6548\u5b9e\u73b0Woodbury\u66f4\u65b0\uff0c\u7279\u522b\u662f\u5f53\u4e0d\u540c\u8ba1\u7b97\u8282\u70b9\u6301\u6709\u6570\u636e\u7684\u4e0d\u540c\u5b50\u96c6\u65f6\uff1f</li>\n<li>\u80fd\u5426\u8bbe\u8ba1\u81ea\u9002\u5e94\u7684\u79e9\u9009\u62e9\u7b56\u7565\uff0c\u5728\u79e9-1\u5230\u79e9-k\u66f4\u65b0\u4e4b\u95f4\u52a8\u6001\u5207\u6362\uff1f</li>\n<li>\u5982\u4f55\u5c06Woodbury\u6280\u672f\u6269\u5c55\u5230\u975e\u5bf9\u79f0\u6216\u4e0d\u5b9a\u77e9\u9635\u7684\u66f4\u65b0\uff1f</li>\n<li>\u662f\u5426\u53ef\u4ee5\u5229\u7528\u968f\u673a\u5316\u6280\u672f\u52a0\u901f\u5927\u89c4\u6a21Woodbury\u66f4\u65b0\uff1f</li>\n<li>\u5982\u4f55\u5c06\u91cf\u5b50\u8ba1\u7b97\u7684\u601d\u60f3\u5e94\u7528\u4e8e\u77e9\u9635\u66f4\u65b0\u95ee\u9898\uff1f</li>\n</ol>\n<p><strong>\u5f00\u653e\u6027\u7814\u7a76\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li><strong>\u975e\u7ebf\u6027Woodbury</strong>\uff1a\u5bf9\u4e8e\u67d0\u4e9b\u7ed3\u6784\u5316\u975e\u7ebf\u6027\u6270\u52a8\uff0c\u662f\u5426\u5b58\u5728\u7c7b\u4f3c\u7684\u9ad8\u6548\u66f4\u65b0\u516c\u5f0f\uff1f</li>\n<li><strong>\u7a00\u758fWoodbury</strong>\uff1a\u5f53$\\mathbf{U}, \\mathbf{V}$\u7a00\u758f\u65f6\uff0c\u5982\u4f55\u4fdd\u6301\u66f4\u65b0\u540e\u77e9\u9635\u7684\u7a00\u758f\u6027\uff1f</li>\n<li><strong>\u6982\u7387Woodbury</strong>\uff1a\u5728\u8d1d\u53f6\u65af\u6846\u67b6\u4e0b\uff0c\u5982\u4f55\u5904\u7406\u4e0d\u786e\u5b9a\u6027\u7684\u4f20\u64ad\uff1f</li>\n</ul>\n<h2 id=\"42-block-wise\">4.2 Block-wise\u66f4\u65b0\u7b56\u7565</h2>\n<h3 id=\"421\">4.2.1 \u5206\u5757\u77e9\u9635\u7684\u589e\u91cf\u66f4\u65b0</h3>\n<p>\u5f53Hessian\u77e9\u9635\u5177\u6709\u5929\u7136\u7684\u5757\u7ed3\u6784\u65f6\uff08\u5982\u591a\u4efb\u52a1\u5b66\u4e60\u3001\u56fe\u795e\u7ecf\u7f51\u7edc\u7b49\uff09\uff0c\u5206\u5757\u66f4\u65b0\u7b56\u7565\u80fd\u591f\u663e\u8457\u63d0\u5347\u8ba1\u7b97\u6548\u7387\u3002\u8003\u8651\u5206\u5757Hessian\uff1a\n$$\\mathbf{H} = \\begin{bmatrix}\n\\mathbf{H}_{11} &amp; \\mathbf{H}_{12} &amp; \\cdots &amp; \\mathbf{H}_{1B} \\\n\\mathbf{H}_{21} &amp; \\mathbf{H}_{22} &amp; \\cdots &amp; \\mathbf{H}_{2B} \\\n\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\n\\mathbf{H}_{B1} &amp; \\mathbf{H}_{B2} &amp; \\cdots &amp; \\mathbf{H}_{BB}\n\\end{bmatrix}$$\n<strong>\u5206\u5757Woodbury\u516c\u5f0f</strong>\uff1a\u5f53\u53ea\u6709\u90e8\u5206\u5757\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u4f8b\u5982\u5757$(i,j)$\u66f4\u65b0\u4e3a$\\mathbf{H}_{ij} + \\Delta\\mathbf{H}_{ij}$\uff0c\u6574\u4e2a\u9006\u77e9\u9635\u7684\u66f4\u65b0\u53ef\u4ee5\u901a\u8fc7Schur\u8865\u6765\u9ad8\u6548\u8ba1\u7b97\u3002</p>\n<p><strong>\u57fa\u7840\u7406\u8bba</strong>\uff1a\u5bf9\u4e8e2\u00d72\u5206\u5757\u77e9\u9635\uff1a\n$$\\begin{bmatrix} \\mathbf{A} &amp; \\mathbf{B} \\ \\mathbf{C} &amp; \\mathbf{D} \\end{bmatrix}^{-1} = \\begin{bmatrix} \\mathbf{A}^{-1} + \\mathbf{A}^{-1}\\mathbf{B}\\mathbf{S}^{-1}\\mathbf{C}\\mathbf{A}^{-1} &amp; -\\mathbf{A}^{-1}\\mathbf{B}\\mathbf{S}^{-1} \\ -\\mathbf{S}^{-1}\\mathbf{C}\\mathbf{A}^{-1} &amp; \\mathbf{S}^{-1} \\end{bmatrix}$$\n\u5176\u4e2d$\\mathbf{S} = \\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$\u662fSchur\u8865\u3002</p>\n<p><strong>\u5c40\u90e8\u66f4\u65b0\u7684\u5168\u5c40\u5f71\u54cd</strong>\uff1a\n\u5f53\u5757$(i,j)$\u66f4\u65b0\u65f6\uff0c\u5f71\u54cd\u4f20\u64ad\u9075\u5faa\u4ee5\u4e0b\u89c4\u5f8b\uff1a</p>\n<ol>\n<li><strong>\u76f4\u63a5\u5f71\u54cd</strong>\uff1a\u7b2c$i$\u884c\u548c\u7b2c$j$\u5217\u7684\u6240\u6709\u5757</li>\n<li><strong>\u95f4\u63a5\u5f71\u54cd</strong>\uff1a\u901a\u8fc7Schur\u8865\u4f20\u64ad\u5230\u5176\u4ed6\u5757</li>\n<li><strong>\u8870\u51cf\u6027\u8d28</strong>\uff1a\u5f71\u54cd\u968f\u7740\u5757\u4e4b\u95f4\u7684\"\u8ddd\u79bb\"\u6307\u6570\u8870\u51cf</li>\n</ol>\n<p><strong>\u9ad8\u6548\u66f4\u65b0\u7b97\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7b97\u6cd5\uff1a\u5757\u77e9\u9635\u589e\u91cf\u66f4\u65b0\n\u8f93\u5165\uff1a\u5f53\u524d\u9006\u77e9\u9635<span class=\"p\">$</span>\\<span class=\"nv\">mathbf</span><span class=\"p\">{</span><span class=\"nv\">H</span><span class=\"p\">}</span><span class=\"o\">^</span><span class=\"p\">{</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">}$</span>\uff0c\u66f4\u65b0\u5757\u4f4d\u7f6e<span class=\"p\">$(</span><span class=\"nv\">i</span><span class=\"p\">,</span><span class=\"nv\">j</span><span class=\"p\">)$</span>\uff0c\u66f4\u65b0\u91cf<span class=\"p\">$</span>\\<span class=\"nv\">Delta</span>\\<span class=\"nv\">mathbf</span><span class=\"p\">{</span><span class=\"nv\">H</span><span class=\"p\">}</span><span class=\"nv\">_</span><span class=\"p\">{</span><span class=\"nv\">ij</span><span class=\"p\">}$</span>\n\u8f93\u51fa\uff1a\u66f4\u65b0\u540e\u7684\u9006\u77e9\u9635\n\n<span class=\"mi\">1</span><span class=\"o\">.</span><span class=\"w\"> </span>\u63d0\u53d6\u76f8\u5173\u5b50\u77e9\u9635\n<span class=\"mi\">2</span><span class=\"o\">.</span><span class=\"w\"> </span>\u8ba1\u7b97\u5c40\u90e8<span class=\"nv\">Schur\u8865</span>\n<span class=\"mi\">3</span><span class=\"o\">.</span><span class=\"w\"> </span>\u5e94\u7528\u5757<span class=\"nv\">Woodbury\u516c\u5f0f</span>\n<span class=\"mi\">4</span><span class=\"o\">.</span><span class=\"w\"> </span>\u66f4\u65b0\u53d7\u5f71\u54cd\u7684\u5757\n</code></pre></div>\n\n<p>\u5173\u952e\u6280\u672f\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5c40\u90e8\u66f4\u65b0\u4f20\u64ad</strong>\uff1a\u8bc6\u522b\u54ea\u4e9b\u5757\u4f1a\u53d7\u5230\u5f71\u54cd\n   - \u4f7f\u7528\u4f9d\u8d56\u56fe\u8ffd\u8e2a\u66f4\u65b0\u4f20\u64ad\u8def\u5f84\n   - \u526a\u679d\u7b56\u7565\uff1a\u5f53\u66f4\u65b0\u91cf\u5c0f\u4e8e\u9608\u503c\u65f6\u505c\u6b62\u4f20\u64ad\n   - \u5ef6\u8fdf\u66f4\u65b0\uff1a\u7d2f\u79ef\u591a\u4e2a\u5c0f\u66f4\u65b0\u540e\u6279\u91cf\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u6027\u5229\u7528</strong>\uff1a\u8bb8\u591a\u5b9e\u9645\u95ee\u9898\u4e2d\uff0c\u8de8\u5757\u7684\u76f8\u5173\u6027\u8f83\u5f31\n   - \u5757\u5e26\u72b6\u7ed3\u6784\uff1a\u53ea\u6709\u76f8\u90bb\u5757\u4e4b\u95f4\u6709\u975e\u96f6\u5143\u7d20\n   - \u5c42\u6b21\u7ed3\u6784\uff1a\u4e0d\u540c\u5c42\u7ea7\u7684\u5757\u5177\u6709\u4e0d\u540c\u7684\u8026\u5408\u5f3a\u5ea6\n   - \u56fe\u8bf1\u5bfc\u7a00\u758f\u6027\uff1a\u57fa\u4e8e\u95ee\u9898\u7684\u56fe\u7ed3\u6784\u786e\u5b9a\u5757\u8fde\u63a5</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0</strong>\uff1a\u4e0d\u540c\u5757\u53ef\u4ee5\u5728\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\u4e0a\u66f4\u65b0\n   - \u5feb\u901f\u53d8\u5316\u7684\u5757\uff08\u5982\u8f93\u51fa\u5c42\uff09\u9891\u7e41\u66f4\u65b0\n   - \u7f13\u6162\u53d8\u5316\u7684\u5757\uff08\u5982\u5e95\u5c42\u7279\u5f81\uff09\u8f83\u5c11\u66f4\u65b0\n   - \u81ea\u9002\u5e94\u66f4\u65b0\u9891\u7387\u57fa\u4e8e\u5757\u7684\"\u6d3b\u8dc3\u5ea6\"</p>\n</li>\n</ol>\n<p><strong>\u591a\u7ea7\u5206\u5757\u7b56\u7565</strong>\uff1a\n\u5bf9\u4e8e\u8d85\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u53ef\u4ee5\u91c7\u7528\u591a\u7ea7\u5206\u5757\uff1a\n$$\\mathbf{H} = \\begin{bmatrix} \\mathbf{H}^{(1)} &amp; \\mathbf{H}^{(1,2)} \\ \\mathbf{H}^{(2,1)} &amp; \\mathbf{H}^{(2)} \\end{bmatrix}$$\n\u5176\u4e2d\u6bcf\u4e2a$\\mathbf{H}^{(i)}$\u672c\u8eab\u53c8\u662f\u5206\u5757\u77e9\u9635\u3002\u8fd9\u79cd\u5c42\u6b21\u7ed3\u6784\u5141\u8bb8\uff1a</p>\n<ul>\n<li>\u4e0d\u540c\u7c92\u5ea6\u7684\u5e76\u884c\u5316</li>\n<li>\u81ea\u9002\u5e94\u7684\u7cbe\u5ea6\u63a7\u5236</li>\n<li>\u5185\u5b58\u5c42\u6b21\u7684\u6709\u6548\u5229\u7528</li>\n</ul>\n<h3 id=\"422\">4.2.2 \u7a00\u758f\u6027\u4fdd\u6301\u6280\u672f</h3>\n<p>\u589e\u91cf\u66f4\u65b0\u53ef\u80fd\u7834\u574f\u539f\u6709\u7684\u7a00\u758f\u7ed3\u6784\u3002\u4fdd\u6301\u7a00\u758f\u6027\u7684\u7b56\u7565\u5305\u62ec\uff1a</p>\n<ol>\n<li><strong>\u9608\u503c\u5316\u7b56\u7565</strong>\uff1a\n$$[\\mathbf{H}_{new}]_{ij} = \\begin{cases}\n   [\\mathbf{H}_{new}]_{ij} &amp; \\text{if } |[\\mathbf{H}_{new}]_{ij}| &gt; \\tau \\\n   0 &amp; \\text{otherwise}\n   \\end{cases}$$\n\u5176\u4e2d$\\tau$\u9700\u8981\u81ea\u9002\u5e94\u9009\u62e9\u4ee5\u5e73\u8861\u7a00\u758f\u6027\u548c\u8fd1\u4f3c\u7cbe\u5ea6\u3002</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u9608\u503c\u9009\u62e9</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u77e9\u9635\u8303\u6570\uff1a$\\tau = \\epsilon |\\mathbf{H}|_F / \\sqrt{n}$</li>\n<li>\u57fa\u4e8e\u8c31\u534a\u5f84\uff1a$\\tau = \\epsilon \\lambda_{max}(\\mathbf{H})$</li>\n<li>\u57fa\u4e8e\u7edf\u8ba1\u663e\u8457\u6027\uff1a\u4fdd\u7559$p$\u503c\u5c0f\u4e8e$\\alpha$\u7684\u5143\u7d20</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u7ed3\u6784\u5316\u7a00\u758f\u6a21\u5f0f</strong>\uff1a\n   - <strong>\u9884\u5b9a\u4e49\u7a00\u758f\u6a21\u5f0f</strong>\uff1a<ul>\n<li>\u5e26\u72b6\u77e9\u9635\uff1a$|i-j| &gt; b \\Rightarrow [\\mathbf{H}]_{ij} = 0$</li>\n<li>\u5757\u5bf9\u89d2\uff1a\u4e0d\u540c\u5757\u4e4b\u95f4\u65e0\u8fde\u63a5</li>\n<li>Arrow\u77e9\u9635\uff1a\u53ea\u6709\u7b2c\u4e00\u884c/\u5217\u548c\u5bf9\u89d2\u7ebf\u975e\u96f6</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li>\n<p><strong>\u57fa\u4e8e\u56fe\u7ed3\u6784\u7684\u7a00\u758f\u6a21\u5f0f</strong>\uff1a</p>\n<ul>\n<li>\u90bb\u63a5\u77e9\u9635\u5b9a\u4e49\u7684\u7a00\u758f\u6027</li>\n<li>$k$-\u6700\u8fd1\u90bb\u56fe</li>\n<li>\u5c0f\u4e16\u754c\u7f51\u7edc\u7ed3\u6784</li>\n</ul>\n</li>\n<li>\n<p><strong>\u5b66\u4e60\u5f97\u5230\u7684\u7a00\u758f\u6a21\u5f0f</strong>\uff1a</p>\n<ul>\n<li>\u901a\u8fc7$L_0$\u6b63\u5219\u5316\uff1a$\\min_{\\mathbf{H}} f(\\mathbf{H}) + \\lambda |\\mathbf{H}|_0$</li>\n<li>\u901a\u8fc7$L_1$\u6b63\u5219\u5316\u4f5c\u4e3a\u51f8\u677e\u5f1b</li>\n<li>\u4f7f\u7528\u95e8\u63a7\u673a\u5236\u5b66\u4e60\u7a00\u758fmask</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u589e\u91cf\u7a00\u758f\u5316</strong>\uff1a\n   - \u7ef4\u62a4\u4e00\u4e2a\"\u6d3b\u8dc3\u96c6\"$\\mathcal{A} = {(i,j): [\\mathbf{H}]_{ij} \\neq 0}$\n   - \u53ea\u5728\u6d3b\u8dc3\u96c6\u5185\u8fdb\u884c\u66f4\u65b0\n   - \u5468\u671f\u6027\u5730\u91cd\u65b0\u8bc4\u4f30\u7a00\u758f\u6a21\u5f0f\uff1a<ul>\n<li>\u6dfb\u52a0\u89c4\u5219\uff1a\u68af\u5ea6\u5927\u7684\u4f4d\u7f6e</li>\n<li>\u5220\u9664\u89c4\u5219\uff1a\u957f\u65f6\u95f4\u672a\u66f4\u65b0\u6216\u503c\u5f88\u5c0f\u7684\u4f4d\u7f6e</li>\n</ul>\n</li>\n</ol>\n<p><strong>\u52a8\u6001\u7a00\u758f\u6027\u7b97\u6cd5</strong>\uff1a\n   ```\n   \u6bcf\u9694T\u6b65\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u6240\u6709\u4f4d\u7f6e\u7684\u91cd\u8981\u6027\u5206\u6570</li>\n<li>\u4fdd\u7559top-k\u4e2a\u91cd\u8981\u4f4d\u7f6e</li>\n<li>\u968f\u673a\u63a2\u7d22\uff1a\u4ee5\u5c0f\u6982\u7387\u6fc0\u6d3b\u65b0\u4f4d\u7f6e</li>\n<li>\u66f4\u65b0\u6d3b\u8dc3\u96c6\n   ```</li>\n</ol>\n<p><strong>\u7a00\u758f\u6027\u4e0e\u8fd1\u4f3c\u8bef\u5dee\u7684\u7406\u8bba\u5206\u6790</strong>\uff1a\n\u8bbe\u771f\u5b9eHessian\u4e3a$\\mathbf{H}$\uff0c\u7a00\u758f\u8fd1\u4f3c\u4e3a$\\tilde{\\mathbf{H}}$\uff0c\u5219\uff1a\n$$|\\mathbf{H}^{-1} - \\tilde{\\mathbf{H}}^{-1}|_2 \\leq \\frac{|\\mathbf{H} - \\tilde{\\mathbf{H}}|_2}{\\lambda_{min}(\\mathbf{H})\\lambda_{min}(\\tilde{\\mathbf{H}})}$$\n\u8fd9\u8868\u660e\u4fdd\u6301\u826f\u597d\u6761\u4ef6\u6570\u5bf9\u7a00\u758f\u8fd1\u4f3c\u81f3\u5173\u91cd\u8981\u3002</p>\n<p><strong>\u6027\u80fd\u5f71\u54cd</strong>\uff1a\u7a00\u758f\u77e9\u9635\u8fd0\u7b97\u53ef\u4ee5\u5229\u7528\u4e13\u95e8\u7684\u6570\u636e\u7ed3\u6784\u548c\u4f18\u5316\u5e93\uff1a</p>\n<ul>\n<li><strong>CSR/CSC\u683c\u5f0f</strong>\uff1a\u9002\u5408\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5</li>\n<li><strong>COO\u683c\u5f0f</strong>\uff1a\u9002\u5408\u589e\u91cf\u66f4\u65b0</li>\n<li><strong>\u5757\u7a00\u758f\u683c\u5f0f</strong>\uff1a\u7ed3\u5408\u7a20\u5bc6\u5757\u548c\u7a00\u758f\u7ed3\u6784\u7684\u4f18\u52bf</li>\n<li><strong>\u4e13\u95e8\u5e93</strong>\uff1aIntel MKL\u7a00\u758fBLAS\u3001cuSPARSE\uff08GPU\uff09</li>\n</ul>\n<h3 id=\"423\">4.2.3 \u5185\u5b58\u6548\u7387\u4f18\u5316</h3>\n<p>\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\uff0c\u5373\u4f7f\u662f\u7a00\u758fHessian\u4e5f\u53ef\u80fd\u8d85\u51fa\u5185\u5b58\u9650\u5236\u3002\u9ad8\u7ea7\u5185\u5b58\u7ba1\u7406\u6280\u672f\uff1a</p>\n<ol>\n<li><strong>\u5206\u5c42\u5b58\u50a8\u7b56\u7565</strong>\uff1a</li>\n</ol>\n<p><strong>\u4e09\u7ea7\u5b58\u50a8\u67b6\u6784</strong>\uff1a</p>\n<ul>\n<li>\n<p><strong>L1 - \u70ed\u5757</strong>\uff1a\u9891\u7e41\u8bbf\u95ee\u7684\u5757</p>\n<ul>\n<li>\u4fdd\u6301\u5728GPU\u5185\u5b58\u6216CPU L3\u7f13\u5b58</li>\n<li>\u5178\u578b\u5927\u5c0f\uff1a1-10 GB</li>\n<li>\u8bbf\u95ee\u5ef6\u8fdf\uff1a\u7eb3\u79d2\u7ea7</li>\n</ul>\n</li>\n<li>\n<p><strong>L2 - \u6e29\u5757</strong>\uff1a\u4e2d\u7b49\u8bbf\u95ee\u9891\u7387</p>\n<ul>\n<li>\u5b58\u50a8\u5728\u4e3b\u5185\u5b58\uff08RAM\uff09</li>\n<li>\u5178\u578b\u5927\u5c0f\uff1a10-100 GB</li>\n<li>\u8bbf\u95ee\u5ef6\u8fdf\uff1a\u5fae\u79d2\u7ea7</li>\n</ul>\n</li>\n<li>\n<p><strong>L3 - \u51b7\u5757</strong>\uff1a\u5f88\u5c11\u8bbf\u95ee</p>\n<ul>\n<li>\u5e8f\u5217\u5316\u5230SSD/NVMe</li>\n<li>\u5178\u578b\u5927\u5c0f\uff1aTB\u7ea7</li>\n<li>\u8bbf\u95ee\u5ef6\u8fdf\uff1a\u6beb\u79d2\u7ea7</li>\n</ul>\n</li>\n</ul>\n<p><strong>\u5757\u8fc1\u79fb\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>LRU\uff08\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff09\u7f6e\u6362</li>\n<li>\u9884\u6d4b\u6027\u9884\u53d6\u57fa\u4e8e\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>\u6279\u91cf\u8fc1\u79fb\u51cf\u5c11\u5f00\u9500</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u538b\u7f29\u8868\u793a</strong>\uff1a</li>\n</ol>\n<p><strong>\u4f4e\u79e9\u5206\u89e3</strong>\uff1a$\\mathbf{H}_{ij} \\approx \\mathbf{U}_{ij}\\mathbf{V}_{ij}^T$</p>\n<ul>\n<li>\u9009\u62e9\u79e9$r$\u4f7f\u5f97$\\sum_{k&gt;r} \\sigma_k^2 &lt; \\epsilon \\sum_k \\sigma_k^2$</li>\n<li>\u589e\u91cfSVD\u66f4\u65b0\u4fdd\u6301\u4f4e\u79e9\u7ed3\u6784</li>\n<li>\u5b58\u50a8\u9700\u6c42\uff1a\u4ece$n_i \\times n_j$\u964d\u81f3$(n_i + n_j) \\times r$</li>\n</ul>\n<p><strong>\u91cf\u5316\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li><strong>\u7ebf\u6027\u91cf\u5316</strong>\uff1a$[\\mathbf{H}]_{ij} \\approx s \\cdot \\text{round}([\\mathbf{H}]_{ij}/s)$</li>\n<li><strong>\u5bf9\u6570\u91cf\u5316</strong>\uff1a\u4fdd\u6301\u52a8\u6001\u8303\u56f4</li>\n<li><strong>\u5411\u91cf\u91cf\u5316</strong>\uff1a\u4f7f\u7528\u7801\u672c\u8868\u793a</li>\n<li><strong>\u6df7\u5408\u7cbe\u5ea6</strong>\uff1a\u91cd\u8981\u5143\u7d20\u7528\u9ad8\u7cbe\u5ea6\uff0c\u5176\u4ed6\u7528\u4f4e\u7cbe\u5ea6</li>\n</ul>\n<p><strong>\u54c8\u5e0c\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u7279\u5f81\u54c8\u5e0c\u51cf\u5c11\u5b58\u50a8</li>\n<li>Count-Min Sketch\u8fd1\u4f3c</li>\n<li>\u5e03\u9686\u8fc7\u6ee4\u5668\u5feb\u901f\u5224\u65ad\u96f6\u5143\u7d20</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5ef6\u8fdf\u8ba1\u7b97</strong>\uff1a</li>\n</ol>\n<p><strong>\u9690\u5f0f\u8868\u793a</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u663e\u5f0f\u5b58\u50a8$\\mathbf{H}^{-1}$\uff0c\u800c\u662f\u5b58\u50a8\u56e0\u5b50</li>\n<li>\u53ea\u5728\u9700\u8981\u65f6\u8ba1\u7b97$\\mathbf{H}^{-1}\\mathbf{v}$</li>\n<li>\u4f7f\u7528\u5171\u8f6d\u68af\u5ea6\u6cd5\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf</li>\n</ul>\n<p><strong>Hessian-\u5411\u91cf\u79ef\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li>Pearlmutter\u6280\u5de7\uff1a$\\mathbf{H}\\mathbf{v} = \\nabla_{\\mathbf{x}}(\\nabla f(\\mathbf{x})^T\\mathbf{v})$</li>\n<li>\u81ea\u52a8\u5fae\u5206\u7684\u9ad8\u6548\u5b9e\u73b0</li>\n<li>\u65e0\u9700\u663e\u5f0f\u5f62\u6210Hessian</li>\n</ul>\n<p><strong>\u7f13\u5b58\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u7f13\u5b58\u9891\u7e41\u4f7f\u7528\u7684Hessian-\u5411\u91cf\u79ef</li>\n<li>\u4f7f\u7528\u8fd1\u4f3c\u503c\u52a0\u901f\u8ba1\u7b97</li>\n<li>\u6e10\u8fdb\u7cbe\u5316\uff1a\u5148\u7528\u7c97\u7cd9\u8fd1\u4f3c\uff0c\u9700\u8981\u65f6\u7ec6\u5316</li>\n</ul>\n<h3 id=\"424\">4.2.4 \u5e76\u884c\u5316\u8003\u8651</h3>\n<p>\u5206\u5757\u7ed3\u6784\u5929\u7136\u9002\u5408\u5e76\u884c\u8ba1\u7b97\uff1a</p>\n<ol>\n<li><strong>\u6570\u636e\u5e76\u884c</strong>\uff1a\n   - \u4e0d\u540c\u7684\u6570\u636e\u6279\u6b21\u66f4\u65b0\u4e0d\u540c\u7684\u5757\n   - \u68af\u5ea6\u7d2f\u79ef\u7684\u5e76\u884c\u5316\n   - \u5f02\u6b65SGD\u4e0e\u5757\u66f4\u65b0\u7684\u7ed3\u5408</li>\n</ol>\n<p><strong>\u8d1f\u8f7d\u5747\u8861</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u4efb\u52a1\u5206\u914d\u907f\u514d\u7a7a\u95f2</li>\n<li>\u5de5\u4f5c\u7a83\u53d6(work stealing)\u7b56\u7565</li>\n<li>\u57fa\u4e8e\u5757\u5927\u5c0f\u7684\u9759\u6001\u5206\u533a</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u6a21\u578b\u5e76\u884c</strong>\uff1a\n   - \u4e0d\u540c\u7684\u5904\u7406\u5668\u8d1f\u8d23\u4e0d\u540c\u7684\u5757\n   - \u5757\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u51b3\u5b9a\u901a\u4fe1\u6a21\u5f0f\n   - \u91cd\u53e0\u8ba1\u7b97\u4e0e\u901a\u4fe1\uff08computation-communication overlap\uff09</li>\n</ol>\n<p><strong>\u901a\u4fe1\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>\u6d88\u606f\u805a\u5408\u51cf\u5c11\u901a\u4fe1\u6b21\u6570</li>\n<li>\u4f7f\u7528\u5355\u8fb9\u901a\u4fe1\uff08one-sided communication\uff09</li>\n<li>\u62d3\u6251\u611f\u77e5\u7684\u8fdb\u7a0b\u6620\u5c04</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong>\uff1a\n   - \u66f4\u65b0\u53ef\u4ee5\u6d41\u6c34\u7ebf\u5316\u5904\u7406\n   - \u4e0d\u540c\u9636\u6bb5\u5904\u7406\u4e0d\u540c\u7684\u5757\n   - \u7f13\u51b2\u533a\u7ba1\u7406\u907f\u514d\u963b\u585e</li>\n</ol>\n<p><strong>\u6d41\u6c34\u7ebf\u6df1\u5ea6\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>\u592a\u6d45\uff1a\u5e76\u884c\u5ea6\u4e0d\u8db3</li>\n<li>\u592a\u6df1\uff1a\u7f13\u51b2\u5f00\u9500\u5927</li>\n<li>\u81ea\u9002\u5e94\u8c03\u6574\u57fa\u4e8e\u8fd0\u884c\u65f6\u6027\u80fd</li>\n</ul>\n<p><strong>\u540c\u6b65\u5f00\u9500\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u901a\u4fe1\u590d\u6742\u5ea6\u6a21\u578b</strong>\uff1a\n\u8bbe$p$\u4e3a\u5904\u7406\u5668\u6570\uff0c$B$\u4e3a\u5757\u6570\uff0c$n_b$\u4e3a\u5e73\u5747\u5757\u5927\u5c0f\uff1a</p>\n<ul>\n<li><strong>\u5168\u5c40\u540c\u6b65</strong>\uff1a</li>\n<li>\u901a\u4fe1\u8f6e\u6570\uff1a$\\mathcal{O}(\\log p)$</li>\n<li>\u6bcf\u8f6e\u6570\u636e\u91cf\uff1a$\\mathcal{O}(B^2 n_b^2 / p)$</li>\n<li>\n<p>\u603b\u5ef6\u8fdf\uff1a$\\mathcal{O}(\\alpha \\log p + \\beta B^2 n_b^2 / p)$</p>\n</li>\n<li>\n<p><strong>\u5c40\u90e8\u540c\u6b65</strong>\uff1a</p>\n</li>\n<li>\u53ea\u5728\u76f8\u90bb\u5757\u4e4b\u95f4\u901a\u4fe1</li>\n<li>\u901a\u4fe1\u8f6e\u6570\uff1a$\\mathcal{O}(B/p)$</li>\n<li>\u6bcf\u8f6e\u6570\u636e\u91cf\uff1a$\\mathcal{O}(n_b^2)$</li>\n<li>\n<p>\u9002\u5408\u7a00\u758f\u8026\u5408\u7684\u95ee\u9898</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0</strong>\uff1a</p>\n</li>\n<li>\u65e0\u9700\u7b49\u5f85\uff0c\u4f46\u9700\u8981\u5904\u7406\u4e00\u81f4\u6027\u95ee\u9898</li>\n<li>\u4f7f\u7528\u7248\u672c\u63a7\u5236\u6216\u65f6\u95f4\u6233</li>\n<li>\u6536\u655b\u6027\u5206\u6790\u66f4\u590d\u6742</li>\n</ul>\n<p><strong>\u6df7\u5408\u5e76\u884c\u7b56\u7565</strong>\uff1a\n\u7ed3\u5408\u4e0d\u540c\u7ea7\u522b\u7684\u5e76\u884c\u6027\uff1a</p>\n<ul>\n<li>\u8282\u70b9\u95f4\uff1a\u6a21\u578b\u5e76\u884c\uff08MPI\uff09</li>\n<li>\u8282\u70b9\u5185\uff1a\u6570\u636e\u5e76\u884c\uff08OpenMP\uff09</li>\n<li>\u52a0\u901f\u5668\uff1a\u77e9\u9635\u8fd0\u7b97\uff08CUDA/ROCm\uff09</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\u5982\u4f55\u8bbe\u8ba1\u901a\u4fe1\u9ad8\u6548\u7684\u5206\u5757\u66f4\u65b0\u534f\u8bae\uff0c\u7279\u522b\u662f\u5728\u5e26\u5bbd\u53d7\u9650\u7684\u73af\u5883\u4e2d\uff1f</li>\n<li>\u80fd\u5426\u5229\u7528\u673a\u5668\u5b66\u4e60\u9884\u6d4b\u5757\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u4f18\u5316\u6570\u636e\u5e03\u5c40\uff1f</li>\n<li>\u5982\u4f55\u5728\u4fdd\u6301\u6570\u503c\u7a33\u5b9a\u6027\u7684\u540c\u65f6\u6700\u5927\u5316\u5e76\u884c\u6548\u7387\uff1f</li>\n</ol>\n<h2 id=\"43-sliding-window\">4.3 Sliding Window\u6280\u672f</h2>\n<h3 id=\"431-hessian\">4.3.1 \u6709\u9650\u5185\u5b58Hessian\u4f30\u8ba1</h3>\n<p>\u5728\u6d41\u5f0f\u6570\u636e\u573a\u666f\u4e2d\uff0c\u7ef4\u62a4\u6240\u6709\u5386\u53f2\u4fe1\u606f\u65e2\u4e0d\u53ef\u884c\u4e5f\u4e0d\u5fc5\u8981\u3002Sliding window\u6280\u672f\u901a\u8fc7\u53ea\u4fdd\u7559\u6700\u8fd1\u7684\u4fe1\u606f\u6765\u5b9e\u73b0\u6709\u9650\u5185\u5b58\u7684Hessian\u4f30\u8ba1\uff1a\n$$\\mathbf{H}_t = \\sum_{i=t-W+1}^{t} \\mathbf{g}_i\\mathbf{g}_i^T + \\lambda\\mathbf{I}$$\n\u5176\u4e2d$W$\u662f\u7a97\u53e3\u5927\u5c0f\u3002\u5173\u952e\u6311\u6218\u662f\u5982\u4f55\u9ad8\u6548\u5730\u6dfb\u52a0\u65b0\u4fe1\u606f\u5e76\u79fb\u9664\u65e7\u4fe1\u606f\u3002</p>\n<p><strong>\u589e\u91cf\u66f4\u65b0\u516c\u5f0f</strong>\uff1a\n$$\\mathbf{H}_{t+1} = \\mathbf{H}_t + \\mathbf{g}_{t+1}\\mathbf{g}_{t+1}^T - \\mathbf{g}_{t-W+1}\\mathbf{g}_{t-W+1}^T$$\n\u8fd9\u662f\u4e00\u4e2a\u79e9-2\u66f4\u65b0\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e24\u6b21Woodbury\u66f4\u65b0\u5b9e\u73b0\u3002\u4f46\u76f4\u63a5\u5e94\u7528\u53ef\u80fd\u5bfc\u81f4\u6570\u503c\u4e0d\u7a33\u5b9a\uff0c\u7279\u522b\u662f\u5f53\u88ab\u79fb\u9664\u7684\u68af\u5ea6\u63a5\u8fd1\u96f6\u65f6\u3002</p>\n<p><strong>\u7a33\u5b9a\u7684\u5b9e\u73b0\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\u7ef4\u62a4Cholesky\u5206\u89e3$\\mathbf{L}_t\\mathbf{L}_t^T = \\mathbf{H}_t$</li>\n<li>\u4f7f\u7528Cholesky\u79e9-1\u66f4\u65b0\u7b97\u6cd5\uff08cholupdate\uff09</li>\n<li>\u5bf9\u4e8e\u79e9-1\u964d\u7ea7\uff08\u79fb\u9664\u65e7\u68af\u5ea6\uff09\uff0c\u4f7f\u7528\u6570\u503c\u7a33\u5b9a\u7684\u964d\u7ea7\u7b97\u6cd5</li>\n</ol>\n<h3 id=\"432\">4.3.2 \u65f6\u5e8f\u76f8\u5173\u6027\u5efa\u6a21</h3>\n<p>\u7b80\u5355\u7684\u6ed1\u52a8\u7a97\u53e3\u5047\u8bbe\u6240\u6709\u7a97\u53e3\u5185\u7684\u6837\u672c\u540c\u7b49\u91cd\u8981\uff0c\u8fd9\u5ffd\u7565\u4e86\u65f6\u5e8f\u76f8\u5173\u6027\u3002\u66f4\u7cbe\u7ec6\u7684\u5efa\u6a21\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6307\u6570\u52a0\u6743\u79fb\u52a8\u5e73\u5747\uff08EWMA\uff09</strong>\uff1a\n$$\\mathbf{H}_t = (1-\\alpha)\\mathbf{H}_{t-1} + \\alpha\\mathbf{g}_t\\mathbf{g}_t^T$$\n\u5176\u4e2d$\\alpha \\in (0,1)$\u662f\u9057\u5fd8\u56e0\u5b50\u3002\u7b49\u6548\u4e8e\u65e0\u9650\u7a97\u53e3\u4f46\u6307\u6570\u8870\u51cf\u7684\u6743\u91cd\u3002</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u9057\u5fd8\u56e0\u5b50</strong>\uff1a\n   \u57fa\u4e8e\u6570\u636e\u7684\u975e\u5e73\u7a33\u6027\u52a8\u6001\u8c03\u6574$\\alpha$\uff1a\n$$\\alpha_t = \\min\\left(1, \\frac{|\\mathbf{g}_t - \\bar{\\mathbf{g}}_{t-1}|^2}{\\sigma_t^2}\\right)$$\n\u5176\u4e2d$\\bar{\\mathbf{g}}_{t-1}$\u548c$\\sigma_t^2$\u662f\u5386\u53f2\u68af\u5ea6\u7684\u5747\u503c\u548c\u65b9\u5dee\u4f30\u8ba1\u3002</p>\n</li>\n<li>\n<p><strong>\u591a\u5c3a\u5ea6\u7a97\u53e3</strong>\uff1a\n   \u7ef4\u62a4\u591a\u4e2a\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\u7684Hessian\u4f30\u8ba1\uff1a\n$$\\mathbf{H}_t = \\sum_{k=1}^{K} w_k \\mathbf{H}_t^{(k)}$$\n\u5176\u4e2d$\\mathbf{H}_t^{(k)}$\u5bf9\u5e94\u7a97\u53e3\u5927\u5c0f$W_k$\u7684\u4f30\u8ba1\uff0c\u6743\u91cd$w_k$\u53ef\u4ee5\u81ea\u9002\u5e94\u5b66\u4e60\u3002</p>\n</li>\n</ol>\n<h3 id=\"433\">4.3.3 \u9057\u5fd8\u56e0\u5b50\u8bbe\u8ba1</h3>\n<p>\u9057\u5fd8\u56e0\u5b50\u7684\u9009\u62e9\u5bf9\u7b97\u6cd5\u6027\u80fd\u81f3\u5173\u91cd\u8981\uff1a</p>\n<ol>\n<li>\n<p><strong>\u56fa\u5b9a\u9057\u5fd8\u56e0\u5b50</strong>\uff1a\n   - \u4f18\u70b9\uff1a\u7b80\u5355\uff0c\u8ba1\u7b97\u9ad8\u6548\n   - \u7f3a\u70b9\uff1a\u4e0d\u9002\u5e94\u6570\u636e\u5206\u5e03\u7684\u53d8\u5316\n   - \u5178\u578b\u503c\uff1a$\\alpha = 0.99$\u5bf9\u5e94\u6709\u6548\u7a97\u53e3\u5927\u5c0f\u7ea6100</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u9057\u5fd8\u56e0\u5b50</strong>\uff1a\n   \u57fa\u4e8e\u4ee5\u4e0b\u6307\u6807\u52a8\u6001\u8c03\u6574\uff1a</p>\n</li>\n</ol>\n<ul>\n<li><strong>\u9884\u6d4b\u8bef\u5dee</strong>\uff1a$\\alpha_t \\propto \\exp(-|\\mathbf{g}_t - \\mathbf{H}_{t-1}^{-1}\\mathbf{g}_{t-1}|^2)$</li>\n<li><strong>\u66f2\u7387\u53d8\u5316</strong>\uff1a\u76d1\u6d4b\u8fde\u7eedHessian\u4f30\u8ba1\u7684\u7279\u5f81\u503c\u53d8\u5316</li>\n<li><strong>\u6536\u655b\u901f\u5ea6</strong>\uff1a\u6839\u636e\u4f18\u5316\u8fdb\u5c55\u8c03\u6574</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u8d1d\u53f6\u65af\u9057\u5fd8</strong>\uff1a\n   \u5c06\u9057\u5fd8\u56e0\u5b50\u89c6\u4e3a\u968f\u673a\u53d8\u91cf\uff0c\u4f7f\u7528\u53d8\u5206\u63a8\u65ad\u6216\u7c92\u5b50\u6ee4\u6ce2\u4f30\u8ba1\u540e\u9a8c\u5206\u5e03\u3002</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\u5728\u9002\u5f53\u7684\u9057\u5fd8\u56e0\u5b50\u4e0b\uff0c\u53ef\u4ee5\u8bc1\u660e\uff1a\n$$\\mathbb{E}[|\\mathbf{H}_t - \\mathbf{H}_t^*|_F] \\leq \\mathcal{O}(\\sqrt{\\frac{\\log t}{t\\alpha}})$$\n\u5176\u4e2d$\\mathbf{H}_t^*$\u662f\u771f\u5b9e\u7684\u65f6\u53d8Hessian\u3002</p>\n<p><strong>\u66f4\u5f3a\u7684\u7406\u8bba\u7ed3\u679c</strong>\uff1a\n\u5728Lipschitz\u8fde\u7eed\u548c\u5f3a\u51f8\u5047\u8bbe\u4e0b\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8ddf\u8e2a\u8bef\u5dee\u754c</strong>\uff1a$|\\mathbf{H}_t - \\mathbf{H}_t^*| \\leq C_1 \\alpha + C_2/\\alpha$\n   - \u7b2c\u4e00\u9879\uff1a\u9057\u5fd8\u592a\u6162\u5bfc\u81f4\u7684\u504f\u5dee\n   - \u7b2c\u4e8c\u9879\uff1a\u9057\u5fd8\u592a\u5feb\u5bfc\u81f4\u7684\u65b9\u5dee\n   - \u6700\u4f18\u9009\u62e9\uff1a$\\alpha^* = \\sqrt{C_2/C_1}$</p>\n</li>\n<li>\n<p><strong>regret\u754c</strong>\uff1a\u4f7f\u7528\u6ed1\u52a8\u7a97\u53e3Hessian\u7684\u5728\u7ebfNewton\u65b9\u6cd5\uff1a\n$$R_T \\leq \\mathcal{O}(d\\log T) + \\mathcal{O}(\\sqrt{T} \\cdot \\text{path-length})$$\n\u5176\u4e2dpath-length\u8861\u91cf\u73af\u5883\u7684\u975e\u5e73\u7a33\u6027\u3002</p>\n</li>\n</ol>\n<h3 id=\"434\">4.3.4 \u7a97\u53e3\u5927\u5c0f\u81ea\u9002\u5e94</h3>\n<p>\u56fa\u5b9a\u7a97\u53e3\u5927\u5c0f\u96be\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u95ee\u9898\u7279\u6027\u3002\u81ea\u9002\u5e94\u7b56\u7565\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u4e8e\u504f\u5dee-\u65b9\u5dee\u6743\u8861</strong>\uff1a\n   - \u5927\u7a97\u53e3\uff1a\u4f4e\u65b9\u5dee\uff0c\u9ad8\u504f\u5dee\uff08\u5bf9\u975e\u5e73\u7a33\u6570\u636e\uff09\n   - \u5c0f\u7a97\u53e3\uff1a\u9ad8\u65b9\u5dee\uff0c\u4f4e\u504f\u5dee\n   - \u901a\u8fc7\u4ea4\u53c9\u9a8c\u8bc1\u6216\u7559\u4e00\u6cd5\u4f30\u8ba1\u6700\u4f18\u7a97\u53e3\u5927\u5c0f</p>\n</li>\n<li>\n<p><strong>\u53d8\u5316\u70b9\u68c0\u6d4b</strong>\uff1a\n   - \u76d1\u6d4b\u68af\u5ea6\u5206\u5e03\u7684\u7a81\u53d8\n   - \u4f7f\u7528CUSUM\u6216\u8d1d\u53f6\u65af\u5728\u7ebf\u53d8\u5316\u70b9\u68c0\u6d4b\n   - \u68c0\u6d4b\u5230\u53d8\u5316\u65f6\u91cd\u7f6e\u7a97\u53e3</p>\n</li>\n<li>\n<p><strong>\u591a\u5206\u8fa8\u7387\u65b9\u6cd5</strong>\uff1a\n   - \u7ef4\u62a4\u4e0d\u540c\u5927\u5c0f\u7684\u7a97\u53e3\u5c42\u7ea7\n   - \u6839\u636e\u68af\u5ea6\u7684\u9891\u8c31\u7279\u6027\u9009\u62e9\u5408\u9002\u7684\u5206\u8fa8\u7387\n   - \u7c7b\u4f3c\u5c0f\u6ce2\u5206\u6790\u7684\u601d\u60f3</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u73b0\u7ec6\u8282</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u5faa\u73af\u7f13\u51b2\u533a\u5b58\u50a8\u68af\u5ea6\u5386\u53f2</li>\n<li>\u9884\u5206\u914d\u5185\u5b58\u907f\u514d\u52a8\u6001\u5206\u914d\u5f00\u9500</li>\n<li>\u4f7f\u7528SIMD\u6307\u4ee4\u52a0\u901f\u5411\u91cf\u8fd0\u7b97</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\u5982\u4f55\u5c06\u5f3a\u5316\u5b66\u4e60\u7684\u601d\u60f3\u5e94\u7528\u4e8e\u7a97\u53e3\u5927\u5c0f\u7684\u5728\u7ebf\u4f18\u5316\uff1f</li>\n<li>\u80fd\u5426\u8bbe\u8ba1\u51fa\u5177\u6709\u7406\u8bba\u4fdd\u8bc1\u7684\u81ea\u9002\u5e94\u7b97\u6cd5\uff1f</li>\n<li>\u5982\u4f55\u5904\u7406\u5f02\u6784\u6570\u636e\u6d41\uff08\u4e0d\u540c\u6765\u6e90\u3001\u4e0d\u540c\u5206\u5e03\uff09\uff1f</li>\n<li>\u662f\u5426\u53ef\u4ee5\u4f7f\u7528\u795e\u7ecf\u7f51\u7edc\u76f4\u63a5\u5b66\u4e60Hessian\u7684\u6f14\u5316\u6a21\u5f0f\uff1f</li>\n<li>\u5982\u4f55\u5728\u9690\u79c1\u4fdd\u62a4\u7ea6\u675f\u4e0b\u8fdb\u884c\u6ed1\u52a8\u7a97\u53e3\u66f4\u65b0\uff1f</li>\n</ol>\n<h2 id=\"44\">4.4 \u4e0e\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u6df1\u5ea6\u8054\u7cfb</h2>\n<h3 id=\"441-newton\">4.4.1 \u5728\u7ebfNewton\u6b65\u9aa4</h3>\n<p>\u5728\u7ebf\u51f8\u4f18\u5316\u6846\u67b6\u4e3a\u589e\u91cfHessian\u8ba1\u7b97\u63d0\u4f9b\u4e86\u7406\u8bba\u57fa\u7840\u3002\u8003\u8651\u5728\u7ebf\u4f18\u5316\u95ee\u9898\uff0c\u5728\u65f6\u523b$t$\uff0c\u7b97\u6cd5\u89c2\u5bdf\u5230\u635f\u5931\u51fd\u6570$f_t(\\mathbf{x})$\u5e76\u66f4\u65b0\u53c2\u6570\u3002\u5728\u7ebfNewton\u65b9\u6cd5\u7684\u66f4\u65b0\u89c4\u5219\u4e3a\uff1a\n$$\\mathbf{x}_{t+1} = \\mathbf{x}_t - \\eta_t \\mathbf{H}_t^{-1}\\nabla f_t(\\mathbf{x}_t)$$\n\u5176\u4e2d$\\mathbf{H}_t$\u662f\u5230\u65f6\u523b$t$\u4e3a\u6b62\u7684Hessian\u4f30\u8ba1\u3002\u5173\u952e\u6d1e\u5bdf\uff1a</p>\n<ul>\n<li>\u4e0d\u9700\u8981\u771f\u5b9e\u7684Hessian\uff0c\u53ea\u9700\u8981\u4e00\u4e2a\u6b63\u5b9a\u7684\u4e8c\u9636\u4fe1\u606f\u4f30\u8ba1</li>\n<li>\u589e\u91cf\u66f4\u65b0\u786e\u4fdd\u8ba1\u7b97\u53ef\u884c\u6027</li>\n<li>\u7406\u8bba\u5206\u6790\u805a\u7126\u4e8eregret\u754c</li>\n</ul>\n<p><strong>\u5728\u7ebfNewton\u7684\u53d8\u4f53</strong>\uff1a</p>\n<ol>\n<li><strong>Follow-the-Regularized-Leader (FTRL)</strong>\uff1a\n$$\\mathbf{x}_{t+1} = \\arg\\min_{\\mathbf{x}} \\sum_{i=1}^{t} f_i(\\mathbf{x}) + \\frac{1}{2\\eta}\\mathbf{x}^T\\mathbf{H}_t\\mathbf{x}$$\n<strong>FTRL\u7684\u8ba1\u7b97\u6548\u7387</strong>\uff1a</li>\n</ol>\n<ul>\n<li>\u663e\u5f0f\u6c42\u89e3\uff1a$\\mathbf{x}_{t+1} = -\\eta \\mathbf{H}_t^{-1}\\sum_{i=1}^t \\nabla f_i(\\mathbf{x}_i)$</li>\n<li>\u589e\u91cf\u66f4\u65b0\uff1a\u53ea\u9700\u7ef4\u62a4\u68af\u5ea6\u548c$\\sum_{i=1}^t \\nabla f_i(\\mathbf{x}_i)$</li>\n<li>\u4e0e\u4e8c\u9636\u65b9\u6cd5\u7684\u8054\u7cfb\uff1aFTRL\u81ea\u7136\u5730\u4ea7\u751fNewton\u7c7b\u66f4\u65b0</li>\n</ul>\n<ol start=\"2\">\n<li><strong>Online Newton Step (ONS)</strong>\uff1a\n   \u4f7f\u7528\u6295\u5f71\u786e\u4fdd\u53ef\u884c\u6027\uff1a\n$$\\mathbf{x}_{t+1} = \\Pi_{\\mathcal{X}}(\\mathbf{x}_t - \\eta_t \\mathbf{H}_t^{-1}\\nabla f_t(\\mathbf{x}_t))$$\n<strong>\u6295\u5f71\u7b97\u5b50\u7684\u5feb\u901f\u8ba1\u7b97</strong>\uff1a</li>\n</ol>\n<ul>\n<li>\u7403\u7ea6\u675f\uff1a$\\Pi_{|\\mathbf{x}| \\leq R}(\\mathbf{y}) = \\min(1, R/|\\mathbf{y}|) \\cdot \\mathbf{y}$</li>\n<li>\u7bb1\u7ea6\u675f\uff1a$[\\Pi_{[a,b]^n}(\\mathbf{y})]_i = \\max(a, \\min(b, y_i))$</li>\n<li>\u7ebf\u6027\u7ea6\u675f\uff1a\u4f7f\u7528KKT\u6761\u4ef6\u6216\u5bf9\u5076\u65b9\u6cd5</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u81ea\u9002\u5e94\u5728\u7ebfNewton (AdaONS)</strong>\uff1a\n   \u7ed3\u5408\u81ea\u9002\u5e94\u6b65\u957f\u548cHessian\u66f4\u65b0\uff1a\n$$\\eta_t = \\frac{\\eta_0}{\\sqrt{t}} \\cdot \\frac{1}{\\sqrt{\\lambda_{max}(\\mathbf{H}_t)}}$$\n\u8fd9\u786e\u4fdd\u4e86\u6570\u503c\u7a33\u5b9a\u6027\u548c\u6700\u4f18\u6536\u655b\u7387\u3002</li>\n</ol>\n<h3 id=\"442-regret\">4.4.2 Regret\u754c\u5206\u6790</h3>\n<p>\u5728\u7ebf\u5b66\u4e60\u7684\u6838\u5fc3\u6027\u80fd\u6307\u6807\u662fregret\uff1a\n$$R_T = \\sum_{t=1}^{T} f_t(\\mathbf{x}_t) - \\min_{\\mathbf{x} \\in \\mathcal{X}} \\sum_{t=1}^{T} f_t(\\mathbf{x})$$\n<strong>\u5173\u952e\u7406\u8bba\u7ed3\u679c</strong>\uff1a</p>\n<ol>\n<li><strong>\u4e00\u9636\u65b9\u6cd5</strong>\uff08\u5982\u5728\u7ebf\u68af\u5ea6\u4e0b\u964d\uff09\uff1a$R_T = \\mathcal{O}(\\sqrt{T})$</li>\n<li><strong>\u4e8c\u9636\u65b9\u6cd5</strong>\uff08\u4f7f\u7528Hessian\u4fe1\u606f\uff09\uff1a\u5728exp-concave\u51fd\u6570\u7c7b\u4e0a\u53ef\u8fbe\u5230$R_T = \\mathcal{O}(\\log T)$</li>\n</ol>\n<p><strong>\u589e\u91cfHessian\u7684\u5f71\u54cd</strong>\uff1a</p>\n<ul>\n<li>\u8fd1\u4f3c\u8bef\u5dee\uff1a\u5982\u679c$|\\mathbf{H}_t - \\nabla^2 f_t(\\mathbf{x}_t)|_2 \\leq \\epsilon$\uff0c\u5219\u989d\u5916regret\u4e3a$\\mathcal{O}(\\epsilon T)$</li>\n<li>\u5ef6\u8fdf\u66f4\u65b0\uff1a\u4f7f\u7528\u8fc7\u65f6\u7684Hessian\u4fe1\u606f\u4f1a\u589e\u52a0$\\mathcal{O}(\\tau\\sqrt{T})$\u7684regret\uff0c\u5176\u4e2d$\\tau$\u662f\u5ef6\u8fdf</li>\n</ul>\n<p><strong>\u66f4\u7cbe\u7ec6\u7684regret\u5206\u6790</strong>\uff1a\n\u8003\u8651\u4e0d\u540c\u7684\u51fd\u6570\u7c7b\uff1a</p>\n<ol>\n<li><strong>\u5f3a\u51f8\u51fd\u6570</strong>\uff1a$R_T = \\mathcal{O}(d\\log T)$</li>\n<li><strong>exp-concave\u51fd\u6570</strong>\uff1a$R_T = \\mathcal{O}(d\\log T)$</li>\n<li><strong>\u4e00\u822c\u51f8\u51fd\u6570</strong>\uff1a$R_T = \\mathcal{O}(\\sqrt{T})$\uff08\u9000\u5316\u5230\u4e00\u9636\u65b9\u6cd5\uff09</li>\n</ol>\n<p><strong>\u9ad8\u9636\u4fe1\u606f\u7684\u4ef7\u503c</strong>\uff1a\n\u4e8c\u9636\u4fe1\u606f\u53ef\u4ee5\u5c06$\\sqrt{T}$\u6539\u5584\u5230$\\log T$\uff0c\u8fd9\u5728\u957f\u671f\u8fd0\u884c\u4e2d\u6781\u4e3a\u663e\u8457\u3002</p>\n<p><strong>\u81ea\u9002\u5e94regret\u754c</strong>\uff1a\n\u8003\u8651\u975e\u5e73\u7a33\u73af\u5883\uff0c\u5b9a\u4e49path length\uff1a\n$$P_T = \\sum_{t=2}^{T} |\\mathbf{x}_t^* - \\mathbf{x}_{t-1}^*|$$\n\u81ea\u9002\u5e94\u7b97\u6cd5\u53ef\u4ee5\u8fbe\u5230$R_T = \\mathcal{O}(\\sqrt{T(1+P_T)})$\uff0c\u66f4\u597d\u5730\u9002\u5e94\u53d8\u5316\u7684\u73af\u5883\u3002</p>\n<p><strong>\u52a8\u6001regret\u548c\u9002\u5e94\u6027</strong>\uff1a\n\u5b9a\u4e49\u533a\u95f4regret\uff1a\n$$R_{[s,t]} = \\sum_{i=s}^{t} f_i(\\mathbf{x}_i) - \\min_{\\mathbf{x}} \\sum_{i=s}^{t} f_i(\\mathbf{x})$$\n\u597d\u7684\u7b97\u6cd5\u5e94\u8be5\u5728\u4efb\u610f\u533a\u95f4$[s,t]$\u4e0a\u90fd\u6709\u4f4e\u7684regret\uff0c\u8fd9\u79f0\u4e3astrongly adaptive regret\u3002</p>\n<p><strong>\u4e8c\u9636\u65b9\u6cd5\u7684\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u53c2\u6570\u91cf\u7eb2\u4e0d\u654f\u611f\uff08scale-free\uff09</li>\n<li>\u81ea\u52a8\u9002\u5e94\u95ee\u9898\u7684\u5c40\u90e8\u51e0\u4f55</li>\n<li>\u5728\u75c5\u6001\u95ee\u9898\u4e0a\u6bd4\u4e00\u9636\u65b9\u6cd5\u7a33\u5b9a</li>\n</ul>\n<h3 id=\"443\">4.4.3 \u81ea\u9002\u5e94\u6b63\u5219\u5316</h3>\n<p>\u6b63\u5219\u5316\u53c2\u6570\u7684\u9009\u62e9\u5bf9\u5728\u7ebf\u7b97\u6cd5\u6027\u80fd\u81f3\u5173\u91cd\u8981\u3002\u81ea\u9002\u5e94\u7b56\u7565\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u4e8e\u66f2\u7387\u7684\u6b63\u5219\u5316</strong>\uff1a\n$$\\lambda_t = \\lambda_0 \\sqrt{\\frac{\\text{tr}(\\mathbf{H}_t)}{n}}$$\n\u6839\u636eHessian\u7684\u8ff9\uff08\u603b\u66f2\u7387\uff09\u8c03\u6574\u6b63\u5219\u5316\u5f3a\u5ea6\u3002</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u7f6e\u4fe1\u5ea6\u7684\u6b63\u5219\u5316</strong>\uff1a\n   \u7c7b\u4f3c\u4e8e\u4e0a\u7f6e\u4fe1\u754c\uff08UCB\uff09\u7684\u601d\u60f3\uff1a\n$$\\lambda_t = \\lambda_0 \\sqrt{\\frac{\\log(t/\\delta)}{t}}$$\n\u5176\u4e2d$\\delta$\u662f\u7f6e\u4fe1\u6c34\u5e73\u3002</p>\n</li>\n<li>\n<p><strong>\u5143\u5b66\u4e60\u6b63\u5219\u5316</strong>\uff1a\n   \u4f7f\u7528\u5386\u53f2\u4efb\u52a1\u5b66\u4e60\u6b63\u5219\u5316\u7b56\u7565\uff1a\n$$\\lambda_t = g_\\theta(\\mathbf{H}_t, \\nabla f_t, t)$$\n\u5176\u4e2d$g_\\theta$\u662f\u5b66\u4e60\u5f97\u5230\u7684\u51fd\u6570\u3002</p>\n</li>\n</ol>\n<p><strong>\u5143\u5b66\u4e60\u6846\u67b6</strong>\uff1a</p>\n<ul>\n<li><strong>\u8f93\u5165\u7279\u5f81</strong>\uff1a$\\phi_t = [\\text{tr}(\\mathbf{H}_t), \\lambda_{max}(\\mathbf{H}_t), |\\nabla f_t|, t]$</li>\n<li><strong>\u7f51\u7edc\u7ed3\u6784</strong>\uff1a\u8f7b\u91cf\u7ea7MLP\u6216LSTM</li>\n<li><strong>\u8bad\u7ec3\u76ee\u6807</strong>\uff1a\u6700\u5c0f\u5316\u5386\u53f2\u4efb\u52a1\u4e0a\u7684\u9a8c\u8bc1regret</li>\n<li><strong>\u5728\u7ebf\u66f4\u65b0</strong>\uff1a\u4f7f\u7528\u68af\u5ea6\u4e0b\u964d\u66f4\u65b0$\\theta$</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u6ce2\u52a8\u6027\u611f\u77e5\u6b63\u5219\u5316</strong>\uff1a\n   \u57fa\u4e8e\u68af\u5ea6\u65b9\u5dee\u8c03\u6574\uff1a\n$$\\lambda_t = \\lambda_0 \\cdot \\frac{\\text{Var}[\\mathbf{g}_{t-w:t}]}{\\mathbb{E}[|\\mathbf{g}_{t-w:t}|^2]}$$\n\u9ad8\u65b9\u5dee\u8868\u660e\u9700\u8981\u66f4\u5f3a\u7684\u6b63\u5219\u5316\u3002</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\u9002\u5f53\u7684\u81ea\u9002\u5e94\u6b63\u5219\u5316\u53ef\u4ee5\u540c\u65f6\u8fbe\u5230\uff1a</p>\n<ul>\n<li>\u5feb\u901f\u6536\u655b\uff1a\u5728\u5f3a\u51f8\u60c5\u51b5\u4e0b\u6307\u6570\u6536\u655b</li>\n<li>\u9c81\u68d2\u6027\uff1a\u5bf9\u5f02\u5e38\u503c\u548c\u566a\u58f0\u4e0d\u654f\u611f</li>\n<li>\u81ea\u9002\u5e94\u6027\uff1a\u81ea\u52a8\u9002\u5e94\u95ee\u9898\u7684\u96be\u5ea6</li>\n</ul>\n<h3 id=\"444-adagradadam\">4.4.4 \u4e0eAdaGrad/Adam\u7684\u8054\u7cfb</h3>\n<p>\u6d41\u884c\u7684\u81ea\u9002\u5e94\u4f18\u5316\u7b97\u6cd5\u53ef\u4ee5\u89c6\u4e3a\u589e\u91cf\u4e8c\u9636\u65b9\u6cd5\u7684\u7279\u6b8a\u60c5\u51b5\uff1a</p>\n<ol>\n<li>\n<p><strong>AdaGrad</strong>\uff1a\n$$\\mathbf{v}_t = \\mathbf{v}_{t-1} + \\mathbf{g}_t \\odot \\mathbf{g}_t$$\n   $$\\mathbf{x}_{t+1} = \\mathbf{x}_t - \\eta \\frac{\\mathbf{g}_t}{\\sqrt{\\mathbf{v}_t + \\epsilon}}$$\n\u8fd9\u7b49\u4ef7\u4e8e\u4f7f\u7528\u5bf9\u89d2Hessian\u8fd1\u4f3c\uff1a$\\mathbf{H}_t = \\text{diag}(\\mathbf{v}_t)$</p>\n</li>\n<li>\n<p><strong>Adam</strong>\uff1a\n   \u7ed3\u5408\u4e86\u52a8\u91cf\u548c\u81ea\u9002\u5e94\u5b66\u4e60\u7387\uff1a\n$$\\mathbf{m}_t = \\beta_1 \\mathbf{m}_{t-1} + (1-\\beta_1)\\mathbf{g}_t$$\n   $$\\mathbf{v}_t = \\beta_2 \\mathbf{v}_{t-1} + (1-\\beta_2)\\mathbf{g}_t \\odot \\mathbf{g}_t$$\n\u53ef\u4ee5\u89e3\u91ca\u4e3a\u4f7f\u7528\u6307\u6570\u52a0\u6743\u7684\u4e8c\u9636\u77e9\u4f30\u8ba1\u3002</p>\n</li>\n<li>\n<p><strong>Natural Gradient\u4e0e\u4e8c\u9636\u65b9\u6cd5\u7684\u7edf\u4e00</strong>\uff1a\n   - Natural gradient\uff1a$\\mathbf{x}_{t+1} = \\mathbf{x}_t - \\eta \\mathbf{F}_t^{-1}\\nabla f_t$\n   - \u5f53$\\mathbf{F}_t$\uff08Fisher\u4fe1\u606f\u77e9\u9635\uff09\u7b49\u4e8e\u671f\u671bHessian\u65f6\uff0c\u4e24\u8005\u7b49\u4ef7\n   - K-FAC\u53ef\u4ee5\u89c6\u4e3a\u7ed3\u6784\u5316\u7684\u589e\u91cfFisher\u77e9\u9635\u8fd1\u4f3c</p>\n</li>\n</ol>\n<p><strong>\u6df1\u5165\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li><strong>\u6536\u655b\u901f\u5ea6</strong>\uff1a\u5168\u77e9\u9635\u65b9\u6cd5 &gt; \u5757\u5bf9\u89d2\u65b9\u6cd5 &gt; \u5bf9\u89d2\u65b9\u6cd5</li>\n<li><strong>\u8ba1\u7b97\u5f00\u9500</strong>\uff1a\u5bf9\u89d2\u65b9\u6cd5 &lt; \u5757\u5bf9\u89d2\u65b9\u6cd5 &lt; \u5168\u77e9\u9635\u65b9\u6cd5</li>\n<li><strong>\u5185\u5b58\u9700\u6c42</strong>\uff1a$\\mathcal{O}(n)$ vs $\\mathcal{O}(n^{3/2})$ vs $\\mathcal{O}(n^2)$</li>\n</ul>\n<p><strong>\u7edf\u4e00\u89c6\u89d2\uff1a\u9884\u6761\u4ef6\u68af\u5ea6\u4e0b\u964d</strong>\n\u6240\u6709\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u53ef\u4ee5\u770b\u4f5c\u4f7f\u7528\u4e0d\u540c\u9884\u6761\u4ef6\u77e9\u9635$\\mathbf{P}_t$\u7684\u68af\u5ea6\u4e0b\u964d\uff1a\n$$\\mathbf{x}_{t+1} = \\mathbf{x}_t - \\eta_t \\mathbf{P}_t^{-1} \\nabla f_t(\\mathbf{x}_t)$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li><strong>SGD</strong>\uff1a$\\mathbf{P}_t = \\mathbf{I}$</li>\n<li><strong>AdaGrad</strong>\uff1a$\\mathbf{P}_t = \\text{diag}(\\sqrt{\\sum_{i=1}^t \\mathbf{g}_i \\odot \\mathbf{g}_i})$</li>\n<li><strong>L-BFGS</strong>\uff1a$\\mathbf{P}_t \\approx \\mathbf{H}_t$\uff08\u6709\u9650\u5185\u5b58\u8fd1\u4f3c\uff09</li>\n<li><strong>Newton</strong>\uff1a$\\mathbf{P}_t = \\nabla^2 f_t(\\mathbf{x}_t)$</li>\n</ul>\n<p><strong>\u5b9e\u7528\u5efa\u8bae</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u95ee\u9898\u89c4\u6a21</strong>\uff1a\n   - $n &lt; 10^3$\uff1a\u53ef\u4ee5\u8003\u8651\u5168\u77e9\u9635\u65b9\u6cd5\n   - $10^3 &lt; n &lt; 10^6$\uff1a\u5757\u5bf9\u89d2\u6216L-BFGS\n   - $n &gt; 10^6$\uff1a\u5bf9\u89d2\u65b9\u6cd5\u6216\u7a00\u758f\u8fd1\u4f3c</p>\n</li>\n<li>\n<p><strong>\u6570\u636e\u7279\u6027</strong>\uff1a\n   - \u566a\u58f0\u5927\uff1a\u4f7f\u7528\u66f4\u5f3a\u7684\u6b63\u5219\u5316\n   - \u975e\u5e73\u7a33\uff1a\u4f7f\u7528\u81ea\u9002\u5e94/\u6ed1\u52a8\u7a97\u53e3\u65b9\u6cd5\n   - \u7a00\u758f\uff1a\u5229\u7528\u7a00\u758f\u6027\u8bbe\u8ba1\u4e13\u95e8\u7b97\u6cd5</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\u5982\u4f55\u8bbe\u8ba1\u4ecb\u4e8e\u5bf9\u89d2\u548c\u5168\u77e9\u9635\u4e4b\u95f4\u7684\u81ea\u9002\u5e94\u7ed3\u6784\uff1f</li>\n<li>\u80fd\u5426\u5229\u7528\u795e\u7ecf\u7f51\u7edc\u7684\u7279\u6b8a\u7ed3\u6784\uff08\u5982\u5c42\u6b21\u6027\uff09\u8bbe\u8ba1\u66f4\u9ad8\u6548\u7684\u4e8c\u9636\u8fd1\u4f3c\uff1f</li>\n<li>\u5982\u4f55\u5c06\u589e\u91cfHessian\u6280\u672f\u6269\u5c55\u5230\u975e\u51f8\u4f18\u5316\uff0c\u7279\u522b\u662f\u5904\u7406\u8d1f\u66f2\u7387\uff1f</li>\n<li>\u662f\u5426\u53ef\u4ee5\u8bbe\u8ba1\u201c\u5b66\u4f1a\u5b66\u4e60\u201d\u7684\u4e8c\u9636\u4f18\u5316\u5668\uff0c\u81ea\u52a8\u53d1\u73b0\u6700\u4f73\u7684Hessian\u7ed3\u6784\uff1f</li>\n<li>\u5982\u4f55\u5728\u8054\u90a6\u5b66\u4e60\u4e2d\u5b89\u5168\u5730\u805a\u5408\u4e8c\u9636\u4fe1\u606f\uff1f</li>\n</ol>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u589e\u91cfHessian\u8ba1\u7b97\u7684\u7406\u8bba\u57fa\u7840\u548c\u5b9e\u8df5\u6280\u672f\u3002\u6838\u5fc3\u8981\u70b9\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>Woodbury\u516c\u5f0f\u7684\u4e2d\u5fc3\u5730\u4f4d</strong>\uff1a\u4f5c\u4e3a\u4f4e\u79e9\u66f4\u65b0\u7684\u57fa\u7840\u5de5\u5177\uff0cWoodbury\u77e9\u9635\u6052\u7b49\u5f0f\u8d2f\u7a7f\u6574\u4e2a\u589e\u91cf\u8ba1\u7b97\u6846\u67b6\u3002\u638c\u63e1\u5176\u6570\u503c\u7a33\u5b9a\u7684\u5b9e\u73b0\u548c\u5404\u79cd\u53d8\u4f53\u662f\u7406\u89e3\u73b0\u4ee3\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\u7684\u5173\u952e\u3002</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u4e0e\u8ba1\u7b97\u7684\u6743\u8861</strong>\uff1a\u4ece\u5b8c\u6574Hessian\uff08$\\mathcal{O}(n^2)$\u5b58\u50a8\uff09\u5230\u5bf9\u89d2\u8fd1\u4f3c\uff08$\\mathcal{O}(n)$\u5b58\u50a8\uff09\uff0c\u4e0d\u540c\u7684\u8fd1\u4f3c\u7b56\u7565\u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u9009\u62e9\u3002Block-wise\u65b9\u6cd5\u548csliding window\u6280\u672f\u5728\u4e24\u8005\u4e4b\u95f4\u627e\u5230\u4e86\u5b9e\u7528\u7684\u5e73\u8861\u70b9\u3002</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u5b66\u4e60\u7684\u89c6\u89d2</strong>\uff1a\u5c06\u589e\u91cfHessian\u8ba1\u7b97\u7f6e\u4e8e\u5728\u7ebf\u51f8\u4f18\u5316\u6846\u67b6\u4e0b\uff0c\u4e0d\u4ec5\u63d0\u4f9b\u4e86\u7406\u8bba\u4fdd\u8bc1\uff08regret\u754c\uff09\uff0c\u8fd8\u63ed\u793a\u4e86\u4e0eAdaGrad\u3001Adam\u7b49\u6d41\u884c\u7b97\u6cd5\u7684\u6df1\u5c42\u8054\u7cfb\u3002</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6027\u7684\u91cd\u8981\u6027</strong>\uff1a\u56fa\u5b9a\u7684\u7a97\u53e3\u5927\u5c0f\u3001\u9057\u5fd8\u56e0\u5b50\u6216\u6b63\u5219\u5316\u53c2\u6570\u96be\u4ee5\u9002\u5e94\u52a8\u6001\u73af\u5883\u3002\u672c\u7ae0\u4ecb\u7ecd\u7684\u5404\u79cd\u81ea\u9002\u5e94\u7b56\u7565\u4e3a\u5b9e\u9645\u5e94\u7528\u63d0\u4f9b\u4e86\u6307\u5bfc\u3002</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u516c\u5f0f\u6c47\u603b</strong>\uff1a</p>\n<ul>\n<li>Woodbury\u6052\u7b49\u5f0f\uff1a$(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{U}(\\mathbf{C}^{-1} + \\mathbf{V}^T\\mathbf{A}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{A}^{-1}$</li>\n<li>\u6ed1\u52a8\u7a97\u53e3\u66f4\u65b0\uff1a$\\mathbf{H}_{t+1} = \\mathbf{H}_t + \\mathbf{g}_{t+1}\\mathbf{g}_{t+1}^T - \\mathbf{g}_{t-W+1}\\mathbf{g}_{t-W+1}^T$</li>\n<li>\u6307\u6570\u52a0\u6743\uff1a$\\mathbf{H}_t = (1-\\alpha)\\mathbf{H}_{t-1} + \\alpha\\mathbf{g}_t\\mathbf{g}_t^T$</li>\n<li>\u5728\u7ebfNewton\u6b65\uff1a$\\mathbf{x}_{t+1} = \\mathbf{x}_t - \\eta_t \\mathbf{H}_t^{-1}\\nabla f_t(\\mathbf{x}_t)$</li>\n</ul>\n<p><strong>\u672a\u6765\u5c55\u671b</strong>\uff1a\n\u589e\u91cfHessian\u8ba1\u7b97\u5728\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\u4ecd\u6709\u5de8\u5927\u6f5c\u529b\u3002\u7279\u522b\u662f\u5728\u8054\u90a6\u5b66\u4e60\u3001\u6301\u7eed\u5b66\u4e60\u548c\u5b9e\u65f6\u7cfb\u7edf\u4e2d\uff0c\u9ad8\u6548\u7684\u4e8c\u9636\u4fe1\u606f\u7ef4\u62a4\u5c06\u6210\u4e3a\u5173\u952e\u6280\u672f\u3002\u7ed3\u5408\u786c\u4ef6\u52a0\u901f\uff08\u5982\u4e13\u7528\u77e9\u9635\u8fd0\u7b97\u5355\u5143\uff09\u548c\u65b0\u578b\u7b97\u6cd5\u8bbe\u8ba1\uff0c\u6709\u671b\u5b9e\u73b0\u66f4\u5927\u89c4\u6a21\u95ee\u9898\u7684\u5b9e\u65f6\u4e8c\u9636\u4f18\u5316\u3002</p>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u98984.1</strong> \u8bc1\u660eWoodbury\u77e9\u9635\u6052\u7b49\u5f0f\u3002\u4eceSherman-Morrison\u516c\u5f0f\uff08\u79e9-1\u60c5\u51b5\uff09\u51fa\u53d1\uff0c\u63a8\u5e7f\u5230\u79e9-k\u7684\u60c5\u51b5\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u6216\u8003\u8651\u5757\u77e9\u9635\u6c42\u9006\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8003\u8651\u589e\u5e7f\u77e9\u9635\uff1a\n$$\\begin{bmatrix}\n\\mathbf{A} &amp; \\mathbf{U} \\\n\\mathbf{V}^T &amp; -\\mathbf{C}^{-1}\n\\end{bmatrix}$$\n\u4f7f\u7528\u5757\u77e9\u9635\u6c42\u9006\u516c\u5f0f\uff0c\u901a\u8fc7Schur\u8865\u53ef\u5f97Woodbury\u516c\u5f0f\u3002\u5173\u952e\u6b65\u9aa4\u662f\u9a8c\u8bc1\uff1a\n$$(\\mathbf{A} + \\mathbf{U}\\mathbf{C}\\mathbf{V}^T)(\\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{U}(\\mathbf{C}^{-1} + \\mathbf{V}^T\\mathbf{A}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{A}^{-1}) = \\mathbf{I}$$</p>\n</details>\n<p><strong>\u4e60\u98984.2</strong> \u5206\u6790\u6ed1\u52a8\u7a97\u53e3Hessian\u4f30\u8ba1\u7684\u504f\u5dee\u548c\u65b9\u5dee\u3002\u5047\u8bbe\u68af\u5ea6$\\mathbf{g}_t$\u662f\u72ec\u7acb\u540c\u5206\u5e03\u7684\uff0c\u671f\u671b\u4e3a$\\boldsymbol{\\mu}$\uff0c\u534f\u65b9\u5dee\u4e3a$\\boldsymbol{\\Sigma}$\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u8ba1\u7b97$\\mathbb{E}[\\mathbf{H}_t]$\u548c$\\text{Var}[\\mathbf{H}_t]_{ij}$\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e\u7a97\u53e3\u5927\u5c0f$W$\uff1a</p>\n<ul>\n<li>\u671f\u671b\uff1a$\\mathbb{E}[\\mathbf{H}_t] = W(\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T + \\boldsymbol{\\Sigma})$</li>\n<li>\u65b9\u5dee\uff1a\u6bcf\u4e2a\u5143\u7d20$(i,j)$\u7684\u65b9\u5dee\u6d89\u53ca\u56db\u9636\u77e9\uff0c\u5728\u9ad8\u65af\u5047\u8bbe\u4e0b\u53ef\u4ee5\u7b80\u5316</li>\n<li>\u504f\u5dee-\u65b9\u5dee\u6743\u8861\uff1a\u5927\u7a97\u53e3\u964d\u4f4e\u65b9\u5dee\u4f46\u5728\u975e\u5e73\u7a33\u60c5\u51b5\u4e0b\u589e\u52a0\u504f\u5dee</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98984.3</strong> \u8bbe\u8ba1\u4e00\u4e2a\u6570\u503c\u7a33\u5b9a\u7684\u7b97\u6cd5\uff0c\u7528\u4e8e\u7ef4\u62a4\u6ed1\u52a8\u7a97\u53e3Hessian\u7684Cholesky\u5206\u89e3\u3002\u5904\u7406\u79fb\u9664\u65e7\u68af\u5ea6\u65f6\u53ef\u80fd\u51fa\u73b0\u7684\u6570\u503c\u95ee\u9898\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u8003\u8651\u5f53\u88ab\u79fb\u9664\u7684\u68af\u5ea6\u5f88\u5c0f\u65f6\uff0c\u76f4\u63a5\u7684\u964d\u7ea7\u66f4\u65b0\u53ef\u80fd\u4e0d\u7a33\u5b9a\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u6dfb\u52a0\u65b0\u68af\u5ea6\uff1a\u4f7f\u7528\u6807\u51c6\u7684cholupdate</li>\n<li>\u79fb\u9664\u65e7\u68af\u5ea6\uff1a\n   - \u68c0\u67e5\u6761\u4ef6\u6570\uff1a\u5982\u679c$\\kappa(\\mathbf{L}) &gt; \\tau$\uff0c\u91cd\u65b0\u8ba1\u7b97\u5b8c\u6574\u5206\u89e3\n   - \u4f7f\u7528\u4fee\u6b63\u7684\u964d\u7ea7\u7b97\u6cd5\uff0c\u6dfb\u52a0\u5c0f\u7684\u6b63\u5219\u5316\u9879\n   - \u7ef4\u62a4\u68af\u5ea6\u7f13\u51b2\u533a\uff0c\u652f\u6301\u91cd\u65b0\u8ba1\u7b97</li>\n<li>\u5468\u671f\u6027\u91cd\u65b0\u6b63\u4ea4\u5316\u4ee5\u63a7\u5236\u7d2f\u79ef\u8bef\u5dee</li>\n</ol>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u98984.4</strong> \u8003\u8651\u5206\u5e03\u5f0f\u73af\u5883\uff0c$P$\u4e2a\u8282\u70b9\u5404\u81ea\u7ef4\u62a4\u5c40\u90e8Hessian\u4f30\u8ba1$\\mathbf{H}_i$\u3002\u8bbe\u8ba1\u4e00\u4e2a\u901a\u4fe1\u9ad8\u6548\u7684\u534f\u8bae\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u8282\u70b9\u80fd\u591f\u83b7\u5f97\u5168\u5c40Hessian\u7684\u826f\u597d\u8fd1\u4f3c\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u8003\u8651\u4f7f\u7528gossip\u7b97\u6cd5\u6216\u5206\u5c42\u805a\u5408\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u65b9\u6848\u4e00\uff1a\u5206\u5c42\u805a\u5408</p>\n<ul>\n<li>\u6784\u5efa\u901a\u4fe1\u6811\uff0c\u6bcf\u5c42\u805a\u5408\u4f7f\u7528Woodbury\u516c\u5f0f</li>\n<li>\u901a\u4fe1\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(\\log P)$\u8f6e\uff0c\u6bcf\u8f6e$\\mathcal{O}(n^2)$\u6570\u636e</li>\n</ul>\n<p>\u65b9\u6848\u4e8c\uff1a\u968f\u673agossip</p>\n<ul>\n<li>\u6bcf\u8f6e\u968f\u673a\u9009\u62e9\u90bb\u5c45\u4ea4\u6362\u4fe1\u606f</li>\n<li>\u4f7f\u7528\u52a0\u6743\u5e73\u5747\uff1a$\\mathbf{H}_i^{new} = (1-\\alpha)\\mathbf{H}_i + \\alpha\\mathbf{H}_j$</li>\n<li>\u6536\u655b\u901f\u5ea6\u53d6\u51b3\u4e8e\u901a\u4fe1\u56fe\u7684\u8c31\u9699</li>\n</ul>\n<p>\u5173\u952e\u4f18\u5316\uff1a\u53ea\u4f20\u8f93\u4f4e\u79e9\u66f4\u65b0\u6216\u7a00\u758f\u589e\u91cf</p>\n</details>\n<p><strong>\u4e60\u98984.5</strong> \u5728\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u4e2d\uff0c\u6bd4\u8f83\u4ee5\u4e0b\u4e09\u79cdHessian\u4f30\u8ba1\u7b56\u7565\u7684regret\u754c\uff1a(a) \u5b8c\u6574Hessian\uff0c(b) \u5bf9\u89d2\u8fd1\u4f3c\uff0c(c) \u5757\u5bf9\u89d2\u8fd1\u4f3c\uff08\u5757\u5927\u5c0f\u4e3a$B$\uff09\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u4f7f\u7528\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u6807\u51c6\u5206\u6790\u6280\u672f\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe\u6570\u636e\u7ef4\u5ea6\u4e3a$n$\uff0c\u65f6\u95f4\u8303\u56f4\u4e3a$T$\uff1a</p>\n<ul>\n<li>\u5b8c\u6574Hessian\uff1a$R_T = \\mathcal{O}(n\\log T)$\uff08\u6700\u4f18\uff09</li>\n<li>\u5bf9\u89d2\u8fd1\u4f3c\uff1a$R_T = \\mathcal{O}(n\\sqrt{T})$\uff08\u6b21\u4f18\uff09</li>\n<li>\u5757\u5bf9\u89d2\uff08\u5757\u5927\u5c0f$B$\uff09\uff1a$R_T = \\mathcal{O}(nB^{-1/2}\\sqrt{T} + B\\log T)$</li>\n</ul>\n<p>\u6700\u4f18\u5757\u5927\u5c0f\uff1a$B^* = \\Theta(T^{1/3})$\uff0c\u5f97\u5230$R_T = \\mathcal{O}(n T^{1/3})$</p>\n</details>\n<p><strong>\u4e60\u98984.6</strong> \u9488\u5bf9\u795e\u7ecf\u7f51\u7edc\u7684\u7279\u6b8a\u7ed3\u6784\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u4ecb\u4e8eK-FAC\u548c\u5b8c\u6574Hessian\u4e4b\u95f4\u7684\u589e\u91cf\u8fd1\u4f3c\u65b9\u6cd5\u3002\u5206\u6790\u5176\u8ba1\u7b97\u590d\u6742\u5ea6\u548c\u5185\u5b58\u9700\u6c42\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u8003\u8651\u5229\u7528\u5c42\u95f4\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5206\u5c42Kronecker\u8fd1\u4f3c\uff1a</p>\n<ol>\n<li>\u5c06\u7f51\u7edc\u5206\u4e3a$K$\u4e2a\u7ec4\uff0c\u6bcf\u7ec4\u5305\u542b\u76f8\u90bb\u7684\u51e0\u5c42</li>\n<li>\u7ec4\u5185\u4f7f\u7528\u5b8c\u6574Hessian\uff0c\u7ec4\u95f4\u5047\u8bbe\u72ec\u7acb</li>\n<li>\u6bcf\u7ec4\u7684Hessian\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5206\u89e3\u4e3a\u8f93\u5165\u548c\u8f93\u51fa\u7684Kronecker\u79ef</li>\n</ol>\n<p>\u590d\u6742\u5ea6\u5206\u6790\uff08\u8bbe\u6bcf\u7ec4\u5e73\u5747\u5927\u5c0f\u4e3a$m$\uff09\uff1a</p>\n<ul>\n<li>\u5b58\u50a8\uff1a$\\mathcal{O}(Km^2)$\u800c\u975e$\\mathcal{O}(n^2)$</li>\n<li>\u66f4\u65b0\uff1a$\\mathcal{O}(Km^3)$\u6bcf\u6b21</li>\n<li>\u6c42\u9006\uff1a\u5229\u7528\u5757\u5bf9\u89d2\u7ed3\u6784\uff0c$\\mathcal{O}(Km^3)$</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98984.7</strong>\uff08\u5f00\u653e\u95ee\u9898\uff09\u5982\u4f55\u5c06\u589e\u91cfHessian\u6280\u672f\u6269\u5c55\u5230\u975e\u51f8\u4f18\u5316\uff1f\u7279\u522b\u662f\uff0c\u5982\u4f55\u68c0\u6d4b\u548c\u5229\u7528\u8d1f\u66f2\u7387\u65b9\u5411\uff1f\u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\u6846\u67b6\u5e76\u5206\u6790\u5176\u7406\u8bba\u6027\u8d28\u3002</p>\n<p><em>\u63d0\u793a\uff1a\u8003\u8651\u7ed3\u5408Lanczos\u65b9\u6cd5\u6216\u968f\u673a\u5316\u6280\u672f\u3002</em></p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u7ef4\u62a4Hessian\u7684\u4f4e\u79e9\u8fd1\u4f3c\u52a0\u5bf9\u89d2\u4fee\u6b63\uff1a$\\mathbf{H} \\approx \\mathbf{U}\\mathbf{U}^T + \\mathbf{D}$</li>\n<li>\u4f7f\u7528Lanczos\u8fed\u4ee3\u68c0\u6d4b\u6700\u5c0f\u7279\u5f81\u503c</li>\n<li>\u5982\u679c\u68c0\u6d4b\u5230\u8d1f\u66f2\u7387\uff0c\u6cbf\u76f8\u5e94\u7279\u5f81\u5411\u91cf\u65b9\u5411\u4e0b\u964d</li>\n</ol>\n<p>\u7406\u8bba\u6311\u6218\uff1a</p>\n<ul>\n<li>\u975e\u51f8\u60c5\u51b5\u4e0b\u6ca1\u6709\u5168\u5c40\u6536\u655b\u4fdd\u8bc1</li>\n<li>\u9700\u8981\u5e73\u8861\u63a2\u7d22\uff08\u5bfb\u627e\u8d1f\u66f2\u7387\uff09\u548c\u5229\u7528\uff08\u6cbf\u8d1f\u66f2\u7387\u4e0b\u964d\uff09</li>\n<li>\u589e\u91cf\u66f4\u65b0\u53ef\u80fd\u9519\u8fc7\u91cd\u8981\u7684\u66f2\u7387\u4fe1\u606f</li>\n</ul>\n<p>\u7814\u7a76\u65b9\u5411\uff1a\u7ed3\u5408\u968f\u673a\u77e9\u9635\u7406\u8bba\u5206\u6790\u8fd1\u4f3c\u8bef\u5dee\u5bf9\u6536\u655b\u7684\u5f71\u54cd</p>\n</details>\n<h2 id=\"_5\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<p>\u5728\u5b9e\u73b0\u548c\u5e94\u7528\u589e\u91cfHessian\u8ba1\u7b97\u65f6\uff0c\u4ee5\u4e0b\u662f\u5bb9\u6613\u72af\u7684\u9519\u8bef\u548c\u76f8\u5e94\u7684\u89e3\u51b3\u65b9\u6848\uff1a</p>\n<h3 id=\"1\">1. \u6570\u503c\u7a33\u5b9a\u6027\u9677\u9631</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u76f4\u63a5\u5e94\u7528Woodbury\u516c\u5f0f\u53ef\u80fd\u5bfc\u81f4\u6570\u503c\u4e0d\u7a33\u5b9a\uff0c\u7279\u522b\u662f\u5f53\u77e9\u9635\u63a5\u8fd1\u5947\u5f02\u65f6\u3002</p>\n<p><strong>\u75c7\u72b6</strong>\uff1a</p>\n<ul>\n<li>\u8ba1\u7b97\u7ed3\u679c\u5305\u542bNaN\u6216Inf</li>\n<li>\u4f18\u5316\u8fc7\u7a0b\u53d1\u6563</li>\n<li>\u6761\u4ef6\u6570\u6025\u5267\u589e\u5927</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u59cb\u7ec8\u6dfb\u52a0\u6b63\u5219\u5316\u9879\uff1a$\\mathbf{H} + \\lambda\\mathbf{I}$\uff0c\u5176\u4e2d$\\lambda \\geq \\epsilon_{machine}$</li>\n<li>\u76d1\u63a7\u6761\u4ef6\u6570\uff0c\u5f53$\\kappa(\\mathbf{H}) &gt; 10^{12}$\u65f6\u91cd\u65b0\u521d\u59cb\u5316</li>\n<li>\u4f7f\u7528\u7a33\u5b9a\u7684\u77e9\u9635\u5206\u89e3\uff08\u5982QR\u6216SVD\uff09\u4ee3\u66ff\u76f4\u63a5\u6c42\u9006</li>\n</ul>\n<h3 id=\"2\">2. \u5185\u5b58\u7ba1\u7406\u9519\u8bef</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5728\u5927\u89c4\u6a21\u5e94\u7528\u4e2d\uff0c\u4e0d\u5f53\u7684\u5185\u5b58\u7ba1\u7406\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u6216\u9891\u7e41\u7684\u5185\u5b58\u5206\u914d\u3002</p>\n<p><strong>\u75c7\u72b6</strong>\uff1a</p>\n<ul>\n<li>\u7a0b\u5e8f\u56e0\u5185\u5b58\u4e0d\u8db3\u5d29\u6e83</li>\n<li>\u6027\u80fd\u56e0\u9891\u7e41\u7684\u5783\u573e\u56de\u6536\u800c\u4e0b\u964d</li>\n<li>\u5185\u5b58\u4f7f\u7528\u91cf\u7ebf\u6027\u589e\u957f</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u9884\u5206\u914d\u6240\u6709\u9700\u8981\u7684\u77e9\u9635\u7a7a\u95f4</li>\n<li>\u4f7f\u7528\u539f\u5730\u66f4\u65b0\uff08in-place updates\uff09\u907f\u514d\u521b\u5efa\u4e34\u65f6\u77e9\u9635</li>\n<li>\u5b9e\u73b0\u5faa\u73af\u7f13\u51b2\u533a\u5b58\u50a8\u5386\u53f2\u68af\u5ea6</li>\n<li>\u8003\u8651\u4f7f\u7528\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u5904\u7406\u8d85\u5927\u89c4\u6a21\u95ee\u9898</li>\n</ul>\n<h3 id=\"3\">3. \u66f4\u65b0\u987a\u5e8f\u9519\u8bef</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5728\u6ed1\u52a8\u7a97\u53e3\u6216\u5206\u5757\u66f4\u65b0\u4e2d\uff0c\u9519\u8bef\u7684\u66f4\u65b0\u987a\u5e8f\u5bfc\u81f4\u4e0d\u4e00\u81f4\u7684\u72b6\u6001\u3002</p>\n<p><strong>\u75c7\u72b6</strong>\uff1a</p>\n<ul>\n<li>Hessian\u77e9\u9635\u5931\u53bb\u6b63\u5b9a\u6027</li>\n<li>\u66f4\u65b0\u540e\u7684\u77e9\u9635\u4e0e\u771f\u5b9e\u503c\u504f\u5dee\u5f88\u5927</li>\n<li>\u7b97\u6cd5\u6536\u655b\u6027\u53d8\u5dee</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u4e25\u683c\u9075\u5faa\"\u5148\u79fb\u9664\u65e7\u6570\u636e\uff0c\u518d\u6dfb\u52a0\u65b0\u6570\u636e\"\u7684\u987a\u5e8f</li>\n<li>\u5728\u6bcf\u6b21\u66f4\u65b0\u540e\u9a8c\u8bc1\u6b63\u5b9a\u6027\uff08\u68c0\u67e5\u6700\u5c0f\u7279\u5f81\u503c\uff09</li>\n<li>\u4f7f\u7528\u4e8b\u52a1\u5f0f\u66f4\u65b0\uff0c\u5931\u8d25\u65f6\u80fd\u591f\u56de\u6eda</li>\n</ul>\n<h3 id=\"4\">4. \u5e76\u884c\u5316\u9677\u9631</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u4e0d\u5f53\u7684\u5e76\u884c\u5316\u7b56\u7565\u5bfc\u81f4\u7ade\u6001\u6761\u4ef6\u6216\u9519\u8bef\u7684\u7ed3\u679c\u3002</p>\n<p><strong>\u75c7\u72b6</strong>\uff1a</p>\n<ul>\n<li>\u5e76\u884c\u7248\u672c\u4e0e\u4e32\u884c\u7248\u672c\u7ed3\u679c\u4e0d\u4e00\u81f4</li>\n<li>\u95f4\u6b47\u6027\u7684\u9519\u8bef\u6216\u5d29\u6e83</li>\n<li>\u5e76\u884c\u6548\u7387\u4f4e\u4e0b</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u9501\u6216\u539f\u5b50\u64cd\u4f5c\u4fdd\u62a4\u5171\u4eab\u6570\u636e\u7ed3\u6784</li>\n<li>\u8bbe\u8ba1\u65e0\u9501\u7b97\u6cd5\uff0c\u5982\u4f7f\u7528\u5c40\u90e8\u7d2f\u79ef\u540e\u5f52\u7ea6</li>\n<li>\u4ed4\u7ec6\u5206\u6790\u6570\u636e\u4f9d\u8d56\uff0c\u907f\u514dfalse sharing</li>\n<li>\u4f7f\u7528\u4e13\u95e8\u7684\u5e76\u884c\u7ebf\u6027\u4ee3\u6570\u5e93\uff08\u5982ScaLAPACK\uff09</li>\n</ul>\n<h3 id=\"5\">5. \u53c2\u6570\u9009\u62e9\u4e0d\u5f53</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u7a97\u53e3\u5927\u5c0f\u3001\u9057\u5fd8\u56e0\u5b50\u7b49\u8d85\u53c2\u6570\u9009\u62e9\u4e0d\u5f53\uff0c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</p>\n<p><strong>\u75c7\u72b6</strong>\uff1a</p>\n<ul>\n<li>\u6536\u655b\u901f\u5ea6\u6162</li>\n<li>\u5bf9\u6570\u636e\u5206\u5e03\u53d8\u5316\u53cd\u5e94\u8fdf\u949d</li>\n<li>\u8fc7\u62df\u5408\u6216\u6b20\u62df\u5408</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u9a8c\u8bc1\u96c6\u8c03\u4f18\u8d85\u53c2\u6570</li>\n<li>\u5b9e\u73b0\u81ea\u9002\u5e94\u53c2\u6570\u8c03\u6574\u673a\u5236</li>\n<li>\u76d1\u63a7\u5173\u952e\u6307\u6807\uff08\u5982\u9884\u6d4b\u8bef\u5dee\uff09\u5e76\u52a8\u6001\u8c03\u6574</li>\n<li>\u63d0\u4f9b\u5408\u7406\u7684\u9ed8\u8ba4\u503c\uff1a\u7a97\u53e3\u5927\u5c0f$\\approx \\sqrt{n}$\uff0c\u9057\u5fd8\u56e0\u5b50$\\approx 0.95$</li>\n</ul>\n<h3 id=\"6\">6. \u5ffd\u89c6\u7279\u6b8a\u7ed3\u6784</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u6ca1\u6709\u5229\u7528\u95ee\u9898\u7684\u7279\u6b8a\u7ed3\u6784\uff08\u5982\u7a00\u758f\u6027\u3001\u4f4e\u79e9\u6027\uff09\uff0c\u5bfc\u81f4\u8ba1\u7b97\u548c\u5b58\u50a8\u6d6a\u8d39\u3002</p>\n<p><strong>\u75c7\u72b6</strong>\uff1a</p>\n<ul>\n<li>\u5185\u5b58\u4f7f\u7528\u8fdc\u8d85\u5fc5\u8981</li>\n<li>\u8ba1\u7b97\u65f6\u95f4\u8fc7\u957f</li>\n<li>\u7a00\u758f\u77e9\u9635\u53d8\u7a20\u5bc6</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u5728\u66f4\u65b0\u524d\u5206\u6790\u77e9\u9635\u7ed3\u6784</li>\n<li>\u4f7f\u7528\u4e13\u95e8\u7684\u7a00\u758f\u77e9\u9635\u6570\u636e\u7ed3\u6784\u548c\u7b97\u6cd5</li>\n<li>\u5b9e\u73b0\u81ea\u9002\u5e94\u7684\u7a00\u758f\u5316\u7b56\u7565</li>\n<li>\u8003\u8651\u4f7f\u7528\u5206\u5c42\u6216\u591a\u5206\u8fa8\u7387\u8868\u793a</li>\n</ul>\n<h3 id=\"_6\">\u8c03\u8bd5\u6280\u5de7</h3>\n<ol>\n<li><strong>\u5355\u5143\u6d4b\u8bd5</strong>\uff1a\u4e3a\u6bcf\u4e2a\u6838\u5fc3\u51fd\u6570\u7f16\u5199\u6d4b\u8bd5\uff0c\u7279\u522b\u662f\u8fb9\u754c\u60c5\u51b5</li>\n<li><strong>\u4e0d\u53d8\u91cf\u68c0\u67e5</strong>\uff1a\u5728\u5173\u952e\u6b65\u9aa4\u540e\u9a8c\u8bc1\u77e9\u9635\u6027\u8d28\uff08\u5bf9\u79f0\u6027\u3001\u6b63\u5b9a\u6027\u7b49\uff09</li>\n<li><strong>\u53ef\u89c6\u5316</strong>\uff1a\u7ed8\u5236\u6761\u4ef6\u6570\u3001\u7279\u5f81\u503c\u8c31\u7684\u6f14\u5316</li>\n<li><strong>\u57fa\u51c6\u5bf9\u6bd4</strong>\uff1a\u4e0e\u7b80\u5355\u4f46\u53ef\u9760\u7684\u5b9e\u73b0\u5bf9\u6bd4\u7ed3\u679c</li>\n<li><strong>\u6e10\u8fdb\u6d4b\u8bd5</strong>\uff1a\u4ece\u5c0f\u89c4\u6a21\u95ee\u9898\u5f00\u59cb\uff0c\u9010\u6b65\u589e\u52a0\u89c4\u6a21</li>\n</ol>\n<h2 id=\"_7\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<p>\u5728\u8bbe\u8ba1\u548c\u5b9e\u73b0\u589e\u91cfHessian\u8ba1\u7b97\u7cfb\u7edf\u65f6\uff0c\u4f7f\u7528\u4ee5\u4e0b\u68c0\u67e5\u6e05\u5355\u786e\u4fdd\u8d28\u91cf\uff1a</p>\n<h3 id=\"_8\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u9700\u6c42\u5206\u6790</strong></li>\n<li>\u786e\u5b9a\u95ee\u9898\u89c4\u6a21\uff08\u7ef4\u5ea6$n$\u3001\u6570\u636e\u91cf$T$\uff09</li>\n<li>\u8bc4\u4f30\u5185\u5b58\u548c\u8ba1\u7b97\u7ea6\u675f</li>\n<li>\n<p>\u8bc6\u522b\u6570\u636e\u7279\u6027\uff08\u5e73\u7a33\u6027\u3001\u7a00\u758f\u6027\u3001\u566a\u58f0\u6c34\u5e73\uff09</p>\n</li>\n<li>\n<p>[ ] <strong>\u65b9\u6cd5\u9009\u62e9</strong></p>\n</li>\n<li>\u6bd4\u8f83\u4e0d\u540c\u8fd1\u4f3c\u7ea7\u522b\u7684\u6743\u8861\uff08\u5168\u77e9\u9635 vs \u5757\u5bf9\u89d2 vs \u5bf9\u89d2\uff09</li>\n<li>\u8003\u8651\u95ee\u9898\u7684\u7279\u6b8a\u7ed3\u6784</li>\n<li>\n<p>\u8bc4\u4f30\u5e76\u884c\u5316\u6f5c\u529b</p>\n</li>\n<li>\n<p>[ ] <strong>\u7406\u8bba\u5206\u6790</strong></p>\n</li>\n<li>\u63a8\u5bfc\u6536\u655b\u6027\u4fdd\u8bc1</li>\n<li>\u5206\u6790\u8ba1\u7b97\u548c\u5185\u5b58\u590d\u6742\u5ea6</li>\n<li>\u786e\u5b9aregret\u754c\u6216\u8fd1\u4f3c\u8bef\u5dee\u754c</li>\n</ul>\n<h3 id=\"_9\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u6570\u503c\u7a33\u5b9a\u6027</strong></li>\n<li>\u6dfb\u52a0\u9002\u5f53\u7684\u6b63\u5219\u5316</li>\n<li>\u5b9e\u73b0\u6761\u4ef6\u6570\u76d1\u63a7</li>\n<li>\n<p>\u9009\u62e9\u7a33\u5b9a\u7684\u77e9\u9635\u5206\u89e3\u7b97\u6cd5</p>\n</li>\n<li>\n<p>[ ] <strong>\u5185\u5b58\u7ba1\u7406</strong></p>\n</li>\n<li>\u9884\u5206\u914d\u6240\u6709\u5927\u578b\u6570\u636e\u7ed3\u6784</li>\n<li>\u5b9e\u73b0\u9ad8\u6548\u7684\u66f4\u65b0\u7b56\u7565\uff08\u539f\u5730\u64cd\u4f5c\uff09</li>\n<li>\n<p>\u8003\u8651out-of-core\u7b97\u6cd5\u7528\u4e8e\u8d85\u5927\u89c4\u6a21\u95ee\u9898</p>\n</li>\n<li>\n<p>[ ] <strong>\u6027\u80fd\u4f18\u5316</strong></p>\n</li>\n<li>\u5229\u7528BLAS/LAPACK\u4f18\u5316\u7684\u4f8b\u7a0b</li>\n<li>\u5b9e\u73b0\u7f13\u5b58\u53cb\u597d\u7684\u6570\u636e\u5e03\u5c40</li>\n<li>\u8003\u8651\u5411\u91cf\u5316\u548cSIMD\u6307\u4ee4</li>\n</ul>\n<h3 id=\"_10\">\u9a8c\u8bc1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u6b63\u786e\u6027\u6d4b\u8bd5</strong></li>\n<li>\u5355\u5143\u6d4b\u8bd5\u6838\u5fc3\u7b97\u6cd5\u7ec4\u4ef6</li>\n<li>\u4e0e\u6734\u7d20\u5b9e\u73b0\u5bf9\u6bd4\u7ed3\u679c</li>\n<li>\n<p>\u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5\u548c\u5f02\u5e38\u8f93\u5165</p>\n</li>\n<li>\n<p>[ ] <strong>\u6027\u80fd\u6d4b\u8bd5</strong></p>\n</li>\n<li>\u57fa\u51c6\u6d4b\u8bd5\u4e0d\u540c\u89c4\u6a21\u7684\u95ee\u9898</li>\n<li>\u5206\u6790scaling\u884c\u4e3a</li>\n<li>\n<p>\u8bc6\u522b\u6027\u80fd\u74f6\u9888</p>\n</li>\n<li>\n<p>[ ] <strong>\u9c81\u68d2\u6027\u6d4b\u8bd5</strong></p>\n</li>\n<li>\u6d4b\u8bd5\u6570\u503c\u7a33\u5b9a\u6027\uff08\u75c5\u6001\u77e9\u9635\uff09</li>\n<li>\u9a8c\u8bc1\u5bf9\u566a\u58f0\u7684\u9c81\u68d2\u6027</li>\n<li>\u68c0\u67e5\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u7a33\u5b9a\u6027</li>\n</ul>\n<h3 id=\"_11\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u76d1\u63a7\u8bbe\u7f6e</strong></li>\n<li>\u5b9e\u65f6\u76d1\u63a7\u5173\u952e\u6307\u6807\uff08\u6761\u4ef6\u6570\u3001\u66f4\u65b0\u65f6\u95f4\uff09</li>\n<li>\u8bbe\u7f6e\u5f02\u5e38\u544a\u8b66\uff08\u5982\u6570\u503c\u6ea2\u51fa\uff09</li>\n<li>\n<p>\u8bb0\u5f55\u6027\u80fd\u7edf\u8ba1\u7528\u4e8e\u540e\u7eed\u5206\u6790</p>\n</li>\n<li>\n<p>[ ] <strong>\u53c2\u6570\u8c03\u4f18</strong></p>\n</li>\n<li>\u63d0\u4f9b\u5408\u7406\u7684\u9ed8\u8ba4\u53c2\u6570</li>\n<li>\u5b9e\u73b0\u53c2\u6570\u81ea\u9002\u5e94\u673a\u5236</li>\n<li>\n<p>\u6587\u6863\u5316\u53c2\u6570\u9009\u62e9\u6307\u5357</p>\n</li>\n<li>\n<p>[ ] <strong>\u53ef\u7ef4\u62a4\u6027</strong></p>\n</li>\n<li>\u6e05\u6670\u7684\u4ee3\u7801\u7ec4\u7ec7\u548c\u547d\u540d</li>\n<li>\u5b8c\u6574\u7684API\u6587\u6863</li>\n<li>\u63d0\u4f9b\u4f7f\u7528\u793a\u4f8b\u548c\u6700\u4f73\u5b9e\u8df5</li>\n</ul>\n<h3 id=\"_12\">\u9ad8\u7ea7\u8003\u8651</h3>\n<ul>\n<li>[ ] <strong>\u6269\u5c55\u6027\u8bbe\u8ba1</strong></li>\n<li>\u6a21\u5757\u5316\u67b6\u6784\u652f\u6301\u65b0\u7684\u66f4\u65b0\u7b56\u7565</li>\n<li>\u63a5\u53e3\u8bbe\u8ba1\u5141\u8bb8\u4e0d\u540c\u7684\u77e9\u9635\u8868\u793a</li>\n<li>\n<p>\u8003\u8651\u672a\u6765\u7684\u5e76\u884c\u5316\u6216\u5206\u5e03\u5f0f\u6269\u5c55</p>\n</li>\n<li>\n<p>[ ] <strong>\u4e0e\u73b0\u6709\u7cfb\u7edf\u96c6\u6210</strong></p>\n</li>\n<li>\u517c\u5bb9\u4e3b\u6d41\u4f18\u5316\u6846\u67b6\uff08\u5982TensorFlow\u3001PyTorch\uff09</li>\n<li>\u63d0\u4f9b\u6807\u51c6\u63a5\u53e3\uff08\u5982scikit-learn\u517c\u5bb9\uff09</li>\n<li>\n<p>\u652f\u6301\u5e8f\u5217\u5316\u548ccheckpoint</p>\n</li>\n<li>\n<p>[ ] <strong>\u7814\u7a76\u5bfc\u5411\u529f\u80fd</strong></p>\n</li>\n<li>\u5b9e\u9a8c\u6027\u529f\u80fd\u7684\u5f00\u5173</li>\n<li>\u8be6\u7ec6\u7684\u8bca\u65ad\u8f93\u51fa</li>\n<li>\u652f\u6301\u65b0\u7b97\u6cd5\u7684\u5feb\u901f\u539f\u578b\u5f00\u53d1</li>\n</ul>\n<h3 id=\"_13\">\u6587\u6863\u8981\u6c42</h3>\n<ul>\n<li>[ ] <strong>\u7528\u6237\u6587\u6863</strong></li>\n<li>\u5feb\u901f\u5165\u95e8\u6307\u5357</li>\n<li>API\u53c2\u8003</li>\n<li>\n<p>\u5e38\u89c1\u95ee\u9898\u89e3\u7b54</p>\n</li>\n<li>\n<p>[ ] <strong>\u5f00\u53d1\u6587\u6863</strong></p>\n</li>\n<li>\u7b97\u6cd5\u8be6\u7ec6\u63cf\u8ff0</li>\n<li>\u5b9e\u73b0\u7ec6\u8282\u548c\u8bbe\u8ba1\u51b3\u7b56</li>\n<li>\n<p>\u8d21\u732e\u6307\u5357</p>\n</li>\n<li>\n<p>[ ] <strong>\u793a\u4f8b\u548c\u6559\u7a0b</strong></p>\n</li>\n<li>\u57fa\u7840\u4f7f\u7528\u793a\u4f8b</li>\n<li>\u9ad8\u7ea7\u7279\u6027\u6f14\u793a</li>\n<li>\u6027\u80fd\u8c03\u4f18\u6848\u4f8b</li>\n</ul>\n<p>\u901a\u8fc7\u7cfb\u7edf\u5730\u9075\u5faa\u8fd9\u4e2a\u68c0\u67e5\u6e05\u5355\uff0c\u53ef\u4ee5\u786e\u4fdd\u589e\u91cfHessian\u8ba1\u7b97\u7684\u5b9e\u73b0\u65e2\u9ad8\u6548\u53c8\u53ef\u9760\uff0c\u4e3a\u5927\u89c4\u6a21\u4f18\u5316\u95ee\u9898\u63d0\u4f9b\u5f3a\u6709\u529b\u7684\u5de5\u5177\u652f\u6301\u3002</p>"
  },
  "../README.md": {
    "hash": "0dd277522d44110a5796a61541c5de9f",
    "content": "<h1 id=\"_1\">\u9ad8\u7ea7\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u6559\u7a0b</h1>\n<h2 id=\"_2\">\u524d\u8a00</h2>\n<p>\u672c\u6559\u7a0b\u9762\u5411\u719f\u6089\u57fa\u7840\u77e9\u9635\u8ba1\u7b97\u7684\u7814\u7a76\u8005\u548cAI\u79d1\u5b66\u5bb6\uff0c\u6df1\u5165\u63a2\u8ba8\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u9ad8\u7ea7\u4e3b\u9898\u3002\u6211\u4eec\u4e0d\u4ec5\u5173\u6ce8\u7ecf\u5178\u7b97\u6cd5\uff0c\u66f4\u5f3a\u8c03\u5728\u73b0\u4ee3AI\u5e94\u7528\u4e2d\u5c1a\u672a\u5145\u5206\u7814\u7a76\u7684\u6570\u5b66\u95ee\u9898\u3002\u6bcf\u7ae0\u5305\u542b\u7406\u8bba\u5206\u6790\u3001\u5b9e\u8df5\u6280\u5de7\u3001\u5e38\u89c1\u9677\u9631\u4ee5\u53ca\u5927\u91cf\u4e60\u9898\u3002</p>\n<h2 id=\"_3\">\u76ee\u5f55</h2>\n<h3 id=\"_4\">\u7b2c\u4e00\u90e8\u5206\uff1a\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\u57fa\u7840</h3>\n<h4 id=\"1\"><a href=\"chapter1.md\">\u7b2c1\u7ae0\uff1a\u4e8c\u9636\u4f18\u5316\u7684\u7edf\u4e00\u6846\u67b6</a></h4>\n<ul>\n<li>Newton\u6cd5\u3001Gauss-Newton\u6cd5\u4e0eNatural Gradient\u7684\u6570\u5b66\u8054\u7cfb</li>\n<li>Fisher\u4fe1\u606f\u77e9\u9635\u4e0eHessian\u7684\u5173\u7cfb</li>\n<li>Trust Region\u65b9\u6cd5\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u590d\u5174</li>\n<li>\u978d\u70b9\u9003\u9038\u7684\u7406\u8bba\u4e0e\u5b9e\u8df5</li>\n</ul>\n<h4 id=\"2hessian\"><a href=\"chapter2.md\">\u7b2c2\u7ae0\uff1aHessian\u8fd1\u4f3c\u7684\u827a\u672f</a></h4>\n<ul>\n<li>\u4eceBFGS\u5230L-BFGS\uff1a\u6709\u9650\u5185\u5b58\u65b9\u6cd5\u7684\u6df1\u5165\u5256\u6790</li>\n<li>Hessian-vector product\u7684\u9ad8\u6548\u8ba1\u7b97</li>\n<li>\u8d1f\u66f2\u7387\u65b9\u5411\u7684\u68c0\u6d4b\u4e0e\u5229\u7528</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u4e0e\u6761\u4ef6\u6570\u63a7\u5236</li>\n</ul>\n<h4 id=\"3\"><a href=\"chapter3.md\">\u7b2c3\u7ae0\uff1a\u7ed3\u6784\u5316\u4e8c\u9636\u65b9\u6cd5</a></h4>\n<ul>\n<li>Kronecker\u56e0\u5b50\u5206\u89e3\uff1aK-FAC\u53ca\u5176\u53d8\u4f53</li>\n<li>Block\u5bf9\u89d2\u8fd1\u4f3c\uff1aShampoo\u7b97\u6cd5\u89e3\u6790</li>\n<li>\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784\u7684\u5229\u7528</li>\n<li>\u7a00\u758fHessian\u6a21\u5f0f\u7684\u81ea\u52a8\u53d1\u73b0</li>\n</ul>\n<h3 id=\"_5\">\u7b2c\u4e8c\u90e8\u5206\uff1a\u589e\u91cf\u4e0e\u5728\u7ebf\u7b97\u6cd5</h3>\n<h4 id=\"4hessian\"><a href=\"chapter4.md\">\u7b2c4\u7ae0\uff1a\u589e\u91cfHessian\u8ba1\u7b97</a></h4>\n<ul>\n<li>Woodbury\u77e9\u9635\u6052\u7b49\u5f0f\u7684\u9ad8\u7ea7\u5e94\u7528</li>\n<li>Block-wise\u66f4\u65b0\u7b56\u7565</li>\n<li>Sliding window\u6280\u672f</li>\n<li>\u4e0e\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u6df1\u5ea6\u8054\u7cfb</li>\n</ul>\n<h4 id=\"5schur\"><a href=\"chapter5.md\">\u7b2c5\u7ae0\uff1aSchur\u8865\u7684\u5999\u7528</a></h4>\n<ul>\n<li>\u5206\u5757\u77e9\u9635\u6c42\u9006\u7684\u9012\u5f52\u7b56\u7565</li>\n<li>\u5728\u5206\u5e03\u5f0f\u4f18\u5316\u4e2d\u7684\u5e94\u7528</li>\n<li>\u6761\u4ef6\u6570\u6539\u5584\u6280\u672f</li>\n<li>\u4e0e\u57df\u5206\u89e3\u65b9\u6cd5\u7684\u8054\u7cfb</li>\n</ul>\n<h3 id=\"_6\">\u7b2c\u4e09\u90e8\u5206\uff1a\u968f\u673a\u5316\u65b9\u6cd5</h3>\n<h4 id=\"6sketching\"><a href=\"chapter6.md\">\u7b2c6\u7ae0\uff1a\u77e9\u9635Sketching\u6280\u672f</a></h4>\n<ul>\n<li>Johnson-Lindenstrauss\u5f15\u7406\u7684\u5b9e\u7528\u5316</li>\n<li>CountSketch\u4e0e\u968f\u673a\u6295\u5f71</li>\n<li>Frequent Directions\u7b97\u6cd5</li>\n<li>\u5728\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h4 id=\"7\"><a href=\"chapter7.md\">\u7b2c7\u7ae0\uff1a\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570</a></h4>\n<ul>\n<li>\u968f\u673aSVD\u7684\u8bef\u5dee\u5206\u6790</li>\n<li>Nystr\u00f6m\u65b9\u6cd5\u7684\u73b0\u4ee3\u89c6\u89d2</li>\n<li>\u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</li>\n<li>\u91cf\u5b50\u542f\u53d1\u7684\u91c7\u6837\u7b56\u7565</li>\n</ul>\n<h3 id=\"_7\">\u7b2c\u56db\u90e8\u5206\uff1a\u5206\u5e03\u5f0f\u4e0e\u5e76\u884c\u8ba1\u7b97</h3>\n<h4 id=\"8\"><a href=\"chapter8.md\">\u7b2c8\u7ae0\uff1a\u5206\u5e03\u5f0f\u77e9\u9635\u8fd0\u7b97</a></h4>\n<ul>\n<li>\u901a\u4fe1\u9ad8\u6548\u7684\u77e9\u9635\u5206\u89e3</li>\n<li>Gossip\u7b97\u6cd5\u7684\u6536\u655b\u6027\u5206\u6790</li>\n<li>\u5f02\u6b65\u66f4\u65b0\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1</li>\n<li>\u62dc\u5360\u5ead\u9c81\u68d2\u6027\u8bbe\u8ba1</li>\n</ul>\n<h4 id=\"9\"><a href=\"chapter9.md\">\u7b2c9\u7ae0\uff1a\u5f02\u6b65\u4f18\u5316\u7684\u6570\u5b66\u57fa\u7840</a></h4>\n<ul>\n<li>\u5ef6\u8fdf\u68af\u5ea6\u7684\u8bef\u5dee\u7d2f\u79ef\u5206\u6790</li>\n<li>Lock-free\u7b97\u6cd5\u8bbe\u8ba1</li>\n<li>\u5c40\u90e8\u4e00\u81f4\u6027\u4e0e\u5168\u5c40\u6536\u655b</li>\n<li>\u786c\u4ef6\u611f\u77e5\u7684\u7b97\u6cd5\u8c03\u4f18</li>\n</ul>\n<h3 id=\"_8\">\u7b2c\u4e94\u90e8\u5206\uff1a\u6d41\u5f62\u4f18\u5316</h3>\n<h4 id=\"10riemannian\"><a href=\"chapter10.md\">\u7b2c10\u7ae0\uff1aRiemannian\u4f18\u5316\u57fa\u7840</a></h4>\n<ul>\n<li>\u77e9\u9635\u6d41\u5f62\u4e0a\u7684\u51e0\u4f55\u7ed3\u6784</li>\n<li>Riemannian\u68af\u5ea6\u4e0eHessian</li>\n<li>\u56de\u7f29\u4e0e\u5411\u91cf\u4f20\u8f93</li>\n<li>\u5728\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h4 id=\"11\"><a href=\"chapter11.md\">\u7b2c11\u7ae0\uff1a\u6d41\u5f62\u9884\u6761\u4ef6\u6280\u672f</a></h4>\n<ul>\n<li>\u6d41\u5f62\u4e0a\u7684Natural Gradient</li>\n<li>Riemannian BFGS\u65b9\u6cd5</li>\n<li>\u51e0\u4f55\u611f\u77e5\u7684Trust Region</li>\n<li>\u4e0e\u6b27\u6c0f\u7a7a\u95f4\u65b9\u6cd5\u7684\u6027\u80fd\u5bf9\u6bd4</li>\n</ul>\n<h3 id=\"_9\">\u7b2c\u516d\u90e8\u5206\uff1a\u7279\u6b8a\u7ed3\u6784\u5229\u7528</h3>\n<h4 id=\"12\"><a href=\"chapter12.md\">\u7b2c12\u7ae0\uff1a\u7ed3\u6784\u5316\u77e9\u9635\u7684\u5feb\u901f\u7b97\u6cd5</a></h4>\n<ul>\n<li>Toeplitz\u4e0e\u5faa\u73af\u77e9\u9635\u7684FFT\u6280\u5de7</li>\n<li>Kronecker\u79ef\u7684\u9ad8\u6548\u8fd0\u7b97</li>\n<li>\u5206\u5c42\u77e9\u9635\uff08H-matrices\uff09</li>\n<li>\u5728\u5377\u79ef\u7f51\u7edc\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h4 id=\"13\"><a href=\"chapter13.md\">\u7b2c13\u7ae0\uff1a\u52a8\u6001\u4f4e\u79e9\u8fd1\u4f3c</a></h4>\n<ul>\n<li>\u6d41\u5f0fSVD\u66f4\u65b0</li>\n<li>\u81ea\u9002\u5e94\u79e9\u9009\u62e9</li>\n<li>\u5728\u7ebf\u77e9\u9635\u8865\u5168</li>\n<li>\u4e0e\u795e\u7ecf\u7f51\u7edc\u526a\u679d\u7684\u8054\u7cfb</li>\n</ul>\n<h3 id=\"_10\">\u7b2c\u4e03\u90e8\u5206\uff1a\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u77e9\u9635\u8ba1\u7b97</h3>\n<h4 id=\"14\"><a href=\"chapter14.md\">\u7b2c14\u7ae0\uff1a\u5927\u89c4\u6a21\u534f\u540c\u8fc7\u6ee4\u7684\u77e9\u9635\u6280\u672f</a></h4>\n<ul>\n<li>\u9690\u5f0f\u53cd\u9988\u77e9\u9635\u5206\u89e3\u7684\u52a0\u6743\u7b56\u7565</li>\n<li>ALS-WR\u7b97\u6cd5\u7684\u5e76\u884c\u5316\u4e0e\u6570\u503c\u4f18\u5316</li>\n<li>\u8d1f\u91c7\u6837\u7684\u6570\u5b66\u539f\u7406\u4e0e\u504f\u5dee\u6821\u6b63</li>\n<li>\u7f6e\u4fe1\u5ea6\u52a0\u6743\u7684\u7406\u8bba\u57fa\u7840</li>\n</ul>\n<h4 id=\"15\"><a href=\"chapter15.md\">\u7b2c15\u7ae0\uff1a\u5b9e\u65f6\u63a8\u8350\u7684\u589e\u91cf\u77e9\u9635\u65b9\u6cd5</a></h4>\n<ul>\n<li>\u5728\u7ebf\u77e9\u9635\u5206\u89e3\u7684\u9057\u5fd8\u673a\u5236</li>\n<li>\u7528\u6237/\u7269\u54c1\u5d4c\u5165\u7684\u5feb\u901f\u66f4\u65b0</li>\n<li>\u51b7\u542f\u52a8\u95ee\u9898\u7684\u77e9\u9635\u8865\u5168\u89c6\u89d2</li>\n<li>\u65f6\u5e8f\u52a8\u6001\u7684\u77e9\u9635\u5efa\u6a21</li>\n</ul>\n<h4 id=\"16\"><a href=\"chapter16.md\">\u7b2c16\u7ae0\uff1a\u591a\u6a21\u6001\u63a8\u8350\u7684\u5f20\u91cf\u5206\u89e3</a></h4>\n<ul>\n<li>\u9ad8\u9636\u4ea4\u4e92\u7684\u5f20\u91cf\u5efa\u6a21</li>\n<li>CP\u5206\u89e3\u4e0eTucker\u5206\u89e3\u7684\u53ef\u6269\u5c55\u5b9e\u73b0</li>\n<li>\u7a00\u758f\u5f20\u91cf\u7684\u9ad8\u6548\u5b58\u50a8\u4e0e\u8ba1\u7b97</li>\n<li>\u8de8\u57df\u63a8\u8350\u7684\u8026\u5408\u77e9\u9635\u5206\u89e3</li>\n</ul>\n<h3 id=\"_11\">\u7b2c\u516b\u90e8\u5206\uff1a\u524d\u6cbf\u4e3b\u9898</h3>\n<h4 id=\"17\"><a href=\"chapter17.md\">\u7b2c17\u7ae0\uff1a\u9690\u5f0f\u5fae\u5206\u4e0e\u53cc\u5c42\u4f18\u5316</a></h4>\n<ul>\n<li>\u5927\u89c4\u6a21\u7ebf\u6027\u7cfb\u7edf\u7684\u9690\u5f0f\u6c42\u89e3</li>\n<li>\u81ea\u52a8\u5fae\u5206\u7684\u9ad8\u7ea7\u6280\u5de7</li>\n<li>\u5728\u5143\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u6311\u6218</li>\n</ul>\n<h4 id=\"18\"><a href=\"chapter18.md\">\u7b2c18\u7ae0\uff1a\u91cf\u5b50\u542f\u53d1\u7684\u77e9\u9635\u7b97\u6cd5</a></h4>\n<ul>\n<li>\u5f20\u91cf\u7f51\u7edc\u65b9\u6cd5</li>\n<li>\u91cf\u5b50\u5947\u5f02\u503c\u53d8\u6362</li>\n<li>\u7ecf\u5178\u6a21\u62df\u7684\u8ba1\u7b97\u590d\u6742\u5ea6</li>\n<li>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u6f5c\u529b</li>\n</ul>\n<h2 id=\"_12\">\u9644\u5f55</h2>\n<h3 id=\"a\"><a href=\"chapter19.md\">\u9644\u5f55A\uff1a\u6570\u503c\u7a33\u5b9a\u6027\u901f\u67e5\u8868</a></h3>\n<h3 id=\"b\"><a href=\"chapter20.md\">\u9644\u5f55B\uff1a\u6027\u80fd\u8c03\u4f18\u68c0\u67e5\u6e05\u5355</a></h3>\n<h3 id=\"c\"><a href=\"chapter21.md\">\u9644\u5f55C\uff1a\u5e38\u7528\u77e9\u9635\u6052\u7b49\u5f0f</a></h3>\n<h2 id=\"_13\">\u4f7f\u7528\u8bf4\u660e</h2>\n<ul>\n<li>\u6bcf\u7ae0\u72ec\u7acb\u6210\u6587\uff0c\u53ef\u6309\u9700\u9605\u8bfb</li>\n<li>\u4e60\u9898\u7b54\u6848\u9ed8\u8ba4\u6298\u53e0\uff0c\u9f13\u52b1\u72ec\u7acb\u601d\u8003</li>\n<li>\"Gotchas\"\u90e8\u5206\u603b\u7ed3\u5b9e\u8df5\u4e2d\u7684\u5e38\u89c1\u9677\u9631</li>\n<li>\"\u7814\u7a76\u65b9\u5411\"\u6307\u51fa\u503c\u5f97\u6df1\u5165\u63a2\u7d22\u7684\u5f00\u653e\u95ee\u9898</li>\n</ul>\n<h2 id=\"_14\">\u7b26\u53f7\u7ea6\u5b9a</h2>\n<ul>\n<li>$\\mathbf{A}, \\mathbf{B}$\uff1a\u77e9\u9635</li>\n<li>$\\mathbf{x}, \\mathbf{y}$\uff1a\u5411\u91cf</li>\n<li>$\\lambda_i$\uff1a\u7279\u5f81\u503c</li>\n<li>$\\kappa(\\mathbf{A})$\uff1a\u6761\u4ef6\u6570</li>\n<li>$\\mathcal{O}(\\cdot)$\uff1a\u8ba1\u7b97\u590d\u6742\u5ea6</li>\n<li>$\\mathbb{E}[\\cdot]$\uff1a\u671f\u671b</li>\n<li>$|\\cdot|_F$\uff1aFrobenius\u8303\u6570</li>\n<li>$\\otimes$\uff1aKronecker\u79ef</li>\n<li>$\\odot$\uff1aHadamard\u79ef</li>\n</ul>"
  },
  "../chapter9.md": {
    "hash": "a5bb72ff8a9afcc4339944138829d4f1",
    "content": "<h1 id=\"9\">\u7b2c9\u7ae0\uff1a\u5f02\u6b65\u4f18\u5316\u7684\u6570\u5b66\u57fa\u7840</h1>\n<p>\u5728\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u548c\u6df1\u5ea6\u5b66\u4e60\u5e94\u7528\u4e2d\uff0c\u6570\u636e\u548c\u6a21\u578b\u7684\u89c4\u6a21\u5f80\u5f80\u8d85\u51fa\u5355\u673a\u5904\u7406\u80fd\u529b\uff0c\u5206\u5e03\u5f0f\u8ba1\u7b97\u6210\u4e3a\u5fc5\u7136\u9009\u62e9\u3002\u7136\u800c\uff0c\u4f20\u7edf\u7684\u540c\u6b65\u4f18\u5316\u7b97\u6cd5\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u9762\u4e34\u4e25\u91cd\u7684\u6027\u80fd\u74f6\u9888\uff1a\u6162\u8282\u70b9\u4f1a\u62d6\u7d2f\u6574\u4f53\u8fdb\u5ea6\uff0c\u901a\u4fe1\u5f00\u9500\u968f\u8282\u70b9\u6570\u7ebf\u6027\u589e\u957f\u3002\u5f02\u6b65\u4f18\u5316\u901a\u8fc7\u653e\u677e\u540c\u6b65\u8981\u6c42\uff0c\u5141\u8bb8\u4e0d\u540c\u8ba1\u7b97\u8282\u70b9\u4ee5\u5404\u81ea\u7684\u901f\u5ea6\u63a8\u8fdb\uff0c\u4ece\u800c\u5927\u5e45\u63d0\u5347\u7cfb\u7edf\u541e\u5410\u91cf\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5f02\u6b65\u4f18\u5316\u7684\u6570\u5b66\u57fa\u7840\uff0c\u5206\u6790\u5176\u6536\u655b\u6027\u4fdd\u8bc1\uff0c\u5e76\u8ba8\u8bba\u5b9e\u9645\u7cfb\u7edf\u4e2d\u7684\u7b97\u6cd5\u8bbe\u8ba1\u4e0e\u4f18\u5316\u6280\u5de7\u3002</p>\n<h2 id=\"91\">9.1 \u5f02\u6b65\u4f18\u5316\u7684\u57fa\u672c\u6846\u67b6</h2>\n<h3 id=\"911\">9.1.1 \u4ece\u540c\u6b65\u5230\u5f02\u6b65\uff1a\u52a8\u673a\u4e0e\u6311\u6218</h3>\n<p>\u8003\u8651\u6807\u51c6\u7684\u968f\u673a\u68af\u5ea6\u4e0b\u964d\uff08SGD\uff09\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u7684\u5b9e\u73b0\u3002\u5728\u540c\u6b65\u6a21\u5f0f\u4e0b\uff0c\u53c2\u6570\u66f4\u65b0\u9075\u5faa\uff1a</p>\n<p>$$\\mathbf{w}_{t+1} = \\mathbf{w}_t - \\eta_t \\frac{1}{P} \\sum_{p=1}^P \\nabla f_p(\\mathbf{w}_t)$$\n\u5176\u4e2d$P$\u662f\u5de5\u4f5c\u8282\u70b9\u6570\uff0c\u6bcf\u4e2a\u8282\u70b9\u8ba1\u7b97\u5c40\u90e8\u68af\u5ea6$\\nabla f_p(\\mathbf{w}_t)$\u3002\u540c\u6b65\u5c4f\u969c\u786e\u4fdd\u6240\u6709\u8282\u70b9\u4f7f\u7528\u76f8\u540c\u7684\u53c2\u6570\u7248\u672c\uff0c\u4f46\u4e5f\u5e26\u6765\u4e86\u663e\u8457\u7684\u7b49\u5f85\u65f6\u95f4\u3002</p>\n<p><strong>\u540c\u6b65\u7684\u6027\u80fd\u74f6\u9888\u5206\u6790</strong>\uff1a\u8bbe\u8282\u70b9$p$\u7684\u8ba1\u7b97\u65f6\u95f4\u4e3a$T_p$\uff0c\u5219\u540c\u6b65\u8fed\u4ee3\u65f6\u95f4\u4e3a\uff1a\n$$T_{\\text{sync}} = \\max_{p=1,...,P} T_p + T_{\\text{comm}}$$\n\u5f53\u8282\u70b9\u6027\u80fd\u5f02\u6784\u6216\u5b58\u5728stragglers\u65f6\uff0c$\\max T_p \\gg \\mathbb{E}[T_p]$\uff0c\u5bfc\u81f4\u4e25\u91cd\u7684\u8d44\u6e90\u6d6a\u8d39\u3002</p>\n<p><strong>Straggler\u6548\u5e94\u7684\u5b9a\u91cf\u5206\u6790</strong>\uff1a\u5047\u8bbe\u8ba1\u7b97\u65f6\u95f4$T_p$\u72ec\u7acb\u540c\u5206\u5e03\uff0c\u5bf9\u4e8e\u5e38\u89c1\u5206\u5e03\u6709\uff1a</p>\n<ul>\n<li><strong>\u6307\u6570\u5206\u5e03</strong>\uff1a$\\mathbb{E}[\\max_p T_p] = \\mathbb{E}[T_p] \\cdot H_P \\approx \\mathbb{E}[T_p] \\cdot \\log P$\uff0c\u5176\u4e2d$H_P$\u662f\u7b2c$P$\u4e2a\u8c03\u548c\u6570</li>\n<li><strong>Weibull\u5206\u5e03</strong>\uff1a$\\mathbb{E}[\\max_p T_p] = \\Gamma(1 + 1/k) \\cdot (\\log P)^{1/k}$\uff0c$k$\u662f\u5f62\u72b6\u53c2\u6570</li>\n<li><strong>\u7ecf\u9a8c\u89c2\u5bdf</strong>\uff1a\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\uff0c\u5c3e\u90e8\u8282\u70b9\uff08\u6700\u61625%\uff09\u7684\u8fd0\u884c\u65f6\u95f4\u53ef\u80fd\u662f\u4e2d\u4f4d\u6570\u768410-100\u500d</li>\n</ul>\n<p>\u5f02\u6b65\u6a21\u5f0f\u6253\u7834\u8fd9\u4e00\u9650\u5236\uff0c\u5141\u8bb8\u8282\u70b9\u4f7f\u7528\u53ef\u80fd\u8fc7\u65f6\u7684\u53c2\u6570\u7248\u672c\uff1a\n$$\\mathbf{w}_{t+1} = \\mathbf{w}_t - \\eta_t \\nabla f_{i_t}(\\mathbf{w}_{t-\\tau_{i_t,t}})$$\n\u8fd9\u91cc$\\tau_{i_t,t}$\u8868\u793a\u8282\u70b9$i_t$\u5728\u65f6\u523b$t$\u4f7f\u7528\u7684\u53c2\u6570\u7248\u672c\u7684\u5ef6\u8fdf\u3002</p>\n<p><strong>\u5f02\u6b65\u66f4\u65b0\u7684\u7ec6\u7c92\u5ea6\u6a21\u578b</strong>\uff1a\u66f4\u7cbe\u786e\u5730\uff0c\u5f02\u6b65\u66f4\u65b0\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a\n$$\\mathbf{w}_{t+1} = \\mathbf{w}_t - \\eta_t \\sum_{i \\in \\mathcal{A}_t} \\nabla f_i(\\mathbf{w}_{s_{i,t}})$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathcal{A}_t$\uff1a\u65f6\u523b$t$\u5b8c\u6210\u8ba1\u7b97\u7684\u8282\u70b9\u96c6\u5408\uff08\u968f\u673a\uff09</li>\n<li>$s_{i,t}$\uff1a\u8282\u70b9$i$\u8bfb\u53d6\u53c2\u6570\u7684\u65f6\u523b\uff0c\u6ee1\u8db3$s_{i,t} \\leq t - \\tau_{i,t}$</li>\n<li>$|\\mathcal{A}_t|$\uff1a\u53ef\u53d8\u7684\uff0c\u53cd\u6620\u4e86\u7cfb\u7edf\u7684\u5f02\u6b65\u6027</li>\n</ul>\n<p><strong>\u5f02\u6b65\u7684\u541e\u5410\u91cf\u4f18\u52bf</strong>\uff1a\u5047\u8bbe\u8282\u70b9\u8ba1\u7b97\u65f6\u95f4\u670d\u4ece\u5206\u5e03$T_p \\sim \\mathcal{D}$\uff0c\u5219\u5f02\u6b65\u6a21\u5f0f\u7684\u5e73\u5747\u541e\u5410\u91cf\u4e3a\uff1a\n$$\\text{Throughput}_{\\text{async}} = \\frac{P}{\\mathbb{E}[T_p]} \\quad \\text{vs} \\quad \\text{Throughput}_{\\text{sync}} = \\frac{P}{\\mathbb{E}[\\max_p T_p]}$$\n<strong>\u7cbe\u786e\u7684\u52a0\u901f\u6bd4\u5206\u6790</strong>\uff1a\u5b9a\u4e49\u540c\u6b65\u6548\u7387\u635f\u5931\u56e0\u5b50\uff1a\n$$\\rho = \\frac{\\mathbb{E}[\\max_p T_p]}{\\mathbb{E}[T_p]} - 1$$\n\u5219\u5f02\u6b65\u76f8\u5bf9\u4e8e\u540c\u6b65\u7684\u7406\u60f3\u52a0\u901f\u6bd4\u4e3a\uff1a\n$$S_{\\text{ideal}} = 1 + \\rho$$\n\u5b9e\u9645\u52a0\u901f\u6bd4\u9700\u8981\u8003\u8651\u5ef6\u8fdf\u5e26\u6765\u7684\u6536\u655b\u901f\u5ea6\u4e0b\u964d\uff1a\n$$S_{\\text{actual}} = \\frac{1 + \\rho}{1 + \\alpha \\cdot \\mathbb{E}[\\tau]}$$\n\u5176\u4e2d$\\alpha \\in [0,1]$\u53cd\u6620\u4e86\u7b97\u6cd5\u5bf9\u5ef6\u8fdf\u7684\u654f\u611f\u5ea6\u3002</p>\n<p><strong>\u5b9e\u4f8b\u5206\u6790</strong>\uff1a\u8003\u8651$P=100$\u4e2a\u8282\u70b9\uff0c\u8ba1\u7b97\u65f6\u95f4\u670d\u4ece\u5bf9\u6570\u6b63\u6001\u5206\u5e03$\\log T_p \\sim \\mathcal{N}(\\mu, \\sigma^2)$\u3002\u5f53$\\sigma = 1$\u65f6\uff0c\u5f02\u6b65\u76f8\u5bf9\u4e8e\u540c\u6b65\u7684\u52a0\u901f\u6bd4\u53ef\u8fbe3-5\u500d\u3002</p>\n<p><strong>\u6df1\u5165\u6848\u4f8b\u7814\u7a76\uff1aGoogle\u7684DistBelief\u7cfb\u7edf</strong></p>\n<ul>\n<li>\u89c4\u6a21\uff1a10,000+\u8282\u70b9\u7684\u53c2\u6570\u670d\u52a1\u5668</li>\n<li>Straggler\u6bd4\u4f8b\uff1a\u7ea65%\u7684\u8282\u70b9\u5ef6\u8fdf\u8d85\u8fc7\u4e2d\u4f4d\u6570\u768410\u500d</li>\n<li>\u5f02\u6b65\u6536\u76ca\uff1a\u6574\u4f53\u8bad\u7ec3\u65f6\u95f4\u51cf\u5c1112\u500d</li>\n<li>\u5173\u952e\u6280\u672f\uff1a\u5907\u4efd\u4efb\u52a1\u3001\u6162\u8282\u70b9\u68c0\u6d4b\u3001\u52a8\u6001\u8d1f\u8f7d\u5747\u8861</li>\n</ul>\n<p><strong>\u5f02\u6b65\u7684\u4ee3\u4ef7\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li><strong>\u6536\u655b\u7cbe\u5ea6\u635f\u5931</strong>\uff1a\u5f02\u6b65\u53ef\u80fd\u6536\u655b\u5230\u6b21\u4f18\u89e3\uff0c\u7279\u522b\u662f\u5728\u975e\u51f8\u4f18\u5316\u4e2d</li>\n<li><strong>\u8d85\u53c2\u6570\u654f\u611f\u6027</strong>\uff1a\u5b66\u4e60\u7387\u9700\u8981\u66f4\u4ed4\u7ec6\u7684\u8c03\u6574</li>\n<li><strong>\u8c03\u8bd5\u56f0\u96be</strong>\uff1a\u975e\u786e\u5b9a\u6027\u884c\u4e3a\u4f7f\u5f97bug\u590d\u73b0\u56f0\u96be</li>\n<li><strong>\u5185\u5b58\u4e00\u81f4\u6027\u5f00\u9500</strong>\uff1a\u539f\u5b50\u64cd\u4f5c\u548c\u5185\u5b58\u5c4f\u969c\u7684\u989d\u5916\u5f00\u9500</li>\n</ol>\n<h3 id=\"912\">9.1.2 \u5ef6\u8fdf\u6a21\u578b\u7684\u5206\u7c7b</h3>\n<p><strong>\u6709\u754c\u5ef6\u8fdf\u6a21\u578b</strong>\uff1a\u5047\u8bbe\u5b58\u5728\u6700\u5927\u5ef6\u8fdf$\\tau_{\\max}$\uff0c\u5373$\\tau_{i,t} \\leq \\tau_{\\max}$\u5bf9\u6240\u6709$i,t$\u6210\u7acb\u3002\u8fd9\u662f\u6700\u5e38\u89c1\u7684\u7406\u8bba\u5206\u6790\u6846\u67b6\u3002</p>\n<p>\u5f62\u5f0f\u5316\u5b9a\u4e49\uff1a\u5b58\u5728\u5e38\u6570$\\tau_{\\max}$\u4f7f\u5f97\u5bf9\u4efb\u610f\u65f6\u523b$t$\u548c\u8282\u70b9$i$\uff1a\n$$t - \\tau_{\\max} \\leq s_{i,t} \\leq t$$\n\u5176\u4e2d$s_{i,t}$\u662f\u8282\u70b9$i$\u5728\u65f6\u523b$t$\u8bfb\u53d6\u7684\u53c2\u6570\u7248\u672c\u3002</p>\n<p><strong>\u6709\u754c\u5ef6\u8fdf\u7684\u7ec6\u5316\u5206\u7c7b</strong>\uff1a</p>\n<ol>\n<li><strong>\u5747\u5300\u6709\u754c\u5ef6\u8fdf</strong>\uff1a\u6240\u6709\u8282\u70b9\u5171\u4eab\u76f8\u540c\u7684\u5ef6\u8fdf\u754c$\\tau_{\\max}$</li>\n<li><strong>\u5f02\u6784\u6709\u754c\u5ef6\u8fdf</strong>\uff1a\u8282\u70b9$i$\u6709\u81ea\u5df1\u7684\u5ef6\u8fdf\u754c$\\tau_{\\max}^{(i)}$</li>\n<li><strong>\u65f6\u53d8\u6709\u754c\u5ef6\u8fdf</strong>\uff1a$\\tau_{\\max}(t)$\u968f\u65f6\u95f4\u53d8\u5316\u4f46\u59cb\u7ec8\u6709\u754c</li>\n</ol>\n<p><strong>\u5ef6\u8fdf\u754c\u7684\u4f30\u8ba1\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li><strong>\u4fdd\u5b88\u4f30\u8ba1</strong>\uff1a$\\tau_{\\max} = \\max_{i,t \\leq T_0} \\tau_{i,t}$\uff0c\u57fa\u4e8e\u5386\u53f2\u89c2\u5bdf</li>\n<li><strong>\u6982\u7387\u754c</strong>\uff1a$P(\\tau &gt; \\tau_{\\max}) \\leq \\delta$\uff0c\u5141\u8bb8\u5c0f\u6982\u7387\u8fdd\u53cd</li>\n<li><strong>\u81ea\u9002\u5e94\u754c</strong>\uff1a\u4f7f\u7528\u6ed1\u52a8\u7a97\u53e3\u52a8\u6001\u66f4\u65b0$\\tau_{\\max}$</li>\n</ul>\n<p><strong>\u6982\u7387\u5ef6\u8fdf\u6a21\u578b</strong>\uff1a\u5c06\u5ef6\u8fdf\u5efa\u6a21\u4e3a\u968f\u673a\u53d8\u91cf\uff0c\u5982\u6cca\u677e\u5206\u5e03\u6216\u51e0\u4f55\u5206\u5e03\u3002\u66f4\u8d34\u8fd1\u5b9e\u9645\u7cfb\u7edf\u884c\u4e3a\u3002</p>\n<p>\u5e38\u89c1\u5206\u5e03\u5305\u62ec\uff1a</p>\n<ul>\n<li><strong>\u6307\u6570\u5206\u5e03</strong>\uff1a$P(\\tau &gt; t) = e^{-\\lambda t}$\uff0c\u9002\u7528\u4e8e\u5185\u5b58\u4e00\u81f4\u7684\u7cfb\u7edf</li>\n<li><strong>\u5e15\u7d2f\u6258\u5206\u5e03</strong>\uff1a$P(\\tau &gt; t) = (t/t_{\\min})^{-\\alpha}$\uff0c\u9002\u7528\u4e8e\u5b58\u5728\u957f\u5c3e\u5ef6\u8fdf\u7684\u7f51\u7edc\u7cfb\u7edf</li>\n<li><strong>\u6df7\u5408\u5206\u5e03</strong>\uff1a$P(\\tau) = p \\cdot \\text{Exp}(\\lambda_1) + (1-p) \\cdot \\text{Exp}(\\lambda_2)$\uff0c\u5efa\u6a21\u5feb\u6162\u4e24\u7c7b\u8282\u70b9</li>\n</ul>\n<p><strong>\u5ef6\u8fdf\u5206\u5e03\u7684\u77e9\u7279\u6027</strong>\uff1a</p>\n<ul>\n<li><strong>\u671f\u671b\u5ef6\u8fdf</strong>\uff1a$\\mathbb{E}[\\tau] = \\int_0^\\infty P(\\tau &gt; t) dt$</li>\n<li><strong>\u5ef6\u8fdf\u65b9\u5dee</strong>\uff1a$\\text{Var}(\\tau) = \\mathbb{E}[\\tau^2] - (\\mathbb{E}[\\tau])^2$</li>\n<li><strong>\u5c3e\u90e8\u884c\u4e3a</strong>\uff1a$\\lim_{t \\to \\infty} t^\\alpha P(\\tau &gt; t)$\uff0c\u523b\u753b\u6781\u7aef\u5ef6\u8fdf</li>\n</ul>\n<p><strong>\u57fa\u4e8e\u6392\u961f\u8bba\u7684\u5ef6\u8fdf\u5efa\u6a21</strong>\uff1a\n\u8003\u8651\u53c2\u6570\u670d\u52a1\u5668\u4f5c\u4e3aM/M/1\u961f\u5217\uff1a</p>\n<ul>\n<li>\u5230\u8fbe\u7387\uff1a$\\lambda$\uff08\u68af\u5ea6\u66f4\u65b0\u8bf7\u6c42\uff09</li>\n<li>\u670d\u52a1\u7387\uff1a$\\mu$\uff08\u53c2\u6570\u66f4\u65b0\u5904\u7406\uff09</li>\n<li>\u5e73\u5747\u5ef6\u8fdf\uff1a$\\mathbb{E}[\\tau] = \\frac{1}{\\mu - \\lambda}$</li>\n<li>\u5ef6\u8fdf\u5206\u5e03\uff1a$P(\\tau &gt; t) = e^{-(\\mu-\\lambda)t}$</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u5ef6\u8fdf\u6a21\u578b</strong>\uff1a\u5ef6\u8fdf\u4f9d\u8d56\u4e8e\u7cfb\u7edf\u72b6\u6001\uff0c\u5982\u7f51\u7edc\u62e5\u585e\u6216\u8ba1\u7b97\u8d1f\u8f7d\u3002\u5206\u6790\u66f4\u52a0\u590d\u6742\u4f46\u66f4\u5b9e\u7528\u3002</p>\n<p>\u72b6\u6001\u4f9d\u8d56\u7684\u5ef6\u8fdf\u53ef\u5efa\u6a21\u4e3a\u9a6c\u5c14\u53ef\u592b\u8fc7\u7a0b\uff1a\n$$P(\\tau_{t+1} = j | \\tau_t = i, S_t) = P_{ij}(S_t)$$\n\u5176\u4e2d$S_t$\u662f\u7cfb\u7edf\u72b6\u6001\uff08\u5982\u961f\u5217\u957f\u5ea6\u3001\u7f51\u7edc\u62e5\u585e\u5ea6\u7b49\uff09\u3002</p>\n<p><strong>\u5177\u4f53\u7684\u72b6\u6001\u4f9d\u8d56\u6a21\u578b</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8d1f\u8f7d\u4f9d\u8d56\u6a21\u578b</strong>\uff1a\n$$\\tau(t) = \\tau_0 \\cdot (1 + \\beta \\cdot \\text{Load}(t))$$\n\u5176\u4e2d$\\text{Load}(t) = |\\mathcal{A}_t|/P$\u662f\u6d3b\u8dc3\u8282\u70b9\u6bd4\u4f8b</p>\n</li>\n<li>\n<p><strong>\u62e5\u585e\u907f\u514d\u6a21\u578b</strong>\uff1a\n$$\\tau(t) = \\begin{cases}\n   \\tau_{\\min} &amp; \\text{if } Q(t) &lt; Q_{\\text{thresh}} \\\n   \\tau_{\\min} \\cdot e^{\\gamma(Q(t) - Q_{\\text{thresh}})} &amp; \\text{otherwise}\n   \\end{cases}$$\n\u5176\u4e2d$Q(t)$\u662f\u961f\u5217\u957f\u5ea6</p>\n</li>\n<li>\n<p><strong>\u5386\u53f2\u611f\u77e5\u6a21\u578b</strong>\uff1a\n$$\\tau(t) = \\alpha \\tau(t-1) + (1-\\alpha) \\tau_{\\text{observed}}(t)$$\n\u4f7f\u7528\u6307\u6570\u79fb\u52a8\u5e73\u5747\u5e73\u6ed1\u5ef6\u8fdf\u4f30\u8ba1</p>\n</li>\n</ol>\n<p><strong>\u603b\u5ef6\u8fdf\u5206\u89e3</strong>\uff1a\u5b9e\u9645\u7cfb\u7edf\u4e2d\u7684\u603b\u5ef6\u8fdf\u53ef\u5206\u89e3\u4e3a\u591a\u4e2a\u7ec4\u6210\u90e8\u5206\uff1a\n$$\\tau_{\\text{total}} = \\tau_{\\text{comp}} + \\tau_{\\text{queue}} + \\tau_{\\text{network}} + \\tau_{\\text{sync}}$$\n\u6bcf\u4e2a\u90e8\u5206\u6709\u4e0d\u540c\u7684\u7edf\u8ba1\u7279\u6027\u548c\u4f18\u5316\u65b9\u6cd5\u3002</p>\n<p><strong>\u5ef6\u8fdf\u7ec4\u6210\u7684\u8be6\u7ec6\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8ba1\u7b97\u5ef6\u8fdf</strong>$\\tau_{\\text{comp}}$\uff1a\n   - \u4f9d\u8d56\u4e8e\u6279\u5927\u5c0f\u3001\u6a21\u578b\u590d\u6742\u5ea6\u3001\u786c\u4ef6\u6027\u80fd\n   - \u4f18\u5316\u65b9\u6cd5\uff1a\u7b97\u5b50\u878d\u5408\u3001\u6df7\u5408\u7cbe\u5ea6\u3001\u6a21\u578b\u526a\u679d</p>\n</li>\n<li>\n<p><strong>\u6392\u961f\u5ef6\u8fdf</strong>$\\tau_{\\text{queue}}$\uff1a\n   - \u53d7\u7cfb\u7edf\u8d1f\u8f7d\u548c\u8c03\u5ea6\u7b56\u7565\u5f71\u54cd\n   - \u4f18\u5316\u65b9\u6cd5\uff1a\u4f18\u5148\u7ea7\u961f\u5217\u3001\u5de5\u4f5c\u7a83\u53d6\u3001\u8d1f\u8f7d\u5747\u8861</p>\n</li>\n<li>\n<p><strong>\u7f51\u7edc\u5ef6\u8fdf</strong>$\\tau_{\\text{network}}$\uff1a\n   - \u5305\u542b\u4f20\u8f93\u5ef6\u8fdf\u548c\u4f20\u64ad\u5ef6\u8fdf\n   - \u4f18\u5316\u65b9\u6cd5\uff1a\u68af\u5ea6\u538b\u7f29\u3001\u5206\u5c42\u901a\u4fe1\u3001\u62d3\u6251\u611f\u77e5\u8def\u7531</p>\n</li>\n<li>\n<p><strong>\u540c\u6b65\u5ef6\u8fdf</strong>$\\tau_{\\text{sync}}$\uff1a\n   - \u5185\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u548c\u9501\u7ade\u4e89\n   - \u4f18\u5316\u65b9\u6cd5\uff1a\u65e0\u9501\u7b97\u6cd5\u3001\u653e\u677e\u4e00\u81f4\u6027\u3001\u6279\u91cf\u540c\u6b65</p>\n</li>\n</ol>\n<p><strong>\u5ef6\u8fdf\u7684\u76f8\u5173\u6027\u7ed3\u6784</strong>\uff1a\n\u5b9e\u9645\u7cfb\u7edf\u4e2d\uff0c\u4e0d\u540c\u8282\u70b9\u7684\u5ef6\u8fdf\u5f80\u5f80\u76f8\u5173\uff1a\n$$\\text{Corr}(\\tau_i, \\tau_j) = \\rho_{ij}$$\n\u76f8\u5173\u6027\u6765\u6e90\uff1a</p>\n<ul>\n<li><strong>\u7a7a\u95f4\u76f8\u5173</strong>\uff1a\u540c\u4e00\u673a\u67b6/\u6570\u636e\u4e2d\u5fc3\u7684\u8282\u70b9</li>\n<li><strong>\u65f6\u95f4\u76f8\u5173</strong>\uff1a\u7f51\u7edc\u62e5\u585e\u7684\u6301\u7eed\u6027</li>\n<li><strong>\u8d1f\u8f7d\u76f8\u5173</strong>\uff1a\u5171\u4eab\u8d44\u6e90\u7684\u7ade\u4e89</li>\n</ul>\n<p>\u8fd9\u79cd\u76f8\u5173\u6027\u5bf9\u7b97\u6cd5\u8bbe\u8ba1\u6709\u91cd\u8981\u5f71\u54cd\uff0c\u9700\u8981\u8003\u8651\u8054\u5408\u5206\u5e03\u800c\u975e\u8fb9\u9645\u5206\u5e03\u3002</p>\n<h3 id=\"913\">9.1.3 \u4e00\u81f4\u6027\u6a21\u578b\u8c31\u7cfb</h3>\n<p>\u5f02\u6b65\u7cfb\u7edf\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1\u5f62\u6210\u4e00\u4e2a\u8c31\u7cfb\uff0c\u4ece\u5f3a\u5230\u5f31\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u987a\u5e8f\u4e00\u81f4\u6027</strong>\uff08Sequential Consistency\uff09\uff1a\u6240\u6709\u64cd\u4f5c\u7684\u5168\u5c40\u987a\u5e8f\n   - \u5f62\u5f0f\u5b9a\u4e49\uff1a\u5b58\u5728\u5168\u5e8f$&lt;$\u4f7f\u5f97\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u64cd\u4f5c\u6309\u7a0b\u5e8f\u987a\u5e8f\u6392\u5217\n   - \u5b9e\u73b0\u4ee3\u4ef7\uff1a\u9700\u8981\u5168\u5c40\u540c\u6b65\uff0c\u6027\u80fd\u5f00\u9500\u5927\n   - <strong>Lamport\u7684\u5f62\u5f0f\u5316\u5b9a\u4e49</strong>\uff1a\u6267\u884c\u7ed3\u679c\u7b49\u4ef7\u4e8e\u6240\u6709\u5904\u7406\u5668\u64cd\u4f5c\u7684\u67d0\u4e2a\u4e32\u884c\u5316\uff0c\u4e14\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u64cd\u4f5c\u4fdd\u6301\u7a0b\u5e8f\u987a\u5e8f</p>\n</li>\n<li>\n<p><strong>\u56e0\u679c\u4e00\u81f4\u6027</strong>\uff08Causal Consistency\uff09\uff1a\u4fdd\u6301\u56e0\u679c\u5173\u7cfb\u7684\u64cd\u4f5c\u987a\u5e8f\n   - \u56e0\u679c\u5173\u7cfb\u5b9a\u4e49\uff1a\u64cd\u4f5c$a$\u56e0\u679c\u5148\u4e8e$b$\uff08\u8bb0\u4f5c$a \\rightarrow b$\uff09\u5f53\u4e14\u4ec5\u5f53\uff1a</p>\n<ul>\n<li>$a$\u548c$b$\u5728\u540c\u4e00\u8fdb\u7a0b\u4e14$a$\u7a0b\u5e8f\u987a\u5e8f\u5148\u4e8e$b$</li>\n<li>$a$\u662f\u5199\u64cd\u4f5c\uff0c$b$\u662f\u8bfb\u64cd\u4f5c\u4e14$b$\u8bfb\u5230$a$\u7684\u503c</li>\n<li>\u5b58\u5728$c$\u4f7f\u5f97$a \\rightarrow c$\u4e14$c \\rightarrow b$\uff08\u4f20\u9012\u6027\uff09</li>\n<li>\u5b9e\u73b0\uff1a\u5411\u91cf\u65f6\u949f\u6216\u7248\u672c\u5411\u91cf</li>\n<li><strong>\u5411\u91cf\u65f6\u949f\u7b97\u6cd5</strong>\uff1a\u8282\u70b9$i$\u7ef4\u62a4\u5411\u91cf$\\mathbf{V}_i[1..P]$\uff0c\u66f4\u65b0\u89c4\u5219\uff1a\n$$\\mathbf{V}_i[i] \\leftarrow \\mathbf{V}_i[i] + 1 \\text{ (\u672c\u5730\u4e8b\u4ef6)}$$\n $$\\mathbf{V}_i[j] \\leftarrow \\max(\\mathbf{V}_i[j], \\mathbf{V}_{\\text{received}}[j]) \\text{ (\u63a5\u6536\u6d88\u606f)}$$</li>\n</ul>\n</li>\n<li>\n<p><strong>\u6700\u7ec8\u4e00\u81f4\u6027</strong>\uff08Eventual Consistency\uff09\uff1a\u7cfb\u7edf\u6700\u7ec8\u6536\u655b\u5230\u4e00\u81f4\u72b6\u6001\n   - \u5f62\u5f0f\u4fdd\u8bc1\uff1a\u82e5\u4ece\u65f6\u523b$t_0$\u8d77\u65e0\u65b0\u66f4\u65b0\uff0c\u5219\u5b58\u5728$t_1 &gt; t_0$\u4f7f\u5f97\u6240\u6709\u526f\u672c\u5728$t &gt; t_1$\u65f6\u4e00\u81f4\n   - \u6536\u655b\u65f6\u95f4\u754c\uff1a\u901a\u5e38\u4e3a$O(\\tau_{\\max} \\log P)$\n   - <strong>\u6536\u655b\u6027\u7684\u91cf\u5316</strong>\uff1a\u5b9a\u4e49\u5206\u6b67\u5ea6\u91cf$D(t) = \\max_{i,j} |\\mathbf{w}_i(t) - \\mathbf{w}_j(t)|$\n$$P(D(t_0 + \\Delta t) &gt; \\epsilon) \\leq e^{-\\lambda \\Delta t}$$\n\u5176\u4e2d$\\lambda$\u662f\u6536\u655b\u7387\u53c2\u6570</p>\n</li>\n<li>\n<p><strong>\u6709\u754c\u4e0d\u4e00\u81f4\u6027</strong>\uff08Bounded Inconsistency\uff09\uff1a\u53c2\u6570\u7248\u672c\u5dee\u5f02\u6709\u754c\n   - $k$-staleness\uff1a\u4efb\u610f\u8282\u70b9\u770b\u5230\u7684\u503c\u81f3\u591a\u8fc7\u65f6$k$\u4e2a\u7248\u672c\n   - $\\epsilon$-consistency\uff1a\u4efb\u610f\u4e24\u4e2a\u8282\u70b9\u7684\u53c2\u6570\u5dee\u5f02$|\\mathbf{w}_i - \\mathbf{w}_j| \\leq \\epsilon$\n   - \u65f6\u95f4\u754c\uff1a\u6240\u6709\u8282\u70b9\u5728$\\Delta t$\u65f6\u95f4\u7a97\u53e3\u5185\u540c\u6b65\n   - <strong>Staleness\u7684\u7cbe\u786e\u5b9a\u4e49</strong>\uff1a\n$$\\text{staleness}(i,t) = t - \\max{s : \\mathbf{w}_i(t) \\text{ \u5305\u542b\u4e86\u65f6\u523b } s \\text{ \u7684\u6240\u6709\u66f4\u65b0}}$$\n<strong>\u4e00\u81f4\u6027\u6a21\u578b\u7684\u5f62\u5f0f\u5316\u6bd4\u8f83</strong>\uff1a</p>\n</li>\n</ol>\n<p>\u5b9a\u4e49\u4e00\u81f4\u6027\u5f3a\u5ea6\u504f\u5e8f\u5173\u7cfb$\\preceq$\uff1a\n$$\\text{Sequential} \\preceq \\text{Linearizable} \\preceq \\text{Causal} \\preceq \\text{PRAM} \\preceq \\text{Eventual}$$\n<strong>\u6df7\u5408\u4e00\u81f4\u6027\u6a21\u578b</strong>\uff1a</p>\n<ol>\n<li><strong>Red-Blue\u4e00\u81f4\u6027</strong>\uff1a\u64cd\u4f5c\u5206\u4e3ared\uff08\u5f3a\u4e00\u81f4\uff09\u548cblue\uff08\u5f31\u4e00\u81f4\uff09\u4e24\u7c7b</li>\n<li><strong>\u4f1a\u8bdd\u4e00\u81f4\u6027</strong>\uff1a\u540c\u4e00\u4f1a\u8bdd\u5185\u4fdd\u8bc1\u987a\u5e8f\uff0c\u8de8\u4f1a\u8bdd\u5141\u8bb8\u4e71\u5e8f</li>\n<li><strong>Fork\u4e00\u81f4\u6027</strong>\uff1a\u68c0\u6d4b\u5e76\u9694\u79bb\u4e0d\u4e00\u81f4\u7684\u89c6\u56fe</li>\n</ol>\n<p><strong>\u4e00\u81f4\u6027\u4e0e\u6027\u80fd\u7684\u6743\u8861</strong>\uff1a</p>\n<p>\u5b9a\u7406\uff08CAP\u7684\u4f18\u5316\u7248\u672c\uff09\uff1a\u5bf9\u4e8e\u5206\u5e03\u5f0f\u4f18\u5316\u7cfb\u7edf\uff0c\u4ee5\u4e0b\u4e09\u8005\u4e0d\u53ef\u517c\u5f97\uff1a</p>\n<ul>\n<li><strong>\u5f3a\u4e00\u81f4\u6027</strong>\uff08Strong Consistency\uff09\uff1a$\\tau_{\\max} = 0$</li>\n<li><strong>\u9ad8\u53ef\u7528\u6027</strong>\uff08High Availability\uff09\uff1a\u8282\u70b9\u6545\u969c\u4e0d\u5f71\u54cd\u7cfb\u7edf</li>\n<li><strong>\u4f4e\u5ef6\u8fdf</strong>\uff08Low Latency\uff09\uff1a\u901a\u4fe1\u5f80\u8fd4\u65f6\u95f4$&lt; \\delta$</li>\n</ul>\n<p><strong>PACELC\u6269\u5c55</strong>\uff1a\u5728CAP\u57fa\u7840\u4e0a\u8003\u8651\u6b63\u5e38\u8fd0\u884c\u65f6\u7684\u6743\u8861\uff1a</p>\n<ul>\n<li><strong>P</strong>artition\u65f6\uff1a\u9009\u62e9<strong>A</strong>vailability\u8fd8\u662f<strong>C</strong>onsistency</li>\n<li><strong>E</strong>lse\uff08\u6b63\u5e38\u65f6\uff09\uff1a\u9009\u62e9<strong>L</strong>atency\u8fd8\u662f<strong>C</strong>onsistency</li>\n</ul>\n<p><strong>\u91cf\u5316\u4e00\u81f4\u6027\u7684\u4ee3\u4ef7</strong>\uff1a\n\u5b9a\u4e49\u4e00\u81f4\u6027\u5f00\u9500\u51fd\u6570$C(\\gamma)$\uff0c\u5176\u4e2d$\\gamma$\u662f\u4e00\u81f4\u6027\u7ea7\u522b\uff1a\n$$C(\\gamma) = \\alpha \\cdot \\text{Latency}(\\gamma) + \\beta \\cdot \\text{Throughput}^{-1}(\\gamma)$$\n\u5b9e\u9a8c\u8868\u660e\uff0c\u4ece\u6700\u7ec8\u4e00\u81f4\u5230\u987a\u5e8f\u4e00\u81f4\uff0c\u541e\u5410\u91cf\u4e0b\u964d\u53ef\u8fbe10\u500d\u3002</p>\n<p>\u5b9e\u8df5\u4e2d\u7684\u9009\u62e9\uff1a</p>\n<ul>\n<li><strong>\u673a\u5668\u5b66\u4e60\u8bad\u7ec3</strong>\uff1a\u901a\u5e38\u9009\u62e9\u6709\u754c\u4e0d\u4e00\u81f4\u6027\uff0c$\\tau_{\\max} = O(10)$</li>\n<li><strong>\u5728\u7ebf\u5b66\u4e60</strong>\uff1a\u6700\u7ec8\u4e00\u81f4\u6027\uff0c\u5bb9\u5fcd\u77ed\u671f\u4e0d\u4e00\u81f4</li>\n<li><strong>\u53c2\u6570\u670d\u52a1\u5668</strong>\uff1a$k$-staleness with $k = O(100)$</li>\n<li><strong>\u8054\u90a6\u5b66\u4e60</strong>\uff1a\u4f1a\u8bdd\u4e00\u81f4\u6027\uff0c\u8bbe\u5907\u5185\u5f3a\u4e00\u81f4</li>\n</ul>\n<p><strong>\u4e00\u81f4\u6027\u76d1\u63a7\u4e0e\u8bca\u65ad</strong>\uff1a</p>\n<ol>\n<li><strong>\u4e00\u81f4\u6027\u8fdd\u53cd\u68c0\u6d4b</strong>\uff1a\u4f7f\u7528\u4e0d\u53d8\u91cf\u68c0\u67e5\u5668</li>\n<li><strong>\u4e00\u81f4\u6027\u5ea6\u91cf</strong>\uff1a\u5b9e\u65f6\u8ddf\u8e2a$k$\u503c\u6216$\\epsilon$\u503c</li>\n<li><strong>\u81ea\u9002\u5e94\u4e00\u81f4\u6027</strong>\uff1a\u6839\u636e\u6536\u655b\u9636\u6bb5\u52a8\u6001\u8c03\u6574\u4e00\u81f4\u6027\u7ea7\u522b</li>\n</ol>\n<h3 id=\"914\">9.1.4 \u5f02\u6b65\u7b97\u6cd5\u7684\u7edf\u4e00\u89c6\u89d2</h3>\n<p><strong>\u53c2\u6570\u66f4\u65b0\u7684\u901a\u7528\u5f62\u5f0f</strong>\uff1a\n$$\\mathbf{w}_{t+1} = \\mathcal{U}(\\mathbf{w}_t, {(\\nabla f_i, \\tau_i)}_{i \\in \\mathcal{A}_t})$$\n\u5176\u4e2d$\\mathcal{U}$\u662f\u66f4\u65b0\u7b97\u5b50\uff0c$\\mathcal{A}_t$\u662f\u65f6\u523b$t$\u7684\u6d3b\u8dc3\u8282\u70b9\u96c6\u5408\u3002</p>\n<p><strong>\u66f4\u65b0\u7b97\u5b50\u7684\u516c\u7406\u5316\u7279\u5f81</strong>\uff1a</p>\n<ol>\n<li><strong>\u4e00\u81f4\u6027</strong>\uff1a$\\mathcal{U}(\\mathbf{w}, \\emptyset) = \\mathbf{w}$\uff08\u65e0\u66f4\u65b0\u65f6\u53c2\u6570\u4e0d\u53d8\uff09</li>\n<li><strong>\u5c40\u90e8\u6027</strong>\uff1a\u66f4\u65b0\u4ec5\u4f9d\u8d56\u5c40\u90e8\u4fe1\u606f\u548c\u5ef6\u8fdf</li>\n<li><strong>\u8fde\u7eed\u6027</strong>\uff1a$\\mathcal{U}$\u5173\u4e8e\u53c2\u6570\u548c\u68af\u5ea6\u8fde\u7eed</li>\n<li><strong>\u65e0\u504f\u6027</strong>\uff1a$\\mathbb{E}[\\mathcal{U}(\\mathbf{w}, \\cdot)] = \\mathbf{w} - \\eta\\mathbb{E}[\\nabla f(\\mathbf{w})]$\uff08\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\uff09</li>\n</ol>\n<p>\u4e0d\u540c\u7b97\u6cd5\u5bf9\u5e94\u4e0d\u540c\u7684$\\mathcal{U}$\u9009\u62e9\uff1a</p>\n<ul>\n<li><strong>\u6807\u51c6\u5f02\u6b65SGD</strong>\uff1a$\\mathcal{U} = \\mathbf{w}_t - \\eta \\sum_{i \\in \\mathcal{A}_t} \\nabla f_i(\\mathbf{w}_{t-\\tau_i})$</li>\n<li><strong>\u5ef6\u8fdf\u8865\u507fSGD</strong>\uff1a$\\mathcal{U} = \\mathbf{w}_t - \\eta \\sum_{i \\in \\mathcal{A}_t} \\mathcal{C}(\\nabla f_i, \\tau_i)$</li>\n<li><strong>\u5f02\u6b65ADMM</strong>\uff1a\u6d89\u53ca\u539f\u59cb\u548c\u5bf9\u5076\u53d8\u91cf\u7684\u4ea4\u66ff\u66f4\u65b0</li>\n<li><strong>\u5f02\u6b65\u5750\u6807\u4e0b\u964d</strong>\uff1a$\\mathcal{U} = \\mathbf{w}_t - \\eta \\sum_{i \\in \\mathcal{A}_t} \\nabla_{I_i} f(\\mathbf{w}_{t-\\tau_i}) \\mathbf{e}_{I_i}$</li>\n<li><strong>\u5f02\u6b65\u65b9\u5dee\u7f29\u51cf</strong>\uff1a$\\mathcal{U} = \\mathbf{w}_t - \\eta \\sum_{i \\in \\mathcal{A}_t} (\\nabla f_i(\\mathbf{w}_{t-\\tau_i}) - \\nabla f_i(\\tilde{\\mathbf{w}}) + \\mu)$</li>\n</ul>\n<p><strong>\u5f02\u6b65\u7b97\u6cd5\u7684\u5206\u7c7b\u4f53\u7cfb</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u4e8e\u66f4\u65b0\u7c92\u5ea6</strong>\uff1a\n   - <strong>\u5168\u91cf\u66f4\u65b0</strong>\uff1a\u6bcf\u6b21\u66f4\u65b0\u6240\u6709\u53c2\u6570\n   - <strong>\u5757\u66f4\u65b0</strong>\uff1a\u66f4\u65b0\u53c2\u6570\u7684\u5b50\u96c6\n   - <strong>\u5750\u6807\u66f4\u65b0</strong>\uff1a\u5355\u4e2a\u53c2\u6570\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u540c\u6b65\u7a0b\u5ea6</strong>\uff1a\n   - <strong>\u5b8c\u5168\u5f02\u6b65</strong>\uff1a\u65e0\u4efb\u4f55\u540c\u6b65\n   - <strong>\u6709\u754c\u5f02\u6b65</strong>\uff1a\u9650\u5236\u6700\u5927\u5ef6\u8fdf\n   - <strong>\u534a\u5f02\u6b65</strong>\uff1a\u5468\u671f\u6027\u540c\u6b65</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u901a\u4fe1\u6a21\u5f0f</strong>\uff1a\n   - <strong>\u96c6\u4e2d\u5f0f</strong>\uff1a\u901a\u8fc7\u53c2\u6570\u670d\u52a1\u5668\n   - <strong>\u53bb\u4e2d\u5fc3\u5316</strong>\uff1a\u70b9\u5bf9\u70b9\u901a\u4fe1\n   - <strong>\u5c42\u6b21\u5316</strong>\uff1a\u591a\u7ea7\u805a\u5408</p>\n</li>\n</ol>\n<p><strong>\u6536\u655b\u6027\u5206\u6790\u7684\u7edf\u4e00\u6846\u67b6</strong>\uff1a</p>\n<p>\u5b9a\u4e49Lyapunov\u51fd\u6570$V_t = \\mathbb{E}[|\\mathbf{w}_t - \\mathbf{w}^*|^2]$\uff0c\u5f02\u6b65\u7b97\u6cd5\u7684\u6536\u655b\u6027\u53ef\u901a\u8fc7\u8bc1\u660e\uff1a\n$$V_{t+1} \\leq (1 - \\mu\\eta)V_t + \\eta^2 G^2 + \\eta^2 L^2 \\mathbb{E}[\\sum_{i \\in \\mathcal{A}_t} \\tau_i^2]$$\n\u8fd9\u4e2a\u9012\u5f52\u5173\u7cfb\u7edf\u4e00\u4e86\u591a\u79cd\u5f02\u6b65\u7b97\u6cd5\u7684\u5206\u6790\u3002</p>\n<p><strong>\u66f4\u4e00\u822c\u7684Lyapunov\u51fd\u6570\u8bbe\u8ba1</strong>\uff1a\n\u8003\u8651\u5305\u542b\u5386\u53f2\u4fe1\u606f\u7684\u6269\u5c55\u72b6\u6001\u7a7a\u95f4\uff1a\n$$\\mathcal{V}_t = V_t + \\sum_{k=1}^{\\tau_{\\max}} \\alpha_k \\mathbb{E}[|\\mathbf{w}_t - \\mathbf{w}_{t-k}|^2]$$\n\u5176\u4e2d$\\alpha_k &gt; 0$\u662f\u6743\u91cd\u7cfb\u6570\uff0c\u9009\u62e9\u4f7f\u5f97\uff1a\n$$\\mathcal{V}_{t+1} \\leq \\rho \\mathcal{V}_t + \\sigma^2$$\n\u8fd9\u79cd\u8bbe\u8ba1\u80fd\u591f\u66f4\u7d27\u5730\u523b\u753b\u5ef6\u8fdf\u7684\u5f71\u54cd\u3002</p>\n<p><strong>\u7edf\u4e00\u6846\u67b6\u4e0b\u7684\u5173\u952e\u5f15\u7406</strong>\uff1a</p>\n<p><strong>\u5f15\u74069.1</strong>\uff08\u5ef6\u8fdf\u68af\u5ea6\u7684\u65b9\u5dee\u754c\uff09\uff1a\n$$\\mathbb{E}[|\\nabla f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)|^2] \\leq 2L^2 \\sum_{s=t-\\tau}^{t-1} \\mathbb{E}[|\\mathbf{w}_{s+1} - \\mathbf{w}_s|^2]$$\n<strong>\u5f15\u74069.2</strong>\uff08\u5f02\u6b65\u66f4\u65b0\u7684\u538b\u7f29\u6027\uff09\uff1a\n\u5728\u5f3a\u51f8\u6761\u4ef6\u4e0b\uff0c\u5b58\u5728$\\rho &lt; 1$\u4f7f\u5f97\uff1a\n$$\\mathbb{E}[|\\mathcal{U}(\\mathbf{w}, \\cdot) - \\mathbf{w}^*|^2] \\leq \\rho |\\mathbf{w} - \\mathbf{w}^*|^2 + \\eta^2 \\sigma^2$$\n<strong>\u5f15\u74069.3</strong>\uff08\u6d3b\u8dc3\u96c6\u7684\u6982\u7387\u7279\u5f81\uff09\uff1a\n$$P(|\\mathcal{A}_t| = k) = \\binom{P}{k} p^k (1-p)^{P-k}$$\n\u5176\u4e2d$p$\u662f\u5355\u4e2a\u8282\u70b9\u5728\u5355\u4f4d\u65f6\u95f4\u5185\u5b8c\u6210\u7684\u6982\u7387\u3002</p>\n<h3 id=\"915\">9.1.5 \u5f02\u6b65\u4f18\u5316\u7684\u4fe1\u606f\u8bba\u89c6\u89d2</h3>\n<p>\u4ece\u4fe1\u606f\u8bba\u89d2\u5ea6\uff0c\u5ef6\u8fdf\u53ef\u89c6\u4e3a\u4fe1\u9053\u566a\u58f0\u3002\u5b9a\u4e49\u4e92\u4fe1\u606f\uff1a\n$$I(\\mathbf{w}_t; \\nabla f(\\mathbf{w}_{t-\\tau})) = H(\\nabla f(\\mathbf{w}_{t-\\tau})) - H(\\nabla f(\\mathbf{w}_{t-\\tau}) | \\mathbf{w}_t)$$\n\u5ef6\u8fdf$\\tau$\u589e\u52a0\u5bfc\u81f4\u4e92\u4fe1\u606f\u51cf\u5c11\uff0c\u91cf\u5316\u4e86\"\u8fc7\u65f6\"\u68af\u5ea6\u7684\u4fe1\u606f\u635f\u5931\u3002</p>\n<p><strong>\u68af\u5ea6\u4fe1\u606f\u7684\u65f6\u95f4\u8870\u51cf\u6a21\u578b</strong>\uff1a\n\u5047\u8bbe\u53c2\u6570\u9075\u5faa\u968f\u673a\u6e38\u8d70$\\mathbf{w}_{t+1} = \\mathbf{w}_t + \\boldsymbol{\\epsilon}_t$\uff0c\u5176\u4e2d$\\boldsymbol{\\epsilon}_t \\sim \\mathcal{N}(0, \\sigma^2 \\mathbf{I})$\uff0c\u5219\uff1a\n$$I(\\mathbf{w}_t; \\mathbf{w}_{t-\\tau}) = \\frac{d}{2}\\log\\left(\\frac{\\sigma^2(\\tau+1)}{\\sigma^2}\\right) = \\frac{d}{2}\\log(\\tau+1)$$\n\u8fd9\u8868\u660e\u4fe1\u606f\u4ee5\u5bf9\u6570\u901f\u7387\u8870\u51cf\u3002</p>\n<p><strong>Fisher\u4fe1\u606f\u7684\u5ef6\u8fdf\u6548\u5e94</strong>\uff1a\n\u5b9a\u4e49\u5ef6\u8fdfFisher\u4fe1\u606f\u77e9\u9635\uff1a\n$$\\mathbf{F}_\\tau = \\mathbb{E}_{\\mathbf{x} \\sim p(\\mathbf{x}|\\mathbf{w}_{t-\\tau})}[\\nabla \\log p(\\mathbf{x}|\\mathbf{w}_t) \\nabla \\log p(\\mathbf{x}|\\mathbf{w}_t)^T]$$\n\u5728\u5c40\u90e8\u4e8c\u6b21\u8fd1\u4f3c\u4e0b\uff1a\n$$\\mathbf{F}_\\tau \\approx \\mathbf{F}_0 (\\mathbf{I} - \\tau \\mathbf{H} \\mathbf{F}_0^{-1})$$\n\u5176\u4e2d$\\mathbf{F}_0$\u662f\u65e0\u5ef6\u8fdfFisher\u4fe1\u606f\uff0c$\\mathbf{H}$\u662fHessian\u3002</p>\n<p><strong>\u4fe1\u606f\u8bba\u754c\u9650</strong>\uff1a\u5728\u9ad8\u65af\u566a\u58f0\u5047\u8bbe\u4e0b\uff0c\u5ef6\u8fdf\u68af\u5ea6\u7684\u6709\u6548\u4fe1\u606f\u7387\u4e3a\uff1a\n$$R_{\\text{eff}} = \\frac{1}{2}\\log\\left(1 + \\frac{\\text{SNR}}{1 + \\tau/\\tau_0}\\right)$$\n\u5176\u4e2dSNR\u662f\u4fe1\u566a\u6bd4\uff0c$\\tau_0$\u662f\u7279\u5f81\u65f6\u95f4\u5c3a\u5ea6\u3002</p>\n<p><strong>\u6700\u4f18\u4fe1\u606f\u63d0\u53d6\u7b56\u7565</strong>\uff1a\n\u7ed9\u5b9a\u591a\u4e2a\u5ef6\u8fdf\u68af\u5ea6${\\nabla f(\\mathbf{w}_{t-\\tau_i})}_{i=1}^n$\uff0c\u6700\u4f18\u7ebf\u6027\u7ec4\u5408\u4e3a\uff1a\n$$\\nabla_{\\text{opt}} = \\sum_{i=1}^n \\alpha_i \\nabla f(\\mathbf{w}_{t-\\tau_i})$$\n\u5176\u4e2d\u6743\u91cd$\\alpha_i \\propto (1 + \\tau_i/\\tau_0)^{-1}$\u6700\u5c0f\u5316\u4f30\u8ba1\u65b9\u5dee\u3002</p>\n<p><strong>\u4fe1\u9053\u5bb9\u91cf\u7c7b\u6bd4</strong>\uff1a\n\u5c06\u5f02\u6b65\u4f18\u5316\u89c6\u4e3a\u901a\u4fe1\u95ee\u9898\uff1a</p>\n<ul>\n<li><strong>\u4fe1\u6e90</strong>\uff1a\u771f\u5b9e\u68af\u5ea6$\\nabla f(\\mathbf{w}_t)$</li>\n<li><strong>\u4fe1\u9053</strong>\uff1a\u5ef6\u8fdf\u548c\u566a\u58f0</li>\n<li><strong>\u63a5\u6536\u4fe1\u53f7</strong>\uff1a\u5ef6\u8fdf\u68af\u5ea6$\\nabla f(\\mathbf{w}_{t-\\tau})$</li>\n</ul>\n<p>\u4fe1\u9053\u5bb9\u91cf\uff1a\n$$C = \\max_{p(\\nabla)} I(\\nabla f(\\mathbf{w}_t); \\nabla f(\\mathbf{w}_{t-\\tau}))$$\n\u8fd9\u7ed9\u51fa\u4e86\u5f02\u6b65\u7cfb\u7edf\u7684\u57fa\u672c\u9650\u5236\u3002</p>\n<p><strong>Rate-Distortion\u7406\u8bba\u5e94\u7528</strong>\uff1a\n\u5b9a\u4e49\u5931\u771f\u5ea6\u91cf$d(\\mathbf{w}, \\hat{\\mathbf{w}}) = |\\mathbf{w} - \\hat{\\mathbf{w}}|^2$\uff0c\u5219\u7ed9\u5b9a\u901a\u4fe1\u7387$R$\uff0c\u6700\u5c0f\u53ef\u8fbe\u5931\u771f\u4e3a\uff1a\n$$D(R) = \\sigma^2 e^{-2R/d}$$\n\u8fd9\u523b\u753b\u4e86\u901a\u4fe1\u7ea6\u675f\u4e0b\u7684\u4f18\u5316\u7cbe\u5ea6\u6781\u9650\u3002</p>\n<h3 id=\"916\">9.1.6 \u5b9e\u9645\u7cfb\u7edf\u4e2d\u7684\u5f02\u6b65\u6a21\u5f0f</h3>\n<p><strong>\u53c2\u6570\u670d\u52a1\u5668\u67b6\u6784</strong>\uff1a</p>\n<ul>\n<li>Server\u8282\u70b9\u7ef4\u62a4\u5168\u5c40\u53c2\u6570</li>\n<li>Worker\u8282\u70b9\u8ba1\u7b97\u68af\u5ea6\u5e76\u63a8\u9001</li>\n<li>\u652f\u6301\u7075\u6d3b\u7684\u4e00\u81f4\u6027\u6a21\u578b</li>\n</ul>\n<p><strong>\u53c2\u6570\u670d\u52a1\u5668\u7684\u8be6\u7ec6\u8bbe\u8ba1</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6570\u636e\u5206\u7247\u7b56\u7565</strong>\uff1a\n   - <strong>Range\u5206\u7247</strong>\uff1a\u8fde\u7eed\u53c2\u6570ID\u6620\u5c04\u5230\u540c\u4e00\u670d\u52a1\u5668\n   - <strong>Hash\u5206\u7247</strong>\uff1a\u4f7f\u7528\u4e00\u81f4\u6027\u54c8\u5e0c\u5747\u5300\u5206\u5e03\n   - <strong>\u8bed\u4e49\u5206\u7247</strong>\uff1a\u76f8\u5173\u53c2\u6570\u5206\u914d\u5230\u540c\u4e00\u8282\u70b9</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a\n   - <strong>\u4e3b\u4ece\u590d\u5236</strong>\uff1a\u6bcf\u4e2a\u5206\u7247\u6709\u591a\u4e2a\u526f\u672c\n   - <strong>\u94fe\u5f0f\u590d\u5236</strong>\uff1a\u5199\u64cd\u4f5c\u6cbf\u94fe\u4f20\u64ad\n   - <strong>Checkpoint</strong>\uff1a\u5b9a\u671f\u6301\u4e45\u5316\u53c2\u6570\u5feb\u7167</p>\n</li>\n<li>\n<p><strong>\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\n   - <strong>\u52a8\u6001\u8fc1\u79fb</strong>\uff1a\u70ed\u70b9\u53c2\u6570\u91cd\u5206\u914d\n   - <strong>\u8bf7\u6c42\u8def\u7531</strong>\uff1a\u57fa\u4e8e\u8d1f\u8f7d\u7684\u667a\u80fd\u8def\u7531\n   - <strong>\u7f13\u5b58\u7b56\u7565</strong>\uff1aWorker\u7aef\u7f13\u5b58\u70ed\u70b9\u53c2\u6570</p>\n</li>\n</ol>\n<p><strong>\u5178\u578b\u5b9e\u73b0\uff1aPS-Lite\u67b6\u6784\u5206\u6790</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>Server Group: \n  - Key-Value\u5b58\u50a8\n  - \u5411\u91cf\u65f6\u949f\u7ef4\u62a4\n  - \u5f02\u6b65\u805a\u5408\u903b\u8f91\n\nWorker Group:\n  - \u672c\u5730\u7f13\u5b58\u7ba1\u7406  \n  - \u6279\u91cf\u901a\u4fe1\u4f18\u5316\n  - \u6545\u969c\u68c0\u6d4b\u5fc3\u8df3\n\nScheduler:\n  - \u4efb\u52a1\u5206\u914d\n  - \u8fdb\u5ea6\u76d1\u63a7\n  - \u8d44\u6e90\u8c03\u5ea6\n</code></pre></div>\n\n<p><strong>\u53bb\u4e2d\u5fc3\u5316\u67b6\u6784</strong>\uff1a</p>\n<ul>\n<li>\u65e0\u4e2d\u5fc3\u8282\u70b9\uff0c\u70b9\u5bf9\u70b9\u901a\u4fe1</li>\n<li>\u4f7f\u7528gossip\u534f\u8bae\u4f20\u64ad\u66f4\u65b0</li>\n<li>\u66f4\u597d\u7684\u5bb9\u9519\u6027\u4f46\u6536\u655b\u8f83\u6162</li>\n</ul>\n<p><strong>Gossip\u534f\u8bae\u7684\u6570\u5b66\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li><strong>\u4f20\u64ad\u65f6\u95f4</strong>\uff1a$O(\\log n)$\u8f6e\u8fbe\u5230\u6240\u6709\u8282\u70b9</li>\n<li><strong>\u6d88\u606f\u590d\u6742\u5ea6</strong>\uff1a\u6bcf\u8f6e$O(n)$\u6761\u6d88\u606f</li>\n<li><strong>\u6536\u655b\u901f\u7387</strong>\uff1a\u8c31\u9699\u51b3\u5b9a\uff0c$\\rho = 1 - \\lambda_2(\\mathbf{W})$</li>\n</ul>\n<p><strong>\u53bb\u4e2d\u5fc3\u5316\u7684\u53d8\u4f53</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>All-Reduce\u67b6\u6784</strong>\uff1a\n   - Ring-AllReduce\uff1a\u5e26\u5bbd\u6700\u4f18\n   - Tree-AllReduce\uff1a\u5ef6\u8fdf\u6700\u4f18\n   - Recursive doubling\uff1a\u5e73\u8861\u5ef6\u8fdf\u548c\u5e26\u5bbd</p>\n</li>\n<li>\n<p><strong>\u90bb\u5c45\u5e73\u5747</strong>\uff1a\n$$\\mathbf{w}_i^{(t+1)} = \\sum_{j \\in \\mathcal{N}_i} w_{ij} \\mathbf{w}_j^{(t)} - \\eta \\nabla f_i(\\mathbf{w}_i^{(t)})$$\n\u5176\u4e2d$w_{ij}$\u662f\u901a\u4fe1\u6743\u91cd\u77e9\u9635</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65ADMM</strong>\uff1a\n   - \u539f\u59cb\u53d8\u91cf\u5c40\u90e8\u66f4\u65b0\n   - \u5bf9\u5076\u53d8\u91cf\u5f02\u6b65\u4f20\u9012\n   - \u9002\u5408\u7ea6\u675f\u4f18\u5316\u95ee\u9898</p>\n</li>\n</ol>\n<p><strong>\u6df7\u5408\u67b6\u6784</strong>\uff1a</p>\n<ul>\n<li>\u5c42\u6b21\u5316\u8bbe\u8ba1\uff1a\u5c40\u90e8\u540c\u6b65+\u5168\u5c40\u5f02\u6b65</li>\n<li>\u81ea\u9002\u5e94\u5207\u6362\u540c\u6b65/\u5f02\u6b65\u6a21\u5f0f</li>\n<li>\u6839\u636e\u4efb\u52a1\u7279\u70b9\u4f18\u5316</li>\n</ul>\n<p><strong>\u5c42\u6b21\u5316\u901a\u4fe1\u7684\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e24\u7ea7\u67b6\u6784</strong>\uff1a\n   - Intra-rack\uff1a\u9ad8\u5e26\u5bbd\u540c\u6b65\n   - Inter-rack\uff1a\u4f4e\u5e26\u5bbd\u5f02\u6b65\n   - \u901a\u4fe1\u6210\u672c\uff1a$T = \\alpha T_{\\text{local}} + (1-\\alpha)T_{\\text{global}}$</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u540c\u6b65\u9891\u7387</strong>\uff1a\n$$H(t) = H_0 \\cdot \\exp(-\\beta \\cdot \\text{progress}(t))$$\n\u65e9\u671f\u9891\u7e41\u540c\u6b65\uff0c\u540e\u671f\u51cf\u5c11\u540c\u6b65</p>\n</li>\n<li>\n<p><strong>\u5206\u7ec4\u7b56\u7565</strong>\uff1a\n   - \u6309\u5730\u7406\u4f4d\u7f6e\u5206\u7ec4\n   - \u6309\u8ba1\u7b97\u80fd\u529b\u5206\u7ec4\n   - \u6309\u4efb\u52a1\u76f8\u4f3c\u5ea6\u5206\u7ec4</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u90e8\u7f72\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7f51\u7edc\u62d3\u6251\u611f\u77e5</strong>\uff1a\n   - Fat-tree\uff1a\u4f18\u5316\u8de8\u4ea4\u6362\u673a\u6d41\u91cf\n   - Torus\uff1a\u5229\u7528\u90bb\u5c45\u901a\u4fe1\n   - Dragonfly\uff1a\u5206\u5c42\u8def\u7531\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u5bb9\u5668\u5316\u90e8\u7f72</strong>\uff1a\n   - Kubernetes operator\u7ba1\u7406\n   - \u5f39\u6027\u4f38\u7f29\u652f\u6301\n   - \u8d44\u6e90\u9694\u79bb\u548cQoS</p>\n</li>\n<li>\n<p><strong>\u76d1\u63a7\u548c\u8c03\u8bd5</strong>\uff1a\n   - \u5206\u5e03\u5f0f\u8ffd\u8e2a\uff08OpenTelemetry\uff09\n   - \u6027\u80fd\u5256\u6790\uff08\u5ef6\u8fdf\u5206\u5e03\u3001\u541e\u5410\u91cf\uff09\n   - \u4e00\u81f4\u6027\u9a8c\u8bc1\u5de5\u5177</p>\n</li>\n</ol>\n<p><strong>\u5de5\u4e1a\u754c\u6848\u4f8b\u7814\u7a76</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Google DistBelief/TensorFlow</strong>\uff1a\n   - \u89c4\u6a21\uff1a10,000+\u8282\u70b9\n   - \u67b6\u6784\uff1a\u53c2\u6570\u670d\u52a1\u5668+\u6570\u636e\u5e76\u884c\n   - \u521b\u65b0\uff1a\u5907\u4efd\u8ba1\u7b97\u5e94\u5bf9stragglers</p>\n</li>\n<li>\n<p><strong>Microsoft Adam</strong>\uff1a\n   - \u7279\u8272\uff1a\u5c42\u6b21\u5316\u53c2\u6570\u670d\u52a1\u5668\n   - \u4f18\u5316\uff1aDelta\u7f16\u7801\u538b\u7f29\n   - \u6027\u80fd\uff1a120\u4ebf\u53c2\u6570\u6a21\u578b\u8bad\u7ec3</p>\n</li>\n<li>\n<p><strong>Facebook PyTorch Distributed</strong>\uff1a\n   - DDP\uff1a\u68af\u5ea6\u6876\u4f18\u5316\n   - RPC\uff1a\u7075\u6d3b\u7684\u5f02\u6b65\u539f\u8bed\n   - Pipeline\uff1a\u6a21\u578b\u5e76\u884c\u652f\u6301</p>\n</li>\n</ol>\n<h2 id=\"92\">9.2 \u5ef6\u8fdf\u68af\u5ea6\u7684\u8bef\u5dee\u7d2f\u79ef\u5206\u6790</h2>\n<h3 id=\"921-taylor\">9.2.1 \u5ef6\u8fdf\u68af\u5ea6\u7684Taylor\u5c55\u5f00</h3>\n<p>\u4e3a\u5206\u6790\u5ef6\u8fdf\u5f71\u54cd\uff0c\u8003\u8651\u68af\u5ea6\u7684Taylor\u5c55\u5f00\uff1a\n$$\\nabla f(\\mathbf{w}_{t-\\tau}) = \\nabla f(\\mathbf{w}_t) - \\sum_{s=t-\\tau}^{t-1} \\mathbf{H}_s (\\mathbf{w}_{s+1} - \\mathbf{w}_s) + O(|\\mathbf{w}_t - \\mathbf{w}_{t-\\tau}|^2)$$\n\u5176\u4e2d$\\mathbf{H}_s$\u662f\u5728\u67d0\u4e2a\u4e2d\u95f4\u70b9\u7684Hessian\u77e9\u9635\u3002\u8fd9\u8868\u660e\u5ef6\u8fdf\u68af\u5ea6\u5305\u542b\u4e86\u5386\u53f2\u66f4\u65b0\u7684\u7d2f\u79ef\u6548\u5e94\u3002</p>\n<p><strong>\u7cbe\u786e\u5c55\u5f00\u5f0f</strong>\uff1a\u4f7f\u7528\u79ef\u5206\u5f62\u5f0f\u7684Taylor\u5c55\u5f00\uff0c\u6211\u4eec\u6709\uff1a\n$$\\nabla f(\\mathbf{w}_{t-\\tau}) = \\nabla f(\\mathbf{w}_t) - \\int_0^1 \\mathbf{H}(\\mathbf{w}_t + \\alpha(\\mathbf{w}_{t-\\tau} - \\mathbf{w}_t))(\\mathbf{w}_t - \\mathbf{w}_{t-\\tau}) d\\alpha$$\n<strong>\u9ad8\u9636\u5c55\u5f00</strong>\uff1a\u4fdd\u7559\u5230\u4e8c\u9636\u9879\uff1a\n$$\\nabla f(\\mathbf{w}_{t-\\tau}) = \\nabla f(\\mathbf{w}_t) - \\mathbf{H}_t \\Delta\\mathbf{w}_\\tau + \\frac{1}{2}\\sum_{i,j,k} \\frac{\\partial^3 f}{\\partial w_i \\partial w_j \\partial w_k}\\bigg|_{\\mathbf{w}_t} \\Delta w_{\\tau,j} \\Delta w_{\\tau,k} \\mathbf{e}_i + O(|\\Delta\\mathbf{w}_\\tau|^3)$$\n\u5176\u4e2d$\\Delta\\mathbf{w}_\\tau = \\mathbf{w}_t - \\mathbf{w}_{t-\\tau}$\u3002</p>\n<h3 id=\"922\">9.2.2 \u8bef\u5dee\u754c\u7684\u63a8\u5bfc</h3>\n<p><strong>\u5047\u8bbe1</strong>\uff08Lipschitz\u8fde\u7eed\u68af\u5ea6\uff09\uff1a$|\\nabla f(\\mathbf{x}) - \\nabla f(\\mathbf{y})| \\leq L|\\mathbf{x} - \\mathbf{y}|$</p>\n<p><strong>\u5047\u8bbe2</strong>\uff08\u6709\u754c\u68af\u5ea6\uff09\uff1a$|\\nabla f(\\mathbf{x})| \\leq G$\u5bf9\u6240\u6709$\\mathbf{x}$</p>\n<p>\u5728\u6709\u754c\u5ef6\u8fdf$\\tau_{\\max}$\u4e0b\uff0c\u5ef6\u8fdf\u68af\u5ea6\u7684\u8bef\u5dee\u53ef\u4ee5\u754c\u5b9a\u4e3a\uff1a\n$$|\\nabla f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)| \\leq LG\\eta \\sum_{s=t-\\tau}^{t-1} 1 \\leq LG\\eta\\tau_{\\max}$$\n\u8fd9\u4e2a\u754c\u8868\u660e\uff0c\u5b66\u4e60\u7387$\\eta$\u548c\u6700\u5927\u5ef6\u8fdf$\\tau_{\\max}$\u7684\u4e58\u79ef\u63a7\u5236\u7740\u8bef\u5dee\u5927\u5c0f\u3002</p>\n<p><strong>\u66f4\u7d27\u7684\u8bef\u5dee\u754c</strong>\uff1a\u8003\u8651\u68af\u5ea6\u7684\u65b9\u5dee\u7ed3\u6784\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\\mathbb{E}[|\\nabla f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)|^2] \\leq L^2 \\eta^2 \\tau \\sum_{s=t-\\tau}^{t-1} \\mathbb{E}[|\\nabla f(\\mathbf{w}_s)|^2] \\leq L^2 \\eta^2 \\tau^2 (G^2 + \\sigma^2)$$\n\u5176\u4e2d$\\sigma^2$\u662f\u68af\u5ea6\u7684\u65b9\u5dee\u3002</p>\n<p><strong>\u6570\u636e\u76f8\u5173\u7684\u754c</strong>\uff1a\u5229\u7528\u51fd\u6570\u7684\u7279\u6b8a\u7ed3\u6784\uff0c\u5982\u5f3a\u51f8\u6027\uff1a\n$$|\\nabla f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)| \\leq L|\\mathbf{w}_t - \\mathbf{w}_{t-\\tau}| \\leq L\\eta G\\tau e^{-\\mu \\tau/2}$$\n\u8fd9\u8868\u660e\u5728\u5f3a\u51f8\u60c5\u51b5\u4e0b\uff0c\u5ef6\u8fdf\u7684\u5f71\u54cd\u4f1a\u6307\u6570\u8870\u51cf\u3002</p>\n<h3 id=\"923\">9.2.3 \u6536\u655b\u901f\u7387\u5206\u6790</h3>\n<p><strong>\u5b9a\u74069.1</strong>\uff08\u5f02\u6b65SGD\u7684\u6536\u655b\u6027\uff09\uff1a\u5728\u51f8\u51fd\u6570$f$\u4e0b\uff0c\u4f7f\u7528\u9012\u51cf\u5b66\u4e60\u7387$\\eta_t = \\eta_0/\\sqrt{t}$\uff0c\u5f02\u6b65SGD\u6ee1\u8db3\uff1a\n$$\\mathbb{E}[f(\\bar{\\mathbf{w}}_T) - f^*] \\leq O\\left(\\frac{1}{\\sqrt{T}} + \\frac{\\tau_{\\max}^2}{T}\\right)$$\n\u5176\u4e2d$\\bar{\\mathbf{w}}_T = \\frac{1}{T}\\sum_{t=1}^T \\mathbf{w}_t$\u662f\u5e73\u5747\u8fed\u4ee3\u70b9\u3002</p>\n<p><strong>\u8bc1\u660e\u8981\u70b9</strong>\uff1a</p>\n<ol>\n<li>\u5229\u7528\u51f8\u6027\u5efa\u7acb\u9012\u5f52\u5173\u7cfb</li>\n<li>\u5904\u7406\u5ef6\u8fdf\u9879\u7684\u4ea4\u53c9\u8026\u5408</li>\n<li>\u5e94\u7528\u9785\u5dee\u5e8f\u5217\u7684\u6536\u655b\u6027\u8d28</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u8bc1\u660e\u6846\u67b6</strong>\uff1a</p>\n<p>\u6b65\u9aa41\uff1a\u5efa\u7acb\u5355\u6b65\u9012\u5f52\n$$\\mathbb{E}[f(\\mathbf{w}_{t+1})] \\leq f(\\mathbf{w}_t) - \\eta_t \\langle \\nabla f(\\mathbf{w}_t), \\mathbb{E}[\\nabla f(\\mathbf{w}_{t-\\tau_{i_t,t}})] \\rangle + \\frac{L\\eta_t^2}{2}\\mathbb{E}[|\\nabla f(\\mathbf{w}_{t-\\tau_{i_t,t}})|^2]$$\n\u6b65\u9aa42\uff1a\u5904\u7406\u5ef6\u8fdf\u9879\n$$\\langle \\nabla f(\\mathbf{w}_t), \\nabla f(\\mathbf{w}_{t-\\tau}) \\rangle \\geq |\\nabla f(\\mathbf{w}_t)|^2 - L|\\nabla f(\\mathbf{w}_t)| \\cdot |\\mathbf{w}_t - \\mathbf{w}_{t-\\tau}|$$\n\u6b65\u9aa43\uff1a\u7d2f\u52a0\u5e76\u5e94\u7528\u51f8\u6027\n$$f(\\bar{\\mathbf{w}}_T) - f^* \\leq \\frac{1}{T}\\sum_{t=1}^T (f(\\mathbf{w}_t) - f^*)$$\n\u6ce8\u610f\u7b2c\u4e8c\u9879$O(\\tau_{\\max}^2/T)$\u662f\u5f02\u6b65\u6027\u5e26\u6765\u7684\u989d\u5916\u8bef\u5dee\uff0c\u5728$T$\u8db3\u591f\u5927\u65f6\u4f1a\u88ab\u7b2c\u4e00\u9879\u4e3b\u5bfc\u3002</p>\n<p><strong>\u52a0\u901f\u6536\u655b\u7684\u6761\u4ef6</strong>\uff1a\u5f53\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u65f6\uff0c\u5f02\u6b65\u7b97\u6cd5\u53ef\u4ee5\u8fbe\u5230\u4e0e\u540c\u6b65\u76f8\u540c\u7684\u6536\u655b\u901f\u7387\uff1a</p>\n<ol>\n<li>\u7a00\u758f\u68af\u5ea6\uff1a$|\\nabla f(\\mathbf{w})|_0 \\ll d$</li>\n<li>\u6709\u754c\u5ef6\u8fdf\uff1a$\\tau_{\\max} = O(\\sqrt{T}/L)$</li>\n<li>\u9002\u5e94\u6027\u5b66\u4e60\u7387\uff1a$\\eta_t = \\eta_0/\\sqrt{t(1+\\tau_t)}$</li>\n</ol>\n<h3 id=\"924\">9.2.4 \u975e\u51f8\u60c5\u51b5\u7684\u5206\u6790</h3>\n<p>\u5bf9\u4e8e\u975e\u51f8\u76ee\u6807\u51fd\u6570\uff0c\u5206\u6790\u66f4\u52a0\u5fae\u5999\u3002\u5173\u952e\u662f\u5efa\u7acb\u68af\u5ea6\u8303\u6570\u7684\u9012\u51cf\u6027\u8d28\u3002</p>\n<p><strong>\u5b9a\u74069.2</strong>\uff08\u975e\u51f8\u5f02\u6b65SGD\uff09\uff1a\u5728\u5149\u6ed1\u975e\u51f8\u51fd\u6570\u4e0b\uff0c\u9009\u62e9\u5b66\u4e60\u7387$\\eta = O(1/(\\tau_{\\max}\\sqrt{T}))$\uff0c\u6709\uff1a\n$$\\frac{1}{T}\\sum_{t=1}^T \\mathbb{E}[|\\nabla f(\\mathbf{w}_t)|^2] \\leq O\\left(\\frac{\\tau_{\\max}}{\\sqrt{T}}\\right)$$\n\u8fd9\u8868\u660e\u5373\u4f7f\u5728\u975e\u51f8\u60c5\u51b5\u4e0b\uff0c\u5f02\u6b65SGD\u4ecd\u80fd\u6536\u655b\u5230\u9a7b\u70b9\u3002</p>\n<p><strong>\u8bc1\u660e\u6280\u5de7</strong>\uff1a\u5229\u7528\u4e0b\u964d\u5f15\u7406\uff08Descent Lemma\uff09\uff1a\n$$f(\\mathbf{w}_{t+1}) \\leq f(\\mathbf{w}_t) - \\eta_t \\langle \\nabla f(\\mathbf{w}_t), \\nabla f(\\mathbf{w}_{t-\\tau}) \\rangle + \\frac{L\\eta_t^2}{2}|\\nabla f(\\mathbf{w}_{t-\\tau})|^2$$\n<strong>\u975e\u51f8\u60c5\u51b5\u7684\u7cbe\u7ec6\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8fd1\u4f3c\u9a7b\u70b9\u7684\u523b\u753b</strong>\uff1a\u5b9a\u4e49$(\\epsilon, \\delta)$-\u9a7b\u70b9\uff1a\n$$P(|\\nabla f(\\mathbf{w})| \\leq \\epsilon) \\geq 1 - \\delta$$</p>\n</li>\n<li>\n<p><strong>\u9003\u79bb\u978d\u70b9\u7684\u5206\u6790</strong>\uff1a\u5f02\u6b65\u566a\u58f0\u53ef\u80fd\u5e2e\u52a9\u9003\u79bb\u978d\u70b9\n$$\\lambda_{\\min}(\\mathbf{H}) &lt; -\\gamma \\Rightarrow \\mathbb{E}[f(\\mathbf{w}_{t+k}) - f(\\mathbf{w}_t)] \\leq -\\Omega(k\\gamma^2/L)$$</p>\n</li>\n<li>\n<p><strong>\u5c40\u90e8\u6536\u655b\u6027</strong>\uff1a\u5728\u6700\u4f18\u89e3\u9644\u8fd1\uff0c\u5f02\u6b65\u7b97\u6cd5\u8868\u73b0\u51fa\u7ebf\u6027\u6536\u655b\n$$\\mathbb{E}[|\\mathbf{w}_t - \\mathbf{w}^*|^2] \\leq (1 - \\mu\\eta(1-L\\eta\\tau_{\\max}))^t |\\mathbf{w}_0 - \\mathbf{w}^*|^2$$</p>\n</li>\n</ol>\n<h3 id=\"925\">9.2.5 \u81ea\u9002\u5e94\u5ef6\u8fdf\u8865\u507f\u7b56\u7565</h3>\n<p>\u4e3a\u7f13\u89e3\u5ef6\u8fdf\u5e26\u6765\u7684\u8d1f\u9762\u5f71\u54cd\uff0c\u7814\u7a76\u8005\u63d0\u51fa\u4e86\u591a\u79cd\u8865\u507f\u7b56\u7565\uff1a</p>\n<p><strong>\u68af\u5ea6\u8865\u507f\uff08Gradient Compensation\uff09</strong>\uff1a\u4f30\u8ba1\u5ef6\u8fdf\u671f\u95f4\u7684\u53c2\u6570\u53d8\u5316\uff0c\u5bf9\u68af\u5ea6\u8fdb\u884c\u4e00\u9636\u4fee\u6b63\uff1a\n$$\\tilde{\\nabla} f(\\mathbf{w}_{t-\\tau}) = \\nabla f(\\mathbf{w}_{t-\\tau}) + \\lambda \\mathbf{H}(\\mathbf{w}_t - \\mathbf{w}_{t-\\tau})$$\n\u5176\u4e2d$\\lambda \\in [0,1]$\u662f\u8865\u507f\u7cfb\u6570\uff0c$\\mathbf{H}$\u662fHessian\u8fd1\u4f3c\uff08\u5982\u5bf9\u89d2\u8fd1\u4f3c\uff09\u3002</p>\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a\u8865\u507f\u540e\u7684\u8bef\u5dee\u754c\u53d8\u4e3a\uff1a\n$$\\mathbb{E}[|\\tilde{\\nabla} f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)|^2] \\leq (1-\\lambda)^2 L^2 |\\mathbf{w}_t - \\mathbf{w}_{t-\\tau}|^2 + \\lambda^2 |\\mathbf{H} - \\mathbf{H}_{\\text{true}}|^2 |\\mathbf{w}_t - \\mathbf{w}_{t-\\tau}|^2$$\n\u6700\u4f18\u8865\u507f\u7cfb\u6570\uff1a$\\lambda^* = \\frac{L^2}{L^2 + |\\mathbf{H} - \\mathbf{H}_{\\text{true}}|^2}$</p>\n<p><strong>\u5ef6\u8fdf\u611f\u77e5\u5b66\u4e60\u7387\uff08Delay-Adaptive Learning Rate\uff09</strong>\uff1a\u6839\u636e\u5b9e\u9645\u5ef6\u8fdf\u52a8\u6001\u8c03\u6574\u5b66\u4e60\u7387\uff1a\n$$\\eta_{i,t} = \\frac{\\eta_0}{\\sqrt{t}(1 + \\tau_{i,t}/\\tau_0)}$$\n\u8fd9\u79cd\u65b9\u6cd5\u7b80\u5355\u6709\u6548\uff0c\u65e0\u9700\u989d\u5916\u8ba1\u7b97\u5f00\u9500\u3002</p>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\u4f7f\u7528\u5ef6\u8fdf\u611f\u77e5\u5b66\u4e60\u7387\u540e\uff1a\n$$\\mathbb{E}[f(\\bar{\\mathbf{w}}_T) - f^*] \\leq O\\left(\\frac{1}{\\sqrt{T}} + \\frac{\\log(\\tau_{\\max})}{T}\\right)$$\n\u6539\u8fdb\u4e86\u5bf9\u5ef6\u8fdf\u7684\u4f9d\u8d56\u4ece$O(\\tau_{\\max}^2)$\u5230$O(\\log(\\tau_{\\max}))$\u3002</p>\n<p><strong>\u91cd\u8981\u6027\u91c7\u6837\uff08Importance Sampling\uff09</strong>\uff1a\u5bf9\u5ef6\u8fdf\u68af\u5ea6\u8d4b\u4e88\u4e0d\u540c\u6743\u91cd\uff1a\n$$\\mathbf{w}_{t+1} = \\mathbf{w}_t - \\eta_t \\sum_i \\frac{p_{i,t}}{q_{i,t}} \\nabla f_i(\\mathbf{w}_{t-\\tau_{i,t}})$$\n\u5176\u4e2d$p_{i,t}$\u662f\u7406\u60f3\u91c7\u6837\u6982\u7387\uff0c$q_{i,t}$\u662f\u5b9e\u9645\u91c7\u6837\u6982\u7387\u3002</p>\n<p><strong>\u6700\u4f18\u91cd\u8981\u6027\u6743\u91cd</strong>\uff1a\u6700\u5c0f\u5316\u65b9\u5dee\u7684\u6743\u91cd\u4e3a\uff1a\n$$\\frac{p_{i,t}}{q_{i,t}} = \\frac{1/\\sqrt{1 + \\tau_{i,t}}}{\\sum_j 1/\\sqrt{1 + \\tau_{j,t}}}$$</p>\n<h3 id=\"926\">9.2.6 \u5ef6\u8fdf\u5206\u6790\u7684\u9ad8\u7ea7\u6280\u5de7</h3>\n<p><strong>Lyapunov\u51fd\u6570\u65b9\u6cd5</strong>\uff1a\u6784\u9020\u5408\u9002\u7684Lyapunov\u51fd\u6570$V(\\mathbf{w}_t, \\boldsymbol{\\tau}_t)$\uff0c\u540c\u65f6\u8003\u8651\u53c2\u6570\u548c\u5ef6\u8fdf\u72b6\u6001\uff1a\n$$\\mathbb{E}[V(\\mathbf{w}_{t+1}, \\boldsymbol{\\tau}_{t+1}) | \\mathcal{F}_t] \\leq (1-\\rho)V(\\mathbf{w}_t, \\boldsymbol{\\tau}_t) + \\epsilon_t$$\n\u8fd9\u63d0\u4f9b\u4e86\u66f4\u7cbe\u7ec6\u7684\u6536\u655b\u6027\u5206\u6790\u5de5\u5177\u3002</p>\n<p><strong>\u793a\u4f8bLyapunov\u51fd\u6570</strong>\uff1a\n$$V(\\mathbf{w}_t, \\boldsymbol{\\tau}_t) = |\\mathbf{w}_t - \\mathbf{w}^*|^2 + \\beta \\sum_{i=1}^P \\sum_{s=t-\\tau_i}^{t-1} |\\mathbf{w}_{s+1} - \\mathbf{w}_s|^2$$\n\u7b2c\u4e8c\u9879\u6355\u83b7\u4e86\u5ef6\u8fdf\u5e26\u6765\u7684\"\u52bf\u80fd\"\u3002</p>\n<p><strong>\u6270\u52a8\u5206\u6790\uff08Perturbation Analysis\uff09</strong>\uff1a\u5c06\u5f02\u6b65\u66f4\u65b0\u89c6\u4e3a\u540c\u6b65\u66f4\u65b0\u7684\u6270\u52a8\uff1a\n$$\\mathbf{w}_{t+1}^{\\text{async}} = \\mathbf{w}_{t+1}^{\\text{sync}} + \\mathbf{e}_t$$\n\u5206\u6790\u6270\u52a8\u9879$\\mathbf{e}_t$\u7684\u7d2f\u79ef\u6548\u5e94\uff0c\u5229\u7528\u9c81\u68d2\u4f18\u5316\u7406\u8bba\u5f97\u5230\u6536\u655b\u754c\u3002</p>\n<p><strong>\u6270\u52a8\u7684\u754c</strong>\uff1a\n$$|\\mathbf{e}_t| \\leq \\eta_t \\sum_{i \\in \\mathcal{A}_t} |\\nabla f(\\mathbf{w}_{t-\\tau_i}) - \\nabla f(\\mathbf{w}_t)| \\leq \\eta_t |\\mathcal{A}_t| LG\\eta\\tau_{\\max}$$\n<strong>\u8026\u5408\u6280\u672f\uff08Coupling Technique\uff09</strong>\uff1a\u6784\u9020\u5f02\u6b65\u8fc7\u7a0b\u4e0e\u865a\u62df\u540c\u6b65\u8fc7\u7a0b\u7684\u8026\u5408\uff0c\u901a\u8fc7\u5206\u6790\u4e24\u8005\u8ddd\u79bb\u7684\u6f14\u5316\u6765\u63a8\u5bfc\u6536\u655b\u6027\u3002\u8fd9\u5728\u5206\u6790\u590d\u6742\u5ef6\u8fdf\u6a21\u5f0f\u65f6\u7279\u522b\u6709\u7528\u3002</p>\n<p><strong>\u8026\u5408\u6784\u9020</strong>\uff1a\u5b9a\u4e49\u865a\u62df\u540c\u6b65\u5e8f\u5217${\\tilde{\\mathbf{w}}_t}$\uff1a\n$$\\tilde{\\mathbf{w}}_{t+1} = \\tilde{\\mathbf{w}}_t - \\eta_t \\frac{1}{|\\mathcal{A}_t|}\\sum_{i \\in \\mathcal{A}_t} \\nabla f(\\tilde{\\mathbf{w}}_t)$$\n\u5206\u6790$\\Delta_t = |\\mathbf{w}_t - \\tilde{\\mathbf{w}}_t|^2$\u7684\u6f14\u5316\u3002</p>\n<h3 id=\"927\">9.2.7 \u5ef6\u8fdf\u5206\u5e03\u7684\u7cbe\u7ec6\u523b\u753b</h3>\n<p><strong>\u5ef6\u8fdf\u7684\u968f\u673a\u51e0\u4f55</strong>\uff1a\u5c06\u5ef6\u8fdf\u5efa\u6a21\u4e3a\u968f\u673a\u56fe\u4e0a\u7684\u8def\u5f84\u957f\u5ea6</p>\n<ul>\n<li>\u8282\u70b9\uff1a\u8ba1\u7b97\u5355\u5143</li>\n<li>\u8fb9\uff1a\u901a\u4fe1\u94fe\u8def</li>\n<li>\u5ef6\u8fdf\uff1a\u6700\u77ed\u8def\u5f84\u957f\u5ea6</li>\n</ul>\n<p><strong>\u6392\u961f\u8bba\u89c6\u89d2</strong>\uff1a\u4f7f\u7528M/M/1\u6216M/G/1\u961f\u5217\u6a21\u578b\n$$P(\\tau &gt; t) = e^{-(\\mu - \\lambda)t}$$\n\u5176\u4e2d$\\lambda$\u662f\u5230\u8fbe\u7387\uff0c$\\mu$\u662f\u670d\u52a1\u7387\u3002</p>\n<p><strong>\u76f8\u53d8\u73b0\u8c61</strong>\uff1a\u5f53\u7cfb\u7edf\u8d1f\u8f7d\u63a5\u8fd1\u4e34\u754c\u503c\u65f6\uff0c\u5ef6\u8fdf\u5206\u5e03\u53d1\u751f\u8d28\u53d8\n$$\\tau \\sim \\begin{cases}\nO(1) &amp; \\text{if } \\rho &lt; \\rho_c \\\nO(\\sqrt{n}) &amp; \\text{if } \\rho = \\rho_c \\\nO(n) &amp; \\text{if } \\rho &gt; \\rho_c\n\\end{cases}$$\n\u5176\u4e2d$\\rho = \\lambda/\\mu$\u662f\u5229\u7528\u7387\uff0c$\\rho_c$\u662f\u4e34\u754c\u503c\u3002</p>\n<h2 id=\"93-lock-free\">9.3 Lock-free\u7b97\u6cd5\u8bbe\u8ba1</h2>\n<h3 id=\"931\">9.3.1 \u5e76\u53d1\u63a7\u5236\u7684\u6570\u5b66\u62bd\u8c61</h3>\n<p>\u5728\u5171\u4eab\u5185\u5b58\u7cfb\u7edf\u4e2d\uff0c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u53c2\u6570\u5411\u91cf\u4f1a\u5bfc\u81f4\u7ade\u6001\u6761\u4ef6\u3002\u4f20\u7edf\u89e3\u51b3\u65b9\u6848\u4f7f\u7528\u9501\u673a\u5236\uff0c\u4f46\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u4f1a\u6210\u4e3a\u6027\u80fd\u74f6\u9888\u3002Lock-free\u7b97\u6cd5\u901a\u8fc7\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u539f\u5b50\u64cd\u4f5c\u907f\u514d\u663e\u5f0f\u9501\u5b9a\u3002</p>\n<p><strong>\u5185\u5b58\u4e00\u81f4\u6027\u6a21\u578b</strong>\uff1a\u5b9a\u4e49\u4e86\u5e76\u53d1\u64cd\u4f5c\u7684\u53ef\u89c1\u6027\u89c4\u5219\u3002\u5e38\u89c1\u6a21\u578b\u5305\u62ec\uff1a</p>\n<ul>\n<li>\u987a\u5e8f\u4e00\u81f4\u6027\uff08Sequential Consistency\uff09</li>\n<li>\u5b8c\u5168\u5b58\u50a8\u6392\u5e8f\uff08Total Store Order, TSO\uff09</li>\n<li>\u677e\u6563\u5185\u5b58\u6a21\u578b\uff08Relaxed Memory Model\uff09</li>\n</ul>\n<p><strong>\u539f\u5b50\u64cd\u4f5c\u7684\u6570\u5b66\u8bed\u4e49</strong>\uff1a</p>\n<ul>\n<li>Compare-And-Swap (CAS)\uff1a$\\text{CAS}(\\text{addr}, \\text{old}, \\text{new})$</li>\n<li>Fetch-And-Add (FAA)\uff1a$\\text{FAA}(\\text{addr}, \\text{delta})$</li>\n<li>Load-Link/Store-Conditional (LL/SC)</li>\n</ul>\n<p>\u8fd9\u4e9b\u64cd\u4f5c\u7684\u7ebf\u6027\u5316\u70b9\uff08linearization point\uff09\u5b9a\u4e49\u4e86\u5e76\u53d1\u6267\u884c\u7684\u7b49\u6548\u4e32\u884c\u987a\u5e8f\u3002</p>\n<h3 id=\"932-hogwild\">9.3.2 HOGWILD!\u7b97\u6cd5\u6df1\u5ea6\u5256\u6790</h3>\n<p>HOGWILD!\u662f\u6700\u8457\u540d\u7684lock-free\u5f02\u6b65SGD\u7b97\u6cd5\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u5b8c\u5168\u653e\u5f03\u540c\u6b65\uff0c\u5141\u8bb8\u5e76\u53d1\u8bfb\u5199\u51b2\u7a81\u3002</p>\n<p><strong>\u7b97\u6cd5\u4f2a\u4ee3\u7801</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">parallel</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"k\">each</span><span class=\"w\"> </span><span class=\"n\">processor</span><span class=\"w\"> </span><span class=\"nl\">p</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"ow\">not</span><span class=\"w\"> </span><span class=\"nl\">converged</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"n\">sample</span><span class=\"w\"> </span><span class=\"n\">mini</span><span class=\"o\">-</span><span class=\"n\">batch</span><span class=\"w\"> </span><span class=\"n\">B_p</span>\n<span class=\"w\">        </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">compute_gradient</span><span class=\"p\">(</span><span class=\"n\">w</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">B_p</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u8bfb\u64cd\u4f5c</span><span class=\"err\">\uff0c</span><span class=\"n\">\u53ef\u80fd\u8bfb\u5230\u4e0d\u4e00\u81f4\u72b6\u6001</span>\n<span class=\"w\">        </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"k\">each</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"n\">sparse</span><span class=\"p\">(</span><span class=\"n\">g</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">            </span><span class=\"n\">w</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">-=</span><span class=\"w\"> </span><span class=\"n\">\u03b7</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\">           </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u5199\u64cd\u4f5c</span><span class=\"err\">\uff0c</span><span class=\"n\">\u53ef\u80fd\u4ea7\u751f\u7ade\u6001</span>\n</code></pre></div>\n\n<p><strong>\u7a00\u758f\u6027\u5047\u8bbe</strong>\uff1aHOGWILD!\u7684\u7406\u8bba\u4fdd\u8bc1\u4f9d\u8d56\u4e8e\u68af\u5ea6\u7a00\u758f\u6027\u3002\u5b9a\u4e49\u7a00\u758f\u5ea6\uff1a\n$$\\Omega = \\max_e \\sum_{f \\in E: e \\in f} |\\text{supp}(f)|$$\n\u5176\u4e2d$e$\u662f\u53c2\u6570\u5206\u91cf\uff0c$E$\u662f\u6837\u672c\u96c6\u5408\uff0c$\\text{supp}(f)$\u662f\u6837\u672c$f$\u7684\u68af\u5ea6\u652f\u6491\u96c6\u3002</p>\n<p><strong>\u5b9a\u74069.3</strong>\uff08HOGWILD!\u6536\u655b\u6027\uff09\uff1a\u5728\u7a00\u758f\u5ea6$\\Omega$\u6709\u754c\u7684\u6761\u4ef6\u4e0b\uff0cHOGWILD!\u4ee5\u63a5\u8fd1\u4e32\u884cSGD\u7684\u901f\u7387\u6536\u655b\uff1a\n$$\\mathbb{E}[|\\mathbf{w}_T - \\mathbf{w}^*|^2] \\leq O\\left(\\frac{\\Omega^2 \\log T}{T}\\right)$$\n\u5173\u952e\u6d1e\u5bdf\u662f\u7a00\u758f\u6027\u9650\u5236\u4e86\u5e76\u53d1\u51b2\u7a81\u7684\u6982\u7387\u3002</p>\n<h3 id=\"933\">9.3.3 \u65e0\u9501\u6570\u636e\u7ed3\u6784\u5728\u4f18\u5316\u4e2d\u7684\u5e94\u7528</h3>\n<p><strong>Lock-free\u961f\u5217</strong>\uff1a\u7528\u4e8e\u4efb\u52a1\u5206\u53d1\u548c\u68af\u5ea6\u805a\u5408\u3002Michael &amp; Scott\u961f\u5217\u662f\u7ecf\u5178\u5b9e\u73b0\uff1a</p>\n<ul>\n<li>\u4f7f\u7528CAS\u64cd\u4f5c\u66f4\u65b0\u5934\u5c3e\u6307\u9488</li>\n<li>ABA\u95ee\u9898\u901a\u8fc7\u7248\u672c\u53f7\u6216\u5371\u9669\u6307\u9488\u89e3\u51b3</li>\n</ul>\n<p><strong>\u5e76\u53d1\u54c8\u5e0c\u8868</strong>\uff1a\u5b58\u50a8\u6a21\u578b\u53c2\u6570\uff0c\u652f\u6301\u52a8\u6001\u6269\u5bb9\uff1a</p>\n<ul>\n<li>\u5206\u6bb5\u9501\u5b9a\uff08striped locking\uff09\u964d\u4f4e\u7ade\u4e89</li>\n<li>Cuckoo hashing\u63d0\u4f9b\u6700\u574f\u60c5\u51b5\u4fdd\u8bc1</li>\n</ul>\n<p><strong>\u539f\u5b50\u6d6e\u70b9\u8fd0\u7b97</strong>\uff1a\u73b0\u4ee3\u786c\u4ef6\u652f\u6301\u539f\u5b50\u6d6e\u70b9\u52a0\u6cd5\uff0c\u4f46\u7cbe\u5ea6\u95ee\u9898\u9700\u8981\u6ce8\u610f\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u5b9a\u70b9\u6570\u8868\u793a\u907f\u514d\u820d\u5165\u8bef\u5dee\u7d2f\u79ef</li>\n<li>Kahan\u6c42\u548c\u7b97\u6cd5\u63d0\u9ad8\u6570\u503c\u7a33\u5b9a\u6027</li>\n</ul>\n<h3 id=\"934-lock-free\">9.3.4 \u9ad8\u7ea7Lock-free\u6280\u672f</h3>\n<p><strong>\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\uff08Optimistic Concurrency Control\uff09</strong>\uff1a</p>\n<ol>\n<li>\u8bfb\u53d6\u53c2\u6570\u7248\u672c\u53f7\u548c\u503c</li>\n<li>\u8ba1\u7b97\u66f4\u65b0</li>\n<li>\u4f7f\u7528CAS\u9a8c\u8bc1\u7248\u672c\u53f7\u5e76\u66f4\u65b0</li>\n<li>\u5931\u8d25\u5219\u91cd\u8bd5</li>\n</ol>\n<p>\u8fd9\u79cd\u65b9\u6cd5\u5728\u4f4e\u7ade\u4e89\u60c5\u51b5\u4e0b\u6027\u80fd\u4f18\u5f02\u3002</p>\n<p><strong>NUMA\u611f\u77e5\u7684Lock-free\u8bbe\u8ba1</strong>\uff1a</p>\n<ul>\n<li>\u53c2\u6570\u5206\u533a\u5bf9\u9f50NUMA\u8282\u70b9</li>\n<li>\u4f7f\u7528\u672c\u5730\u526f\u672c\u51cf\u5c11\u8de8\u8282\u70b9\u8bbf\u95ee</li>\n<li>\u5b9a\u671f\u540c\u6b65\u4fdd\u6301\u4e00\u81f4\u6027</li>\n</ul>\n<p><strong>Wait-free\u7b97\u6cd5</strong>\uff1a\u6bd4lock-free\u66f4\u5f3a\u7684\u4fdd\u8bc1\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u5728\u6709\u9650\u6b65\u5185\u5b8c\u6210\uff1a</p>\n<ul>\n<li>\u4f7f\u7528helping\u673a\u5236</li>\n<li>\u7a7a\u95f4\u5f00\u9500\u901a\u5e38\u8f83\u5927</li>\n<li>\u5728\u5b9e\u65f6\u7cfb\u7edf\u4e2d\u6709\u5e94\u7528</li>\n</ul>\n<h3 id=\"935\">9.3.5 \u6b63\u786e\u6027\u9a8c\u8bc1\u6280\u672f</h3>\n<p><strong>\u7ebf\u6027\u5316\u9a8c\u8bc1</strong>\uff1a\u68c0\u67e5\u5e76\u53d1\u6267\u884c\u662f\u5426\u7b49\u4ef7\u4e8e\u67d0\u4e2a\u4e32\u884c\u6267\u884c\uff1a</p>\n<ul>\n<li>Wing-Gong\u7ebf\u6027\u5316\u68c0\u67e5\u7b97\u6cd5</li>\n<li>\u57fa\u4e8ehappens-before\u5173\u7cfb\u7684\u9a8c\u8bc1</li>\n</ul>\n<p><strong>\u4e0d\u53d8\u91cf\u9a8c\u8bc1</strong>\uff1a\u8bc6\u522b\u5e76\u9a8c\u8bc1\u7b97\u6cd5\u4fdd\u6301\u7684\u5173\u952e\u4e0d\u53d8\u91cf\uff1a</p>\n<ul>\n<li>\u53c2\u6570\u754c\u9650\uff1a$|\\mathbf{w}_t| \\leq R$</li>\n<li>\u80fd\u91cf\u9012\u51cf\uff1a$f(\\mathbf{w}_t)$\u975e\u589e\uff08\u8fd1\u4f3c\uff09</li>\n</ul>\n<p><strong>\u6a21\u578b\u68c0\u6d4b</strong>\uff1a\u4f7f\u7528TLA+\u6216Promela\u7b49\u5f62\u5f0f\u5316\u5de5\u5177\uff1a</p>\n<ul>\n<li>\u7a77\u4e3e\u5c0f\u89c4\u6a21\u573a\u666f\u7684\u6240\u6709\u53ef\u80fd\u6267\u884c</li>\n<li>\u53d1\u73b0\u6f5c\u5728\u7684\u7ade\u6001\u6761\u4ef6\u548c\u6b7b\u9501</li>\n</ul>\n<h2 id=\"94\">9.4 \u5c40\u90e8\u4e00\u81f4\u6027\u4e0e\u5168\u5c40\u6536\u655b</h2>\n<h3 id=\"941\">9.4.1 \u4e00\u81f4\u6027\u6a21\u578b\u7684\u5c42\u6b21\u7ed3\u6784</h3>\n<p>\u5728\u5206\u5e03\u5f0f\u4f18\u5316\u4e2d\uff0c\u4e0d\u540c\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1\u5f62\u6210\u4e86\u4e00\u4e2a\u6743\u8861\u8c31\u7cfb\uff0c\u4ece\u5f3a\u5230\u5f31\u5305\u62ec\uff1a</p>\n<p><strong>\u5f3a\u4e00\u81f4\u6027\uff08Strong Consistency\uff09</strong>\uff1a\u6240\u6709\u8282\u70b9\u5728\u4efb\u610f\u65f6\u523b\u770b\u5230\u76f8\u540c\u7684\u53c2\u6570\u503c\u3002\u5b9e\u73b0\u4ee3\u4ef7\u9ad8\u6602\uff0c\u901a\u5e38\u9700\u8981\u5168\u5c40\u540c\u6b65\u3002</p>\n<p><strong>\u6709\u754c\u4e0d\u4e00\u81f4\u6027\uff08Bounded Inconsistency\uff09</strong>\uff1a\u53c2\u6570\u7248\u672c\u5dee\u5f02\u6709\u4e0a\u754c\uff1a\n$$|\\mathbf{w}_i^{(t)} - \\mathbf{w}_j^{(t)}| \\leq \\Delta, \\quad \\forall i,j$$\n<strong>\u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventual Consistency\uff09</strong>\uff1a\u7cfb\u7edf\u6700\u7ec8\u6536\u655b\u5230\u4e00\u81f4\u72b6\u6001\uff0c\u4f46\u4e2d\u95f4\u53ef\u80fd\u5b58\u5728\u4efb\u610f\u5927\u7684\u4e0d\u4e00\u81f4\u3002</p>\n<p><strong>\u56e0\u679c\u4e00\u81f4\u6027\uff08Causal Consistency\uff09</strong>\uff1a\u4fdd\u6301\u64cd\u4f5c\u95f4\u7684\u56e0\u679c\u5173\u7cfb\uff0c\u4f46\u5141\u8bb8\u5e76\u53d1\u64cd\u4f5c\u7684\u4e0d\u540c\u89c2\u5bdf\u987a\u5e8f\u3002</p>\n<h3 id=\"942\">9.4.2 \u90e8\u5206\u540c\u6b65\u6846\u67b6</h3>\n<p>\u90e8\u5206\u540c\u6b65\uff08Partially Synchronous\uff09\u6a21\u578b\u5728\u5b8c\u5168\u5f02\u6b65\u548c\u5b8c\u5168\u540c\u6b65\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\uff1a</p>\n<p><strong>Stale Synchronous Parallel (SSP)</strong>\uff1a\u5141\u8bb8\u6700\u5feb\u548c\u6700\u6162\u8282\u70b9\u4e4b\u95f4\u6700\u591a\u76f8\u5dee$s$\u4e2a\u8fed\u4ee3\uff1a\n$$\\max_i c_i - \\min_j c_j \\leq s$$\n\u5176\u4e2d$c_i$\u662f\u8282\u70b9$i$\u7684\u65f6\u949f\uff08\u8fed\u4ee3\u8ba1\u6570\uff09\u3002</p>\n<p><strong>\u5b9a\u74069.4</strong>\uff08SSP\u6536\u655b\u6027\uff09\uff1a\u5728SSP\u6a21\u578b\u4e0b\uff0c\u9009\u62e9\u5408\u9002\u7684\u5b66\u4e60\u7387$\\eta = O(1/\\sqrt{sT})$\uff0c\u6709\uff1a\n$$\\mathbb{E}[f(\\bar{\\mathbf{w}}_T) - f^*] \\leq O\\left(\\frac{s}{\\sqrt{T}}\\right)$$\n\u8fd9\u8868\u660e\u677e\u5f1b\u5ea6$s$\u76f4\u63a5\u5f71\u54cd\u6536\u655b\u901f\u7387\u3002</p>\n<p><strong>Flexible Synchronous Parallel</strong>\uff1a\u52a8\u6001\u8c03\u6574\u540c\u6b65\u9891\u7387\uff0c\u57fa\u4e8e\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u65b9\u5dee\u4f30\u8ba1</li>\n<li>\u7f51\u7edc\u8d1f\u8f7d</li>\n<li>\u6536\u655b\u8fdb\u5ea6</li>\n</ul>\n<h3 id=\"943\">9.4.3 \u5c40\u90e8\u66f4\u65b0\u4e0e\u5168\u5c40\u805a\u5408</h3>\n<p><strong>Local SGD</strong>\uff1a\u6bcf\u4e2a\u8282\u70b9\u6267\u884c$H$\u6b65\u5c40\u90e8\u66f4\u65b0\u540e\u8fdb\u884c\u5168\u5c40\u5e73\u5747\uff1a\n$$\\mathbf{w}_i^{(t+1)} = \\begin{cases}\n\\mathbf{w}_i^{(t)} - \\eta \\nabla f_i(\\mathbf{w}_i^{(t)}, \\xi_i^{(t)}) &amp; \\text{if } t \\bmod H \\neq 0 \\\n\\frac{1}{P}\\sum_{j=1}^P \\mathbf{w}_j^{(t)} &amp; \\text{if } t \\bmod H = 0\n\\end{cases}$$\n<strong>\u6536\u655b\u6027\u5206\u6790\u7684\u5173\u952e</strong>\uff1a\u5206\u6790\u5c40\u90e8\u6a21\u578b\u7684\u53d1\u6563\u7a0b\u5ea6\uff1a\n$$\\mathcal{D}_t = \\frac{1}{P}\\sum_{i=1}^P |\\mathbf{w}_i^{(t)} - \\bar{\\mathbf{w}}^{(t)}|^2$$\n\u5176\u4e2d$\\bar{\\mathbf{w}}^{(t)} = \\frac{1}{P}\\sum_{i=1}^P \\mathbf{w}_i^{(t)}$\u662f\u5e73\u5747\u6a21\u578b\u3002</p>\n<p><strong>\u5b9a\u74069.5</strong>\uff08Local SGD\u7684\u6536\u655b\u6027\uff09\uff1a\u5728$\\beta$-smooth\u548c$\\mu$-strongly convex\u6761\u4ef6\u4e0b\uff1a\n$$\\mathbb{E}[\\mathcal{D}_t] \\leq \\frac{H^2G^2}{P} + O(H\\eta^2)$$\n\u8fd9\u7ed9\u51fa\u4e86\u901a\u4fe1\u9891\u7387$1/H$\u4e0e\u6a21\u578b\u4e00\u81f4\u6027\u7684\u6743\u8861\u3002</p>\n<h3 id=\"944\">9.4.4 \u62dc\u5360\u5ead\u9c81\u68d2\u6027</h3>\n<p>\u5728\u5b58\u5728\u6076\u610f\u6216\u6545\u969c\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u62dc\u5360\u5ead\u5bb9\u9519\uff08Byzantine-robust\uff09\u7b97\u6cd5\uff1a</p>\n<p><strong>\u9c81\u68d2\u805a\u5408\u89c4\u5219</strong>\uff1a</p>\n<ul>\n<li><strong>\u4e2d\u4f4d\u6570\uff08Coordinate-wise Median\uff09</strong>\uff1a$[\\text{med}(\\mathbf{w})]_j = \\text{median}{[\\mathbf{w}_i]_j}_{i=1}^P$</li>\n<li><strong>\u51e0\u4f55\u4e2d\u4f4d\u6570\uff08Geometric Median\uff09</strong>\uff1a$\\arg\\min_{\\mathbf{x}} \\sum_{i=1}^P |\\mathbf{x} - \\mathbf{w}_i|$</li>\n<li><strong>\u4fee\u526a\u5747\u503c\uff08Trimmed Mean\uff09</strong>\uff1a\u53bb\u9664\u6781\u503c\u540e\u5e73\u5747</li>\n</ul>\n<p><strong>\u5b9a\u74069.6</strong>\uff08\u62dc\u5360\u5eadSGD\uff09\uff1a\u5047\u8bbe\u6700\u591a$f &lt; P/2$\u4e2a\u62dc\u5360\u5ead\u8282\u70b9\uff0c\u4f7f\u7528\u51e0\u4f55\u4e2d\u4f4d\u6570\u805a\u5408\uff0c\u6709\uff1a\n$$\\mathbb{E}[|\\mathbf{w}_T - \\mathbf{w}^*|^2] \\leq O\\left(\\frac{1}{T} + \\frac{f^2}{P^2}\\right)$$</p>\n<h3 id=\"945\">9.4.5 \u53bb\u4e2d\u5fc3\u5316\u4f18\u5316</h3>\n<p>\u5b8c\u5168\u53bb\u4e2d\u5fc3\u5316\u7684\u8bbe\u7f6e\u4e2d\uff0c\u8282\u70b9\u4ec5\u4e0e\u90bb\u5c45\u901a\u4fe1\uff0c\u65e0\u4e2d\u5fc3\u534f\u8c03\u5668\uff1a</p>\n<p><strong>\u5171\u8bc6\u4f18\u5316\uff08Consensus Optimization\uff09</strong>\uff1a\n$$\\mathbf{w}_i^{(t+1)} = \\sum_{j \\in \\mathcal{N}_i} a_{ij} \\mathbf{w}_j^{(t)} - \\eta \\nabla f_i(\\mathbf{w}_i^{(t)})$$\n\u5176\u4e2d$a_{ij}$\u662f\u901a\u4fe1\u77e9\u9635\u7684\u5143\u7d20\uff0c$\\mathcal{N}_i$\u662f\u8282\u70b9$i$\u7684\u90bb\u5c45\u96c6\u3002</p>\n<p><strong>\u8c31\u9699\u4e0e\u6536\u655b\u901f\u7387</strong>\uff1a\u901a\u4fe1\u56fe\u7684\u8c31\u9699$1-\\lambda_2(\\mathbf{A})$\u51b3\u5b9a\u4e86\u4fe1\u606f\u4f20\u64ad\u901f\u5ea6\uff0c\u5176\u4e2d$\\lambda_2$\u662f\u7b2c\u4e8c\u5927\u7279\u5f81\u503c\u3002</p>\n<p><strong>\u52a0\u901f\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li><strong>Chebyshev\u52a0\u901f</strong>\uff1a\u5229\u7528Chebyshev\u591a\u9879\u5f0f\u52a0\u901f\u5171\u8bc6</li>\n<li><strong>\u591a\u6b65\u901a\u4fe1</strong>\uff1a\u6bcf\u6b21\u68af\u5ea6\u66f4\u65b0\u6267\u884c\u591a\u8f6e\u901a\u4fe1</li>\n<li><strong>\u52a8\u6001\u62d3\u6251</strong>\uff1a\u968f\u65f6\u95f4\u6539\u53d8\u901a\u4fe1\u56fe\u63d0\u9ad8\u8fde\u901a\u6027</li>\n</ul>\n<h2 id=\"95\">9.5 \u786c\u4ef6\u611f\u77e5\u7684\u7b97\u6cd5\u8c03\u4f18</h2>\n<h3 id=\"951\">9.5.1 \u5185\u5b58\u5c42\u6b21\u7ed3\u6784\u4e0e\u7b97\u6cd5\u8bbe\u8ba1</h3>\n<p>\u73b0\u4ee3\u8ba1\u7b97\u7cfb\u7edf\u7684\u5185\u5b58\u5c42\u6b21\u5bf9\u5f02\u6b65\u7b97\u6cd5\u6027\u80fd\u6709\u51b3\u5b9a\u6027\u5f71\u54cd\uff1a</p>\n<p><strong>\u7f13\u5b58\u884c\uff08Cache Line\uff09\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u5178\u578b\u5927\u5c0f\uff1a64\u5b57\u8282</li>\n<li>False sharing\u95ee\u9898\uff1a\u4e0d\u540c\u7ebf\u7a0b\u66f4\u65b0\u540c\u4e00\u7f13\u5b58\u884c\u7684\u4e0d\u540c\u90e8\u5206</li>\n<li>\u89e3\u51b3\u65b9\u6848\uff1a\u53c2\u6570padding\u548c\u5bf9\u9f50</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code>struct alignas(64) ParameterBlock {\n    float values[16];  // 64 bytes\n};\n</code></pre></div>\n\n<p><strong>\u5185\u5b58\u5e26\u5bbd\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li><strong>\u6279\u91cf\u66f4\u65b0</strong>\uff1a\u7d2f\u79ef\u591a\u4e2a\u68af\u5ea6\u540e\u4e00\u6b21\u6027\u66f4\u65b0\uff0c\u51cf\u5c11\u5185\u5b58\u8bbf\u95ee</li>\n<li><strong>\u6d41\u5f0f\u5904\u7406</strong>\uff1a\u5229\u7528\u786c\u4ef6\u9884\u53d6\u548c\u5411\u91cf\u5316\u6307\u4ee4</li>\n<li><strong>\u6570\u636e\u5e03\u5c40</strong>\uff1aStructure of Arrays (SoA) vs Array of Structures (AoS)</li>\n</ul>\n<p><strong>\u5206\u5c42\u5b58\u50a8\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>L1/L2\u7f13\u5b58\uff1a\u5b58\u50a8\u70ed\u70b9\u53c2\u6570</li>\n<li>L3\u7f13\u5b58\uff1a\u5de5\u4f5c\u96c6\u7f13\u51b2</li>\n<li>\u4e3b\u5b58\uff1a\u5b8c\u6574\u6a21\u578b</li>\n<li>NVMe SSD\uff1a\u8d85\u5927\u6a21\u578b\u7684\u53c2\u6570\u4ea4\u6362</li>\n</ul>\n<h3 id=\"952-numa\">9.5.2 NUMA\u67b6\u6784\u4e0b\u7684\u4f18\u5316\u7b56\u7565</h3>\n<p>Non-Uniform Memory Access (NUMA) \u7cfb\u7edf\u4e2d\uff0c\u5185\u5b58\u8bbf\u95ee\u5ef6\u8fdf\u53d6\u51b3\u4e8e\u5904\u7406\u5668\u548c\u5185\u5b58\u7684\u7269\u7406\u4f4d\u7f6e\uff1a</p>\n<p><strong>NUMA\u611f\u77e5\u7684\u53c2\u6570\u5206\u533a</strong>\uff1a\n$$\\mathbf{w} = [\\mathbf{w}_1, \\mathbf{w}_2, ..., \\mathbf{w}_N]$$\n\u5176\u4e2d$\\mathbf{w}_i$\u7ed1\u5b9a\u5230NUMA\u8282\u70b9$i$\u7684\u672c\u5730\u5185\u5b58\u3002</p>\n<p><strong>\u8bbf\u95ee\u6a21\u5f0f\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li><strong>\u672c\u5730\u4f18\u5148</strong>\uff1a\u6bcf\u4e2a\u7ebf\u7a0b\u4f18\u5148\u66f4\u65b0\u672c\u5730NUMA\u8282\u70b9\u7684\u53c2\u6570</li>\n<li><strong>\u6279\u91cf\u8fdc\u7a0b\u8bbf\u95ee</strong>\uff1a\u7d2f\u79ef\u8fdc\u7a0b\u66f4\u65b0\uff0c\u51cf\u5c11\u8de8\u8282\u70b9\u901a\u4fe1</li>\n<li><strong>\u526f\u672c\u7b56\u7565</strong>\uff1a\u70ed\u70b9\u53c2\u6570\u5728\u591a\u4e2aNUMA\u8282\u70b9\u7ef4\u62a4\u526f\u672c</li>\n</ul>\n<p><strong>\u5b9a\u74069.7</strong>\uff08NUMA\u611f\u77e5\u7b97\u6cd5\u7684\u52a0\u901f\u6bd4\uff09\uff1a\u5047\u8bbe\u672c\u5730/\u8fdc\u7a0b\u5185\u5b58\u8bbf\u95ee\u6bd4\u4e3a$\\rho$\uff0c\u672c\u5730\u8bbf\u95ee\u6bd4\u4f8b\u4e3a$\\alpha$\uff0c\u5219\u76f8\u5bf9\u4e8eNUMA\u65e0\u611f\u77e5\u7b97\u6cd5\u7684\u52a0\u901f\u6bd4\u4e3a\uff1a\n$$S = \\frac{1}{\\alpha + (1-\\alpha)/\\rho}$$</p>\n<h3 id=\"953-gpu\">9.5.3 GPU\u5f02\u6b65\u8ba1\u7b97\u6a21\u5f0f</h3>\n<p>GPU\u7684\u5927\u89c4\u6a21\u5e76\u884c\u67b6\u6784\u4e3a\u5f02\u6b65\u4f18\u5316\u63d0\u4f9b\u4e86\u72ec\u7279\u673a\u4f1a\uff1a</p>\n<p><strong>Warp\u7ea7\u540c\u6b65</strong>\uff1a</p>\n<ul>\n<li>32\u4e2a\u7ebf\u7a0b\u7684warp\u5185\u90e8\u81ea\u7136\u540c\u6b65</li>\n<li>Warp\u5185\u7684\u539f\u5b50\u64cd\u4f5c\u5f00\u9500\u8f83\u4f4e</li>\n<li>\u9002\u5408\u7ec6\u7c92\u5ea6\u5e76\u884c</li>\n</ul>\n<p><strong>Block\u7ea7\u5f02\u6b65</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u540cblock\u72ec\u7acb\u6267\u884c</li>\n<li>\u901a\u8fc7\u5168\u5c40\u5185\u5b58\u901a\u4fe1</li>\n<li>\u9002\u5408\u4e2d\u7b49\u7c92\u5ea6\u4efb\u52a1</li>\n</ul>\n<p><strong>\u591a\u6d41\u5e76\u53d1</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">int</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">num_streams</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">cudaMemcpyAsync</span><span class=\"p\">(...,</span><span class=\"w\"> </span><span class=\"n\">stream</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]);</span>\n<span class=\"w\">    </span><span class=\"n\">kernel</span><span class=\"o\">&lt;&lt;&lt;</span><span class=\"n\">grid</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">stream</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span><span class=\"o\">&gt;&gt;&gt;</span><span class=\"p\">(...);</span>\n<span class=\"w\">    </span><span class=\"n\">cudaMemcpyAsync</span><span class=\"p\">(...,</span><span class=\"w\"> </span><span class=\"n\">stream</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]);</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<p><strong>GPU\u7279\u5b9a\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li><strong>Tensor Core\u5229\u7528</strong>\uff1a\u6df7\u5408\u7cbe\u5ea6\u8bad\u7ec3\uff0cFP16\u8ba1\u7b97+FP32\u7d2f\u52a0</li>\n<li><strong>\u5171\u4eab\u5185\u5b58</strong>\uff1ablock\u5185\u7ebf\u7a0b\u7684\u5feb\u901f\u901a\u4fe1</li>\n<li><strong>Warp Shuffle</strong>\uff1a\u65e0\u9700\u5171\u4eab\u5185\u5b58\u7684warp\u5185\u901a\u4fe1</li>\n</ul>\n<h3 id=\"954\">9.5.4 \u901a\u4fe1/\u8ba1\u7b97\u91cd\u53e0\u6280\u672f</h3>\n<p>\u9690\u85cf\u901a\u4fe1\u5ef6\u8fdf\u662f\u5206\u5e03\u5f0f\u5f02\u6b65\u4f18\u5316\u7684\u5173\u952e\uff1a</p>\n<p><strong>\u68af\u5ea6\u538b\u7f29\u4e0e\u91cf\u5316</strong>\uff1a</p>\n<ul>\n<li><strong>Top-k\u7a00\u758f\u5316</strong>\uff1a\u53ea\u4f20\u8f93\u6700\u5927\u7684k\u4e2a\u68af\u5ea6\u5206\u91cf</li>\n<li><strong>\u968f\u673a\u91cf\u5316</strong>\uff1a$Q(g) = \\text{sign}(g) \\cdot |g| \\cdot \\xi$\uff0c\u5176\u4e2d$\\xi \\in {0,1}$</li>\n<li><strong>\u8bef\u5dee\u53cd\u9988</strong>\uff1a\u7d2f\u79ef\u91cf\u5316\u8bef\u5dee\uff0c\u9632\u6b62\u504f\u5dee</li>\n</ul>\n<p><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong>\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u7b2c$i$\u5c42\u68af\u5ea6</li>\n<li>\u540c\u65f6\uff1a\u4f20\u8f93\u7b2c$i$\u5c42\u68af\u5ea6\uff0c\u8ba1\u7b97\u7b2c$i+1$\u5c42\u68af\u5ea6</li>\n<li>\u805a\u5408\u6536\u5230\u7684\u68af\u5ea6\uff0c\u66f4\u65b0\u53c2\u6570</li>\n</ol>\n<p><strong>\u5b9a\u74069.8</strong>\uff08\u901a\u4fe1\u9690\u85cf\u7684\u6761\u4ef6\uff09\uff1a\u8bbe\u8ba1\u7b97\u65f6\u95f4\u4e3a$T_c$\uff0c\u901a\u4fe1\u65f6\u95f4\u4e3a$T_m$\uff0c\u5c42\u6570\u4e3a$L$\uff0c\u5219\u5b8c\u5168\u9690\u85cf\u901a\u4fe1\u7684\u6761\u4ef6\u662f\uff1a\n$$T_c \\geq \\frac{T_m}{L-1}$$\n<strong>\u5c42\u6b21\u5316\u901a\u4fe1</strong>\uff1a</p>\n<ul>\n<li><strong>Ring-AllReduce</strong>\uff1a\u5e26\u5bbd\u6700\u4f18\uff0c\u5ef6\u8fdf$O(P)$</li>\n<li><strong>Tree-AllReduce</strong>\uff1a\u5ef6\u8fdf\u6700\u4f18$O(\\log P)$\uff0c\u5e26\u5bbd\u6b21\u4f18</li>\n<li><strong>Butterfly-AllReduce</strong>\uff1a\u5ef6\u8fdf\u548c\u5e26\u5bbd\u7684\u5e73\u8861</li>\n</ul>\n<h3 id=\"955\">9.5.5 \u786c\u4ef6\u52a0\u901f\u5668\u7684\u534f\u540c\u8bbe\u8ba1</h3>\n<p><strong>TPU\u7684\u7cfb\u7edf\u6027\u504f\u5dee</strong>\uff1a</p>\n<ul>\n<li>\u8109\u52a8\u9635\u5217\u9002\u5408\u77e9\u9635\u4e58\u6cd5</li>\n<li>bfloat16\u6570\u503c\u683c\u5f0f</li>\n<li>\u6709\u9650\u7684\u63a7\u5236\u6d41\u652f\u6301</li>\n</ul>\n<p><strong>FPGA\u7684\u7075\u6d3b\u6027\u5229\u7528</strong>\uff1a</p>\n<ul>\n<li>\u5b9a\u5236\u5316\u6570\u636e\u901a\u8def</li>\n<li>\u6d41\u6c34\u7ebf\u5e76\u884c</li>\n<li>\u8fd1\u6570\u636e\u8ba1\u7b97</li>\n</ul>\n<p><strong>\u5f02\u6784\u7cfb\u7edf\u7684\u4efb\u52a1\u8c03\u5ea6</strong>\uff1a</p>\n<ul>\n<li>CPU\uff1a\u63a7\u5236\u6d41\u548c\u9884\u5904\u7406</li>\n<li>GPU\uff1a\u4e3b\u8981\u8ba1\u7b97</li>\n<li>TPU/FPGA\uff1a\u7279\u5b9a\u6838\u5fc3\u64cd\u4f5c</li>\n<li>\u667a\u80fdNIC\uff1a\u901a\u4fe1\u5378\u8f7d</li>\n</ul>\n<p><strong>\u6027\u80fd\u5efa\u6a21\u4e0e\u9884\u6d4b</strong>\uff1a\n$$T_{\\text{total}} = \\max(T_{\\text{comp}}, T_{\\text{comm}}) + T_{\\text{sync}}$$\n\u901a\u8fc7\u51c6\u786e\u7684\u6027\u80fd\u6a21\u578b\u6307\u5bfc\u7b97\u6cd5\u8bbe\u8ba1\u548c\u7cfb\u7edf\u914d\u7f6e\u3002</p>\n<h2 id=\"96\">9.6 \u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u5f02\u6b65\u4f18\u5316\u7684\u6570\u5b66\u57fa\u7840\uff0c\u4ece\u7406\u8bba\u5206\u6790\u5230\u5b9e\u9645\u7cfb\u7edf\u8bbe\u8ba1\uff1a</p>\n<p><strong>\u6838\u5fc3\u6982\u5ff5</strong>\uff1a</p>\n<ul>\n<li><strong>\u5ef6\u8fdf\u68af\u5ea6\u5206\u6790</strong>\uff1a\u5ef6\u8fdf\u5e26\u6765$O(\\tau_{\\max}\\eta)$\u7684\u989d\u5916\u8bef\u5dee\uff0c\u9700\u8981\u4ed4\u7ec6\u7684\u5b66\u4e60\u7387\u8c03\u6574</li>\n<li><strong>Lock-free\u7b97\u6cd5</strong>\uff1a\u5229\u7528\u539f\u5b50\u64cd\u4f5c\u907f\u514d\u540c\u6b65\u5f00\u9500\uff0c\u7a00\u758f\u6027\u662f\u6536\u655b\u6027\u4fdd\u8bc1\u7684\u5173\u952e</li>\n<li><strong>\u4e00\u81f4\u6027\u8c31\u7cfb</strong>\uff1a\u4ece\u5f3a\u4e00\u81f4\u6027\u5230\u6700\u7ec8\u4e00\u81f4\u6027\u7684\u6743\u8861\uff0c\u90e8\u5206\u540c\u6b65\u63d0\u4f9b\u4e86\u5b9e\u7528\u7684\u4e2d\u95f4\u65b9\u6848</li>\n<li><strong>\u786c\u4ef6\u611f\u77e5\u8bbe\u8ba1</strong>\uff1a\u5185\u5b58\u5c42\u6b21\u3001NUMA\u67b6\u6784\u3001GPU\u7279\u6027\u90fd\u9700\u8981\u4e13\u95e8\u4f18\u5316</li>\n</ul>\n<p><strong>\u5173\u952e\u6d1e\u5bdf</strong>\uff1a</p>\n<ol>\n<li>\u5f02\u6b65\u6027\u4e0d\u662f\u514d\u8d39\u7684\u5348\u9910\u2014\u2014\u5b83\u7528\u4e00\u81f4\u6027\u6362\u53d6\u4e86\u541e\u5410\u91cf</li>\n<li>\u786c\u4ef6\u67b6\u6784\u51b3\u5b9a\u4e86\u7b97\u6cd5\u8bbe\u8ba1\u7684\u6700\u4f18\u9009\u62e9</li>\n<li>\u901a\u4fe1\u6a21\u5f0f\u548c\u8ba1\u7b97\u6a21\u5f0f\u7684\u5339\u914d\u662f\u6027\u80fd\u7684\u5173\u952e</li>\n<li>\u7406\u8bba\u754c\u9650\u901a\u5e38\u8fc7\u4e8e\u4fdd\u5b88\uff0c\u5b9e\u8df5\u4e2d\u7684\u6027\u80fd\u66f4\u597d</li>\n</ol>\n<p><strong>\u5b9e\u7528\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u5ef6\u8fdf\u611f\u77e5\u7684\u5b66\u4e60\u7387\u8c03\u6574</li>\n<li>\u5229\u7528\u7a00\u758f\u6027\u51cf\u5c11\u51b2\u7a81\u6982\u7387</li>\n<li>\u8bbe\u8ba1NUMA\u53cb\u597d\u7684\u6570\u636e\u5e03\u5c40</li>\n<li>\u91cd\u53e0\u901a\u4fe1\u4e0e\u8ba1\u7b97\u9690\u85cf\u5ef6\u8fdf</li>\n</ul>\n<h2 id=\"97\">9.7 \u7ec3\u4e60\u9898</h2>\n<h3 id=\"_1\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u98989.1</strong> \u8003\u8651\u6709\u754c\u5ef6\u8fdf\u6a21\u578b\uff0c\u5176\u4e2d\u6700\u5927\u5ef6\u8fdf$\\tau_{\\max} = 10$\u3002\u5982\u679c\u4f7f\u7528\u56fa\u5b9a\u5b66\u4e60\u7387$\\eta = 0.01$\uff0cLipschitz\u5e38\u6570$L = 1$\uff0c\u68af\u5ea6\u754c$G = 10$\uff0c\u8ba1\u7b97\u5ef6\u8fdf\u68af\u5ea6\u7684\u6700\u574f\u60c5\u51b5\u8bef\u5dee\u754c\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u672c\u7ae0\u7ed9\u51fa\u7684\u8bef\u5dee\u754c\u516c\u5f0f$|\\nabla f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)| \\leq LG\\eta\\tau_{\\max}$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6700\u574f\u60c5\u51b5\u8bef\u5dee\u754c\u4e3a\uff1a\n$$|\\nabla f(\\mathbf{w}_{t-\\tau}) - \\nabla f(\\mathbf{w}_t)| \\leq LG\\eta\\tau_{\\max} = 1 \\times 10 \\times 0.01 \\times 10 = 1$$\n\u8fd9\u610f\u5473\u7740\u5ef6\u8fdf\u68af\u5ea6\u4e0e\u5f53\u524d\u68af\u5ea6\u7684\u5dee\u5f02\u6700\u591a\u4e3a1\uff0c\u8fd9\u662f\u4e00\u4e2a\u76f8\u5f53\u5927\u7684\u8bef\u5dee\u3002\u5b9e\u8df5\u4e2d\u53ef\u80fd\u9700\u8981\u66f4\u5c0f\u7684\u5b66\u4e60\u7387\u3002</p>\n</details>\n<p><strong>\u4e60\u98989.2</strong> \u5728HOGWILD!\u7b97\u6cd5\u4e2d\uff0c\u5047\u8bbe\u6709100\u4e2a\u53c2\u6570\uff0c\u6bcf\u4e2a\u68af\u5ea6\u5e73\u5747\u53ea\u670910\u4e2a\u975e\u96f6\u5206\u91cf\u3002\u5982\u679c\u670920\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u66f4\u65b0\uff0c\u4f30\u8ba1\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u66f4\u65b0\u540c\u4e00\u53c2\u6570\u7684\u6982\u7387\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u751f\u65e5\u6096\u8bba\u7684\u601d\u60f3\uff0c\u8003\u8651\u4efb\u610f\u4e24\u4e2a\u7ebf\u7a0b\u7684\u51b2\u7a81\u6982\u7387\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe\u6bcf\u4e2a\u7ebf\u7a0b\u66f4\u65b010\u4e2a\u53c2\u6570\uff08\u4ece100\u4e2a\u4e2d\u968f\u673a\u9009\u62e9\uff09\u3002\u4e24\u4e2a\u7279\u5b9a\u7ebf\u7a0b\u53d1\u751f\u51b2\u7a81\u7684\u6982\u7387\u7ea6\u4e3a\uff1a\n$$P(\\text{collision}) = 1 - \\frac{\\binom{90}{10}}{\\binom{100}{10}} \\approx 1 - \\left(\\frac{90}{100}\\right)^{10} \\approx 0.65$$\n\u8003\u865120\u4e2a\u7ebf\u7a0b\uff0c\u81f3\u5c11\u6709\u4e00\u5bf9\u7ebf\u7a0b\u51b2\u7a81\u7684\u6982\u7387\u4f1a\u66f4\u9ad8\u3002\u4f46\u7531\u4e8e\u7a00\u758f\u6027\uff0810%\uff09\uff0c\u5927\u591a\u6570\u66f4\u65b0\u4ecd\u7136\u662f\u65e0\u51b2\u7a81\u7684\u3002</p>\n</details>\n<p><strong>\u4e60\u98989.3</strong> \u5728Local SGD\u4e2d\uff0c\u5982\u679c\u5c40\u90e8\u66f4\u65b0\u6b65\u6570$H = 100$\uff0c\u8282\u70b9\u6570$P = 8$\uff0c\u68af\u5ea6\u65b9\u5dee\u754c$\\sigma^2 = 1$\uff0c\u4f30\u8ba1\u5c40\u90e8\u6a21\u578b\u7684\u53d1\u6563\u7a0b\u5ea6$\\mathbb{E}[\\mathcal{D}_t]$\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u5b9a\u74069.5\u4e2d\u7684\u754c$\\mathbb{E}[\\mathcal{D}_t] \\leq \\frac{H^2\\sigma^2}{P}$\uff08\u7b80\u5316\u7248\u672c\uff09\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5c40\u90e8\u6a21\u578b\u53d1\u6563\u7a0b\u5ea6\u7684\u4e0a\u754c\u4e3a\uff1a\n$$\\mathbb{E}[\\mathcal{D}_t] \\leq \\frac{H^2\\sigma^2}{P} = \\frac{100^2 \\times 1}{8} = 1250$$\n\u8fd9\u8868\u660e\u7ecf\u8fc7100\u6b65\u5c40\u90e8\u66f4\u65b0\u540e\uff0c\u4e0d\u540c\u8282\u70b9\u7684\u6a21\u578b\u4f1a\u6709\u663e\u8457\u5dee\u5f02\uff0c\u9700\u8981\u5168\u5c40\u540c\u6b65\u6765\u91cd\u65b0\u5bf9\u9f50\u3002</p>\n</details>\n<h3 id=\"_2\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u98989.4</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7684\u5ef6\u8fdf\u8865\u507f\u673a\u5236\uff0c\u6839\u636e\u89c2\u5bdf\u5230\u7684\u5ef6\u8fdf\u5206\u5e03\u52a8\u6001\u8c03\u6574\u8865\u507f\u5f3a\u5ea6\u3002\u7ed9\u51fa\u7b97\u6cd5\u4f2a\u4ee3\u7801\u5e76\u5206\u6790\u5176\u6536\u655b\u6027\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4f7f\u7528\u6307\u6570\u79fb\u52a8\u5e73\u5747\u4f30\u8ba1\u5ef6\u8fdf\u5206\u5e03\uff0c\u57fa\u4e8e\u4f30\u8ba1\u7684\u5ef6\u8fdf\u8c03\u6574\u68af\u5ea6\u8865\u507f\u7cfb\u6570\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u5ef6\u8fdf\u8865\u507f\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u7ef4\u62a4\u5ef6\u8fdf\u7684\u6307\u6570\u79fb\u52a8\u5e73\u5747\uff1a$\\bar{\\tau}_t = \\beta\\bar{\\tau}_{t-1} + (1-\\beta)\\tau_t$</li>\n<li>\u8ba1\u7b97\u8865\u507f\u7cfb\u6570\uff1a$\\lambda_t = \\min(1, \\bar{\\tau}_t / \\tau_{\\text{target}})$</li>\n<li>\u5e94\u7528\u68af\u5ea6\u8865\u507f\uff1a$\\tilde{g}_t = g_t + \\lambda_t \\mathbf{H}(\\mathbf{w}_t - \\mathbf{w}_{t-\\tau_t})$</li>\n</ol>\n<p>\u6536\u655b\u6027\u5206\u6790\u8981\u70b9\uff1a</p>\n<ul>\n<li>\u8865\u507f\u51cf\u5c11\u4e86\u5ef6\u8fdf\u5e26\u6765\u7684\u504f\u5dee</li>\n<li>\u81ea\u9002\u5e94\u673a\u5236\u9632\u6b62\u8fc7\u5ea6\u8865\u507f</li>\n<li>\u9700\u8981\u8bc1\u660e\u8865\u507f\u540e\u7684\u68af\u5ea6\u4ecd\u6ee1\u8db3\u65e0\u504f\u6027\uff08\u5728\u671f\u671b\u610f\u4e49\u4e0b\uff09</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98989.5</strong> \u5206\u6790\u5728\u62dc\u5360\u5ead\u653b\u51fb\u4e0b\uff0c\u4e0d\u540c\u805a\u5408\u89c4\u5219\uff08\u5747\u503c\u3001\u4e2d\u4f4d\u6570\u3001\u51e0\u4f55\u4e2d\u4f4d\u6570\uff09\u7684\u9c81\u68d2\u6027\u3002\u8003\u8651\u6700\u574f\u60c5\u51b5\u4e0b\u7684\u653b\u51fb\u7b56\u7565\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u62dc\u5360\u5ead\u8282\u70b9\u53ef\u4ee5\u4efb\u610f\u8bbe\u7f6e\u5176\u68af\u5ea6\u503c\uff0c\u5206\u6790\u6bcf\u79cd\u805a\u5408\u89c4\u5219\u80fd\u5bb9\u5fcd\u7684\u6700\u5927\u653b\u51fb\u6bd4\u4f8b\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u9c81\u68d2\u6027\u5206\u6790\uff1a</p>\n<ol>\n<li><strong>\u5747\u503c\u805a\u5408</strong>\uff1a\u65e0\u9c81\u68d2\u6027\uff0c\u5355\u4e2a\u62dc\u5360\u5ead\u8282\u70b9\u53ef\u4ee5\u4efb\u610f\u504f\u79fb\u7ed3\u679c</li>\n<li><strong>\u5750\u6807\u4e2d\u4f4d\u6570</strong>\uff1a\u53ef\u5bb9\u5fcd&lt;50%\u62dc\u5360\u5ead\u8282\u70b9\uff0c\u4f46\u6613\u53d7\u9ad8\u7ef4\u653b\u51fb</li>\n<li><strong>\u51e0\u4f55\u4e2d\u4f4d\u6570</strong>\uff1a\u6700\u9c81\u68d2\uff0c\u53ef\u5bb9\u5fcd&lt;50%\u62dc\u5360\u5ead\u8282\u70b9\uff0c\u4e14\u5bf9\u9ad8\u7ef4\u653b\u51fb\u6709\u62b5\u6297\u529b</li>\n</ol>\n<p>\u6700\u574f\u653b\u51fb\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u5bf9\u5747\u503c\uff1a\u53d1\u9001\u6781\u5927\u68af\u5ea6</li>\n<li>\u5bf9\u5750\u6807\u4e2d\u4f4d\u6570\uff1a\u5728\u4e0d\u540c\u7ef4\u5ea6\u534f\u8c03\u653b\u51fb</li>\n<li>\u5bf9\u51e0\u4f55\u4e2d\u4f4d\u6570\uff1a\u9700\u8981\u89e3\u4f18\u5316\u95ee\u9898\u627e\u5230\u6700\u4f18\u653b\u51fb\u65b9\u5411</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98989.6</strong> \u63a8\u5bfcNUMA\u7cfb\u7edf\u4e2d\u7684\u6700\u4f18\u53c2\u6570\u5206\u533a\u7b56\u7565\u3002\u8003\u8651\u53c2\u6570\u8bbf\u95ee\u9891\u7387\u4e0d\u5747\u5300\u7684\u60c5\u51b5\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5c06\u95ee\u9898\u5efa\u6a21\u4e3a\u56fe\u5206\u5272\uff0c\u5176\u4e2d\u8282\u70b9\u662f\u53c2\u6570\uff0c\u8fb9\u6743\u91cd\u662f\u5171\u540c\u8bbf\u95ee\u9891\u7387\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6700\u4f18\u5206\u533a\u95ee\u9898\u53ef\u5efa\u6a21\u4e3a\uff1a\n$$\\min_{\\pi} \\sum_{i,j} f_{ij} \\cdot \\mathbb{1}[\\pi(i) \\neq \\pi(j)]$$</p>\n<p>\u5176\u4e2d$f_{ij}$\u662f\u53c2\u6570$i,j$\u7684\u5171\u540c\u8bbf\u95ee\u9891\u7387\uff0c$\\pi$\u662f\u5206\u533a\u51fd\u6570\u3002</p>\n<p>\u8fd9\u662f\u4e00\u4e2aNP\u96be\u95ee\u9898\uff0c\u5b9e\u7528\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u8c31\u805a\u7c7b\uff1a\u4f7f\u7528\u8bbf\u95ee\u77e9\u9635\u7684\u7279\u5f81\u5411\u91cf</li>\n<li>\u8d2a\u5fc3\u7b97\u6cd5\uff1a\u8fed\u4ee3\u5730\u79fb\u52a8\u53c2\u6570\u4ee5\u51cf\u5c11\u8de8\u8282\u70b9\u8bbf\u95ee</li>\n<li>\u6a21\u62df\u9000\u706b\uff1a\u5141\u8bb8\u6b21\u4f18\u79fb\u52a8\u4ee5\u8df3\u51fa\u5c40\u90e8\u6700\u4f18</li>\n</ol>\n<p>\u5173\u952e\u6d1e\u5bdf\uff1a\u9891\u7e41\u5171\u540c\u8bbf\u95ee\u7684\u53c2\u6570\u5e94\u5206\u914d\u5230\u540c\u4e00NUMA\u8282\u70b9\u3002</p>\n</details>\n<p><strong>\u4e60\u98989.7</strong>\uff08\u5f00\u653e\u95ee\u9898\uff09\u5f02\u6b65\u4f18\u5316\u4e2d\u7684\u52a8\u91cf\u65b9\u6cd5\u5982\u4f55\u8bbe\u8ba1\uff1f\u5206\u6790\u52a8\u91cf\u9879\u5728\u5ef6\u8fdf\u68af\u5ea6\u4e0b\u7684\u884c\u4e3a\uff0c\u63d0\u51fa\u6539\u8fdb\u65b9\u6848\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u52a8\u91cf\u9879\u4e5f\u53ef\u80fd\u5305\u542b\u8fc7\u65f6\u4fe1\u606f\uff0c\u9700\u8981\u534f\u8c03\u68af\u5ea6\u5ef6\u8fdf\u548c\u52a8\u91cf\u5ef6\u8fdf\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8fd9\u662f\u4e00\u4e2a\u6d3b\u8dc3\u7684\u7814\u7a76\u95ee\u9898\u3002\u5173\u952e\u6311\u6218\uff1a</p>\n<ol>\n<li><strong>\u53cc\u91cd\u5ef6\u8fdf</strong>\uff1a\u68af\u5ea6\u5ef6\u8fdf+\u52a8\u91cf\u5ef6\u8fdf\u7684\u4ea4\u4e92</li>\n<li><strong>\u7a33\u5b9a\u6027</strong>\uff1a\u52a8\u91cf\u53ef\u80fd\u653e\u5927\u5ef6\u8fdf\u5e26\u6765\u7684\u8bef\u5dee</li>\n<li><strong>\u6539\u8fdb\u601d\u8def</strong>\uff1a\n   - \u5ef6\u8fdf\u611f\u77e5\u7684\u52a8\u91cf\u7cfb\u6570\u8c03\u6574\n   - \u5c40\u90e8\u52a8\u91cf+\u5168\u5c40\u52a8\u91cf\u7684\u5c42\u6b21\u8bbe\u8ba1\n   - \u57fa\u4e8e\u5ef6\u8fdf\u8865\u507f\u7684\u52a8\u91cf\u4fee\u6b63</li>\n</ol>\n<p>\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ul>\n<li>\u7406\u8bba\uff1a\u63a8\u5bfc\u5305\u542b\u52a8\u91cf\u7684\u5f02\u6b65\u6536\u655b\u754c</li>\n<li>\u5b9e\u8df5\uff1a\u8bbe\u8ba1\u81ea\u9002\u5e94\u52a8\u91cf\u7b56\u7565</li>\n<li>\u7cfb\u7edf\uff1a\u5b9e\u73b0\u9ad8\u6548\u7684\u52a8\u91cf\u72b6\u6001\u7ba1\u7406</li>\n</ul>\n</details>\n<h2 id=\"98-gotchas\">9.8 \u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef\uff08Gotchas\uff09</h2>\n<ol>\n<li>\n<p><strong>\u5b66\u4e60\u7387\u9009\u62e9\u8fc7\u5927</strong>\uff1a\u5f02\u6b65\u8bbe\u7f6e\u4e0b\uff0c\u8fc7\u5927\u7684\u5b66\u4e60\u7387\u4f1a\u5bfc\u81f4\u53c2\u6570\u9707\u8361\u751a\u81f3\u53d1\u6563\u3002\u7ecf\u9a8c\u6cd5\u5219\uff1a\u5f02\u6b65\u5b66\u4e60\u7387\u5e94\u4e3a\u540c\u6b65\u7248\u672c\u7684$1/\\sqrt{\\tau_{\\max}}$\u3002</p>\n</li>\n<li>\n<p><strong>\u5ffd\u89c6\u6570\u503c\u7cbe\u5ea6</strong>\uff1aLock-free\u7b97\u6cd5\u4e2d\u7684\u5e76\u53d1\u6d6e\u70b9\u8fd0\u7b97\u53ef\u80fd\u5bfc\u81f4\u7cbe\u5ea6\u635f\u5931\u7d2f\u79ef\u3002\u4f7f\u7528Kahan\u6c42\u548c\u6216\u5b9a\u70b9\u6570\u8868\u793a\u3002</p>\n</li>\n<li>\n<p><strong>\u8fc7\u5ea6\u4f18\u5316\u5c40\u90e8\u6027</strong>\uff1aNUMA\u4f18\u5316\u53ef\u80fd\u5bfc\u81f4\u8d1f\u8f7d\u4e0d\u5747\u8861\u3002\u9700\u8981\u5728\u5c40\u90e8\u6027\u548c\u8d1f\u8f7d\u5747\u8861\u95f4\u6743\u8861\u3002</p>\n</li>\n<li>\n<p><strong>\u5ffd\u7565\u786c\u4ef6\u9650\u5236</strong>\uff1a\n   - \u539f\u5b50\u64cd\u4f5c\u7684\u541e\u5410\u91cf\u9650\u5236\n   - \u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u7684\u5f00\u9500\n   - \u5185\u5b58\u5e26\u5bbd\u9971\u548c</p>\n</li>\n<li>\n<p><strong>\u9519\u8bef\u7684\u4e00\u81f4\u6027\u5047\u8bbe</strong>\uff1a\u5047\u8bbe\u5f3a\u4e00\u81f4\u6027\u4f46\u5b9e\u9645\u53ea\u6709\u5f31\u4e00\u81f4\u6027\uff0c\u5bfc\u81f4\u7b97\u6cd5\u6b63\u786e\u6027\u95ee\u9898\u3002</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u6a21\u5f0f\u4e0d\u5339\u914d</strong>\uff1aAll-to-all\u901a\u4fe1\u5728\u67d0\u4e9b\u7f51\u7edc\u62d3\u6251\u4e0b\u6548\u7387\u4f4e\u4e0b\uff0c\u9700\u8981\u9009\u62e9\u5408\u9002\u7684\u901a\u4fe1\u539f\u8bed\u3002</p>\n</li>\n</ol>\n<h2 id=\"99\">9.9 \u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_3\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5206\u6790\u76ee\u6807\u95ee\u9898\u7684\u7a00\u758f\u6027\u548c\u5c40\u90e8\u6027\u7279\u5f81</li>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff08\u5f3a/\u5f31/\u6700\u7ec8\uff09</li>\n<li>[ ] \u8bbe\u8ba1\u5ef6\u8fdf\u8865\u507f\u673a\u5236</li>\n<li>[ ] \u8003\u8651\u62dc\u5360\u5ead\u5bb9\u9519\u9700\u6c42</li>\n</ul>\n<h3 id=\"_4\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u5408\u9002\u7684\u539f\u5b50\u64cd\u4f5c\u548c\u5185\u5b58\u5e8f</li>\n<li>[ ] \u907f\u514dfalse sharing\uff08\u7f13\u5b58\u884c\u5bf9\u9f50\uff09</li>\n<li>[ ] \u5b9e\u73b0\u9ad8\u6548\u7684\u901a\u4fe1\u539f\u8bed</li>\n<li>[ ] \u6dfb\u52a0\u6027\u80fd\u8ba1\u6570\u5668\u548c\u8bca\u65ad\u5de5\u5177</li>\n</ul>\n<h3 id=\"_5\">\u8c03\u4f18\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6d4b\u91cf\u5b9e\u9645\u5ef6\u8fdf\u5206\u5e03</li>\n<li>[ ] Profile\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>[ ] \u8bc6\u522b\u901a\u4fe1\u74f6\u9888</li>\n<li>[ ] \u8c03\u6574\u5e76\u53d1\u5ea6\u548c\u6279\u5927\u5c0f</li>\n</ul>\n<h3 id=\"_6\">\u9a8c\u8bc1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5355\u5143\u6d4b\u8bd5\u5e76\u53d1\u6b63\u786e\u6027</li>\n<li>[ ] \u538b\u529b\u6d4b\u8bd5\u6781\u7aef\u5ef6\u8fdf\u60c5\u51b5</li>\n<li>[ ] \u9a8c\u8bc1\u6570\u503c\u7a33\u5b9a\u6027</li>\n<li>[ ] \u5bf9\u6bd4\u540c\u6b65\u57fa\u51c6\u6027\u80fd</li>\n</ul>\n<h2 id=\"910\">9.10 \u7814\u7a76\u65b9\u5411\u5c55\u671b</h2>\n<h3 id=\"_7\">\u7406\u8bba\u65b9\u5411</h3>\n<ol>\n<li>\n<p><strong>\u975e\u51f8\u975e\u5149\u6ed1\u60c5\u51b5\u7684\u5f02\u6b65\u5206\u6790</strong>\uff1a\u73b0\u6709\u7406\u8bba\u4e3b\u8981\u5173\u6ce8\u51f8\u6216\u5149\u6ed1\u60c5\u51b5\uff0c\u975e\u51f8\u975e\u5149\u6ed1\uff08\u5982ReLU\u7f51\u7edc\uff09\u7684\u5206\u6790\u4ecd\u7136\u5f00\u653e\u3002</p>\n</li>\n<li>\n<p><strong>\u6700\u4f18\u5ef6\u8fdf\u8865\u507f</strong>\uff1a\u8bbe\u8ba1\u53ef\u8bc1\u660e\u6700\u4f18\u7684\u5ef6\u8fdf\u8865\u507f\u673a\u5236\uff0c\u7279\u522b\u662f\u5728\u6a21\u578b\u672a\u77e5\u7684\u60c5\u51b5\u4e0b\u3002</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u9ad8\u9636\u65b9\u6cd5</strong>\uff1a\u5c06\u5f02\u6b65\u6280\u672f\u6269\u5c55\u5230\u725b\u987f\u6cd5\u3001\u81ea\u7136\u68af\u5ea6\u7b49\u9ad8\u9636\u65b9\u6cd5\u3002</p>\n</li>\n</ol>\n<h3 id=\"_8\">\u7cfb\u7edf\u65b9\u5411</h3>\n<ol>\n<li>\n<p><strong>\u5f02\u6784\u786c\u4ef6\u7684\u7edf\u4e00\u62bd\u8c61</strong>\uff1a\u8bbe\u8ba1\u80fd\u591f\u81ea\u52a8\u9002\u5e94CPU/GPU/TPU/FPGA\u7684\u5f02\u6b65\u6846\u67b6\u3002</p>\n</li>\n<li>\n<p><strong>\u53ef\u9a8c\u8bc1\u7684Lock-free\u5b9e\u73b0</strong>\uff1a\u4f7f\u7528\u5f62\u5f0f\u5316\u65b9\u6cd5\u9a8c\u8bc1\u590d\u6742Lock-free\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u3002</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u5e76\u53d1\u63a7\u5236</strong>\uff1a\u6839\u636e\u7cfb\u7edf\u8d1f\u8f7d\u52a8\u6001\u8c03\u6574\u5e76\u53d1\u7b56\u7565\u3002</p>\n</li>\n</ol>\n<h3 id=\"_9\">\u5e94\u7528\u65b9\u5411</h3>\n<ol>\n<li>\n<p><strong>\u8054\u90a6\u5b66\u4e60\u4e2d\u7684\u5f02\u6b65</strong>\uff1a\u5728\u975e\u53ef\u9760\u3001\u5f02\u6784\u7684\u8fb9\u7f18\u8bbe\u5907\u4e0a\u5b9e\u73b0\u9ad8\u6548\u5f02\u6b65\u8bad\u7ec3\u3002</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u5b66\u4e60\u7cfb\u7edf</strong>\uff1a\u5b9e\u65f6\u63a8\u8350\u3001\u5e7f\u544a\u7b49\u7cfb\u7edf\u4e2d\u7684\u5f02\u6b65\u6a21\u578b\u66f4\u65b0\u3002</p>\n</li>\n<li>\n<p><strong>\u79d1\u5b66\u8ba1\u7b97</strong>\uff1a\u5c06\u5f02\u6b65\u6280\u672f\u5e94\u7528\u4e8e\u5927\u89c4\u6a21\u79d1\u5b66\u4eff\u771f\u548c\u4f18\u5316\u95ee\u9898\u3002</p>\n</li>\n</ol>\n<h3 id=\"_10\">\u4ea4\u53c9\u65b9\u5411</h3>\n<ol>\n<li>\n<p><strong>\u5f02\u6b65+\u538b\u7f29</strong>\uff1a\u8054\u5408\u4f18\u5316\u901a\u4fe1\u538b\u7f29\u548c\u5f02\u6b65\u66f4\u65b0\u3002</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65+\u9690\u79c1</strong>\uff1a\u5728\u5dee\u5206\u9690\u79c1\u7ea6\u675f\u4e0b\u8bbe\u8ba1\u5f02\u6b65\u7b97\u6cd5\u3002</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65+\u9c81\u68d2\u6027</strong>\uff1a\u5bf9\u6297\u6027\u73af\u5883\u4e0b\u7684\u5f02\u6b65\u4f18\u5316\u3002</p>\n</li>\n</ol>\n<p>\u8fd9\u4e9b\u65b9\u5411\u4ee3\u8868\u4e86\u5f02\u6b65\u4f18\u5316\u9886\u57df\u7684\u524d\u6cbf\uff0c\u6bcf\u4e2a\u90fd\u5305\u542b\u4e30\u5bcc\u7684\u7814\u7a76\u673a\u4f1a\u3002\u7279\u522b\u662f\u968f\u7740\u6a21\u578b\u89c4\u6a21\u548c\u7cfb\u7edf\u89c4\u6a21\u7684\u6301\u7eed\u589e\u957f\uff0c\u5f02\u6b65\u6280\u672f\u7684\u91cd\u8981\u6027\u53ea\u4f1a\u8d8a\u6765\u8d8a\u5927\u3002</p>"
  },
  "../chapter19.md": {
    "hash": "97d96b2393c4468f541825459f567206",
    "content": "<h1 id=\"a\">\u9644\u5f55A\uff1a\u6570\u503c\u7a33\u5b9a\u6027\u901f\u67e5\u8868</h1>\n<p>\u6570\u503c\u7a33\u5b9a\u6027\u662f\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u7684\u57fa\u77f3\u3002\u5373\u4f7f\u7b97\u6cd5\u5728\u7406\u8bba\u4e0a\u6b63\u786e\uff0c\u6570\u503c\u8bef\u5dee\u7684\u7d2f\u79ef\u4e5f\u53ef\u80fd\u5bfc\u81f4\u8ba1\u7b97\u7ed3\u679c\u5b8c\u5168\u5931\u771f\u3002\u672c\u9644\u5f55\u6c47\u603b\u4e86\u4fdd\u8bc1\u6570\u503c\u7a33\u5b9a\u6027\u7684\u5173\u952e\u6280\u672f\u548c\u5b9e\u7528\u51c6\u5219\uff0c\u4e3a\u5b9e\u9645\u5e94\u7528\u63d0\u4f9b\u5feb\u901f\u53c2\u8003\u3002\u7279\u522b\u5730\uff0c\u6211\u4eec\u5173\u6ce8\u90a3\u4e9b\u5728\u73b0\u4ee3\u673a\u5668\u5b66\u4e60\u548c\u79d1\u5b66\u8ba1\u7b97\u4e2d\u9891\u7e41\u51fa\u73b0\u4f46\u5bb9\u6613\u88ab\u5ffd\u89c6\u7684\u7a33\u5b9a\u6027\u95ee\u9898\u3002</p>\n<h2 id=\"1\">1. \u6761\u4ef6\u6570\u4e0e\u8bef\u5dee\u4f20\u64ad</h2>\n<h3 id=\"11\">1.1 \u6761\u4ef6\u6570\u7684\u591a\u79cd\u89c6\u89d2</h3>\n<p><strong>\u77e9\u9635\u6761\u4ef6\u6570</strong> $\\kappa(\\mathbf{A})$ \u8861\u91cf\u4e86\u95ee\u9898\u7684\u654f\u611f\u5ea6\uff1a</p>\n<ul>\n<li><strong>\u8c31\u6761\u4ef6\u6570</strong>\uff1a$\\kappa_2(\\mathbf{A}) = |\\mathbf{A}|_2 |\\mathbf{A}^{-1}|_2 = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}$</li>\n<li><strong>Frobenius\u6761\u4ef6\u6570</strong>\uff1a$\\kappa_F(\\mathbf{A}) = |\\mathbf{A}|_F |\\mathbf{A}^{-1}|_F$</li>\n<li><strong>\u5206\u91cf\u6761\u4ef6\u6570</strong>\uff1a\u8003\u8651\u8f93\u5165\u6270\u52a8\u7684\u7ed3\u6784\u6027</li>\n</ul>\n<p><strong>\u5b9e\u7528\u4f30\u8ba1\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528 <code>condest</code> \u7c7b\u51fd\u6570\u8fdb\u884c\u5feb\u901f\u4f30\u8ba1\uff08\u57fa\u4e8e1-\u8303\u6570\uff09</li>\n<li>\u901a\u8fc7\u5e42\u8fed\u4ee3\u4f30\u8ba1\u6700\u5927\u5947\u5f02\u503c</li>\n<li>\u5229\u7528Lanczos\u8fed\u4ee3\u540c\u65f6\u4f30\u8ba1\u6700\u5927\u548c\u6700\u5c0f\u5947\u5f02\u503c</li>\n</ul>\n<h3 id=\"12\">1.2 \u8bef\u5dee\u4f20\u64ad\u7684\u9ec4\u91d1\u6cd5\u5219</h3>\n<p>\u5bf9\u4e8e\u7ebf\u6027\u7cfb\u7edf $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$\uff1a</p>\n<p>$$\\frac{|\\Delta \\mathbf{x}|}{|\\mathbf{x}|} \\leq \\kappa(\\mathbf{A}) \\left( \\frac{|\\Delta \\mathbf{A}|}{|\\mathbf{A}|} + \\frac{|\\Delta \\mathbf{b}|}{|\\mathbf{b}|} \\right)$$\n<strong>\u7ecf\u9a8c\u51c6\u5219</strong>\uff1a</p>\n<ul>\n<li>\u82e5 $\\kappa(\\mathbf{A}) \\approx 10^k$\uff0c\u5219\u671f\u671b\u635f\u5931 $k$ \u4f4d\u6709\u6548\u6570\u5b57</li>\n<li>\u5728\u53cc\u7cbe\u5ea6\u4e0b\uff0c$\\kappa &gt; 10^{16}$ \u610f\u5473\u7740\u7ed3\u679c\u53ef\u80fd\u5b8c\u5168\u4e0d\u53ef\u9760</li>\n<li>\u5bf9\u4e8e\u8fed\u4ee3\u65b9\u6cd5\uff0c\u6761\u4ef6\u6570\u8fd8\u5f71\u54cd\u6536\u655b\u901f\u5ea6</li>\n</ul>\n<h3 id=\"13\">1.3 \u7ed3\u6784\u5316\u8bef\u5dee\u5206\u6790</h3>\n<p><strong>\u524d\u5411\u8bef\u5dee vs \u540e\u5411\u8bef\u5dee</strong>\uff1a</p>\n<ul>\n<li>\u524d\u5411\u8bef\u5dee\uff1a$|\\hat{\\mathbf{x}} - \\mathbf{x}|$ \uff08\u8ba1\u7b97\u7ed3\u679c\u4e0e\u771f\u5b9e\u89e3\u7684\u5dee\u8ddd\uff09</li>\n<li>\u540e\u5411\u8bef\u5dee\uff1a\u627e\u5230 $\\Delta \\mathbf{A}$\uff0c\u4f7f\u5f97 $(\\mathbf{A} + \\Delta \\mathbf{A})\\hat{\\mathbf{x}} = \\mathbf{b}$</li>\n</ul>\n<p><strong>\u540e\u5411\u7a33\u5b9a\u7b97\u6cd5\u7684\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u8ba1\u7b97\u7ed3\u679c\u662f\u67d0\u4e2a\u5fae\u6270\u95ee\u9898\u7684\u7cbe\u786e\u89e3</li>\n<li>\u82e5\u539f\u95ee\u9898\u826f\u6001\uff0c\u5219\u540e\u5411\u7a33\u5b9a\u4fdd\u8bc1\u524d\u5411\u8bef\u5dee\u5c0f</li>\n<li>\u5927\u591a\u6570LAPACK\u7b97\u6cd5\u90fd\u662f\u540e\u5411\u7a33\u5b9a\u7684</li>\n</ul>\n<h2 id=\"2\">2. \u7a33\u5b9a\u7b97\u6cd5\u901f\u67e5</h2>\n<h3 id=\"21\">2.1 \u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3</h3>\n<p><strong>\u76f4\u63a5\u6cd5\u7a33\u5b9a\u6027\u6392\u5e8f</strong>\uff08\u4ece\u6700\u7a33\u5b9a\u5230\u6700\u4e0d\u7a33\u5b9a\uff09\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5e26\u9009\u4e3b\u5143\u7684LU\u5206\u89e3</strong> (<code>GEPP</code>)\n   - \u589e\u957f\u56e0\u5b50\u901a\u5e38\u4e3a $O(n^{0.5})$\n   - \u5b9e\u8df5\u4e2d\u975e\u5e38\u7a33\u5b9a</p>\n</li>\n<li>\n<p><strong>QR\u5206\u89e3</strong>\n   - \u65e0\u6761\u4ef6\u540e\u5411\u7a33\u5b9a\n   - \u8ba1\u7b97\u6210\u672c\u7ea6\u4e3aLU\u76842\u500d</p>\n</li>\n<li>\n<p><strong>Cholesky\u5206\u89e3</strong>\uff08\u4ec5\u9002\u7528\u4e8e\u6b63\u5b9a\u77e9\u9635\uff09\n   - \u4e0d\u9700\u8981\u9009\u4e3b\u5143\n   - \u81ea\u52a8\u68c0\u6d4b\u975e\u6b63\u5b9a\u6027</p>\n</li>\n<li>\n<p><strong>\u4e0d\u5e26\u9009\u4e3b\u5143\u7684LU\u5206\u89e3</strong>\n   - \u53ef\u80fd\u6570\u503c\u4e0d\u7a33\u5b9a\n   - \u4ec5\u5728\u7279\u6b8a\u7ed3\u6784\u4e0b\u4f7f\u7528</p>\n</li>\n</ol>\n<p><strong>\u8fed\u4ee3\u6cd5\u7684\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>CG\u6cd5\uff1a\u6761\u4ef6\u6570\u5f71\u54cd\u6536\u655b\u901f\u5ea6\uff0c\u4f46\u6bcf\u6b65\u90fd\u4fdd\u6301\u6570\u503c\u7a33\u5b9a</li>\n<li>GMRES\uff1a\u7406\u8bba\u4e0a\u6709\u9650\u6b65\u6536\u655b\uff0c\u4f46\u820d\u5165\u8bef\u5dee\u53ef\u80fd\u5bfc\u81f4\u505c\u6ede</li>\n<li>BiCGSTAB\uff1a\u53ef\u80fd\u51fa\u73b0\u5d29\u6e83\uff0c\u9700\u8981\u91cd\u542f\u7b56\u7565</li>\n</ul>\n<h3 id=\"22\">2.2 \u7279\u5f81\u503c\u8ba1\u7b97</h3>\n<p><strong>\u6807\u51c6\u7b97\u6cd5\u7684\u7a33\u5b9a\u6027</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5bf9\u79f0\u77e9\u9635</strong>\uff1a\n   - Jacobi\u65b9\u6cd5\uff1a\u6700\u7a33\u5b9a\uff0c\u80fd\u8ba1\u7b97\u9ad8\u7cbe\u5ea6\u5c0f\u7279\u5f81\u503c\n   - QR\u7b97\u6cd5\uff08\u5e26Wilkinson\u4f4d\u79fb\uff09\uff1a\u6807\u51c6\u9009\u62e9\n   - \u5206\u6cbb\u7b97\u6cd5\uff1a\u5e76\u884c\u6027\u597d\uff0c\u7a33\u5b9a\u6027\u7565\u4f4e</p>\n</li>\n<li>\n<p><strong>\u975e\u5bf9\u79f0\u77e9\u9635</strong>\uff1a\n   - Schur\u5206\u89e3 + \u7279\u5f81\u503c\u63d0\u53d6\uff1a\u6700\u7a33\u5b9a\n   - \u76f4\u63a5QR\u8fed\u4ee3\uff1a\u53ef\u80fd\u4e0d\u6536\u655b\n   - \u5e42\u65b9\u6cd5\uff1a\u4ec5\u9002\u7528\u4e8e\u4e3b\u7279\u5f81\u503c</p>\n</li>\n</ol>\n<p><strong>\u75c5\u6001\u7279\u5f81\u503c\u95ee\u9898\u7684\u5904\u7406</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u591a\u7cbe\u5ea6\u7b97\u672f</li>\n<li>\u8003\u8651\u4f2a\u8c31\u5206\u6790</li>\n<li>\u5bf9\u4e8e\u63a5\u8fd1\u7684\u7279\u5f81\u503c\uff0c\u8ba1\u7b97\u4e0d\u53d8\u5b50\u7a7a\u95f4\u800c\u975e\u5355\u4e2a\u7279\u5f81\u5411\u91cf</li>\n</ul>\n<h3 id=\"23\">2.3 \u77e9\u9635\u5206\u89e3\u7684\u7a33\u5b9a\u6027</h3>\n<p><strong>SVD\u8ba1\u7b97</strong>\uff1a</p>\n<ul>\n<li>Golub-Reinsch\u7b97\u6cd5\uff1a\u6807\u51c6\u65b9\u6cd5\uff0c\u53cc\u5bf9\u89d2\u5316+QR\u8fed\u4ee3</li>\n<li>Jacobi SVD\uff1a\u66f4\u7cbe\u786e\u4f46\u66f4\u6162</li>\n<li>\u968f\u673a\u5316SVD\uff1a\u5927\u89c4\u6a21\u95ee\u9898\u7684\u9996\u9009\uff0c\u4f46\u9700\u8981\u8fc7\u91c7\u6837</li>\n</ul>\n<p><strong>\u4f4e\u79e9\u8fd1\u4f3c\u7684\u6570\u503c\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u622a\u65adSVD\uff1a\u6700\u4f18\u4f46\u8ba1\u7b97\u6602\u8d35</li>\n<li>\u968f\u673a\u5316\u65b9\u6cd5\uff1a\u4f7f\u7528\u8fc7\u91c7\u6837\u53c2\u6570 $p \\geq 5$</li>\n<li>CUR\u5206\u89e3\uff1a\u4fdd\u6301\u7a00\u758f\u6027\uff0c\u4f46\u6570\u503c\u6027\u8d28\u8f83\u5dee</li>\n</ul>\n<h3 id=\"24\">2.4 \u77e9\u9635\u51fd\u6570\u7684\u7a33\u5b9a\u8ba1\u7b97</h3>\n<p><strong>\u77e9\u9635\u6307\u6570 $e^{\\mathbf{A}}$</strong>\uff1a</p>\n<ul>\n<li>Pad\u00e9\u8fd1\u4f3c + scaling and squaring\uff1a\u901a\u7528\u65b9\u6cd5</li>\n<li>\u5bf9\u4e8e\u6b63\u89c4\u77e9\u9635\uff0c\u4f7f\u7528\u7279\u5f81\u5206\u89e3</li>\n<li>Krylov\u65b9\u6cd5\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u7a00\u758f\u60c5\u51b5</li>\n</ul>\n<p><strong>\u77e9\u9635\u5e73\u65b9\u6839 $\\mathbf{A}^{1/2}$</strong>\uff1a</p>\n<ul>\n<li>Newton\u8fed\u4ee3\uff1a\u9700\u8981\u597d\u7684\u521d\u503c</li>\n<li>Schur\u65b9\u6cd5\uff1a\u7a33\u5b9a\u4f46\u8ba1\u7b97\u5bc6\u96c6</li>\n<li>\u5bf9\u4e8e\u6b63\u5b9a\u77e9\u9635\uff0c\u4f7f\u7528Cholesky\u5206\u89e3</li>\n</ul>\n<p><strong>\u77e9\u9635\u5bf9\u6570 $\\log(\\mathbf{A})$</strong>\uff1a</p>\n<ul>\n<li>\u53cdscaling and squaring</li>\n<li>\u9700\u8981 $|\\mathbf{A} - \\mathbf{I}| &lt; 1$</li>\n<li>Pad\u00e9\u8fd1\u4f3c\u7684\u9636\u6570\u9009\u62e9\u5f88\u5173\u952e</li>\n</ul>\n<h2 id=\"3\">3. \u5e38\u89c1\u6570\u503c\u9677\u9631\u4e0e\u8865\u6551\u63aa\u65bd</h2>\n<h3 id=\"31\">3.1 \u75c5\u6001\u95ee\u9898\u7684\u8bc6\u522b</h3>\n<p><strong>\u9884\u8b66\u4fe1\u53f7</strong>\uff1a</p>\n<ul>\n<li>\u6b8b\u5dee\u5c0f\u4f46\u89e3\u7684\u6270\u52a8\u5927</li>\n<li>\u8fed\u4ee3\u65b9\u6cd5\u6536\u655b\u6781\u6162\u6216\u505c\u6ede</li>\n<li>\u4e0d\u540c\u7b97\u6cd5\u7ed9\u51fa\u663e\u8457\u4e0d\u540c\u7684\u7ed3\u679c</li>\n</ul>\n<p><strong>\u8bca\u65ad\u5de5\u5177</strong>\uff1a</p>\n<ul>\n<li>\u8ba1\u7b97\u6761\u4ef6\u6570\u4f30\u8ba1</li>\n<li>\u68c0\u67e5\u77e9\u9635\u7684\u5947\u5f02\u503c\u5206\u5e03</li>\n<li>\u4f7f\u7528\u6270\u52a8\u5206\u6790\u9a8c\u8bc1\u7ed3\u679c</li>\n</ul>\n<h3 id=\"32\">3.2 \u6ea2\u51fa/\u4e0b\u6ea2\u7684\u9884\u9632</h3>\n<p><strong>\u7f29\u653e\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u884c\u5e73\u8861\uff1a\u4f7f\u6bcf\u884c\u7684\u8303\u6570\u76f8\u8fd1</li>\n<li>\u5217\u5e73\u8861\uff1a\u4f7f\u6bcf\u5217\u7684\u8303\u6570\u76f8\u8fd1</li>\n<li>\u5bf9\u79f0\u7f29\u653e\uff1a\u4fdd\u6301\u5bf9\u79f0\u6027\u7684\u540c\u65f6\u6539\u5584\u6761\u4ef6\u6570</li>\n</ul>\n<p><strong>\u5177\u4f53\u6280\u5de7</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u884c\u7f29\u653e\uff1aD\u2081AD\u2082\uff0c\u9009\u62e9D\u2081\u548cD\u2082\u4f7f\u5f97\u7f29\u653e\u540e\u77e9\u9635\u5143\u7d20\u91cf\u7ea7\u5747\u8861\n\u8303\u6570\u8ba1\u7b97\uff1a\u4f7f\u7528\u7a33\u5b9a\u7684\u5b9e\u73b0\uff08\u5982BLAS\u4e2d\u7684_nrm2\uff09\n\u907f\u514d\u663e\u5f0f\u5f62\u6210A^T A\n</code></pre></div>\n\n<h3 id=\"33\">3.3 \u820d\u5165\u8bef\u5dee\u7684\u63a7\u5236</h3>\n<p><strong>\u6c42\u548c\u7684\u7a33\u5b9a\u7b97\u6cd5</strong>\uff1a</p>\n<ul>\n<li>Kahan\u6c42\u548c\uff1a\u8865\u507f\u820d\u5165\u8bef\u5dee</li>\n<li>\u6210\u5bf9\u6c42\u548c\uff1a\u9012\u5f52\u5730\u4e24\u4e24\u76f8\u52a0</li>\n<li>\u6392\u5e8f\u6c42\u548c\uff1a\u4ece\u5c0f\u5230\u5927\u7d2f\u52a0</li>\n</ul>\n<p><strong>\u5185\u79ef\u8ba1\u7b97</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528BLAS\u7684_dot\u51fd\u6570\uff08\u53ef\u80fd\u4f7f\u7528\u6269\u5c55\u7cbe\u5ea6\uff09</li>\n<li>\u5bf9\u4e8e\u9ad8\u7cbe\u5ea6\u9700\u6c42\uff0c\u4f7f\u7528\u591a\u7cbe\u5ea6\u7b97\u672f\u5e93</li>\n<li>\u8003\u8651\u8bef\u5dee\u81ea\u7531\u53d8\u6362\uff08Error-Free Transformations\uff09</li>\n</ul>\n<h3 id=\"34\">3.4 \u8fed\u4ee3\u7b97\u6cd5\u7684\u505c\u6b62\u51c6\u5219</h3>\n<p><strong>\u76f8\u5bf9\u6b8b\u5dee\u51c6\u5219</strong>\uff1a\n$$\\frac{|\\mathbf{b} - \\mathbf{A}\\mathbf{x}_k|}{|\\mathbf{b}|} &lt; \\text{tol}$$\n<strong>\u52a0\u6743\u6b8b\u5dee\u51c6\u5219</strong>\uff08\u8003\u8651\u6761\u4ef6\u6570\uff09\uff1a\n$$\\frac{|\\mathbf{b} - \\mathbf{A}\\mathbf{x}_k|}{|\\mathbf{A}| |\\mathbf{x}_k| + |\\mathbf{b}|} &lt; \\text{tol}$$\n<strong>\u5b9e\u7528\u5efa\u8bae</strong>\uff1a</p>\n<ul>\n<li>\u8bbe\u7f6e\u6700\u5927\u8fed\u4ee3\u6b21\u6570\u9632\u6b62\u65e0\u9650\u5faa\u73af</li>\n<li>\u76d1\u63a7\u6b8b\u5dee\u7684\u4e0b\u964d\u5386\u53f2</li>\n<li>\u5bf9\u4e8e\u75c5\u6001\u95ee\u9898\uff0c\u4f7f\u7528\u66f4\u4fdd\u5b88\u7684\u505c\u6b62\u51c6\u5219</li>\n</ul>\n<h2 id=\"4\">4. \u7279\u6b8a\u573a\u666f\u7684\u7a33\u5b9a\u6027\u8003\u8651</h2>\n<h3 id=\"41\">4.1 \u7a00\u758f\u77e9\u9635\u8ba1\u7b97</h3>\n<p><strong>\u586b\u5145(fill-in)\u4e0e\u7a33\u5b9a\u6027\u7684\u6743\u8861</strong>\uff1a</p>\n<ul>\n<li>\u6700\u5c0f\u5ea6\u6392\u5e8f\uff1a\u51cf\u5c11\u586b\u5145\u4f46\u53ef\u80fd\u5f71\u54cd\u7a33\u5b9a\u6027</li>\n<li>\u8fd1\u4f3c\u6700\u5c0f\u5ea6\uff08AMD\uff09\uff1a\u5e73\u8861\u586b\u5145\u548c\u6570\u503c\u6027\u8d28</li>\n<li>\u5d4c\u5957\u5256\u5206\uff1a\u4fdd\u8bc1\u7406\u8bba\u754c\u4f46\u5b9e\u73b0\u590d\u6742</li>\n</ul>\n<p><strong>\u4e0d\u5b8c\u5168\u5206\u89e3\u7684\u7a33\u5b9a\u6027</strong>\uff1a</p>\n<ul>\n<li>ILU(0)\uff1a\u53ef\u80fd\u4e0d\u7a33\u5b9a\uff0c\u9700\u8981\u5bf9\u89d2\u4fee\u6b63</li>\n<li>ILUT\uff1a\u5e26\u9608\u503c\uff0c\u66f4\u7a33\u5b9a\u4f46\u586b\u5145\u66f4\u591a</li>\n<li>Modified ILU\uff1a\u4fdd\u6301\u67d0\u4e9b\u6570\u5b66\u6027\u8d28</li>\n</ul>\n<h3 id=\"42\">4.2 \u5206\u5e03\u5f0f\u8ba1\u7b97\u4e2d\u7684\u8bef\u5dee\u7d2f\u79ef</h3>\n<p><strong>\u901a\u4fe1\u8bf1\u5bfc\u7684\u8bef\u5dee</strong>\uff1a</p>\n<ul>\n<li>\u5f02\u6b65\u66f4\u65b0\u5e26\u6765\u7684\u4e0d\u4e00\u81f4\u6027</li>\n<li>\u90e8\u5206\u548c\u7684\u7d2f\u79ef\u8bef\u5dee</li>\n<li>\u4e0d\u540c\u5904\u7406\u5668\u7684\u820d\u5165\u5dee\u5f02</li>\n</ul>\n<p><strong>\u7f13\u89e3\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u786e\u5b9a\u6027\u7684\u5f52\u7ea6\u64cd\u4f5c</li>\n<li>\u5b9a\u671f\u540c\u6b65\u548c\u8bef\u5dee\u4fee\u6b63</li>\n<li>Allreduce\u64cd\u4f5c\u7684\u7a33\u5b9a\u5b9e\u73b0</li>\n</ul>\n<h3 id=\"43\">4.3 \u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</h3>\n<p><strong>\u8fed\u4ee3\u7cbe\u5316(Iterative Refinement)</strong>\uff1a</p>\n<ol>\n<li>\u4f4e\u7cbe\u5ea6\u8ba1\u7b97\u8fd1\u4f3c\u89e3</li>\n<li>\u9ad8\u7cbe\u5ea6\u8ba1\u7b97\u6b8b\u5dee</li>\n<li>\u4f4e\u7cbe\u5ea6\u6c42\u89e3\u4fee\u6b63\u65b9\u7a0b</li>\n<li>\u66f4\u65b0\u89e3\u5e76\u91cd\u590d</li>\n</ol>\n<p><strong>\u7cbe\u5ea6\u9009\u62e9\u51c6\u5219</strong>\uff1a</p>\n<ul>\n<li>\u5de5\u4f5c\u7cbe\u5ea6\uff1a\u5355\u7cbe\u5ea6(FP32)\u6216\u534a\u7cbe\u5ea6(FP16)</li>\n<li>\u6b8b\u5dee\u8ba1\u7b97\uff1a\u81f3\u5c11\u53cc\u7cbe\u5ea6(FP64)</li>\n<li>\u7d2f\u52a0\u5668\uff1a\u8003\u8651\u4f7f\u7528\u6269\u5c55\u7cbe\u5ea6</li>\n</ul>\n<h3 id=\"44-gpu\">4.4 GPU\u8ba1\u7b97\u7684\u6570\u503c\u7279\u6027</h3>\n<p><strong>\u4e0eCPU\u7684\u5dee\u5f02</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u540c\u7684\u820d\u5165\u6a21\u5f0f</li>\n<li>\u878d\u5408\u4e58\u52a0(FMA)\u7684\u4f7f\u7528</li>\n<li>\u5e76\u884c\u5f52\u7ea6\u7684\u975e\u786e\u5b9a\u6027</li>\n</ul>\n<p><strong>\u6700\u4f73\u5b9e\u8df5</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528cuBLAS/cuSolver\u7684\u7a33\u5b9a\u4f8b\u7a0b</li>\n<li>\u6ce8\u610fwarp\u7ea7\u522b\u7684\u540c\u6b65</li>\n<li>\u5bf9\u4e8e\u9ad8\u7cbe\u5ea6\u9700\u6c42\uff0c\u8003\u8651\u4f7f\u7528\u5f20\u91cf\u6838\u5fc3\u7684\u6df7\u5408\u7cbe\u5ea6\u6a21\u5f0f</li>\n</ul>\n<h2 id=\"5\">5. \u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u6570\u503c\u7a33\u5b9a\u6027\u662f\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u6210\u529f\u7684\u5173\u952e\u3002\u672c\u9644\u5f55\u603b\u7ed3\u4e86\u4ee5\u4e0b\u6838\u5fc3\u6982\u5ff5\uff1a</p>\n<ol>\n<li><strong>\u6761\u4ef6\u6570</strong>\u662f\u7406\u89e3\u6570\u503c\u654f\u611f\u6027\u7684\u57fa\u7840\u5de5\u5177\uff0c\u5b83\u91cf\u5316\u4e86\u8f93\u5165\u6270\u52a8\u5bf9\u8f93\u51fa\u7684\u653e\u5927\u6548\u5e94</li>\n<li><strong>\u540e\u5411\u7a33\u5b9a\u6027</strong>\u662f\u8bc4\u4f30\u7b97\u6cd5\u8d28\u91cf\u7684\u91d1\u6807\u51c6\uff0c\u786e\u4fdd\u8ba1\u7b97\u7ed3\u679c\u662f\u67d0\u4e2a\u90bb\u8fd1\u95ee\u9898\u7684\u7cbe\u786e\u89e3</li>\n<li><strong>\u7b97\u6cd5\u9009\u62e9</strong>\u9700\u8981\u6743\u8861\u7a33\u5b9a\u6027\u3001\u6548\u7387\u548c\u95ee\u9898\u7ed3\u6784\uff0c\u6ca1\u6709\u4e07\u80fd\u7684\u6700\u4f18\u7b97\u6cd5</li>\n<li><strong>\u8bef\u5dee\u63a7\u5236</strong>\u9700\u8981\u7efc\u5408\u8003\u8651\u820d\u5165\u3001\u622a\u65ad\u548c\u7d2f\u79ef\u6548\u5e94\uff0c\u7279\u522b\u662f\u5728\u8fed\u4ee3\u548c\u5206\u5e03\u5f0f\u573a\u666f\u4e2d</li>\n<li><strong>\u7279\u6b8a\u786c\u4ef6</strong>\uff08\u5982GPU\uff09\u548c<strong>\u6df7\u5408\u7cbe\u5ea6</strong>\u8ba1\u7b97\u5e26\u6765\u65b0\u7684\u7a33\u5b9a\u6027\u6311\u6218\uff0c\u9700\u8981\u4e13\u95e8\u7684\u5904\u7406\u7b56\u7565</li>\n</ol>\n<p>\u5173\u952e\u516c\u5f0f\u6c47\u603b\uff1a</p>\n<ul>\n<li>\u6761\u4ef6\u6570\u5b9a\u4e49\uff1a$\\kappa(\\mathbf{A}) = |\\mathbf{A}| |\\mathbf{A}^{-1}|$</li>\n<li>\u8bef\u5dee\u4f20\u64ad\uff1a$\\text{\u76f8\u5bf9\u8bef\u5dee} \\leq \\kappa \\times \\text{\u76f8\u5bf9\u6270\u52a8}$</li>\n<li>\u673a\u5668\u7cbe\u5ea6\uff1a\u53cc\u7cbe\u5ea6 $\\epsilon \\approx 2.2 \\times 10^{-16}$</li>\n<li>\u8fed\u4ee3\u7cbe\u5316\u6536\u655b\u6761\u4ef6\uff1a$\\kappa(\\mathbf{A}) \\cdot \\epsilon &lt; 1$</li>\n</ul>\n<h2 id=\"6\">6. \u7ec3\u4e60\u9898</h2>\n<h3 id=\"_1\">\u57fa\u7840\u9898</h3>\n<p><strong>\u7ec3\u4e60 19.1</strong>\uff1a\u6761\u4ef6\u6570\u4f30\u8ba1\n\u7ed9\u5b9a\u77e9\u9635 $\\mathbf{A} = \\begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 1+\\epsilon \\end{bmatrix}$\uff0c\u5176\u4e2d $\\epsilon &gt; 0$ \u5f88\u5c0f\u3002\na) \u8ba1\u7b97 $\\kappa_2(\\mathbf{A})$ \u4f5c\u4e3a $\\epsilon$ \u7684\u51fd\u6570\nb) \u5f53 $\\epsilon = 10^{-8}$ \u65f6\uff0c\u6c42\u89e3 $\\mathbf{A}\\mathbf{x} = [2, 2+\\epsilon]^T$ \u9884\u671f\u635f\u5931\u591a\u5c11\u4f4d\u6709\u6548\u6570\u5b57\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5148\u8ba1\u7b97\u7279\u5f81\u503c\uff0c\u6ce8\u610f\u5f53 $\\epsilon$ \u5f88\u5c0f\u65f6\u7684\u8fd1\u4f3c\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) \u77e9\u9635 $\\mathbf{A}$ \u7684\u7279\u5f81\u503c\u4e3a\uff1a</p>\n<ul>\n<li>$\\lambda_1 = 2 + \\epsilon/2 + O(\\epsilon^2)$</li>\n<li>$\\lambda_2 = \\epsilon/2 + O(\\epsilon^2)$</li>\n</ul>\n<p>\u56e0\u6b64\uff1a$\\kappa_2(\\mathbf{A}) = \\frac{\\lambda_1}{\\lambda_2} \\approx \\frac{4}{\\epsilon}$</p>\n<p>b) \u5f53 $\\epsilon = 10^{-8}$ \u65f6\uff0c$\\kappa_2(\\mathbf{A}) \\approx 4 \\times 10^8$</p>\n<p>\u9884\u671f\u635f\u5931\u7ea6 8-9 \u4f4d\u6709\u6548\u6570\u5b57\u3002\u5b9e\u9645\u89e3\u4e3a $\\mathbf{x} = [1, 1]^T$\uff0c\u4f46\u6570\u503c\u89e3\u53ef\u80fd\u6709\u663e\u8457\u8bef\u5dee\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 19.2</strong>\uff1a\u540e\u5411\u8bef\u5dee\u5206\u6790\n\u4f7f\u7528\u9ad8\u65af\u6d88\u5143\u6cd5\uff08\u65e0\u9009\u4e3b\u5143\uff09\u6c42\u89e3\uff1a\n$$\\begin{bmatrix} \\epsilon &amp; 1 \\ 1 &amp; 1 \\end{bmatrix} \\begin{bmatrix} x_1 \\ x_2 \\end{bmatrix} = \\begin{bmatrix} 1 \\ 2 \\end{bmatrix}$$\n\u5176\u4e2d $\\epsilon = 10^{-20}$\u3002\u5206\u6790\u5728\u53cc\u7cbe\u5ea6\u4e0b\u7684\u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8ffd\u8e2a\u6d88\u5143\u8fc7\u7a0b\u4e2d\u7684\u6570\u503c\uff0c\u6ce8\u610f\u4f55\u65f6\u51fa\u73b0\u707e\u96be\u6027\u62b5\u6d88\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6d88\u5143\u8fc7\u7a0b\uff1a</p>\n<ol>\n<li>\u7b2c\u4e00\u6b65\uff1a$m_{21} = 1/\\epsilon = 10^{20}$ \uff08\u6ea2\u51fa\u98ce\u9669\uff09</li>\n<li>\u66f4\u65b0\uff1a$a_{22}^{(1)} = 1 - 10^{20}$ \uff08\u707e\u96be\u6027\u62b5\u6d88\uff09</li>\n<li>\u5728\u6d6e\u70b9\u8fd0\u7b97\u4e2d\uff1a$a_{22}^{(1)} \\approx -10^{20}$</li>\n</ol>\n<p>\u56de\u4ee3\u5f97\u5230\u7684\u6570\u503c\u89e3\u4e25\u91cd\u504f\u79bb\u771f\u5b9e\u89e3 $x_1 = 1, x_2 = 1$\u3002</p>\n<p>\u4f7f\u7528\u90e8\u5206\u9009\u4e3b\u5143\u53ef\u4ee5\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff1a\u4ea4\u6362\u4e24\u884c\u540e\uff0c\u6d88\u5143\u56e0\u5b50\u53d8\u4e3a $\\epsilon$\uff0c\u8ba1\u7b97\u7a33\u5b9a\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 19.3</strong>\uff1a\u8fed\u4ee3\u7cbe\u5316\n\u8003\u8651\u7ebf\u6027\u7cfb\u7edf $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$\uff0c\u5176\u4e2d $\\kappa(\\mathbf{A}) = 10^6$\u3002\na) \u5982\u679c\u4f7f\u7528\u5355\u7cbe\u5ea6\uff08$\\epsilon_s \\approx 10^{-7}$\uff09\u6c42\u89e3\uff0c\u8fed\u4ee3\u7cbe\u5316\u80fd\u5426\u6539\u5584\u7ed3\u679c\uff1f\nb) \u9700\u8981\u591a\u5c11\u6b21\u8fed\u4ee3\u624d\u80fd\u8fbe\u5230\u53cc\u7cbe\u5ea6\u7684\u7cbe\u5ea6\u6c34\u5e73\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8fed\u4ee3\u7cbe\u5316\u7684\u6536\u655b\u56e0\u5b50\u7ea6\u4e3a $\\kappa(\\mathbf{A}) \\cdot \\epsilon_{\\text{work}}$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) \u6536\u655b\u56e0\u5b50 $\\rho = \\kappa(\\mathbf{A}) \\cdot \\epsilon_s = 10^6 \\times 10^{-7} = 0.1 &lt; 1$</p>\n<p>\u56e0\u6b64\u8fed\u4ee3\u7cbe\u5316\u4f1a\u6536\u655b\uff0c\u80fd\u591f\u6539\u5584\u7ed3\u679c\u3002</p>\n<p>b) \u6bcf\u6b21\u8fed\u4ee3\u8bef\u5dee\u51cf\u5c11\u56e0\u5b50\u7ea6\u4e3a 0.1\u3002\u8981\u4ece\u5355\u7cbe\u5ea6\u8bef\u5dee\uff08$10^{-7}$\uff09\u6539\u5584\u5230\u53cc\u7cbe\u5ea6\uff08$10^{-16}$\uff09\uff0c\u9700\u8981\u8bef\u5dee\u51cf\u5c11 $10^9$ \u500d\u3002</p>\n<p>\u6240\u9700\u8fed\u4ee3\u6b21\u6570\uff1a$k \\geq \\frac{\\log(10^9)}{\\log(10)} = 9$ \u6b21</p>\n<p>\u5b9e\u8df5\u4e2d\u901a\u5e38 2-3 \u6b21\u8fed\u4ee3\u5c31\u80fd\u83b7\u5f97\u663e\u8457\u6539\u5584\u3002</p>\n</details>\n<h3 id=\"_2\">\u6311\u6218\u9898</h3>\n<p><strong>\u7ec3\u4e60 19.4</strong>\uff1a\u7ed3\u6784\u5316\u6761\u4ef6\u6570\n\u8003\u8651\u4e09\u5bf9\u89d2\u77e9\u9635\uff1a\n$$\\mathbf{T}_n = \\begin{bmatrix}\n2 &amp; -1 &amp; &amp; &amp; \\\n-1 &amp; 2 &amp; -1 &amp; &amp; \\\n&amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\\n&amp; &amp; -1 &amp; 2 &amp; -1 \\\n&amp; &amp; &amp; -1 &amp; 2\n\\end{bmatrix}_{n \\times n}$$\na) \u8bc1\u660e $\\kappa_2(\\mathbf{T}_n) = O(n^2)$\nb) \u8bbe\u8ba1\u4e00\u4e2a\u9884\u6761\u4ef6\u5b50\u4f7f\u5f97 $\\kappa(\\mathbf{M}^{-1}\\mathbf{T}_n) = O(1)$\nc) \u8fd9\u4e2a\u7ed3\u679c\u5bf9\u6709\u9650\u5dee\u5206\u79bb\u6563\u5316\u6709\u4ec0\u4e48\u542f\u793a\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5229\u7528 $\\mathbf{T}_n$ \u7684\u7279\u5f81\u503c\u663e\u5f0f\u516c\u5f0f\uff0c\u8003\u8651\u79bb\u6563\u4e8c\u9636\u5bfc\u6570\u7b97\u5b50\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) $\\mathbf{T}_n$ \u7684\u7279\u5f81\u503c\u4e3a\uff1a$\\lambda_k = 2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right), k = 1, ..., n$</p>\n<p>\u6700\u5c0f\u7279\u5f81\u503c\uff1a$\\lambda_1 \\approx \\frac{\\pi^2}{(n+1)^2}$\n   \u6700\u5927\u7279\u5f81\u503c\uff1a$\\lambda_n \\approx 4$</p>\n<p>\u56e0\u6b64\uff1a$\\kappa_2(\\mathbf{T}_n) = \\frac{\\lambda_n}{\\lambda_1} \\approx \\frac{4(n+1)^2}{\\pi^2} = O(n^2)$</p>\n<p>b) \u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u9884\u6761\u4ef6\u5b50\uff1a</p>\n<ul>\n<li>\u591a\u91cd\u7f51\u683c\u65b9\u6cd5\u7684\u7c97\u7f51\u683c\u7b97\u5b50</li>\n<li>\u4e0d\u5b8c\u5168Cholesky\u5206\u89e3</li>\n<li>\u5faa\u73af\u7ea6\u5316\u5f97\u5230\u7684\u8fd1\u4f3c\u9006</li>\n</ul>\n<p>\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u80fd\u4f7f\u6761\u4ef6\u6570\u4e0e $n$ \u65e0\u5173\u3002</p>\n<p>c) \u542f\u793a\uff1a</p>\n<ul>\n<li>\u7f51\u683c\u52a0\u5bc6\u5bfc\u81f4\u6761\u4ef6\u6570\u5feb\u901f\u589e\u957f</li>\n<li>\u7b80\u5355\u8fed\u4ee3\u6cd5\uff08\u5982Jacobi\uff09\u6536\u655b\u53d8\u6162</li>\n<li>\u591a\u5c3a\u5ea6\u65b9\u6cd5\u662f\u5fc5\u8981\u7684</li>\n<li>\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48PDE\u6c42\u89e3\u9700\u8981\u4e13\u95e8\u7684\u9884\u6761\u4ef6\u6280\u672f</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e60 19.5</strong>\uff1a\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\u8bbe\u8ba1\n\u4e3a\u4ee5\u4e0b\u573a\u666f\u8bbe\u8ba1\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u6c42\u89e3\u5927\u89c4\u6a21\u7a20\u5bc6\u7ebf\u6027\u7cfb\u7edf $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$\uff0c$n = 10000$</li>\n<li>$\\mathbf{A}$ \u5b58\u50a8\u9700\u8981 800MB\uff08\u53cc\u7cbe\u5ea6\uff09</li>\n<li>GPU\u663e\u5b58\u9650\u5236\u4e3a 4GB</li>\n<li>\u9700\u8981\u76f8\u5bf9\u8bef\u5dee $&lt; 10^{-10}$</li>\n</ul>\n<p>\u8981\u6c42\uff1a\u6700\u5927\u5316\u6027\u80fd\u540c\u65f6\u4fdd\u8bc1\u6570\u503c\u7cbe\u5ea6\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u5206\u5757\u7b97\u6cd5\u3001\u8fed\u4ee3\u7cbe\u5316\u548c\u9009\u62e9\u6027\u4f7f\u7528\u9ad8\u7cbe\u5ea6\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4f18\u5316\u7684\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5b58\u50a8\u65b9\u6848</strong>\uff1a\n   - $\\mathbf{A}$ \u5b58\u50a8\u4e3aFP32\uff08400MB\uff09\n   - \u5de5\u4f5c\u7a7a\u95f4\u9884\u7559\u7528\u4e8e\u5206\u5757\n   - \u5173\u952e\u4e2d\u95f4\u91cf\uff08\u5982\u4e3b\u5143\uff09\u4fdd\u6301FP64</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u6d41\u7a0b</strong>\uff1a\n   ```</p>\n</li>\n<li>\n<p>FP32: LU\u5206\u89e3\uff08\u5e26\u90e8\u5206\u9009\u4e3b\u5143\uff09</p>\n</li>\n<li>FP32: \u524d\u5411/\u56de\u4ee3\u5f97\u5230\u521d\u59cb\u89e3 x\u2080</li>\n<li>FP64: \u8ba1\u7b97\u6b8b\u5dee r = b - Ax\u2080</li>\n<li>FP32: \u6c42\u89e3\u4fee\u6b63\u65b9\u7a0b Az = r</li>\n<li>FP64: \u66f4\u65b0 x\u2081 = x\u2080 + z</li>\n<li>\n<p>\u91cd\u590d\u6b65\u9aa43-5\u76f4\u5230\u6536\u655b\n   ```</p>\n</li>\n<li>\n<p><strong>\u5206\u5757\u4f18\u5316</strong>\uff1a\n   - \u5757\u5927\u5c0f\u9009\u62e9\uff1a\u5e73\u8861\u663e\u5b58\u548c\u8ba1\u7b97\u6548\u7387\n   - \u5bf9\u89d2\u5757\u7528FP64\uff0c\u975e\u5bf9\u89d2\u5757\u7528FP32\n   - \u4f7f\u7528\u9762\u677f\u5206\u89e3\u51cf\u5c11\u901a\u4fe1</p>\n</li>\n<li>\n<p><strong>\u6536\u655b\u4fdd\u8bc1</strong>\uff1a\n   - \u76d1\u63a7\u76f8\u5bf9\u6b8b\u5dee\uff08FP64\u8ba1\u7b97\uff09\n   - \u5982\u679c\u505c\u6ede\uff0c\u5207\u6362\u5230FP64\u91cd\u65b0\u5206\u89e3\n   - \u5178\u578b\u60c5\u51b5\u4e0b2-3\u6b21\u8fed\u4ee3\u5373\u53ef\u8fbe\u5230\u76ee\u6807\u7cbe\u5ea6</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u4f30\u8ba1</strong>\uff1a\n   - \u76f8\u6bd4\u7eafFP64\u52a0\u901f\u7ea61.8-2.2\u500d\n   - \u5185\u5b58\u4f7f\u7528\u51cf\u5c11\u7ea645%\n   - \u6570\u503c\u7cbe\u5ea6\u6ee1\u8db3\u8981\u6c42</p>\n</li>\n</ol>\n</details>\n<p><strong>\u7ec3\u4e60 19.6</strong>\uff1a\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u6570\u503c\u7a33\u5b9a\u6027\n\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u8ba1\u7b97 $|\\mathbf{A}|_F^2 = \\sum_{i,j} a_{ij}^2$\uff0c\u5176\u4e2d\u77e9\u9635 $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ \u6309\u884c\u5206\u5757\u5b58\u50a8\u5728 $p$ \u4e2a\u5904\u7406\u5668\u4e0a\u3002</p>\n<p>a) \u5206\u6790\u6734\u7d20\u5e76\u884c\u6c42\u548c\u7684\u8bef\u5dee\u7d2f\u79ef\nb) \u8bbe\u8ba1\u4e00\u4e2a\u6570\u503c\u7a33\u5b9a\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\nc) \u5982\u4f55\u5904\u7406\u5404\u5904\u7406\u5668\u4e0a\u7684\u6570\u636e\u89c4\u6a21\u4e25\u91cd\u4e0d\u5e73\u8861\u7684\u60c5\u51b5\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u6811\u5f62\u5f52\u7ea6\u548c\u8bef\u5dee\u8865\u507f\u6280\u672f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) <strong>\u6734\u7d20\u65b9\u6cd5\u7684\u8bef\u5dee\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6bcf\u4e2a\u5904\u7406\u5668\u5c40\u90e8\u8bef\u5dee\uff1a$O(\\epsilon n^2/p)$</li>\n<li>\u5f52\u7ea6\u8fc7\u7a0b\u8bef\u5dee\uff1a$O(\\epsilon \\log p)$</li>\n<li>\u6700\u574f\u60c5\u51b5\u603b\u8bef\u5dee\uff1a$O(\\epsilon n^2)$</li>\n<li>\u5f53\u90e8\u5206\u548c\u6570\u91cf\u7ea7\u5dee\u5f02\u5927\u65f6\uff0c\u53ef\u80fd\u51fa\u73b0\u707e\u96be\u6027\u62b5\u6d88</li>\n</ul>\n<p>b) <strong>\u7a33\u5b9a\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5</strong>\uff1a\n   ```</p>\n<ol>\n<li>\n<p>\u5c40\u90e8\u8ba1\u7b97\uff08\u6bcf\u4e2a\u5904\u7406\u5668\uff09\uff1a</p>\n<ul>\n<li>\u4f7f\u7528Kahan\u6c42\u548c\u6216\u6210\u5bf9\u6c42\u548c</li>\n<li>\u8ba1\u7b97\u5c40\u90e8\u548c S_i \u53ca\u8bef\u5dee\u8865\u507f\u9879 C_i</li>\n</ul>\n</li>\n<li>\n<p>\u5168\u5c40\u5f52\u7ea6\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u786e\u5b9a\u6027\u6811\u5f62\u5f52\u7ea6</li>\n<li>\u4f20\u8f93(S_i, C_i)\u5bf9\u800c\u975e\u5355\u4e00\u503c</li>\n<li>\u5728\u5f52\u7ea6\u65f6\u7ee7\u7eed\u4f7f\u7528\u8865\u507f\u6c42\u548c</li>\n</ul>\n</li>\n<li>\n<p>\u53ef\u9009\u7684\u4e24\u904d\u7b97\u6cd5\uff1a</p>\n<ul>\n<li>\u7b2c\u4e00\u904d\uff1a\u8ba1\u7b97\u89c4\u6a21\u4f30\u8ba1</li>\n<li>\u7b2c\u4e8c\u904d\uff1a\u4f7f\u7528\u7f29\u653e\u907f\u514d\u6ea2\u51fa\n   ```</li>\n</ul>\n</li>\n</ol>\n<p>c) <strong>\u8d1f\u8f7d\u4e0d\u5e73\u8861\u7684\u5904\u7406</strong>\uff1a</p>\n<ul>\n<li><strong>\u52a8\u6001\u7f29\u653e</strong>\uff1a\u6839\u636e\u5c40\u90e8\u6700\u5927\u503c\u9009\u62e9\u7f29\u653e\u56e0\u5b50</li>\n<li><strong>\u5206\u5c42\u5f52\u7ea6</strong>\uff1a\u5148\u5728\u76f8\u4f3c\u89c4\u6a21\u7684\u5904\u7406\u5668\u95f4\u5f52\u7ea6</li>\n<li><strong>\u4f7f\u7528\u9ad8\u7cbe\u5ea6\u7d2f\u52a0\u5668</strong>\uff1a\u5982\u4f7f\u7528128\u4f4d\u6d6e\u70b9\u6570</li>\n<li><strong>\u81ea\u9002\u5e94\u7b97\u6cd5</strong>\uff1a\n     <code>if (max_local_sum / min_local_sum &gt; 10^6)\n         \u4f7f\u7528\u6392\u5e8f\u5f52\u7ea6\n     else\n         \u4f7f\u7528\u6807\u51c6\u6811\u5f62\u5f52\u7ea6</code></li>\n</ul>\n<p>\u5173\u952e\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ul>\n<li>\u901a\u4fe1\u4e0e\u7cbe\u5ea6\u7684\u6700\u4f18\u6743\u8861</li>\n<li>\u5f02\u6b65\u7b97\u6cd5\u7684\u8bef\u5dee\u754c</li>\n<li>\u786c\u4ef6\u611f\u77e5\u7684\u5f52\u7ea6\u7b56\u7565</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e60 19.7</strong>\uff1a\u521b\u65b0\u7b97\u6cd5\u7684\u7a33\u5b9a\u6027\u5206\u6790\n\u6700\u8fd1\u63d0\u51fa\u7684\"\u968f\u673a\u9012\u5f52\u6700\u5c0f\u4e8c\u4e58\"(Randomized Recursive Least Squares, RRLS)\u7b97\u6cd5\u901a\u8fc7\u968f\u673a\u91c7\u6837\u548c\u9012\u5f52\u66f4\u65b0\u6765\u6c42\u89e3\u8d85\u5b9a\u7cfb\u7edf\u3002\u7b97\u6cd5\u6838\u5fc3\u662f\uff1a\n$$\\mathbf{H}_{k+1} = \\mathbf{H}_k - \\frac{\\mathbf{H}_k \\mathbf{a}_k \\mathbf{a}_k^T \\mathbf{H}_k}{\\mathbf{a}_k^T \\mathbf{H}_k \\mathbf{a}_k + \\lambda}$$\n\u5176\u4e2d $\\mathbf{H}_k$ \u903c\u8fd1 $(\\mathbf{A}^T\\mathbf{A})^{-1}$\uff0c$\\mathbf{a}_k$ \u662f\u968f\u673a\u91c7\u6837\u7684\u884c\u3002</p>\n<p>\u5206\u6790\u8be5\u7b97\u6cd5\u7684\u6570\u503c\u7a33\u5b9a\u6027\uff0c\u7279\u522b\u662f\uff1a\na) \u4f55\u65f6\u4f1a\u51fa\u73b0\u6570\u503c\u5d29\u6e83\uff1f\nb) \u5982\u4f55\u6539\u8fdb\u7b97\u6cd5\u4ee5\u63d0\u9ad8\u7a33\u5b9a\u6027\uff1f\nc) \u4e0e\u7ecf\u5178\u65b9\u6cd5\u76f8\u6bd4\u7684\u4f18\u52a3\uff1f</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8fd9\u662fSherman-Morrison\u516c\u5f0f\u7684\u5e94\u7528\uff0c\u8003\u8651\u5206\u6bcd\u63a5\u8fd1\u96f6\u7684\u60c5\u51b5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) <strong>\u6570\u503c\u5d29\u6e83\u7684\u6761\u4ef6</strong>\uff1a</p>\n<ol>\n<li>\u5f53 $\\mathbf{a}_k^T \\mathbf{H}_k \\mathbf{a}_k + \\lambda \\approx 0$</li>\n<li>$\\mathbf{H}_k$ \u5931\u53bb\u6b63\u5b9a\u6027</li>\n<li>\u820d\u5165\u8bef\u5dee\u7d2f\u79ef\u5bfc\u81f4\u975e\u5bf9\u79f0\u6027</li>\n<li>\u6761\u4ef6\u6570\u589e\u957f\u5931\u63a7</li>\n</ol>\n<p>b) <strong>\u7a33\u5b9a\u6027\u6539\u8fdb\u65b9\u6848</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6b63\u5b9a\u6027\u7ef4\u62a4</strong>\uff1a\n        <code>\u6bcf\u9694m\u6b65\uff1aH = (H + H^T)/2\n        \u5982\u679c\u6700\u5c0f\u7279\u5f81\u503c &lt; \u03b5\uff1aH = H + \u03b5I</code></p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6b63\u5219\u5316</strong>\uff1a\n        <code>\u03bb_k = max(\u03bb_min, \u03c4\u00b7trace(H_k)/n)\n        \u5176\u4e2d\u03c4 ~ 10^(-12)</code></p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u5b89\u5168\u66f4\u65b0</strong>\uff1a\n        <code>\u8ba1\u7b97 d = a_k^T H_k a_k + \u03bb\n        if (d &lt; \u03b5\u00b7\u2016H_k\u2016\u00b7\u2016a_k\u2016\u00b2)\n            \u8df3\u8fc7\u6b64\u6b21\u66f4\u65b0\n        else\n            \u6267\u884cSherman-Morrison\u66f4\u65b0</code></p>\n</li>\n<li>\n<p><strong>\u5468\u671f\u6027\u91cd\u542f</strong>\uff1a\n        <code>if (cond(H_k) &gt; threshold)\n            \u4f7f\u7528\u6700\u8fd1\u7684\u6837\u672c\u91cd\u65b0\u521d\u59cb\u5316</code></p>\n</li>\n</ol>\n<p>c) <strong>\u4e0e\u7ecf\u5178\u65b9\u6cd5\u6bd4\u8f83</strong>\uff1a</p>\n<p><strong>\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u5728\u7ebf/\u589e\u91cf\u66f4\u65b0\u80fd\u529b</li>\n<li>\u5185\u5b58\u9700\u6c42 O(n\u00b2) vs O(mn)</li>\n<li>\u9002\u5408\u6d41\u6570\u636e\u5904\u7406</li>\n</ul>\n<p><strong>\u52a3\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u6536\u655b\u901f\u5ea6\u4f9d\u8d56\u4e8e\u91c7\u6837</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u8f83QR\u5206\u89e3\u5dee</li>\n<li>\u9700\u8981\u7cbe\u5fc3\u7684\u53c2\u6570\u8c03\u8282</li>\n</ul>\n<p><strong>\u9002\u7528\u573a\u666f</strong>\uff1a</p>\n<ul>\n<li>\u6570\u636e\u6301\u7eed\u5230\u8fbe\u7684\u5728\u7ebf\u5b66\u4e60</li>\n<li>\u5b58\u50a8\u53d7\u9650\u7684\u5d4c\u5165\u5f0f\u7cfb\u7edf</li>\n<li>\u53ef\u4ee5\u5bb9\u5fcd\u4e00\u5b9a\u7cbe\u5ea6\u635f\u5931\u7684\u5e94\u7528</li>\n</ul>\n</details>\n<h2 id=\"7-gotchas\">7. \u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<h3 id=\"71\">7.1 \u6613\u88ab\u5ffd\u89c6\u7684\u7cbe\u5ea6\u635f\u5931\u6e90</h3>\n<ol>\n<li>\n<p><strong>\u9690\u5f0f\u7684\u707e\u96be\u6027\u62b5\u6d88</strong>\n   - \u8ba1\u7b97 $\\mathbf{A}^T\\mathbf{A}$ \u5f62\u6210\u6cd5\u65b9\u7a0b\n   - \u4e24\u4e2a\u63a5\u8fd1\u77e9\u9635\u7684\u5dee\uff1a$\\mathbf{A} - \\mathbf{B}$\n   - \u4f7f\u7528 $\\log(1 + x)$ \u800c\u975e <code>log1p(x)</code></p>\n</li>\n<li>\n<p><strong>\u7ef4\u5ea6\u8bc5\u5492\u5f15\u8d77\u7684\u6570\u503c\u95ee\u9898</strong>\n   - \u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u8ddd\u79bb\u8ba1\u7b97\n   - \u534f\u65b9\u5dee\u77e9\u9635\u5728\u9ad8\u7ef4\u4e0b\u8d8b\u5411\u5947\u5f02\n   - \u968f\u673a\u6295\u5f71\u7684\u6982\u7387\u4fdd\u8bc1vs\u5b9e\u9645\u7cbe\u5ea6</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u5f15\u5165\u7684\u4e0d\u4e00\u81f4\u6027</strong>\n   - \u4e0d\u540c\u7684\u6c42\u548c\u987a\u5e8f\n   - \u975e\u539f\u5b50\u64cd\u4f5c\u7684\u7ade\u4e89\u6761\u4ef6\n   - \u7f13\u5b58\u4e00\u81f4\u6027\u5bfc\u81f4\u7684\u5fae\u5c0f\u5dee\u5f02</p>\n</li>\n</ol>\n<h3 id=\"72\">7.2 \u8c03\u8bd5\u6570\u503c\u95ee\u9898\u7684\u7cfb\u7edf\u65b9\u6cd5</h3>\n<ol>\n<li>\n<p><strong>\u4f7f\u7528\u54e8\u5175\u503c</strong>\uff1a\n   <code>\u5728\u5173\u952e\u4f4d\u7f6e\u63d2\u5165\u5df2\u77e5\u7684\u6d4b\u8bd5\u5411\u91cf\n   \u9a8c\u8bc1\u5b83\u4eec\u662f\u5426\u88ab\u6b63\u786e\u5904\u7406</code></p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u76d1\u63a7</strong>\uff1a\n   <code>\u5b9a\u671f\u4f30\u8ba1\u548c\u8bb0\u5f55\u6761\u4ef6\u6570\n   \u5f53\u6761\u4ef6\u6570\u7a81\u53d8\u65f6\u89e6\u53d1\u8b66\u544a</code></p>\n</li>\n<li>\n<p><strong>\u6b8b\u5deevs\u8bef\u5dee</strong>\uff1a\n   <code>\u5c0f\u6b8b\u5dee \u2260 \u5c0f\u8bef\u5dee\uff08\u75c5\u6001\u95ee\u9898\uff09\n   \u5927\u6b8b\u5dee \u2260 \u5927\u8bef\u5dee\uff08\u826f\u6001\u95ee\u9898\u7684\u820d\u5165\uff09</code></p>\n</li>\n</ol>\n<h3 id=\"73\">7.3 \u5e73\u53f0\u76f8\u5173\u7684\u9677\u9631</h3>\n<ol>\n<li>\n<p><strong>\u7f16\u8bd1\u5668\u4f18\u5316\u7684\u526f\u4f5c\u7528</strong>\n   - <code>-ffast-math</code> \u53ef\u80fd\u7834\u574fIEEE\u5408\u89c4\u6027\n   - \u5faa\u73af\u5411\u91cf\u5316\u6539\u53d8\u6c42\u548c\u987a\u5e8f\n   - \u51fd\u6570\u5185\u8054\u5f71\u54cd\u7cbe\u5ea6</p>\n</li>\n<li>\n<p><strong>\u786c\u4ef6\u5dee\u5f02</strong>\n   - x86\u768480\u4f4d\u6269\u5c55\u7cbe\u5ea6\n   - ARM\u7684\u4e0d\u540c\u820d\u5165\u6a21\u5f0f\n   - GPU\u7684\u975e\u89c4\u8303\u5316\u6570\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u5e93\u7684\u4e0d\u4e00\u81f4\u6027</strong>\n   - \u4e0d\u540cBLAS\u5b9e\u73b0\u7684\u6570\u503c\u5dee\u5f02\n   - MKL vs OpenBLAS vs\u53c2\u8003\u5b9e\u73b0\n   - \u7248\u672c\u66f4\u65b0\u53ef\u80fd\u6539\u53d8\u6570\u503c\u884c\u4e3a</p>\n</li>\n</ol>\n<h2 id=\"8\">8. \u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_3\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u6761\u4ef6\u6570\u5206\u6790</strong></li>\n<li>\u4f30\u8ba1\u95ee\u9898\u7684\u56fa\u6709\u6761\u4ef6\u6570</li>\n<li>\u8bc6\u522b\u75c5\u6001\u7684\u5b50\u95ee\u9898</li>\n<li>\n<p>\u8003\u8651\u91cd\u65b0\u8868\u8ff0\u4ee5\u6539\u5584\u6761\u4ef6\u6570</p>\n</li>\n<li>\n<p>[ ] <strong>\u7b97\u6cd5\u9009\u62e9</strong></p>\n</li>\n<li>\u4f18\u5148\u9009\u62e9\u540e\u5411\u7a33\u5b9a\u7684\u7b97\u6cd5</li>\n<li>\u8003\u8651\u95ee\u9898\u7684\u7279\u6b8a\u7ed3\u6784</li>\n<li>\n<p>\u8bc4\u4f30\u7cbe\u5ea6vs\u6548\u7387\u7684\u6743\u8861</p>\n</li>\n<li>\n<p>[ ] <strong>\u8bef\u5dee\u9884\u7b97</strong></p>\n</li>\n<li>\u5206\u914d\u5404\u6b65\u9aa4\u7684\u8bef\u5dee\u5bb9\u9650</li>\n<li>\u8bc6\u522b\u8bef\u5dee\u653e\u5927\u7684\u5173\u952e\u6b65\u9aa4</li>\n<li>\u8bbe\u8ba1\u8bef\u5dee\u8865\u507f\u673a\u5236</li>\n</ul>\n<h3 id=\"_4\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u6570\u503c\u5b89\u5168\u7f16\u7a0b</strong></li>\n<li>\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4e2d\u95f4\u91cf\u8ba1\u7b97\uff08\u5982 $\\mathbf{A}^T\\mathbf{A}$\uff09</li>\n<li>\u4f7f\u7528\u7a33\u5b9a\u7684\u57fa\u672c\u64cd\u4f5c\uff08\u5982 <code>hypot</code>, <code>log1p</code>\uff09</li>\n<li>\n<p>\u5b9e\u73b0\u9002\u5f53\u7684\u7f29\u653e\u7b56\u7565</p>\n</li>\n<li>\n<p>[ ] <strong>\u7cbe\u5ea6\u7ba1\u7406</strong></p>\n</li>\n<li>\u5173\u952e\u8ba1\u7b97\u4f7f\u7528\u9ad8\u7cbe\u5ea6</li>\n<li>\u5b9e\u73b0\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565</li>\n<li>\n<p>\u4fdd\u7559\u8bef\u5dee\u4f30\u8ba1\u4fe1\u606f</p>\n</li>\n<li>\n<p>[ ] <strong>\u9c81\u68d2\u6027\u589e\u5f3a</strong></p>\n</li>\n<li>\u6dfb\u52a0\u6570\u503c\u5065\u5eb7\u68c0\u67e5</li>\n<li>\u5b9e\u73b0\u4f18\u96c5\u7684\u964d\u7ea7\u7b56\u7565</li>\n<li>\u63d0\u4f9b\u8bca\u65ad\u8f93\u51fa\u9009\u9879</li>\n</ul>\n<h3 id=\"_5\">\u6d4b\u8bd5\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u6570\u503c\u6d4b\u8bd5\u5957\u4ef6</strong></li>\n<li>\u5305\u542b\u75c5\u6001\u6d4b\u8bd5\u7528\u4f8b</li>\n<li>\u6d4b\u8bd5\u6781\u7aef\u8f93\u5165\uff08\u5f88\u5927/\u5f88\u5c0f\u7684\u6570\uff09</li>\n<li>\n<p>\u9a8c\u8bc1\u8bef\u5dee\u754c</p>\n</li>\n<li>\n<p>[ ] <strong>\u8de8\u5e73\u53f0\u9a8c\u8bc1</strong></p>\n</li>\n<li>\u6d4b\u8bd5\u4e0d\u540c\u786c\u4ef6\u67b6\u6784</li>\n<li>\u9a8c\u8bc1\u4e0d\u540c\u7f16\u8bd1\u9009\u9879</li>\n<li>\n<p>\u68c0\u67e5\u5e76\u884c\u5316\u7684\u6570\u503c\u4e00\u81f4\u6027</p>\n</li>\n<li>\n<p>[ ] <strong>\u6027\u80fdvs\u7cbe\u5ea6\u6743\u8861</strong></p>\n</li>\n<li>\u57fa\u51c6\u6d4b\u8bd5\u4e0d\u540c\u7cbe\u5ea6\u7ea7\u522b</li>\n<li>\u8bc4\u4f30\u7b97\u6cd5\u7684\u7cbe\u5ea6\u9000\u5316\u66f2\u7ebf</li>\n<li>\u786e\u5b9a\u6700\u4f18\u5de5\u4f5c\u70b9</li>\n</ul>\n<h3 id=\"_6\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] <strong>\u76d1\u63a7\u7b56\u7565</strong></li>\n<li>\u5b9e\u65f6\u6761\u4ef6\u6570\u4f30\u8ba1</li>\n<li>\u5f02\u5e38\u68c0\u6d4b\u673a\u5236</li>\n<li>\n<p>\u6027\u80fd\u9000\u5316\u9884\u8b66</p>\n</li>\n<li>\n<p>[ ] <strong>\u6587\u6863\u8981\u6c42</strong></p>\n</li>\n<li>\u660e\u786e\u6570\u503c\u5047\u8bbe\u548c\u9650\u5236</li>\n<li>\u63d0\u4f9b\u7cbe\u5ea6\u4fdd\u8bc1\u8bf4\u660e</li>\n<li>\n<p>\u5305\u542b\u6545\u969c\u6392\u9664\u6307\u5357</p>\n</li>\n<li>\n<p>[ ] <strong>\u6301\u7eed\u6539\u8fdb</strong></p>\n</li>\n<li>\u6536\u96c6\u6570\u503c\u5931\u8d25\u6848\u4f8b</li>\n<li>\u66f4\u65b0\u6d4b\u8bd5\u5957\u4ef6</li>\n<li>\u4f18\u5316\u5173\u952e\u6570\u503c\u6838\u5fc3</li>\n</ul>\n<h3 id=\"_7\">\u7279\u5b9a\u573a\u666f\u8865\u5145</h3>\n<p><strong>\u5927\u89c4\u6a21\u8ba1\u7b97</strong></p>\n<ul>\n<li>[ ] \u8003\u8651\u901a\u4fe1\u5f15\u8d77\u7684\u8bef\u5dee</li>\n<li>[ ] \u5b9e\u73b0\u68c0\u67e5\u70b9\u4ee5\u5e94\u5bf9\u6570\u503c\u5931\u8d25</li>\n<li>[ ] \u4f7f\u7528\u5206\u5c42\u7b97\u6cd5\u51cf\u5c11\u8bef\u5dee\u7d2f\u79ef</li>\n</ul>\n<p><strong>\u5b9e\u65f6\u7cfb\u7edf</strong></p>\n<ul>\n<li>[ ] \u56fa\u5b9a\u8fed\u4ee3\u6b21\u6570\u907f\u514d\u4e0d\u786e\u5b9a\u6027</li>\n<li>[ ] \u9884\u8ba1\u7b97\u6761\u4ef6\u6570\u9608\u503c</li>\n<li>[ ] \u5b9e\u73b0\u5feb\u901f\u4f46\u7565\u635f\u7cbe\u5ea6\u7684\u5907\u9009\u65b9\u6848</li>\n</ul>\n<p><strong>\u673a\u5668\u5b66\u4e60\u5e94\u7528</strong></p>\n<ul>\n<li>[ ] \u68af\u5ea6\u8ba1\u7b97\u7684\u6570\u503c\u7a33\u5b9a\u6027</li>\n<li>[ ] \u9632\u6b62\u6743\u91cd\u66f4\u65b0\u4e2d\u7684\u6570\u503c\u5d29\u6e83</li>\n<li>[ ] \u6279\u5f52\u4e00\u5316\u7b49\u6280\u672f\u7684\u6570\u503c\u8003\u8651</li>\n</ul>\n<h2 id=\"_8\">\u5ef6\u4f38\u9605\u8bfb\u4e0e\u7814\u7a76\u65b9\u5411</h2>\n<ol>\n<li><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6\u7b97\u6cd5</strong>\uff1a\u6839\u636e\u95ee\u9898\u6761\u4ef6\u6570\u52a8\u6001\u8c03\u6574\u5de5\u4f5c\u7cbe\u5ea6</li>\n<li><strong>\u6982\u7387\u6570\u503c\u65b9\u6cd5</strong>\uff1a\u5c06\u820d\u5165\u8bef\u5dee\u5efa\u6a21\u4e3a\u968f\u673a\u53d8\u91cf</li>\n<li><strong>\u5f62\u5f0f\u5316\u9a8c\u8bc1</strong>\uff1a\u4f7f\u7528\u5b9a\u7406\u8bc1\u660e\u5668\u9a8c\u8bc1\u6570\u503c\u7b97\u6cd5</li>\n<li><strong>\u91cf\u5b50\u7ea0\u9519\u7801\u542f\u53d1\u7684\u6570\u503c\u65b9\u6cd5</strong>\uff1a\u501f\u9274\u91cf\u5b50\u8ba1\u7b97\u7684\u9519\u8bef\u5904\u7406</li>\n<li><strong>\u795e\u7ecf\u7f51\u7edc\u8f85\u52a9\u7684\u7a33\u5b9a\u6027\u9884\u6d4b</strong>\uff1a\u4f7f\u7528ML\u9884\u6d4b\u6570\u503c\u5931\u8d25\u6a21\u5f0f</li>\n</ol>\n<p>\u672c\u9644\u5f55\u63d0\u4f9b\u4e86\u6570\u503c\u7a33\u5b9a\u6027\u7684\u5b9e\u7528\u6307\u5357\u3002\u8bb0\u4f4f\uff1a\u5728\u6570\u503c\u8ba1\u7b97\u4e2d\uff0c\u6b63\u786e\u7684\u7b97\u6cd5\u53ea\u662f\u8d77\u70b9\uff0c\u7a33\u5b9a\u7684\u5b9e\u73b0\u624d\u662f\u5173\u952e\u3002\u5f53\u9047\u5230\u6570\u503c\u95ee\u9898\u65f6\uff0c\u7cfb\u7edf\u5730\u5e94\u7528\u672c\u9644\u5f55\u7684\u539f\u5219\u548c\u6280\u672f\uff0c\u901a\u5e38\u80fd\u627e\u5230\u89e3\u51b3\u65b9\u6848\u3002</p>"
  },
  "../index.md": {
    "hash": "0dd277522d44110a5796a61541c5de9f",
    "content": "<h1 id=\"_1\">\u9ad8\u7ea7\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u6559\u7a0b</h1>\n<h2 id=\"_2\">\u524d\u8a00</h2>\n<p>\u672c\u6559\u7a0b\u9762\u5411\u719f\u6089\u57fa\u7840\u77e9\u9635\u8ba1\u7b97\u7684\u7814\u7a76\u8005\u548cAI\u79d1\u5b66\u5bb6\uff0c\u6df1\u5165\u63a2\u8ba8\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u9ad8\u7ea7\u4e3b\u9898\u3002\u6211\u4eec\u4e0d\u4ec5\u5173\u6ce8\u7ecf\u5178\u7b97\u6cd5\uff0c\u66f4\u5f3a\u8c03\u5728\u73b0\u4ee3AI\u5e94\u7528\u4e2d\u5c1a\u672a\u5145\u5206\u7814\u7a76\u7684\u6570\u5b66\u95ee\u9898\u3002\u6bcf\u7ae0\u5305\u542b\u7406\u8bba\u5206\u6790\u3001\u5b9e\u8df5\u6280\u5de7\u3001\u5e38\u89c1\u9677\u9631\u4ee5\u53ca\u5927\u91cf\u4e60\u9898\u3002</p>\n<h2 id=\"_3\">\u76ee\u5f55</h2>\n<h3 id=\"_4\">\u7b2c\u4e00\u90e8\u5206\uff1a\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\u57fa\u7840</h3>\n<h4 id=\"1\"><a href=\"chapter1.md\">\u7b2c1\u7ae0\uff1a\u4e8c\u9636\u4f18\u5316\u7684\u7edf\u4e00\u6846\u67b6</a></h4>\n<ul>\n<li>Newton\u6cd5\u3001Gauss-Newton\u6cd5\u4e0eNatural Gradient\u7684\u6570\u5b66\u8054\u7cfb</li>\n<li>Fisher\u4fe1\u606f\u77e9\u9635\u4e0eHessian\u7684\u5173\u7cfb</li>\n<li>Trust Region\u65b9\u6cd5\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u590d\u5174</li>\n<li>\u978d\u70b9\u9003\u9038\u7684\u7406\u8bba\u4e0e\u5b9e\u8df5</li>\n</ul>\n<h4 id=\"2hessian\"><a href=\"chapter2.md\">\u7b2c2\u7ae0\uff1aHessian\u8fd1\u4f3c\u7684\u827a\u672f</a></h4>\n<ul>\n<li>\u4eceBFGS\u5230L-BFGS\uff1a\u6709\u9650\u5185\u5b58\u65b9\u6cd5\u7684\u6df1\u5165\u5256\u6790</li>\n<li>Hessian-vector product\u7684\u9ad8\u6548\u8ba1\u7b97</li>\n<li>\u8d1f\u66f2\u7387\u65b9\u5411\u7684\u68c0\u6d4b\u4e0e\u5229\u7528</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u4e0e\u6761\u4ef6\u6570\u63a7\u5236</li>\n</ul>\n<h4 id=\"3\"><a href=\"chapter3.md\">\u7b2c3\u7ae0\uff1a\u7ed3\u6784\u5316\u4e8c\u9636\u65b9\u6cd5</a></h4>\n<ul>\n<li>Kronecker\u56e0\u5b50\u5206\u89e3\uff1aK-FAC\u53ca\u5176\u53d8\u4f53</li>\n<li>Block\u5bf9\u89d2\u8fd1\u4f3c\uff1aShampoo\u7b97\u6cd5\u89e3\u6790</li>\n<li>\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784\u7684\u5229\u7528</li>\n<li>\u7a00\u758fHessian\u6a21\u5f0f\u7684\u81ea\u52a8\u53d1\u73b0</li>\n</ul>\n<h3 id=\"_5\">\u7b2c\u4e8c\u90e8\u5206\uff1a\u589e\u91cf\u4e0e\u5728\u7ebf\u7b97\u6cd5</h3>\n<h4 id=\"4hessian\"><a href=\"chapter4.md\">\u7b2c4\u7ae0\uff1a\u589e\u91cfHessian\u8ba1\u7b97</a></h4>\n<ul>\n<li>Woodbury\u77e9\u9635\u6052\u7b49\u5f0f\u7684\u9ad8\u7ea7\u5e94\u7528</li>\n<li>Block-wise\u66f4\u65b0\u7b56\u7565</li>\n<li>Sliding window\u6280\u672f</li>\n<li>\u4e0e\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u6df1\u5ea6\u8054\u7cfb</li>\n</ul>\n<h4 id=\"5schur\"><a href=\"chapter5.md\">\u7b2c5\u7ae0\uff1aSchur\u8865\u7684\u5999\u7528</a></h4>\n<ul>\n<li>\u5206\u5757\u77e9\u9635\u6c42\u9006\u7684\u9012\u5f52\u7b56\u7565</li>\n<li>\u5728\u5206\u5e03\u5f0f\u4f18\u5316\u4e2d\u7684\u5e94\u7528</li>\n<li>\u6761\u4ef6\u6570\u6539\u5584\u6280\u672f</li>\n<li>\u4e0e\u57df\u5206\u89e3\u65b9\u6cd5\u7684\u8054\u7cfb</li>\n</ul>\n<h3 id=\"_6\">\u7b2c\u4e09\u90e8\u5206\uff1a\u968f\u673a\u5316\u65b9\u6cd5</h3>\n<h4 id=\"6sketching\"><a href=\"chapter6.md\">\u7b2c6\u7ae0\uff1a\u77e9\u9635Sketching\u6280\u672f</a></h4>\n<ul>\n<li>Johnson-Lindenstrauss\u5f15\u7406\u7684\u5b9e\u7528\u5316</li>\n<li>CountSketch\u4e0e\u968f\u673a\u6295\u5f71</li>\n<li>Frequent Directions\u7b97\u6cd5</li>\n<li>\u5728\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h4 id=\"7\"><a href=\"chapter7.md\">\u7b2c7\u7ae0\uff1a\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570</a></h4>\n<ul>\n<li>\u968f\u673aSVD\u7684\u8bef\u5dee\u5206\u6790</li>\n<li>Nystr\u00f6m\u65b9\u6cd5\u7684\u73b0\u4ee3\u89c6\u89d2</li>\n<li>\u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</li>\n<li>\u91cf\u5b50\u542f\u53d1\u7684\u91c7\u6837\u7b56\u7565</li>\n</ul>\n<h3 id=\"_7\">\u7b2c\u56db\u90e8\u5206\uff1a\u5206\u5e03\u5f0f\u4e0e\u5e76\u884c\u8ba1\u7b97</h3>\n<h4 id=\"8\"><a href=\"chapter8.md\">\u7b2c8\u7ae0\uff1a\u5206\u5e03\u5f0f\u77e9\u9635\u8fd0\u7b97</a></h4>\n<ul>\n<li>\u901a\u4fe1\u9ad8\u6548\u7684\u77e9\u9635\u5206\u89e3</li>\n<li>Gossip\u7b97\u6cd5\u7684\u6536\u655b\u6027\u5206\u6790</li>\n<li>\u5f02\u6b65\u66f4\u65b0\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1</li>\n<li>\u62dc\u5360\u5ead\u9c81\u68d2\u6027\u8bbe\u8ba1</li>\n</ul>\n<h4 id=\"9\"><a href=\"chapter9.md\">\u7b2c9\u7ae0\uff1a\u5f02\u6b65\u4f18\u5316\u7684\u6570\u5b66\u57fa\u7840</a></h4>\n<ul>\n<li>\u5ef6\u8fdf\u68af\u5ea6\u7684\u8bef\u5dee\u7d2f\u79ef\u5206\u6790</li>\n<li>Lock-free\u7b97\u6cd5\u8bbe\u8ba1</li>\n<li>\u5c40\u90e8\u4e00\u81f4\u6027\u4e0e\u5168\u5c40\u6536\u655b</li>\n<li>\u786c\u4ef6\u611f\u77e5\u7684\u7b97\u6cd5\u8c03\u4f18</li>\n</ul>\n<h3 id=\"_8\">\u7b2c\u4e94\u90e8\u5206\uff1a\u6d41\u5f62\u4f18\u5316</h3>\n<h4 id=\"10riemannian\"><a href=\"chapter10.md\">\u7b2c10\u7ae0\uff1aRiemannian\u4f18\u5316\u57fa\u7840</a></h4>\n<ul>\n<li>\u77e9\u9635\u6d41\u5f62\u4e0a\u7684\u51e0\u4f55\u7ed3\u6784</li>\n<li>Riemannian\u68af\u5ea6\u4e0eHessian</li>\n<li>\u56de\u7f29\u4e0e\u5411\u91cf\u4f20\u8f93</li>\n<li>\u5728\u4f4e\u79e9\u77e9\u9635\u8865\u5168\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h4 id=\"11\"><a href=\"chapter11.md\">\u7b2c11\u7ae0\uff1a\u6d41\u5f62\u9884\u6761\u4ef6\u6280\u672f</a></h4>\n<ul>\n<li>\u6d41\u5f62\u4e0a\u7684Natural Gradient</li>\n<li>Riemannian BFGS\u65b9\u6cd5</li>\n<li>\u51e0\u4f55\u611f\u77e5\u7684Trust Region</li>\n<li>\u4e0e\u6b27\u6c0f\u7a7a\u95f4\u65b9\u6cd5\u7684\u6027\u80fd\u5bf9\u6bd4</li>\n</ul>\n<h3 id=\"_9\">\u7b2c\u516d\u90e8\u5206\uff1a\u7279\u6b8a\u7ed3\u6784\u5229\u7528</h3>\n<h4 id=\"12\"><a href=\"chapter12.md\">\u7b2c12\u7ae0\uff1a\u7ed3\u6784\u5316\u77e9\u9635\u7684\u5feb\u901f\u7b97\u6cd5</a></h4>\n<ul>\n<li>Toeplitz\u4e0e\u5faa\u73af\u77e9\u9635\u7684FFT\u6280\u5de7</li>\n<li>Kronecker\u79ef\u7684\u9ad8\u6548\u8fd0\u7b97</li>\n<li>\u5206\u5c42\u77e9\u9635\uff08H-matrices\uff09</li>\n<li>\u5728\u5377\u79ef\u7f51\u7edc\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h4 id=\"13\"><a href=\"chapter13.md\">\u7b2c13\u7ae0\uff1a\u52a8\u6001\u4f4e\u79e9\u8fd1\u4f3c</a></h4>\n<ul>\n<li>\u6d41\u5f0fSVD\u66f4\u65b0</li>\n<li>\u81ea\u9002\u5e94\u79e9\u9009\u62e9</li>\n<li>\u5728\u7ebf\u77e9\u9635\u8865\u5168</li>\n<li>\u4e0e\u795e\u7ecf\u7f51\u7edc\u526a\u679d\u7684\u8054\u7cfb</li>\n</ul>\n<h3 id=\"_10\">\u7b2c\u4e03\u90e8\u5206\uff1a\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u77e9\u9635\u8ba1\u7b97</h3>\n<h4 id=\"14\"><a href=\"chapter14.md\">\u7b2c14\u7ae0\uff1a\u5927\u89c4\u6a21\u534f\u540c\u8fc7\u6ee4\u7684\u77e9\u9635\u6280\u672f</a></h4>\n<ul>\n<li>\u9690\u5f0f\u53cd\u9988\u77e9\u9635\u5206\u89e3\u7684\u52a0\u6743\u7b56\u7565</li>\n<li>ALS-WR\u7b97\u6cd5\u7684\u5e76\u884c\u5316\u4e0e\u6570\u503c\u4f18\u5316</li>\n<li>\u8d1f\u91c7\u6837\u7684\u6570\u5b66\u539f\u7406\u4e0e\u504f\u5dee\u6821\u6b63</li>\n<li>\u7f6e\u4fe1\u5ea6\u52a0\u6743\u7684\u7406\u8bba\u57fa\u7840</li>\n</ul>\n<h4 id=\"15\"><a href=\"chapter15.md\">\u7b2c15\u7ae0\uff1a\u5b9e\u65f6\u63a8\u8350\u7684\u589e\u91cf\u77e9\u9635\u65b9\u6cd5</a></h4>\n<ul>\n<li>\u5728\u7ebf\u77e9\u9635\u5206\u89e3\u7684\u9057\u5fd8\u673a\u5236</li>\n<li>\u7528\u6237/\u7269\u54c1\u5d4c\u5165\u7684\u5feb\u901f\u66f4\u65b0</li>\n<li>\u51b7\u542f\u52a8\u95ee\u9898\u7684\u77e9\u9635\u8865\u5168\u89c6\u89d2</li>\n<li>\u65f6\u5e8f\u52a8\u6001\u7684\u77e9\u9635\u5efa\u6a21</li>\n</ul>\n<h4 id=\"16\"><a href=\"chapter16.md\">\u7b2c16\u7ae0\uff1a\u591a\u6a21\u6001\u63a8\u8350\u7684\u5f20\u91cf\u5206\u89e3</a></h4>\n<ul>\n<li>\u9ad8\u9636\u4ea4\u4e92\u7684\u5f20\u91cf\u5efa\u6a21</li>\n<li>CP\u5206\u89e3\u4e0eTucker\u5206\u89e3\u7684\u53ef\u6269\u5c55\u5b9e\u73b0</li>\n<li>\u7a00\u758f\u5f20\u91cf\u7684\u9ad8\u6548\u5b58\u50a8\u4e0e\u8ba1\u7b97</li>\n<li>\u8de8\u57df\u63a8\u8350\u7684\u8026\u5408\u77e9\u9635\u5206\u89e3</li>\n</ul>\n<h3 id=\"_11\">\u7b2c\u516b\u90e8\u5206\uff1a\u524d\u6cbf\u4e3b\u9898</h3>\n<h4 id=\"17\"><a href=\"chapter17.md\">\u7b2c17\u7ae0\uff1a\u9690\u5f0f\u5fae\u5206\u4e0e\u53cc\u5c42\u4f18\u5316</a></h4>\n<ul>\n<li>\u5927\u89c4\u6a21\u7ebf\u6027\u7cfb\u7edf\u7684\u9690\u5f0f\u6c42\u89e3</li>\n<li>\u81ea\u52a8\u5fae\u5206\u7684\u9ad8\u7ea7\u6280\u5de7</li>\n<li>\u5728\u5143\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u6311\u6218</li>\n</ul>\n<h4 id=\"18\"><a href=\"chapter18.md\">\u7b2c18\u7ae0\uff1a\u91cf\u5b50\u542f\u53d1\u7684\u77e9\u9635\u7b97\u6cd5</a></h4>\n<ul>\n<li>\u5f20\u91cf\u7f51\u7edc\u65b9\u6cd5</li>\n<li>\u91cf\u5b50\u5947\u5f02\u503c\u53d8\u6362</li>\n<li>\u7ecf\u5178\u6a21\u62df\u7684\u8ba1\u7b97\u590d\u6742\u5ea6</li>\n<li>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u6f5c\u529b</li>\n</ul>\n<h2 id=\"_12\">\u9644\u5f55</h2>\n<h3 id=\"a\"><a href=\"chapter19.md\">\u9644\u5f55A\uff1a\u6570\u503c\u7a33\u5b9a\u6027\u901f\u67e5\u8868</a></h3>\n<h3 id=\"b\"><a href=\"chapter20.md\">\u9644\u5f55B\uff1a\u6027\u80fd\u8c03\u4f18\u68c0\u67e5\u6e05\u5355</a></h3>\n<h3 id=\"c\"><a href=\"chapter21.md\">\u9644\u5f55C\uff1a\u5e38\u7528\u77e9\u9635\u6052\u7b49\u5f0f</a></h3>\n<h2 id=\"_13\">\u4f7f\u7528\u8bf4\u660e</h2>\n<ul>\n<li>\u6bcf\u7ae0\u72ec\u7acb\u6210\u6587\uff0c\u53ef\u6309\u9700\u9605\u8bfb</li>\n<li>\u4e60\u9898\u7b54\u6848\u9ed8\u8ba4\u6298\u53e0\uff0c\u9f13\u52b1\u72ec\u7acb\u601d\u8003</li>\n<li>\"Gotchas\"\u90e8\u5206\u603b\u7ed3\u5b9e\u8df5\u4e2d\u7684\u5e38\u89c1\u9677\u9631</li>\n<li>\"\u7814\u7a76\u65b9\u5411\"\u6307\u51fa\u503c\u5f97\u6df1\u5165\u63a2\u7d22\u7684\u5f00\u653e\u95ee\u9898</li>\n</ul>\n<h2 id=\"_14\">\u7b26\u53f7\u7ea6\u5b9a</h2>\n<ul>\n<li>$\\mathbf{A}, \\mathbf{B}$\uff1a\u77e9\u9635</li>\n<li>$\\mathbf{x}, \\mathbf{y}$\uff1a\u5411\u91cf</li>\n<li>$\\lambda_i$\uff1a\u7279\u5f81\u503c</li>\n<li>$\\kappa(\\mathbf{A})$\uff1a\u6761\u4ef6\u6570</li>\n<li>$\\mathcal{O}(\\cdot)$\uff1a\u8ba1\u7b97\u590d\u6742\u5ea6</li>\n<li>$\\mathbb{E}[\\cdot]$\uff1a\u671f\u671b</li>\n<li>$|\\cdot|_F$\uff1aFrobenius\u8303\u6570</li>\n<li>$\\otimes$\uff1aKronecker\u79ef</li>\n<li>$\\odot$\uff1aHadamard\u79ef</li>\n</ul>"
  },
  "../chapter18.md": {
    "hash": "5c9babed6df8cdf927c1828c3ded0f9f",
    "content": "<h1 id=\"18\">\u7b2c18\u7ae0\uff1a\u91cf\u5b50\u542f\u53d1\u7684\u77e9\u9635\u7b97\u6cd5</h1>\n<p>\u91cf\u5b50\u8ba1\u7b97\u7684\u5d1b\u8d77\u4e0d\u4ec5\u5e26\u6765\u4e86\u8ba1\u7b97\u8303\u5f0f\u7684\u9769\u547d\uff0c\u66f4\u4e3a\u7ecf\u5178\u7b97\u6cd5\u8bbe\u8ba1\u63d0\u4f9b\u4e86\u5168\u65b0\u89c6\u89d2\u3002\u672c\u7ae0\u63a2\u8ba8\u5982\u4f55\u5c06\u91cf\u5b50\u8ba1\u7b97\u4e2d\u7684\u5173\u952e\u601d\u60f3\u8f6c\u5316\u4e3a\u5b9e\u7528\u7684\u7ecf\u5178\u77e9\u9635\u7b97\u6cd5\u3002\u6211\u4eec\u5c06\u6df1\u5165\u7814\u7a76\u5f20\u91cf\u7f51\u7edc\u3001\u91cf\u5b50\u5947\u5f02\u503c\u53d8\u6362\u7b49\u6982\u5ff5\uff0c\u5206\u6790\u5176\u5728\u7ecf\u5178\u8ba1\u7b97\u673a\u4e0a\u7684\u9ad8\u6548\u5b9e\u73b0\uff0c\u5e76\u63a2\u7d22\u8fd9\u4e9b\u65b9\u6cd5\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\u6f5c\u529b\u3002\u901a\u8fc7\u5b66\u4e60\u672c\u7ae0\uff0c\u8bfb\u8005\u5c06\u638c\u63e1\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u7684\u6838\u5fc3\u601d\u60f3\uff0c\u7406\u89e3\u5176\u4f18\u52bf\u4e0e\u5c40\u9650\uff0c\u5e76\u80fd\u591f\u5728\u5b9e\u9645\u95ee\u9898\u4e2d\u5e94\u7528\u8fd9\u4e9b\u524d\u6cbf\u6280\u672f\u3002</p>\n<h2 id=\"181\">18.1 \u5f20\u91cf\u7f51\u7edc\u65b9\u6cd5</h2>\n<p>\u5f20\u91cf\u7f51\u7edc\u6e90\u4e8e\u91cf\u5b50\u591a\u4f53\u7269\u7406\uff0c\u4f46\u5176\u6570\u5b66\u7ed3\u6784\u4e3a\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u63d0\u4f9b\u4e86\u5f3a\u5927\u5de5\u5177\u3002\u672c\u8282\u5c06\u4ecb\u7ecd\u4e3b\u8981\u7684\u5f20\u91cf\u7f51\u7edc\u7ed3\u6784\u53ca\u5176\u5728\u77e9\u9635\u7b97\u6cd5\u4e2d\u7684\u5e94\u7528\u3002\u5f20\u91cf\u7f51\u7edc\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u9ad8\u7ef4\u5f20\u91cf\u5206\u89e3\u4e3a\u4f4e\u7ef4\u5f20\u91cf\u7684\u7f51\u7edc\uff0c\u901a\u8fc7\u63a7\u5236\u7f51\u7edc\u7684\u8fde\u63a5\u7ed3\u6784\u6765\u6355\u83b7\u6570\u636e\u7684\u5185\u5728\u5173\u8054\u6a21\u5f0f\u3002\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u4ec5\u80fd\u591f\u5927\u5e45\u964d\u4f4e\u5b58\u50a8\u548c\u8ba1\u7b97\u590d\u6742\u5ea6\uff0c\u8fd8\u63d0\u4f9b\u4e86\u5bf9\u9ad8\u7ef4\u6570\u636e\u7ed3\u6784\u7684\u6df1\u523b\u6d1e\u5bdf\u3002</p>\n<h3 id=\"1811-matrix-product-states-mps\">18.1.1 Matrix Product States (MPS)</h3>\n<p>Matrix Product States\u662f\u6700\u57fa\u7840\u7684\u5f20\u91cf\u7f51\u7edc\u7ed3\u6784\uff0c\u5b83\u5c06\u9ad8\u9636\u5f20\u91cf\u5206\u89e3\u4e3a\u4e00\u7cfb\u5217\u77e9\u9635\u7684\u4e58\u79ef\uff1a</p>\n<p>$$\\mathcal{T}_{i_1,i_2,...,i_n} = \\sum_{\\alpha_1,...,\\alpha_{n-1}} A^{[1]}_{i_1,\\alpha_1} A^{[2]}_{\\alpha_1,i_2,\\alpha_2} \\cdots A^{[n]}_{\\alpha_{n-1},i_n}$$\n\u5176\u4e2d\u6bcf\u4e2a$A^{[k]}$\u662f\u4e00\u4e2a\u4e09\u9636\u5f20\u91cf\uff08\u8fb9\u754c\u5904\u4e3a\u77e9\u9635\uff09\uff0c$\\alpha_k$\u79f0\u4e3abond dimension\u6216virtual dimension\u3002</p>\n<p><strong>\u6df1\u5165\u7406\u89e3MPS</strong>\uff1a</p>\n<p>MPS\u7684\u6570\u5b66\u672c\u8d28\u662f\u5bf9\u5f20\u91cf\u8fdb\u884c\u8fde\u7eed\u7684\u77e9\u9635\u5206\u89e3\u3002\u8003\u8651\u4e00\u4e2a$n$\u9636\u5f20\u91cf$\\mathcal{T} \\in \\mathbb{R}^{d_1 \\times d_2 \\times \\cdots \\times d_n}$\uff0cMPS\u5206\u89e3\u8fc7\u7a0b\u5982\u4e0b\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9012\u5f52SVD\u5206\u89e3</strong>\uff1a\n   - \u5c06\u5f20\u91cf\u91cd\u5851\u4e3a\u77e9\u9635\uff1a$\\mathcal{T}_{(i_1),(i_2...i_n)}$\n   - \u8fdb\u884cSVD\uff1a$\\mathcal{T} = \\mathbf{U}\\mathbf{\\Sigma}\\mathbf{V}^T$\n   - \u622a\u65ad\u4fdd\u7559\u524d$r_1$\u4e2a\u5947\u5f02\u503c\n   - \u8bbe\u7f6e$A^{[1]} = \\mathbf{U}_{:,:r_1}$\uff0c\u7ee7\u7eed\u5904\u7406$\\mathbf{\\Sigma}_{:r_1,:r_1}\\mathbf{V}_{:r_1,:}^T$</p>\n</li>\n<li>\n<p><strong>\u6b63\u4ea4\u6027\u4fdd\u8bc1</strong>\uff1a\n   - \u5de6\u6b63\u4ea4\u5f62\u5f0f\uff1a$\\sum_{i_k} A^{[k]\\dagger}_{i_k} A^{[k]}_{i_k} = \\mathbf{I}$\n   - \u53f3\u6b63\u4ea4\u5f62\u5f0f\uff1a$\\sum_{i_k} A^{[k]} A^{[k]\\dagger}_{i_k} = \\mathbf{I}$\n   - \u6df7\u5408\u6b63\u4ea4\u5f62\u5f0f\uff1a\u5728\u4f18\u5316\u4e2d\u4fdd\u6301\u6570\u503c\u7a33\u5b9a\u6027</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li>\u5b58\u50a8\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(ndr^2)$\uff0c\u5176\u4e2d$d$\u662f\u7269\u7406\u7ef4\u5ea6\uff0c$r$\u662f\u6700\u5927bond dimension</li>\n<li>\u53ef\u4ee5\u7cbe\u786e\u8868\u793a\u4f4e\u7ea0\u7f20\u6001\uff08area law\u7ea0\u7f20\uff09</li>\n<li>\u652f\u6301\u9ad8\u6548\u7684\u5c40\u90e8\u64cd\u4f5c\uff08\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\uff09</li>\n<li>Schmidt\u79e9\u4e0ebond dimension\u7684\u5173\u7cfb\uff1a$r_k = \\text{rank}(\\mathcal{T}_{(i_1...i_k),(i_{k+1}...i_n)})$</li>\n</ul>\n<p><strong>\u7ea0\u7f20\u71b5\u4e0e\u8868\u8fbe\u80fd\u529b</strong>\uff1a</p>\n<p>MPS\u7684\u8868\u8fbe\u80fd\u529b\u7531\u7ea0\u7f20\u71b5\u51b3\u5b9a\u3002\u5bf9\u4e8e\u91cf\u5b50\u6001$|\\psi\\rangle$\uff0c\u5c06\u7cfb\u7edf\u5206\u4e3a\u4e24\u90e8\u5206A\u548cB\uff0c\u7ea0\u7f20\u71b5\u5b9a\u4e49\u4e3a\uff1a\n$$S_A = -\\text{Tr}(\\rho_A \\log \\rho_A)$$\n\u5176\u4e2d$\\rho_A = \\text{Tr}_B(|\\psi\\rangle\\langle\\psi|)$\u3002MPS\u80fd\u591f\u9ad8\u6548\u8868\u793a\u6ee1\u8db3area law\u7684\u6001\uff1a$S_A \\sim \\mathcal{O}(1)$\u3002</p>\n<p><strong>\u5728\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u77e9\u9635\u538b\u7f29</strong>\uff1a\n   - \u5c06$m \\times n$\u77e9\u9635\u5411\u91cf\u5316\u4e3a\u957f\u5ea6$mn$\u7684\u5411\u91cf\n   - \u9009\u62e9\u5408\u9002\u7684\u5f20\u91cf\u5316\u65b9\u5f0f\uff08\u5982\u4e8c\u8fdb\u5236\u7f16\u7801\u7d22\u5f15\uff09\n   - \u5e94\u7528MPS\u538b\u7f29\uff0c\u590d\u6742\u5ea6\u4ece$\\mathcal{O}(mn)$\u964d\u81f3$\\mathcal{O}(r^2\\log(mn))$</p>\n</li>\n<li>\n<p><strong>\u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3</strong>\uff1a\n   - \u53d8\u5206\u539f\u7406\uff1a$\\min_{|\\psi\\rangle \\in \\mathcal{M}_r} |A|\\psi\\rangle - |b\\rangle|^2$\n   - \u5728MPS\u6d41\u5f62$\\mathcal{M}_r$\u4e0a\u8fdb\u884c\u4f18\u5316\n   - \u5229\u7528tangent space\u6295\u5f71\u52a0\u901f\u6536\u655b</p>\n</li>\n<li>\n<p><strong>\u7279\u5f81\u503c\u8ba1\u7b97</strong>\uff1a\n   - DMRG\u7b97\u6cd5\u7684\u6838\u5fc3\u5c31\u662fMPS\u7684\u4f18\u5316\n   - \u76ee\u6807\uff1a$\\min_{|\\psi\\rangle \\in \\mathcal{M}_r} \\langle\\psi|H|\\psi\\rangle / \\langle\\psi|\\psi\\rangle$\n   - \u4fdd\u8bc1\u627e\u5230\u57fa\u6001\uff08\u6700\u5c0f\u7279\u5f81\u503c\uff09</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li><strong>\u81ea\u9002\u5e94bond dimension</strong>\uff1a\u57fa\u4e8e\u622a\u65ad\u8bef\u5dee\u52a8\u6001\u8c03\u6574</li>\n<li><strong>\u5e76\u884c\u5316\u7b56\u7565</strong>\uff1a\u5229\u7528MPS\u7684\u5c40\u90e8\u7ed3\u6784</li>\n<li><strong>\u538b\u7f29\u611f\u77e5\u89c6\u89d2</strong>\uff1aMPS\u4f5c\u4e3a\u7ed3\u6784\u5316\u7a00\u758f\u8868\u793a</li>\n</ul>\n<h3 id=\"1812-tensor-train\">18.1.2 Tensor Train\u5206\u89e3</h3>\n<p>Tensor Train (TT)\u5206\u89e3\u662fMPS\u5728\u9ad8\u9636\u5f20\u91cf\u4e0a\u7684\u63a8\u5e7f\uff0c\u63d0\u4f9b\u4e86\u5904\u7406\u8d85\u9ad8\u7ef4\u6570\u636e\u7684\u7cfb\u7edf\u65b9\u6cd5\u3002TT\u5206\u89e3\u5177\u6709\u5982\u4e0b\u5f62\u5f0f\uff1a\n$$\\mathcal{T}_{i_1,...,i_d} = \\sum_{r_1,...,r_{d-1}} G^{[1]}_{i_1,r_1} G^{[2]}_{r_1,i_2,r_2} \\cdots G^{[d]}_{r_{d-1},i_d}$$\n<strong>TT\u5206\u89e3\u7684\u6570\u5b66\u57fa\u7840</strong>\uff1a</p>\n<p>TT\u5206\u89e3\u57fa\u4e8e\u8fde\u7eed\u7684\u77e9\u9635\u5206\u89e3\uff0c\u5176\u7406\u8bba\u57fa\u7840\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u591a\u7ebf\u6027\u79e9\u7684\u6982\u5ff5</strong>\uff1a\n   - \u5bf9\u4e8e\u5f20\u91cf$\\mathcal{T}$\uff0c\u7b2c$k$\u4e2aunfolding\u77e9\u9635\uff1a$\\mathcal{T}^{(k)} = \\text{reshape}(\\mathcal{T}, [i_1...i_k], [i_{k+1}...i_d])$\n   - TT-\u79e9\u5b9a\u4e49\uff1a$\\mathbf{r} = (r_1, r_2, ..., r_{d-1})$\uff0c\u5176\u4e2d$r_k = \\text{rank}(\\mathcal{T}^{(k)})$\n   - \u5b58\u5728\u6027\u5b9a\u7406\uff1a\u4efb\u4f55\u5f20\u91cf\u90fd\u53ef\u4ee5\u7cbe\u786e\u8868\u793a\u4e3aTT\u683c\u5f0f\uff0c\u79e9\u7531unfolding\u77e9\u9635\u51b3\u5b9a</p>\n</li>\n<li>\n<p><strong>\u4e0e\u5176\u4ed6\u5206\u89e3\u7684\u5173\u7cfb</strong>\uff1a\n   - Tucker\u5206\u89e3\uff1aTT\u662f\u7279\u6b8a\u7684Tucker\u5206\u89e3\uff0c\u6838\u5f20\u91cf\u4e3a\u5bf9\u89d2\u7ebf\u7ed3\u6784\n   - CP\u5206\u89e3\uff1a\u79e9-$R$ CP\u5206\u89e3\u53ef\u8f6c\u6362\u4e3aTT\u683c\u5f0f\uff0c\u4f46TT-\u79e9\u53ef\u80fd\u66f4\u5927\n   - Hierarchical Tucker\uff1aTT\u662f\u4e8c\u53c9\u6811\u7ed3\u6784\u7684\u7279\u4f8b</p>\n</li>\n</ol>\n<p><strong>TT\u5206\u89e3\u7684\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u907f\u514d\u7ef4\u5ea6\u707e\u96be\uff1a\u5b58\u50a8\u4ece$\\mathcal{O}(n^d)$\u964d\u81f3$\\mathcal{O}(dnr^2)$</li>\n<li>\u4fdd\u6301\u591a\u7ebf\u6027\u7ed3\u6784\uff1a\u7ebf\u6027\u64cd\u4f5c\u5728TT\u683c\u5f0f\u4e0b\u5c01\u95ed</li>\n<li>\u652f\u6301\u9ad8\u6548\u7684\u57fa\u672c\u8fd0\u7b97\uff1a</li>\n<li>\u52a0\u6cd5\uff1a$\\mathcal{O}(dnr^2)$\uff0c\u79e9\u6700\u591a\u7ffb\u500d</li>\n<li>Hadamard\u79ef\uff1a$\\mathcal{O}(dnr^3)$\uff0c\u79e9\u6700\u591a\u5e73\u65b9</li>\n<li>\u5185\u79ef\uff1a$\\mathcal{O}(dnr^3)$\uff0c\u65e0\u9700\u5c55\u5f00\u5b8c\u6574\u5f20\u91cf</li>\n<li>\u7a33\u5b9a\u7684\u6570\u503c\u6027\u8d28\uff1a\u901a\u8fc7\u6b63\u4ea4\u5316\u63a7\u5236\u6761\u4ef6\u6570</li>\n</ul>\n<p><strong>TT-SVD\u7b97\u6cd5\u8be6\u89e3</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">\u8f93\u5165</span><span class=\"err\">\uff1a</span><span class=\"n\">\u5f20\u91cf</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"err\">\u2208</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">^</span><span class=\"err\">{</span><span class=\"n\">n\u2081</span><span class=\"err\">\u00d7</span><span class=\"p\">...</span><span class=\"err\">\u00d7</span><span class=\"n\">n_d</span><span class=\"err\">}</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">\u7cbe\u5ea6</span><span class=\"w\"> </span><span class=\"n\">\u03b5</span>\n<span class=\"n\">\u8f93\u51fa</span><span class=\"err\">\uff1a</span><span class=\"n\">TT</span><span class=\"o\">-</span><span class=\"n\">cores</span><span class=\"w\"> </span><span class=\"err\">{</span><span class=\"n\">G</span><span class=\"o\">^[</span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"err\">}</span><span class=\"w\"> </span><span class=\"n\">\u6ee1\u8db3</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">T_TT</span><span class=\"o\">||</span><span class=\"w\"> </span><span class=\"err\">\u2264</span><span class=\"w\"> </span><span class=\"n\">\u03b5</span><span class=\"o\">||</span><span class=\"n\">T</span><span class=\"o\">||</span>\n\n<span class=\"mf\">1.</span><span class=\"w\"> </span><span class=\"n\">\u521d\u59cb\u5316</span><span class=\"err\">\uff1a</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">\u03b4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">\u03b5</span><span class=\"o\">/</span><span class=\"err\">\u221a</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"n\">T</span><span class=\"o\">||</span><span class=\"n\">_F</span>\n<span class=\"mf\">2.</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"err\">:</span>\n<span class=\"w\">   </span><span class=\"mf\">3.</span><span class=\"w\"> </span><span class=\"n\">\u91cd\u5851</span><span class=\"err\">\uff1a</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">r_{k-1}*n_k, n_{k+1}*...*n_d</span><span class=\"o\">]</span><span class=\"p\">)</span>\n<span class=\"w\">   </span><span class=\"mf\">4.</span><span class=\"w\"> </span><span class=\"n\">\u8ba1\u7b97SVD</span><span class=\"err\">\uff1a</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">U\u03a3V</span><span class=\"o\">^</span><span class=\"n\">T</span>\n<span class=\"w\">   </span><span class=\"mf\">5.</span><span class=\"w\"> </span><span class=\"n\">\u786e\u5b9a\u79e9</span><span class=\"err\">\uff1a</span><span class=\"n\">r_k</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">min</span><span class=\"err\">{</span><span class=\"nl\">r</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"n\">\u03a3_</span><span class=\"err\">{</span><span class=\"n\">r</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"err\">:</span><span class=\"k\">end</span><span class=\"err\">}</span><span class=\"o\">||</span><span class=\"n\">_F</span><span class=\"w\"> </span><span class=\"err\">\u2264</span><span class=\"w\"> </span><span class=\"n\">\u03b4</span><span class=\"err\">}</span>\n<span class=\"w\">   </span><span class=\"mf\">6.</span><span class=\"w\"> </span><span class=\"n\">\u622a\u65ad</span><span class=\"err\">\uff1a</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">[</span><span class=\"n\">:, 1:r_k</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">\u03a3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">\u03a3</span><span class=\"o\">[</span><span class=\"n\">1:r_k, 1:r_k</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">[</span><span class=\"n\">:, 1:r_k</span><span class=\"o\">]</span>\n<span class=\"w\">   </span><span class=\"mf\">7.</span><span class=\"w\"> </span><span class=\"n\">\u8bbe\u7f6ecore</span><span class=\"err\">\uff1a</span><span class=\"n\">G</span><span class=\"o\">^[</span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">U</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">r_{k-1}, n_k, r_k</span><span class=\"o\">]</span><span class=\"p\">)</span>\n<span class=\"w\">   </span><span class=\"mf\">8.</span><span class=\"w\"> </span><span class=\"n\">\u66f4\u65b0</span><span class=\"err\">\uff1a</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">\u03a3</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">^</span><span class=\"n\">T</span>\n<span class=\"mf\">9.</span><span class=\"w\"> </span><span class=\"n\">\u6700\u540ecore</span><span class=\"err\">\uff1a</span><span class=\"n\">G</span><span class=\"o\">^[</span><span class=\"n\">d</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">r_{d-1}, n_d, 1</span><span class=\"o\">]</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>\u8bef\u5dee\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u5c40\u90e8\u622a\u65ad\u8bef\u5dee\uff1a\u6bcf\u6b65\u6700\u591a$\\delta$</li>\n<li>\u5168\u5c40\u8bef\u5dee\u754c\uff1a$|\\mathcal{T} - \\mathcal{T}_{TT}|_F \\leq \\sqrt{d-1}\\epsilon|\\mathcal{T}|_F$</li>\n<li>\u76f8\u5bf9\u8bef\u5dee\u63a7\u5236\uff1a\u901a\u8fc7\u5f52\u4e00\u5316\u4fdd\u8bc1\u76f8\u5bf9\u7cbe\u5ea6</li>\n<li>\u6700\u4f18\u6027\uff1a\u5728\u56fa\u5b9a\u79e9\u7ea6\u675f\u4e0b\uff0cTT-SVD\u7ed9\u51fa\u62df\u6700\u4f18\u89e3</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u53d8\u4f53</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>TT-cross\u8fd1\u4f3c</strong>\uff1a\n   - \u57fa\u4e8e\u9aa8\u67b6\u5206\u89e3\uff0c\u907f\u514d\u6784\u9020\u5b8c\u6574\u5f20\u91cf\n   - \u590d\u6742\u5ea6\uff1a$\\mathcal{O}(dnr^3)$\uff0c\u9002\u5408\u9690\u5f0f\u5b9a\u4e49\u7684\u5f20\u91cf\n   - \u81ea\u9002\u5e94\u79e9\u786e\u5b9a</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u5316TT\u5206\u89e3</strong>\uff1a\n   - \u5229\u7528\u968f\u673a\u6295\u5f71\u52a0\u901f\u5927\u89c4\u6a21\u95ee\u9898\n   - \u6982\u7387\u8bef\u5dee\u754c\uff1a$P(\\text{error} &gt; (1+\\epsilon)\\sigma_{r+1}) &lt; \\delta$\n   - \u9002\u5408\u4f4e\u7cbe\u5ea6\u5feb\u901f\u8fd1\u4f3c</p>\n</li>\n<li>\n<p><strong>\u6d41\u5f0fTT\u5206\u89e3</strong>\uff1a\n   - \u5904\u7406\u8d85\u5927\u89c4\u6a21\u6570\u636e\uff0c\u4e00\u6b21\u8bfb\u53d6\n   - \u589e\u91cf\u66f4\u65b0TT-cores\n   - \u5185\u5b58\u9700\u6c42\uff1a$\\mathcal{O}(dnr^2)$\u800c\u975e$\\mathcal{O}(n^d)$</p>\n</li>\n</ol>\n<h3 id=\"1813-dmrg\">18.1.3 DMRG\u7b97\u6cd5\u7684\u77e9\u9635\u89c6\u89d2</h3>\n<p>Density Matrix Renormalization Group (DMRG)\u6700\u521d\u7528\u4e8e\u91cf\u5b50\u7cfb\u7edf\uff0c\u4f46\u5176\u672c\u8d28\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u77e9\u9635\u7279\u5f81\u503c\u6c42\u89e3\u5668\u3002DMRG\u7684\u6210\u529f\u5728\u4e8e\u5b83\u5de7\u5999\u5730\u7ed3\u5408\u4e86\u53d8\u5206\u539f\u7406\u3001\u5c40\u90e8\u4f18\u5316\u548c\u81ea\u9002\u5e94\u903c\u8fd1\uff0c\u4e3a\u5927\u89c4\u6a21\u7a00\u758f\u77e9\u9635\u7684\u7279\u5f81\u503c\u95ee\u9898\u63d0\u4f9b\u4e86\u9769\u547d\u6027\u7684\u89e3\u51b3\u65b9\u6848\u3002</p>\n<p><strong>DMRG\u7684\u7406\u8bba\u57fa\u7840</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u53d8\u5206\u539f\u7406</strong>\uff1a\n   \u5bf9\u4e8eHermitian\u77e9\u9635$\\mathbf{H}$\uff0c\u57fa\u6001\u80fd\u91cf\u548c\u57fa\u6001\u6ee1\u8db3\uff1a\n$$E_0 = \\min_{|\\psi\\rangle} \\frac{\\langle\\psi|\\mathbf{H}|\\psi\\rangle}{\\langle\\psi|\\psi\\rangle} = \\min_{|\\psi\\rangle \\in \\mathcal{M}_r} \\langle\\psi|\\mathbf{H}|\\psi\\rangle$$\n\u5176\u4e2d$\\mathcal{M}_r$\u662fbond dimension\u4e3a$r$\u7684MPS\u6d41\u5f62\u3002</p>\n</li>\n<li>\n<p><strong>\u5c40\u90e8\u4f18\u5316\u7684\u5168\u5c40\u6536\u655b\u6027</strong>\uff1a\n   - DMRG\u901a\u8fc7\u4ea4\u66ff\u6700\u5c0f\u5316\u5b9e\u73b0\u5168\u5c40\u4f18\u5316\n   - \u6bcf\u4e2a\u5c40\u90e8\u95ee\u9898\u662f\u6807\u51c6\u7279\u5f81\u503c\u95ee\u9898\n   - \u80fd\u91cf\u5355\u8c03\u4e0b\u964d\u4fdd\u8bc1\u6536\u655b</p>\n</li>\n<li>\n<p><strong>\u5bc6\u5ea6\u77e9\u9635\u7684\u7269\u7406\u610f\u4e49</strong>\uff1a\n   - \u7ea6\u5316\u5bc6\u5ea6\u77e9\u9635\uff1a$\\rho_A = \\text{Tr}_B(|\\psi\\rangle\\langle\\psi|)$\n   - \u6700\u4f18\u622a\u65ad\uff1a\u4fdd\u7559$\\rho_A$\u7684\u6700\u5927\u7279\u5f81\u503c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\n   - \u622a\u65ad\u8bef\u5dee\u4e0e\u4e22\u5f03\u7684\u7279\u5f81\u503c\u76f4\u63a5\u76f8\u5173</p>\n</li>\n</ol>\n<p><strong>DMRG\u7684\u6838\u5fc3\u601d\u60f3</strong>\uff1a</p>\n<ol>\n<li>\u5c06\u5927\u89c4\u6a21\u7279\u5f81\u503c\u95ee\u9898\u6295\u5f71\u5230MPS\u6d41\u5f62</li>\n<li>\u901a\u8fc7\u5c40\u90e8\u4f18\u5316\uff08sweeping\uff09\u66f4\u65b0MPS\u53c2\u6570</li>\n<li>\u81ea\u9002\u5e94\u8c03\u6574bond dimension</li>\n<li>\u5229\u7528\u91cf\u5b50\u7ea0\u7f20\u7684\u5c40\u57df\u6027</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u7b97\u6cd5\u6846\u67b6</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">\u8f93\u5165</span><span class=\"err\">\uff1a</span><span class=\"n\">Hamiltonian</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">\u521d\u59cbMPS</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">\u03c8</span><span class=\"err\">\u27e9</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">\u76ee\u6807\u7cbe\u5ea6</span><span class=\"w\"> </span><span class=\"n\">\u03b5</span>\n<span class=\"n\">\u8f93\u51fa</span><span class=\"err\">\uff1a</span><span class=\"n\">\u57fa\u6001\u80fd\u91cf</span><span class=\"w\"> </span><span class=\"n\">E\u2080</span><span class=\"w\"> </span><span class=\"n\">\u548c\u57fa\u6001</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">\u03c8\u2080</span><span class=\"err\">\u27e9</span>\n\n<span class=\"mf\">1.</span><span class=\"w\"> </span><span class=\"n\">\u521d\u59cb\u5316</span><span class=\"err\">\uff1a</span>\n<span class=\"w\">   </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">\u968f\u673a\u751f\u6210MPS\u6216\u4f7f\u7528\u7269\u7406\u76f4\u89c9\u521d\u59cb\u5316</span>\n<span class=\"w\">   </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">\u5c06MPS\u6b63\u4ea4\u5316\u5230\u6df7\u5408\u6807\u51c6\u5f62\u5f0f</span>\n\n<span class=\"mf\">2.</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">sweep</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"nl\">max_sweeps</span><span class=\"p\">:</span>\n<span class=\"w\">   </span><span class=\"mf\">3.</span><span class=\"w\"> </span><span class=\"n\">\u80fd\u91cf\u53d8\u5316</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">   </span><span class=\"mf\">4.</span><span class=\"w\"> </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u6b63\u5411\u626b\u63cf</span>\n<span class=\"w\">   </span><span class=\"mf\">5.</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"err\">:</span>\n<span class=\"w\">      </span><span class=\"mf\">6.</span><span class=\"w\"> </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u4e24\u4f4d\u70b9\u4f18\u5316</span>\n<span class=\"w\">      </span><span class=\"mf\">7.</span><span class=\"w\"> </span><span class=\"n\">\u6784\u9020\u6709\u6548Hamiltonian</span><span class=\"w\"> </span><span class=\"n\">H_eff\u4f5c\u7528\u5728sites</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mf\">8.</span><span class=\"w\"> </span><span class=\"n\">\u6c42\u89e3\u7279\u5f81\u503c\u95ee\u9898</span><span class=\"err\">\uff1a</span><span class=\"n\">H_eff</span><span class=\"o\">|</span><span class=\"n\">\u03b8</span><span class=\"err\">\u27e9</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">|</span><span class=\"n\">\u03b8</span><span class=\"err\">\u27e9</span>\n<span class=\"w\">      </span><span class=\"mf\">9.</span><span class=\"w\"> </span><span class=\"n\">\u5c06</span><span class=\"o\">|</span><span class=\"n\">\u03b8</span><span class=\"err\">\u27e9</span><span class=\"n\">\u8fdb\u884cSVD</span><span class=\"err\">\uff1a</span><span class=\"o\">|</span><span class=\"n\">\u03b8</span><span class=\"err\">\u27e9</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">\u03a3\u1d63</span><span class=\"w\"> </span><span class=\"n\">U\u1d63\u03c3\u1d63</span><span class=\"o\">|</span><span class=\"n\">V\u1d63</span><span class=\"err\">\u27e9</span>\n<span class=\"w\">      </span><span class=\"mf\">10.</span><span class=\"w\"> </span><span class=\"n\">\u622a\u65ad\u4fdd\u7559\u524dr\u4e2a\u5947\u5f02\u503c</span>\n<span class=\"w\">      </span><span class=\"mf\">11.</span><span class=\"w\"> </span><span class=\"n\">\u66f4\u65b0MPS\u5f20\u91cf</span><span class=\"err\">\uff1a</span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">i+1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">\u03c3V</span>\n<span class=\"w\">      </span><span class=\"mf\">12.</span><span class=\"w\"> </span><span class=\"n\">\u53f3\u6b63\u4ea4\u5316A</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"mf\">13.</span><span class=\"w\"> </span><span class=\"n\">\u80fd\u91cf\u53d8\u5316</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">E_new</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">E_old</span><span class=\"o\">|</span>\n\n<span class=\"w\">   </span><span class=\"mf\">14.</span><span class=\"w\"> </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u53cd\u5411\u626b\u63cf</span>\n<span class=\"w\">   </span><span class=\"mf\">15.</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"err\">:</span>\n<span class=\"w\">      </span><span class=\"mf\">16.</span><span class=\"w\"> </span><span class=\"n\">\u7c7b\u4f3c\u6b63\u5411\u626b\u63cf</span><span class=\"err\">\uff0c</span><span class=\"n\">\u4f46\u5de6\u6b63\u4ea4\u5316</span>\n\n<span class=\"w\">   </span><span class=\"mf\">17.</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">\u80fd\u91cf\u53d8\u5316</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nl\">\u03b5</span><span class=\"p\">:</span>\n<span class=\"w\">      </span><span class=\"mf\">18.</span><span class=\"w\"> </span><span class=\"k\">break</span>\n\n<span class=\"mf\">19.</span><span class=\"w\"> </span><span class=\"n\">\u8fd4\u56de</span><span class=\"w\"> </span><span class=\"n\">E\u2080</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">\u27e8</span><span class=\"n\">\u03c8</span><span class=\"o\">|</span><span class=\"n\">H</span><span class=\"o\">|</span><span class=\"n\">\u03c8</span><span class=\"err\">\u27e9</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">\u03c8\u2080</span><span class=\"err\">\u27e9</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">\u03c8</span><span class=\"err\">\u27e9</span>\n</code></pre></div>\n\n<p><strong>\u6709\u6548Hamiltonian\u7684\u6784\u9020</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u4e24\u4f4d\u70b9\u4f18\u5316\uff0c\u6709\u6548Hamiltonian\u662f$d\u00b2 \u00d7 d\u00b2$\u77e9\u9635\uff1a\n$$H_{\\text{eff}} = \\sum_{i,j,k,l} L^{\u03b1}_{i} \\cdot W^{\u03b1\u03b2}_{ij,kl} \\cdot R^{\u03b2}_{l}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$L^\u03b1$\uff1a\u5de6\u73af\u5883\u5f20\u91cf\uff0c\u7f16\u7801sites 1\u5230i-1\u7684\u4fe1\u606f</li>\n<li>$W^{\u03b1\u03b2}$\uff1aMPO\u8868\u793a\u7684Hamiltonian</li>\n<li>$R^\u03b2$\uff1a\u53f3\u73af\u5883\u5f20\u91cf\uff0c\u7f16\u7801sites i+2\u5230n\u7684\u4fe1\u606f</li>\n</ul>\n<p><strong>\u6570\u503c\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Mixed canonical form</strong>\uff1a\n   - \u4fdd\u6301\u5f53\u524d\u4f18\u5316\u4f4d\u70b9\u7684\u6b63\u4ea4\u4e2d\u5fc3\n   - \u6570\u503c\u7a33\u5b9a\u6027\uff1a\u907f\u514d\u6307\u6570\u589e\u957f/\u8870\u51cf\n   - \u9ad8\u6548\u66f4\u65b0\uff1a\u53ea\u9700\u5c40\u90e8\u6b63\u4ea4\u5316</p>\n</li>\n<li>\n<p><strong>Two-site vs one-site\u4f18\u5316</strong>\uff1a\n   - Two-site\uff1a\u53ef\u4ee5\u52a8\u6001\u8c03\u6574bond dimension\uff0c\u4f46\u8ba1\u7b97\u91cf\u5927\n   - One-site\uff1a\u8ba1\u7b97\u9ad8\u6548\uff0c\u4f46\u9700\u8981\u9884\u5148\u56fa\u5b9abond dimension\n   - \u6df7\u5408\u7b56\u7565\uff1a\u5148\u7528two-site\u627e\u5230\u5408\u9002\u7684bond dimension\uff0c\u518d\u7528one-site\u7ec6\u5316</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001bond dimension\u8c03\u6574</strong>\uff1a\n   - \u57fa\u4e8e\u5947\u5f02\u503c\u8c31\uff1a$r_{\\text{new}} = {k : \\sigma_k &gt; \\epsilon_{\\text{SVD}}}$\n   - \u57fa\u4e8e\u7ea0\u7f20\u71b5\uff1a$S = -\\sum_i \\sigma_i^2 \\log \\sigma_i^2$\n   - \u81ea\u9002\u5e94\u7b56\u7565\uff1a\u5728\u9ad8\u7ea0\u7f20\u533a\u57df\u589e\u52a0bond dimension</p>\n</li>\n<li>\n<p><strong>\u6536\u655b\u52a0\u901f\u6280\u672f</strong>\uff1a\n   - Mixer\u9879\uff1a\u6dfb\u52a0\u5c0f\u7684\u968f\u673a\u6270\u52a8\u907f\u514d\u5c40\u90e8\u6781\u5c0f\n   - \u5b50\u7a7a\u95f4\u5c55\u5f00\uff1a\u4f7f\u7528\u591a\u4e2aMPS\u6784\u9020\u66f4\u5927\u7684\u53d8\u5206\u7a7a\u95f4\n   - \u52a8\u91cf\u65b9\u6cd5\uff1a\u501f\u9274\u4f18\u5316\u7406\u8bba\u7684\u52a0\u901f\u6280\u672f</p>\n</li>\n</ol>\n<p><strong>\u4e0eKrylov\u65b9\u6cd5\u7684\u6bd4\u8f83</strong>\uff1a</p>\n<p>| \u65b9\u9762 | DMRG | Lanczos/Arnoldi |</p>\n<table>\n<thead>\n<tr>\n<th>\u65b9\u9762</th>\n<th>DMRG</th>\n<th>Lanczos/Arnoldi</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u5185\u5b58\u9700\u6c42</td>\n<td>$\\mathcal{O}(nr^2d\u00b2)$</td>\n<td>$\\mathcal{O}(nk)$</td>\n</tr>\n<tr>\n<td>\u9002\u7528\u89c4\u6a21</td>\n<td>\u6781\u5927\uff08$n \\sim 10^{100}$\uff09</td>\n<td>\u4e2d\u7b49\uff08$n \\sim 10^9$\uff09</td>\n</tr>\n<tr>\n<td>\u6536\u655b\u901f\u5ea6</td>\n<td>\u4f9d\u8d56\u4e8e\u7ea0\u7f20\u7ed3\u6784</td>\n<td>\u4f9d\u8d56\u4e8e\u8c31\u95f4\u9699</td>\n</tr>\n<tr>\n<td>\u7cbe\u5ea6\u63a7\u5236</td>\n<td>\u901a\u8fc7bond dimension</td>\n<td>\u901a\u8fc7\u8fed\u4ee3\u6b21\u6570</td>\n</tr>\n<tr>\n<td>\u5e76\u884c\u6027</td>\n<td>\u4e2d\u7b49</td>\n<td>\u9ad8</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u9ad8\u7ea7\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li><strong>\u6fc0\u53d1\u6001\u8ba1\u7b97</strong>\uff1a\u901a\u8fc7\u6b63\u4ea4\u7ea6\u675f\u6216targeting</li>\n<li><strong>\u65f6\u95f4\u6f14\u5316</strong>\uff1aTEBD (Time-Evolving Block Decimation)</li>\n<li><strong>\u6709\u9650\u6e29\u5ea6</strong>\uff1apurification\u6216METTS\u65b9\u6cd5</li>\n<li><strong>\u5f00\u653e\u7cfb\u7edf</strong>\uff1avectorization\u6280\u672f</li>\n</ol>\n<h3 id=\"1814\">18.1.4 \u5728\u5927\u89c4\u6a21\u77e9\u9635\u538b\u7f29\u4e2d\u7684\u5e94\u7528</h3>\n<p>\u5f20\u91cf\u7f51\u7edc\u4e3a\u77e9\u9635\u538b\u7f29\u63d0\u4f9b\u4e86\u65b0\u8303\u5f0f\uff0c\u7279\u522b\u9002\u5408\u5177\u6709\u7279\u5b9a\u7ed3\u6784\u7684\u77e9\u9635\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u6838\u5fc3\u5728\u4e8e\u8bc6\u522b\u548c\u5229\u7528\u77e9\u9635\u4e2d\u7684\u9690\u542b\u4f4e\u7ef4\u7ed3\u6784\uff0c\u901a\u8fc7\u5f20\u91cf\u5206\u89e3\u6280\u672f\u5b9e\u73b0\u6307\u6570\u7ea7\u7684\u538b\u7f29\u7387\u3002</p>\n<p><strong>TT-\u77e9\u9635\u683c\u5f0f</strong>\uff1a</p>\n<p>\u5bf9\u4e8e$2^d \\times 2^d$\u77e9\u9635$\\mathbf{A}$\uff0c\u5c06\u884c\u5217\u7d22\u5f15\u8fdb\u884c\u4e8c\u8fdb\u5236\u7f16\u7801\uff1a</p>\n<ul>\n<li>\u884c\u7d22\u5f15\uff1a$i = i_1i_2...i_d$ (\u4e8c\u8fdb\u5236\u8868\u793a)</li>\n<li>\u5217\u7d22\u5f15\uff1a$j = j_1j_2...j_d$ (\u4e8c\u8fdb\u5236\u8868\u793a)</li>\n<li>\u77e9\u9635\u5143\u7d20\uff1a$A_{ij} = \\mathcal{T}_{i_1j_1,i_2j_2,...,i_dj_d}$</li>\n</ul>\n<p>\u5e94\u7528TT\u5206\u89e3\u540e\uff1a\n$$A_{ij} = \\sum_{\u03b1_1,...,\u03b1_{d-1}} G^{[1]}_{(i_1j_1),\u03b1_1} G^{[2]}_{\u03b1_1,(i_2j_2),\u03b1_2} \\cdots G^{[d]}_{\u03b1_{d-1},(i_dj_d)}$$\n<strong>\u91cf\u5316\u538b\u7f29\u6548\u679c</strong>\uff1a</p>\n<ul>\n<li>\u539f\u59cb\u5b58\u50a8\uff1a$\\mathcal{O}(4^d) = \\mathcal{O}(n^2)$</li>\n<li>TT\u5b58\u50a8\uff1a$\\mathcal{O}(4dr^2) = \\mathcal{O}(r^2\\log n)$</li>\n<li>\u538b\u7f29\u7387\uff1a$\\frac{n^2}{r^2\\log n}$\uff0c\u5f53$r \\ll n^{1/\\log n}$\u65f6\u663e\u8457</li>\n</ul>\n<p><strong>\u5feb\u901f\u8fd0\u7b97\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5</strong>\uff1a\n   ```\n   \u8f93\u5165\uff1aTT-matrix A, vector x\n   \u8f93\u51fa\uff1ay = Ax</p>\n</li>\n<li>\n<p>\u5c06x\u8868\u793a\u4e3aTT-vector\uff08\u901a\u8fc7\u4e8c\u8fdb\u5236\u7f16\u7801\uff09</p>\n</li>\n<li>for k = d to 1:<ol start=\"3\">\n<li>\u6536\u7f29G^[k]_A\u4e0eG^[k]_x</li>\n<li>\u66f4\u65b0\u4e2d\u95f4\u7ed3\u679c</li>\n</ol>\n</li>\n<li>\u8fd4\u56de\u6700\u7ec8\u6536\u7f29\u7ed3\u679c</li>\n</ol>\n<p>\u590d\u6742\u5ea6\uff1aO(d\u00b7r\u00b2\u00b74) = O(r\u00b2log n)\n   ```</p>\n<ol start=\"2\">\n<li>\n<p><strong>\u77e9\u9635\u52a0\u6cd5\u548cHadamard\u79ef</strong>\uff1a\n   - \u76f4\u63a5\u5728TT-cores\u4e0a\u64cd\u4f5c\n   - \u79e9\u7684\u589e\u957f\u89c4\u5f8b\uff1a\u52a0\u6cd5\u6700\u591a\u7ffb\u500d\uff0cHadamard\u79ef\u6700\u591a\u5e73\u65b9\n   - \u901a\u8fc7\u91cd\u538b\u7f29\u63a7\u5236\u79e9\u589e\u957f</p>\n</li>\n<li>\n<p><strong>\u77e9\u9635\u9006\u7684\u8fd1\u4f3c</strong>\uff1a\n   - \u5229\u7528Neumann\u7ea7\u6570\uff1a$\\mathbf{A}^{-1} = \\sum_{k=0}^\u221e (\\mathbf{I} - \\mathbf{A})^k$\n   - \u6216\u4f7f\u7528\u4f18\u5316\u65b9\u6cd5\uff1a$\\min_{\\mathbf{X}} |\\mathbf{AX} - \\mathbf{I}|_F^2$\n   - \u5728TT\u6d41\u5f62\u4e0a\u6c42\u89e3</p>\n</li>\n</ol>\n<p><strong>\u7ed3\u6784\u5316\u77e9\u9635\u7684TT\u8868\u793a</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Toeplitz\u77e9\u9635</strong>\uff1a\n   - \u5229\u7528\u5faa\u73af\u7ed3\u6784\uff0cTT-\u79e9\u901a\u5e38\u5f88\u5c0f\n   - \u4f8b\uff1a\u4e09\u5bf9\u89d2Toeplitz\u77e9\u9635\u7684TT-\u79e9\u4e3a2\n   - \u5e94\u7528\uff1a\u4fe1\u53f7\u5904\u7406\u3001\u65f6\u95f4\u5e8f\u5217\u5206\u6790</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u77e9\u9635(Hierarchical matrices)</strong>\uff1a\n   - \u9012\u5f52\u4f4e\u79e9\u5757\u7ed3\u6784\u81ea\u7136\u5bf9\u5e94TT\u5206\u89e3\n   - \u9002\u7528\u4e8e\uff1a\u8fb9\u754c\u5143\u65b9\u6cd5\u3001N-body\u95ee\u9898\n   - \u4e0eFMM\uff08\u5feb\u901f\u591a\u6781\u65b9\u6cd5\uff09\u7684\u8054\u7cfb</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u77e9\u9635\u7684TT\u8fd1\u4f3c</strong>\uff1a\n   - \u5229\u7528\u56fe\u7684\u9012\u5f52\u4e8c\u5206\n   - \u4fdd\u6301\u7a00\u758f\u6a21\u5f0f\u7684\u540c\u65f6\u964d\u4f4e\u5b58\u50a8\n   - \u5e94\u7528\uff1a\u5927\u89c4\u6a21\u7ebf\u6027\u7cfb\u7edf\u9884\u6761\u4ef6\u5b50</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u6848\u4f8b\u6df1\u5ea6\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u534f\u65b9\u5dee\u77e9\u9635\u538b\u7f29</strong>\uff1a\n   - \u80cc\u666f\uff1a\u91d1\u878d\u98ce\u9669\u5206\u6790\u3001\u6c14\u5019\u6a21\u578b\n   - \u6311\u6218\uff1a\u7ef4\u5ea6\u9ad8\u8fbe$10^6$\uff0c\u9700\u8981\u4fdd\u6301\u6b63\u5b9a\u6027\n   - TT\u89e3\u51b3\u65b9\u6848\uff1a</p>\n<ul>\n<li>\u5229\u7528\u53d8\u91cf\u95f4\u7684\u5c42\u6b21\u76f8\u5173\u6027</li>\n<li>Cholesky\u5206\u89e3\u7684TT\u8868\u793a</li>\n<li>\u5728\u7ebf\u66f4\u65b0\u7b97\u6cd5</li>\n<li>\u6548\u679c\uff1a\u5b58\u50a8\u964d\u4f4e1000\u500d\uff0c\u8ba1\u7b97\u52a0\u901f100\u500d</li>\n</ul>\n</li>\n<li>\n<p><strong>\u6838\u77e9\u9635\u8fd1\u4f3c</strong>\uff1a\n   - RBF\u6838\uff1a$K_{ij} = \\exp(-|x_i - x_j|^2/2\u03c3^2)$\n   - TT-cross\u7b97\u6cd5\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u9009\u62e9\u5173\u952e\u5143\u7d20</li>\n<li>\u907f\u514d\u8ba1\u7b97\u5168\u90e8$n^2$\u4e2a\u5143\u7d20</li>\n<li>\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(nr^3\\log n)$</li>\n<li>\u5e94\u7528\uff1a\u5927\u89c4\u6a21\u9ad8\u65af\u8fc7\u7a0b\u3001\u652f\u6301\u5411\u91cf\u673a</li>\n</ul>\n</li>\n<li>\n<p><strong>\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635</strong>\uff1a\n   - \u5229\u7528\u56fe\u7684\u591a\u5c3a\u5ea6\u7ed3\u6784\n   - \u8c31\u805a\u7c7b\u7684\u52a0\u901f\n   - \u4e0e\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u7ed3\u5408</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u538b\u7f29\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>QTT (Quantized TT)\u683c\u5f0f</strong>\uff1a\n   - \u5bf9\u6bcf\u4e2a\u7ef4\u5ea6\u518d\u6b21\u4e8c\u8fdb\u5236\u7f16\u7801\n   - \u5b58\u50a8\u8fdb\u4e00\u6b65\u964d\u81f3$\\mathcal{O}(r^2\\log\\log n)$\n   - \u9002\u7528\u4e8e\u9ad8\u5ea6\u7ed3\u6784\u5316\u95ee\u9898</p>\n</li>\n<li>\n<p><strong>\u5757TT\u683c\u5f0f</strong>\uff1a\n   - \u5904\u7406\u5757\u7ed3\u6784\u77e9\u9635\n   - \u4fdd\u6301\u5757\u5185\u76f8\u5173\u6027\n   - \u5e94\u7528\uff1a\u591a\u7269\u7406\u573a\u8026\u5408\u95ee\u9898</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u4ea4\u53c9\u8fd1\u4f3c(ACA)\u4e0eTT\u7684\u7ed3\u5408</strong>\uff1a\n   - \u52a8\u6001\u786e\u5b9aTT-\u79e9\n   - \u57fa\u4e8e\u8bef\u5dee\u7684\u81ea\u9002\u5e94\u7ec6\u5316\n   - \u9c81\u68d2\u6027\u589e\u5f3a</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u4f18\u5316\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5e76\u884c\u5316</strong>\uff1a\n   - TT-cores\u7684\u72ec\u7acb\u8ba1\u7b97\n   - \u6d41\u6c34\u7ebf\u5e76\u884cfor\u8fde\u7eed\u8fd0\u7b97\n   - GPU\u52a0\u901f\u7684\u5f20\u91cf\u6536\u7f29</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u4f18\u5316</strong>\uff1a\n   - \u907f\u514d\u4e2d\u95f4\u7ed3\u679c\u81a8\u80c0\n   - \u539f\u4f4d(in-place)\u8fd0\u7b97\u8bbe\u8ba1\n   - \u7f13\u5b58\u53cb\u597d\u7684\u6570\u636e\u5e03\u5c40</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\n   - \u5b9a\u671f\u91cd\u6b63\u4ea4\u5316\n   - \u6761\u4ef6\u6570\u76d1\u63a7\n   - \u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</p>\n</li>\n</ol>\n<p><strong>\u4e0e\u5176\u4ed6\u65b9\u6cd5\u7684\u6bd4\u8f83</strong>\uff1a</p>\n<p>| \u65b9\u6cd5 | \u5b58\u50a8 | \u77e9\u9635-\u5411\u91cf\u4e58 | \u9002\u7528\u573a\u666f | \u4e3b\u8981\u9650\u5236 |</p>\n<table>\n<thead>\n<tr>\n<th>\u65b9\u6cd5</th>\n<th>\u5b58\u50a8</th>\n<th>\u77e9\u9635-\u5411\u91cf\u4e58</th>\n<th>\u9002\u7528\u573a\u666f</th>\n<th>\u4e3b\u8981\u9650\u5236</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u7a00\u758f\u5b58\u50a8</td>\n<td>$\\mathcal{O}(nnz)$</td>\n<td>$\\mathcal{O}(nnz)$</td>\n<td>\u771f\u6b63\u7a00\u758f</td>\n<td>\u4e0d\u9002\u7528\u4e8e\u7a20\u5bc6</td>\n</tr>\n<tr>\n<td>\u4f4e\u79e9\u5206\u89e3</td>\n<td>$\\mathcal{O}(nr)$</td>\n<td>$\\mathcal{O}(nr)$</td>\n<td>\u5168\u5c40\u4f4e\u79e9</td>\n<td>\u79e9\u589e\u957f\u5feb</td>\n</tr>\n<tr>\n<td>H-matrices</td>\n<td>$\\mathcal{O}(n\\log n)$</td>\n<td>$\\mathcal{O}(n\\log n)$</td>\n<td>\u5c40\u90e8\u4f4e\u79e9</td>\n<td>\u6784\u9020\u590d\u6742</td>\n</tr>\n<tr>\n<td>TT\u683c\u5f0f</td>\n<td>$\\mathcal{O}(r^2\\log n)$</td>\n<td>$\\mathcal{O}(r^2\\log n)$</td>\n<td>\u591a\u5c3a\u5ea6\u7ed3\u6784</td>\n<td>\u9700\u8981\u89c4\u5219\u7f51\u683c</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u7814\u7a76\u524d\u6cbf\u4e0e\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7406\u8bba\u95ee\u9898</strong>\uff1a\n   - TT-\u79e9\u7684\u5148\u9a8c\u4f30\u8ba1\n   - \u6700\u4f18\u7d22\u5f15\u6392\u5e8f\u95ee\u9898\uff08NP-hard\uff09\n   - \u903c\u8fd1\u7406\u8bba\u7684\u5b8c\u5584</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u521b\u65b0</strong>\uff1a\n   - \u975e\u5747\u5300\u7f51\u683c\u7684\u63a8\u5e7f\n   - \u52a8\u6001TT-\u79e9\u81ea\u9002\u5e94\n   - \u4e0e\u6df1\u5ea6\u5b66\u4e60\u7684\u878d\u5408</p>\n</li>\n<li>\n<p><strong>\u5e94\u7528\u62d3\u5c55</strong>\uff1a\n   - \u91cf\u5b50\u591a\u4f53\u7cfb\u7edf\u6a21\u62df\n   - \u9ad8\u7ef4\u504f\u5fae\u5206\u65b9\u7a0b\u6c42\u89e3\n   - \u5927\u89c4\u6a21\u4f18\u5316\u95ee\u9898\n   - \u5f20\u91cf\u7f51\u7edc\u4e0eAutoML</p>\n</li>\n<li>\n<p><strong>\u786c\u4ef6\u9002\u914d</strong>\uff1a\n   - \u4e13\u7528\u5f20\u91cf\u5904\u7406\u5668\u8bbe\u8ba1\n   - \u5206\u5e03\u5f0fTT\u8fd0\u7b97\n   - \u8fd1\u6570\u636e\u8ba1\u7b97\u67b6\u6784</p>\n</li>\n</ol>\n<h2 id=\"182\">18.2 \u91cf\u5b50\u5947\u5f02\u503c\u53d8\u6362</h2>\n<p>\u91cf\u5b50\u5947\u5f02\u503c\u53d8\u6362(QSVT)\u662f\u91cf\u5b50\u7b97\u6cd5\u8bbe\u8ba1\u7684\u7edf\u4e00\u6846\u67b6\uff0c\u5176\u601d\u60f3\u53ef\u4ee5\u542f\u53d1\u7ecf\u5178\u7b97\u6cd5\u7684\u8bbe\u8ba1\u3002</p>\n<h3 id=\"1821-block-encoding\">18.2.1 Block Encoding\u6280\u672f</h3>\n<p>Block encoding\u662f\u5c06\u77e9\u9635\u5d4c\u5165\u5230\u66f4\u5927\u9149\u77e9\u9635\u4e2d\u7684\u6280\u672f\uff1a</p>\n<p><strong>\u5b9a\u4e49</strong>\uff1a\u77e9\u9635$\\mathbf{A}$\u7684$(\u03b1,a,\u03b5)$-block encoding\u662f\u9149\u77e9\u9635$\\mathbf{U}$\uff0c\u6ee1\u8db3\uff1a\n$$\\left| \\mathbf{A} - \u03b1(\\langle 0|^{\\otimes a} \\otimes \\mathbf{I})\\mathbf{U}(|0\\rangle^{\\otimes a} \\otimes \\mathbf{I}) \\right| \\leq \u03b5$$\n<strong>\u7ecf\u5178\u6a21\u62df\u601d\u8def</strong>\uff1a</p>\n<ol>\n<li>\u6784\u9020\u7a00\u758f\u77e9\u9635\u7684block encoding</li>\n<li>\u5229\u7528\u591a\u9879\u5f0f\u903c\u8fd1\u5b9e\u73b0\u77e9\u9635\u51fd\u6570</li>\n<li>\u901a\u8fc7\u91c7\u6837\u6280\u672f\u964d\u4f4e\u590d\u6742\u5ea6</li>\n</ol>\n<h3 id=\"1822\">18.2.2 \u91cf\u5b50\u76f8\u4f4d\u4f30\u8ba1\u7684\u7ecf\u5178\u6a21\u62df</h3>\n<p>\u91cf\u5b50\u76f8\u4f4d\u4f30\u8ba1(QPE)\u662f\u8bb8\u591a\u91cf\u5b50\u7b97\u6cd5\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5176\u7ecf\u5178\u6a21\u62df\u63d0\u4f9b\u4e86\u65b0\u7684\u7279\u5f81\u503c\u8ba1\u7b97\u65b9\u6cd5\u3002</p>\n<p><strong>\u6838\u5fc3\u601d\u60f3</strong>\uff1a</p>\n<ul>\n<li>\u5c06\u7279\u5f81\u503c\u7f16\u7801\u5230\u76f8\u4f4d\u4e2d</li>\n<li>\u901a\u8fc7\u63a7\u5236\u65cb\u8f6c\u63d0\u53d6\u76f8\u4f4d\u4fe1\u606f</li>\n<li>\u4f7f\u7528\u7ecf\u5178\u91c7\u6837\u6a21\u62df\u91cf\u5b50\u6d4b\u91cf</li>\n</ul>\n<p><strong>\u7ecf\u5178QPE\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\u51c6\u5907\u968f\u673a\u521d\u59cb\u5411\u91cf$|\\psi\\rangle$</li>\n<li>\u8ba1\u7b97$\\mathbf{U}^{2^k}|\\psi\\rangle$\u5e8f\u5217\uff08$k=0,1,...,m$\uff09</li>\n<li>\u5e94\u7528\u7ecf\u5178\"\u91cf\u5b50\"\u5085\u91cc\u53f6\u53d8\u6362</li>\n<li>\u4ece\u7ed3\u679c\u4e2d\u63d0\u53d6\u7279\u5f81\u503c\u4fe1\u606f</li>\n</ol>\n<p><strong>\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(m \\cdot T_{mult})$</li>\n<li>\u7cbe\u5ea6\uff1a$\\mathcal{O}(1/2^m)$</li>\n<li>\u6210\u529f\u6982\u7387\u4f9d\u8d56\u4e8e\u521d\u59cb\u5411\u91cf\u4e0e\u7279\u5f81\u5411\u91cf\u7684\u91cd\u53e0</li>\n</ul>\n<h3 id=\"1823-quantum-inspired-svd\">18.2.3 Quantum-inspired SVD\u7b97\u6cd5</h3>\n<p>\u57fa\u4e8eQSVT\u601d\u60f3\u7684SVD\u7b97\u6cd5\u63d0\u4f9b\u4e86\u65b0\u7684\u8ba1\u7b97\u8303\u5f0f\u3002</p>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a</p>\n<ol>\n<li>\u6784\u9020\u77e9\u9635$\\mathbf{A}$\u7684block encoding</li>\n<li>\u8bbe\u8ba1\u591a\u9879\u5f0f\u903c\u8fd1\u5947\u5f02\u503c\u53d8\u6362</li>\n<li>\u901a\u8fc7\u8fed\u4ee3\u7ec6\u5316\u63d0\u53d6\u5947\u5f02\u503c\u548c\u5947\u5f02\u5411\u91cf</li>\n</ol>\n<p><strong>\u5173\u952e\u521b\u65b0</strong>\uff1a</p>\n<ul>\n<li>\u5947\u5f02\u503c\u7684\u540c\u65f6\u53d8\u6362</li>\n<li>\u975e\u7ebf\u6027\u51fd\u6570\u7684\u9ad8\u6548\u5b9e\u73b0</li>\n<li>\u4e0eKrylov\u5b50\u7a7a\u95f4\u65b9\u6cd5\u7684\u8054\u7cfb</li>\n</ul>\n<p><strong>\u591a\u9879\u5f0f\u8bbe\u8ba1</strong>\uff1a\n\u5bf9\u4e8e\u76ee\u6807\u51fd\u6570$f(\\sigma)$\uff0c\u6784\u9020Chebyshev\u591a\u9879\u5f0f\u903c\u8fd1\uff1a\n$$p_n(\\sigma) = \\sum_{k=0}^n c_k T_k(\\sigma)$$\n\u5176\u4e2d\u7cfb\u6570\u901a\u8fc7\u4ee5\u4e0b\u4f18\u5316\u786e\u5b9a\uff1a\n$$\\min_{c_k} \\max_{\\sigma \\in [-1,1]} |f(\\sigma) - p_n(\\sigma)|$$</p>\n<h3 id=\"1824\">18.2.4 \u8bef\u5dee\u5206\u6790\u4e0e\u590d\u6742\u5ea6</h3>\n<p>\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u7684\u6027\u80fd\u5206\u6790\u9700\u8981\u8003\u8651\u591a\u4e2a\u56e0\u7d20\u3002</p>\n<p><strong>\u8bef\u5dee\u6765\u6e90</strong>\uff1a</p>\n<ol>\n<li>Block encoding\u8fd1\u4f3c\u8bef\u5dee\uff1a$\\epsilon_{block}$</li>\n<li>\u591a\u9879\u5f0f\u903c\u8fd1\u8bef\u5dee\uff1a$\\epsilon_{poly}$</li>\n<li>\u91c7\u6837\u8bef\u5dee\uff1a$\\epsilon_{sample}$</li>\n<li>\u6570\u503c\u7cbe\u5ea6\uff1a$\\epsilon_{numerical}$</li>\n</ol>\n<p><strong>\u603b\u8bef\u5dee\u754c</strong>\uff1a\n$$|\\mathbf{A}_{approx} - \\mathbf{A}| \\leq \\epsilon_{block} + \\epsilon_{poly} + \\mathcal{O}(\\sqrt{\\log(1/\\delta)/N_{samples}})$$\n<strong>\u590d\u6742\u5ea6\u6743\u8861</strong>\uff1a</p>\n<ul>\n<li>\u7cbe\u5ea6vs\u8ba1\u7b97\u65f6\u95f4</li>\n<li>\u5185\u5b58vs\u5e76\u884c\u5ea6</li>\n<li>\u786e\u5b9a\u6027vs\u968f\u673a\u5316</li>\n</ul>\n<p><strong>\u5b9e\u7528\u6307\u5bfc</strong>\uff1a</p>\n<ol>\n<li>\u5bf9\u4e8e\u4f4e\u79e9\u77e9\u9635\uff0c\u91cf\u5b50\u542f\u53d1\u65b9\u6cd5\u53ef\u80fd\u4f18\u4e8e\u7ecf\u5178\u968f\u673a\u5316</li>\n<li>Block encoding\u7684\u6784\u9020\u662f\u6027\u80fd\u74f6\u9888</li>\n<li>\u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236\u53ef\u663e\u8457\u63d0\u5347\u6548\u7387</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u6700\u4f18block encoding\u6784\u9020</li>\n<li>\u786c\u4ef6\u52a0\u901f\u7684\u53ef\u80fd\u6027</li>\n<li>\u4e0e\u6df1\u5ea6\u5b66\u4e60\u4f18\u5316\u5668\u7684\u7ed3\u5408</li>\n<li>\u566a\u58f0\u9c81\u68d2\u6027\u5206\u6790</li>\n</ul>\n<h2 id=\"183\">18.3 \u7ecf\u5178\u6a21\u62df\u7684\u8ba1\u7b97\u590d\u6742\u5ea6</h2>\n<p>\u7406\u89e3\u91cf\u5b50\u7b97\u6cd5\u7684\u7ecf\u5178\u6a21\u62df\u590d\u6742\u5ea6\u5bf9\u4e8e\u8bc6\u522b\u771f\u6b63\u7684\u91cf\u5b50\u4f18\u52bf\u81f3\u5173\u91cd\u8981\u3002\u672c\u8282\u6df1\u5165\u5206\u6790\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u7684\u7406\u8bba\u57fa\u7840\u3002</p>\n<h3 id=\"1831\">18.3.1 \u91cf\u5b50\u4f18\u52bf\u7684\u8fb9\u754c</h3>\n<p>\u91cf\u5b50\u8ba1\u7b97\u5e76\u975e\u5728\u6240\u6709\u95ee\u9898\u4e0a\u90fd\u5177\u6709\u6307\u6570\u52a0\u901f\uff0c\u7406\u89e3\u5176\u8fb9\u754c\u6709\u52a9\u4e8e\u8bbe\u8ba1\u66f4\u597d\u7684\u7ecf\u5178\u7b97\u6cd5\u3002</p>\n<p><strong>\u91cf\u5b50\u52a0\u901f\u7684\u6761\u4ef6</strong>\uff1a</p>\n<ol>\n<li><strong>\u95ee\u9898\u7ed3\u6784</strong>\uff1a\u9700\u8981\u5168\u5c40\u76f8\u5e72\u6027</li>\n<li><strong>\u8f93\u5165\u6a21\u578b</strong>\uff1a\u91cf\u5b50\u6001\u51c6\u5907vs\u7ecf\u5178\u6570\u636e\u52a0\u8f7d</li>\n<li><strong>\u8f93\u51fa\u8981\u6c42</strong>\uff1a\u5b8c\u6574\u89e3vs\u91c7\u6837/\u8fd1\u4f3c</li>\n</ol>\n<p><strong>\u7ecf\u5178\u53ef\u6a21\u62df\u7684\u60c5\u51b5</strong>\uff1a</p>\n<ul>\n<li>\u4f4e\u7ea0\u7f20\u5ea6\u7cfb\u7edf\uff1abond dimension\u591a\u9879\u5f0f\u589e\u957f</li>\n<li>\u7a00\u758f\u54c8\u5bc6\u987f\u91cf\uff1aFeynman\u8def\u5f84\u53ef\u6709\u6548\u91c7\u6837</li>\n<li>\u7279\u5b9a\u5bf9\u79f0\u6027\uff1a\u5229\u7528\u7fa4\u8bba\u7b80\u5316</li>\n</ul>\n<p><strong>BQP vs BPP\u8fb9\u754c</strong>\uff1a</p>\n<ul>\n<li>Gottesman-Knill\u5b9a\u7406\uff1aClifford\u7535\u8def\u7684\u9ad8\u6548\u6a21\u62df</li>\n<li>\u91cf\u5b50\u4f18\u52bf\u7684\u5fc5\u8981\u6761\u4ef6\uff1a\u975eClifford\u95e8\u7684\u5bc6\u5ea6</li>\n<li>\u7ecf\u5178\u786c\u5ea6\u5047\u8bbe\uff1a\u67d0\u4e9b\u91c7\u6837\u95ee\u9898</li>\n</ul>\n<h3 id=\"1832-dequantization\">18.3.2 Dequantization\u6280\u672f</h3>\n<p>Dequantization\u662f\u5c06\u91cf\u5b50\u7b97\u6cd5\u8f6c\u5316\u4e3a\u7ecf\u5178\u7b97\u6cd5\u7684\u7cfb\u7edf\u65b9\u6cd5\uff0cTang\u7684\u7a81\u7834\u6027\u5de5\u4f5c\u5c55\u793a\u4e86\u5176\u5a01\u529b\u3002</p>\n<p><strong>\u6838\u5fc3\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91c7\u6837\u6743\u91cd\u77e9\u9635</strong>\uff1a\n   - \u6784\u9020\u6982\u7387\u5206\u5e03$p_{ij} = |A_{ij}|^2/|\\mathbf{A}|_F^2$\n   - \u901a\u8fc7\u91c7\u6837\u8fd1\u4f3c\u77e9\u9635\u8fd0\u7b97\n   - \u5229\u7528concentration inequality\u63a7\u5236\u8bef\u5dee</p>\n</li>\n<li>\n<p><strong><code>\u2113\u00b2</code>-norm\u91c7\u6837</strong>\uff1a\n   - \u884c/\u5217\u7684\u91cd\u8981\u6027\u91c7\u6837\n   - Leverage score\u7684\u5feb\u901f\u8ba1\u7b97\n   - \u81ea\u9002\u5e94\u91c7\u6837\u7b56\u7565</p>\n</li>\n</ol>\n<p><strong>Dequantized\u7b97\u6cd5\u793a\u4f8b</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u63a8\u8350\u7cfb\u7edf</strong>\uff1a\n   - \u539f\u59cb\u91cf\u5b50\u7b97\u6cd5\uff1a$\\mathcal{O}(\\text{poly}(\\log mn))$\n   - Dequantized\u7248\u672c\uff1a$\\mathcal{O}(\\text{poly}(k)\\text{polylog}(mn))$\n   - \u6761\u4ef6\uff1a\u4f4e\u79e9\u5047\u8bbe($k \\ll m,n$)</p>\n</li>\n<li>\n<p><strong>\u4e3b\u6210\u5206\u5206\u6790</strong>\uff1a\n   - \u91c7\u6837based\u7684\u4f4e\u79e9\u8fd1\u4f3c\n   - Frieze-Kannan-Vempala\u7b97\u6cd5\u7684\u6539\u8fdb\n   - \u4e0e\u968f\u673aSVD\u7684\u8054\u7cfb</p>\n</li>\n</ol>\n<h3 id=\"1833\">18.3.3 \u91c7\u6837\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p>\u7cbe\u786e\u5206\u6790\u91c7\u6837\u590d\u6742\u5ea6\u662f\u7406\u89e3\u7b97\u6cd5\u6027\u80fd\u7684\u5173\u952e\u3002</p>\n<p><strong>\u57fa\u672c\u4e0d\u7b49\u5f0f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Hoeffding\u754c</strong>\uff1a\n$$P(|\\bar{X} - \\mathbb{E}[X]| \\geq t) \\leq 2\\exp(-2nt^2/b^2)$$</p>\n</li>\n<li>\n<p><strong>Matrix Bernstein\u4e0d\u7b49\u5f0f</strong>\uff1a\n$$P(|\\sum_i \\mathbf{X}_i - \\mathbb{E}[\\sum_i \\mathbf{X}_i]| \\geq t) \\leq 2n\\exp(-t^2/2(\\sigma^2 + Mt/3))$$\n<strong>\u91c7\u6837\u7b56\u7565\u4f18\u5316</strong>\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u91cd\u8981\u6027\u91c7\u6837vs\u5747\u5300\u91c7\u6837</li>\n<li>\u81ea\u9002\u5e94\u91c7\u6837\u8f6e\u6570</li>\n<li>Variance reduction\u6280\u672f</li>\n</ul>\n<p><strong>\u590d\u6742\u5ea6\u4e0b\u754c</strong>\uff1a</p>\n<ul>\n<li>\u4fe1\u606f\u8bba\u4e0b\u754c\uff1a$\\Omega(\\epsilon^{-2})$\u91c7\u6837for $\\epsilon$-\u8fd1\u4f3c</li>\n<li>\u7ef4\u5ea6\u4f9d\u8d56\uff1a\u67d0\u4e9b\u95ee\u9898\u9700\u8981$\\Omega(d)$\u91c7\u6837</li>\n<li>\u6761\u4ef6\u6570\u5f71\u54cd\uff1a$\\Omega(\\kappa)$\u4f9d\u8d56for\u75c5\u6001\u95ee\u9898</li>\n</ul>\n<h3 id=\"1834\">18.3.4 \u4e0e\u7ecf\u5178\u968f\u673a\u5316\u7b97\u6cd5\u7684\u5bf9\u6bd4</h3>\n<p>\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u4e0e\u7ecf\u5178\u968f\u673a\u5316\u65b9\u6cd5\u6709\u6df1\u523b\u8054\u7cfb\u3002</p>\n<p><strong>\u7b97\u6cd5\u8c31\u7cfb</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7ecf\u5178\u786e\u5b9a\u6027 \u2192 \u7ecf\u5178\u968f\u673a\u5316 \u2192 \u91cf\u5b50\u542f\u53d1 \u2192 \u5b8c\u5168\u91cf\u5b50\n     \u2191              \u2191            \u2191           \u2191\n   \u7cbe\u786e\u89e3      Monte Carlo    Dequantized   \u6307\u6570\u52a0\u901f\n</code></pre></div>\n\n<p><strong>\u6027\u80fd\u5bf9\u6bd4\u8868</strong>\uff1a</p>\n<p>| \u7b97\u6cd5\u7c7b\u578b | \u65f6\u95f4\u590d\u6742\u5ea6 | \u7a7a\u95f4\u590d\u6742\u5ea6 | \u7cbe\u5ea6\u4fdd\u8bc1 | \u5e76\u884c\u6027 |</p>\n<table>\n<thead>\n<tr>\n<th>\u7b97\u6cd5\u7c7b\u578b</th>\n<th>\u65f6\u95f4\u590d\u6742\u5ea6</th>\n<th>\u7a7a\u95f4\u590d\u6742\u5ea6</th>\n<th>\u7cbe\u5ea6\u4fdd\u8bc1</th>\n<th>\u5e76\u884c\u6027</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Johnson-Lindenstrauss</td>\n<td>$\\mathcal{O}(n\\log n/\\epsilon^2)$</td>\n<td>$\\mathcal{O}(n/\\epsilon^2)$</td>\n<td>$\\epsilon$-\u4fdd\u8ddd</td>\n<td>\u9ad8</td>\n</tr>\n<tr>\n<td>\u968f\u673aSVD</td>\n<td>$\\mathcal{O}(mn\\log k)$</td>\n<td>$\\mathcal{O}(mk)$</td>\n<td>\u76f8\u5bf9\u8bef\u5dee</td>\n<td>\u4e2d</td>\n</tr>\n<tr>\n<td>\u91cf\u5b50\u542f\u53d1SVD</td>\n<td>$\\mathcal{O}(\\text{poly}(k,1/\\epsilon)\\log mn)$</td>\n<td>$\\mathcal{O}(\\text{poly}(k))$</td>\n<td>\u52a0\u6027\u8bef\u5dee</td>\n<td>\u4f4e</td>\n</tr>\n<tr>\n<td>CountSketch</td>\n<td>$\\mathcal{O}(nnz)$</td>\n<td>$\\mathcal{O}(k/\\epsilon)$</td>\n<td>$\\epsilon|\\mathbf{A}-\\mathbf{A}_k|$</td>\n<td>\u9ad8</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u9009\u62e9\u6307\u5357</strong>\uff1a</p>\n<ol>\n<li><strong>\u6570\u636e\u7a00\u758f\u6027</strong>\uff1a\u7a00\u758f\u6570\u636e\u503e\u5411\u7ecf\u5178\u65b9\u6cd5</li>\n<li><strong>\u7cbe\u5ea6\u8981\u6c42</strong>\uff1a\u9ad8\u7cbe\u5ea6\u65f6\u91cf\u5b50\u542f\u53d1\u53ef\u80fd\u66f4\u4f18</li>\n<li><strong>\u77e9\u9635\u7ed3\u6784</strong>\uff1a\u4f4e\u79e9+\u7a20\u5bc6\u9002\u5408\u91cf\u5b50\u542f\u53d1</li>\n<li><strong>\u786c\u4ef6\u9650\u5236</strong>\uff1a\u5185\u5b58\u53d7\u9650\u65f6\u8003\u8651streaming\u7b97\u6cd5</li>\n</ol>\n<p><strong>\u7406\u8bba\u89c1\u89e3</strong>\uff1a</p>\n<ul>\n<li>\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5often\u63d0\u4f9bpolylog\u4f9d\u8d56</li>\n<li>\u4f46\u5e38\u6570\u56e0\u5b50\u53ef\u80fd\u5f88\u5927</li>\n<li>\u9700\u8981\u7ec6\u81f4\u7684\u5b9e\u8bc1\u6bd4\u8f83</li>\n</ul>\n<p><strong>\u672a\u6765\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\u66f4\u7d27\u7684\u590d\u6742\u5ea6\u754c</li>\n<li>\u95ee\u9898specific\u7684\u4f18\u5316</li>\n<li>\u6df7\u5408\u7b97\u6cd5\u8bbe\u8ba1</li>\n<li>\u5b9e\u7528\u6027\u57fa\u51c6\u6d4b\u8bd5</li>\n</ol>\n<h2 id=\"184\">18.4 \u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u6f5c\u529b</h2>\n<p>\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u5c55\u73b0\u51fa\u72ec\u7279\u4f18\u52bf\uff0c\u672c\u8282\u63a2\u8ba8\u5177\u4f53\u5e94\u7528\u548c\u672a\u6765\u6f5c\u529b\u3002</p>\n<h3 id=\"1841\">18.4.1 \u91cf\u5b50\u6838\u65b9\u6cd5\u7684\u7ecf\u5178\u5b9e\u73b0</h3>\n<p>\u91cf\u5b50\u6838\u5229\u7528\u9ad8\u7ef4\u7279\u5f81\u7a7a\u95f4\uff0c\u5176\u7ecf\u5178\u8fd1\u4f3c\u63d0\u4f9b\u4e86\u65b0\u7684\u6838\u51fd\u6570\u8bbe\u8ba1\u601d\u8def\u3002</p>\n<p><strong>\u91cf\u5b50\u6838\u7684\u5b9a\u4e49</strong>\uff1a\n$$K(x,x') = |\\langle\\phi(x)|\\phi(x')\\rangle|^2$$\n\u5176\u4e2d$|\\phi(x)\\rangle$\u662f\u6570\u636e\u7684\u91cf\u5b50\u7279\u5f81\u6620\u5c04\u3002</p>\n<p><strong>\u7ecf\u5178\u8fd1\u4f3c\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Random Fourier Features\u7684\u63a8\u5e7f</strong>\uff1a\n   - \u6784\u9020\u91cf\u5b50\u7535\u8def\u7684\u7ecf\u5178\u6a21\u62df\n   - \u91c7\u6837\u7279\u5f81\u6620\u5c04\u7684\u5206\u91cf\n   - \u4fdd\u6301\u5185\u79ef\u7ed3\u6784</p>\n</li>\n<li>\n<p><strong>\u5f20\u91cf\u7f51\u7edc\u8868\u793a</strong>\uff1a\n   - \u5c06\u91cf\u5b50\u6001\u8868\u793a\u4e3aMPS\n   - \u9ad8\u6548\u8ba1\u7b97\u6838\u77e9\u9635\u5143\u7d20\n   - \u63a7\u5236\u7ea0\u7f20\u5ea6\u4ee5\u9650\u5236\u590d\u6742\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li><strong>\u5206\u7c7b\u4efb\u52a1</strong>\uff1a\u91cf\u5b50\u6838SVM</li>\n<li><strong>\u56de\u5f52\u95ee\u9898</strong>\uff1a\u91cf\u5b50\u6838\u5cad\u56de\u5f52</li>\n<li><strong>\u5f02\u5e38\u68c0\u6d4b</strong>\uff1a\u57fa\u4e8e\u91cf\u5b50\u8ddd\u79bb</li>\n</ul>\n<p><strong>\u6027\u80fd\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u8868\u8fbe\u80fd\u529bvs\u8ba1\u7b97\u6548\u7387\u7684\u6743\u8861</li>\n<li>\u4e0e\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u7684\u6bd4\u8f83</li>\n<li>\u6570\u636e\u7f16\u7801\u7684\u5f71\u54cd</li>\n</ul>\n<h3 id=\"1842-quantum-inspired\">18.4.2 Quantum-inspired\u63a8\u8350\u7cfb\u7edf</h3>\n<p>\u63a8\u8350\u7cfb\u7edf\u662f\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u6700\u6210\u529f\u7684\u5e94\u7528\u4e4b\u4e00\u3002</p>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4f4e\u79e9\u77e9\u9635\u8865\u5168</strong>\uff1a\n   - \u7528\u6237-\u7269\u54c1\u77e9\u9635\u7684\u7a00\u758f\u89c2\u6d4b\n   - \u91cf\u5b50\u542f\u53d1\u7684\u91c7\u6837\u7b56\u7565\n   - \u5feb\u901f\u66f4\u65b0\u673a\u5236</p>\n</li>\n<li>\n<p><strong>\u6838\u5fc3\u7b97\u6cd5</strong>\uff1a\n   ```</p>\n</li>\n<li>\n<p>\u6784\u5efa\u91c7\u6837\u6570\u636e\u7ed3\u6784\uff08\u6309\u884c/\u5217\u8303\u6570\uff09</p>\n</li>\n<li>for t = 1 to T:<ol start=\"3\">\n<li>\u91c7\u6837\u7528\u6237i\u548c\u7269\u54c1j</li>\n<li>\u4f30\u8ba1$\\mathbf{U}_i^T\\mathbf{V}_j$</li>\n<li>\u66f4\u65b0\u91c7\u6837\u6743\u91cd</li>\n</ol>\n</li>\n<li>\u8f93\u51fa\uff1a\u4f4e\u79e9\u5206\u89e3$\\mathbf{R} \\approx \\mathbf{U}\\mathbf{V}^T$\n   ```</li>\n</ol>\n<p><strong>\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u4e9a\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(\\text{poly}(k)\\text{polylog}(mn))$</li>\n<li>\u5728\u7ebf\u66f4\u65b0\u80fd\u529b</li>\n<li>\u9690\u79c1\u4fdd\u62a4\uff1a\u4e0d\u9700\u8981\u5b58\u50a8\u5b8c\u6574\u77e9\u9635</li>\n</ul>\n<p><strong>\u5b9e\u8df5\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u51b7\u542f\u52a8\u95ee\u9898\u7684\u5904\u7406</li>\n<li>\u65f6\u5e8f\u4fe1\u606f\u7684\u6574\u5408</li>\n<li>\u591a\u6a21\u6001\u6570\u636e\u878d\u5408</li>\n</ul>\n<h3 id=\"1843\">18.4.3 \u5f20\u91cf\u7f51\u7edc\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</h3>\n<p>\u5f20\u91cf\u7f51\u7edc\u4e3a\u6df1\u5ea6\u5b66\u4e60\u63d0\u4f9b\u4e86\u65b0\u7684\u6a21\u578b\u538b\u7f29\u548c\u7406\u8bba\u5206\u6790\u5de5\u5177\u3002</p>\n<p><strong>\u4e3b\u8981\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u795e\u7ecf\u7f51\u7edc\u538b\u7f29</strong>\uff1a\n   - \u6743\u91cd\u77e9\u9635\u7684TT\u5206\u89e3\n   - \u5377\u79ef\u6838\u7684CP\u5206\u89e3\n   - \u4fdd\u6301\u6027\u80fd\u7684\u79e9\u9009\u62e9</p>\n</li>\n<li>\n<p><strong>\u65b0\u578b\u67b6\u6784\u8bbe\u8ba1</strong>\uff1a\n   - Tensor network\u5c42\n   - \u91cf\u5b50\u7535\u8def\u542f\u53d1\u7684\u6fc0\u6d3b\u51fd\u6570\n   - \u7ea0\u7f20\u5ea6\u4f5c\u4e3a\u6b63\u5219\u5316</p>\n</li>\n<li>\n<p><strong>\u7406\u8bba\u5206\u6790\u5de5\u5177</strong>\uff1a\n   - \u8868\u8fbe\u80fd\u529b\u7684\u5f20\u91cf\u5206\u6790\n   - \u68af\u5ea6\u6d41\u7684\u51e0\u4f55\u7406\u89e3\n   - \u6cdb\u5316\u754c\u7684\u63a8\u5bfc</p>\n</li>\n</ol>\n<p><strong>\u5177\u4f53\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li><strong>TT-\u5c42</strong>\uff1a\u5c06\u5168\u8fde\u63a5\u5c42\u53c2\u6570\u5316\u4e3aTT\u683c\u5f0f</li>\n<li>\u53c2\u6570\u6570\u91cf\uff1a$\\mathcal{O}(dr^2\\log n)$ vs $\\mathcal{O}(n^2)$</li>\n<li>\u524d\u5411\u4f20\u64ad\uff1a\u5229\u7528TT\u7ed3\u6784\u52a0\u901f</li>\n<li>\n<p>\u53cd\u5411\u4f20\u64ad\uff1a\u4fdd\u6301TT\u683c\u5f0f\u7684\u68af\u5ea6</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u7535\u8defBorn\u673a</strong>\uff1a</p>\n</li>\n<li>\u751f\u6210\u6a21\u578b\u7684\u65b0\u8303\u5f0f</li>\n<li>\u91c7\u6837\u590d\u6742\u5ea6\u5206\u6790</li>\n<li>\u4e0eGAN/VAE\u7684\u6bd4\u8f83</li>\n</ul>\n<h3 id=\"1844\">18.4.4 \u672a\u6765\u7814\u7a76\u65b9\u5411</h3>\n<p>\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u4ecd\u6709\u5de8\u5927\u6f5c\u529b\u5f85\u6316\u6398\u3002</p>\n<p><strong>\u7406\u8bba\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u590d\u6742\u5ea6\u7406\u8bba</strong>\uff1a\n   - \u5b66\u4e60\u95ee\u9898\u7684\u91cf\u5b50\u52a0\u901f\u754c\u9650\n   - BQP-complete\u95ee\u9898\u7684\u673a\u5668\u5b66\u4e60\u5e94\u7528\n   - \u91cf\u5b50\u542f\u53d1\u7684PAC\u5b66\u4e60</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u8bbe\u8ba1</strong>\uff1a\n   - \u65b0\u7684dequantization\u6280\u672f\n   - \u6df7\u5408\u91cf\u5b50-\u7ecf\u5178\u7b97\u6cd5\n   - \u95ee\u9898\u7279\u5b9a\u7684\u4f18\u5316</p>\n</li>\n</ol>\n<p><strong>\u5e94\u7528\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5927\u8bed\u8a00\u6a21\u578b</strong>\uff1a\n   - Attention\u673a\u5236\u7684\u91cf\u5b50\u542f\u53d1\n   - \u53c2\u6570\u9ad8\u6548\u5fae\u8c03\n   - \u63a8\u7406\u52a0\u901f</p>\n</li>\n<li>\n<p><strong>\u79d1\u5b66\u8ba1\u7b97</strong>\uff1a\n   - \u5206\u5b50\u52a8\u529b\u5b66\u6a21\u62df\n   - \u91cf\u5b50\u5316\u5b66\u8ba1\u7b97\n   - \u6750\u6599\u8bbe\u8ba1</p>\n</li>\n<li>\n<p><strong>\u7ec4\u5408\u4f18\u5316</strong>\uff1a\n   - QAOA\u7684\u7ecf\u5178\u6a21\u62df\n   - \u9000\u706b\u7b97\u6cd5\u7684\u6539\u8fdb\n   - \u7ea6\u675f\u6ee1\u8db3\u95ee\u9898</p>\n</li>\n</ol>\n<p><strong>\u6280\u672f\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li><strong>\u5b9e\u7528\u6027\u9e3f\u6c9f</strong>\uff1a\u7406\u8bba\u4f18\u52bf\u5230\u5b9e\u9645\u52a0\u901f</li>\n<li><strong>\u786c\u4ef6\u9002\u914d</strong>\uff1aGPU/TPU\u7684\u9ad8\u6548\u5b9e\u73b0</li>\n<li><strong>\u53ef\u89e3\u91ca\u6027</strong>\uff1a\u91cf\u5b50\u542f\u53d1\u6a21\u578b\u7684\u7406\u89e3</li>\n<li><strong>\u9c81\u68d2\u6027</strong>\uff1a\u566a\u58f0\u548c\u8bef\u5dee\u7684\u5f71\u54cd</li>\n</ul>\n<p><strong>\u8de8\u5b66\u79d1\u673a\u4f1a</strong>\uff1a</p>\n<ul>\n<li>\u7269\u7406\u5b66\uff1a\u591a\u4f53\u7cfb\u7edf\u6a21\u62df</li>\n<li>\u5316\u5b66\uff1a\u53cd\u5e94\u8def\u5f84\u9884\u6d4b</li>\n<li>\u751f\u7269\u5b66\uff1a\u86cb\u767d\u8d28\u6298\u53e0</li>\n<li>\u91d1\u878d\uff1a\u98ce\u9669\u5206\u6790</li>\n</ul>\n<p><strong>\u8bc4\u4f30\u57fa\u51c6</strong>\uff1a\n\u9700\u8981\u5efa\u7acb\u6807\u51c6\u5316\u7684\u57fa\u51c6\u6d4b\u8bd5\uff1a</p>\n<ul>\n<li>\u4e0d\u540c\u89c4\u6a21\u7684\u6570\u636e\u96c6</li>\n<li>\u591a\u6837\u7684\u4efb\u52a1\u7c7b\u578b</li>\n<li>\u516c\u5e73\u7684\u786c\u4ef6\u6bd4\u8f83</li>\n<li>\u5b9e\u9645\u5e94\u7528\u573a\u666f</li>\n</ul>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u91cf\u5b50\u542f\u53d1\u7684\u77e9\u9635\u7b97\u6cd5\u4ee3\u8868\u4e86\u8ba1\u7b97\u79d1\u5b66\u7684\u65b0\u524d\u6cbf\uff0c\u5c06\u91cf\u5b50\u8ba1\u7b97\u7684\u7406\u8bba\u4f18\u52bf\u8f6c\u5316\u4e3a\u5b9e\u7528\u7684\u7ecf\u5178\u7b97\u6cd5\u3002\u672c\u7ae0\u7684\u6838\u5fc3\u8981\u70b9\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f20\u91cf\u7f51\u7edc\u65b9\u6cd5</strong>\uff1a\n   - MPS/TT\u5206\u89e3\u63d0\u4f9b\u4e86\u5904\u7406\u9ad8\u7ef4\u6570\u636e\u7684\u5f3a\u5927\u5de5\u5177\n   - DMRG\u5c55\u793a\u4e86\u5c40\u90e8\u4f18\u5316\u8fbe\u5230\u5168\u5c40\u6700\u4f18\u7684\u53ef\u80fd\u6027\n   - \u5b58\u50a8\u548c\u8ba1\u7b97\u590d\u6742\u5ea6\u7684\u6307\u6570\u7ea7\u964d\u4f4e</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u5947\u5f02\u503c\u53d8\u6362</strong>\uff1a\n   - Block encoding\u7edf\u4e00\u4e86\u77e9\u9635\u51fd\u6570\u7684\u8ba1\u7b97\u6846\u67b6\n   - \u591a\u9879\u5f0f\u903c\u8fd1\u6280\u672f\u8fde\u63a5\u4e86\u91cf\u5b50\u548c\u7ecf\u5178\u7b97\u6cd5\n   - \u4e3a\u77e9\u9635\u8ba1\u7b97\u63d0\u4f9b\u4e86\u65b0\u7684\u7b97\u6cd5\u8bbe\u8ba1\u8303\u5f0f</p>\n</li>\n<li>\n<p><strong>\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a\n   - Dequantization\u63ed\u793a\u4e86\u91cf\u5b50\u4f18\u52bf\u7684\u771f\u5b9e\u8fb9\u754c\n   - \u91c7\u6837\u6280\u672f\u662f\u5b9e\u73b0\u4e9a\u7ebf\u6027\u7b97\u6cd5\u7684\u5173\u952e\n   - \u7406\u8bba\u5206\u6790\u6307\u5bfc\u5b9e\u9645\u7b97\u6cd5\u9009\u62e9</p>\n</li>\n<li>\n<p><strong>\u673a\u5668\u5b66\u4e60\u5e94\u7528</strong>\uff1a\n   - \u63a8\u8350\u7cfb\u7edf\u5c55\u793a\u4e86\u5b9e\u9645\u52a0\u901f\u7684\u53ef\u80fd\n   - \u5f20\u91cf\u7f51\u7edc\u4e3a\u6df1\u5ea6\u5b66\u4e60\u63d0\u4f9b\u65b0\u5de5\u5177\n   - \u8de8\u5b66\u79d1\u878d\u5408\u521b\u9020\u65b0\u673a\u4f1a</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u516c\u5f0f\u56de\u987e</strong>\uff1a</p>\n<ul>\n<li>TT\u5206\u89e3\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(dnr^2)$ vs $\\mathcal{O}(n^d)$</li>\n<li>Dequantized\u91c7\u6837\uff1a$\\mathcal{O}(\\text{poly}(k)\\text{polylog}(mn))$</li>\n<li>\u91cf\u5b50\u6838\uff1a$K(x,x') = |\\langle\\phi(x)|\\phi(x')\\rangle|^2$</li>\n</ul>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u989818.1</strong> (TT-\u5206\u89e3\u7684\u57fa\u672c\u6027\u8d28)\n\u7ed9\u5b9a\u4e00\u4e2a\u56db\u9636\u5f20\u91cf$\\mathcal{T} \\in \\mathbb{R}^{10 \\times 10 \\times 10 \\times 10}$\uff0c\u5176TT-\u79e9\u4e3a$(r_1, r_2, r_3) = (5, 8, 5)$\u3002\n(a) \u8ba1\u7b97TT\u683c\u5f0f\u7684\u5b58\u50a8\u9700\u6c42\n(b) \u5982\u679c\u5f20\u91cf\u7684\u6bcf\u4e2a\u5143\u7d20\u53ef\u4ee5\u8868\u793a\u4e3a$\\mathcal{T}_{i,j,k,l} = \\sin(i+j)\\cos(k+l)$\uff0c\u8bc1\u660e\u5176TT-\u79e9\u81f3\u591a\u4e3a2\n(c) \u8bbe\u8ba1\u7b97\u6cd5\u8ba1\u7b97$\\mathcal{T}$\u4e0e\u5411\u91cf\u7684\u6536\u7f29</p>\n<p><em>Hint</em>: \u5229\u7528\u4e09\u89d2\u6052\u7b49\u5f0f\u548c\u79e91\u5206\u89e3\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) TT\u683c\u5f0f\u5b58\u50a8\uff1a$G^{[1]} \\in \\mathbb{R}^{10 \\times 5}$, $G^{[2]} \\in \\mathbb{R}^{5 \\times 10 \\times 8}$, $G^{[3]} \\in \\mathbb{R}^{8 \\times 10 \\times 5}$, $G^{[4]} \\in \\mathbb{R}^{5 \\times 10}$\n\u603b\u5b58\u50a8\uff1a$10 \\times 5 + 5 \\times 10 \\times 8 + 8 \\times 10 \\times 5 + 5 \\times 10 = 900$\u4e2a\u5143\u7d20</p>\n<p>(b) \u5229\u7528$\\sin(i+j) = \\sin i \\cos j + \\cos i \\sin j$\uff0c\u53ef\u5c06\u5f20\u91cf\u5199\u4e3a\u6700\u591a4\u4e2a\u79e91\u5f20\u91cf\u7684\u548c\u3002\u7531\u4e8e$\\cos(k+l)$\u4e5f\u7c7b\u4f3c\u5206\u89e3\uff0c\u603b\u79e9\u6700\u591a\u4e3a2\u3002</p>\n<p>(c) \u4ece\u53f3\u5411\u5de6\u9010\u6b65\u6536\u7f29\uff0c\u4fdd\u6301\u4e2d\u95f4\u7ed3\u679c\u4e3a\u77e9\u9635\u5f62\u5f0f\uff0c\u590d\u6742\u5ea6$\\mathcal{O}(dr^2n)$\u3002</p>\n</details>\n<p><strong>\u4e60\u989818.2</strong> (Block Encoding\u6784\u9020)\n\u8bbe$\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$\u662f\u7a00\u758f\u77e9\u9635\uff0c\u6bcf\u884c\u6700\u591a\u6709$s$\u4e2a\u975e\u96f6\u5143\u7d20\uff0c\u4e14$|\\mathbf{A}| \\leq 1$\u3002\n(a) \u6784\u9020$\\mathbf{A}$\u7684$(s, \\lceil\\log n\\rceil, 0)$-block encoding\n(b) \u5982\u679c$\\mathbf{A}$\u662f\u4e09\u5bf9\u89d2\u77e9\u9635\uff0c\u5982\u4f55\u4f18\u5316\u6784\u9020\uff1f\n(c) \u5206\u6790\u6784\u9020\u7684\u65f6\u95f4\u590d\u6742\u5ea6</p>\n<p><em>Hint</em>: \u8003\u8651oracle\u8bbf\u95ee\u6a21\u578b\u548c\u7a00\u758f\u6027\u7ed3\u6784\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) \u6784\u9020$\\mathbf{U}$\u4f7f\u5f97\u5de6\u4e0a\u89d2\u5757\u4e3a$\\mathbf{A}/s$\uff0c\u5229\u7528\u63a7\u5236\u65cb\u8f6c\u5b9e\u73b0\u7a00\u758f\u77e9\u9635\u5143\u7d20\u7684\u9009\u62e9\u6027\u5e94\u7528\u3002\u8f85\u52a9\u7a7a\u95f4\u7f16\u7801\u5217\u7d22\u5f15\u3002</p>\n<p>(b) \u4e09\u5bf9\u89d2\u77e9\u9635\u53ef\u4ee5\u7528\u66f4\u5c11\u7684\u8f85\u52a9\u91cf\u5b50\u6bd4\u7279\uff0c\u53ea\u9700\u89812\u4e2a\u989d\u5916\u6bd4\u7279\u7f16\u7801\u76f8\u5bf9\u4f4d\u7f6e\uff08-1, 0, 1\uff09\u3002</p>\n<p>(c) \u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(s)$\u6bcf\u6b21\u67e5\u8be2\uff0c\u6784\u9020\u672c\u8eab$\\mathcal{O}(1)$\u3002</p>\n</details>\n<p><strong>\u4e60\u989818.3</strong> (Dequantization\u57fa\u7840)\n\u8003\u8651\u77e9\u9635$\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$\uff0c\u79e9\u4e3a$k$\u3002\u8bbe\u8ba1\u57fa\u4e8e\u91c7\u6837\u7684\u7b97\u6cd5\u4f30\u8ba1$|\\mathbf{A}\\mathbf{x}|^2$\uff0c\u5176\u4e2d$\\mathbf{x}$\u662f\u7ed9\u5b9a\u5411\u91cf\u3002\n(a) \u63cf\u8ff0\u91cd\u8981\u6027\u91c7\u6837\u7b56\u7565\n(b) \u5206\u6790\u9700\u8981\u7684\u91c7\u6837\u6570\u91cf\u4ee5\u8fbe\u5230$(1\u00b1\\epsilon)$-\u8fd1\u4f3c\n(c) \u4e0e\u76f4\u63a5\u8ba1\u7b97\u76f8\u6bd4\uff0c\u4f55\u65f6\u6709\u4f18\u52bf\uff1f</p>\n<p><em>Hint</em>: \u4f7f\u7528\u884c\u8303\u6570\u4f5c\u4e3a\u91c7\u6837\u6982\u7387\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) \u91c7\u6837\u6982\u7387$p_i = |\\mathbf{A}_{i,:}|^2/|\\mathbf{A}|_F^2$\uff0c\u4f30\u8ba1\u91cf$\\tilde{y} = \\frac{|\\mathbf{A}|_F^2}{s}\\sum_{j=1}^s \\frac{(\\mathbf{A}_{i_j,:}\\mathbf{x})^2}{p_{i_j}}$</p>\n<p>(b) \u7531Hoeffding\u4e0d\u7b49\u5f0f\uff0c\u9700\u8981$s = \\mathcal{O}(\\epsilon^{-2}\\log(1/\\delta))$\u4e2a\u6837\u672c</p>\n<p>(c) \u5f53$m \\gg \\epsilon^{-2}\\log(1/\\delta)$\u4e14\u53ef\u4ee5\u9884\u5904\u7406\u8ba1\u7b97\u884c\u8303\u6570\u65f6\u6709\u4f18\u52bf</p>\n</details>\n<p><strong>\u4e60\u989818.4</strong> (\u91cf\u5b50\u6838\u8ba1\u7b97)\n\u8bbe\u8ba1\u7b97\u6cd5\u8ba1\u7b97\u4e24\u4e2a\u6570\u636e\u70b9\u7684\u91cf\u5b50\u6838$K(x,x') = |\\langle\\phi(x)|\\phi(x')\\rangle|^2$\uff0c\u5176\u4e2d$|\\phi(x)\\rangle$\u662f\u901a\u8fc7\u53c2\u6570\u5316\u91cf\u5b50\u7535\u8def\u751f\u6210\u7684$n$-qubit\u6001\u3002\n(a) \u5982\u679c\u7535\u8def\u6df1\u5ea6\u4e3a$d$\uff0c\u5206\u6790\u7ecf\u5178\u6a21\u62df\u7684\u590d\u6742\u5ea6\n(b) \u4f7f\u7528MPS\u8fd1\u4f3c\u65f6\uff0c\u5982\u4f55\u9009\u62e9bond dimension\uff1f\n(c) \u8bbe\u8ba1\u9ad8\u6548\u7684\u68af\u5ea6\u8ba1\u7b97\u65b9\u6cd5</p>\n<p><em>Hint</em>: \u5229\u7528\u7535\u8def\u7684\u5c40\u90e8\u6027\u548c\u53c2\u6570\u79fb\u4f4d\u89c4\u5219\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) \u5b8c\u6574\u6a21\u62df\uff1a$\\mathcal{O}(2^n d)$\uff1b\u5229\u7528\u7535\u8def\u7ed3\u6784\u53ef\u80fd\u964d\u81f3$\\mathcal{O}(\\text{poly}(n)d)$</p>\n<p>(b) Bond dimension\u9009\u62e9\u4f9d\u8d56\u4e8e\u7535\u8def\u4ea7\u751f\u7684\u7ea0\u7f20\u71b5\uff0c\u5178\u578b\u503c$r = \\mathcal{O}(\\text{poly}(d))$</p>\n<p>(c) \u53c2\u6570\u79fb\u4f4d\uff1a$\\partial_\\theta K = K(\\theta + \\pi/2) - K(\\theta - \\pi/2)$\uff0c\u590d\u7528\u4e2d\u95f4\u8ba1\u7b97\u7ed3\u679c</p>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u989818.5</strong> (\u9ad8\u7ea7TT\u7b97\u6cd5\u8bbe\u8ba1)\n\u8bbe\u8ba1\u7b97\u6cd5\u89e3\u51b3\u5982\u4e0b\u95ee\u9898\uff1a\u7ed9\u5b9aTT\u683c\u5f0f\u7684\u77e9\u9635$\\mathbf{A}$\u548c\u5411\u91cf$\\mathbf{b}$\uff0c\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf$\\mathbf{A}\\mathbf{x} = \\mathbf{b}$\uff0c\u5176\u4e2d\u89e3$\\mathbf{x}$\u4e5f\u8981\u6c42\u4ee5TT\u683c\u5f0f\u8f93\u51fa\u3002\n(a) \u63d0\u51fa\u57fa\u4e8e\u4f18\u5316\u7684\u6c42\u89e3\u6846\u67b6\n(b) \u5206\u6790\u7b97\u6cd5\u7684\u6536\u655b\u6027\n(c) \u8ba8\u8bba\u5982\u4f55\u81ea\u9002\u5e94\u5730\u8c03\u6574TT\u79e9\n(d) \u6bd4\u8f83\u4e0e\u4f20\u7edfKrylov\u65b9\u6cd5\u7684\u4f18\u52a3</p>\n<p><em>Hint</em>: \u8003\u8651\u5728TT\u6d41\u5f62\u4e0a\u7684\u4f18\u5316\u95ee\u9898\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) \u6700\u5c0f\u5316$|\\mathbf{A}\\mathbf{x} - \\mathbf{b}|^2$\u5728TT\u6d41\u5f62\u4e0a\uff0c\u4f7f\u7528Riemannian\u4f18\u5316\u6216\u4ea4\u66ff\u6700\u5c0f\u5316</p>\n<p>(b) \u6536\u655b\u6027\u4f9d\u8d56\u4e8e$\\mathbf{A}$\u7684\u6761\u4ef6\u6570\u548c\u89e3\u7684TT\u79e9\u3002\u5c40\u90e8\u7ebf\u6027\u6536\u655b\u7387\u7ea6\u4e3a$(1-1/\\kappa)$</p>\n<p>(c) \u76d1\u63a7\u6b8b\u5dee\u4e0b\u964d\u7387\uff0c\u5f53\u505c\u6ede\u65f6\u589e\u52a0\u79e9\uff1b\u4f7f\u7528SVD\u622a\u65ad\u63a7\u5236\u8fc7\u62df\u5408</p>\n<p>(d) TT\u65b9\u6cd5\uff1a\u5185\u5b58$\\mathcal{O}(nr^2\\log n)$\uff0c\u9002\u5408\u9ad8\u7ef4\uff1bKrylov\u65b9\u6cd5\uff1a\u66f4\u9c81\u68d2\uff0c\u9002\u5408\u4e2d\u7b49\u89c4\u6a21</p>\n</details>\n<p><strong>\u4e60\u989818.6</strong> (\u91cf\u5b50\u4f18\u52bf\u7684\u4e25\u683c\u5206\u6790)\n\u8003\u8651\u4ee5\u4e0b\u91c7\u6837\u95ee\u9898\uff1a\u7ed9\u5b9a\u63cf\u8ff0\u91cf\u5b50\u7535\u8def$C$\uff0c\u4ece\u8f93\u51fa\u5206\u5e03\u4e2d\u91c7\u6837\u3002\n(a) \u8bc1\u660e\u67d0\u4e9b\u7535\u8def\u65cf\u7684\u7ecf\u5178\u6a21\u62df\u9700\u8981\u6307\u6570\u65f6\u95f4\uff08\u5047\u8bbe\u5408\u7406\u7684\u590d\u6742\u5ea6\u5047\u8bbe\uff09\n(b) \u8bc6\u522b\u4f7f\u95ee\u9898\u53d8\u5f97\u7ecf\u5178\u6613\u5904\u7406\u7684\u7535\u8def\u7279\u5f81\n(c) \u8bbe\u8ba1\u7b97\u6cd5\u68c0\u6d4b\u7ed9\u5b9a\u7535\u8def\u662f\u5426\u53ef\u9ad8\u6548\u7ecf\u5178\u6a21\u62df\n(d) \u63a2\u8ba8\u566a\u58f0\u5982\u4f55\u5f71\u54cd\u91cf\u5b50\u4f18\u52bf</p>\n<p><em>Hint</em>: \u8003\u8651Random Circuit Sampling\u548c\u76f8\u5173\u590d\u6742\u5ea6\u7ed3\u679c\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) \u5229\u7528Random Circuit Sampling\u7684#P-\u56f0\u96be\u6027\u7ed3\u679c\uff0c\u57fa\u4e8eAverage-case hardness</p>\n<p>(b) \u53ef\u9ad8\u6548\u6a21\u62df\u7684\u7279\u5f81\uff1a\u4f4e\u7ea0\u7f20\u71b5\u3001Clifford\u95e8\u4e3b\u5bfc\u3001\u7279\u5b9a\u5bf9\u79f0\u6027\u3001\u4f4e\u6df1\u5ea6</p>\n<p>(c) \u68c0\u67e5\uff1a\u95e8\u96c6\u5408\u7c7b\u578b\u3001\u7ea0\u7f20\u7ed3\u6784\u3001\u5149\u9525\u5927\u5c0f\u3001\u7a33\u5b9a\u5b50\u79e9</p>\n<p>(d) \u566a\u58f0\u4f7f\u5206\u5e03\u63a5\u8fd1\u5747\u5300\uff0c\u964d\u4f4e\u91c7\u6837\u56f0\u96be\u5ea6\u3002\u9519\u8bef\u7387$p$\u4e0b\uff0c\u4f18\u52bf\u5728\u6df1\u5ea6$d \\sim 1/p$\u65f6\u6d88\u5931</p>\n</details>\n<p><strong>\u4e60\u989818.7</strong> (Dequantization\u7684\u6781\u9650)\n\u7814\u7a76Dequantization\u6280\u672f\u7684\u7406\u8bba\u6781\u9650\u3002\n(a) \u6784\u9020\u4e00\u4e2a\u77e9\u9635\u95ee\u9898\uff0c\u5176\u4e2d\u91cf\u5b50\u7b97\u6cd5\u6709\u53ef\u8bc1\u660e\u7684\u6307\u6570\u52a0\u901f\n(b) \u5206\u6790\u54ea\u4e9b\u95ee\u9898\u7279\u5f81\u4f7f\u5f97Dequantization\u5931\u6548\n(c) \u8bbe\u8ba1\u6df7\u5408\u91cf\u5b50-\u7ecf\u5178\u7b97\u6cd5\uff0c\u7ed3\u5408\u4e24\u8005\u4f18\u52bf\n(d) \u63a2\u8ba8\u8f93\u5165\u6a21\u578b\u5bf9\u590d\u6742\u5ea6\u7684\u5f71\u54cd</p>\n<p><em>Hint</em>: \u8003\u8651Fourier Sampling\u548cHidden Subgroup\u95ee\u9898\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) HSP for non-abelian groups\uff0c\u5982\u4e8c\u9762\u4f53\u7fa4\uff0c\u5df2\u77e5\u65e0\u9ad8\u6548\u7ecf\u5178\u7b97\u6cd5</p>\n<p>(b) \u5931\u6548\u7279\u5f81\uff1a\u9700\u8981\u5168\u5c40\u76f8\u5e72\u6027\u3001\u9ad8\u5ea6\u7ea0\u7f20\u7684\u4e2d\u95f4\u6001\u3001\u6307\u6570\u7ea7\u7cbe\u5ea6\u8981\u6c42</p>\n<p>(c) \u6df7\u5408\u7b56\u7565\uff1a\u7ecf\u5178\u9884\u5904\u7406+\u91cf\u5b50\u6838\u5fc3\u8ba1\u7b97+\u7ecf\u5178\u540e\u5904\u7406\uff0c\u5982VQE\u7b97\u6cd5</p>\n<p>(d) \u91cf\u5b50\u8f93\u5165\uff08\u53e0\u52a0\u6001\uff09vs\u7ecf\u5178\u8f93\u5165\uff08\u8ba1\u7b97\u57fa\uff09\u53ef\u5bfc\u81f4\u6307\u6570\u7ea7\u5dee\u8ddd</p>\n</details>\n<p><strong>\u4e60\u989818.8</strong> (\u524d\u6cbf\u5e94\u7528\u8bbe\u8ba1)\n\u8bbe\u8ba1\u4e00\u4e2a\u7ed3\u5408\u5f20\u91cf\u7f51\u7edc\u548c\u673a\u5668\u5b66\u4e60\u7684\u521b\u65b0\u5e94\u7528\u3002\n(a) \u63d0\u51fa\u5177\u4f53\u95ee\u9898\u548c\u89e3\u51b3\u65b9\u6848\n(b) \u5206\u6790\u7406\u8bba\u6027\u80fd\n(c) \u8ba8\u8bba\u5b9e\u73b0\u6311\u6218\n(d) \u8bc4\u4f30\u4e0e\u73b0\u6709\u65b9\u6cd5\u7684\u6bd4\u8f83\n(e) \u6307\u51fa\u672a\u6765\u7814\u7a76\u65b9\u5411</p>\n<p><em>Hint</em>: \u8003\u8651\u7ed3\u6784\u5316\u6570\u636e\u3001\u7269\u7406\u7ea6\u675f\u6216\u591a\u6a21\u6001\u5b66\u4e60\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u793a\u4f8b\u65b9\u6848\uff1a\u7528\u4e8e\u5206\u5b50\u6027\u8d28\u9884\u6d4b\u7684\u5f20\u91cf\u7f51\u7edc\u56fe\u795e\u7ecf\u7f51\u7edc</p>\n<p>(a) \u5c06\u5206\u5b50\u8868\u793a\u4e3a\u5f20\u91cf\u7f51\u7edc\uff0c\u5316\u5b66\u952e\u4e3atensor\uff0c\u539f\u5b50\u4e3a\u7269\u7406\u6307\u6807</p>\n<p>(b) \u8868\u8fbe\u80fd\u529b\u968fbond dimension\u6307\u6570\u589e\u957f\uff1b\u8ba1\u7b97\u590d\u6742\u5ea6$\\mathcal{O}(E r^3)$\uff0c$E$\u4e3a\u8fb9\u6570</p>\n<p>(c) \u5b9e\u73b0\u6311\u6218\uff1a\u5927\u5206\u5b50\u7684\u6536\u7f29\u987a\u5e8f\u4f18\u5316\u3001\u68af\u5ea6\u6d88\u5931\u3001\u5316\u5b66\u5148\u9a8c\u7684\u7f16\u7801</p>\n<p>(d) \u4f18\u52bf\uff1a\u81ea\u7136\u7f16\u7801\u591a\u4f53\u76f8\u4e92\u4f5c\u7528\u3001\u53c2\u6570\u6548\u7387\u9ad8\u3001\u53ef\u89e3\u91ca\u6027\u5f3a</p>\n<p>(e) \u672a\u6765\u65b9\u5411\uff1a\u81ea\u9002\u5e94\u7f51\u7edc\u7ed3\u6784\u3001\u4e0e\u91cf\u5b50\u5316\u5b66\u65b9\u6cd5\u7ed3\u5408\u3001\u8fc1\u79fb\u5b66\u4e60</p>\n</details>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<h3 id=\"_5\">\u5f20\u91cf\u7f51\u7edc\u76f8\u5173</h3>\n<ol>\n<li>\n<p><strong>Bond dimension\u9009\u62e9</strong>\n   - \u274c \u9519\u8bef\uff1a\u76f2\u76ee\u4f7f\u7528\u5927\u7684bond dimension\n   - \u2705 \u6b63\u786e\uff1a\u57fa\u4e8e\u5947\u5f02\u503c\u8c31\u81ea\u9002\u5e94\u9009\u62e9\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u76d1\u63a7\u622a\u65ad\u8bef\u5dee\u7d2f\u79ef</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\n   - \u274c \u9519\u8bef\uff1a\u5ffd\u89c6\u6b63\u4ea4\u5316\u7684\u91cd\u8981\u6027\n   - \u2705 \u6b63\u786e\uff1a\u4fdd\u6301canonical form\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u5b9a\u671f\u91cd\u6b63\u4ea4\u5316</p>\n</li>\n<li>\n<p><strong>\u6536\u7f29\u987a\u5e8f</strong>\n   - \u274c \u9519\u8bef\uff1a\u968f\u610f\u9009\u62e9\u5f20\u91cf\u6536\u7f29\u987a\u5e8f\n   - \u2705 \u6b63\u786e\uff1a\u4f18\u5316\u6536\u7f29\u8def\u5f84\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u6216\u542f\u53d1\u5f0f\u7b97\u6cd5</p>\n</li>\n</ol>\n<h3 id=\"_6\">\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u76f8\u5173</h3>\n<ol start=\"4\">\n<li>\n<p><strong>\u91c7\u6837\u590d\u6742\u5ea6</strong>\n   - \u274c \u9519\u8bef\uff1a\u4f4e\u4f30\u6240\u9700\u91c7\u6837\u6570\n   - \u2705 \u6b63\u786e\uff1a\u8003\u8651\u6761\u4ef6\u6570\u548c\u7cbe\u5ea6\u8981\u6c42\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u81ea\u9002\u5e94\u91c7\u6837\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u7ecf\u5178\u9884\u5904\u7406\u5f00\u9500</strong>\n   - \u274c \u9519\u8bef\uff1a\u5ffd\u89c6\u6570\u636e\u7ed3\u6784\u6784\u5efa\u65f6\u95f4\n   - \u2705 \u6b63\u786e\uff1a\u644a\u9500\u5206\u6790\u603b\u590d\u6742\u5ea6\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u589e\u91cf\u66f4\u65b0\u800c\u975e\u91cd\u5efa</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u4f18\u52bf\u7684\u8bef\u89e3</strong>\n   - \u274c \u9519\u8bef\uff1a\u8ba4\u4e3a\u6240\u6709\u91cf\u5b50\u7b97\u6cd5\u90fd\u6709\u6307\u6570\u52a0\u901f\n   - \u2705 \u6b63\u786e\uff1a\u5177\u4f53\u95ee\u9898\u5177\u4f53\u5206\u6790\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u5173\u6ce8\u95ee\u9898\u7ed3\u6784\u548c\u8f93\u5165\u6a21\u578b</p>\n</li>\n</ol>\n<h3 id=\"_7\">\u5b9e\u73b0\u76f8\u5173</h3>\n<ol start=\"7\">\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406</strong>\n   - \u274c \u9519\u8bef\uff1a\u5b58\u50a8\u5b8c\u6574\u5f20\u91cf\u540e\u518d\u5206\u89e3\n   - \u2705 \u6b63\u786e\uff1a\u76f4\u63a5\u5728\u538b\u7f29\u683c\u5f0f\u4e0a\u64cd\u4f5c\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u6d41\u5f0f\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u9677\u9631</strong>\n   - \u274c \u9519\u8bef\uff1a\u7ec6\u7c92\u5ea6\u5e76\u884c\u5316\u5f20\u91cf\u64cd\u4f5c\n   - \u2705 \u6b63\u786e\uff1a\u5728\u5408\u9002\u7684\u7c92\u5ea6\u5e76\u884c\n   - \ud83d\udca1 \u6280\u5de7\uff1a\u5229\u7528\u5f20\u91cf\u7f51\u7edc\u7684\u5c40\u90e8\u6027</p>\n</li>\n</ol>\n<h3 id=\"_8\">\u8c03\u8bd5\u6280\u5de7</h3>\n<ol>\n<li>\n<p><strong>\u9a8c\u8bc1\u6b63\u786e\u6027</strong>\uff1a\n   - \u5c0f\u89c4\u6a21\u7cbe\u786e\u8ba1\u7b97\u5bf9\u6bd4\n   - \u68c0\u67e5\u7269\u7406\u91cf\u5b88\u6052\uff08\u5982\u8303\u6570\uff09\n   - \u5355\u5143\u6d4b\u8bd5\u5173\u952e\u7ec4\u4ef6</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u5206\u6790</strong>\uff1a\n   - Profile\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\n   - \u76d1\u63a7\u7f13\u5b58\u547d\u4e2d\u7387\n   - \u6d4b\u91cf\u5b9e\u9645\u52a0\u901f\u6bd4</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u95ee\u9898\u8bca\u65ad</strong>\uff1a\n   - \u68c0\u67e5\u6761\u4ef6\u6570\u53d8\u5316\n   - \u76d1\u63a7\u5947\u5f02\u503c\u8c31\n   - \u4f7f\u7528\u9ad8\u7cbe\u5ea6\u9a8c\u8bc1</p>\n</li>\n</ol>\n<h2 id=\"_9\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_10\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5206\u6790\u95ee\u9898\u662f\u5426\u9002\u5408\u91cf\u5b50\u542f\u53d1\u65b9\u6cd5</li>\n<li>[ ] \u4f4e\u79e9\u7ed3\u6784\uff1f</li>\n<li>[ ] \u5c40\u90e8\u76f8\u4e92\u4f5c\u7528\uff1f</li>\n<li>\n<p>[ ] \u91c7\u6837\u53cb\u597d\uff1f</p>\n</li>\n<li>\n<p>[ ] \u9009\u62e9\u5408\u9002\u7684\u5f20\u91cf\u7f51\u7edc\u7ed3\u6784</p>\n</li>\n<li>[ ] MPS/TT for 1D\u7ed3\u6784</li>\n<li>[ ] PEPS for 2D\u7ed3\u6784</li>\n<li>\n<p>[ ] Tree tensor network for\u5c42\u6b21\u7ed3\u6784</p>\n</li>\n<li>\n<p>[ ] \u8bbe\u8ba1\u8bef\u5dee\u63a7\u5236\u7b56\u7565</p>\n</li>\n<li>[ ] \u622a\u65ad\u8bef\u5dee\u754c</li>\n<li>[ ] \u91c7\u6837\u8bef\u5dee\u4f30\u8ba1</li>\n<li>[ ] \u603b\u8bef\u5dee\u9884\u7b97\u5206\u914d</li>\n</ul>\n<h3 id=\"_11\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6570\u636e\u7ed3\u6784\u9009\u62e9</li>\n<li>[ ] \u7a00\u758f\u5f20\u91cf\u5b58\u50a8</li>\n<li>[ ] \u7d22\u5f15\u4f18\u5316</li>\n<li>\n<p>[ ] \u5185\u5b58\u5e03\u5c40</p>\n</li>\n<li>\n<p>[ ] \u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u8bc1</p>\n</li>\n<li>[ ] \u6b63\u4ea4\u5316\u7b56\u7565</li>\n<li>[ ] \u6761\u4ef6\u6570\u76d1\u63a7</li>\n<li>\n<p>[ ] \u6ea2\u51fa\u4fdd\u62a4</p>\n</li>\n<li>\n<p>[ ] \u6027\u80fd\u4f18\u5316</p>\n</li>\n<li>[ ] \u5411\u91cf\u5316\u5173\u952e\u5faa\u73af</li>\n<li>[ ] \u7f13\u5b58\u53cb\u597d\u7684\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>[ ] \u9002\u5f53\u7684\u5e76\u884c\u7c92\u5ea6</li>\n</ul>\n<h3 id=\"_12\">\u6d4b\u8bd5\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6b63\u786e\u6027\u9a8c\u8bc1</li>\n<li>[ ] \u4e0e\u5df2\u77e5\u7ed3\u679c\u5bf9\u6bd4</li>\n<li>[ ] \u6781\u9650\u60c5\u51b5\u6d4b\u8bd5</li>\n<li>\n<p>[ ] \u968f\u673a\u6d4b\u8bd5</p>\n</li>\n<li>\n<p>[ ] \u6027\u80fd\u57fa\u51c6</p>\n</li>\n<li>[ ] \u4e0d\u540c\u95ee\u9898\u89c4\u6a21</li>\n<li>[ ] \u4e0e\u7ecf\u5178\u65b9\u6cd5\u5bf9\u6bd4</li>\n<li>\n<p>[ ] \u6269\u5c55\u6027\u5206\u6790</p>\n</li>\n<li>\n<p>[ ] \u9c81\u68d2\u6027\u6d4b\u8bd5</p>\n</li>\n<li>[ ] \u566a\u58f0\u6570\u636e</li>\n<li>[ ] \u75c5\u6001\u6761\u4ef6</li>\n<li>[ ] \u8fb9\u754c\u60c5\u51b5</li>\n</ul>\n<h3 id=\"_13\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6587\u6863\u5b8c\u5907</li>\n<li>[ ] \u7b97\u6cd5\u5047\u8bbe</li>\n<li>[ ] \u53c2\u6570\u9009\u62e9\u6307\u5357</li>\n<li>\n<p>[ ] \u6027\u80fd\u7279\u5f81</p>\n</li>\n<li>\n<p>[ ] \u76d1\u63a7\u8bbe\u7f6e</p>\n</li>\n<li>[ ] \u6536\u655b\u8bca\u65ad</li>\n<li>[ ] \u8d44\u6e90\u4f7f\u7528</li>\n<li>\n<p>[ ] \u9519\u8bef\u7387</p>\n</li>\n<li>\n<p>[ ] \u7ef4\u62a4\u8ba1\u5212</p>\n</li>\n<li>[ ] \u66f4\u65b0\u7b56\u7565</li>\n<li>[ ] \u5411\u540e\u517c\u5bb9</li>\n<li>[ ] \u6027\u80fd\u56de\u5f52\u6d4b\u8bd5</li>\n</ul>\n<h3 id=\"_14\">\u7814\u7a76\u65b9\u5411\u8bc4\u4f30</h3>\n<ul>\n<li>[ ] \u521b\u65b0\u6027</li>\n<li>[ ] \u65b0\u7b97\u6cd5\uff1f</li>\n<li>[ ] \u65b0\u5e94\u7528\uff1f</li>\n<li>\n<p>[ ] \u7406\u8bba\u7a81\u7834\uff1f</p>\n</li>\n<li>\n<p>[ ] \u5b9e\u7528\u6027</p>\n</li>\n<li>[ ] \u771f\u5b9e\u95ee\u9898\uff1f</li>\n<li>[ ] \u53ef\u6269\u5c55\uff1f</li>\n<li>\n<p>[ ] \u7ade\u4e89\u529b\uff1f</p>\n</li>\n<li>\n<p>[ ] \u53ef\u53d1\u5c55\u6027</p>\n</li>\n<li>[ ] \u5f00\u653e\u95ee\u9898</li>\n<li>[ ] \u6539\u8fdb\u7a7a\u95f4</li>\n<li>[ ] \u4ea4\u53c9\u9886\u57df</li>\n</ul>"
  },
  "../chapter8.md": {
    "hash": "d43bd2ce882ac6a24c9086056dd06f95",
    "content": "<h1 id=\"8\">\u7b2c8\u7ae0\uff1a\u5206\u5e03\u5f0f\u77e9\u9635\u8fd0\u7b97</h1>\n<p>\u5728\u73b0\u4ee3\u673a\u5668\u5b66\u4e60\u548c\u79d1\u5b66\u8ba1\u7b97\u4e2d\uff0c\u6570\u636e\u89c4\u6a21\u7684\u7206\u70b8\u6027\u589e\u957f\u4f7f\u5f97\u5355\u673a\u8ba1\u7b97\u53d8\u5f97\u4e0d\u518d\u53ef\u884c\u3002\u5f53\u77e9\u9635\u7ef4\u5ea6\u8fbe\u5230\u767e\u4e07\u751a\u81f3\u5341\u4ebf\u7ea7\u522b\u65f6\uff0c\u5206\u5e03\u5f0f\u8ba1\u7b97\u6210\u4e3a\u5fc5\u7136\u9009\u62e9\u3002\u7136\u800c\uff0c\u7b80\u5355\u5730\u5c06\u4e32\u884c\u7b97\u6cd5\u5e76\u884c\u5316\u5f80\u5f80\u4f1a\u9047\u5230\u4e25\u91cd\u7684\u901a\u4fe1\u74f6\u9888\u3001\u540c\u6b65\u5f00\u9500\u548c\u5bb9\u9519\u6311\u6218\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5206\u5e03\u5f0f\u77e9\u9635\u8fd0\u7b97\u7684\u6570\u5b66\u57fa\u7840\u4e0e\u7b97\u6cd5\u8bbe\u8ba1\uff0c\u91cd\u70b9\u5173\u6ce8\u901a\u4fe1\u6548\u7387\u3001\u6536\u655b\u6027\u4fdd\u8bc1\u548c\u9c81\u68d2\u6027\u3002\u6211\u4eec\u5c06\u770b\u5230\uff0c\u4f18\u79c0\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\u4e0d\u4ec5\u4ec5\u662f\u5e76\u884c\u5316\uff0c\u66f4\u9700\u8981\u4ece\u6839\u672c\u4e0a\u91cd\u65b0\u601d\u8003\u7b97\u6cd5\u8bbe\u8ba1\u3002</p>\n<h2 id=\"81\">8.1 \u901a\u4fe1\u9ad8\u6548\u7684\u77e9\u9635\u5206\u89e3</h2>\n<p>\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u6838\u5fc3\u6311\u6218\u5728\u4e8e\u901a\u4fe1\u5f00\u9500\u5f80\u5f80\u4e3b\u5bfc\u4e86\u603b\u4f53\u8fd0\u884c\u65f6\u95f4\u3002\u5bf9\u4e8e\u77e9\u9635\u8fd0\u7b97\uff0c\u5173\u952e\u5728\u4e8e\u5982\u4f55\u5212\u5206\u6570\u636e\u548c\u8ba1\u7b97\uff0c\u4f7f\u5f97\u901a\u4fe1\u91cf\u6700\u5c0f\u5316\u7684\u540c\u65f6\u4fdd\u6301\u826f\u597d\u7684\u8d1f\u8f7d\u5747\u8861\u3002</p>\n<h3 id=\"811\">8.1.1 \u901a\u4fe1\u590d\u6742\u5ea6\u7684\u4e0b\u754c\u7406\u8bba</h3>\n<p>\u8003\u8651\u5728 $P$ \u4e2a\u5904\u7406\u5668\u4e0a\u8fdb\u884c\u77e9\u9635\u4e58\u6cd5 $\\mathbf{C} = \\mathbf{A}\\mathbf{B}$\uff0c\u5176\u4e2d $\\mathbf{A}, \\mathbf{B}, \\mathbf{C} \\in \\mathbb{R}^{n \\times n}$\u3002\u5047\u8bbe\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u5185\u5b58\u4e3a $M$\uff0cIrony\u7b49\u4eba\u8bc1\u660e\u4e86\u901a\u4fe1\u4e0b\u754c\uff1a</p>\n<p>$$W = \\Omega\\left(\\frac{n^3}{\\sqrt{PM}}\\right)$$\n\u8fd9\u4e2a\u4e0b\u754c\u544a\u8bc9\u6211\u4eec\uff0c\u65e0\u8bba\u91c7\u7528\u4f55\u79cd\u7b97\u6cd5\uff0c\u901a\u4fe1\u91cf\u90fd\u4e0d\u53ef\u80fd\u4f4e\u4e8e\u8fd9\u4e2a\u9608\u503c\u3002\u7c7b\u4f3c\u7684\u4e0b\u754c\u5b58\u5728\u4e8eLU\u5206\u89e3\u3001QR\u5206\u89e3\u7b49\u57fa\u7840\u8fd0\u7b97\u4e2d\u3002</p>\n<p><strong>\u4e0b\u754c\u7684\u63a8\u5bfc\u76f4\u89c9</strong>\uff1a</p>\n<ul>\n<li>\u77e9\u9635\u4e58\u6cd5\u9700\u8981 $O(n^3)$ \u6b21\u6807\u91cf\u8fd0\u7b97</li>\n<li>\u6bcf\u4e2a\u5904\u7406\u5668\u6700\u591a\u5b58\u50a8 $M$ \u4e2a\u77e9\u9635\u5143\u7d20</li>\n<li>\u91cd\u7528\u6570\u636e\u7684\u80fd\u529b\u53d7\u9650\u4e8e\u5185\u5b58\u5927\u5c0f</li>\n<li>\u4f7f\u7528Hong-Kung\u7684\u7ea2\u84dd\u5375\u77f3\u6e38\u620f\uff08red-blue pebble game\uff09\u53ef\u4ee5\u4e25\u683c\u8bc1\u660e</li>\n</ul>\n<p><strong>\u7ea2\u84dd\u5375\u77f3\u6e38\u620f\u7684\u6838\u5fc3\u601d\u60f3</strong>\uff1a</p>\n<ol>\n<li><strong>\u8ba1\u7b97\u56fe\u8868\u793a</strong>\uff1a\u5c06\u77e9\u9635\u8fd0\u7b97\u8868\u793a\u4e3a\u6709\u5411\u65e0\u73af\u56fe\uff08DAG\uff09\uff0c\u8282\u70b9\u4ee3\u8868\u6570\u636e\uff0c\u8fb9\u4ee3\u8868\u4f9d\u8d56\u5173\u7cfb</li>\n<li><strong>\u5375\u77f3\u89c4\u5219</strong>\uff1a\n   - \u7ea2\u5375\u77f3\uff1a\u8868\u793a\u5185\u5b58\u4e2d\u7684\u6570\u636e\uff08\u6700\u591a $M$ \u4e2a\uff09\n   - \u84dd\u5375\u77f3\uff1a\u8868\u793a\u9700\u8981\u4ece\u5176\u4ed6\u5904\u7406\u5668\u901a\u4fe1\u83b7\u5f97\u7684\u6570\u636e\n   - \u8ba1\u7b97\u89c4\u5219\uff1a\u53ea\u6709\u5f53\u8282\u70b9\u7684\u6240\u6709\u524d\u9a71\u90fd\u6709\u5375\u77f3\u65f6\uff0c\u624d\u80fd\u5728\u8be5\u8282\u70b9\u653e\u7f6e\u5375\u77f3</li>\n<li><strong>\u4e0b\u754c\u63a8\u5bfc</strong>\uff1a\n   - \u5b9a\u4e49\u8ba1\u7b97\u7684\"footprint\"\uff1a\u5728\u67d0\u4e2a\u65f6\u95f4\u6bb5\u5185\u8bbf\u95ee\u7684\u4e0d\u540c\u6570\u636e\u91cf\n   - Loomis-Whitney\u4e0d\u7b49\u5f0f\uff1a\u5bf9\u4e8e3D\u683c\u70b9\uff0c$|S|^3 \\leq |S_{xy}| \\cdot |S_{xz}| \\cdot |S_{yz}|$\n   - \u5e94\u7528\u5230\u77e9\u9635\u4e58\u6cd5\uff1a\u6bcf\u4e2a\u5904\u7406\u5668\u7684footprint\u81f3\u5c11\u4e3a $\\Omega(n^3/P)$</li>\n</ol>\n<p><strong>\u6269\u5c55\u5230\u4e00\u822c\u7ebf\u6027\u4ee3\u6570\u8fd0\u7b97</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u8ba1\u7b97 $2m$ \u4e2a $n \\times n$ \u77e9\u9635\u7684 $m$ \u4e2a\u4e58\u79ef\uff08\u5982 $\\mathbf{C}_1 = \\mathbf{A}_1\\mathbf{B}_1, ..., \\mathbf{C}_m = \\mathbf{A}_m\\mathbf{B}_m$\uff09\uff0c\u901a\u4fe1\u4e0b\u754c\u4e3a\uff1a\n$$W = \\Omega\\left(\\frac{mn^2}{\\sqrt{PM/m}}\\right)$$\n\u5f53 $m = 1$ \u65f6\u9000\u5316\u4e3a\u6807\u51c6\u77e9\u9635\u4e58\u6cd5\u7684\u4e0b\u754c\u3002</p>\n<p><strong>\u5176\u4ed6\u91cd\u8981\u8fd0\u7b97\u7684\u901a\u4fe1\u4e0b\u754c</strong>\uff1a</p>\n<ul>\n<li>LU\u5206\u89e3\uff1a$W = \\Omega(n^2/\\sqrt{P})$\uff08\u5047\u8bbe\u4f7f\u7528 $O(n^2/P)$ \u5185\u5b58\uff09</li>\n<li>Cholesky\u5206\u89e3\uff1a\u4e0eLU\u5206\u89e3\u76f8\u540c</li>\n<li>QR\u5206\u89e3\uff1a$W = \\Omega(n^2/\\sqrt{P})$</li>\n<li>\u7279\u5f81\u503c\u5206\u89e3\uff1a$W = \\Omega(n^2)$\uff08\u7531\u4e8e\u56fa\u6709\u7684\u6570\u636e\u4f9d\u8d56\u6027\uff09</li>\n<li>Krylov\u5b50\u7a7a\u95f4\u65b9\u6cd5\uff08$k$ \u6b65\uff09\uff1a$W = \\Omega(kn/\\sqrt{P})$</li>\n</ul>\n<p><strong>\u5185\u5b58-\u901a\u4fe1\u6743\u8861</strong>\uff1a</p>\n<p>\u589e\u52a0\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u5185\u5b58 $M$ \u53ef\u4ee5\u51cf\u5c11\u901a\u4fe1\uff0c\u4f46\u5b58\u5728\u57fa\u672c\u9650\u5236\u3002\u5b9a\u4e49\u6548\u7387\u6307\u6807\uff1a\n$$E = \\frac{\\text{\u8ba1\u7b97\u91cf}/P}{\\text{\u901a\u4fe1\u91cf} + \\text{\u8ba1\u7b97\u91cf}/P}$$\n\u5bf9\u4e8e\u77e9\u9635\u4e58\u6cd5\uff0c\u5f53 $M = \\Theta(n^2/P^{2/3})$ \u65f6\u53ef\u4ee5\u8fbe\u5230\u6700\u4f18\u6548\u7387 $E = \\Theta(1)$\u3002</p>\n<p><strong>\u5b9e\u9645\u610f\u4e49</strong>\uff1a</p>\n<ol>\n<li><strong>\u7b97\u6cd5\u8bbe\u8ba1\u6307\u5bfc</strong>\uff1a\u4efb\u4f55\u7b97\u6cd5\u90fd\u4e0d\u5e94\u671f\u671b\u7a81\u7834\u8fd9\u4e9b\u4e0b\u754c</li>\n<li><strong>\u5185\u5b58\u89c4\u5212</strong>\uff1a\u6839\u636e\u4e0b\u754c\u516c\u5f0f\u4f18\u5316\u5185\u5b58\u5206\u914d</li>\n<li><strong>\u5f31\u6269\u5c55\u6027\u5206\u6790</strong>\uff1a\u4fdd\u6301 $n^3/P$ \u56fa\u5b9a\u65f6\uff0c\u901a\u4fe1\u91cf\u589e\u957f\u4e3a $O(n^2) = O((n^3/P)^{2/3}P^{2/3})$</li>\n</ol>\n<p><strong>\u524d\u6cbf\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li><strong>\u80fd\u91cf\u4e0b\u754c</strong>\uff1a\u8003\u8651\u901a\u4fe1\u7684\u80fd\u91cf\u6d88\u8017\uff0c\u4e0d\u540c\u8ddd\u79bb\u7684\u901a\u4fe1\u80fd\u8017\u4e0d\u540c</li>\n<li><strong>I/O\u590d\u6742\u5ea6</strong>\uff1a\u6269\u5c55\u5230\u591a\u7ea7\u5b58\u50a8\u5c42\u6b21\uff08\u7f13\u5b58\u3001\u5185\u5b58\u3001\u78c1\u76d8\uff09</li>\n<li><strong>\u8fd1\u4f3c\u7b97\u6cd5\u7684\u4e0b\u754c</strong>\uff1a\u5141\u8bb8\u4e00\u5b9a\u8bef\u5dee\u65f6\u7684\u901a\u4fe1\u4e0b\u754c</li>\n<li><strong>\u91cf\u5b50\u901a\u4fe1\u4e0b\u754c</strong>\uff1a\u91cf\u5b50\u7ea0\u7f20\u662f\u5426\u80fd\u7a81\u7834\u7ecf\u5178\u4e0b\u754c</li>\n</ul>\n<h3 id=\"812-2d-block-cyclicsumma\">8.1.2 2D Block-Cyclic\u5206\u5e03\u4e0eSUMMA\u7b97\u6cd5</h3>\n<p>\u6700\u7ecf\u5178\u7684\u77e9\u9635\u5206\u5e03\u7b56\u7565\u662f2D block-cyclic\u5206\u5e03\u3002\u5c06\u77e9\u9635\u5212\u5206\u4e3a $\\sqrt{P} \\times \\sqrt{P}$ \u7684\u5904\u7406\u5668\u7f51\u683c\uff0c\u6bcf\u4e2a\u5904\u7406\u5668\u8d1f\u8d23\u591a\u4e2a\u5206\u6563\u7684\u5757\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u826f\u597d\u7684\u8d1f\u8f7d\u5747\u8861\u3002</p>\n<p><strong>Block-Cyclic\u5206\u5e03\u7684\u6570\u5b66\u63cf\u8ff0</strong>\uff1a</p>\n<p>\u7ed9\u5b9a\u5757\u5927\u5c0f $r \\times c$\uff0c\u5904\u7406\u5668\u7f51\u683c $P_r \\times P_c$\uff0c\u77e9\u9635\u5143\u7d20 $A_{ij}$ \u88ab\u5206\u914d\u7ed9\u5904\u7406\u5668 $(p, q)$\uff0c\u5176\u4e2d\uff1a\n$$p = \\left\\lfloor \\frac{i/r \\bmod P_r}{1} \\right\\rfloor, \\quad q = \\left\\lfloor \\frac{j/c \\bmod P_c}{1} \\right\\rfloor$$\n\u6bcf\u4e2a\u5904\u7406\u5668\u62e5\u6709\u7684\u5c40\u90e8\u77e9\u9635\u5927\u5c0f\u7ea6\u4e3a $\\lceil n/P_r \\rceil \\times \\lceil n/P_c \\rceil$\u3002</p>\n<p><strong>\u4e3a\u4ec0\u4e48\u9009\u62e9Block-Cyclic\u800c\u975e\u7b80\u5355Block\u5206\u5e03</strong>\uff1a</p>\n<ul>\n<li><strong>\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\u77e9\u9635\u8fd0\u7b97\u4e2d\u540e\u671f\u9636\u6bb5\u7684\u5de5\u4f5c\u91cf\u4e0d\u5747\u5300\uff08\u5982LU\u5206\u89e3\uff09</li>\n<li>LU\u5206\u89e3\u4e2d\uff0c\u968f\u7740\u6d88\u5143\u8fdb\u884c\uff0c\u6d3b\u8dc3\u533a\u57df\u9010\u6e10\u7f29\u5c0f\u5230\u53f3\u4e0b\u89d2</li>\n<li>Block-cyclic\u786e\u4fdd\u6240\u6709\u5904\u7406\u5668\u5728\u5404\u9636\u6bb5\u90fd\u6709\u5de5\u4f5c</li>\n<li><strong>\u53ef\u6269\u5c55\u6027</strong>\uff1a\u9002\u5e94\u4e0d\u540c\u7684\u77e9\u9635\u5927\u5c0f\u548c\u5904\u7406\u5668\u6570\u91cf</li>\n<li>\u5757\u5927\u5c0f\u53ef\u4ee5\u72ec\u7acb\u4e8e\u5904\u7406\u5668\u6570\u91cf\u9009\u62e9</li>\n<li>\u652f\u6301\u975e\u65b9\u5f62\u5904\u7406\u5668\u7f51\u683c</li>\n<li><strong>\u5c40\u90e8\u6027</strong>\uff1a\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u6570\u636e\u5c40\u90e8\u6027\u4ecd\u7136\u8f83\u597d</li>\n<li>\u8fde\u7eed\u7684 $r \\times c$ \u5757\u4fdd\u6301\u5728\u4e00\u8d77</li>\n<li>\u6709\u5229\u4e8ecache\u6027\u80fd\u548c\u5411\u91cf\u5316</li>\n</ul>\n<p><strong>ScaLAPACK\u4e2d\u7684\u5206\u5e03\u53c2\u6570</strong>\uff1a</p>\n<ul>\n<li><code>MB</code>, <code>NB</code>\uff1a\u5757\u7684\u884c\u6570\u548c\u5217\u6570</li>\n<li><code>RSRC</code>, <code>CSRC</code>\uff1a\u8d77\u59cb\u5904\u7406\u5668\u5750\u6807</li>\n<li><code>LLD</code>\uff1a\u5c40\u90e8\u77e9\u9635\u7684leading dimension</li>\n</ul>\n<p>SUMMA (Scalable Universal Matrix Multiplication Algorithm) \u57fa\u4e8e\u8fd9\u79cd\u5206\u5e03\u5b9e\u73b0\u4e86\u63a5\u8fd1\u6700\u4f18\u7684\u901a\u4fe1\u590d\u6742\u5ea6\uff1a</p>\n<p><strong>SUMMA\u7b97\u6cd5\u8be6\u7ec6\u6b65\u9aa4</strong>\uff1a</p>\n<ol>\n<li><strong>\u5916\u79ef\u5f62\u5f0f</strong>\uff1a$\\mathbf{C} = \\sum_{k=1}^{n} \\mathbf{a}_k \\mathbf{b}_k^T$</li>\n<li>\n<p><strong>\u5206\u5757\u7248\u672c</strong>\uff1a\u5c06 $k$ \u7ef4\u5ea6\u5206\u6210\u5927\u5c0f\u4e3a $b$ \u7684\u5757\n   ```\n   for kb = 0 to n-1 step b:\n       k_size = min(b, n - kb)\n       // \u6b65\u9aa4 1: \u884c\u5e7f\u64ad\n       if \u6211\u7684\u5904\u7406\u5668\u5217\u62e5\u6709 A[:, kb:kb+k_size]:\n           \u5728\u6211\u7684\u5904\u7406\u5668\u884c\u5185\u5e7f\u64ad A_local[:, kb:kb+k_size]</p>\n<p>// \u6b65\u9aa4 2: \u5217\u5e7f\u64ad<br />\n   if \u6211\u7684\u5904\u7406\u5668\u884c\u62e5\u6709 B[kb:kb+k_size, :]:\n       \u5728\u6211\u7684\u5904\u7406\u5668\u5217\u5185\u5e7f\u64ad B_local[kb:kb+k_size, :]</p>\n<p>// \u6b65\u9aa4 3: \u5c40\u90e8\u77e9\u9635\u4e58\u6cd5\n   C_local += A_broadcast \u00d7 B_broadcast\n   ```</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u91cf\u5206\u6790</strong>\uff1a\n   - \u6bcf\u4e2a\u5904\u7406\u5668\u63a5\u6536 $n/\\sqrt{P} \\times n$ \u7684 A \u6570\u636e\uff08\u6309\u5217\u5206\u5757\uff09\n   - \u6bcf\u4e2a\u5904\u7406\u5668\u63a5\u6536 $n \\times n/\\sqrt{P}$ \u7684 B \u6570\u636e\uff08\u6309\u884c\u5206\u5757\uff09\n   - \u603b\u901a\u4fe1\u91cf\uff1a$O(n^2/\\sqrt{P})$\uff0c\u8fbe\u5230\u7406\u8bba\u4e0b\u754c</p>\n</li>\n</ol>\n<p><strong>SUMMA\u7684\u4f18\u5316\u53d8\u4f53</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5e26\u5bbd\u4f18\u5316 - \u6d41\u6c34\u7ebf\u5e7f\u64ad</strong>\uff1a\n   - \u5c06\u5e7f\u64ad\u5206\u89e3\u4e3a\u591a\u4e2a\u5c0f\u6d88\u606f\n   - \u4f7f\u7528\u6811\u5f62\u6216\u4e8c\u9879\u5f0f\u6811\u5e7f\u64ad\u62d3\u6251\n   - \u51cf\u5c11\u5ef6\u8fdf\u5bf9\u5927\u6d88\u606f\u7684\u5f71\u54cd</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u4f18\u5316</strong>\uff1a\n   - \u5206\u5757\u5927\u5c0f $b$ \u7684\u9009\u62e9\u5f71\u54cdcache\u6027\u80fd\n   - \u4f18\u5316\u51c6\u5219\uff1a$3b^2 \\leq L$\uff08L\u662fcache\u5927\u5c0f\uff09\n   - \u5178\u578b\u9009\u62e9\uff1a$b = \\Theta(\\sqrt{M/3})$</p>\n</li>\n<li>\n<p><strong>\u91cd\u53e0\u4f18\u5316</strong>\uff1a\n   ```\n   \u4f7f\u7528\u53cc\u7f13\u51b2\u6280\u672f\uff1a\n   buffer_A[2][...], buffer_B[2][...]</p>\n</li>\n</ol>\n<p>for kb = 0 to n-1 step b:\n       curr = kb % 2\n       next = 1 - curr</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u5f02\u6b65\u5f00\u59cb\u4e0b\u4e00\u5757\u7684\u901a\u4fe1</span>\n<span class=\"w\">   </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">kb</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nl\">n</span><span class=\"p\">:</span>\n<span class=\"w\">       </span><span class=\"n\">MPI_Ibcast</span><span class=\"p\">(</span><span class=\"n\">buffer_A</span><span class=\"o\">[</span><span class=\"n\">next</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">...)</span>\n<span class=\"w\">       </span><span class=\"n\">MPI_Ibcast</span><span class=\"p\">(</span><span class=\"n\">buffer_B</span><span class=\"o\">[</span><span class=\"n\">next</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">...)</span>\n\n<span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u4f7f\u7528\u5f53\u524d\u5757\u8ba1\u7b97</span>\n<span class=\"w\">   </span><span class=\"n\">GEMM</span><span class=\"p\">(</span><span class=\"n\">buffer_A</span><span class=\"o\">[</span><span class=\"n\">curr</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">buffer_B</span><span class=\"o\">[</span><span class=\"n\">curr</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">C_local</span><span class=\"p\">)</span>\n\n<span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u7b49\u5f85\u4e0b\u4e00\u5757\u901a\u4fe1\u5b8c\u6210</span>\n<span class=\"w\">   </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">kb</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nl\">n</span><span class=\"p\">:</span>\n<span class=\"w\">       </span><span class=\"n\">MPI_Wait</span><span class=\"p\">(...)</span>\n</code></pre></div>\n\n<p>```</p>\n<p><strong>\u4e0e\u5176\u4ed6\u5e76\u884c\u77e9\u9635\u4e58\u6cd5\u7b97\u6cd5\u7684\u6bd4\u8f83</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Cannon\u7b97\u6cd5</strong>\uff1a\n   - \u521d\u59cb\u504f\u79fb\uff1a$A$ \u5411\u5de6\u5faa\u73af\u79fb\u4f4d $i$ \u6b65\uff0c$B$ \u5411\u4e0a\u5faa\u73af\u79fb\u4f4d $j$ \u6b65\n   - \u6bcf\u6b65\uff1a\u8ba1\u7b97\u5c40\u90e8\u4e58\u79ef\uff0c\u7136\u540e $A$ \u5de6\u79fb\uff0c$B$ \u4e0a\u79fb\n   - \u4f18\u70b9\uff1a\u6240\u6709\u901a\u4fe1\u90fd\u662f\u6700\u8fd1\u90bb\uff0c\u9002\u5408\u7f51\u683c\u62d3\u6251\n   - \u7f3a\u70b9\uff1a\u9700\u8981\u65b9\u5f62\u5904\u7406\u5668\u7f51\u683c\uff0c\u521d\u59cb\u5316\u590d\u6742</p>\n</li>\n<li>\n<p><strong>Fox\u7b97\u6cd5\uff08\u5e7f\u64ad\u4e58\u6cd5\u7b97\u6cd5\uff09</strong>\uff1a\n   - \u6bcf\u6b65\u5e7f\u64ad $A$ \u7684\u4e00\u4e2a\u5757\u5217\uff0c$B$ \u8fdb\u884c\u5217\u5faa\u73af\n   - \u901a\u4fe1\u6a21\u5f0f\u4e0eSUMMA\u7c7b\u4f3c\uff0c\u4f46\u5b9e\u73b0\u7ec6\u8282\u4e0d\u540c</p>\n</li>\n<li>\n<p><strong>3D\u7b97\u6cd5</strong>\uff1a\n   - \u4f7f\u7528 $P^{1/3} \\times P^{1/3} \\times P^{1/3}$ \u7684\u5904\u7406\u5668\u7f51\u683c\n   - \u53ef\u4ee5\u8fbe\u5230\u66f4\u4f4e\u7684\u901a\u4fe1\u91cf\uff1a$O(n^2/P^{2/3})$\n   - \u4ee3\u4ef7\u662f\u66f4\u590d\u6742\u7684\u6570\u636e\u5206\u5e03\u548c\u66f4\u591a\u7684\u5185\u5b58\u4f7f\u7528</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u6a21\u578b\u4e0e\u5206\u6790</strong>\uff1a</p>\n<p>SUMMA\u7684\u6267\u884c\u65f6\u95f4\u53ef\u4ee5\u5efa\u6a21\u4e3a\uff1a\n$$T = \\gamma \\frac{n^3}{P} + \\beta \\frac{n^2}{\\sqrt{P}} + \\alpha \\log P \\frac{n}{b}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\gamma$\uff1a\u6d6e\u70b9\u8fd0\u7b97\u65f6\u95f4</li>\n<li>$\\beta$\uff1a\u5e26\u5bbd\u7684\u5012\u6570</li>\n<li>$\\alpha$\uff1a\u5ef6\u8fdf</li>\n<li>\u7b2c\u4e09\u9879\u6765\u81ea $n/b$ \u6b21\u5e7f\u64ad\uff0c\u6bcf\u6b21 $O(\\log P)$ \u7684\u5ef6\u8fdf</li>\n</ul>\n<p><strong>SUMMA\u5728\u73b0\u4ee3\u7cfb\u7edf\u4e0a\u7684\u5b9e\u73b0\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>GPU\u52a0\u901f</strong>\uff1a\n   - \u4f7f\u7528cuBLAS\u6216rocBLAS\u8fdb\u884c\u5c40\u90e8GEMM\n   - NCCL\u8fdb\u884cGPU\u95f4\u901a\u4fe1\n   - GPUDirect RDMA\u51cf\u5c11CPU\u53c2\u4e0e</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u5e76\u884c</strong>\uff1a\n   - MPI\u5904\u7406\u8282\u70b9\u95f4\u901a\u4fe1\n   - OpenMP/CUDA\u5904\u7406\u8282\u70b9\u5185\u5e76\u884c\n   - \u4f18\u5316\u8282\u70b9\u5185\u7684NUMA\u6548\u5e94</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519SUMMA</strong>\uff1a\n   - \u4f7f\u7528\u6821\u9a8c\u548c\u77e9\u9635\uff1a$\\tilde{\\mathbf{A}} = [\\mathbf{A}; \\mathbf{e}^T\\mathbf{A}]$\n   - ABFT (Algorithm-Based Fault Tolerance) \u68c0\u6d4b\u548c\u7ea0\u6b63\u8f6f\u9519\u8bef\n   - \u5f00\u9500\u7ea65-10%\uff0c\u53ef\u68c0\u6d4b\u548c\u5b9a\u4f4d\u5355\u4e2a\u5904\u7406\u5668\u6545\u969c</p>\n</li>\n</ol>\n<h3 id=\"813-communication-avoiding\">8.1.3 Communication-Avoiding\u7b97\u6cd5</h3>\n<p>CA (Communication-Avoiding) \u7b97\u6cd5\u901a\u8fc7\u91cd\u7ec4\u8ba1\u7b97\u6765\u51cf\u5c11\u901a\u4fe1\u9891\u7387\u3002\u6838\u5fc3\u601d\u60f3\u662f\u5728\u5c40\u90e8\u8fdb\u884c\u66f4\u591a\u8ba1\u7b97\uff0c\u4ee5\u6362\u53d6\u901a\u4fe1\u6b21\u6570\u7684\u51cf\u5c11\u3002\u8fd9\u7c7b\u7b97\u6cd5\u7279\u522b\u9002\u5408\u73b0\u4ee3\u8ba1\u7b97\u73af\u5883\uff0c\u5176\u4e2d\u901a\u4fe1\u6210\u672c\u8fdc\u9ad8\u4e8e\u8ba1\u7b97\u6210\u672c\u3002</p>\n<p><strong>\u7406\u8bba\u57fa\u7840\uff1a\u901a\u4fe1\u4e0e\u8ba1\u7b97\u7684\u6743\u8861</strong></p>\n<p>\u5b9a\u4e49 $s$-\u6b65\u65b9\u6cd5\u7684\u6548\u7387\u6307\u6807\uff1a\n$$\\text{Efficiency} = \\frac{\\text{\u539f\u59cb\u7b97\u6cd5\u901a\u4fe1\u6b21\u6570}}{\\text{CA\u7b97\u6cd5\u901a\u4fe1\u6b21\u6570}} \\times \\frac{\\text{CA\u7b97\u6cd5\u8ba1\u7b97\u91cf}}{\\text{\u539f\u59cb\u7b97\u6cd5\u8ba1\u7b97\u91cf}}$$\n\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u901a\u4fe1\u51cf\u5c11 $s$ \u500d\uff0c\u8ba1\u7b97\u589e\u52a0\u4e0d\u8d85\u8fc7\u5e38\u6570\u500d\uff0c\u5b9e\u73b0\u8fd1 $s$ \u500d\u7684\u52a0\u901f\u3002</p>\n<p><strong>Tall-Skinny QR (TSQR)</strong>\uff1a\u5bf9\u4e8e $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ ($m \\gg n$)\uff1a</p>\n<p>\u4f20\u7edfHouseholder QR\u9700\u8981 $O(n)$ \u6b21\u540c\u6b65\uff0cTSQR\u5c06\u5176\u51cf\u5c11\u5230 $O(\\log P)$\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5e76\u884c\u5c40\u90e8QR\u5206\u89e3</strong>\uff1a\n   <code>\u5c06 A \u6309\u884c\u5206\u5757\uff1aA = [A\u2081\u1d40, A\u2082\u1d40, ..., A\u209a\u1d40]\u1d40\n   \u5e76\u884c\u8ba1\u7b97\uff1aA\u1d62 = Q\u1d62R\u1d62\uff0c\u5176\u4e2d Q\u1d62 \u2208 \u211d^(m\u1d62\u00d7n), R\u1d62 \u2208 \u211d^(n\u00d7n)</code></p>\n</li>\n<li>\n<p><strong>\u9012\u5f52\u5408\u5e76\uff08\u4e8c\u53c9\u6811reduction\uff09</strong>\uff1a\n   <code>Level 1: [R\u2081; R\u2082] = Q\u2081\u2082R\u2081\u2082, [R\u2083; R\u2084] = Q\u2083\u2084R\u2083\u2084, ...\n   Level 2: [R\u2081\u2082; R\u2083\u2084] = Q\u2081\u2082\u2083\u2084R\u2081\u2082\u2083\u2084, ...\n   ...\n   Level log P: \u5f97\u5230\u6700\u7ec8\u7684 R</code></p>\n</li>\n<li>\n<p><strong>\u91cd\u6784Q\u77e9\u9635</strong>\uff08\u5982\u9700\u8981\uff09\uff1a\n   <code>\u4ece\u53f6\u5230\u6839\u5e94\u7528\u6240\u6709\u7684Householder\u53d8\u6362\n   \u901a\u4fe1\u6a21\u5f0f\u4e0ereduction\u76f8\u53cd</code></p>\n</li>\n</ol>\n<p><strong>TSQR\u7684\u6570\u503c\u7a33\u5b9a\u6027\u5206\u6790</strong>\uff1a</p>\n<p>\u5b9a\u7406\uff1aTSQR\u4ea7\u751f\u7684 $\\mathbf{R}$ \u56e0\u5b50\u6ee1\u8db3\uff1a\n$$|\\mathbf{R}_{\\text{TSQR}} - \\mathbf{R}_{\\text{HouseQR}}|_F \\leq O(\\epsilon \\kappa(\\mathbf{A}) n^{3/2})$$\n\u6b63\u4ea4\u6027\u4fdd\u8bc1\uff1a\n$$|\\mathbf{Q}^T\\mathbf{Q} - \\mathbf{I}|_2 \\leq O(\\epsilon n \\log P)$$\n\u76f8\u6bd4\u4e4b\u4e0b\uff0cClassical Gram-Schmidt\u7684\u6b63\u4ea4\u6027\u8bef\u5dee\u4e3a $O(\\epsilon \\kappa(\\mathbf{A})^n)$\uff0c\u5728\u75c5\u6001\u95ee\u9898\u4e0a\u5dee\u5f02\u5de8\u5927\u3002</p>\n<p><strong>CA-Krylov\u5b50\u7a7a\u95f4\u65b9\u6cd5</strong></p>\n<p>\u6838\u5fc3\u601d\u60f3\uff1a\u4e00\u6b21\u8ba1\u7b97 $s$ \u4e2aKrylov\u57fa\u5411\u91cf\uff0c\u7136\u540e\u7edf\u4e00\u6b63\u4ea4\u5316\u3002</p>\n<p><strong>\u77e9\u9635\u5e42\u6838\uff08Matrix Powers Kernel\uff09</strong>\uff1a</p>\n<p>\u7ed9\u5b9a\u8d77\u59cb\u5411\u91cf $\\mathbf{v}$\uff0c\u8ba1\u7b97\uff1a\n$$[\\mathbf{v}, \\mathbf{A}\\mathbf{v}, \\mathbf{A}^2\\mathbf{v}, ..., \\mathbf{A}^{s-1}\\mathbf{v}]$$\n\u6734\u7d20\u65b9\u6cd5\u6570\u503c\u4e0d\u7a33\u5b9a\u3002\u7a33\u5b9a\u7684\u65b9\u6cd5\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>Newton\u57fa</strong>\uff1a\n$$\\mathbf{p}_0 = \\mathbf{v}, \\quad \\mathbf{p}_{j+1} = (\\mathbf{A} - \\theta_j\\mathbf{I})\\mathbf{p}_j$$\n\u5176\u4e2d $\\theta_j$ \u662fRitz\u503c\u7684\u4f30\u8ba1</p>\n</li>\n<li>\n<p><strong>Chebyshev\u57fa</strong>\uff1a\n$$\\mathbf{p}_0 = \\mathbf{v}, \\quad \\mathbf{p}_1 = \\frac{2}{\\beta-\\alpha}(\\mathbf{A} - \\frac{\\alpha+\\beta}{2}\\mathbf{I})\\mathbf{v}$$\n   $$\\mathbf{p}_{j+1} = \\frac{4}{\\beta-\\alpha}(\\mathbf{A} - \\frac{\\alpha+\\beta}{2}\\mathbf{I})\\mathbf{p}_j - \\mathbf{p}_{j-1}$$\n\u5176\u4e2d $[\\alpha, \\beta]$ \u5305\u542b $\\mathbf{A}$ \u7684\u8c31</p>\n</li>\n</ol>\n<p><strong>CA-GMRES\u8be6\u7ec6\u7b97\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1aA, b, s\uff08\u6b65\u6570\uff09\n1. r\u2080 = b - Ax\u2080, \u03b2 = \u2016r\u2080\u2016, v\u2081 = r\u2080/\u03b2\n2. for k = 0, s, 2s, ... until convergence:\n   // \u8ba1\u7b97s\u4e2a\u57fa\u5411\u91cf\n   3. [V\u2096, B\u2096] = MatrixPowers(A, v\u2096\u208a\u2081, s)\n   4. // B\u2096\u662f\u53d8\u57fa\u77e9\u9635\uff0c\u6ee1\u8db3AV\u2096 = V\u2096\u208a\u2081B\u2096\n\n   // \u6b63\u4ea4\u5316\uff08\u4f7f\u7528TSQR\uff09\n   5. [Q\u2096, R\u2096] = TSQR([V\u2096\u208a\u2081[:, 0], V\u2096])\n   6. H\u2096 = R\u2096\u208a\u2081[:s+1, 1:s+1]\u207b\u00b9 * R\u2096\u208a\u2081[:s+1, 0]\n\n   // \u6c42\u89e3\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898\n   7. y\u2096 = argmin \u2016\u03b2e\u2081 - H\u2096y\u2016\n   8. x\u2096\u208a\u209b = x\u2096 + V\u2096y\u2096\n</code></pre></div>\n\n<p><strong>CA-CG\uff08Communication-Avoiding Conjugate Gradient\uff09</strong>\uff1a</p>\n<p>\u6807\u51c6CG\u6bcf\u6b65\u9700\u89812\u6b21\u5185\u79ef\uff08\u5168\u5c40\u901a\u4fe1\uff09\uff0cCA-CG\u5c06 $s$ \u6b65\u7684 $2s$ \u6b21\u901a\u4fe1\u51cf\u5c11\u5230 $O(1)$ \u6b21\u3002</p>\n<p>\u5173\u952e\u6280\u672f\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5411\u91cf\u9012\u63a8\u7684\u77e9\u9635\u5316</strong>\uff1a\n$$[\\mathbf{p}_k, \\mathbf{p}_{k+1}, ..., \\mathbf{p}_{k+s-1}] = [\\mathbf{p}_k, \\mathbf{r}_k] \\mathbf{B}_k$$\n\u5176\u4e2d $\\mathbf{B}_k$ \u662f $2 \\times s$ \u7684\u7cfb\u6570\u77e9\u9635</p>\n</li>\n<li>\n<p><strong>Gram\u77e9\u9635\u9884\u8ba1\u7b97</strong>\uff1a\n$$\\mathbf{G}_k = \\begin{bmatrix}\n   \\mathbf{V}_k^T\\mathbf{V}_k &amp; \\mathbf{V}_k^T\\mathbf{A}\\mathbf{V}_k \\\n   (\\mathbf{A}\\mathbf{V}_k)^T\\mathbf{V}_k &amp; (\\mathbf{A}\\mathbf{V}_k)^T\\mathbf{A}\\mathbf{V}_k\n   \\end{bmatrix}$$\n\u4e00\u6b21\u901a\u4fe1\u8ba1\u7b97\u6240\u6709\u9700\u8981\u7684\u5185\u79ef</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u969c</strong>\uff1a\n   - \u6b8b\u5dee\u66ff\u6362\uff1a\u6bcf $s$ \u6b65\u663e\u5f0f\u8ba1\u7b97 $\\mathbf{r} = \\mathbf{b} - \\mathbf{A}\\mathbf{x}$\n   - \u81ea\u9002\u5e94 $s$\uff1a\u76d1\u63a7\u57fa\u5411\u91cf\u7684\u6761\u4ef6\u6570\uff0c\u5fc5\u8981\u65f6\u51cf\u5c0f $s$</p>\n</li>\n</ol>\n<p><strong>CA-LU\u5206\u89e3</strong></p>\n<p>\u5c06LU\u5206\u89e3\u91cd\u7ec4\u4e3a\u5757\u7b97\u6cd5\uff0c\u51cf\u5c11\u540c\u6b65\u70b9\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9526\u6807\u8d5b\u65cb\u8f6c\uff08Tournament Pivoting\uff09</strong>\uff1a\n   - \u5e76\u884c\u641c\u7d22\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u5c40\u90e8\u6700\u5927\u5143\n   - \u901a\u8fc7\u9526\u6807\u8d5b\u6811\u786e\u5b9a\u5168\u5c40\u4e3b\u5143\n   - \u901a\u4fe1\u590d\u6742\u5ea6\uff1a$O(\\log P)$ \u800c\u975e $O(n)$</p>\n</li>\n<li>\n<p><strong>\u5757\u6d88\u5143</strong>\uff1a\n   ```\n   \u5c06\u77e9\u9635\u5206\u6210 b\u00d7b \u7684\u5757\n   for k = 0 to n/b-1:\n       // \u56e0\u5b50\u5316\u5bf9\u89d2\u5757\uff08\u4f7f\u7528tournament pivoting\uff09\n       [L\u2096\u2096, U\u2096\u2096] = LU(A\u2096\u2096)</p>\n<p>// \u66f4\u65b0\u5757\u5217\u548c\u5757\u884c\n   L\u2096,\u2096\u208a\u2081:\u2099/\u1d66 = A\u2096,\u2096\u208a\u2081:\u2099/\u1d66 \u00d7 U\u2096\u2096\u207b\u00b9\n   U\u2096\u208a\u2081:\u2099/\u1d66,\u2096 = L\u2096\u2096\u207b\u00b9 \u00d7 A\u2096\u208a\u2081:\u2099/\u1d66,\u2096</p>\n<p>// Schur\u8865\u66f4\u65b0\uff08\u53ef\u4ee5\u4f7f\u7528CA\u77e9\u9635\u4e58\u6cd5\uff09\n   A\u2096\u208a\u2081:\u2099/\u1d66,\u2096\u208a\u2081:\u2099/\u1d66 -= L\u2096\u208a\u2081:\u2099/\u1d66,\u2096 \u00d7 U\u2096,\u2096\u208a\u2081:\u2099/\u1d66\n   ```</p>\n</li>\n</ol>\n<p><strong>2.5D\u7b97\u6cd5\uff1a\u5185\u5b58\u4e0e\u901a\u4fe1\u7684\u6700\u4f18\u6743\u8861</strong></p>\n<p>\u5f53\u53ef\u7528\u5185\u5b58\u5927\u4e8e\u6700\u5c0f\u9700\u6c42\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u590d\u5236\u8fdb\u4e00\u6b65\u51cf\u5c11\u901a\u4fe1\uff1a</p>\n<p>\u5bf9\u4e8e\u77e9\u9635\u4e58\u6cd5\uff0c\u4f7f\u7528 $c$ \u500d\u7684\u5185\u5b58\u526f\u672c\uff1a</p>\n<ul>\n<li>\u5904\u7406\u5668\u7ec4\u7ec7\uff1a$P/c^{1/2} \\times P/c^{1/2} \\times c$</li>\n<li>\u6bcf\u5c42\u5b58\u50a8 $\\mathbf{A}$ \u548c $\\mathbf{B}$ \u7684\u4e0d\u540c\u5757</li>\n<li>\u901a\u4fe1\u91cf\uff1a$O(n^2/\\sqrt{cP})$</li>\n<li>\u5f53 $c = P^{1/3}$ \u65f6\uff0c\u8fbe\u5230 $O(n^2/P^{2/3})$ \u76843D\u7b97\u6cd5\u4e0b\u754c</li>\n</ul>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u4e2d\u7684\u6311\u6218\u4e0e\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7a00\u758f\u77e9\u9635\u7684CA\u7b97\u6cd5</strong>\uff1a\n   - \u9884\u8ba1\u7b97\u901a\u4fe1\u6a21\u5f0f\u907f\u514d\u8fd0\u884c\u65f6\u5f00\u9500\n   - \u4f7f\u7528\u56fe\u5206\u5272minimized\u901a\u4fe1\u91cf\n   - Hypergraph\u6a21\u578b\u4f18\u5316\u6570\u636e\u5206\u5e03</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94CA\u7b97\u6cd5</strong>\uff1a\n   - \u76d1\u63a7\u901a\u4fe1/\u8ba1\u7b97\u6bd4\u7387\n   - \u52a8\u6001\u8c03\u6574 $s$ \u503c\n   - \u57fa\u4e8e\u7f51\u7edc\u62e5\u585e\u5207\u6362\u7b97\u6cd5</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6CA\u7b97\u6cd5</strong>\uff1a\n   - \u9ad8\u7cbe\u5ea6\u901a\u4fe1\uff0c\u4f4e\u7cbe\u5ea6\u5c40\u90e8\u8ba1\u7b97\n   - \u8fed\u4ee3\u7cbe\u5316\u6062\u590d\u7cbe\u5ea6\n   - \u7279\u522b\u9002\u5408GPU\u7b49\u67b6\u6784</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u5efa\u6a21\u4e0e\u4f18\u5316</strong>\uff1a</p>\n<p>CA\u7b97\u6cd5\u7684\u52a0\u901f\u6bd4\u53ef\u4ee5\u5efa\u6a21\u4e3a\uff1a\n$$S = \\frac{T_{\\text{classic}}}{T_{\\text{CA}}} = \\frac{\\gamma n^3/P + \\beta n^2/\\sqrt{P} + \\alpha n \\log P}{\\gamma n^3/P \\cdot (1+\\delta) + \\beta n^2/\\sqrt{P} + \\alpha n/s \\log P}$$\n\u5176\u4e2d $\\delta$ \u662fCA\u7b97\u6cd5\u7684\u8ba1\u7b97\u5f00\u9500\u56e0\u5b50\uff08\u901a\u5e38 $&lt; 0.2$\uff09\u3002</p>\n<p>\u5f53 $\\alpha n \\log P \\gg \\beta n^2/\\sqrt{P}$\uff08\u5ef6\u8fdf\u4e3b\u5bfc\uff09\u65f6\uff0cCA\u7b97\u6cd5\u53ef\u4ee5\u83b7\u5f97\u63a5\u8fd1 $s$ \u500d\u7684\u52a0\u901f\u3002</p>\n<h3 id=\"814\">8.1.4 \u5f02\u6784\u7cfb\u7edf\u4e2d\u7684\u8d1f\u8f7d\u5747\u8861</h3>\n<p>\u73b0\u4ee3\u96c6\u7fa4\u5f80\u5f80\u5305\u542b\u4e0d\u540c\u6027\u80fd\u7684\u8282\u70b9\uff08CPU\u3001GPU\u3001TPU\u6df7\u5408\uff09\u3002\u5f02\u6784\u73af\u5883\u5e26\u6765\u65b0\u7684\u6311\u6218\u548c\u673a\u9047\u3002</p>\n<p><strong>\u9759\u6001\u8d1f\u8f7d\u5747\u8861\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>\u6027\u80fd\u5efa\u6a21</strong>\uff1a\u6d4b\u91cf\u6bcf\u4e2a\u8282\u70b9\u7684\u8ba1\u7b97\u901f\u7387 $\\alpha_i$ \u548c\u901a\u4fe1\u5e26\u5bbd $\\beta_i$</li>\n<li><strong>\u4f18\u5316\u95ee\u9898</strong>\uff1a\u6700\u5c0f\u5316 $\\max_i {W_i/\\alpha_i + C_i/\\beta_i}$</li>\n<li><strong>\u52a8\u6001\u8c03\u6574</strong>\uff1a\u8fd0\u884c\u65f6\u76d1\u63a7\u5e76\u91cd\u65b0\u5206\u914d\u4efb\u52a1</li>\n</ol>\n<p><strong>\u5f02\u6784\u611f\u77e5\u7684\u6570\u636e\u5206\u5e03</strong>\uff1a</p>\n<ul>\n<li><strong>\u52a0\u6743Block-Cyclic</strong>\uff1a\u5757\u5927\u5c0f $b_i \\propto \\alpha_i$</li>\n<li><strong>2D\u5206\u5e03\u7684\u975e\u5747\u5300\u7f51\u683c</strong>\uff1aGPU\u8282\u70b9\u5206\u914d\u66f4\u5927\u7684\u5b50\u77e9\u9635</li>\n<li><strong>\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565</strong>\uff1aGPU\u4f7f\u7528FP16\uff0cCPU\u4f7f\u7528FP64\uff0c\u901a\u8fc7\u8fed\u4ee3\u7cbe\u5316\u4fdd\u8bc1\u7cbe\u5ea6</li>\n</ul>\n<p><strong>GPU-CPU\u534f\u540c\u8ba1\u7b97\u6a21\u5f0f</strong>\uff1a</p>\n<ol>\n<li><strong>\u4efb\u52a1\u7ea7\u5e76\u884c</strong>\uff1aGPU\u5904\u7406\u77e9\u9635\u4e58\u6cd5\u5bc6\u96c6\u90e8\u5206\uff0cCPU\u5904\u7406\u7a00\u758f\u6216\u4e0d\u89c4\u5219\u90e8\u5206</li>\n<li><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong>\uff1aGPU\u8ba1\u7b97\uff0cCPU\u8fdb\u884c\u6570\u636e\u9884\u5904\u7406\u548c\u540e\u5904\u7406</li>\n<li><strong>\u6570\u636e\u5e76\u884c</strong>\uff1a\u5927\u77e9\u9635\u5206\u5757\uff0cGPU\u548cCPU\u5904\u7406\u4e0d\u540c\u5757</li>\n</ol>\n<p><strong>\u52a8\u6001\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>Work-Stealing\u6846\u67b6\uff1a\n1. \u521d\u59cb\u5206\u914d\u57fa\u4e8e\u9759\u6001\u6027\u80fd\u6a21\u578b\n2. \u5feb\u901f\u8282\u70b9\u5b8c\u6210\u540e\u4ece\u6162\u8282\u70b9&quot;\u5077\u53d6&quot;\u4efb\u52a1\n3. \u4efb\u52a1\u7c92\u5ea6\u52a8\u6001\u8c03\u6574\u907f\u514d\u8fc7\u591a\u901a\u4fe1\n4. \u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\u4fdd\u8bc1\u4efb\u52a1\u961f\u5217\u4e00\u81f4\u6027\n</code></pre></div>\n\n<h3 id=\"815\">8.1.5 \u5b9e\u8df5\u8003\u8651</h3>\n<ol>\n<li>\n<p><strong>\u91cd\u53e0\u901a\u4fe1\u4e0e\u8ba1\u7b97</strong>\uff1a\n   - \u4f7f\u7528\u5f02\u6b65\u901a\u4fe1\u539f\u8bed\uff08MPI_Isend/Irecv, NCCL\u5f02\u6b65\u96c6\u5408\u64cd\u4f5c\uff09\n   - \u53cc\u7f13\u51b2\u6280\u672f\uff1a\u8ba1\u7b97buffer A\u65f6\u4f20\u8f93buffer B\n   - GPU Direct RDMA\u51cf\u5c11CPU\u53c2\u4e0e</p>\n</li>\n<li>\n<p><strong>\u62d3\u6251\u611f\u77e5\u4f18\u5316</strong>\uff1a\n   - <strong>Fat-tree\u62d3\u6251</strong>\uff1a\u5229\u7528\u5206\u5c42\u7ed3\u6784\uff0c\u540c\u673a\u67b6\u5185\u901a\u4fe1\u4f18\u5148\n   - <strong>Torus/Mesh\u62d3\u6251</strong>\uff1a\u6700\u8fd1\u90bb\u901a\u4fe1\u6a21\u5f0f\uff0c\u907f\u514d\u8de8\u7ef4\u5ea6\u901a\u4fe1\n   - <strong>Dragonfly\u62d3\u6251</strong>\uff1a\u7ec4\u5185\u5168\u8fde\u63a5\uff0c\u7ec4\u95f4\u7a00\u758f\u8fde\u63a5\u7684\u4f18\u5316\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a\n   - <strong>Algorithm-Based Fault Tolerance (ABFT)</strong>\uff1a\u5229\u7528\u6821\u9a8c\u548c\u68c0\u6d4b\u548c\u6062\u590d\u9519\u8bef\n   - <strong>Checkpointing\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u540c\u6b65\u68c0\u67e5\u70b9\uff1a\u6240\u6709\u8282\u70b9\u540c\u65f6\u4fdd\u5b58\u72b6\u6001</li>\n<li>\u5f02\u6b65\u68c0\u67e5\u70b9\uff1a\u5404\u8282\u70b9\u72ec\u7acb\u4fdd\u5b58\uff0c\u9700\u8981\u5904\u7406\u4e00\u81f4\u6027</li>\n<li>\u589e\u91cf\u68c0\u67e5\u70b9\uff1a\u53ea\u4fdd\u5b58\u53d8\u5316\u7684\u6570\u636e\u5757</li>\n<li><strong>\u5f39\u6027\u8c03\u5ea6</strong>\uff1a\u8282\u70b9\u6545\u969c\u540e\u81ea\u52a8\u91cd\u65b0\u5206\u914d\u4efb\u52a1</li>\n</ul>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u8c03\u4f18\u8981\u70b9</strong>\uff1a\n   - \u9009\u62e9\u5408\u9002\u7684\u5757\u5927\u5c0f\u5e73\u8861\u8ba1\u7b97/\u901a\u4fe1\u6bd4\n   - \u4f7f\u7528\u96c6\u5408\u901a\u4fe1\u64cd\u4f5c\u800c\u975e\u70b9\u5bf9\u70b9\u901a\u4fe1\n   - \u5185\u5b58\u5bf9\u9f50\u548cNUMA\u611f\u77e5\u7684\u5185\u5b58\u5206\u914d\n   - \u907f\u514dfalse sharing\u548ccache\u51b2\u7a81</p>\n</li>\n</ol>\n<h2 id=\"82-gossip\">8.2 Gossip\u7b97\u6cd5\u7684\u6536\u655b\u6027\u5206\u6790</h2>\n<p>Gossip\u7b97\u6cd5\u662f\u4e00\u7c7b\u53bb\u4e2d\u5fc3\u5316\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\uff0c\u8282\u70b9\u901a\u8fc7\u4e0e\u90bb\u5c45\u7684\u5c40\u90e8\u901a\u4fe1\u8fbe\u5230\u5168\u5c40\u4e00\u81f4\u3002\u8fd9\u7c7b\u7b97\u6cd5\u5728\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u4e2d\u8d8a\u6765\u8d8a\u91cd\u8981\uff0c\u7279\u522b\u662f\u5728\u8054\u90a6\u5b66\u4e60\u548c\u53bb\u4e2d\u5fc3\u5316\u4f18\u5316\u4e2d\u3002</p>\n<h3 id=\"821-gossip\">8.2.1 \u57fa\u7840Gossip\u6a21\u578b</h3>\n<p>\u8003\u8651 $n$ \u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9 $i$ \u6301\u6709\u521d\u59cb\u503c $x_i(0)$\u3002\u76ee\u6807\u662f\u8ba1\u7b97\u5e73\u5747\u503c $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i(0)$\u3002</p>\n<p><strong>\u540c\u6b65Gossip</strong>\uff1a\n$$\\mathbf{x}(t+1) = \\mathbf{W}(t)\\mathbf{x}(t)$$\n\u5176\u4e2d $\\mathbf{W}(t)$ \u662f\u53cc\u968f\u673a\u77e9\u9635\uff08\u884c\u548c\u5217\u548c\u90fd\u4e3a1\uff09\u3002</p>\n<p><strong>\u53cc\u968f\u673a\u77e9\u9635\u7684\u6784\u9020</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Metropolis-Hastings\u6743\u91cd</strong>\uff1a\n$$W_{ij} = \\begin{cases}\n   \\frac{1}{\\max{d_i, d_j}+1} &amp; \\text{if } (i,j) \\in E \\\n   1 - \\sum_{k \\neq i} W_{ik} &amp; \\text{if } i = j \\\n   0 &amp; \\text{otherwise}\n   \\end{cases}$$</p>\n</li>\n<li>\n<p><strong>Max-degree\u6743\u91cd</strong>\uff1a$W_{ij} = 1/(d_{\\max}+1)$ for $(i,j) \\in E$</p>\n</li>\n<li>\n<p><strong>\u4f18\u5316\u6743\u91cd</strong>\uff1a\u6c42\u89e3SDP\u95ee\u9898\u6700\u5c0f\u5316 $\\lambda_2(\\mathbf{W})$</p>\n</li>\n</ol>\n<p><strong>\u6536\u655b\u6761\u4ef6</strong>\uff1a\u5982\u679c\u5b58\u5728 $\\gamma \\in (0,1)$ \u4f7f\u5f97\u5bf9\u6240\u6709 $t$\uff1a\n$$\\lambda_2(\\mathbb{E}[\\mathbf{W}(t)]) \\leq \\gamma &lt; 1$$\n\u5219 $\\mathbb{E}[|\\mathbf{x}(t) - \\bar{x}\\mathbf{1}|^2] \\leq \\gamma^t |\\mathbf{x}(0) - \\bar{x}\\mathbf{1}|^2$\u3002</p>\n<p><strong>\u6536\u655b\u6027\u8bc1\u660e\u8981\u70b9</strong>\uff1a</p>\n<ul>\n<li>\u5e73\u5747\u503c\u4fdd\u6301\uff1a$\\mathbf{1}^T\\mathbf{x}(t) = \\mathbf{1}^T\\mathbf{x}(0)$\uff08\u7531\u53cc\u968f\u673a\u6027\uff09</li>\n<li>\u5171\u8bc6\u5b50\u7a7a\u95f4\uff1a$\\text{span}{\\mathbf{1}}$ \u662f\u4e0d\u53d8\u5b50\u7a7a\u95f4</li>\n<li>\u8bef\u5dee\u6295\u5f71\uff1a\u5728 $\\mathbf{1}^{\\perp}$ \u4e0a\u5206\u6790\u6536\u655b\u6027</li>\n</ul>\n<h3 id=\"822\">8.2.2 \u8c31\u5206\u6790\u4e0e\u6536\u655b\u901f\u5ea6</h3>\n<p>\u6536\u655b\u901f\u5ea6\u7531\u7b2c\u4e8c\u5927\u7279\u5f81\u503c $\\lambda_2$ \u51b3\u5b9a\u3002\u5bf9\u4e8e\u5e38\u89c1\u62d3\u6251\uff1a</p>\n<ol>\n<li><strong>\u5b8c\u5168\u56fe</strong>\uff1a$\\lambda_2 = 0$\uff0c\u4e00\u6b65\u6536\u655b</li>\n<li><strong>\u73af\u5f62\u62d3\u6251</strong>\uff1a$\\lambda_2 = 1 - O(1/n^2)$\uff0c\u9700\u8981 $O(n^2)$ \u6b65</li>\n<li><strong>\u968f\u673a\u51e0\u4f55\u56fe</strong>\uff1a$\\lambda_2 = 1 - O(1/n)$\uff0c\u9700\u8981 $O(n)$ \u6b65</li>\n<li><strong>Expander\u56fe</strong>\uff1a$\\lambda_2 \\leq 1 - \\Omega(1)$\uff0c\u9700\u8981 $O(\\log n)$ \u6b65</li>\n</ol>\n<p><strong>\u7cbe\u786e\u7684\u8c31\u5206\u6790</strong>\uff1a</p>\n<p>\u5bf9\u4e8e $d$-\u6b63\u5219\u56fe\uff0c\u4f7f\u7528Cheeger\u4e0d\u7b49\u5f0f\uff1a\n$$\\frac{h^2}{2d} \\leq 1 - \\lambda_2 \\leq 2h$$\n\u5176\u4e2d $h$ \u662fCheeger\u5e38\u6570\uff08\u7b49\u5468\u5e38\u6570\uff09\uff1a\n$$h = \\min_{S: |S| \\leq n/2} \\frac{|\\partial S|}{|S|}$$\n<strong>\u5c0f\u4e16\u754c\u73b0\u8c61\u4e0e\u5feb\u901f\u6df7\u5408</strong>\uff1a</p>\n<ul>\n<li>Watts-Strogatz\u6a21\u578b\uff1a\u5728\u73af\u4e0a\u6dfb\u52a0\u5c11\u91cf\u968f\u673a\u8fb9</li>\n<li>\u8c31\u9699\u4ece $O(1/n^2)$ \u6539\u5584\u5230 $O(1/\\text{polylog}(n))$</li>\n<li>\u5b9e\u8df5\u610f\u4e49\uff1a\u793e\u4ea4\u7f51\u7edc\u4e2d\u7684\u4fe1\u606f\u4f20\u64ad</li>\n</ul>\n<p><strong>\u8c31\u9699\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>SDP\u677e\u5f1b</strong>\uff1a\n$$\\begin{align}\n   \\text{minimize} \\quad &amp;\\lambda_2(\\mathbf{W}) \\\n   \\text{subject to} \\quad &amp;\\mathbf{W}\\mathbf{1} = \\mathbf{1}, \\mathbf{W}^T\\mathbf{1} = \\mathbf{1} \\\n   &amp;W_{ij} \\geq 0, W_{ij} = 0 \\text{ if } (i,j) \\notin E\n   \\end{align}$$</p>\n</li>\n<li>\n<p><strong>\u5feb\u901f\u6df7\u5408\u9a6c\u5c14\u53ef\u592b\u94fe\u8bbe\u8ba1</strong>\uff1a\n   - Boyd\u7b49\u4eba\u7684\u51f8\u4f18\u5316\u65b9\u6cd5\n   - \u53ef\u8fbe\u5230 $\\lambda_2 = 1 - \\Theta(1/\\text{diam}(G))$ \u7684\u6700\u4f18\u754c</p>\n</li>\n<li>\n<p><strong>\u591a\u5c3a\u5ea6\u65b9\u6cd5</strong>\uff1a\n   - \u6784\u5efa\u5c42\u6b21\u5316\u7684\u901a\u4fe1\u56fe\n   - \u4e0d\u540c\u5c3a\u5ea6\u4e0a\u7684\u4fe1\u606f\u805a\u5408\n   - \u7c7b\u4f3c\u4e8e\u591a\u91cd\u7f51\u683c\u65b9\u6cd5\u7684\u601d\u60f3</p>\n</li>\n</ol>\n<h3 id=\"823-push-sum\">8.2.3 Push-Sum\u7b97\u6cd5</h3>\n<p>Push-Sum\u662f\u4e00\u79cd\u80fd\u591f\u5904\u7406\u6709\u5411\u56fe\u548c\u65f6\u53d8\u62d3\u6251\u7684gossip\u53d8\u4f53\uff0c\u89e3\u51b3\u4e86\u4f20\u7edfgossip\u9700\u8981\u53cc\u968f\u673a\u6027\u7684\u9650\u5236\uff1a</p>\n<p>\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e24\u4e2a\u503c\uff1a$s_i(t)$\uff08sum\uff09\u548c $w_i(t)$\uff08weight\uff09\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\uff1a$s_i(0) = x_i$\uff0c$w_i(0) = 1$</li>\n<li>\u66f4\u65b0\uff1a\u8282\u70b9 $i$ \u5c06 $(s_i(t), w_i(t))$ \u5e73\u5747\u5206\u7ed9\u51fa\u90bb\u5c45\u548c\u81ea\u5df1</li>\n<li>\u4f30\u8ba1\uff1a$\\hat{x}_i(t) = s_i(t)/w_i(t)$</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u7ec6\u8282</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u5bf9\u6bcf\u4e2a\u8282\u70b9i\u548c\u65f6\u523bt\uff1a\n  out_degree = |N_out(i)| + 1  // \u5305\u62ec\u81ea\u5df1\n  \u5bf9\u6bcf\u4e2a j \u2208 N_out(i) \u222a {i}\uff1a\n    \u53d1\u9001 (s_i(t)/out_degree, w_i(t)/out_degree) \u7ed9\u8282\u70b9j\n\n  s_i(t+1) = \u03a3_{k\u2208N_in(i)\u222a{i}} s_k\u2192i\n  w_i(t+1) = \u03a3_{k\u2208N_in(i)\u222a{i}} w_k\u2192i\n</code></pre></div>\n\n<p><strong>\u6536\u655b\u6027\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li><strong>\u5217\u968f\u673a\u6027\u4fdd\u6301</strong>\uff1a\u6743\u91cd\u77e9\u9635 $\\mathbf{P}(t)$ \u6ee1\u8db3 $\\mathbf{1}^T\\mathbf{P}(t) = \\mathbf{1}^T$</li>\n<li><strong>\u8d28\u91cf\u5b88\u6052</strong>\uff1a$\\sum_i s_i(t) = \\sum_i s_i(0)$, $\\sum_i w_i(t) = n$</li>\n<li><strong>\u6bd4\u7387\u6536\u655b</strong>\uff1a$\\lim_{t\u2192\u221e} s_i(t)/w_i(t) = \\bar{x}$ \u5bf9\u6240\u6709 $i$</li>\n</ul>\n<p><strong>\u6536\u655b\u901f\u5ea6</strong>\uff1a\n\u5bf9\u4e8e\u56fa\u5b9a\u7684\u5f3a\u8fde\u901a\u56fe\uff0c\u5b58\u5728 $\\rho &lt; 1$ \u4f7f\u5f97\uff1a\n$$\\max_i |\\hat{x}_i(t) - \\bar{x}| \\leq O(\\rho^t)$$\n\u5176\u4e2d $\\rho$ \u4e0e\u8f6c\u79fb\u77e9\u9635\u7684\u7b2c\u4e8c\u5927\u7279\u5f81\u503c\u6a21\u76f8\u5173\u3002</p>\n<p><strong>\u65f6\u53d8\u56fe\u4e0a\u7684Push-Sum</strong>\uff1a</p>\n<ul>\n<li>\u53ea\u9700\u8981\u56fe\u5e8f\u5217 ${G(t)}$ \u8054\u5408\u5f3a\u8fde\u901a</li>\n<li>B-\u5f3a\u8fde\u901a\u6027\uff1a\u4efb\u610f\u8fde\u7eed $B$ \u4e2a\u56fe\u7684\u5e76\u662f\u5f3a\u8fde\u901a\u7684</li>\n<li>\u6536\u655b\u901f\u5ea6\u4f9d\u8d56\u4e8e $B$ \u548c\u56fe\u5e8f\u5217\u7684\u6027\u8d28</li>\n</ul>\n<h3 id=\"824\">8.2.4 \u52a0\u901f\u6280\u672f</h3>\n<p><strong>Momentum Gossip</strong>\uff1a\n$$\\mathbf{x}(t+1) = \\mathbf{W}\\mathbf{x}(t) + \\beta(\\mathbf{x}(t) - \\mathbf{x}(t-1))$$\n\u9009\u62e9 $\\beta = \\frac{\\lambda_2}{1 + \\lambda_2}$ \u53ef\u4ee5\u5c06\u6536\u655b\u901f\u5ea6\u4ece $O(\\lambda_2^t)$ \u63d0\u5347\u5230 $O(\\lambda_2^{t/2})$\u3002</p>\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u5e94\u4e8e\u4e8c\u9636\u5dee\u5206\u65b9\u7a0b\u7684\u7279\u5f81\u591a\u9879\u5f0f\uff1a$r^2 - (1+\\beta)\\lambda r + \\beta = 0$</li>\n<li>\u6700\u4f18 $\\beta$ \u4f7f\u4e24\u4e2a\u6839\u7684\u6a21\u76f8\u7b49</li>\n<li>\u7c7b\u4f3c\u4e8eChebyshev\u52a0\u901f\u7684\u601d\u60f3</li>\n</ul>\n<p><strong>\u9884\u6761\u4ef6Gossip</strong>\uff1a\u4f7f\u7528\u56fe\u62c9\u666e\u62c9\u65af\u7684\u4f2a\u9006\u4f5c\u4e3a\u9884\u6761\u4ef6\u5b50\uff1a\n$$\\mathbf{x}(t+1) = \\mathbf{x}(t) - \\alpha \\mathbf{L}^{\\dagger}(\\mathbf{x}(t) - \\bar{x}\\mathbf{1})$$\n<strong>\u5b9e\u73b0\u6311\u6218\u4e0e\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>$\\mathbf{L}^{\\dagger}$ \u7684\u8ba1\u7b97\u4ee3\u4ef7\u9ad8</li>\n<li>\u4f7f\u7528\u591a\u9879\u5f0f\u8fd1\u4f3c\uff1a$\\mathbf{L}^{\\dagger} \\approx \\sum_{k=1}^K c_k \\mathbf{L}^k$</li>\n<li>\u6216\u4f7f\u7528\u5206\u5e03\u5f0f\u5171\u8f6d\u68af\u5ea6\u6c42\u89e3</li>\n</ul>\n<p><strong>Shift-Register\u65b9\u6cd5</strong>\uff1a\n\u5229\u7528\u5386\u53f2\u4fe1\u606f\u6784\u9020\u66f4\u597d\u7684\u4f30\u8ba1\uff1a\n$$\\hat{x}_i(t) = \\sum_{k=0}^{K-1} a_k x_i(t-k)$$\n\u7cfb\u6570 ${a_k}$ \u901a\u8fc7\u6700\u5c0f\u5316\u65b9\u5dee\u5f97\u5230\uff0c\u53ef\u4ee5\u8fbe\u5230 $O(1/t^2)$ \u7684\u6536\u655b\u901f\u5ea6\u3002</p>\n<p><strong>\u6709\u9650\u65f6\u95f4\u7cbe\u786e\u5171\u8bc6</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528\u6700\u5c0f\u591a\u9879\u5f0f\u7406\u8bba</li>\n<li>\u5982\u679c\u77e5\u9053\u7f51\u7edc\u62d3\u6251\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u5728 $\\text{diam}(G)$ \u6b65\u5185\u7cbe\u786e\u6536\u655b\u7684\u7b97\u6cd5</li>\n<li>\u6743\u91cd\u77e9\u9635\u7684\u7279\u5f81\u591a\u9879\u5f0f\u8d77\u5173\u952e\u4f5c\u7528</li>\n</ul>\n<h3 id=\"825\">8.2.5 \u5b9e\u9645\u5e94\u7528</h3>\n<ol>\n<li>\n<p><strong>\u5206\u5e03\u5f0f\u4f18\u5316</strong>\uff1a\n   - <strong>D-SGD\uff08\u53bb\u4e2d\u5fc3\u5316SGD\uff09</strong>\uff1a\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u5c40\u90e8\u6a21\u578b\uff0c\u901a\u8fc7gossip\u5e73\u5747\n   - <strong>\u6536\u655b\u6027</strong>\uff1a$\\mathbb{E}[f(\\bar{\\mathbf{x}}(T))] - f^* \\leq O(1/\\sqrt{nT}) + O(\\lambda_2^T)$\n   - \u7b2c\u4e00\u9879\u662f\u4f18\u5316\u8bef\u5dee\uff0c\u7b2c\u4e8c\u9879\u662f\u5171\u8bc6\u8bef\u5dee</p>\n</li>\n<li>\n<p><strong>\u4f20\u611f\u5668\u7f51\u7edc</strong>\uff1a\n   - <strong>\u5206\u5e03\u5f0f\u5361\u5c14\u66fc\u6ee4\u6ce2</strong>\uff1a\u878d\u5408\u5c40\u90e8\u89c2\u6d4b\n   - <strong>\u9c81\u68d2\u6027</strong>\uff1a\u5bf9\u8282\u70b9\u6545\u969c\u548c\u901a\u4fe1\u4e22\u5931\u7684\u5bb9\u5fcd\n   - <strong>\u80fd\u91cf\u6548\u7387</strong>\uff1a\u53ea\u4e0e\u90bb\u5c45\u901a\u4fe1\uff0c\u5ef6\u957f\u7f51\u7edc\u5bff\u547d</p>\n</li>\n<li>\n<p><strong>\u8054\u90a6\u5b66\u4e60</strong>\uff1a\n   - <strong>FedAvg\u7684\u53bb\u4e2d\u5fc3\u5316\u7248\u672c</strong>\uff1a\u65e0\u9700\u4e2d\u5fc3\u670d\u52a1\u5668\n   - <strong>\u9690\u79c1\u4fdd\u62a4</strong>\uff1a\u53ea\u4ea4\u6362\u6a21\u578b\u53c2\u6570\uff0c\u4e0d\u4f20\u8f93\u539f\u59cb\u6570\u636e\n   - <strong>\u5f02\u6784\u6027\u5904\u7406</strong>\uff1a\u52a0\u6743gossip\u5904\u7406\u4e0d\u540c\u6570\u636e\u91cf\u7684\u5ba2\u6237\u7aef</p>\n</li>\n<li>\n<p><strong>\u533a\u5757\u94fe\u4e0e\u5171\u8bc6</strong>\uff1a\n   - <strong>Avalanche\u534f\u8bae</strong>\uff1a\u57fa\u4e8egossip\u7684\u5171\u8bc6\u673a\u5236\n   - <strong>\u5feb\u901f\u6700\u7ec8\u6027</strong>\uff1a\u5229\u7528\u7f51\u7edc\u6548\u5e94\u52a0\u901f\u5171\u8bc6\n   - <strong>\u53ef\u6269\u5c55\u6027</strong>\uff1a\u4e9a\u7ebf\u6027\u7684\u6d88\u606f\u590d\u6742\u5ea6</p>\n</li>\n</ol>\n<h2 id=\"83\">8.3 \u5f02\u6b65\u66f4\u65b0\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1</h2>\n<p>\u540c\u6b65\u7b97\u6cd5\u7684\u4e3b\u8981\u7f3a\u70b9\u662f\u9700\u8981\u7b49\u5f85\u6700\u6162\u7684\u8282\u70b9\uff0c\u5bfc\u81f4\u4e25\u91cd\u7684\u7a7a\u95f2\u65f6\u95f4\u3002\u5f02\u6b65\u7b97\u6cd5\u5141\u8bb8\u8282\u70b9\u72ec\u7acb\u66f4\u65b0\uff0c\u4f46\u5e26\u6765\u4e86\u4e00\u81f4\u6027\u548c\u6536\u655b\u6027\u7684\u65b0\u6311\u6218\u3002</p>\n<h3 id=\"831-bounded-delay\">8.3.1 Bounded Delay\u6a21\u578b</h3>\n<p>\u5047\u8bbe\u66f4\u65b0\u5ef6\u8fdf\u6700\u591a\u4e3a $\\tau$\uff0c\u5373\u65f6\u523b $t$ \u7684\u66f4\u65b0\u4f7f\u7528\u7684\u662f $[t-\\tau, t]$ \u4e4b\u95f4\u7684\u53c2\u6570\u3002\u5bf9\u4e8e\u68af\u5ea6\u4e0b\u964d\uff1a\n$$\\mathbf{x}(t+1) = \\mathbf{x}(t) - \\alpha \\nabla f(\\mathbf{x}(t - d(t)))$$\n\u5176\u4e2d $0 \\leq d(t) \\leq \\tau$\u3002</p>\n<p><strong>\u6536\u655b\u6027\u5206\u6790</strong>\uff1a\u5bf9\u4e8e $L$-\u5149\u6ed1\u7684\u51f8\u51fd\u6570\uff0c\u5982\u679c $\\alpha &lt; \\frac{1}{L(1+\\tau)}$\uff0c\u5219\uff1a\n$$\\mathbb{E}[f(\\mathbf{x}(T))] - f^* \\leq O\\left(\\frac{1}{\\alpha T} + \\alpha^2 L^2 \\tau \\sigma^2\\right)$$\n\u5ef6\u8fdf $\\tau$ \u5bfc\u81f4\u989d\u5916\u7684\u8bef\u5dee\u9879\uff0c\u9700\u8981\u66f4\u5c0f\u7684\u5b66\u4e60\u7387\u3002</p>\n<h3 id=\"832-hogwild\">8.3.2 Hogwild!\u7b97\u6cd5\u5206\u6790</h3>\n<p>Hogwild!\u5141\u8bb8\u65e0\u9501\u5e76\u884c\u66f4\u65b0\u5171\u4eab\u53c2\u6570\u3002\u5173\u952e\u5047\u8bbe\u662f\u68af\u5ea6\u7684\u7a00\u758f\u6027\u3002</p>\n<p>\u8bbe $\\mathbf{e}_i$ \u662f\u7b2c $i$ \u4e2a\u6837\u672c\u5f71\u54cd\u7684\u53c2\u6570\u96c6\u5408\uff0c\u5b9a\u4e49\uff1a</p>\n<ul>\n<li>\u7a00\u758f\u5ea6\uff1a$\\Delta = \\max_i |\\mathbf{e}_i|$</li>\n<li>\u51b2\u7a81\u5ea6\uff1a$\\rho = \\max_{j} |{i: j \\in \\mathbf{e}_i}|$</li>\n</ul>\n<p><strong>\u6536\u655b\u4fdd\u8bc1</strong>\uff1a\u5982\u679c $\\alpha &lt; \\frac{1}{2L\\rho\\Delta}$\uff0c\u5219\u671f\u671b\u6536\u655b\u901f\u5ea6\u51e0\u4e4e\u4e0e\u4e32\u884cSGD\u76f8\u540c\u3002</p>\n<p>\u5b9e\u8df5\u4e2d\uff0c\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u7684\u68af\u5ea6\u7a00\u758f\u6027\u4e0d\u5f3a\uff0c\u4f46Hogwild!\u4ecd\u7136\u6709\u6548\uff0c\u8fd9\u6697\u793a\u7406\u8bba\u5206\u6790\u53ef\u80fd\u8fc7\u4e8e\u4fdd\u5b88\u3002</p>\n<h3 id=\"833\">8.3.3 \u53c2\u6570\u670d\u52a1\u5668\u7684\u4e00\u81f4\u6027\u6a21\u578b</h3>\n<p>\u53c2\u6570\u670d\u52a1\u5668\u67b6\u6784\u4e2d\uff0cworker\u4eceserver\u62c9\u53d6\u53c2\u6570\uff0c\u8ba1\u7b97\u68af\u5ea6\uff0c\u63a8\u9001\u66f4\u65b0\u3002</p>\n<p><strong>\u6700\u7ec8\u4e00\u81f4\u6027</strong>\uff08Eventual Consistency\uff09\uff1a</p>\n<ul>\n<li>Worker\u53ef\u80fd\u8bfb\u5230\u8fc7\u65f6\u7684\u53c2\u6570</li>\n<li>\u7cfb\u7edf\u4fdd\u8bc1\u6700\u7ec8\u6240\u6709\u66f4\u65b0\u90fd\u4f1a\u88ab\u5e94\u7528</li>\n</ul>\n<p><strong>\u6709\u754c\u4e0d\u4e00\u81f4\u6027</strong>\uff08Bounded Staleness\uff09\uff1a</p>\n<ul>\n<li>\u9650\u5236\u53c2\u6570\u7684\u8fc7\u65f6\u7a0b\u5ea6\uff1a$\\text{clock}(t) - \\text{clock}(\\mathbf{x}_{\\text{read}}) \\leq s$</li>\n<li>\u63d0\u4f9b\u6536\u655b\u6027\u4fdd\u8bc1\u7684\u540c\u65f6\u5141\u8bb8\u4e00\u5b9a\u5f02\u6b65\u6027</li>\n</ul>\n<p><strong>SSP (Stale Synchronous Parallel)</strong>\uff1a\n\u6700\u5feb\u7684worker\u6700\u591a\u9886\u5148\u6700\u6162\u7684 $s$ \u4e2a\u65f6\u949f\u5468\u671f\u3002\u8fd9\u5728\u5f02\u6b65\u548c\u540c\u6b65\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002</p>\n<h3 id=\"834-sgd\">8.3.4 \u5c40\u90e8SGD\u4e0e\u5468\u671f\u5e73\u5747</h3>\n<p>\u6bcf\u4e2aworker\u72ec\u7acb\u8fd0\u884c $H$ \u6b65SGD\uff0c\u7136\u540e\u540c\u6b65\u5e76\u5e73\u5747\u53c2\u6570\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>for epoch = 1 to E:\n    for h = 1 to H:\n        \u5404worker\u72ec\u7acb: x_i = x_i - \u03b1\u2207f_i(x_i)\n    \u540c\u6b65: x = (1/P)\u2211x_i\n    \u5e7f\u64adx\u7ed9\u6240\u6709worker\n</code></pre></div>\n\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u901a\u4fe1\u590d\u6742\u5ea6\uff1a$O(E)$ vs \u6807\u51c6SGD\u7684 $O(EH)$</li>\n<li>\u6536\u655b\u901f\u5ea6\uff1a\u5f53 $H = O(\\sqrt{T/P})$ \u65f6\u8fbe\u5230\u6700\u4f18</li>\n</ul>\n<p><strong>\u4f18\u52bf</strong>\uff1a</p>\n<ol>\n<li>\u51cf\u5c11\u901a\u4fe1\u9891\u7387</li>\n<li>\u66f4\u597d\u5730\u5229\u7528\u5c40\u90e8\u6570\u636e\u7ed3\u6784</li>\n<li>\u5bf9\u7f51\u7edc\u5ef6\u8fdf\u66f4\u9c81\u68d2</li>\n</ol>\n<h3 id=\"835\">8.3.5 \u5b9e\u8df5\u6307\u5357</h3>\n<ol>\n<li><strong>\u81ea\u9002\u5e94\u5f02\u6b65\u5ea6</strong>\uff1a\u6839\u636e\u7f51\u7edc\u72b6\u51b5\u52a8\u6001\u8c03\u6574 $\\tau$ \u6216 $s$</li>\n<li><strong>\u91cd\u8981\u6027\u91c7\u6837</strong>\uff1a\u8865\u507f\u5ef6\u8fdf\u5bfc\u81f4\u7684\u68af\u5ea6\u504f\u5dee</li>\n<li><strong>\u7248\u672c\u63a7\u5236</strong>\uff1a\u4f7f\u7528\u7248\u672c\u53f7\u68c0\u6d4b\u8fc7\u65f6\u66f4\u65b0</li>\n<li><strong>\u5f39\u6027\u6269\u5c55</strong>\uff1a\u652f\u6301\u52a8\u6001\u52a0\u5165/\u9000\u51fa\u8282\u70b9</li>\n</ol>\n<h2 id=\"84\">8.4 \u62dc\u5360\u5ead\u9c81\u68d2\u6027\u8bbe\u8ba1</h2>\n<p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u8282\u70b9\u53ef\u80fd\u56e0\u4e3a\u786c\u4ef6\u6545\u969c\u3001\u8f6f\u4ef6bug\u6216\u6076\u610f\u653b\u51fb\u800c\u4ea7\u751f\u9519\u8bef\u7684\u8ba1\u7b97\u7ed3\u679c\u3002\u62dc\u5360\u5ead\u5bb9\u9519\uff08Byzantine Fault Tolerance\uff09\u7814\u7a76\u5982\u4f55\u5728\u5b58\u5728\u4efb\u610f\u6545\u969c\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\u4fdd\u8bc1\u7cfb\u7edf\u7684\u6b63\u786e\u6027\u3002\u5728\u673a\u5668\u5b66\u4e60\u573a\u666f\u4e2d\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c24\u4e3a\u91cd\u8981\uff0c\u56e0\u4e3a\u5355\u4e2a\u6076\u610f\u8282\u70b9\u53ef\u80fd\u7834\u574f\u6574\u4e2a\u6a21\u578b\u7684\u8bad\u7ec3\u3002</p>\n<h3 id=\"841\">8.4.1 \u62dc\u5360\u5ead\u6545\u969c\u6a21\u578b</h3>\n<p>\u5047\u8bbe $n$ \u4e2aworker\u4e2d\u6709\u6700\u591a $f$ \u4e2a\u662f\u62dc\u5360\u5ead\u8282\u70b9\uff0c\u5b83\u4eec\u53ef\u4ee5\uff1a</p>\n<ul>\n<li>\u53d1\u9001\u4efb\u610f\u68af\u5ea6\u503c</li>\n<li>\u4e0e\u5176\u4ed6\u62dc\u5360\u5ead\u8282\u70b9\u5408\u8c0b</li>\n<li>\u4e86\u89e3\u7b97\u6cd5\u7ec6\u8282\u548c\u5176\u4ed6\u8282\u70b9\u7684\u68af\u5ea6</li>\n</ul>\n<p><strong>\u57fa\u672c\u4e0d\u53ef\u80fd\u6027\u7ed3\u679c</strong>\uff1a\u5f53 $f \\geq n/2$ \u65f6\uff0c\u65e0\u6cd5\u533a\u5206\u6b63\u786e\u8282\u70b9\u548c\u62dc\u5360\u5ead\u8282\u70b9\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u901a\u5e38\u5047\u8bbe $f &lt; n/2$\u3002</p>\n<p><strong>\u653b\u51fb\u5411\u91cf\u793a\u4f8b</strong>\uff1a</p>\n<ol>\n<li><strong>\u968f\u673a\u566a\u58f0\u653b\u51fb</strong>\uff1a\u53d1\u9001\u968f\u673a\u68af\u5ea6</li>\n<li><strong>\u7b26\u53f7\u7ffb\u8f6c\u653b\u51fb</strong>\uff1a\u53d1\u9001 $-c\\mathbf{g}$\uff0c\u5176\u4e2d $c &gt; 0$</li>\n<li><strong>\u6a21\u578b\u6bd2\u5316\u653b\u51fb</strong>\uff1a\u7cbe\u5fc3\u6784\u9020\u68af\u5ea6\u4f7f\u6a21\u578b\u5b66\u4e60\u9519\u8bef\u6a21\u5f0f</li>\n</ol>\n<h3 id=\"842\">8.4.2 \u9c81\u68d2\u805a\u5408\u65b9\u6cd5</h3>\n<p><strong>\u5750\u6807\u4e2d\u503c\uff08Coordinate-wise Median\uff09</strong>\uff1a\n\u5bf9\u6bcf\u4e2a\u7ef4\u5ea6\u72ec\u7acb\u53d6\u4e2d\u503c\uff1a\n$$\\text{Median}(\\mathbf{g}_1, ..., \\mathbf{g}_n)_j = \\text{median}{g_{1j}, ..., g_{nj}}$$\n<strong>\u51e0\u4f55\u4e2d\u503c\uff08Geometric Median\uff09</strong>\uff1a\n$$\\mathbf{g}^* = \\arg\\min_{\\mathbf{g}} \\sum_{i=1}^n |\\mathbf{g} - \\mathbf{g}_i|$$\n\u8ba1\u7b97\u4f7f\u7528Weiszfeld\u7b97\u6cd5\u8fed\u4ee3\u6c42\u89e3\u3002</p>\n<p><strong>Trimmed Mean</strong>\uff1a\n\u53bb\u9664\u6bcf\u4e2a\u7ef4\u5ea6\u7684\u6700\u5927\u548c\u6700\u5c0f $\\beta$ \u4e2a\u503c\u540e\u6c42\u5e73\u5747\uff1a\n$$\\text{TrimmedMean}_\\beta({g_{ij}}) = \\frac{1}{n-2\\beta} \\sum_{k=\\beta+1}^{n-\\beta} g_{i(k)j}$$\n\u5176\u4e2d $g_{i(k)j}$ \u662f\u7b2c $j$ \u7ef4\u6392\u5e8f\u540e\u7684\u7b2c $k$ \u4e2a\u503c\u3002</p>\n<h3 id=\"843-krum\">8.4.3 Krum\u7b97\u6cd5\u53ca\u53d8\u4f53</h3>\n<p><strong>Krum\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p>\u5bf9\u6bcf\u4e2a\u68af\u5ea6 $\\mathbf{g}_i$\uff0c\u8ba1\u7b97\u5230\u6700\u8fd1 $n-f-2$ \u4e2a\u68af\u5ea6\u7684\u8ddd\u79bb\u548c\uff1a\n$$s_i = \\sum_{j \\in \\mathcal{N}_i(n-f-2)} |\\mathbf{g}_i - \\mathbf{g}_j|^2$$</p>\n</li>\n<li>\n<p>\u9009\u62e9 $s_i$ \u6700\u5c0f\u7684\u68af\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\u5982\u679c\u8bda\u5b9e\u68af\u5ea6\u6ee1\u8db3 $(\\alpha, f)$-Byzantine resilience\u6761\u4ef6\uff0c\u5219Krum\u7684\u8f93\u51fa $\\mathbf{g}^*$ \u6ee1\u8db3\uff1a\n$$|\\mathbf{g}^* - \\mathbf{g}| \\leq \\frac{4\\alpha(n-f)}{n-2f-2}$$</p>\n<p><strong>Multi-Krum</strong>\uff1a\u9009\u62e9 $m$ \u4e2a\u6700\u597d\u7684\u68af\u5ea6\u6c42\u5e73\u5747\uff0c\u5728\u504f\u5dee\u548c\u65b9\u5dee\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002</p>\n<p><strong>Bulyan\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\u8fd0\u884cKrum\u9009\u62e9 $n-2f$ \u4e2a\u68af\u5ea6</li>\n<li>\u5bf9\u9009\u4e2d\u7684\u68af\u5ea6\u4f7f\u7528trimmed mean</li>\n<li>\u63d0\u4f9b\u66f4\u5f3a\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n</ol>\n<h3 id=\"844\">8.4.4 \u68af\u5ea6\u7f16\u7801\u4e0e\u5197\u4f59\u8ba1\u7b97</h3>\n<p>\u5229\u7528\u7f16\u7801\u7406\u8bba\u4e3b\u52a8\u68c0\u6d4b\u548c\u7ea0\u6b63\u9519\u8bef\uff1a</p>\n<p><strong>\u68af\u5ea6\u7f16\u7801</strong>\uff1a\n\u5c06\u6570\u636e\u5206\u6210 $k$ \u4efd\uff0c\u4f7f\u7528 $(n,k)$ MDS\u7801\u7f16\u7801\u6210 $n$ \u4efd\u5206\u914d\u7ed9worker\u3002\u4efb\u610f $k$ \u4e2a\u6b63\u786e\u7684\u7ed3\u679c\u53ef\u4ee5\u6062\u590d\u539f\u59cb\u68af\u5ea6\u3002</p>\n<p><strong>2D\u68af\u5ea6\u7f16\u7801</strong>\uff1a\n\u5bf9\u4e8e\u77e9\u9635\u4e58\u6cd5 $\\mathbf{C} = \\mathbf{A}^T\\mathbf{B}$\uff1a</p>\n<ol>\n<li>\u5bf9 $\\mathbf{A}$ \u6309\u884c\u7f16\u7801\uff1a$\\tilde{\\mathbf{A}} = \\mathbf{A}\\mathbf{P}$</li>\n<li>\u5bf9 $\\mathbf{B}$ \u6309\u5217\u7f16\u7801\uff1a$\\tilde{\\mathbf{B}} = \\mathbf{Q}\\mathbf{B}$</li>\n<li>\u8ba1\u7b97 $\\tilde{\\mathbf{C}} = \\tilde{\\mathbf{A}}^T\\tilde{\\mathbf{B}}$</li>\n<li>\u4ece\u4efb\u610f\u8db3\u591f\u7684\u5b50\u77e9\u9635\u6062\u590d $\\mathbf{C}$</li>\n</ol>\n<p><strong>\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u786e\u5b9a\u6027\u4fdd\u8bc1</li>\n<li>\u53ef\u4ee5\u5904\u7406\u66f4\u591a\u7684\u62dc\u5360\u5ead\u8282\u70b9\uff08\u6700\u591a $n-k$\uff09</li>\n<li>\u8ba1\u7b97\u5f00\u9500\u76f8\u5bf9\u8f83\u5c0f</li>\n</ul>\n<h3 id=\"845\">8.4.5 \u9ad8\u7ea7\u4e3b\u9898\u4e0e\u7814\u7a76\u65b9\u5411</h3>\n<p><strong>1. \u81ea\u9002\u5e94\u653b\u51fb</strong>\uff1a\n\u73b0\u6709\u65b9\u6cd5\u5927\u591a\u5047\u8bbe\u653b\u51fb\u8005\u4e0d\u77e5\u9053\u9632\u5fa1\u7b56\u7565\u3002\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ul>\n<li>\u5bf9\u6297\u9c81\u68d2\u7684\u805a\u5408\u65b9\u6cd5</li>\n<li>\u57fa\u4e8e\u535a\u5f08\u8bba\u7684\u5206\u6790</li>\n</ul>\n<p><strong>2. \u5f02\u6784\u6570\u636e\u4e0b\u7684\u9c81\u68d2\u6027</strong>\uff1a\n\u8054\u90a6\u5b66\u4e60\u4e2d\u6570\u636e\u975e\u72ec\u7acb\u540c\u5206\u5e03\uff0c\u589e\u52a0\u4e86\u533a\u5206\u6076\u610f\u66f4\u65b0\u7684\u96be\u5ea6\u3002</p>\n<p><strong>3. \u9690\u79c1\u4e0e\u9c81\u68d2\u6027\u7684\u6743\u8861</strong>\uff1a\n\u5dee\u5206\u9690\u79c1\u566a\u58f0\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\uff0c\u9700\u8981\u8054\u5408\u8bbe\u8ba1\u3002</p>\n<p><strong>4. \u9ad8\u7ef4\u573a\u666f\u7684\u8ba1\u7b97\u6548\u7387</strong>\uff1a\n\u8bb8\u591a\u9c81\u68d2\u805a\u5408\u65b9\u6cd5\u5728\u9ad8\u7ef4\u65f6\u8ba1\u7b97\u590d\u6742\u5ea6\u8fc7\u9ad8\u3002</p>\n<h3 id=\"846\">8.4.6 \u5b9e\u8df5\u5efa\u8bae</h3>\n<ol>\n<li><strong>\u68c0\u6d4b\u4e3a\u4e3b\uff0c\u5bb9\u9519\u4e3a\u8f85</strong>\uff1a\u5148\u5c1d\u8bd5\u68c0\u6d4b\u5f02\u5e38\uff0c\u518d\u4f7f\u7528\u9c81\u68d2\u805a\u5408</li>\n<li><strong>\u591a\u5c42\u9632\u5fa1</strong>\uff1a\u7ed3\u5408\u4e0d\u540c\u65b9\u6cd5\uff0c\u5982\u5148\u7528\u7edf\u8ba1\u68c0\u6d4b\u8fc7\u6ee4\u660e\u663e\u5f02\u5e38\uff0c\u518d\u7528Krum</li>\n<li><strong>\u76d1\u63a7\u6307\u6807</strong>\uff1a\u8ddf\u8e2a\u68af\u5ea6\u8303\u6570\u3001\u66f4\u65b0\u4e00\u81f4\u6027\u7b49\u6307\u6807</li>\n<li><strong>\u6e10\u8fdb\u5f0f\u4fe1\u4efb</strong>\uff1a\u6839\u636e\u5386\u53f2\u8868\u73b0\u8c03\u6574\u5bf9\u4e0d\u540c\u8282\u70b9\u7684\u4fe1\u4efb\u5ea6</li>\n</ol>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u5206\u5e03\u5f0f\u77e9\u9635\u8fd0\u7b97\u662f\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u7684\u57fa\u77f3\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u56db\u4e2a\u6838\u5fc3\u4e3b\u9898\uff1a</p>\n<ol>\n<li>\n<p><strong>\u901a\u4fe1\u9ad8\u6548\u7684\u77e9\u9635\u5206\u89e3</strong>\uff1a\u901a\u4fe1\u590d\u6742\u5ea6\u4e0b\u754c\u6307\u5bfc\u7b97\u6cd5\u8bbe\u8ba1\uff0cCA\u7b97\u6cd5\u901a\u8fc7\u91cd\u7ec4\u8ba1\u7b97\u7a81\u7834\u4f20\u7edf\u9650\u5236\uff0c\u8fbe\u5230\u8fd1\u4f3c\u6700\u4f18\u7684\u901a\u4fe1\u6548\u7387\u3002</p>\n</li>\n<li>\n<p><strong>Gossip\u7b97\u6cd5</strong>\uff1a\u53bb\u4e2d\u5fc3\u5316\u5171\u8bc6\u673a\u5236\uff0c\u6536\u655b\u901f\u5ea6\u7531\u8c31\u9699\u51b3\u5b9a\u3002Push-sum\u5904\u7406\u6709\u5411\u56fe\uff0cmomentum\u548c\u9884\u6761\u4ef6\u6280\u672f\u53ef\u663e\u8457\u52a0\u901f\u6536\u655b\u3002</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0</strong>\uff1a\u6253\u7834\u540c\u6b65\u58c1\u5792\u63d0\u9ad8\u7cfb\u7edf\u5229\u7528\u7387\uff0c\u4f46\u9700\u8981\u4ed4\u7ec6\u5904\u7406\u4e00\u81f4\u6027\u3002Bounded delay\u6a21\u578b\u3001Hogwild!\u3001SSP\u7b49\u63d0\u4f9b\u4e0d\u540c\u7684\u4e00\u81f4\u6027-\u6027\u80fd\u6743\u8861\u3002</p>\n</li>\n<li>\n<p><strong>\u62dc\u5360\u5ead\u9c81\u68d2\u6027</strong>\uff1a\u9762\u5bf9\u6076\u610f\u8282\u70b9\u7684\u9632\u5fa1\u673a\u5236\u3002\u4ece\u7b80\u5355\u7684\u4e2d\u503c\u805a\u5408\u5230\u590d\u6742\u7684\u68af\u5ea6\u7f16\u7801\uff0c\u63d0\u4f9b\u4e0d\u540c\u7ea7\u522b\u7684\u5b89\u5168\u4fdd\u8bc1\u3002</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u516c\u5f0f\u56de\u987e</strong>\uff1a</p>\n<ul>\n<li>\u901a\u4fe1\u4e0b\u754c\uff1a$W = \\Omega(n^3/\\sqrt{PM})$</li>\n<li>Gossip\u6536\u655b\uff1a$\\mathbb{E}[|\\mathbf{x}(t) - \\bar{x}\\mathbf{1}|^2] \\leq \\lambda_2^t |\\mathbf{x}(0) - \\bar{x}\\mathbf{1}|^2$</li>\n<li>\u5f02\u6b65SGD\uff1a$\\mathbb{E}[f(\\mathbf{x}(T))] - f^* \\leq O(1/\\alpha T + \\alpha^2 L^2 \\tau \\sigma^2)$</li>\n<li>Krum\u4fdd\u8bc1\uff1a$|\\mathbf{g}^* - \\mathbf{g}| \\leq 4\\alpha(n-f)/(n-2f-2)$</li>\n</ul>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u7ec3\u4e60 8.1</strong>\uff1a\u8bc1\u660e2D\u65b9\u5f62\u5904\u7406\u5668\u7f51\u683c\u4e0a\u77e9\u9635\u4e58\u6cd5\u7684\u901a\u4fe1\u4e0b\u754c\u3002\n<em>\u63d0\u793a</em>\uff1a\u8003\u8651\u6bcf\u4e2a\u5904\u7406\u5668\u9700\u8981\u8bbf\u95ee\u7684\u4e0d\u540c\u6570\u636e\u91cf\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6bcf\u4e2a\u5904\u7406\u5668\u8ba1\u7b97 $n/\\sqrt{P} \\times n/\\sqrt{P}$ \u7684\u8f93\u51fa\u5757\uff0c\u9700\u8981\u8bbf\u95ee $\\mathbf{A}$ \u7684 $n/\\sqrt{P}$ \u884c\u548c $\\mathbf{B}$ \u7684 $n/\\sqrt{P}$ \u5217\u3002\u603b\u6570\u636e\u91cf\u4e3a $2n^2/\\sqrt{P}$\uff0c\u800c\u672c\u5730\u5185\u5b58\u53ea\u6709 $M$\u3002\u4f7f\u7528red-blue pebble game\u5206\u6790\uff0c\u53ef\u5f97\u901a\u4fe1\u4e0b\u754c $\\Omega(n^3/\\sqrt{PM})$\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 8.2</strong>\uff1a\u63a8\u5bfc\u73af\u5f62\u62d3\u6251\u4e0agossip\u7b97\u6cd5\u7684\u7b2c\u4e8c\u5927\u7279\u5f81\u503c\u3002\n<em>\u63d0\u793a</em>\uff1a\u5faa\u73af\u77e9\u9635\u7684\u7279\u5f81\u503c\u53ef\u7528DFT\u8ba1\u7b97\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u73af\u5f62\u62d3\u6251\u7684\u90bb\u63a5\u77e9\u9635\u662f\u5faa\u73af\u77e9\u9635\u3002\u6743\u91cd\u77e9\u9635 $\\mathbf{W} = \\mathbf{I} - \\epsilon\\mathbf{L}$\uff0c\u5176\u4e2d $\\mathbf{L}$ \u662f\u62c9\u666e\u62c9\u65af\u77e9\u9635\u3002\u7279\u5f81\u503c\u4e3a $\\lambda_k = 1 - 2\\epsilon(1 - \\cos(2\\pi k/n))$\u3002\u7b2c\u4e8c\u5927\u7279\u5f81\u503c $\\lambda_2 = 1 - 2\\epsilon(1 - \\cos(2\\pi/n)) \\approx 1 - 2\\epsilon \\pi^2/n^2$\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 8.3</strong>\uff1a\u5206\u6790Hogwild!\u5728\u975e\u51f8\u4f18\u5316\u4e2d\u7684\u6536\u655b\u6027\u3002\n<em>\u63d0\u793a</em>\uff1a\u8003\u8651\u68af\u5ea6\u7684\u6709\u754c\u6027\u548cLipschitz\u8fde\u7eed\u6027\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5047\u8bbe\u68af\u5ea6\u6709\u754c $|\\nabla f| \\leq G$\uff0c\u51fd\u6570 $L$-\u5149\u6ed1\u3002\u5728\u5ef6\u8fdf $\\tau$ \u4e0b\uff0cHogwild!\u7684\u66f4\u65b0\u6ee1\u8db3\uff1a\n$\\mathbb{E}[f(\\mathbf{x}_{t+1})] \\leq f(\\mathbf{x}_t) - \\alpha|\\nabla f(\\mathbf{x}_t)|^2 + \\alpha^2 L G^2 \\tau/2$\u3002\n\u7d2f\u52a0\u540e\u53ef\u5f97\u6536\u655b\u5230\u7a33\u5b9a\u70b9\u7684\u901f\u7387\u4e3a $O(1/\\sqrt{T})$\u3002</p>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u7ec3\u4e60 8.4</strong>\uff1a\u8bbe\u8ba1\u4e00\u4e2a\u901a\u4fe1\u6700\u4f18\u7684\u5206\u5e03\u5f0fSVD\u7b97\u6cd5\u3002\n<em>\u63d0\u793a</em>\uff1a\u7ed3\u5408\u968f\u673a\u5316\u6280\u672f\u548cCA\u601d\u60f3\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4f7f\u7528\u968f\u673a\u5316SVD\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u968f\u673a\u6295\u5f71\uff1a$\\mathbf{Y} = \\mathbf{A}\\Omega$\uff0c\u5176\u4e2d $\\Omega$ \u662f\u968f\u673a\u77e9\u9635</li>\n<li>\u5206\u5e03\u5f0fQR\uff1a\u4f7f\u7528TSQR\u8ba1\u7b97 $\\mathbf{Y} = \\mathbf{Q}\\mathbf{R}$</li>\n<li>\u5f62\u6210\u5c0f\u77e9\u9635\uff1a$\\mathbf{B} = \\mathbf{Q}^T\\mathbf{A}$\uff08\u9700\u8981\u4e00\u6b21\u5168\u5c40\u901a\u4fe1\uff09</li>\n<li>\u5c40\u90e8SVD\uff1a$\\mathbf{B} = \\tilde{\\mathbf{U}}\\Sigma\\mathbf{V}^T$</li>\n<li>\u6062\u590d\uff1a$\\mathbf{U} = \\mathbf{Q}\\tilde{\\mathbf{U}}$</li>\n</ol>\n<p>\u901a\u4fe1\u590d\u6742\u5ea6\uff1a$O(nk/\\sqrt{P})$\uff0c\u5176\u4e2d $k$ \u662f\u76ee\u6807\u79e9\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 8.5</strong>\uff1a\u5206\u6790\u5f02\u6784\u7f51\u7edc\u4e2dgossip\u7b97\u6cd5\u7684\u6536\u655b\u6027\u3002\n<em>\u63d0\u793a</em>\uff1a\u8003\u8651\u4e0d\u540c\u7684\u901a\u4fe1\u5ef6\u8fdf\u548c\u8ba1\u7b97\u80fd\u529b\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5efa\u6a21\u4e3a\u65f6\u53d8\u56fe $\\mathcal{G}(t)$\uff0c\u8fb9\u7684\u6fc0\u6d3b\u6982\u7387\u4f9d\u8d56\u4e8e\u8282\u70b9\u5bf9\u7684\u901a\u4fe1\u5ef6\u8fdf\u3002\u5b9a\u4e49\u6709\u6548\u8c31\u9699\uff1a\n$\\lambda_{\\text{eff}} = \\min_t \\lambda_2(\\mathbb{E}[\\mathbf{W}(t)])$\u3002\n\u6536\u655b\u901f\u5ea6\u7531\u6700\u574f\u60c5\u51b5\u7684\u8c31\u9699\u51b3\u5b9a\u3002\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u5feb\u901f\u8282\u70b9\u95f4\u7684\u901a\u4fe1\u6743\u91cd\u6765\u6539\u5584\u6574\u4f53\u6027\u80fd\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 8.6</strong>\uff1a\u8bc1\u660e\u5728\u5b58\u5728 $f &lt; n/3$ \u4e2a\u62dc\u5360\u5ead\u8282\u70b9\u65f6\uff0c\u51e0\u4f55\u4e2d\u503c\u7684\u9c81\u68d2\u6027\u3002\n<em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u51e0\u4f55\u4e2d\u503c\u7684\u53d8\u5206\u7279\u5f81\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe\u8bda\u5b9e\u68af\u5ea6\u7684\u51e0\u4f55\u4e2d\u503c\u4e3a $\\mathbf{g}_h^*$\uff0c\u6240\u6709\u68af\u5ea6\u7684\u51e0\u4f55\u4e2d\u503c\u4e3a $\\mathbf{g}^*$\u3002\u7531\u51e0\u4f55\u4e2d\u503c\u7684\u5b9a\u4e49\uff1a\n$\\sum_{i=1}^n |\\mathbf{g}^* - \\mathbf{g}_i| \\leq \\sum_{i=1}^n |\\mathbf{g}_h^* - \\mathbf{g}_i|$\u3002\n\u5c06\u8bda\u5b9e\u548c\u62dc\u5360\u5ead\u68af\u5ea6\u5206\u5f00\uff0c\u5229\u7528\u4e09\u89d2\u4e0d\u7b49\u5f0f\u548c $f &lt; n/3$ \u7684\u6761\u4ef6\uff0c\u53ef\u5f97\uff1a\n$|\\mathbf{g}^* - \\mathbf{g}_h^*| \\leq O(f\\sigma/n)$\uff0c\u5176\u4e2d $\\sigma$ \u662f\u8bda\u5b9e\u68af\u5ea6\u7684\u6807\u51c6\u5dee\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 8.7</strong>\uff1a\u8bbe\u8ba1\u4e00\u4e2a\u540c\u65f6\u6ee1\u8db3\u5dee\u5206\u9690\u79c1\u548c\u62dc\u5360\u5ead\u9c81\u68d2\u6027\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\u3002\n<em>\u63d0\u793a</em>\uff1a\u8003\u8651\u5982\u4f55\u5728\u805a\u5408\u524d\u6dfb\u52a0\u566a\u58f0\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4f7f\u7528\u5206\u5e03\u5f0f\u566a\u58f0\u751f\u6210\u534f\u8bae\uff1a</p>\n<ol>\n<li>\u6bcf\u4e2a\u8bda\u5b9e\u8282\u70b9\u751f\u6210\u566a\u58f0\u4efd\u989d $\\mathbf{n}_i \\sim \\mathcal{N}(0, \\sigma^2/n\\mathbf{I})$</li>\n<li>\u68af\u5ea6\u52a0\u566a\u58f0\uff1a$\\tilde{\\mathbf{g}}_i = \\mathbf{g}_i + \\mathbf{n}_i$</li>\n<li>\u4f7f\u7528Krum\u6216\u51e0\u4f55\u4e2d\u503c\u805a\u5408</li>\n<li>\u8bda\u5b9e\u8282\u70b9\u7684\u566a\u58f0\u548c\u6ee1\u8db3\u5dee\u5206\u9690\u79c1\uff0c\u62dc\u5360\u5ead\u8282\u70b9\u65e0\u6cd5\u7834\u574f\u8fd9\u4e00\u6027\u8d28</li>\n</ol>\n<p>\u5173\u952e\u662f\u566a\u58f0\u7684\u5206\u5e03\u5f0f\u751f\u6210\uff0c\u907f\u514d\u4e2d\u5fc3\u5316\u7684\u4fe1\u4efb\u5047\u8bbe\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 8.8</strong>\uff1a\u5206\u6790\u68af\u5ea6\u7f16\u7801\u5728stragglers\u548c\u62dc\u5360\u5ead\u8282\u70b9\u540c\u65f6\u5b58\u5728\u65f6\u7684\u6027\u80fd\u3002\n<em>\u63d0\u793a</em>\uff1a\u7ed3\u5408\u7f16\u7801\u7406\u8bba\u7684\u7ea0\u9519\u548c\u7ea0\u5220\u80fd\u529b\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4f7f\u7528 $(n, k)$ MDS\u7801\uff0c\u53ef\u4ee5\u5bb9\u5fcd $s$ \u4e2astragglers\u548c $b$ \u4e2a\u62dc\u5360\u5ead\u8282\u70b9\uff0c\u53ea\u8981 $n - s - 2b \\geq k$\u3002\n\u89e3\u7801\u8fc7\u7a0b\uff1a</p>\n<ol>\n<li>\u6536\u96c6 $n-s$ \u4e2a\u54cd\u5e94</li>\n<li>\u4f7f\u7528Reed-Solomon\u89e3\u7801\u68c0\u6d4b\u548c\u5b9a\u4f4d\u9519\u8bef</li>\n<li>\u7ea0\u6b63\u6700\u591a $b$ \u4e2a\u9519\u8bef</li>\n<li>\u4ece\u5269\u4f59 $k$ \u4e2a\u6b63\u786e\u7ed3\u679c\u6062\u590d</li>\n</ol>\n<p>\u8ba1\u7b97\u5197\u4f59\u5ea6\uff1a$(n-k)/k$\uff0c\u9700\u8981\u5728\u5bb9\u9519\u80fd\u529b\u548c\u8ba1\u7b97\u5f00\u9500\u95f4\u6743\u8861\u3002</p>\n</details>\n<h2 id=\"_5\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<ol>\n<li>\n<p><strong>\u901a\u4fe1\u6a21\u5f0f\u8bbe\u8ba1</strong>\n   - \u274c \u5ffd\u89c6\u7f51\u7edc\u62d3\u6251\uff0c\u4f7f\u7528\u5168\u5bf9\u5168\u901a\u4fe1\n   - \u2705 \u5229\u7528\u5c42\u6b21\u5316\u901a\u4fe1\uff0c\u5982\u6811\u5f62\u805a\u5408</p>\n</li>\n<li>\n<p><strong>\u8d1f\u8f7d\u5747\u8861</strong>\n   - \u274c \u9759\u6001\u5747\u5300\u5206\u914d\uff0c\u5ffd\u89c6\u8ba1\u7b97/\u901a\u4fe1\u5f02\u6784\u6027\n   - \u2705 \u52a8\u6001\u8d1f\u8f7d\u5747\u8861\uff0c\u76d1\u63a7\u5e76\u8c03\u6574\u4efb\u52a1\u5206\u914d</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u7b97\u6cd5</strong>\n   - \u274c \u76f2\u76ee\u4f7f\u7528\u5927\u7684staleness\u53c2\u6570\n   - \u2705 \u6839\u636e\u95ee\u9898\u7279\u6027\u548c\u7f51\u7edc\u72b6\u51b5\u8c03\u6574</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519\u8bbe\u8ba1</strong>\n   - \u274c \u53ea\u8003\u8651crash\u6545\u969c\uff0c\u5ffd\u89c6\u62dc\u5360\u5ead\u884c\u4e3a\n   - \u2705 \u5206\u5c42\u9632\u5fa1\uff0c\u4ece\u68c0\u6d4b\u5230\u5bb9\u9519\u9010\u6b65\u5347\u7ea7</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u4f18\u5316</strong>\n   - \u274c \u53ea\u4f18\u5316\u8ba1\u7b97\uff0c\u5ffd\u89c6\u901a\u4fe1\u5f00\u9500\n   - \u2705 \u8ba1\u7b97\u901a\u4fe1\u91cd\u53e0\uff0c\u4f7f\u7528\u5f02\u6b65\u901a\u4fe1\u539f\u8bed</p>\n</li>\n</ol>\n<h2 id=\"_6\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_7\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5206\u6790\u901a\u4fe1\u590d\u6742\u5ea6\uff0c\u4e0e\u7406\u8bba\u4e0b\u754c\u6bd4\u8f83</li>\n<li>[ ] \u8003\u8651\u6570\u636e\u5206\u5e03\u7b56\u7565\uff081D, 2D, block-cyclic\uff09</li>\n<li>[ ] \u8bbe\u8ba1\u5bb9\u9519\u673a\u5236\uff08checkpointing, replication\uff09</li>\n<li>[ ] \u8bc4\u4f30\u5f02\u6b65vs\u540c\u6b65\u7684\u6743\u8861</li>\n</ul>\n<h3 id=\"_8\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u9ad8\u6548\u7684\u901a\u4fe1\u5e93\uff08MPI, NCCL\uff09</li>\n<li>[ ] \u5b9e\u73b0\u8ba1\u7b97\u4e0e\u901a\u4fe1\u7684\u91cd\u53e0</li>\n<li>[ ] \u6dfb\u52a0\u6027\u80fd\u76d1\u63a7\u548cprofiling</li>\n<li>[ ] \u5b9e\u73b0\u5f39\u6027\u6269\u5c55\u652f\u6301</li>\n</ul>\n<h3 id=\"_9\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u6d4b\u8bd5\u4e0d\u540c\u89c4\u6a21\u4e0b\u7684\u5f3a/\u5f31\u6269\u5c55\u6027</li>\n<li>[ ] \u9a8c\u8bc1\u5bb9\u9519\u673a\u5236\u7684\u6709\u6548\u6027</li>\n<li>[ ] \u76d1\u63a7\u7f51\u7edc\u5229\u7528\u7387\u548c\u8d1f\u8f7d\u5747\u8861</li>\n<li>[ ] \u51c6\u5907\u964d\u7ea7\u65b9\u6848\u548c\u6545\u969c\u6062\u590d\u6d41\u7a0b</li>\n</ul>\n<h3 id=\"_10\">\u5b89\u5168\u8003\u8651</h3>\n<ul>\n<li>[ ] \u5b9e\u65bd\u6570\u636e\u5b8c\u6574\u6027\u68c0\u67e5</li>\n<li>[ ] \u90e8\u7f72\u5f02\u5e38\u68c0\u6d4b\u673a\u5236</li>\n<li>[ ] \u8003\u8651\u9690\u79c1\u4fdd\u62a4\u9700\u6c42</li>\n<li>[ ] \u5b9a\u671f\u5ba1\u8ba1\u548c\u66f4\u65b0\u5b89\u5168\u7b56\u7565</li>\n</ul>"
  },
  "../chapter17.md": {
    "hash": "63c58bdcb2dbbd5af298a810d32ee895",
    "content": "<h1 id=\"17\">\u7b2c17\u7ae0\uff1a\u9690\u5f0f\u5fae\u5206\u4e0e\u53cc\u5c42\u4f18\u5316</h1>\n<p>\u9690\u5f0f\u5fae\u5206\u548c\u53cc\u5c42\u4f18\u5316\u662f\u73b0\u4ee3\u673a\u5668\u5b66\u4e60\u4e2d\u65e5\u76ca\u91cd\u8981\u7684\u6280\u672f\uff0c\u7279\u522b\u662f\u5728\u5143\u5b66\u4e60\u3001\u8d85\u53c2\u6570\u4f18\u5316\u548c\u795e\u7ecf\u67b6\u6784\u641c\u7d22\u7b49\u9886\u57df\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5982\u4f55\u9ad8\u6548\u8ba1\u7b97\u901a\u8fc7\u9690\u5f0f\u5b9a\u4e49\u7684\u51fd\u6570\u7684\u68af\u5ea6\uff0c\u4ee5\u53ca\u5982\u4f55\u89e3\u51b3\u5d4c\u5957\u4f18\u5316\u95ee\u9898\u3002\u6211\u4eec\u5c06\u7279\u522b\u5173\u6ce8\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\u7684\u8ba1\u7b97\u6311\u6218\u548c\u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898\u3002</p>\n<h2 id=\"171\">17.1 \u9690\u5f0f\u51fd\u6570\u5b9a\u7406\u7684\u8ba1\u7b97\u89c6\u89d2</h2>\n<h3 id=\"_1\">\u4ece\u7ecf\u5178\u5b9a\u7406\u5230\u5b9e\u9645\u8ba1\u7b97</h3>\n<p>\u9690\u5f0f\u51fd\u6570\u5b9a\u7406\u544a\u8bc9\u6211\u4eec\uff0c\u5f53\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u65f6\uff0c\u65b9\u7a0b $F(x, y) = 0$ \u53ef\u4ee5\u9690\u5f0f\u5b9a\u4e49 $y$ \u4f5c\u4e3a $x$ \u7684\u51fd\u6570\u3002\u5728\u8ba1\u7b97\u4e2d\uff0c\u6211\u4eec\u5173\u5fc3\u7684\u662f\u5982\u4f55\u9ad8\u6548\u8ba1\u7b97 $\\frac{dy}{dx}$\u3002</p>\n<p>\u8003\u8651\u5e73\u8861\u65b9\u7a0b\uff1a\n$$F(x, y^*(x)) = 0$$\n\u5176\u4e2d $y^*(x)$ \u662f\u7ed9\u5b9a $x$ \u65f6\u7684\u9690\u5f0f\u89e3\u3002\u901a\u8fc7\u5bf9\u4e24\u8fb9\u6c42\u5bfc\uff0c\u6211\u4eec\u5f97\u5230\uff1a\n$$\\frac{\\partial F}{\\partial x} + \\frac{\\partial F}{\\partial y} \\frac{dy^*}{dx} = 0$$\n\u56e0\u6b64\uff1a\n$$\\frac{dy^*}{dx} = -\\left(\\frac{\\partial F}{\\partial y}\\right)^{-1} \\frac{\\partial F}{\\partial x}$$\n<strong>\u5173\u952e\u6d1e\u5bdf</strong>\uff1a\u6211\u4eec\u4e0d\u9700\u8981\u663e\u5f0f\u8ba1\u7b97\u96c5\u53ef\u6bd4\u77e9\u9635\u7684\u9006\uff0c\u800c\u662f\u89e3\u7ebf\u6027\u7cfb\u7edf\uff1a\n$$\\frac{\\partial F}{\\partial y} v = -\\frac{\\partial F}{\\partial x}$$\n<strong>\u5b9e\u9645\u8ba1\u7b97\u4e2d\u7684\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li><strong>\u7a00\u758f\u6027\u5229\u7528</strong>\uff1a\u5f53 $\\frac{\\partial F}{\\partial y}$ \u7a00\u758f\u65f6\uff0c\u4f7f\u7528\u4e13\u95e8\u7684\u7a00\u758f\u6c42\u89e3\u5668\uff08\u5982SuperLU\u3001UMFPACK\uff09</li>\n<li><strong>\u7ed3\u6784\u5229\u7528</strong>\uff1a\u5757\u5bf9\u89d2\u3001\u5e26\u72b6\u77e9\u9635\u7b49\u7279\u6b8a\u7ed3\u6784\u53ef\u5927\u5e45\u52a0\u901f</li>\n<li><strong>\u7cbe\u5ea6\u63a7\u5236</strong>\uff1a\u6c42\u89e3\u7cbe\u5ea6\u76f4\u63a5\u5f71\u54cd\u6700\u7ec8\u68af\u5ea6\u7cbe\u5ea6\uff0c\u9700\u8981\u81ea\u9002\u5e94\u8c03\u6574</li>\n</ol>\n<p><strong>\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\u573a\u666f</strong>\uff1a</p>\n<ul>\n<li><strong>\u5e73\u8861\u65b9\u7a0b\u7f51\u7edc</strong>\uff1a\u795e\u7ecfODE\u7684\u7a33\u6001\u89e3</li>\n<li><strong>\u80fd\u91cf\u6700\u5c0f\u5316\u5c42</strong>\uff1a\u5982OptNet\u4e2d\u7684\u4e8c\u6b21\u89c4\u5212\u5c42</li>\n<li><strong>\u5f52\u4e00\u5316\u5c42</strong>\uff1aBatchNorm\u3001LayerNorm\u7684\u9690\u5f0f\u8868\u793a</li>\n<li><strong>\u6ce8\u610f\u529b\u673a\u5236</strong>\uff1a\u81ea\u6ce8\u610f\u529b\u7684\u56fa\u5b9a\u70b9\u89c6\u89d2</li>\n</ul>\n<h3 id=\"_2\">\u56fa\u5b9a\u70b9\u8fed\u4ee3\u7684\u9690\u5f0f\u5fae\u5206</h3>\n<p>\u8bb8\u591a\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u53ef\u4ee5\u8868\u793a\u4e3a\u56fa\u5b9a\u70b9\u8fed\u4ee3\uff1a\n$$y^* = T(x, y^*)$$\n\u4f8b\u5982\uff0c\u5728\u5f3a\u5316\u5b66\u4e60\u4e2d\u7684\u7b56\u7565\u8bc4\u4f30\u3001\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u6d88\u606f\u4f20\u9012\u7b49\u3002</p>\n<p>\u5bf9\u4e8e\u56fa\u5b9a\u70b9 $y^*(x)$\uff0c\u9690\u5f0f\u5fae\u5206\u7ed9\u51fa\uff1a\n$$\\frac{dy^*}{dx} = \\left(I - \\frac{\\partial T}{\\partial y}\\right)^{-1} \\frac{\\partial T}{\\partial x}$$\n<strong>Neumann\u7ea7\u6570\u65b9\u6cd5</strong>\uff1a\u5f53 $|\\frac{\\partial T}{\\partial y}| &lt; 1$ \u65f6\uff0c\u53ef\u4ee5\u7528\u7ea7\u6570\u5c55\u5f00\uff1a\n$$\\left(I - \\frac{\\partial T}{\\partial y}\\right)^{-1} = \\sum_{k=0}^{\\infty} \\left(\\frac{\\partial T}{\\partial y}\\right)^k$$\n\u8fd9\u63d0\u4f9b\u4e86\u4e00\u79cd\u8fed\u4ee3\u8ba1\u7b97\u9690\u5f0f\u68af\u5ea6\u7684\u65b9\u6cd5\u3002</p>\n<p><strong>\u6536\u655b\u6027\u52a0\u901f\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Chebyshev\u52a0\u901f</strong>\uff1a\u5229\u7528\u8c31\u4fe1\u606f\u4f18\u5316\u6536\u655b\n$$y_{k+1} = \\omega_k T(x, y_k) + (1-\\omega_k)y_{k-1}$$\n\u5176\u4e2d $\\omega_k$ \u6839\u636e\u8c31\u534a\u5f84\u9009\u62e9</p>\n</li>\n<li>\n<p><strong>Anderson\u52a0\u901f</strong>\uff1a\u5229\u7528\u5386\u53f2\u4fe1\u606f\u6784\u9020\u66f4\u597d\u7684\u4e0b\u4e00\u6b65\n   - \u5b58\u50a8\u6700\u8fd1m\u6b65\u7684\u6b8b\u5dee\n   - \u6700\u5c0f\u4e8c\u4e58\u7ec4\u5408\u83b7\u5f97\u52a0\u901f</p>\n</li>\n<li>\n<p><strong>\u52a8\u91cf\u65b9\u6cd5</strong>\uff1aPolyak\u52a8\u91cf\u7684\u56fa\u5b9a\u70b9\u7248\u672c\n$$z_{k+1} = T(x, y_k), \\quad y_{k+1} = z_{k+1} + \\beta(z_{k+1} - z_k)$$\n<strong>\u5b9e\u9645\u6848\u4f8b\uff1a\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u9690\u5f0f\u5c42</strong></p>\n</li>\n</ol>\n<p>\u8003\u8651\u56fe\u6ce8\u610f\u529b\u7f51\u7edc\u7684\u56fa\u5b9a\u70b9\u5f62\u5f0f\uff1a\n$$h_i^* = \\sigma\\left(\\sum_{j \\in \\mathcal{N}(i)} \\alpha_{ij}(h^*) W h_j^* + b\\right)$$\n\u5176\u4e2d $\\alpha_{ij}$ \u662f\u6ce8\u610f\u529b\u6743\u91cd\u3002\u8fd9\u5b9a\u4e49\u4e86\u4e00\u4e2a\u9690\u5f0f\u7684\u7279\u5f81\u8868\u793a\u3002</p>\n<p><strong>\u8ba1\u7b97\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\u524d\u5411\u4f20\u64ad\uff1a\u7528\u56fa\u5b9a\u70b9\u8fed\u4ee3\u6c42\u89e3 $h^*$</li>\n<li>\u53cd\u5411\u4f20\u64ad\uff1a\u89e3\u7ebf\u6027\u7cfb\u7edf\u8ba1\u7b97\u68af\u5ea6</li>\n<li>\u5185\u5b58\u4f18\u5316\uff1a\u4e0d\u5b58\u50a8\u4e2d\u95f4\u8fed\u4ee3\uff0c\u9700\u8981\u65f6\u91cd\u8ba1\u7b97</li>\n</ol>\n<h3 id=\"_3\">\u77e9\u9635\u65b9\u7a0b\u7684\u9690\u5f0f\u89e3</h3>\n<p>\u8003\u8651Sylvester\u65b9\u7a0b\uff1a\n$$AX + XB = C$$\n\u8fd9\u5728\u63a7\u5236\u7406\u8bba\u548c\u56fe\u4fe1\u53f7\u5904\u7406\u4e2d\u7ecf\u5e38\u51fa\u73b0\u3002\u5f53\u53c2\u6570\u5316 $A(\\theta), B(\\theta), C(\\theta)$ \u65f6\uff0c\u6211\u4eec\u9700\u8981\u8ba1\u7b97 $\\frac{dX}{d\\theta}$\u3002</p>\n<p>\u5229\u7528vec\u7b97\u5b50\u548cKronecker\u79ef\uff1a\n$$(I \\otimes A + B^T \\otimes I) \\text{vec}(X) = \\text{vec}(C)$$\n\u9690\u5f0f\u5fae\u5206\u7ed9\u51fa\u68af\u5ea6\u8ba1\u7b97\u7684\u7ebf\u6027\u7cfb\u7edf\u3002</p>\n<p><strong>\u9ad8\u6548\u6c42\u89e3\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Bartels-Stewart\u7b97\u6cd5</strong>\uff1a\n   - \u5c06A\u548cB\u5316\u4e3aSchur\u5f62\u5f0f\n   - \u5229\u7528\u4e09\u89d2\u7ed3\u6784\u9012\u5f52\u6c42\u89e3\n   - \u590d\u6742\u5ea6 $O(n^3)$\uff0c\u6570\u503c\u7a33\u5b9a</p>\n</li>\n<li>\n<p><strong>Krylov\u5b50\u7a7a\u95f4\u65b9\u6cd5</strong>\uff1a\n   - \u5bf9\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u907f\u514d\u663e\u5f0f\u5f62\u6210Kronecker\u79ef\n   - \u5229\u7528\u77e9\u9635-\u5411\u91cf\u79ef\uff1a$(I \\otimes A + B^T \\otimes I)v = \\text{vec}(A\\text{mat}(v) + \\text{mat}(v)B)$\n   - \u9002\u7528\u4e8e\u7a00\u758fA\u3001B</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u8fd1\u4f3c</strong>\uff1a\n   \u5f53\u89e3\u63a5\u8fd1\u4f4e\u79e9\u65f6\uff1a$X \\approx UV^T$</p>\n</li>\n</ol>\n<ul>\n<li>\u4ea4\u66ff\u65b9\u5411\u6cd5\uff08ADI\uff09</li>\n<li>\u6709\u7406Krylov\u65b9\u6cd5</li>\n<li>\u622a\u65ad\u5947\u5f02\u503c\u5206\u89e3</li>\n</ul>\n<p><strong>\u5e7f\u4e49Sylvester\u65b9\u7a0b</strong>\uff1a\n$$\\sum_{i=1}^k A_i X B_i = C$$\n\u5728\u5f20\u91cf\u5206\u89e3\u3001\u591a\u7ebf\u6027\u7cfb\u7edf\u4e2d\u51fa\u73b0\u3002\u6c42\u89e3\u66f4\u5177\u6311\u6218\u6027\uff0c\u9700\u8981\uff1a</p>\n<ul>\n<li>\u5f20\u91cfKrylov\u65b9\u6cd5</li>\n<li>\u9ad8\u9636\u5947\u5f02\u503c\u5206\u89e3</li>\n<li>\u968f\u673a\u6295\u5f71\u6280\u672f</li>\n</ul>\n<p><strong>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8fde\u7eed\u65f6\u95f4RNN</strong>\uff1a\n   \u72b6\u6001\u65b9\u7a0b $\\dot{X} = AX + XB + f(X)$ \u7684\u7a33\u6001\u89e3</p>\n</li>\n<li>\n<p><strong>\u56fe\u5377\u79ef\u7684\u8c31\u65b9\u6cd5</strong>\uff1a\n   \u56feLaplacian\u7684\u51fd\u6570\u8ba1\u7b97\u6d89\u53ca\u77e9\u9635\u65b9\u7a0b</p>\n</li>\n<li>\n<p><strong>\u77e9\u9635\u8865\u5168\u7684\u6838\u8303\u6570\u6b63\u5219\u5316</strong>\uff1a\n   \u4f18\u5316\u5b50\u95ee\u9898\u5e38\u5f52\u7ed3\u4e3aSylvester\u65b9\u7a0b</p>\n</li>\n</ol>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u5206\u79bb\u5ea6 $\\text{sep}(A, -B) = \\min_{|X|_F=1} |AX + XB|_F$ \u51b3\u5b9a\u6761\u4ef6\u6570</li>\n<li>\u5f53\u5206\u79bb\u5ea6\u5c0f\u65f6\uff0c\u9700\u8981\u6b63\u5219\u5316\u6216\u8fed\u4ee3\u7cbe\u5316</li>\n<li>\u5bf9\u75c5\u6001\u95ee\u9898\uff0c\u8003\u8651\u6270\u52a8\u5206\u6790\u548c\u533a\u95f4\u7b97\u6cd5</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528\u77e9\u9635\u65b9\u7a0b\u7684\u7279\u6b8a\u7ed3\u6784\u52a0\u901f\u6c42\u89e3</li>\n<li>\u4f4e\u79e9\u8fd1\u4f3c\u5728\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\u7684\u5e94\u7528</li>\n<li>\u968f\u673a\u5316\u65b9\u6cd5\u7684\u8bef\u5dee\u5206\u6790</li>\n<li>\u91cf\u5b50\u7b97\u6cd5\u542f\u53d1\u7684\u65b0\u6c42\u89e3\u7b56\u7565</li>\n<li>\u975e\u7ebf\u6027\u77e9\u9635\u65b9\u7a0b\u7684\u9690\u5f0f\u5fae\u5206\u7406\u8bba</li>\n</ul>\n<h2 id=\"172\">17.2 \u5927\u89c4\u6a21\u7ebf\u6027\u7cfb\u7edf\u7684\u9ad8\u6548\u6c42\u89e3</h2>\n<h3 id=\"_4\">\u8fed\u4ee3\u6c42\u89e3\u5668\u7684\u9009\u62e9\u7b56\u7565</h3>\n<p>\u5728\u9690\u5f0f\u5fae\u5206\u4e2d\uff0c\u6838\u5fc3\u8ba1\u7b97\u662f\u6c42\u89e3\u5f62\u5982 $Jv = r$ \u7684\u7ebf\u6027\u7cfb\u7edf\uff0c\u5176\u4e2d $J = \\frac{\\partial F}{\\partial y}$\u3002</p>\n<p><strong>\u6c42\u89e3\u5668\u9009\u62e9\u51b3\u7b56\u6811</strong>\uff1a</p>\n<ol>\n<li><strong>\u5bf9\u79f0\u6b63\u5b9a</strong>\uff1a\u5171\u8f6d\u68af\u5ea6\u6cd5\uff08CG\uff09</li>\n<li><strong>\u5bf9\u79f0\u4e0d\u5b9a</strong>\uff1aMINRES</li>\n<li><strong>\u975e\u5bf9\u79f0</strong>\uff1aGMRES\u6216BiCGSTAB</li>\n<li><strong>\u7ed3\u6784\u5316</strong>\uff1a\u4e13\u7528\u6c42\u89e3\u5668\uff08\u5982FFT-based\uff09</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u9009\u62e9\u6307\u5357</strong>\uff1a</p>\n<p>| \u77e9\u9635\u6027\u8d28 | \u63a8\u8350\u6c42\u89e3\u5668 | \u5907\u9009\u65b9\u6848 | \u9002\u7528\u573a\u666f |</p>\n<table>\n<thead>\n<tr>\n<th>\u77e9\u9635\u6027\u8d28</th>\n<th>\u63a8\u8350\u6c42\u89e3\u5668</th>\n<th>\u5907\u9009\u65b9\u6848</th>\n<th>\u9002\u7528\u573a\u666f</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u5bf9\u79f0\u6b63\u5b9a</td>\n<td>CG</td>\n<td>PCG\u3001Chebyshev</td>\n<td>\u692d\u5706\u578bPDE\u3001\u6b63\u5219\u5316\u6700\u5c0f\u4e8c\u4e58</td>\n</tr>\n<tr>\n<td>\u5bf9\u79f0\u4e0d\u5b9a</td>\n<td>MINRES</td>\n<td>SYMMLQ\u3001CR</td>\n<td>\u978d\u70b9\u95ee\u9898\u3001\u7ea6\u675f\u4f18\u5316</td>\n</tr>\n<tr>\n<td>\u975e\u5bf9\u79f0</td>\n<td>GMRES(m)</td>\n<td>BiCGSTAB\u3001QMR</td>\n<td>\u5bf9\u6d41\u6269\u6563\u3001\u975e\u5bf9\u79f0\u9884\u6761\u4ef6</td>\n</tr>\n<tr>\n<td>\u6b63\u89c4\u77e9\u9635</td>\n<td>GMRES</td>\n<td>Richardson</td>\n<td>\u8c31\u65b9\u6cd5\u3001\u7279\u5f81\u503c\u95ee\u9898</td>\n</tr>\n<tr>\n<td>\u5757\u7ed3\u6784</td>\n<td>Block-CG</td>\n<td>Block-GMRES</td>\n<td>\u591a\u53f3\u7aef\u9879\u3001\u53c2\u6570\u5316\u95ee\u9898</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u6536\u655b\u6027\u4f30\u8ba1</strong>\uff1a</p>\n<ul>\n<li>CG\u6536\u655b\u901f\u7387\uff1a$|e_k| \\leq 2\\left(\\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}\\right)^k |e_0|$</li>\n<li>GMRES\u6b8b\u5dee\u5355\u8c03\u9012\u51cf\uff1a$|r_k| = \\min_{p \\in \\mathcal{P}_k} |p(A)r_0|$</li>\n<li>BiCGSTAB\uff1a\u975e\u5355\u8c03\u4f46\u901a\u5e38\u66f4\u5feb\uff0c\u9002\u5408\u975e\u5bf9\u79f0\u4f46\u8c31\u63a5\u8fd1\u5b9e\u8f74\u7684\u95ee\u9898</li>\n</ul>\n<p><strong>\u5b9e\u9645\u6027\u80fd\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5185\u5b58\u9700\u6c42</strong>\uff1a\n   - CG/BiCGSTAB\uff1a$O(n)$ \u5b58\u50a8\n   - GMRES(m)\uff1a$O(mn)$ \u5b58\u50a8\uff0c\u9700\u8981\u91cd\u542f\u7b56\u7565\n   - MINRES\uff1a$O(n)$ \u4f46\u9700\u8981\u66f4\u591a\u5411\u91cf</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u6210\u672c</strong>\uff1a\n   - \u6bcf\u6b65\u8fed\u4ee3\uff1a1-2\u6b21\u77e9\u9635\u5411\u91cf\u79ef\n   - \u9884\u6761\u4ef6\u5e94\u7528\uff1a\u901a\u5e38\u662f\u74f6\u9888\n   - \u6b63\u4ea4\u5316\uff1aGMRES\u4e2d\u7684\u4e3b\u8981\u5f00\u9500</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u6027</strong>\uff1a\n   - \u77e9\u9635\u5411\u91cf\u79ef\uff1a\u6613\u5e76\u884c\n   - \u70b9\u79ef\uff1a\u5168\u5c40\u901a\u4fe1\u74f6\u9888\n   - \u6d41\u6c34\u7ebfCG\uff1a\u9690\u85cf\u901a\u4fe1\u5ef6\u8fdf</p>\n</li>\n</ol>\n<h3 id=\"_5\">\u9884\u6761\u4ef6\u5b50\u5728\u9690\u5f0f\u5fae\u5206\u4e2d\u7684\u4f5c\u7528</h3>\n<p>\u826f\u597d\u7684\u9884\u6761\u4ef6\u5b50 $P \\approx J$ \u53ef\u4ee5\u663e\u8457\u52a0\u901f\u6536\u655b\uff1a\n$$P^{-1}Jv = P^{-1}r$$\n<strong>\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\u539f\u5219</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e0d\u5b8c\u5168\u5206\u89e3</strong>\uff1aILU\u3001\u4e0d\u5b8c\u5168Cholesky\n   - ILU(0)\uff1a\u4fdd\u6301\u7a00\u758f\u6a21\u5f0f\n   - ILU(k)\uff1a\u5141\u8bb8k\u7ea7\u586b\u5145\n   - ILUT\uff1a\u57fa\u4e8e\u9608\u503c\u7684\u4e22\u5f03</p>\n</li>\n<li>\n<p><strong>\u4ee3\u6570\u591a\u91cd\u7f51\u683c</strong>\uff1a\u9002\u7528\u4e8ePDE\u76f8\u5173\u95ee\u9898\n   - \u7ecf\u5178AMG\uff1a\u57fa\u4e8e\u5f3a\u8fde\u63a5\n   - \u805a\u5408AMG\uff1a\u66f4\u9c81\u68d2\n   - SA-AMG\uff1a\u5149\u6ed1\u805a\u5408</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u66f4\u65b0</strong>\uff1a\u5229\u7528\u95ee\u9898\u7684\u589e\u91cf\u7279\u6027\n   - Woodbury\u516c\u5f0f\uff1a$(A + UV^T)^{-1} = A^{-1} - A^{-1}U(I + V^TA^{-1}U)^{-1}V^TA^{-1}$\n   - \u9012\u5f52\u66f4\u65b0\uff1a\u4fdd\u6301\u6709\u9650\u5386\u53f2</p>\n</li>\n<li>\n<p><strong>\u7269\u7406\u542f\u53d1</strong>\uff1a\u57fa\u4e8e\u95ee\u9898\u9886\u57df\u77e5\u8bc6\n   - \u7269\u7406\u7f51\u683c\u7684\u591a\u91cd\u7f51\u683c\n   - \u9891\u57df\u7684FFT\u9884\u6761\u4ef6\n   - \u65f6\u57df\u7684\u9690\u5f0f\u65f6\u95f4\u6b65\u8fdb</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u9884\u6761\u4ef6\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57df\u5206\u89e3\u65b9\u6cd5</strong>\uff1a\n   - \u52a0\u6027Schwarz\uff1a$P^{-1} = \\sum_i R_i^T A_i^{-1} R_i$\n   - \u4e58\u6027Schwarz\uff1a\u66f4\u597d\u6536\u655b\u4f46\u4e32\u884c\n   - FETI/BDDC\uff1a\u5e73\u8861\u57df\u5206\u89e3</p>\n</li>\n<li>\n<p><strong>\u591a\u7ea7\u9884\u6761\u4ef6</strong>\uff1a\n   <code>\u7c97\u7f51\u683c\u6821\u6b63 + \u7ec6\u7f51\u683c\u5149\u6ed1\n   V-cycle: \u9650\u5236 \u2192 \u7c97\u7f51\u683c\u6c42\u89e3 \u2192 \u5ef6\u62d3\n   W-cycle: \u66f4\u9c81\u68d2\u4f46\u8ba1\u7b97\u91cf\u5927</code></p>\n</li>\n<li>\n<p><strong>\u8c31\u9884\u6761\u4ef6</strong>\uff1a\n   - \u591a\u9879\u5f0f\u9884\u6761\u4ef6\uff1a$P^{-1} = p(A)$\n   - \u6709\u7406\u51fd\u6570\u9884\u6761\u4ef6\uff1a\u66f4\u7075\u6d3b\n   - \u5faa\u73af\u77e9\u9635\u8fd1\u4f3c\uff1aFFT\u52a0\u901f</p>\n</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u9884\u6761\u4ef6</strong>\uff1a\n\u5728\u4f18\u5316\u8fc7\u7a0b\u4e2d\uff0c\u96c5\u53ef\u6bd4\u77e9\u9635\u4f1a\u53d8\u5316\u3002\u53ef\u4ee5\u4f7f\u7528\uff1a</p>\n<ul>\n<li>BFGS\u578b\u66f4\u65b0\u7ef4\u62a4\u9884\u6761\u4ef6\u5b50</li>\n<li>\u5468\u671f\u6027\u91cd\u8ba1\u7b97\u7b56\u7565</li>\n<li>\u57fa\u4e8e\u6536\u655b\u5386\u53f2\u7684\u81ea\u9002\u5e94\u9009\u62e9</li>\n</ul>\n<p><strong>\u5b9e\u7528\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span>\u8fed\u4ee3\u6b21\u6570<span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span>\u9608\u503c:\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span>\u4f7f\u7528\u7b80\u5355\u9884\u6761\u4ef6:\n<span class=\"w\">        </span>\u5347\u7ea7\u5230\u66f4\u590d\u6742\u9884\u6761\u4ef6\n<span class=\"w\">    </span><span class=\"nv\">elif</span><span class=\"w\"> </span>\u77e9\u9635\u53d8\u5316\u5927:\n<span class=\"w\">        </span>\u91cd\u65b0\u8ba1\u7b97\u9884\u6761\u4ef6\u5b50\n<span class=\"w\">    </span><span class=\"k\">else</span>:\n<span class=\"w\">        </span>\u589e\u52a0\u9884\u6761\u4ef6\u7cbe\u5ea6\n</code></pre></div>\n\n<h3 id=\"_6\">\u8fd1\u4f3c\u6c42\u89e3\u7684\u8bef\u5dee\u4f20\u64ad\u5206\u6790</h3>\n<p>\u5b9e\u8df5\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u53ea\u80fd\u8fd1\u4f3c\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf\u3002\u8bbe $\\tilde{v}$ \u662f\u8fd1\u4f3c\u89e3\uff0c\u6ee1\u8db3\uff1a\n$$|J\\tilde{v} - r| \\leq \\epsilon |r|$$\n<strong>\u8bef\u5dee\u4f20\u64ad\u5b9a\u7406</strong>\uff1a\n\u9690\u5f0f\u68af\u5ea6\u7684\u8bef\u5dee\u6ee1\u8db3\uff1a\n$$|\\nabla_x L - \\tilde{\\nabla}_x L| \\leq C \\cdot \\epsilon \\cdot |\\nabla_y L|$$\n\u5176\u4e2d $C$ \u4f9d\u8d56\u4e8e\u95ee\u9898\u7684\u6761\u4ef6\u6570\u3002</p>\n<p><strong>\u7cbe\u7ec6\u5316\u8bef\u5dee\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u524d\u5411\u8bef\u5dee\u754c</strong>\uff1a\n$$\\frac{|v - \\tilde{v}|}{|v|} \\leq \\kappa(J) \\frac{|J\\tilde{v} - r|}{|r|}$$</p>\n</li>\n<li>\n<p><strong>\u540e\u5411\u8bef\u5dee\u5206\u6790</strong>\uff1a\n   $\\tilde{v}$ \u662f\u6270\u52a8\u95ee\u9898 $(J + \\Delta J)\\tilde{v} = r + \\Delta r$ \u7684\u7cbe\u786e\u89e3</p>\n</li>\n<li>\n<p><strong>\u6982\u7387\u8bef\u5dee\u4f30\u8ba1</strong>\uff1a\n   \u5bf9\u968f\u673a\u5316\u6c42\u89e3\u5668\uff1a$\\mathbb{E}[|v - \\tilde{v}|^2] \\leq f(\\epsilon, \\kappa)$</p>\n</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u4e8e\u76ee\u6807\u7684\u505c\u6b62\u51c6\u5219</strong>\uff1a\n   <code>\u76ee\u6807\uff1a|\\nabla_x L|\u7684\u76f8\u5bf9\u8bef\u5dee &lt; tol\n   \u63a8\u5bfc\uff1a\u7ebf\u6027\u6c42\u89e3\u5668\u5bb9\u5dee = tol / (C * |\\nabla_y L|)</code></p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u8c03\u6574\u7b56\u7565</strong>\uff1a\n   - \u521d\u671f\uff1a\u7c97\u7cbe\u5ea6\u5feb\u901f\u8fed\u4ee3\n   - \u4e2d\u671f\uff1a\u6839\u636e\u6536\u655b\u901f\u5ea6\u8c03\u6574\n   - \u540e\u671f\uff1a\u9ad8\u7cbe\u5ea6\u786e\u4fdd\u51c6\u786e\u6027</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u6846\u67b6</strong>\uff1a\n   - \u4f4e\u7cbe\u5ea6\uff1a\u63a2\u7d22\u9636\u6bb5\n   - \u9ad8\u7cbe\u5ea6\uff1a\u6536\u655b\u9636\u6bb5\n   - \u81ea\u52a8\u5207\u6362\uff1a\u57fa\u4e8e\u8fdb\u5ea6\u6307\u6807</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u7528\u6307\u5357</strong>\uff1a</p>\n<ul>\n<li>\u6839\u636e\u6700\u7ec8\u68af\u5ea6\u7cbe\u5ea6\u8981\u6c42\u8bbe\u7f6e\u6c42\u89e3\u5668\u5bb9\u5dee</li>\n<li>\u76d1\u63a7\u6b8b\u5dee\u8303\u6570\u7684\u4e0b\u964d\u66f2\u7ebf</li>\n<li>\u4f7f\u7528\u6e29\u542f\u52a8\u6280\u672f\u5229\u7528\u4e4b\u524d\u7684\u89e3</li>\n<li>\u5b9e\u65bd\u65e9\u505c\u907f\u514d\u8fc7\u5ea6\u6c42\u89e3</li>\n</ul>\n<p><strong>\u7279\u6b8a\u7ed3\u6784\u7684\u5229\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5757\u5bf9\u89d2\u4e3b\u5bfc</strong>\uff1a\n   <code>J = [A  B]\n       [C  D]\n   \u5176\u4e2dA\u3001D\u662f\u4e3b\u8981\u5757</code>\n   \u4f7f\u7528\u5757\u6d88\u53bb\u6216\u8fd1\u4f3cSchur\u8865</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u6270\u52a8</strong>\uff1a\n   $J = J_0 + UV^T$\uff0c\u5176\u4e2d $U, V \\in \\mathbb{R}^{n \\times k}$, $k \\ll n$</p>\n</li>\n</ol>\n<ul>\n<li>Sherman-Morrison-Woodbury\u516c\u5f0f</li>\n<li>\u4fdd\u6301 $J_0^{-1}$ \u6216\u5176\u8fd1\u4f3c</li>\n</ul>\n<ol start=\"3\">\n<li><strong>Kronecker\u7ed3\u6784</strong>\uff1a\n   $J = A \\otimes B + C \\otimes D$</li>\n</ol>\n<ul>\n<li>\u5229\u7528Kronecker\u79ef\u6027\u8d28</li>\n<li>\u964d\u7ef4\u5230\u5c0f\u89c4\u6a21Sylvester\u65b9\u7a0b</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236\u7b97\u6cd5</li>\n<li>\u968f\u673a\u6c42\u89e3\u5668\u7684\u65b9\u5dee\u5206\u6790</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u673a\u5668\u5b66\u4e60\u52a0\u901f\u7684\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</li>\n<li>\u91cf\u5b50\u7ebf\u6027\u6c42\u89e3\u5668\u7684\u7ecf\u5178\u6a21\u62df</li>\n</ul>\n<h2 id=\"173\">17.3 \u81ea\u52a8\u5fae\u5206\u7684\u9ad8\u7ea7\u6280\u5de7</h2>\n<h3 id=\"vs\">\u524d\u5411\u6a21\u5f0fvs\u53cd\u5411\u6a21\u5f0f\u7684\u6743\u8861</h3>\n<p>\u5728\u9690\u5f0f\u5fae\u5206\u4e2d\uff0c\u9009\u62e9\u5408\u9002\u7684AD\u6a21\u5f0f\u81f3\u5173\u91cd\u8981\uff1a</p>\n<p><strong>\u524d\u5411\u6a21\u5f0f\u4f18\u52bf\u573a\u666f</strong>\uff1a</p>\n<ul>\n<li>\u8f93\u5165\u7ef4\u5ea6\u8fdc\u5c0f\u4e8e\u8f93\u51fa\u7ef4\u5ea6</li>\n<li>\u9700\u8981\u8ba1\u7b97Hessian-vector\u79ef</li>\n<li>\u5b9e\u65f6/\u5728\u7ebf\u8ba1\u7b97\u9700\u6c42</li>\n</ul>\n<p><strong>\u53cd\u5411\u6a21\u5f0f\u4f18\u52bf\u573a\u666f</strong>\uff1a</p>\n<ul>\n<li>\u8f93\u51fa\u7ef4\u5ea6\u5c0f\uff08\u5982\u6807\u91cf\u635f\u5931\uff09</li>\n<li>\u5185\u5b58\u5145\u8db3</li>\n<li>\u6279\u5904\u7406\u573a\u666f</li>\n</ul>\n<p><strong>\u8be6\u7ec6\u6bd4\u8f83</strong>\uff1a</p>\n<p>| \u7279\u6027 | \u524d\u5411\u6a21\u5f0f | \u53cd\u5411\u6a21\u5f0f |</p>\n<table>\n<thead>\n<tr>\n<th>\u7279\u6027</th>\n<th>\u524d\u5411\u6a21\u5f0f</th>\n<th>\u53cd\u5411\u6a21\u5f0f</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u8ba1\u7b97\u56fe\u904d\u5386</td>\n<td>\u4e00\u6b21\u524d\u5411</td>\n<td>\u4e00\u6b21\u524d\u5411+\u4e00\u6b21\u53cd\u5411</td>\n</tr>\n<tr>\n<td>\u5185\u5b58\u9700\u6c42</td>\n<td>$O(1)$</td>\n<td>$O(n)$ \u4e2d\u95f4\u503c\u5b58\u50a8</td>\n</tr>\n<tr>\n<td>\u8ba1\u7b97\u590d\u6742\u5ea6</td>\n<td>$O(n_{\\text{in}} \\cdot \\text{ops})$</td>\n<td>$O(n_{\\text{out}} \\cdot \\text{ops})$</td>\n</tr>\n<tr>\n<td>\u9002\u7528\u4e8e</td>\n<td>$n_{\\text{in}} \\ll n_{\\text{out}}$</td>\n<td>$n_{\\text{out}} \\ll n_{\\text{in}}$</td>\n</tr>\n<tr>\n<td>\u5e76\u884c\u6027</td>\n<td>\u8f93\u5165\u7ef4\u5ea6\u5e76\u884c</td>\n<td>\u94fe\u5f0f\u6cd5\u5219\u4e32\u884c</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u6df7\u5408\u7b56\u7565</strong>\uff1a\n\u5bf9\u4e8e\u9690\u5f0f\u5fae\u5206\uff0c\u5e38\u7528\u7684\u6a21\u5f0f\u662f\uff1a</p>\n<ol>\n<li>\u524d\u5411\u6a21\u5f0f\u8ba1\u7b97 $\\frac{\\partial F}{\\partial x}$ \u548c $\\frac{\\partial F}{\\partial y}$</li>\n<li>\u8fed\u4ee3\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf</li>\n<li>\u53cd\u5411\u6a21\u5f0f\u4f20\u64ad\u6700\u7ec8\u68af\u5ea6</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u6df7\u5408\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4ea4\u53c9\u6a21\u5f0f\uff08Cross-country\uff09</strong>\uff1a\n   - \u90e8\u5206\u524d\u5411\u3001\u90e8\u5206\u53cd\u5411\n   - \u57fa\u4e8e\u8ba1\u7b97\u56fe\u7ed3\u6784\u4f18\u5316\n   - \u6700\u5c0f\u5316\u603b\u4f53\u8ba1\u7b97\u91cf</p>\n</li>\n<li>\n<p><strong>\u5411\u91cf\u96c5\u53ef\u6bd4\u79ef\uff08VJP\uff09vs \u96c5\u53ef\u6bd4\u5411\u91cf\u79ef\uff08JVP\uff09</strong>\uff1a\n   <code>VJP: v^T J = \u53cd\u5411\u6a21\u5f0f\u81ea\u7136\u8ba1\u7b97\n   JVP: J v = \u524d\u5411\u6a21\u5f0f\u81ea\u7136\u8ba1\u7b97</code>\n   \u9009\u62e9\u53d6\u51b3\u4e8e\u5177\u4f53\u9700\u6c42</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u96c5\u53ef\u6bd4\u7684\u9ad8\u6548\u8ba1\u7b97</strong>\uff1a\n   - \u7740\u8272\u7b97\u6cd5\uff1a\u5c06\u5217\u5206\u7ec4\u4ee5\u51cf\u5c11\u8ba1\u7b97\n   - \u538b\u7f29\u611f\u77e5\uff1a\u5229\u7528\u7a00\u758f\u6027\n   - \u968f\u673a\u63a2\u6d4b\uff1a\u6982\u7387\u65b9\u6cd5</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u6848\u4f8b\uff1a\u795e\u7ecfODE\u7684\u9690\u5f0f\u5fae\u5206</strong></p>\n<p>\u8003\u8651ODE\uff1a$\\frac{dy}{dt} = f(y, t, \\theta)$</p>\n<p>\u4f34\u968f\u65b9\u6cd5\u8ba1\u7b97\u68af\u5ea6\uff1a</p>\n<ol>\n<li>\u524d\u5411\u6c42\u89e3ODE\u5f97\u5230\u8f68\u8ff9</li>\n<li>\u53cd\u5411\u6c42\u89e3\u4f34\u968fODE\uff1a$\\frac{da}{dt} = -a^T \\frac{\\partial f}{\\partial y}$</li>\n<li>\u53c2\u6570\u68af\u5ea6\uff1a$\\frac{dL}{d\\theta} = \\int a^T \\frac{\\partial f}{\\partial \\theta} dt$</li>\n</ol>\n<p>\u8fd9\u662f\u524d\u5411-\u53cd\u5411\u6df7\u5408\u7684\u5178\u578b\u4f8b\u5b50\u3002</p>\n<h3 id=\"_7\">\u68c0\u67e5\u70b9\u6280\u672f\u4e0e\u5185\u5b58\u4f18\u5316</h3>\n<p>\u5728\u6df1\u5ea6\u6a21\u578b\u4e2d\uff0c\u5b58\u50a8\u6240\u6709\u4e2d\u95f4\u6fc0\u6d3b\u503c\u4f1a\u6d88\u8017\u5927\u91cf\u5185\u5b58\u3002\u68c0\u67e5\u70b9\u6280\u672f\u901a\u8fc7\u65f6\u95f4\u6362\u7a7a\u95f4\uff1a</p>\n<p><strong>\u57fa\u672c\u68c0\u67e5\u70b9\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u5747\u5300\u68c0\u67e5\u70b9\uff1a\u6bcf $\\sqrt{n}$ \u5c42\u4fdd\u5b58\u4e00\u6b21</li>\n<li>\u81ea\u9002\u5e94\u68c0\u67e5\u70b9\uff1a\u57fa\u4e8e\u5185\u5b58\u9884\u7b97\u52a8\u6001\u51b3\u5b9a</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u68c0\u67e5\u70b9\uff1a\u5173\u952e\u5c42\u9ad8\u7cbe\u5ea6\uff0c\u5176\u4ed6\u4f4e\u7cbe\u5ea6</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u68c0\u67e5\u70b9\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6700\u4f18\u68c0\u67e5\u70b9\u653e\u7f6e</strong>\uff08Griewank &amp; Walther\uff09\uff1a\n   - \u52a8\u6001\u89c4\u5212\u6c42\u89e3\u6700\u4f18\u7b56\u7565\n   - \u6700\u5c0f\u5316\u91cd\u8ba1\u7b97\u6b21\u6570\n   - \u8003\u8651\u4e0d\u540c\u5c42\u7684\u8ba1\u7b97\u6210\u672c</p>\n</li>\n<li>\n<p><strong>\u9012\u5f52\u4e8c\u5206\u7b56\u7565</strong>\uff1a\n   <code>checkpoint_recursive(start, end, budget):\n       if budget == 0:\n           \u91cd\u8ba1\u7b97\u6240\u6709\n       else:\n           mid = (start + end) // 2\n           \u4fdd\u5b58mid\u5904\u7684\u6fc0\u6d3b\u503c\n           \u5206\u914d\u9884\u7b97\u7ed9\u4e24\u534a</code></p>\n</li>\n<li>\n<p><strong>\u9009\u62e9\u6027\u68c0\u67e5\u70b9</strong>\uff1a\n   - \u57fa\u4e8e\u6fc0\u6d3b\u503c\u5927\u5c0f\n   - \u57fa\u4e8e\u91cd\u8ba1\u7b97\u6210\u672c\n   - \u57fa\u4e8e\u68af\u5ea6\u91cd\u8981\u6027</p>\n</li>\n</ol>\n<p><strong>\u9690\u5f0f\u5fae\u5206\u7684\u7279\u6b8a\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u56fa\u5b9a\u70b9\u8fed\u4ee3\u7684\u4e2d\u95f4\u72b6\u6001\u53ef\u4ee5\u91cd\u8ba1\u7b97</li>\n<li>\u5229\u7528\u95ee\u9898\u7684\u9a6c\u5c14\u53ef\u592b\u6027\u8d28\u51cf\u5c11\u5b58\u50a8</li>\n<li>\u5f02\u6b65\u68c0\u67e5\u70b9\u4e0e\u8ba1\u7b97\u91cd\u53e0</li>\n</ul>\n<p><strong>\u5185\u5b58\u9ad8\u6548\u7684\u9690\u5f0f\u5fae\u5206\u5b9e\u73b0</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5c31\u5730\u64cd\u4f5c</strong>\uff1a\n   - \u590d\u7528\u8f93\u5165\u5185\u5b58\u5b58\u50a8\u8f93\u51fa\n   - \u6ce8\u610f\u4fdd\u6301\u68af\u5ea6\u8ba1\u7b97\u6b63\u786e\u6027</p>\n</li>\n<li>\n<p><strong>\u6d41\u5f0f\u8ba1\u7b97</strong>\uff1a\n   - \u5206\u5757\u5904\u7406\u5927\u77e9\u9635\n   - \u91cd\u53e0\u8ba1\u7b97\u4e0e\u6570\u636e\u4f20\u8f93</p>\n</li>\n<li>\n<p><strong>\u538b\u7f29\u5b58\u50a8</strong>\uff1a\n   - \u91cf\u5316\u6fc0\u6d3b\u503c\n   - \u7a00\u758f\u8868\u793a\n   - \u4f4e\u79e9\u5206\u89e3</p>\n</li>\n</ol>\n<p><strong>\u6848\u4f8b\uff1aTransformer\u7684\u5185\u5b58\u4f18\u5316</strong></p>\n<p>\u81ea\u6ce8\u610f\u529b\u7684\u5185\u5b58\u74f6\u9888\uff1a$O(n^2)$ \u7684\u6ce8\u610f\u529b\u77e9\u9635</p>\n<p>\u4f18\u5316\u7b56\u7565\uff1a</p>\n<ol>\n<li><strong>FlashAttention</strong>\uff1a\u5206\u5757\u8ba1\u7b97\uff0c\u878d\u5408kernel</li>\n<li><strong>Reformer</strong>\uff1aLSH\u6ce8\u610f\u529b\uff0c$O(n\\log n)$</li>\n<li><strong>Linformer</strong>\uff1a\u4f4e\u79e9\u6295\u5f71\uff0c$O(nk)$</li>\n</ol>\n<h3 id=\"_8\">\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7b56\u7565</h3>\n<p>\u5728\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\uff0c\u6df7\u5408\u7cbe\u5ea6\u53ef\u4ee5\u663e\u8457\u63d0\u5347\u6027\u80fd\uff1a</p>\n<p><strong>\u7cbe\u5ea6\u5206\u914d\u539f\u5219</strong>\uff1a</p>\n<ol>\n<li><strong>\u524d\u5411\u8ba1\u7b97</strong>\uff1aFP16/BF16</li>\n<li><strong>\u68af\u5ea6\u7d2f\u79ef</strong>\uff1aFP32</li>\n<li><strong>\u7ebf\u6027\u6c42\u89e3\u5668</strong>\uff1a\u6839\u636e\u6761\u4ef6\u6570\u9009\u62e9</li>\n<li><strong>\u53c2\u6570\u66f4\u65b0</strong>\uff1aFP32\u4e3b\u6743\u91cd</li>\n</ol>\n<p><strong>\u7cbe\u5ea6\u5c42\u6b21\u8be6\u89e3</strong>\uff1a</p>\n<p>| \u7cbe\u5ea6\u7c7b\u578b | \u4f4d\u5bbd | \u52a8\u6001\u8303\u56f4 | \u7cbe\u5ea6 | \u4f7f\u7528\u573a\u666f |</p>\n<table>\n<thead>\n<tr>\n<th>\u7cbe\u5ea6\u7c7b\u578b</th>\n<th>\u4f4d\u5bbd</th>\n<th>\u52a8\u6001\u8303\u56f4</th>\n<th>\u7cbe\u5ea6</th>\n<th>\u4f7f\u7528\u573a\u666f</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>FP32</td>\n<td>32</td>\n<td>$\\pm 3.4 \\times 10^{38}$</td>\n<td>7\u4f4d\u5c0f\u6570</td>\n<td>\u6807\u51c6\u8bad\u7ec3</td>\n</tr>\n<tr>\n<td>FP16</td>\n<td>16</td>\n<td>$\\pm 65504$</td>\n<td>3\u4f4d\u5c0f\u6570</td>\n<td>\u524d\u5411\u4f20\u64ad</td>\n</tr>\n<tr>\n<td>BF16</td>\n<td>16</td>\n<td>$\\pm 3.4 \\times 10^{38}$</td>\n<td>2\u4f4d\u5c0f\u6570</td>\n<td>\u66f4\u597d\u7684\u8303\u56f4</td>\n</tr>\n<tr>\n<td>INT8</td>\n<td>8</td>\n<td>$\\pm 127$</td>\n<td>\u6574\u6570</td>\n<td>\u63a8\u7406\u91cf\u5316</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u969c</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u635f\u5931\u7f29\u653e</li>\n<li>\u68af\u5ea6\u88c1\u526a</li>\n<li>Kahan\u6c42\u548c\u7528\u4e8e\u7d2f\u79ef</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u6df7\u5408\u7cbe\u5ea6\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li><strong>\u81ea\u52a8\u6df7\u5408\u7cbe\u5ea6\uff08AMP\uff09</strong>\uff1a\n   ```python\n   # \u4f2a\u4ee3\u7801\n   with autocast():\n       output = model(input)  # FP16\u8ba1\u7b97\n       loss = loss_fn(output)  # FP32\u635f\u5931</li>\n</ol>\n<p># \u68af\u5ea6\u7f29\u653e\n   scaled_loss = loss * scale_factor\n   scaled_loss.backward()</p>\n<p># \u68af\u5ea6\u53cd\u7f29\u653e\u548c\u88c1\u526a\n   unscale_gradients()\n   clip_gradients()\n   optimizer.step()\n   ```</p>\n<ol start=\"2\">\n<li>\n<p><strong>\u5f20\u91cf\u6838\u5fc3\u5229\u7528</strong>\uff1a\n   - \u786e\u4fdd\u77e9\u9635\u7ef4\u5ea6\u662f8\u7684\u500d\u6570\n   - \u4f7f\u7528\u5408\u9002\u7684\u6570\u636e\u5e03\u5c40\n   - \u878d\u5408\u64cd\u4f5c\u51cf\u5c11\u5185\u5b58\u8bbf\u95ee</p>\n</li>\n<li>\n<p><strong>\u7cbe\u5ea6\u81ea\u9002\u5e94\u7b97\u6cd5</strong>\uff1a\n   - \u76d1\u63a7\u6570\u503c\u7a33\u5b9a\u6027\u6307\u6807\n   - \u52a8\u6001\u8c03\u6574\u7cbe\u5ea6\u7ea7\u522b\n   - \u5173\u952e\u8def\u5f84\u4fdd\u6301\u9ad8\u7cbe\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u9690\u5f0f\u5fae\u5206\u7684\u6df7\u5408\u7cbe\u5ea6\u6311\u6218</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u654f\u611f\u6027</strong>\uff1a\n   - \u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3\u5bf9\u7cbe\u5ea6\u654f\u611f\n   - \u53ef\u80fd\u9700\u8981\u8fed\u4ee3\u7cbe\u5316\n   - \u8003\u8651\u4f7f\u7528\u53cc\u7cbe\u5ea6\u6c42\u89e3\u6838\u5fc3\u7cfb\u7edf</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u7d2f\u79ef\u8bef\u5dee</strong>\uff1a\n   - \u957f\u5e8f\u5217\u7684\u8bef\u5dee\u7d2f\u79ef\n   - \u4f7f\u7528\u8865\u507f\u6c42\u548c\u6280\u672f\n   - \u5468\u671f\u6027\u9ad8\u7cbe\u5ea6\u6821\u6b63</p>\n</li>\n<li>\n<p><strong>\u6536\u655b\u6027\u4fdd\u8bc1</strong>\uff1a\n   - \u7406\u8bba\u5206\u6790\u6df7\u5408\u7cbe\u5ea6\u7684\u6536\u655b\u6027\n   - \u5b9e\u9a8c\u9a8c\u8bc1\u4e0d\u540c\u7cbe\u5ea6\u7ec4\u5408\n   - \u5efa\u7acb\u7cbe\u5ea6\u9009\u62e9\u51c6\u5219</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u8df5\u5efa\u8bae</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5c42\u7cbe\u5ea6\u7b56\u7565</strong>\uff1a\n   <code>\u5173\u952e\u8ba1\u7b97\uff08\u7ebf\u6027\u6c42\u89e3\uff09: FP32/FP64\n   \u4e00\u822c\u524d\u5411\u4f20\u64ad: FP16/BF16\n   \u6fc0\u6d3b\u5b58\u50a8: INT8\uff08\u5e26\u7f29\u653e\uff09\n   \u68af\u5ea6\u901a\u4fe1: FP16\uff08\u5e26\u8bef\u5dee\u53cd\u9988\uff09</code></p>\n</li>\n<li>\n<p><strong>\u786c\u4ef6\u611f\u77e5\u4f18\u5316</strong>\uff1a\n   - \u5229\u7528\u7279\u5b9a\u786c\u4ef6\u7684\u6df7\u5408\u7cbe\u5ea6\u80fd\u529b\n   - \u8003\u8651\u5185\u5b58\u5e26\u5bbdvs\u8ba1\u7b97\u80fd\u529b\n   - \u4f18\u5316\u6570\u636e\u79fb\u52a8\u6a21\u5f0f</p>\n</li>\n<li>\n<p><strong>\u8c03\u8bd5\u548c\u9a8c\u8bc1</strong>\uff1a\n   - \u5bf9\u6bd4\u5168\u7cbe\u5ea6\u57fa\u51c6\n   - \u76d1\u63a7\u5173\u952e\u6570\u503c\u6307\u6807\n   - \u6e10\u8fdb\u5f0f\u964d\u4f4e\u7cbe\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u52a8\u7cbe\u5ea6\u9009\u62e9\u7b97\u6cd5</li>\n<li>\u786c\u4ef6\u611f\u77e5\u7684AD\u4f18\u5316</li>\n<li>\u91cf\u5316\u611f\u77e5\u7684\u9690\u5f0f\u5fae\u5206</li>\n<li>\u65b0\u578b\u6570\u503c\u683c\u5f0f\uff08\u5982Posit\uff09\u5728AD\u4e2d\u7684\u5e94\u7528</li>\n<li>\u6982\u7387\u6570\u503c\u65b9\u6cd5\u4e0e\u4e0d\u786e\u5b9a\u6027\u91cf\u5316</li>\n</ul>\n<h2 id=\"174\">17.4 \u53cc\u5c42\u4f18\u5316\u7684\u73b0\u4ee3\u7b97\u6cd5</h2>\n<p>\u53cc\u5c42\u4f18\u5316\u95ee\u9898\u5177\u6709\u4ee5\u4e0b\u5f62\u5f0f\uff1a\n$$\\min_{x} f(x, y^*(x)) \\quad \\text{s.t.} \\quad y^*(x) = \\arg\\min_y g(x, y)$$\n\u8fd9\u5728\u8d85\u53c2\u6570\u4f18\u5316\u3001\u5143\u5b66\u4e60\u3001\u5bf9\u6297\u8bad\u7ec3\u7b49\u573a\u666f\u4e2d\u5e7f\u6cdb\u51fa\u73b0\u3002</p>\n<h3 id=\"_9\">\u68af\u5ea6\u5c55\u5f00\u6cd5\u7684\u6536\u655b\u6027\u5206\u6790</h3>\n<p>\u68af\u5ea6\u5c55\u5f00\uff08Gradient Unrolling\uff09\u901a\u8fc7\u5c55\u5f00\u5185\u5c42\u4f18\u5316\u7684K\u6b65\u8fed\u4ee3\u6765\u8fd1\u4f3c $y^*(x)$\uff1a\n$$y_0 = y_{\\text{init}}, \\quad y_{k+1} = y_k - \\eta \\nabla_y g(x, y_k)$$\n<strong>\u6536\u655b\u6027\u5b9a\u7406</strong>\uff1a\n\u5047\u8bbe $g(x, \\cdot)$ \u662f $\\mu$-\u5f3a\u51f8\u4e14 $L$-\u5149\u6ed1\u7684\uff0c\u5219\uff1a\n$$|y_K - y^*(x)| \\leq (1 - \\mu/L)^K |y_0 - y^*(x)|$$\n<strong>\u504f\u5dee-\u65b9\u5dee\u6743\u8861</strong>\uff1a</p>\n<ul>\n<li>\u5c0fK\uff1a\u8ba1\u7b97\u5feb\u4f46\u504f\u5dee\u5927</li>\n<li>\u5927K\uff1a\u504f\u5dee\u5c0f\u4f46\u8ba1\u7b97\u6162\u4e14\u68af\u5ea6\u53ef\u80fd\u6d88\u5931</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u5c55\u5f00\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u6536\u655b\u68c0\u6d4b\u7684\u65e9\u505c</li>\n<li>\u52a8\u6001\u8c03\u6574\u6b65\u957f $\\eta$</li>\n<li>\u4f7f\u7528\u52a8\u91cf\u52a0\u901f\u6536\u655b</li>\n</ul>\n<h3 id=\"_10\">\u9690\u5f0f\u68af\u5ea6\u65b9\u6cd5\u7684\u5b9e\u73b0\u7ec6\u8282</h3>\n<p>\u9690\u5f0f\u68af\u5ea6\u65b9\u6cd5\u76f4\u63a5\u5229\u7528\u6700\u4f18\u6027\u6761\u4ef6\uff1a\n$$\\nabla_y g(x, y^*(x)) = 0$$\n<strong>\u5b8c\u6574\u68af\u5ea6\u516c\u5f0f</strong>\uff1a\n$$\\frac{d f}{d x} = \\frac{\\partial f}{\\partial x} - \\frac{\\partial f}{\\partial y} \\left(\\frac{\\partial^2 g}{\\partial y^2}\\right)^{-1} \\frac{\\partial^2 g}{\\partial x \\partial y}$$\n<strong>\u9ad8\u6548\u5b9e\u73b0\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li><strong>\u5411\u91cf-\u96c5\u53ef\u6bd4\u79ef</strong>\uff1a\u907f\u514d\u663e\u5f0f\u6784\u9020Hessian</li>\n<li><strong>\u5171\u8f6d\u68af\u5ea6\u6cd5</strong>\uff1a\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf</li>\n<li><strong>\u4f4e\u79e9\u8fd1\u4f3c</strong>\uff1a\u5f53Hessian\u8fd1\u4f3c\u4f4e\u79e9\u65f6</li>\n</ol>\n<p><strong>\u4e8c\u9636\u9525\u89c4\u5212\u89c6\u89d2</strong>\uff1a\n\u67d0\u4e9b\u53cc\u5c42\u95ee\u9898\u53ef\u4ee5\u91cd\u6784\u4e3a\u9525\u89c4\u5212\uff0c\u5229\u7528\u6210\u719f\u7684\u6c42\u89e3\u5668\u3002</p>\n<h3 id=\"_11\">\u8fd1\u4f3c\u4e0e\u7cbe\u786e\u65b9\u6cd5\u7684\u5bf9\u6bd4</h3>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5bf9\u6bd4</strong>\uff1a\n| \u65b9\u6cd5 | \u65f6\u95f4\u590d\u6742\u5ea6 | \u7a7a\u95f4\u590d\u6742\u5ea6 | \u7cbe\u5ea6 |</p>\n<table>\n<thead>\n<tr>\n<th>\u65b9\u6cd5</th>\n<th>\u65f6\u95f4\u590d\u6742\u5ea6</th>\n<th>\u7a7a\u95f4\u590d\u6742\u5ea6</th>\n<th>\u7cbe\u5ea6</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u68af\u5ea6\u5c55\u5f00(K\u6b65)</td>\n<td>$O(K \\cdot T_{\\text{grad}})$</td>\n<td>$O(K \\cdot d)$</td>\n<td>$O((1-\\mu/L)^K)$</td>\n</tr>\n<tr>\n<td>\u9690\u5f0f\u68af\u5ea6</td>\n<td>$O(T_{\\text{solve}} + T_{\\text{opt}})$</td>\n<td>$O(d^2)$</td>\n<td>\u673a\u5668\u7cbe\u5ea6</td>\n</tr>\n<tr>\n<td>\u4e00\u9636\u8fd1\u4f3c</td>\n<td>$O(T_{\\text{grad}})$</td>\n<td>$O(d)$</td>\n<td>$O(\\eta)$</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u9009\u62e9\u6307\u5357</strong>\uff1a</p>\n<ul>\n<li><strong>\u68af\u5ea6\u5c55\u5f00</strong>\uff1a\u5185\u5c42\u95ee\u9898\u6761\u4ef6\u826f\u597d\uff0c\u9700\u8981\u5728\u7ebf\u5b66\u4e60</li>\n<li><strong>\u9690\u5f0f\u68af\u5ea6</strong>\uff1a\u9700\u8981\u9ad8\u7cbe\u5ea6\uff0c\u5185\u5c42\u95ee\u9898\u89c4\u6a21\u9002\u4e2d</li>\n<li><strong>\u6df7\u5408\u65b9\u6cd5</strong>\uff1a\u6e29\u542f\u52a8+\u9690\u5f0f\u5fae\u5206</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u968f\u673a\u53cc\u5c42\u4f18\u5316\u7684\u65b9\u5dee\u51cf\u5c11\u6280\u672f</li>\n<li>\u975e\u51f8\u5185\u5c42\u95ee\u9898\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u5206\u5e03\u5f0f\u53cc\u5c42\u4f18\u5316\u7b97\u6cd5</li>\n</ul>\n<h2 id=\"175\">17.5 \u5143\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</h2>\n<p>\u5143\u5b66\u4e60\u65e8\u5728\u5b66\u4e60\u5982\u4f55\u5feb\u901f\u9002\u5e94\u65b0\u4efb\u52a1\uff0c\u5176\u6838\u5fc3\u662f\u53cc\u5c42\u4f18\u5316\u7ed3\u6784\u3002</p>\n<h3 id=\"maml\">MAML\u7b97\u6cd5\u7684\u6570\u5b66\u672c\u8d28</h3>\n<p>Model-Agnostic Meta-Learning (MAML) \u89e3\u51b3\uff1a\n$$\\min_{\\theta} \\sum_{i=1}^N \\mathcal{L}_i(\\theta - \\alpha \\nabla \\mathcal{L}_i(\\theta))$$\n\u8fd9\u662f\u4e00\u4e2a\u53cc\u5c42\u4f18\u5316\u95ee\u9898\uff0c\u5176\u4e2d\uff1a</p>\n<ul>\n<li>\u5916\u5c42\uff1a\u5b66\u4e60\u521d\u59cb\u5316\u53c2\u6570 $\\theta$</li>\n<li>\u5185\u5c42\uff1a\u4efb\u52a1\u7279\u5b9a\u7684\u5feb\u901f\u9002\u5e94</li>\n</ul>\n<p><strong>\u68af\u5ea6\u8ba1\u7b97</strong>\uff1a\n$$\\nabla_{\\theta} \\mathcal{L}_i(\\theta') = \\nabla_{\\theta'} \\mathcal{L}_i(\\theta') \\cdot \\left(I - \\alpha \\nabla^2 \\mathcal{L}_i(\\theta)\\right)$$\n<strong>\u4e00\u9636\u8fd1\u4f3c\uff08FOMAML\uff09</strong>\uff1a\n\u5ffd\u7565\u4e8c\u9636\u9879\uff1a$\\nabla_{\\theta} \\mathcal{L}_i(\\theta') \\approx \\nabla_{\\theta'} \\mathcal{L}_i(\\theta')$</p>\n<h3 id=\"_12\">\u9ad8\u9636\u5bfc\u6570\u7684\u9ad8\u6548\u8ba1\u7b97</h3>\n<p>\u5728K\u6b65\u9002\u5e94\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u8ba1\u7b97K\u9636\u5bfc\u6570\u3002</p>\n<p><strong>\u8ba1\u7b97\u56fe\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u524d\u5411\u7d2f\u79ef</strong>\uff1a\u5b58\u50a8\u4e2d\u95f4\u68af\u5ea6</li>\n<li><strong>\u53cd\u5411\u4f20\u64ad</strong>\uff1a\u590d\u7528\u8ba1\u7b97</li>\n<li><strong>Hessian-vector\u79ef</strong>\uff1a\u907f\u514d\u663e\u5f0fHessian</li>\n</ol>\n<p><strong>\u5185\u5b58\u4f18\u5316\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u68c0\u67e5\u70b9</li>\n<li>\u4f4e\u79e9\u5206\u89e3</li>\n<li>\u968f\u673a\u622a\u65ad</li>\n</ul>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u88c1\u526a</li>\n<li>\u81ea\u9002\u5e94\u5b66\u4e60\u7387</li>\n<li>\u6b63\u5219\u5316\u6280\u672f</li>\n</ul>\n<h3 id=\"_13\">\u53c2\u6570\u5171\u4eab\u4e0e\u6b63\u5219\u5316\u7b56\u7565</h3>\n<p><strong>\u5c42\u6b21\u5316\u5143\u5b66\u4e60</strong>\uff1a\n\u4e0d\u540c\u5c42\u91c7\u7528\u4e0d\u540c\u7684\u9002\u5e94\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u5e95\u5c42\uff1a\u56fa\u5b9a\u6216\u6162\u9002\u5e94</li>\n<li>\u9ad8\u5c42\uff1a\u5feb\u901f\u9002\u5e94</li>\n</ul>\n<p><strong>\u6b63\u5219\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f39\u6027\u6743\u91cd\u5de9\u56fa\uff08EWC\uff09</strong>\uff1a\n$$\\mathcal{L}_{\\text{total}} = \\mathcal{L}_{\\text{task}} + \\frac{\\lambda}{2} \\sum_i F_i (\\theta_i - \\theta^*_i)^2$$</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u5bf9\u9f50</strong>\uff1a\n   \u9f13\u52b1\u4e0d\u540c\u4efb\u52a1\u7684\u68af\u5ea6\u65b9\u5411\u4e00\u81f4</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u4efb\u52a1\u76f8\u4f3c\u5ea6\u7684\u81ea\u52a8\u53d1\u73b0</li>\n<li>\u8fde\u7eed\u5b66\u4e60\u4e2d\u7684\u707e\u96be\u6027\u9057\u5fd8</li>\n<li>\u5143\u5b66\u4e60\u7684\u6cdb\u5316\u754c</li>\n</ul>\n<h2 id=\"176\">17.6 \u6570\u503c\u7a33\u5b9a\u6027\u7684\u6311\u6218\u4e0e\u5bf9\u7b56</h2>\n<p>\u9690\u5f0f\u5fae\u5206\u548c\u53cc\u5c42\u4f18\u5316\u5728\u6570\u503c\u4e0a\u5177\u6709\u6311\u6218\u6027\uff0c\u7279\u522b\u662f\u5728\u6df1\u5ea6\u5b66\u4e60\u7684\u89c4\u6a21\u4e0a\u3002</p>\n<h3 id=\"_14\">\u75c5\u6001\u6761\u4ef6\u4e0b\u7684\u7a33\u5b9a\u5316\u6280\u672f</h3>\n<p>\u5f53 $\\frac{\\partial F}{\\partial y}$ \u63a5\u8fd1\u5947\u5f02\u65f6\uff0c\u7ebf\u6027\u7cfb\u7edf\u53d8\u5f97\u75c5\u6001\u3002</p>\n<p><strong>\u6b63\u5219\u5316\u65b9\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Tikhonov\u6b63\u5219\u5316</strong>\uff1a\n$$\\left(\\frac{\\partial F}{\\partial y} + \\epsilon I\\right) v = -\\frac{\\partial F}{\\partial x}$$</p>\n</li>\n<li>\n<p><strong>\u622a\u65adSVD</strong>\uff1a\n   \u4e22\u5f03\u5c0f\u5947\u5f02\u503c\u5bf9\u5e94\u7684\u5206\u91cf</p>\n</li>\n<li>\n<p><strong>\u8fed\u4ee3\u7cbe\u5316</strong>\uff1a\n   \u4f7f\u7528\u9ad8\u7cbe\u5ea6\u8ba1\u7b97\u6b8b\u5dee\uff0c\u4f4e\u7cbe\u5ea6\u66f4\u65b0</p>\n</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u6b63\u5219\u5316</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u6761\u4ef6\u6570\u4f30\u8ba1\u9009\u62e9 $\\epsilon$</li>\n<li>\u4ea4\u53c9\u9a8c\u8bc1\u9009\u62e9\u6700\u4f18\u6b63\u5219\u5316\u5f3a\u5ea6</li>\n<li>\u8d1d\u53f6\u65af\u65b9\u6cd5\u81ea\u52a8\u786e\u5b9a</li>\n</ul>\n<h3 id=\"_15\">\u68af\u5ea6\u6d88\u5931/\u7206\u70b8\u7684\u68c0\u6d4b\u4e0e\u7f13\u89e3</h3>\n<p><strong>\u68c0\u6d4b\u6307\u6807</strong>\uff1a</p>\n<ol>\n<li><strong>\u68af\u5ea6\u8303\u6570\u76d1\u63a7</strong>\uff1a$|\\nabla L|$</li>\n<li><strong>\u76f8\u5bf9\u53d8\u5316</strong>\uff1a$\\frac{|\\nabla L_t - \\nabla L_{t-1}|}{|\\nabla L_{t-1}|}$</li>\n<li><strong>\u8c31\u534a\u5f84\u4f30\u8ba1</strong>\uff1a\u5e42\u8fed\u4ee3\u6cd5</li>\n</ol>\n<p><strong>\u7f13\u89e3\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u68af\u5ea6\u88c1\u526a</strong>\uff1a\n   - \u5168\u5c40\u8303\u6570\u88c1\u526a\n   - \u9010\u5143\u7d20\u88c1\u526a\n   - \u81ea\u9002\u5e94\u88c1\u526a\u9608\u503c</p>\n</li>\n<li>\n<p><strong>\u91cd\u53c2\u6570\u5316</strong>\uff1a\n   - \u53c2\u6570\u5f52\u4e00\u5316\n   - \u8c31\u5f52\u4e00\u5316\n   - \u6743\u91cd\u6807\u51c6\u5316</p>\n</li>\n<li>\n<p><strong>\u67b6\u6784\u8bbe\u8ba1</strong>\uff1a\n   - \u6b8b\u5dee\u8fde\u63a5\n   - \u5f52\u4e00\u5316\u5c42\n   - \u6ce8\u610f\u529b\u673a\u5236</p>\n</li>\n</ol>\n<h3 id=\"_16\">\u9c81\u68d2\u6027\u8bbe\u8ba1\u539f\u5219</h3>\n<p><strong>\u539f\u52191\uff1a\u6e10\u8fdb\u5f0f\u590d\u6742\u5ea6</strong>\n\u4ece\u7b80\u5355\u95ee\u9898\u5f00\u59cb\uff0c\u9010\u6b65\u589e\u52a0\u590d\u6742\u5ea6\uff1a</p>\n<ul>\n<li>\u5c0f\u89c4\u6a21 \u2192 \u5927\u89c4\u6a21</li>\n<li>\u4f4e\u7ef4 \u2192 \u9ad8\u7ef4</li>\n<li>\u51f8 \u2192 \u975e\u51f8</li>\n</ul>\n<p><strong>\u539f\u52192\uff1a\u591a\u5c3a\u5ea6\u65b9\u6cd5</strong>\n\u4e0d\u540c\u5c3a\u5ea6\u4f7f\u7528\u4e0d\u540c\u7cbe\u5ea6\uff1a</p>\n<ul>\n<li>\u7c97\u7f51\u683c\uff1a\u4f4e\u7cbe\u5ea6\u5feb\u901f\u6536\u655b</li>\n<li>\u7ec6\u7f51\u683c\uff1a\u9ad8\u7cbe\u5ea6\u7cbe\u786e\u6c42\u89e3</li>\n</ul>\n<p><strong>\u539f\u52193\uff1a\u5197\u4f59\u6027\u8bbe\u8ba1</strong></p>\n<ul>\n<li>\u591a\u79cd\u6c42\u89e3\u5668\u5907\u9009</li>\n<li>\u81ea\u52a8\u6545\u969c\u68c0\u6d4b\u548c\u6062\u590d</li>\n<li>\u7ed3\u679c\u9a8c\u8bc1\u673a\u5236</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u7b97\u6cd5\u7684\u7406\u8bba\u5206\u6790</li>\n<li>\u786c\u4ef6\u9519\u8bef\u7684\u5bb9\u9519\u8bbe\u8ba1</li>\n<li>\u6982\u7387\u6570\u503c\u65b9\u6cd5\u7684\u5e94\u7528</li>\n</ul>\n<h2 id=\"_17\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u9690\u5f0f\u5fae\u5206\u548c\u53cc\u5c42\u4f18\u5316\u5728\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u7406\u8bba\u4e0e\u5b9e\u8df5\u3002\u5173\u952e\u8981\u70b9\u5305\u62ec\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9690\u5f0f\u51fd\u6570\u5b9a\u7406\u7684\u8ba1\u7b97\u5316</strong>\uff1a\u5c06\u62bd\u8c61\u7684\u6570\u5b66\u5b9a\u7406\u8f6c\u5316\u4e3a\u5b9e\u9645\u53ef\u8ba1\u7b97\u7684\u7b97\u6cd5\uff0c\u6838\u5fc3\u662f\u9ad8\u6548\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf\u800c\u975e\u663e\u5f0f\u6c42\u9006</p>\n</li>\n<li>\n<p><strong>\u7ebf\u6027\u6c42\u89e3\u5668\u7684\u9009\u62e9\u827a\u672f</strong>\uff1a\u6839\u636e\u77e9\u9635\u6027\u8d28\uff08\u5bf9\u79f0\u6027\u3001\u6b63\u5b9a\u6027\u3001\u7a00\u758f\u6a21\u5f0f\uff09\u9009\u62e9\u5408\u9002\u7684\u8fed\u4ee3\u6c42\u89e3\u5668\uff0c\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\u81f3\u5173\u91cd\u8981</p>\n</li>\n<li>\n<p><strong>\u81ea\u52a8\u5fae\u5206\u7684\u9ad8\u7ea7\u6280\u5de7</strong>\uff1a\u524d\u5411/\u53cd\u5411\u6a21\u5f0f\u7684\u6743\u8861\u3001\u68c0\u67e5\u70b9\u6280\u672f\u3001\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\uff0c\u90fd\u662f\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\u7684\u5173\u952e\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u53cc\u5c42\u4f18\u5316\u7684\u4e24\u79cd\u8303\u5f0f</strong>\uff1a\u68af\u5ea6\u5c55\u5f00\u63d0\u4f9b\u4e86\u7b80\u5355\u4f46\u8fd1\u4f3c\u7684\u89e3\u6cd5\uff0c\u9690\u5f0f\u68af\u5ea6\u63d0\u4f9b\u4e86\u7cbe\u786e\u4f46\u8ba1\u7b97\u5bc6\u96c6\u7684\u65b9\u6848</p>\n</li>\n<li>\n<p><strong>\u5143\u5b66\u4e60\u7684\u6570\u5b66\u672c\u8d28</strong>\uff1aMAML\u7b49\u7b97\u6cd5\u672c\u8d28\u4e0a\u662f\u7279\u6b8a\u7684\u53cc\u5c42\u4f18\u5316\u95ee\u9898\uff0c\u7406\u89e3\u8fd9\u4e00\u70b9\u6709\u52a9\u4e8e\u8bbe\u8ba1\u66f4\u597d\u7684\u7b97\u6cd5</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u7684\u7cfb\u7edf\u65b9\u6cd5</strong>\uff1a\u4ece\u95ee\u9898\u68c0\u6d4b\u3001\u7b97\u6cd5\u8bbe\u8ba1\u5230\u9c81\u68d2\u6027\u4fdd\u8bc1\uff0c\u9700\u8981\u5168\u65b9\u4f4d\u7684\u8003\u8651</p>\n</li>\n</ol>\n<h2 id=\"_18\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_19\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u989817.1</strong> \u8003\u8651\u56fa\u5b9a\u70b9\u65b9\u7a0b $x = \\tanh(Wx + b)$\uff0c\u5176\u4e2d $W \\in \\mathbb{R}^{n \\times n}$\uff0c$b \\in \\mathbb{R}^n$\u3002\na) \u63a8\u5bfc $\\frac{\\partial x^*}{\\partial b}$ \u7684\u8868\u8fbe\u5f0f\nb) \u5f53 $|W|_2 &lt; 1$ \u65f6\uff0c\u8bc1\u660e\u56fa\u5b9a\u70b9\u552f\u4e00\u5b58\u5728\nc) \u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u6548\u7b97\u6cd5\u8ba1\u7b97\u8be5\u5bfc\u6570</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5229\u7528\u9690\u5f0f\u51fd\u6570\u5b9a\u7406\u548c $\\tanh'(x) = 1 - \\tanh^2(x)$</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) \u8bbe $F(x,b) = x - \\tanh(Wx + b) = 0$\uff0c\u5219\uff1a\n$$\\frac{\\partial x^*}{\\partial b} = (I - \\text{diag}(1-\\tanh^2(Wx^*+b))W)^{-1}\\text{diag}(1-\\tanh^2(Wx^*+b))$$\nb) \u5b9a\u4e49 $T(x) = \\tanh(Wx + b)$\uff0c\u5219 $|T(x) - T(y)| \\leq |W|_2 |x - y|$\uff0c\u5f53 $|W|_2 &lt; 1$ \u65f6\u4e3a\u538b\u7f29\u6620\u5c04</p>\n<p>c) \u4f7f\u7528\u5171\u8f6d\u68af\u5ea6\u6cd5\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf\uff0c\u5229\u7528\u77e9\u9635\u7ed3\u6784\u53ea\u9700\u77e9\u9635-\u5411\u91cf\u79ef</p>\n</details>\n<p><strong>\u4e60\u989817.2</strong> \u5728L-BFGS\u7b97\u6cd5\u4e2d\u5b58\u50a8m\u4e2a\u5411\u91cf\u5bf9 $(s_i, y_i)$\u3002\u82e5\u5c06L-BFGS\u8fd1\u4f3c\u7528\u4f5c\u9884\u6761\u4ef6\u5b50\uff0c\u5206\u6790\uff1a\na) \u9884\u6761\u4ef6\u5b50\u5e94\u7528\u4e00\u6b21\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\nb) \u5b58\u50a8\u9700\u6c42\nc) \u4e0e\u5b8c\u6574BFGS\u76f8\u6bd4\u7684\u8fd1\u4f3c\u8bef\u5dee</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u56de\u987eL-BFGS\u7684\u4e24\u5faa\u73af\u9012\u5f52\u7b97\u6cd5</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) $O(mn)$\uff0c\u5176\u4e2dn\u662f\u95ee\u9898\u7ef4\u5ea6\uff0cm\u662f\u5b58\u50a8\u7684\u5411\u91cf\u5bf9\u6570\nb) $O(mn)$ \u5b58\u50a8\u7a7a\u95f4\nc) \u8bef\u5dee\u4e3b\u8981\u6765\u81ea\u4e22\u5f03\u7684\u65e9\u671f\u66f2\u7387\u4fe1\u606f\uff0c\u53ef\u4ee5\u7528\u8c31\u5206\u6790\u91cf\u5316</p>\n</details>\n<p><strong>\u4e60\u989817.3</strong> \u8003\u8651\u53cc\u5c42\u4f18\u5316\u95ee\u9898\uff1a\n$$\\min_x |Ax - b|^2 \\quad \\text{s.t.} \\quad A = \\arg\\min_A |AX - Y|_F^2 + \\lambda|A|_F^2$$\n\u5176\u4e2d $X, Y$ \u662f\u7ed9\u5b9a\u7684\u6570\u636e\u77e9\u9635\u3002\na) \u6c42\u89e3\u5185\u5c42\u95ee\u9898\u7684\u95ed\u5f0f\u89e3\nb) \u8ba1\u7b97\u5916\u5c42\u76ee\u6807\u5bf9x\u7684\u68af\u5ea6\nc) \u8fd9\u4e2a\u95ee\u9898\u5728\u4ec0\u4e48\u5e94\u7528\u4e2d\u4f1a\u51fa\u73b0\uff1f</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5185\u5c42\u662f\u6807\u51c6\u7684\u5cad\u56de\u5f52\u95ee\u9898</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>a) $A^* = YX^T(XX^T + \\lambda I)^{-1}$\nb) \u4f7f\u7528\u9690\u5f0f\u5fae\u5206\uff0c\u9700\u8981\u6c42\u89e3Sylvester\u65b9\u7a0b\nc) \u5728\u81ea\u9002\u5e94\u7ebf\u6027\u7cfb\u7edf\u8fa8\u8bc6\u3001\u5143\u5b66\u4e60\u7ebf\u6027\u6a21\u578b\u7b49\u573a\u666f</p>\n</details>\n<h3 id=\"_20\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u989817.4</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7b97\u6cd5\uff0c\u5728\u6c42\u89e3\u9690\u5f0f\u5fae\u5206\u7684\u7ebf\u6027\u7cfb\u7edf\u65f6\u81ea\u52a8\u9009\u62e9\u5408\u9002\u7684\u6c42\u89e3\u5668\u548c\u9884\u6761\u4ef6\u5b50\u3002\u7b97\u6cd5\u5e94\u8be5\uff1a</p>\n<ul>\n<li>\u4f30\u8ba1\u77e9\u9635\u7684\u6761\u4ef6\u6570\u548c\u8c31\u6027\u8d28</li>\n<li>\u6839\u636e\u95ee\u9898\u89c4\u6a21\u9009\u62e9\u76f4\u63a5\u6cd5\u6216\u8fed\u4ee3\u6cd5</li>\n<li>\u52a8\u6001\u8c03\u6574\u6c42\u89e3\u7cbe\u5ea6</li>\n</ul>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u53ef\u4ee5\u4f7f\u7528\u5c11\u91cf\u77e9\u9635-\u5411\u91cf\u79ef\u4f30\u8ba1\u8c31\u4fe1\u606f\uff0c\u8003\u8651Gershgorin\u5706\u76d8\u5b9a\u7406</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u7528Lanczos\u8fed\u4ee3\u4f30\u8ba1\u6781\u503c\u7279\u5f81\u503c</li>\n<li>\u8ba1\u7b97\u6761\u4ef6\u6570\u4f30\u8ba1\uff0c\u82e5 $\\kappa &lt; 100$ \u4e14 $n &lt; 1000$ \u7528\u76f4\u63a5\u6cd5</li>\n<li>\u5426\u5219\u7528\u8fed\u4ee3\u6cd5\uff0c\u6839\u636e\u5bf9\u79f0\u6027\u9009\u62e9CG/GMRES</li>\n<li>\u76d1\u63a7\u6b8b\u5dee\u4e0b\u964d\u7387\uff0c\u81ea\u9002\u5e94\u8c03\u6574\u9884\u6761\u4ef6\u5b50</li>\n</ol>\n</details>\n<p><strong>\u4e60\u989817.5</strong> \u8003\u8651\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5f52\u4e00\u5316\u5c42\u53ef\u4ee5\u770b\u4f5c\u9690\u5f0f\u5c42\uff1a\u7ed9\u5b9a\u8f93\u5165 $x$\uff0c\u8f93\u51fa $y$ \u6ee1\u8db3 $\\text{mean}(y) = 0$, $\\text{var}(y) = 1$\u3002\na) \u5c06BatchNorm\u8868\u793a\u4e3a\u9690\u5f0f\u51fd\u6570 $F(x,y) = 0$ \u7684\u5f62\u5f0f\nb) \u63a8\u5bfc\u53cd\u5411\u4f20\u64ad\u516c\u5f0f\uff0c\u4e0d\u4f7f\u7528\u81ea\u52a8\u5fae\u5206\nc) \u5206\u6790\u6570\u503c\u7a33\u5b9a\u6027\uff0c\u7279\u522b\u662f\u5f53batch size\u5f88\u5c0f\u65f6</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u7ea6\u675f\u4f18\u5316\u7684KKT\u6761\u4ef6</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8fd9\u662f\u4e00\u4e2a\u7ea6\u675f\u4f18\u5316\u95ee\u9898\uff0c\u53ef\u4ee5\u7528Lagrange\u4e58\u5b50\u6cd5\u3002\u5173\u952e\u662f\u5904\u7406\u5947\u5f02\u60c5\u51b5\uff08\u5982\u6240\u6709\u8f93\u5165\u76f8\u540c\u65f6\uff09\u3002\u9700\u8981\u6b63\u5219\u5316\u6280\u672f\u4fdd\u8bc1\u6570\u503c\u7a33\u5b9a\u6027\u3002</p>\n</details>\n<p><strong>\u4e60\u989817.6</strong> \u5728\u8054\u90a6\u5b66\u4e60\u4e2d\uff0c\u6bcf\u4e2a\u5ba2\u6237\u7aef\u89e3\u51b3\u5c40\u90e8\u4f18\u5316\u95ee\u9898\uff0c\u670d\u52a1\u5668\u805a\u5408\u7ed3\u679c\u3002\u5c06\u5176\u5efa\u6a21\u4e3a\u53cc\u5c42\u4f18\u5316\uff1a\n$$\\min_{x_0} \\sum_{i=1}^n f_i(x_i^*) \\quad \\text{s.t.} \\quad x_i^* = \\arg\\min_{x_i} g_i(x_i) + \\frac{\\rho}{2}|x_i - x_0|^2$$\n\u8bbe\u8ba1\u4e00\u4e2a\u901a\u4fe1\u9ad8\u6548\u7684\u7b97\u6cd5\u6c42\u89e3\uff0c\u8003\u8651\uff1a</p>\n<ul>\n<li>\u5ba2\u6237\u7aef\u8ba1\u7b97\u80fd\u529b\u5f02\u6784</li>\n<li>\u901a\u4fe1\u5e26\u5bbd\u9650\u5236</li>\n<li>\u9690\u79c1\u4fdd\u62a4\u9700\u6c42</li>\n</ul>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651ADMM\u6846\u67b6\u548c\u5dee\u5206\u9690\u79c1</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65ADMM\uff0c\u7ed3\u5408\uff1a</p>\n<ol>\n<li>\u538b\u7f29\u611f\u77e5\u51cf\u5c11\u901a\u4fe1</li>\n<li>\u5c40\u90e8SGD\u51cf\u5c11\u901a\u4fe1\u8f6e\u6b21</li>\n<li>\u5dee\u5206\u9690\u79c1\u566a\u58f0\u4fdd\u62a4\u68af\u5ea6</li>\n<li>\u91cd\u8981\u6027\u91c7\u6837\u5904\u7406\u5f02\u6784\u6027</li>\n</ol>\n</details>\n<p><strong>\u4e60\u989817.7</strong> \u7814\u7a76\u5982\u4f55\u5c06\u9690\u5f0f\u5fae\u5206\u6269\u5c55\u5230\u975e\u5149\u6ed1\u4f18\u5316\u3002\u8003\u8651\u95ee\u9898\uff1a\n$$y^*(x) = \\arg\\min_y f(x,y) + \\lambda|y|_1$$</p>\n<p>a) \u5f53 $y^*$ \u7684\u67d0\u4e9b\u5206\u91cf\u6070\u597d\u4e3a0\u65f6\uff0c\u5982\u4f55\u5b9a\u4e49\u548c\u8ba1\u7b97\u5bfc\u6570\uff1f\nb) \u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\u8ba1\u7b97 $\\frac{\\partial y^*}{\\partial x}$\nc) \u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\u8be5\u5bfc\u6570\u662f\u826f\u5b9a\u4e49\u7684\uff1f</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u6b21\u5fae\u5206\u548cMoreau\u5305\u7edc</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u9700\u8981\u4f7f\u7528\u9690\u5f0f\u51fd\u6570\u5b9a\u7406\u7684\u975e\u5149\u6ed1\u7248\u672c\uff0c\u5173\u952e\u662f\u8bc6\u522b\u6d3b\u8dc3\u96c6\uff08\u975e\u96f6\u5206\u91cf\uff09\u5e76\u5728\u964d\u7ef4\u7a7a\u95f4\u4e2d\u5e94\u7528\u5149\u6ed1\u9690\u5f0f\u51fd\u6570\u5b9a\u7406\u3002\u7b97\u6cd5\u9700\u8981\u5904\u7406\u6d3b\u8dc3\u96c6\u53d8\u5316\u7684\u60c5\u51b5\u3002</p>\n</details>\n<p><strong>\u4e60\u989817.8</strong> \u8003\u8651\u4e00\u4e2a\"\u5b66\u4e60\u4f18\u5316\u5668\"\u7684\u5143\u5b66\u4e60\u95ee\u9898\uff1a\u6211\u4eec\u60f3\u5b66\u4e60\u4e00\u4e2a\u53c2\u6570\u5316\u7684\u4f18\u5316\u7b97\u6cd5 $x_{k+1} = g_\\theta(x_k, \\nabla f(x_k))$\uff0c\u4f7f\u5176\u5728\u4e00\u7c7b\u51fd\u6570\u4e0a\u8868\u73b0\u826f\u597d\u3002</p>\n<p>a) \u5c06\u6b64\u5efa\u6a21\u4e3a\u53cc\u5c42\u4f18\u5316\u95ee\u9898\nb) \u5206\u6790\u68af\u5ea6\u8ba1\u7b97\u7684\u590d\u6742\u5ea6\nc) \u63d0\u51fa\u4e00\u4e2a\u5b9e\u7528\u7684\u8fd1\u4f3c\u7b97\u6cd5\nd) \u8fd9\u4e0e\u4f20\u7edf\u4f18\u5316\u5668\uff08\u5982Adam\uff09\u6709\u4f55\u672c\u8d28\u533a\u522b\uff1f</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u5c55\u5f00K\u6b65\u4f18\u5316\u8fc7\u7a0b</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8fd9\u9700\u8981\u901a\u8fc7K\u6b65\u4f18\u5316\u8f68\u8ff9\u53cd\u5411\u4f20\u64ad\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6\u4e3a $O(K \\cdot \\text{cost}(\\nabla f))$\u3002\u53ef\u4ee5\u4f7f\u7528\u622a\u65ad\u53cd\u5411\u4f20\u64ad\u6216\u5408\u6210\u68af\u5ea6\u964d\u4f4e\u590d\u6742\u5ea6\u3002\u672c\u8d28\u533a\u522b\u662f\u6570\u636e\u9a71\u52a8vs\u7406\u8bba\u9a71\u52a8\u3002</p>\n</details>\n<h2 id=\"_21\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<ol>\n<li>\n<p><strong>\u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3\u7cbe\u5ea6\u4e0d\u8db3</strong>\uff1a\u9690\u5f0f\u68af\u5ea6\u5bf9\u7ebf\u6027\u7cfb\u7edf\u89e3\u7684\u7cbe\u5ea6\u654f\u611f\uff0c\u6b8b\u5dee\u8fc7\u5927\u4f1a\u5bfc\u81f4\u68af\u5ea6\u504f\u5dee\u7d2f\u79ef</p>\n</li>\n<li>\n<p><strong>\u5ffd\u7565\u6b63\u5219\u5316\u7684\u5fc5\u8981\u6027</strong>\uff1a\u5373\u4f7f\u7406\u8bba\u4e0a\u77e9\u9635\u53ef\u9006\uff0c\u6570\u503c\u4e0a\u4e5f\u53ef\u80fd\u63a5\u8fd1\u5947\u5f02\uff0c\u9700\u8981\u9002\u5f53\u6b63\u5219\u5316</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406\u4e0d\u5f53</strong>\uff1a\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\uff0c\u5b58\u50a8\u6240\u6709\u4e2d\u95f4Jacobian\u4f1a\u5feb\u901f\u8017\u5c3d\u5185\u5b58\uff0c\u9700\u8981\u7cbe\u5fc3\u8bbe\u8ba1\u8ba1\u7b97\u56fe</p>\n</li>\n<li>\n<p><strong>\u56fa\u5b9a\u70b9\u4e0d\u5b58\u5728\u6216\u4e0d\u552f\u4e00</strong>\uff1a\u5728\u975e\u51f8\u60c5\u51b5\u4e0b\uff0c\u9690\u5f0f\u51fd\u6570\u53ef\u80fd\u65e0\u5b9a\u4e49\uff0c\u9700\u8981\u989d\u5916\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u5c55\u5f00\u6b65\u6570\u9009\u62e9\u4e0d\u5f53</strong>\uff1a\u592a\u5c11\u5bfc\u81f4\u504f\u5dee\u5927\uff0c\u592a\u591a\u5bfc\u81f4\u68af\u5ea6\u6d88\u5931\u548c\u8ba1\u7b97\u6d6a\u8d39</p>\n</li>\n<li>\n<p><strong>\u6df7\u6dc6\u4e00\u9636\u548c\u4e8c\u9636\u65b9\u6cd5</strong>\uff1aFOMAML\u7b49\u4e00\u9636\u8fd1\u4f3c\u5728\u67d0\u4e9b\u95ee\u9898\u4e0a\u6548\u679c\u5f88\u597d\uff0c\u4f46\u4e0d\u662f\u4e07\u80fd\u7684</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u5fae\u5206\u9a8c\u8bc1\u7f3a\u5931</strong>\uff1a\u590d\u6742\u7684\u9690\u5f0f\u5fae\u5206\u5b9e\u73b0\u5bb9\u6613\u51fa\u9519\uff0c\u5e94\u8be5\u7528\u6709\u9650\u5dee\u5206\u9a8c\u8bc1</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u673a\u4f1a\u6d6a\u8d39</strong>\uff1a\u8bb8\u591a\u8ba1\u7b97\u53ef\u4ee5\u5e76\u884c\u5316\uff08\u5982\u4e0d\u540c\u4efb\u52a1\u7684\u68af\u5ea6\uff09\uff0c\u4f46\u4e32\u884c\u5b9e\u73b0\u4f1a\u5f88\u6162</p>\n</li>\n</ol>\n<h2 id=\"_22\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_23\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u95ee\u9898\u662f\u5426\u771f\u7684\u9700\u8981\u9690\u5f0f\u5fae\u5206\uff1f\u662f\u5426\u6709\u663e\u5f0f\u66ff\u4ee3\u65b9\u6848\uff1f</li>\n<li>[ ] \u5185\u5c42\u95ee\u9898\u7684\u6027\u8d28\uff1a\u51f8\u6027\u3001\u5149\u6ed1\u6027\u3001\u6761\u4ef6\u6570\uff1f</li>\n<li>[ ] \u9884\u671f\u7684\u95ee\u9898\u89c4\u6a21\u548c\u7cbe\u5ea6\u8981\u6c42\uff1f</li>\n<li>[ ] \u662f\u5426\u9700\u8981\u4e8c\u9636\u4fe1\u606f\uff0c\u8fd8\u662f\u4e00\u9636\u8fd1\u4f3c\u8db3\u591f\uff1f</li>\n</ul>\n<h3 id=\"_24\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u7ebf\u6027\u6c42\u89e3\u5668\u548c\u9884\u6761\u4ef6\u5b50</li>\n<li>[ ] \u5b9e\u73b0\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u62a4\uff08\u6b63\u5219\u5316\u3001\u88c1\u526a\u7b49\uff09</li>\n<li>[ ] \u8bbe\u8ba1\u9ad8\u6548\u7684\u5185\u5b58\u7ba1\u7406\u7b56\u7565</li>\n<li>[ ] \u5229\u7528\u95ee\u9898\u7ed3\u6784\uff08\u7a00\u758f\u6027\u3001\u4f4e\u79e9\u6027\u7b49\uff09</li>\n<li>[ ] \u5b9e\u73b0\u68af\u5ea6\u68c0\u67e5\u548c\u8c03\u8bd5\u5de5\u5177</li>\n</ul>\n<h3 id=\"_25\">\u8c03\u4f18\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u76d1\u63a7\u5173\u952e\u6570\u503c\u6307\u6807\uff08\u6761\u4ef6\u6570\u3001\u6b8b\u5dee\u3001\u68af\u5ea6\u8303\u6570\uff09</li>\n<li>[ ] \u6839\u636e\u95ee\u9898\u7279\u70b9\u8c03\u6574\u7b97\u6cd5\u53c2\u6570</li>\n<li>[ ] \u5e73\u8861\u7cbe\u5ea6\u548c\u6548\u7387\u7684\u6743\u8861</li>\n<li>[ ] \u8003\u8651\u786c\u4ef6\u7279\u6027\u4f18\u5316\uff08GPU\u3001\u5206\u5e03\u5f0f\uff09</li>\n</ul>\n<h3 id=\"_26\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u9c81\u68d2\u6027\u6d4b\u8bd5\uff1a\u6781\u7aef\u8f93\u5165\u3001\u6570\u503c\u8fb9\u754c\u60c5\u51b5</li>\n<li>[ ] \u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u548c\u74f6\u9888\u5206\u6790</li>\n<li>[ ] \u6545\u969c\u6062\u590d\u673a\u5236</li>\n<li>[ ] \u6587\u6863\u5316\u6570\u503c\u7a33\u5b9a\u6027\u5047\u8bbe\u548c\u9650\u5236</li>\n</ul>"
  },
  "../chapter3.md": {
    "hash": "4aa5c81ed5ba7069650a51a47186b0aa",
    "content": "<h1 id=\"3\">\u7b2c3\u7ae0\uff1a\u7ed3\u6784\u5316\u4e8c\u9636\u65b9\u6cd5</h1>\n<p>\u5728\u5927\u89c4\u6a21\u4f18\u5316\u95ee\u9898\u4e2d\uff0c\u5b8c\u6574\u7684Hessian\u77e9\u9635\u5f80\u5f80\u56e0\u5176$O(n^2)$\u7684\u5b58\u50a8\u9700\u6c42\u548c$O(n^3)$\u7684\u6c42\u9006\u590d\u6742\u5ea6\u800c\u53d8\u5f97\u4e0d\u5207\u5b9e\u9645\u3002\u672c\u7ae0\u63a2\u8ba8\u5982\u4f55\u901a\u8fc7\u8bc6\u522b\u548c\u5229\u7528Hessian\u7684\u7279\u6b8a\u7ed3\u6784\u6765\u8bbe\u8ba1\u9ad8\u6548\u7684\u4e8c\u9636\u4f18\u5316\u7b97\u6cd5\u3002\u6211\u4eec\u5c06\u6df1\u5165\u5206\u6790\u56db\u79cd\u4e3b\u8981\u7684\u7ed3\u6784\u5316\u65b9\u6cd5\uff1aKronecker\u56e0\u5b50\u5206\u89e3\u3001\u5757\u5bf9\u89d2\u8fd1\u4f3c\u3001\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784\uff0c\u4ee5\u53ca\u7a00\u758f\u6a21\u5f0f\u7684\u81ea\u52a8\u53d1\u73b0\u3002\u8fd9\u4e9b\u65b9\u6cd5\u4e0d\u4ec5\u5728\u7406\u8bba\u4e0a\u4f18\u96c5\uff0c\u66f4\u5728\u6df1\u5ea6\u5b66\u4e60\u3001\u63a8\u8350\u7cfb\u7edf\u7b49\u73b0\u4ee3\u5e94\u7528\u4e2d\u5c55\u73b0\u51fa\u5353\u8d8a\u7684\u5b9e\u7528\u4ef7\u503c\u3002</p>\n<h2 id=\"31-kroneckerk-fac\">3.1 Kronecker\u56e0\u5b50\u5206\u89e3\uff1aK-FAC\u53ca\u5176\u53d8\u4f53</h2>\n<h3 id=\"311\">3.1.1 \u6570\u5b66\u57fa\u7840</h3>\n<p>\u8003\u8651\u4e00\u4e2a\u5177\u6709\u5206\u5c42\u7ed3\u6784\u7684\u795e\u7ecf\u7f51\u7edc\uff0c\u5176\u4e2d\u7b2c$l$\u5c42\u7684\u6743\u91cd\u77e9\u9635\u4e3a$\\mathbf{W}_l \\in \\mathbb{R}^{m \\times n}$\u3002\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u8be5\u5c42\u7684Fisher\u4fe1\u606f\u77e9\u9635\uff08\u4f5c\u4e3aHessian\u7684\u8fd1\u4f3c\uff09\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a</p>\n<p>$$\\mathbf{F}_l = \\mathbb{E}[\\text{vec}(\\nabla_{\\mathbf{W}_l} \\mathcal{L}) \\text{vec}(\\nabla_{\\mathbf{W}_l} \\mathcal{L})^T]$$\nK-FAC\u7684\u6838\u5fc3\u6d1e\u5bdf\u662f\u5047\u8bbe\u8fd9\u4e2aFisher\u77e9\u9635\u53ef\u4ee5\u8fd1\u4f3c\u4e3a\u4e24\u4e2a\u8f83\u5c0f\u77e9\u9635\u7684Kronecker\u79ef\uff1a\n$$\\mathbf{F}_l \\approx \\mathbf{A}_l \\otimes \\mathbf{B}_l$$\n\u5176\u4e2d$\\mathbf{A}_l \\in \\mathbb{R}^{m \\times m}$\u6355\u83b7\u8f93\u51fa\u4e4b\u95f4\u7684\u76f8\u5173\u6027\uff0c$\\mathbf{B}_l \\in \\mathbb{R}^{n \\times n}$\u6355\u83b7\u8f93\u5165\u4e4b\u95f4\u7684\u76f8\u5173\u6027\u3002</p>\n<p><strong>\u6570\u5b66\u63a8\u5bfc\u7684\u6df1\u5c42\u542b\u4e49</strong>\uff1a</p>\n<p>\u4ece\u4fe1\u606f\u51e0\u4f55\u7684\u89d2\u5ea6\uff0cFisher\u4fe1\u606f\u77e9\u9635\u5b9a\u4e49\u4e86\u53c2\u6570\u7a7a\u95f4\u7684\u9ece\u66fc\u5ea6\u91cf\u3002\u5bf9\u4e8e\u6307\u6570\u65cf\u5206\u5e03$p(\\mathbf{y}|\\mathbf{x}, \\boldsymbol{\\theta}) = h(\\mathbf{y})\\exp(\\boldsymbol{\\eta}(\\boldsymbol{\\theta})^T\\mathbf{T}(\\mathbf{y}) - A(\\boldsymbol{\\eta}))$\uff0cFisher\u77e9\u9635\u7b49\u4e8e\u5bf9\u6570\u914d\u5206\u51fd\u6570\u7684Hessian\uff1a\n$$\\mathbf{F}(\\boldsymbol{\\theta}) = \\nabla^2 A(\\boldsymbol{\\eta}(\\boldsymbol{\\theta}))$$\n\u8fd9\u63ed\u793a\u4e86Fisher\u77e9\u9635\u4e0e\u66f2\u7387\u7684\u672c\u8d28\u8054\u7cfb\u3002\u5728\u6df1\u5ea6\u7f51\u7edc\u4e2d\uff0c\u5c42\u7ea7\u7ed3\u6784\u8bf1\u5bfc\u4e86\u7279\u6b8a\u7684\u51e0\u4f55\u6027\u8d28\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5c40\u90e8\u56e0\u5b50\u5316\u5047\u8bbe</strong>\uff1a\u5bf9\u4e8e\u5168\u8fde\u63a5\u5c42\uff0c\u82e5\u8bb0$\\mathbf{a}_{l-1}$\u4e3a\u8f93\u5165\u6fc0\u6d3b\uff0c$\\mathbf{g}_l = \\nabla_{\\mathbf{z}_l}\\mathcal{L}$\u4e3a\u9884\u6fc0\u6d3b\u68af\u5ea6\uff0c\u5219\uff1a\n$$\\nabla_{\\mathbf{W}_l}\\mathcal{L} = \\mathbf{g}_l \\mathbf{a}_{l-1}^T$$\n\u8fd9\u81ea\u7136\u5bfc\u51fa\u4e86Kronecker\u79ef\u7ed3\u6784\uff0c\u56e0\u4e3a\uff1a\n$$\\text{vec}(\\mathbf{g}_l \\mathbf{a}_{l-1}^T) = \\mathbf{a}_{l-1} \\otimes \\mathbf{g}_l$$</p>\n</li>\n<li>\n<p><strong>\u7edf\u8ba1\u72ec\u7acb\u6027\u7684\u51e0\u4f55\u89e3\u91ca</strong>\uff1aK-FAC\u5047\u8bbe$\\mathbf{a}_{l-1}$\u4e0e$\\mathbf{g}_l$\u7edf\u8ba1\u72ec\u7acb\uff0c\u8fd9\u5728\u51e0\u4f55\u4e0a\u610f\u5473\u7740\u8f93\u5165\u6d41\u5f62\u4e0e\u8f93\u51fa\u6d41\u5f62\u6b63\u4ea4\u3002\u867d\u7136\u8fd9\u5728\u6df1\u5ea6\u7f51\u7edc\u4e2d\u5e76\u4e0d\u4e25\u683c\u6210\u7acb\uff0c\u4f46\u7ecf\u9a8c\u8868\u660e\u8fd9\u79cd\u8fd1\u4f3c\u5728\u4f18\u5316\u666f\u89c2\u7684\u5927\u90e8\u5206\u533a\u57df\u8db3\u591f\u51c6\u786e\u3002</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u5ea6\u91cf\u7684\u590d\u5408</strong>\uff1a\u6574\u4e2a\u7f51\u7edc\u7684Fisher\u77e9\u9635\u5177\u6709\u5757\u5bf9\u89d2\u7ed3\u6784\uff08\u5ffd\u7565\u5c42\u95f4\u76f8\u5173\u6027\uff09\uff1a\n$$\\mathbf{F} = \\text{diag}(\\mathbf{F}_1, \\mathbf{F}_2, \\ldots, \\mathbf{F}_L)$$\nK-FAC\u8fdb\u4e00\u6b65\u5c06\u6bcf\u4e2a\u5757\u5206\u89e3\u4e3aKronecker\u79ef\uff0c\u5b9e\u73b0\u4e86\u8ba1\u7b97\u6548\u7387\u4e0e\u8868\u8fbe\u80fd\u529b\u7684\u5e73\u8861\u3002</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u6027\u8d28</strong>\uff1a</p>\n<ol>\n<li><strong>\u5b58\u50a8\u6548\u7387</strong>\uff1a\u4ece$O(m^2n^2)$\u964d\u81f3$O(m^2 + n^2)$</li>\n<li><strong>\u8ba1\u7b97\u6548\u7387</strong>\uff1a\u5229\u7528Kronecker\u79ef\u7684\u6027\u8d28\uff0c$(\\mathbf{A} \\otimes \\mathbf{B})^{-1} = \\mathbf{A}^{-1} \\otimes \\mathbf{B}^{-1}$</li>\n<li><strong>\u8c31\u5206\u6790</strong>\uff1a\u82e5$\\lambda_i$\u548c$\\mu_j$\u5206\u522b\u662f$\\mathbf{A}$\u548c$\\mathbf{B}$\u7684\u7279\u5f81\u503c\uff0c\u5219$\\lambda_i\\mu_j$\u662f$\\mathbf{A} \\otimes \\mathbf{B}$\u7684\u7279\u5f81\u503c</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u6027\u8d28\u4e0e\u7406\u8bba\u6269\u5c55</strong>\uff1a</p>\n<ol start=\"4\">\n<li>\n<p><strong>\u77e9\u9635\u8303\u6570\u7684\u4fdd\u6301</strong>\uff1a\u5bf9\u4e8e\u4efb\u610f\u76f8\u5bb9\u7684\u77e9\u9635\u8303\u6570$|\\cdot|$\uff1a\n$$|\\mathbf{A} \\otimes \\mathbf{B}| = |\\mathbf{A}| \\cdot |\\mathbf{B}|$$\n\u8fd9\u4fdd\u8bc1\u4e86K-FAC\u8fd1\u4f3c\u4e0d\u4f1a\u5f15\u5165\u6570\u503c\u4e0d\u7a33\u5b9a\u6027\u3002</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u7684\u4e58\u79ef\u6027</strong>\uff1a\n$$\\kappa(\\mathbf{A} \\otimes \\mathbf{B}) = \\kappa(\\mathbf{A}) \\cdot \\kappa(\\mathbf{B})$$\n\u8fd9\u610f\u5473\u7740\u9700\u8981\u540c\u65f6\u63a7\u5236\u4e24\u4e2a\u56e0\u5b50\u7684\u6761\u4ef6\u6570\u4ee5\u4fdd\u8bc1\u6570\u503c\u7a33\u5b9a\u6027\u3002</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u6d41\u7684\u5206\u89e3</strong>\uff1a\u5728\u8fde\u7eed\u65f6\u95f4\u6781\u9650\u4e0b\uff0cK-FAC\u5bf9\u5e94\u7684\u68af\u5ea6\u6d41\u53ef\u4ee5\u5206\u89e3\u4e3a\uff1a\n$$\\frac{d\\mathbf{W}}{dt} = -(\\mathbf{A}^{-1} \\otimes \\mathbf{B}^{-1})\\text{vec}(\\nabla_{\\mathbf{W}}\\mathcal{L})$$\n\u8fd9\u53ef\u4ee5\u89e3\u91ca\u4e3a\u5728\u4e24\u4e2a\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\u4e0a\u7684\u8026\u5408\u52a8\u529b\u5b66\u3002</p>\n</li>\n<li>\n<p><strong>\u4fe1\u606f\u8bba\u89e3\u91ca</strong>\uff1aKronecker\u79ef\u5206\u89e3\u6700\u5c0f\u5316\u4e86\u4ee5\u4e0b\u4fe1\u606f\u8bba\u51c6\u5219\uff1a\n$$\\min_{\\mathbf{A},\\mathbf{B}} D_{KL}(\\mathcal{N}(0, \\mathbf{F}) | \\mathcal{N}(0, \\mathbf{A} \\otimes \\mathbf{B}))$$\n\u5176\u4e2d$D_{KL}$\u662fKullback-Leibler\u6563\u5ea6\u3002\u8fd9\u63d0\u4f9b\u4e86K-FAC\u7684\u4fe1\u606f\u51e0\u4f55\u57fa\u7840\u3002</p>\n</li>\n<li>\n<p><strong>\u4e0e\u5f20\u91cf\u5206\u89e3\u7684\u8054\u7cfb</strong>\uff1aK-FAC\u53ef\u4ee5\u770b\u4f5c\u662f\u5bf9\u56db\u9636\u5f20\u91cf$\\mathcal{F}_{ijkl} = \\mathbf{F}_{(i-1)m+j,(k-1)m+l}$\u7684\u7279\u6b8aTucker\u5206\u89e3\uff1a\n$$\\mathcal{F} \\approx \\mathcal{G} \\times_1 \\mathbf{U}_1 \\times_2 \\mathbf{U}_2 \\times_3 \\mathbf{U}_3 \\times_4 \\mathbf{U}_4$$\n\u5176\u4e2d\u6838\u5fc3\u5f20\u91cf$\\mathcal{G}$\u5177\u6709\u7279\u6b8a\u7684\u5bf9\u89d2\u7ed3\u6784\u3002</p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u4f9d\u636e\u4e0e\u5047\u8bbe</strong>\uff1a</p>\n<p>K-FAC\u8fd1\u4f3c\u57fa\u4e8e\u4ee5\u4e0b\u5173\u952e\u5047\u8bbe\uff1a</p>\n<ol>\n<li><strong>\u6fc0\u6d3b\u4e0e\u68af\u5ea6\u7684\u7edf\u8ba1\u72ec\u7acb\u6027</strong>\uff1a\u5047\u8bbe\u524d\u5411\u6fc0\u6d3b$\\mathbf{a}_{l-1}$\u4e0e\u53cd\u5411\u68af\u5ea6$\\mathbf{g}_l$\u5728\u6570\u636e\u5206\u5e03\u4e0a\u72ec\u7acb</li>\n<li><strong>\u5c42\u95f4\u72ec\u7acb\u6027</strong>\uff1a\u4e0d\u540c\u5c42\u7684\u53c2\u6570\u66f4\u65b0\u53ef\u4ee5\u72ec\u7acb\u5904\u7406</li>\n<li><strong>\u540c\u8d28\u6027\u5047\u8bbe</strong>\uff1abatch\u5185\u7684\u6837\u672c\u5bf9Fisher\u77e9\u9635\u8d21\u732e\u76f8\u4f3c</li>\n</ol>\n<p>\u8fd9\u4e9b\u5047\u8bbe\u867d\u7136\u5728\u5b9e\u8df5\u4e2d\u5e76\u4e0d\u5b8c\u5168\u6210\u7acb\uff0c\u4f46\u7ecf\u9a8c\u8868\u660eK-FAC\u4ecd\u80fd\u63d0\u4f9b\u9ad8\u8d28\u91cf\u7684\u66f2\u7387\u8fd1\u4f3c\u3002\u8fd1\u671f\u7814\u7a76\u8868\u660e\uff0c\u901a\u8fc7\u5f15\u5165\u9ad8\u9636\u4fee\u6b63\u9879\u53ef\u4ee5\u653e\u677e\u8fd9\u4e9b\u5047\u8bbe\uff1a\n$$\\mathbf{F}_l = \\mathbf{A}_l \\otimes \\mathbf{B}_l + \\mathbf{R}_l$$\n\u5176\u4e2d$\\mathbf{R}_l$\u662f\u6355\u83b7\u975eKronecker\u7ed3\u6784\u7684\u6b8b\u5dee\u9879\u3002</p>\n<p><strong>\u5047\u8bbe\u7684\u6570\u5b66\u523b\u753b\u4e0e\u653e\u677e</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u72ec\u7acb\u6027\u5047\u8bbe\u7684\u91cf\u5316</strong>\uff1a\u5b9a\u4e49\u76f8\u5173\u6027\u5ea6\u91cf\uff1a\n$$\\rho(\\mathbf{a}, \\mathbf{g}) = \\frac{|\\mathbb{E}[\\mathbf{a}\\mathbf{a}^T \\otimes \\mathbf{g}\\mathbf{g}^T] - \\mathbb{E}[\\mathbf{a}\\mathbf{a}^T] \\otimes \\mathbb{E}[\\mathbf{g}\\mathbf{g}^T]|_F}{|\\mathbb{E}[\\mathbf{a}\\mathbf{a}^T]|_F \\cdot |\\mathbb{E}[\\mathbf{g}\\mathbf{g}^T]|_F}$$\n\u5f53$\\rho \\approx 0$\u65f6\uff0cK-FAC\u8fd1\u4f3c\u8d28\u91cf\u9ad8\u3002\u5b9e\u8df5\u4e2d\uff0c$\\rho$\u901a\u5e38\u57280.1-0.3\u8303\u56f4\u5185\u3002</p>\n</li>\n<li>\n<p><strong>\u5c42\u95f4\u76f8\u5173\u6027\u7684\u5904\u7406</strong>\uff1a\u901a\u8fc7\u5f15\u5165\u4e09\u56e0\u5b50\u5206\u89e3\u6355\u83b7\u76f8\u90bb\u5c42\u7684\u76f8\u5173\u6027\uff1a\n$$\\mathbf{F}_{l,l+1} \\approx \\mathbf{A}_l \\otimes \\mathbf{C}_{l,l+1} \\otimes \\mathbf{B}_{l+1}$$\n\u5176\u4e2d$\\mathbf{C}_{l,l+1}$\u6355\u83b7\u5c42\u95f4\u7684\u4f20\u9012\u7ed3\u6784\u3002</p>\n</li>\n<li>\n<p><strong>\u975e\u540c\u8d28\u6027\u7684\u81ea\u9002\u5e94\u5904\u7406</strong>\uff1a\u4f7f\u7528\u6837\u672c\u7279\u5b9a\u7684\u6743\u91cd\uff1a\n$$\\mathbf{F}_l = \\sum_{i=1}^B w_i \\cdot \\text{vec}(\\nabla_{\\mathbf{W}_l}\\mathcal{L}_i)\\text{vec}(\\nabla_{\\mathbf{W}_l}\\mathcal{L}_i)^T$$\n\u5176\u4e2d$w_i$\u57fa\u4e8e\u68af\u5ea6\u8303\u6570\u6216\u635f\u5931\u503c\u81ea\u9002\u5e94\u8c03\u6574\u3002</p>\n</li>\n<li>\n<p><strong>\u9ad8\u9636\u4fee\u6b63\u7684\u5177\u4f53\u5f62\u5f0f</strong>\uff1a\n$$\\mathbf{R}_l = \\sum_{k=1}^K \\sigma_k (\\mathbf{u}_k \\mathbf{v}_k^T) \\otimes (\\mathbf{p}_k \\mathbf{q}_k^T)$$\n\u8fd9\u662f\u4e00\u4e2a\u4f4e\u79e9\u4fee\u6b63\uff0c\u53ef\u4ee5\u901a\u8fc7\u968f\u673aSVD\u9ad8\u6548\u8ba1\u7b97\u3002</p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1\u7684\u6700\u65b0\u8fdb\u5c55</strong>\uff1a</p>\n<p><strong>\u5b9a\u7406\uff08K-FAC\u8fd1\u4f3c\u8bef\u5dee\u754c\uff09</strong>\uff1a\u5728\u6e29\u548c\u7684\u6b63\u5219\u6027\u6761\u4ef6\u4e0b\uff0c\u5b58\u5728\u5e38\u6570$C$\u4f7f\u5f97\uff1a\n$$|\\mathbf{F}_l - \\mathbf{A}_l \\otimes \\mathbf{B}_l|_F \\leq C \\cdot \\sqrt{mn} \\cdot \\mathbb{E}[|\\mathbf{a}_{l-1}|^2|\\mathbf{g}_l|^2] \\cdot \\rho(\\mathbf{a}_{l-1}, \\mathbf{g}_l)$$\n\u8fd9\u4e2a\u754c\u8bf4\u660e\u4e86\u7f51\u7edc\u5bbd\u5ea6\u3001\u6fc0\u6d3b/\u68af\u5ea6\u7684\u5927\u5c0f\u4ee5\u53ca\u76f8\u5173\u6027\u5982\u4f55\u5f71\u54cd\u8fd1\u4f3c\u8d28\u91cf\u3002</p>\n<p><strong>\u4e0eNatural Gradient\u7684\u6df1\u5c42\u8054\u7cfb</strong>\uff1a</p>\n<p>K-FAC\u53ef\u89c6\u4e3aNatural Gradient\u5728\u6df1\u5ea6\u7f51\u7edc\u4e2d\u7684\u9ad8\u6548\u5b9e\u73b0\u3002\u8003\u8651\u53c2\u6570\u7a7a\u95f4\u7684\u9ece\u66fc\u5ea6\u91cf\uff1a\n$$ds^2 = d\\boldsymbol{\\theta}^T \\mathbf{F}(\\boldsymbol{\\theta}) d\\boldsymbol{\\theta}$$\nNatural Gradient\u6cbf\u7740\u8be5\u5ea6\u91cf\u5b9a\u4e49\u7684\u6700\u9661\u4e0b\u964d\u65b9\u5411\u66f4\u65b0\u53c2\u6570\uff1a\n$$\\boldsymbol{\\theta}_{t+1} = \\boldsymbol{\\theta}_t - \\eta \\mathbf{F}^{-1}(\\boldsymbol{\\theta}_t) \\nabla_{\\boldsymbol{\\theta}} \\mathcal{L}$$\nK-FAC\u901a\u8fc7Kronecker\u5206\u89e3\u4f7f\u5f97$\\mathbf{F}^{-1}$\u7684\u8ba1\u7b97\u53d8\u5f97\u53ef\u884c\u3002\u66f4\u6df1\u5165\u5730\uff0c\u8fd9\u79cd\u5206\u89e3\u9690\u542b\u4e86\u5bf9\u7f51\u7edc\u6fc0\u6d3b\u6d41\u7684\u9a6c\u5c14\u53ef\u592b\u5047\u8bbe\uff0c\u5373\u4fe1\u606f\u5728\u5c42\u95f4\u7684\u4f20\u64ad\u5177\u6709\u65e0\u8bb0\u5fc6\u6027\u3002</p>\n<p><strong>\u4fe1\u606f\u51e0\u4f55\u7684\u6df1\u5c42\u89c6\u89d2</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u53c2\u6570\u5316\u4e0d\u53d8\u6027</strong>\uff1aNatural Gradient\u5177\u6709\u53c2\u6570\u5316\u4e0d\u53d8\u6027\uff0c\u5373\u5bf9\u4e8e\u53ef\u9006\u53d8\u6362$\\boldsymbol{\\phi} = f(\\boldsymbol{\\theta})$\uff1a\n$$\\tilde{\\nabla}_{\\boldsymbol{\\phi}}\\mathcal{L} = \\mathbf{J}_f^{-T} \\tilde{\\nabla}_{\\boldsymbol{\\theta}}\\mathcal{L}$$\n\u5176\u4e2d$\\tilde{\\nabla}$\u8868\u793a\u81ea\u7136\u68af\u5ea6\uff0c$\\mathbf{J}_f$\u662fJacobian\u77e9\u9635\u3002\u8fd9\u4fdd\u8bc1\u4e86\u4f18\u5316\u8f68\u8ff9\u4e0d\u4f9d\u8d56\u4e8e\u53c2\u6570\u5316\u65b9\u5f0f\u3002</p>\n</li>\n<li>\n<p><strong>\u6700\u5c0f\u957f\u5ea6\u539f\u7406</strong>\uff1aNatural Gradient\u66f4\u65b0\u5bf9\u5e94\u4e8e\u53c2\u6570\u7a7a\u95f4\u4e2d\u7684\u6d4b\u5730\u7ebf\uff0c\u6700\u5c0f\u5316\u4e86\u4ee5\u4e0b\u6cdb\u51fd\uff1a\n$$\\mathcal{S}[\\boldsymbol{\\theta}(t)] = \\int_0^1 \\sqrt{\\dot{\\boldsymbol{\\theta}}^T(t) \\mathbf{F}(\\boldsymbol{\\theta}(t)) \\dot{\\boldsymbol{\\theta}}(t)} dt$$\nK-FAC\u901a\u8fc7Kronecker\u8fd1\u4f3c\u4fdd\u6301\u4e86\u8fd9\u79cd\u51e0\u4f55\u7ed3\u6784\u7684\u4e3b\u8981\u7279\u5f81\u3002</p>\n</li>\n<li>\n<p><strong>KL\u6563\u5ea6\u7684\u4e8c\u9636Taylor\u5c55\u5f00</strong>\uff1aFisher\u77e9\u9635\u662fKL\u6563\u5ea6\u7684\u5c40\u90e8\u4e8c\u6b21\u8fd1\u4f3c\uff1a\n$$D_{KL}(p(\\cdot|\\boldsymbol{\\theta}) | p(\\cdot|\\boldsymbol{\\theta} + \\Delta\\boldsymbol{\\theta})) \\approx \\frac{1}{2}\\Delta\\boldsymbol{\\theta}^T \\mathbf{F}(\\boldsymbol{\\theta}) \\Delta\\boldsymbol{\\theta}$$\nK-FAC\u4fdd\u6301\u4e86\u8fd9\u79cd\u8fd1\u4f3c\u7684\u4e3b\u8981\u7ed3\u6784\uff0c\u540c\u65f6\u5927\u5e45\u964d\u4f4e\u4e86\u8ba1\u7b97\u590d\u6742\u5ea6\u3002</p>\n</li>\n<li>\n<p><strong>\u4e0e\u91cf\u5b50\u4fe1\u606f\u7684\u8054\u7cfb</strong>\uff1aFisher\u4fe1\u606f\u77e9\u9635\u4e0e\u91cf\u5b50\u4fdd\u771f\u5ea6\uff08quantum fidelity\uff09\u7684\u5173\u7cfb\uff1a\n$$F(\\rho_{\\boldsymbol{\\theta}}, \\rho_{\\boldsymbol{\\theta}+d\\boldsymbol{\\theta}}) = 1 - \\frac{1}{8}d\\boldsymbol{\\theta}^T \\mathbf{F}_{Q}(\\boldsymbol{\\theta}) d\\boldsymbol{\\theta} + O(|d\\boldsymbol{\\theta}|^3)$$\n\u5176\u4e2d$\\mathbf{F}_Q$\u662f\u91cf\u5b50Fisher\u4fe1\u606f\u77e9\u9635\u3002\u8fd9\u6697\u793a\u4e86K-FAC\u5728\u91cf\u5b50\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u6f5c\u5728\u5e94\u7528\u3002</p>\n</li>\n</ol>\n<h3 id=\"312-k-fac\">3.1.2 K-FAC\u7b97\u6cd5\u8be6\u89e3</h3>\n<p>K-FAC\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u8fd1\u4f3cFisher\u4fe1\u606f\u77e9\u9635\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6fc0\u6d3b\u7edf\u8ba1\u6536\u96c6</strong>\uff1a\n   - \u8f93\u5165\u6fc0\u6d3b\uff1a$\\mathbf{a}_{l-1} \\in \\mathbb{R}^n$\n   - \u9884\u6fc0\u6d3b\u68af\u5ea6\uff1a$\\mathbf{g}_l \\in \\mathbb{R}^m$</p>\n</li>\n<li>\n<p><strong>Kronecker\u56e0\u5b50\u4f30\u8ba1</strong>\uff1a\n$$\\mathbf{A}_l = \\mathbb{E}[\\mathbf{g}_l \\mathbf{g}_l^T], \\quad \\mathbf{B}_l = \\mathbb{E}[\\mathbf{a}_{l-1} \\mathbf{a}_{l-1}^T]$$</p>\n</li>\n<li>\n<p><strong>\u81ea\u7136\u68af\u5ea6\u8ba1\u7b97</strong>\uff1a\n$$\\text{vec}(\\Delta\\mathbf{W}_l) = (\\mathbf{A}_l \\otimes \\mathbf{B}_l)^{-1} \\text{vec}(\\nabla_{\\mathbf{W}_l} \\mathcal{L})$$\n\u5b9e\u9645\u5b9e\u73b0\u4e2d\uff0c\u901a\u5e38\u91c7\u7528\u8fd0\u884c\u5e73\u5747\u6765\u4f30\u8ba1\u671f\u671b\u503c\uff0c\u5e76\u5b9a\u671f\u66f4\u65b0\u9006\u77e9\u9635\u4ee5\u5e73\u8861\u8ba1\u7b97\u6210\u672c\u3002</p>\n</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u7684\u7cbe\u786e\u63cf\u8ff0\u4e0e\u53d8\u4f53</strong>\uff1a</p>\n<p><strong>\u7b97\u6cd5 3.1\uff1aK-FAC with Adaptive Damping</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u5b66\u4e60\u7387\u03b7\uff0c\u52a8\u91cf\u53c2\u6570\u03b2\u2081\uff0c\u963b\u5c3c\u53c2\u6570\u03bb\u2080\uff0c\u66f4\u65b0\u9891\u7387T_inv\n\u521d\u59cb\u5316\uff1aA_l = \u03b5I, B_l = \u03b5I for all layers l\n\nfor t = 1, 2, ... do\n    // \u524d\u5411\u4f20\u64ad\uff0c\u6536\u96c6\u6fc0\u6d3b\n    for l = 1 to L do\n        a_{l-1} = \u5c42l\u7684\u8f93\u5165\u6fc0\u6d3b\n        \u5b58\u50a8 a_{l-1}\n\n    // \u53cd\u5411\u4f20\u64ad\uff0c\u6536\u96c6\u68af\u5ea6\n    for l = L to 1 do\n        g_l = \u5c42l\u7684\u9884\u6fc0\u6d3b\u68af\u5ea6\n        \u2207W_l = g_l \u2297 a_{l-1}^T\n\n    // \u66f4\u65b0Kronecker\u56e0\u5b50\uff08\u6307\u6570\u79fb\u52a8\u5e73\u5747\uff09\n    for l = 1 to L do\n        A_l \u2190 \u03b2\u2081 A_l + (1-\u03b2\u2081) E[g_l g_l^T]\n        B_l \u2190 \u03b2\u2081 B_l + (1-\u03b2\u2081) E[a_{l-1} a_{l-1}^T]\n\n    // \u5468\u671f\u6027\u66f4\u65b0\u9006\u77e9\u9635\n    if t mod T_inv == 0 then\n        for l = 1 to L do\n            // \u81ea\u9002\u5e94\u963b\u5c3c\n            \u03bb_l = \u03bb\u2080 * (tr(A_l)/m + tr(B_l)/n) / 2\n            \u00c3_l = A_l + \u03bb_l I\n            B\u0303_l = B_l + \u03bb_l I\n\n            // \u8ba1\u7b97\u9006\u6216\u4f2a\u9006\n            A_l^{-1} = pinv(\u00c3_l)\n            B_l^{-1} = pinv(B\u0303_l)\n\n    // \u5e94\u7528\u9884\u6761\u4ef6\u66f4\u65b0\n    for l = 1 to L do\n        vec(\u0394W_l) = (A_l^{-1} \u2297 B_l^{-1}) vec(\u2207W_l)\n        W_l \u2190 W_l - \u03b7 \u0394W_l\n</code></pre></div>\n\n<p><strong>\u5173\u952e\u5b9e\u73b0\u7ec6\u8282</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6279\u5904\u7406\u4e2d\u7684\u9ad8\u6548\u8ba1\u7b97</strong>\uff1a\n   \u5bf9\u4e8e\u6279\u91cf\u5927\u5c0fB\uff0c\u6fc0\u6d3b\u548c\u68af\u5ea6\u7684\u534f\u65b9\u5dee\u4f30\u8ba1\uff1a\n$$\\mathbf{A}_l = \\frac{1}{B}\\sum_{i=1}^B \\mathbf{g}_l^{(i)} (\\mathbf{g}_l^{(i)})^T$$\n   $$\\mathbf{B}_l = \\frac{1}{B}\\sum_{i=1}^B \\mathbf{a}_{l-1}^{(i)} (\\mathbf{a}_{l-1}^{(i)})^T$$\n\u53ef\u4ee5\u901a\u8fc7\u77e9\u9635\u4e58\u6cd5\u9ad8\u6548\u5b9e\u73b0\uff1a\n$$\\mathbf{A}_l = \\frac{1}{B}\\mathbf{G}_l\\mathbf{G}_l^T, \\quad \\mathbf{B}_l = \\frac{1}{B}\\mathbf{A}_{l-1}\\mathbf{A}_{l-1}^T$$\n\u5176\u4e2d$\\mathbf{G}_l = [\\mathbf{g}_l^{(1)}, \\ldots, \\mathbf{g}_l^{(B)}]$\u3002</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u540c\u6b65\u7b56\u7565</strong>\uff1a\n   - <strong>\u540c\u6b65K-FAC</strong>\uff1a\u6240\u6709\u8282\u70b9\u540c\u6b65\u66f4\u65b0\u56e0\u5b50\n   - <strong>\u5f02\u6b65K-FAC</strong>\uff1a\u56e0\u5b50\u66f4\u65b0\u53ef\u4ee5\u5ef6\u8fdf\uff0c\u51cf\u5c11\u901a\u4fe1\u5f00\u9500\n   - <strong>\u5c40\u90e8K-FAC</strong>\uff1a\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u5c40\u90e8\u56e0\u5b50\uff0c\u5468\u671f\u6027\u540c\u6b65</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u4f18\u5316\u6280\u672f</strong>\uff1a\n   - <strong>\u56e0\u5b50\u5171\u4eab</strong>\uff1a\u76f8\u4f3c\u5c42\uff08\u5982ResNet\u5757\uff09\u5171\u4eabKronecker\u56e0\u5b50\n   - <strong>\u4f4e\u7cbe\u5ea6\u5b58\u50a8</strong>\uff1a\u56e0\u5b50\u7528FP16\u5b58\u50a8\uff0c\u8ba1\u7b97\u65f6\u8f6cFP32\n   - <strong>\u7a00\u758f\u8868\u793a</strong>\uff1a\u5bf9\u4e8eReLU\u7f51\u7edc\uff0c\u5229\u7528\u6fc0\u6d3b\u7a00\u758f\u6027</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u5b9e\u73b0\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li><strong>\u52a8\u91cf\u673a\u5236\u7684\u6574\u5408</strong>\uff1a\n   K-FAC\u53ef\u4ee5\u4e0e\u52a8\u91cf\u65b9\u6cd5\u7ed3\u5408\uff0c\u5f62\u6210\u9884\u6761\u4ef6\u52a8\u91cf\u66f4\u65b0\uff1a\n$$\\mathbf{m}_{t+1} = \\beta_1 \\mathbf{m}_t + (1-\\beta_1) \\mathbf{g}_t$$\n   $$\\mathbf{v}_{t+1} = (\\mathbf{A}_t \\otimes \\mathbf{B}_t)^{-1} \\mathbf{m}_{t+1}$$\n\u8fd9\u79cd\u7ed3\u5408\u65e2\u4fdd\u7559\u4e86\u52a8\u91cf\u7684\u52a0\u901f\u6548\u679c\uff0c\u53c8\u5229\u7528\u4e86\u4e8c\u9636\u4fe1\u606f\u7684\u65b9\u5411\u6821\u6b63\u3002</li>\n</ol>\n<p><strong>\u52a8\u91cf\u7684\u4e0d\u540c\u7ec4\u5408\u65b9\u5f0f</strong>\uff1a</p>\n<ul>\n<li><strong>\u9884\u6761\u4ef6\u52a8\u91cf\uff08PM\uff09</strong>\uff1a$\\mathbf{v}_t = (\\mathbf{F}_t)^{-1}\\mathbf{m}_t$</li>\n<li><strong>\u540e\u6761\u4ef6\u52a8\u91cf\uff08AM\uff09</strong>\uff1a$\\mathbf{m}_t = \\beta\\mathbf{m}_{t-1} + (1-\\beta)(\\mathbf{F}_t)^{-1}\\mathbf{g}_t$</li>\n<li><strong>\u6df7\u5408\u52a8\u91cf\uff08HM\uff09</strong>\uff1a$\\mathbf{v}_t = \\alpha(\\mathbf{F}_t)^{-1}\\mathbf{m}_t + (1-\\alpha)(\\mathbf{F}_t)^{-1}\\mathbf{g}_t$</li>\n</ul>\n<p>\u7814\u7a76\u8868\u660e\uff0cPM\u5728\u975e\u51f8\u4f18\u5316\u4e2d\u66f4\u7a33\u5b9a\uff0c\u800cAM\u5728\u51f8\u4f18\u5316\u4e2d\u6536\u655b\u66f4\u5feb\u3002</p>\n<ol start=\"2\">\n<li><strong>\u5206\u5757\u66f4\u65b0\u7b56\u7565</strong>\uff1a\n   \u4e3a\u4e86\u964d\u4f4e\u8ba1\u7b97\u5f00\u9500\uff0c\u53ef\u4ee5\u91c7\u7528\u5206\u5757\u66f4\u65b0\u7b56\u7565\uff1a</li>\n</ol>\n<ul>\n<li>\u5c06\u5c42\u5206\u7ec4\uff0c\u6bcf\u6b21\u53ea\u66f4\u65b0\u4e00\u7ec4\u7684Kronecker\u56e0\u5b50</li>\n<li>\u4f7f\u7528\u5faa\u73af\u8c03\u5ea6\u6216\u57fa\u4e8e\u91cd\u8981\u6027\u7684\u8c03\u5ea6</li>\n<li>\u5173\u952e\u5c42\uff08\u5982\u8f93\u51fa\u5c42\u9644\u8fd1\uff09\u66f4\u9891\u7e41\u66f4\u65b0</li>\n</ul>\n<p><strong>\u5c42\u91cd\u8981\u6027\u7684\u91cf\u5316\u6307\u6807</strong>\uff1a</p>\n<ul>\n<li><strong>\u68af\u5ea6\u8303\u6570\u6bd4</strong>\uff1a$\\gamma_l = |\\nabla_{\\mathbf{W}_l}\\mathcal{L}|_F / \\sum_j |\\nabla_{\\mathbf{W}_j}\\mathcal{L}|_F$</li>\n<li><strong>Fisher\u8ff9\u6bd4</strong>\uff1a$\\tau_l = \\text{tr}(\\mathbf{F}_l) / \\sum_j \\text{tr}(\\mathbf{F}_j)$</li>\n<li><strong>\u6709\u6548\u79e9</strong>\uff1a$r_{\\text{eff},l} = (\\text{tr}(\\mathbf{F}_l))^2 / \\text{tr}(\\mathbf{F}_l^2)$</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u8c03\u5ea6\u7b97\u6cd5</strong>\uff1a\n   ```\n   \u6bcf\u9694T\u6b65\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u6240\u6709\u5c42\u7684\u91cd\u8981\u6027\u6307\u6807</li>\n<li>\u9009\u62e9top-k\u5c42\u8fdb\u884c\u56e0\u5b50\u66f4\u65b0</li>\n<li>\n<p>\u5176\u4f59\u5c42\u4f7f\u7528\u8fc7\u65f6\u7684\u56e0\u5b50\u6216\u5bf9\u89d2\u8fd1\u4f3c\n   ```</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u8bc1</strong>\uff1a</p>\n</li>\n</ol>\n<p><strong>Tikhonov\u6b63\u5219\u5316</strong>\uff1a\n$$\\tilde{\\mathbf{A}}_l = \\mathbf{A}_l + \\lambda_A \\mathbf{I}, \\quad \\tilde{\\mathbf{B}}_l = \\mathbf{B}_l + \\lambda_B \\mathbf{I}$$\n\u5176\u4e2d$\\lambda_A$\u548c$\\lambda_B$\u7684\u9009\u62e9\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u8ff9\u7684\u81ea\u9002\u5e94\uff1a$\\lambda = \\max(\\epsilon, \\alpha \\cdot \\text{tr}(\\mathbf{A})/m)$</li>\n<li>\u57fa\u4e8e\u6761\u4ef6\u6570\u7684\u8c03\u6574\uff1a\u76d1\u63a7$\\kappa(\\mathbf{A})$\uff0c\u5f53\u8d85\u8fc7\u9608\u503c\u65f6\u589e\u5927$\\lambda$</li>\n</ul>\n<p><strong>\u8c31\u622a\u65ad</strong>\uff1a\n   \u5bf9\u4e8e\u75c5\u6001\u77e9\u9635\uff0c\u53ef\u4ee5\u4f7f\u7528\u8c31\u622a\u65ad\uff1a\n$$\\mathbf{A} = \\mathbf{U}\\mathbf{\\Lambda}\\mathbf{U}^T \\rightarrow \\tilde{\\mathbf{A}}^{-1} = \\mathbf{U}\\text{diag}(\\min(\\lambda_i^{-1}, \\tau))\\mathbf{U}^T$$\n<strong>\u9ad8\u7ea7\u6b63\u5219\u5316\u6280\u672f</strong>\uff1a</p>\n<p><strong>\u81ea\u9002\u5e94\u8c31\u6b63\u5219\u5316</strong>\uff1a\u57fa\u4e8e\u6709\u6548\u79e9\u7684\u52a8\u6001\u8c03\u6574\n$$\\lambda(t) = \\lambda_0 \\cdot \\exp\\left(-\\beta \\cdot \\frac{r_{\\text{eff}}(t)}{n}\\right)$$\n\u5176\u4e2d$r_{\\text{eff}} = (\\text{tr}(\\mathbf{A}))^2 / \\text{tr}(\\mathbf{A}^2)$\u662f\u6709\u6548\u79e9\u3002</p>\n<p><strong>\u5206\u5c42\u6b63\u5219\u5316</strong>\uff1a\u4e0d\u540c\u5c42\u4f7f\u7528\u4e0d\u540c\u7684\u6b63\u5219\u5316\u5f3a\u5ea6\n$$\\lambda_l = \\lambda_{\\text{base}} \\cdot \\left(\\frac{\\text{width}_l}{\\text{width}_{\\text{max}}}\\right)^\\alpha$$\n<strong>\u9c81\u68d2\u4f2a\u9006</strong>\uff1a\u4f7f\u7528Moore-Penrose\u4f2a\u9006\u5904\u7406\u5947\u5f02\u60c5\u51b5\n$$\\mathbf{A}^{\\dagger} = \\lim_{\\epsilon \\to 0^+} (\\mathbf{A}^T\\mathbf{A} + \\epsilon\\mathbf{I})^{-1}\\mathbf{A}^T$$</p>\n<ol start=\"4\">\n<li><strong>\u5185\u5b58\u9ad8\u6548\u7684\u5b9e\u73b0</strong>\uff1a</li>\n</ol>\n<p><strong>\u4f4e\u7cbe\u5ea6\u5b58\u50a8</strong>\uff1aKronecker\u56e0\u5b50\u53ef\u4ee5\u7528FP16\u5b58\u50a8\uff0c\u8ba1\u7b97\u65f6\u8f6c\u6362\u4e3aFP32</p>\n<p><strong>\u7a00\u758f\u5316\u7b56\u7565</strong>\uff1a\u5bf9\u4e8e\u7a00\u758f\u6fc0\u6d3b\uff08\u5982ReLU\u540e\uff09\uff0c\u5229\u7528\u7a00\u758f\u77e9\u9635\u683c\u5f0f</p>\n<p><strong>\u5171\u4eab\u56e0\u5b50</strong>\uff1a\u76f8\u4f3c\u5c42\uff08\u5982ResNet\u4e2d\u7684\u91cd\u590d\u5757\uff09\u53ef\u4ee5\u5171\u4eabKronecker\u56e0\u5b50</p>\n<p><strong>\u5185\u5b58\u6c60\u5316\u6280\u672f</strong>\uff1a\n   ```python\n   class KroneckerFactorPool:\n       def <strong>init</strong>(self, max_memory):\n           self.pool = {}\n           self.usage_count = {}\n           self.memory_limit = max_memory</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"n\">def</span><span class=\"w\"> </span><span class=\"n\">get_or_create</span><span class=\"p\">(</span><span class=\"n\">self</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">layer_key</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">shape</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">       </span><span class=\"err\">#</span><span class=\"w\"> </span><span class=\"n\">\u68c0\u67e5\u662f\u5426\u5b58\u5728\u53ef\u590d\u7528\u7684\u56e0\u5b50</span>\n<span class=\"w\">       </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"k\">key</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">factor</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">pool</span><span class=\"p\">.</span><span class=\"n\">items</span><span class=\"p\">()</span><span class=\"err\">:</span>\n<span class=\"w\">           </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">is_compatible</span><span class=\"p\">(</span><span class=\"n\">factor</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">shape</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">               </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">usage_count</span><span class=\"o\">[</span><span class=\"n\">key</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">               </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">factor</span>\n\n<span class=\"w\">       </span><span class=\"err\">#</span><span class=\"w\"> </span><span class=\"n\">\u521b\u5efa\u65b0\u56e0\u5b50</span><span class=\"err\">\uff0c</span><span class=\"n\">\u5fc5\u8981\u65f6\u9010\u51fa\u6700\u5c11\u4f7f\u7528\u7684</span>\n<span class=\"w\">       </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">current_memory</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"nl\">memory_limit</span><span class=\"p\">:</span>\n<span class=\"w\">           </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">evict_lru</span><span class=\"p\">()</span>\n\n<span class=\"w\">       </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">create_new_factor</span><span class=\"p\">(</span><span class=\"n\">layer_key</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">shape</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p>```</p>\n<p><strong>\u91cf\u5316\u538b\u7f29</strong>\uff1a</p>\n<ul>\n<li><strong>\u5bf9\u79f0\u91cf\u5316</strong>\uff1a\u5229\u7528\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5bf9\u79f0\u6027</li>\n<li><strong>\u5757\u91cf\u5316</strong>\uff1a\u5c06\u77e9\u9635\u5206\u5757\uff0c\u6bcf\u5757\u4f7f\u7528\u4e0d\u540c\u7684\u91cf\u5316\u7ea7\u522b</li>\n<li><strong>\u52a8\u6001\u8303\u56f4</strong>\uff1a\u57fa\u4e8e\u5386\u53f2\u7edf\u8ba1\u8c03\u6574\u91cf\u5316\u8303\u56f4</li>\n</ul>\n<h3 id=\"313-k-fac\">3.1.3 K-FAC\u7684\u53d8\u4f53\u4e0e\u6269\u5c55</h3>\n<p><strong>K-BFGS</strong>\uff1a\u5c06BFGS\u7684\u62df\u725b\u987f\u601d\u60f3\u4e0eKronecker\u7ed3\u6784\u7ed3\u5408</p>\n<p>K-BFGS\u7ef4\u62a4Kronecker\u7ed3\u6784\u7684\u540c\u65f6\u8fdb\u884c\u62df\u725b\u987f\u66f4\u65b0\uff1a\n$$\\mathbf{B}_{k+1} = \\mathbf{B}_k + \\Delta\\mathbf{B}_k$$\n\u5176\u4e2d$\\Delta\\mathbf{B}_k$\u4fdd\u6301Kronecker\u5f62\u5f0f\u3002\u5173\u952e\u521b\u65b0\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u79e9\u4e00\u4fee\u6b63\u7684Kronecker\u5206\u89e3\uff1a$\\Delta\\mathbf{B}_k = \\mathbf{u}\\mathbf{u}^T \\otimes \\mathbf{v}\\mathbf{v}^T$</li>\n<li>\u6ee1\u8db3\u62df\u725b\u987f\u6761\u4ef6\uff1a$\\mathbf{B}_{k+1}\\mathbf{s}_k = \\mathbf{y}_k$</li>\n<li>\u4fdd\u6301\u6b63\u5b9a\u6027\u7684\u540c\u65f6\u964d\u4f4e\u5b58\u50a8\u9700\u6c42</li>\n</ul>\n<p><strong>EKFAC (Eigenvalue-corrected K-FAC)</strong>\uff1a</p>\n<p>EKFAC\u901a\u8fc7\u7279\u5f81\u503c\u6821\u6b63\u89e3\u51b3K-FAC\u7684\u7cfb\u7edf\u6027\u504f\u5dee\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8c31\u5206\u6790</strong>\uff1a\u8ba1\u7b97\u771f\u5b9eFisher\u4e0eK-FAC\u8fd1\u4f3c\u7684\u8c31\u5dee\u5f02\n$$\\text{spec}(\\mathbf{F}) \\neq {\\lambda_i\\mu_j : \\lambda_i \\in \\text{spec}(\\mathbf{A}), \\mu_j \\in \\text{spec}(\\mathbf{B})}$$</p>\n</li>\n<li>\n<p><strong>\u6821\u6b63\u7b56\u7565</strong>\uff1a\n   - <strong>\u5168\u5c40\u7f29\u653e</strong>\uff1a$\\tilde{\\mathbf{F}} = \\alpha(\\mathbf{A} \\otimes \\mathbf{B})$\uff0c\u5176\u4e2d$\\alpha = \\frac{\\text{tr}(\\mathbf{F})}{\\text{tr}(\\mathbf{A})\\text{tr}(\\mathbf{B})}$\n   - <strong>\u8c31\u5bf9\u9f50</strong>\uff1a\u901a\u8fc7\u5339\u914d\u524d$k$\u4e2a\u7279\u5f81\u503c\u8fdb\u884c\u6821\u6b63\n   - <strong>\u81ea\u9002\u5e94\u963b\u5c3c</strong>\uff1a$\\tilde{\\mathbf{F}}_l = \\mathbf{F}_l + \\lambda(t)\\mathbf{I}$\uff0c$\\lambda(t)$\u968f\u8bad\u7ec3\u8fdb\u7a0b\u8870\u51cf</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u4f18\u5316</strong>\uff1a\n   - \u4f7f\u7528\u968f\u673a\u5316\u65b9\u6cd5\u4f30\u8ba1\u8c31\u6821\u6b63\u56e0\u5b50\n   - \u5468\u671f\u6027\u66f4\u65b0\u6821\u6b63\u53c2\u6570\uff08\u5982\u6bcf100\u6b65\uff09</p>\n</li>\n</ol>\n<p><strong>\u5206\u5e03\u5f0fK-FAC</strong>\uff1a</p>\n<p>\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u8bad\u7ec3\u4e2d\u7684K-FAC\u5b9e\u73b0\u9762\u4e34\u72ec\u7279\u6311\u6218\uff1a</p>\n<ol>\n<li>\n<p><strong>\u901a\u4fe1\u6a21\u5f0f\u4f18\u5316</strong>\uff1a\n   - <strong>All-reduce\u4f18\u5316</strong>\uff1aKronecker\u56e0\u5b50\u7684\u5206\u7247\u805a\u5408\n   - <strong>\u68af\u5ea6\u538b\u7f29</strong>\uff1a\u5229\u7528K-FAC\u7684\u4f4e\u79e9\u7ed3\u6784\u8fdb\u884c\u68af\u5ea6\u538b\u7f29\n   - <strong>\u5f02\u6b65\u901a\u4fe1</strong>\uff1a\u8ba1\u7b97\u4e0e\u901a\u4fe1\u91cd\u53e0\uff0c\u9690\u85cf\u5ef6\u8fdf</p>\n</li>\n<li>\n<p><strong>\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\n   - \u52a8\u6001\u5c42\u5206\u914d\uff1a\u6839\u636e\u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u914d\u5c42\u5230\u4e0d\u540c\u8282\u70b9\n   - \u6df7\u5408\u5e76\u884c\uff1a\u6570\u636e\u5e76\u884c\u4e0e\u6a21\u578b\u5e76\u884c\u7684\u7ed3\u5408\n   - \u5f39\u6027\u8ba1\u7b97\uff1a\u652f\u6301\u8282\u70b9\u52a8\u6001\u52a0\u5165/\u9000\u51fa</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a\n   - <strong>Byzantine-robust\u805a\u5408</strong>\uff1a\u4f7f\u7528\u4e2d\u4f4d\u6570\u6216\u4fee\u526a\u5747\u503c\n   - <strong>\u68c0\u67e5\u70b9\u673a\u5236</strong>\uff1a\u5b9a\u671f\u4fdd\u5b58Kronecker\u56e0\u5b50\n   - <strong>\u589e\u91cf\u6062\u590d</strong>\uff1a\u6545\u969c\u540e\u5feb\u901f\u6062\u590d\u8bad\u7ec3\u72b6\u6001</p>\n</li>\n</ol>\n<p><strong>Kronecker-factored Trust Region (KF-TR)</strong>\uff1a</p>\n<p>\u5c06\u4fe1\u8d56\u57df\u65b9\u6cd5\u4e0eK-FAC\u7ed3\u5408\uff1a\n$$\\min_{\\Delta\\mathbf{w}} \\mathcal{L}(\\mathbf{w}) + \\nabla\\mathcal{L}^T\\Delta\\mathbf{w} + \\frac{1}{2}\\Delta\\mathbf{w}^T(\\mathbf{A} \\otimes \\mathbf{B})\\Delta\\mathbf{w}$$\n$$\\text{s.t. } |\\Delta\\mathbf{w}|_{(\\mathbf{A} \\otimes \\mathbf{B})} \\leq \\delta$$\n\u5173\u952e\u7279\u6027\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u6b65\u957f\u63a7\u5236\uff0c\u907f\u514d\u8fc7\u5927\u66f4\u65b0</li>\n<li>\u4e8c\u9636\u6a21\u578b\u7684\u8d28\u91cf\u4fdd\u8bc1</li>\n<li>\u4e0eline search\u7684\u5bf9\u6bd4\u4f18\u52bf</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411\u4e0e\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u81ea\u9002\u5e94Kronecker\u5206\u89e3</strong>\uff1a\n   - \u52a8\u6001\u9009\u62e9\u5206\u89e3\u7684\u79e9\n   - \u591a\u91cdKronecker\u5206\u89e3\uff1a$\\mathbf{F} \\approx \\sum_{i=1}^r \\mathbf{A}_i \\otimes \\mathbf{B}_i$\n   - \u4e0e\u5f20\u91cf\u5206\u89e3\u7406\u8bba\u7684\u8054\u7cfb</p>\n</li>\n<li>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\n   - \u975e\u51f8\u4f18\u5316\u4e2d\u7684\u6536\u655b\u6027\u5206\u6790\n   - \u8fd1\u4f3c\u8bef\u5dee\u5bf9\u6536\u655b\u901f\u5ea6\u7684\u5f71\u54cd\n   - \u6700\u4f18\u66f4\u65b0\u9891\u7387\u7684\u7406\u8bba\u6307\u5bfc</p>\n</li>\n<li>\n<p><strong>\u65b0\u67b6\u6784\u7684\u9002\u5e94</strong>\uff1a\n   - Transformer\u4e2d\u7684\u591a\u5934\u6ce8\u610f\u529bK-FAC\n   - \u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u90bb\u57df\u805a\u5408K-FAC\n   - 3D\u5377\u79ef\u548c\u89c6\u9891\u6a21\u578b\u7684\u9ad8\u9636K-FAC</p>\n</li>\n</ol>\n<h3 id=\"314\">3.1.4 \u6536\u655b\u6027\u5206\u6790</h3>\n<p>K-FAC\u7684\u6536\u655b\u6027\u5206\u6790\u6d89\u53ca\u4e24\u4e2a\u5173\u952e\u65b9\u9762\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8fd1\u4f3c\u8bef\u5dee\u754c</strong>\uff1a\n$$|\\mathbf{F}_l - \\mathbf{A}_l \\otimes \\mathbf{B}_l|_F \\leq \\epsilon(\\mathbf{F}_l)$$\n\u5176\u4e2d$\\epsilon$\u4f9d\u8d56\u4e8e\u6fc0\u6d3b\u548c\u68af\u5ea6\u7684\u7edf\u8ba1\u72ec\u7acb\u6027\u5047\u8bbe\u3002</p>\n</li>\n<li>\n<p><strong>\u5168\u5c40\u6536\u655b\u901f\u7387</strong>\uff1a\n   \u5728\u5f3a\u51f8\u5047\u8bbe\u4e0b\uff0cK-FAC\u53ef\u8fbe\u5230\u8d85\u7ebf\u6027\u6536\u655b\uff1a\n$$|\\mathbf{w}_{t+1} - \\mathbf{w}^*| \\leq \\rho^t |\\mathbf{w}_0 - \\mathbf{w}^*|$$\n\u5176\u4e2d$\\rho &lt; 1$\u53d6\u51b3\u4e8eKronecker\u8fd1\u4f3c\u7684\u8d28\u91cf\u3002</p>\n</li>\n</ol>\n<p><strong>\u6df1\u5165\u7684\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li><strong>\u8fd1\u4f3c\u8bef\u5dee\u7684\u7cbe\u786e\u523b\u753b</strong>\uff1a</li>\n</ol>\n<p>\u8003\u8651\u771f\u5b9eFisher\u77e9\u9635\u7684\u5206\u89e3\uff1a\n$$\\mathbf{F} = \\mathbb{E}[\\text{vec}(\\mathbf{g})\\text{vec}(\\mathbf{g})^T]$$\nK-FAC\u8fd1\u4f3c\u8bef\u5dee\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a\n$$\\mathbf{E} = \\mathbf{F} - \\mathbf{A} \\otimes \\mathbf{B} = \\mathbb{E}[(\\mathbf{g} \\otimes \\mathbf{a})(\\mathbf{g} \\otimes \\mathbf{a})^T] - \\mathbb{E}[\\mathbf{g}\\mathbf{g}^T] \\otimes \\mathbb{E}[\\mathbf{a}\\mathbf{a}^T]$$\n\u5f53$\\mathbf{g}$\u548c$\\mathbf{a}$\u7edf\u8ba1\u72ec\u7acb\u65f6\uff0c$\\mathbf{E} = 0$\u3002\u5b9e\u9645\u4e2d\uff0c\u53ef\u4ee5\u8bc1\u660e\uff1a\n$$|\\mathbf{E}|_F \\leq C \\cdot \\text{Cov}(|\\mathbf{g}|^2, |\\mathbf{a}|^2)$$\n\u5176\u4e2d$C$\u662f\u4e0e\u7f51\u7edc\u7ed3\u6784\u76f8\u5173\u7684\u5e38\u6570\u3002</p>\n<ol start=\"2\">\n<li><strong>\u975e\u51f8\u60c5\u51b5\u4e0b\u7684\u5c40\u90e8\u6536\u655b\u6027</strong>\uff1a</li>\n</ol>\n<p>\u5728\u975e\u51f8\u4f18\u5316\u4e2d\uff0cK-FAC\u5728\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u65f6\u5177\u6709\u5c40\u90e8\u7ebf\u6027\u6536\u655b\u6027\uff1a</p>\n<p><strong>\u6761\u4ef6A\uff08\u5c40\u90e8\u5f3a\u51f8\u6027\uff09</strong>\uff1a\u5b58\u5728\u90bb\u57df$\\mathcal{N}(\\mathbf{w}^*)$\u4f7f\u5f97\uff1a\n$$\\lambda_{\\min}(\\mathbf{F}(\\mathbf{w})) \\geq \\mu &gt; 0, \\quad \\forall \\mathbf{w} \\in \\mathcal{N}(\\mathbf{w}^*)$$\n<strong>\u6761\u4ef6B\uff08Lipschitz\u8fde\u7eed\u6027\uff09</strong>\uff1aFisher\u77e9\u9635\u6ee1\u8db3\uff1a\n$$|\\mathbf{F}(\\mathbf{w}_1) - \\mathbf{F}(\\mathbf{w}_2)| \\leq L_F|\\mathbf{w}_1 - \\mathbf{w}_2|$$\n<strong>\u5b9a\u7406</strong>\uff1a\u5728\u6761\u4ef6A\u548cB\u4e0b\uff0c\u82e5\u521d\u59cb\u70b9$\\mathbf{w}_0$\u8db3\u591f\u63a5\u8fd1$\\mathbf{w}^*$\uff0c\u4e14K-FAC\u8fd1\u4f3c\u8bef\u5dee\u6ee1\u8db3$|\\mathbf{E}| &lt; \\mu/2$\uff0c\u5219\uff1a\n$$|\\mathbf{w}_{k+1} - \\mathbf{w}^*| \\leq \\left(1 - \\frac{\\mu}{2L}\\right)|\\mathbf{w}_k - \\mathbf{w}^*| + O(|\\mathbf{E}|)$$</p>\n<ol start=\"3\">\n<li><strong>\u968f\u673a\u4f18\u5316\u6846\u67b6\u4e0b\u7684\u5206\u6790</strong>\uff1a</li>\n</ol>\n<p>\u5728\u968f\u673a\u5c0f\u6279\u91cf\u8bbe\u7f6e\u4e0b\uff0cK-FAC\u7684\u6536\u655b\u6027\u9700\u8981\u8003\u8651\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u4f30\u8ba1\u7684\u65b9\u5dee\uff1a$\\mathbb{E}[|\\nabla f_i(\\mathbf{w}) - \\nabla f(\\mathbf{w})|^2] \\leq \\sigma^2$</li>\n<li>Kronecker\u56e0\u5b50\u4f30\u8ba1\u7684\u65b9\u5dee\uff1a$\\text{Var}(\\hat{\\mathbf{A}}_t), \\text{Var}(\\hat{\\mathbf{B}}_t)$</li>\n</ul>\n<p><strong>\u6536\u655b\u901f\u7387</strong>\uff1a\u4f7f\u7528\u9012\u51cf\u6b65\u957f$\\eta_t = \\eta_0/\\sqrt{t}$\u65f6\uff1a\n$$\\mathbb{E}[|\\mathbf{w}_T - \\mathbf{w}^*|^2] \\leq O\\left(\\frac{1}{\\sqrt{T}}\\right) + O(\\epsilon_{\\text{approx}})$$\n\u5176\u4e2d$\\epsilon_{\\text{approx}}$\u662fK-FAC\u8fd1\u4f3c\u5f15\u5165\u7684\u504f\u5dee\u3002</p>\n<ol start=\"4\">\n<li><strong>\u4e0e\u4e00\u9636\u65b9\u6cd5\u7684\u6bd4\u8f83</strong>\uff1a</li>\n</ol>\n<p><strong>\u52a0\u901f\u533a\u57df</strong>\uff1a\u5f53Hessian\u7684\u6761\u4ef6\u6570$\\kappa(\\mathbf{H}) \\gg 1$\u65f6\uff0cK-FAC\u76f8\u6bd4SGD\u7684\u52a0\u901f\u6bd4\u7ea6\u4e3a\uff1a\n$$\\frac{T_{\\text{SGD}}}{T_{\\text{K-FAC}}} \\approx \\sqrt{\\kappa(\\mathbf{H})} \\cdot \\frac{1}{1 + \\epsilon_{\\text{rel}}}$$\n\u5176\u4e2d$\\epsilon_{\\text{rel}} = |\\mathbf{E}|/|\\mathbf{F}|$\u662f\u76f8\u5bf9\u8fd1\u4f3c\u8bef\u5dee\u3002</p>\n<p><strong>\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>\u975e\u51f8\u60c5\u51b5\u4e0b\u7684\u5168\u5c40\u6536\u655b\u4fdd\u8bc1</li>\n<li>\u81ea\u9002\u5e94Kronecker\u5206\u89e3\u7684\u7406\u8bba\u5206\u6790</li>\n<li>\u4e0e\u5176\u4ed6\u4e8c\u9636\u65b9\u6cd5\u7684\u7edf\u4e00\u7406\u8bba\u6846\u67b6</li>\n<li>\u5728\u7ebf\u5b66\u4e60\u8bbe\u7f6e\u4e0b\u7684\u9057\u61be\u754c\u5206\u6790</li>\n<li>\u5206\u5e03\u5f0fK-FAC\u7684\u4e00\u81f4\u6027\u4e0e\u6536\u655b\u6027\u6743\u8861</li>\n</ul>\n<h2 id=\"32-blockshampoo\">3.2 Block\u5bf9\u89d2\u8fd1\u4f3c\uff1aShampoo\u7b97\u6cd5\u89e3\u6790</h2>\n<h3 id=\"321\">3.2.1 \u5757\u7ed3\u6784\u7684\u6570\u5b66\u52a8\u673a</h3>\n<p>Shampoo\u7b97\u6cd5\u5c06\u53c2\u6570\u5f20\u91cf\u7684\u4e0d\u540c\u6a21\u5f0f\uff08modes\uff09\u5206\u522b\u9884\u6761\u4ef6\uff0c\u5b9e\u73b0\u4e86\u6bd4K-FAC\u66f4\u7075\u6d3b\u7684\u7ed3\u6784\u5316\u8fd1\u4f3c\u3002\u5bf9\u4e8e\u5f20\u91cf$\\mathcal{W} \\in \\mathbb{R}^{d_1 \\times d_2 \\times \\cdots \\times d_k}$\uff0cShampoo\u7ef4\u62a4$k$\u4e2a\u9884\u6761\u4ef6\u77e9\u9635$\\mathbf{H}_i \\in \\mathbb{R}^{d_i \\times d_i}$\u3002</p>\n<p>\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u9ad8\u9636\u5f20\u91cf\u7684\u9884\u6761\u4ef6\u95ee\u9898\u5206\u89e3\u4e3a\u591a\u4e2a\u4f4e\u7ef4\u77e9\u9635\u7684\u9884\u6761\u4ef6\u95ee\u9898\uff0c\u6bcf\u4e2a\u77e9\u9635\u5bf9\u5e94\u5f20\u91cf\u7684\u4e00\u4e2a\u6a21\u5f0f\u3002</p>\n<p><strong>\u7406\u8bba\u57fa\u7840</strong>\uff1a</p>\n<ol>\n<li><strong>\u5f20\u91cf\u68af\u5ea6\u7684\u534f\u65b9\u5dee\u5206\u89e3</strong>\uff1a</li>\n</ol>\n<p>\u5bf9\u4e8e\u5f20\u91cf\u53c2\u6570$\\mathcal{W}$\uff0c\u5176\u68af\u5ea6$\\mathcal{G}$\u7684\u5b8c\u6574\u534f\u65b9\u5dee\u77e9\u9635\u5927\u5c0f\u4e3a$(\\prod_i d_i)^2$\u3002Shampoo\u5047\u8bbe\u8fd9\u4e2a\u534f\u65b9\u5dee\u53ef\u4ee5\u8fd1\u4f3c\u4e3a\uff1a\n$$\\text{Cov}(\\text{vec}(\\mathcal{G})) \\approx \\mathbf{H}_1 \\otimes \\mathbf{H}_2 \\otimes \\cdots \\otimes \\mathbf{H}_k$$\n\u8fd9\u6bd4K-FAC\u7684\u53cc\u56e0\u5b50\u5206\u89e3\u66f4\u4e00\u822c\u5316\uff0c\u5141\u8bb8\u5904\u7406\u9ad8\u9636\u5f20\u91cf\u3002</p>\n<ol start=\"2\">\n<li><strong>\u6a21\u5f0f\u72ec\u7acb\u6027\u5047\u8bbe</strong>\uff1a</li>\n</ol>\n<p>Shampoo\u9690\u542b\u5047\u8bbe\u4e0d\u540c\u6a21\u5f0f\u4e4b\u95f4\u7684\u7edf\u8ba1\u76f8\u5173\u6027\u53ef\u4ee5\u901a\u8fc7\u5404\u81ea\u7684\u534f\u65b9\u5dee\u77e9\u9635\u5145\u5206\u6355\u83b7\u3002\u6570\u5b66\u4e0a\uff1a\n$$\\mathbb{E}[\\mathcal{G} \\times_i \\mathcal{G}^T] \\approx \\mathbb{E}_i[\\mathcal{G}_{(i)} \\mathcal{G}_{(i)}^T]$$\n\u5176\u4e2d$\\mathcal{G}_{(i)}$\u662f\u5f20\u91cf$\\mathcal{G}$\u6cbf\u7b2c$i$\u4e2a\u6a21\u5f0f\u7684\u5c55\u5f00\u3002</p>\n<ol start=\"3\">\n<li><strong>\u4e0e\u9ece\u66fc\u4f18\u5316\u7684\u8054\u7cfb</strong>\uff1a</li>\n</ol>\n<p>Shampoo\u53ef\u4ee5\u89e3\u91ca\u4e3a\u5728\u4e58\u79ef\u6d41\u5f62$\\mathcal{M} = \\mathbb{R}^{d_1} \\times \\mathbb{R}^{d_2} \\times \\cdots \\times \\mathbb{R}^{d_k}$\u4e0a\u7684\u9ece\u66fc\u4f18\u5316\uff0c\u5176\u4e2d\u6bcf\u4e2a\u56e0\u5b50\u7a7a\u95f4\u914d\u5907\u7531$\\mathbf{H}_i$\u8bf1\u5bfc\u7684\u5ea6\u91cf\uff1a\n$$g_i(\\mathbf{u}, \\mathbf{v}) = \\mathbf{u}^T \\mathbf{H}_i \\mathbf{v}$$\n\u8fd9\u63d0\u4f9b\u4e86Shampoo\u7684\u51e0\u4f55\u89e3\u91ca\uff1a\u5728\u6bcf\u4e2a\u6a21\u5f0f\u7684\u81ea\u7136\u51e0\u4f55\u4e0b\u8fdb\u884c\u6700\u9661\u4e0b\u964d\u3002</p>\n<p><strong>\u4e0e\u5176\u4ed6\u65b9\u6cd5\u7684\u533a\u522b</strong>\uff1a</p>\n<ul>\n<li><strong>K-FAC</strong>\uff1a\u4ec5\u5904\u7406\u77e9\u9635\uff082\u9636\u5f20\u91cf\uff09\uff0c\u4f7f\u7528\u4e24\u4e2aKronecker\u56e0\u5b50</li>\n<li><strong>Shampoo</strong>\uff1a\u53ef\u5904\u7406\u4efb\u610f\u9636\u5f20\u91cf\uff0c\u6bcf\u4e2a\u6a21\u5f0f\u4e00\u4e2a\u56e0\u5b50</li>\n<li><strong>\u5b8c\u6574\u4e8c\u9636\u65b9\u6cd5</strong>\uff1a\u9700\u8981\u5b58\u50a8\u548c\u64cd\u4f5c\u5b8c\u6574\u7684Hessian\u6216Fisher\u77e9\u9635</li>\n</ul>\n<p><strong>\u8ba1\u7b97\u4e0e\u5b58\u50a8\u4f18\u52bf</strong>\uff1a</p>\n<p>\u5bf9\u4e8e$k$\u9636\u5f20\u91cf$\\mathcal{W} \\in \\mathbb{R}^{d_1 \\times \\cdots \\times d_k}$\uff1a</p>\n<ul>\n<li>\u5b8c\u6574\u65b9\u6cd5\uff1a$O((\\prod_i d_i)^2)$\u5b58\u50a8\uff0c$O((\\prod_i d_i)^3)$\u8ba1\u7b97</li>\n<li>Shampoo\uff1a$O(\\sum_i d_i^2)$\u5b58\u50a8\uff0c$O(\\sum_i d_i^3 + k\\prod_i d_i)$\u8ba1\u7b97</li>\n</ul>\n<p>\u5f53$d_i$\u76f8\u8fd1\u4e14$k$\u8f83\u5927\u65f6\uff0cShampoo\u7684\u4f18\u52bf\u5c24\u4e3a\u660e\u663e\u3002</p>\n<h3 id=\"322-shampoo\">3.2.2 Shampoo\u9884\u6761\u4ef6\u7b97\u6cd5</h3>\n<p><strong>\u7b97\u6cd5\u6b65\u9aa4</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u68af\u5ea6\u5f20\u91cf\u5316</strong>\uff1a\u5c06\u68af\u5ea6$\\mathbf{g}$\u91cd\u5851\u4e3a\u4e0e\u53c2\u6570\u76f8\u540c\u7684\u5f20\u91cf\u5f62\u5f0f$\\mathcal{G}$</p>\n</li>\n<li>\n<p><strong>\u6a21\u5f0f\u5c55\u5f00\u4e0e\u7edf\u8ba1\u6536\u96c6</strong>\uff1a\n   \u5bf9\u6bcf\u4e2a\u6a21\u5f0f$i$\uff0c\u8ba1\u7b97\uff1a\n$$\\mathbf{G}_i = \\text{unfold}_i(\\mathcal{G}), \\quad \\mathbf{H}_i \\leftarrow \\beta\\mathbf{H}_i + (1-\\beta)\\mathbf{G}_i\\mathbf{G}_i^T$$</p>\n</li>\n<li>\n<p><strong>\u9884\u6761\u4ef6\u5e94\u7528</strong>\uff1a\n$$\\mathcal{P} = \\mathcal{G} \\times_1 \\mathbf{H}_1^{-1/4} \\times_2 \\mathbf{H}_2^{-1/4} \\cdots \\times_k \\mathbf{H}_k^{-1/4}$$\n\u5176\u4e2d$\\times_i$\u8868\u793a\u6cbf\u7b2c$i$\u4e2a\u6a21\u5f0f\u7684\u5f20\u91cf\u79ef\u3002</p>\n</li>\n<li>\n<p><strong>\u53c2\u6570\u66f4\u65b0</strong>\uff1a\n$$\\mathcal{W} \\leftarrow \\mathcal{W} - \\eta \\mathcal{P}$$\n<strong>\u9ad8\u7ea7\u5b9e\u73b0\u7ec6\u8282</strong>\uff1a</p>\n</li>\n<li>\n<p><strong>\u77e9\u9635\u5e42\u7684\u9ad8\u6548\u8ba1\u7b97</strong>\uff1a</p>\n</li>\n</ol>\n<p>\u8ba1\u7b97$\\mathbf{H}_i^{-1/4}$\u662fShampoo\u7684\u8ba1\u7b97\u74f6\u9888\u3002\u5e38\u7528\u65b9\u6cd5\uff1a</p>\n<p><strong>\u7279\u5f81\u5206\u89e3\u6cd5</strong>\uff1a\n$$\\mathbf{H}_i = \\mathbf{U}_i\\mathbf{\\Lambda}_i\\mathbf{U}_i^T \\Rightarrow \\mathbf{H}_i^{-1/4} = \\mathbf{U}_i\\mathbf{\\Lambda}_i^{-1/4}\\mathbf{U}_i^T$$\n<strong>Newton-Schulz\u8fed\u4ee3</strong>\uff1a\n$$\\mathbf{X}_{k+1} = \\frac{1}{2}\\mathbf{X}_k(3\\mathbf{I} - \\mathbf{X}_k^4\\mathbf{H}_i), \\quad \\mathbf{X}_0 = \\frac{\\mathbf{I}}{|\\mathbf{H}_i|^{1/4}}$$\n\u6536\u655b\u5230$\\mathbf{H}_i^{-1/4}$\uff0c\u9002\u5408GPU\u5e76\u884c\u8ba1\u7b97\u3002</p>\n<p><strong>\u968f\u673a\u8fd1\u4f3c</strong>\uff1a\n   \u4f7f\u7528\u968f\u673aSVD\u6216Nystr\u00f6m\u65b9\u6cd5\u8fd1\u4f3c\u4e3b\u8981\u7279\u5f81\u7a7a\u95f4\uff1a\n$$\\mathbf{H}_i^{-1/4} \\approx \\mathbf{V}_r\\mathbf{\\Lambda}_r^{-1/4}\\mathbf{V}_r^T + \\epsilon^{-1/4}(\\mathbf{I} - \\mathbf{V}_r\\mathbf{V}_r^T)$$</p>\n<ol start=\"2\">\n<li><strong>\u81ea\u9002\u5e94\u9884\u6761\u4ef6\u5f3a\u5ea6</strong>\uff1a</li>\n</ol>\n<p>\u4e0d\u540c\u6a21\u5f0f\u53ef\u80fd\u9700\u8981\u4e0d\u540c\u7684\u9884\u6761\u4ef6\u5f3a\u5ea6\u3002\u5f15\u5165\u6a21\u5f0f\u7279\u5b9a\u7684\u6307\u6570$p_i$\uff1a\n$$\\mathcal{P} = \\mathcal{G} \\times_1 \\mathbf{H}_1^{-p_1} \\times_2 \\mathbf{H}_2^{-p_2} \\cdots$$\n\u5176\u4e2d$p_i$\u53ef\u4ee5\u57fa\u4e8e\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u4fe1\u566a\u6bd4\uff1a$p_i \\propto |\\mathbf{G}_i|_F/\\text{tr}(\\mathbf{H}_i)$</li>\n<li>\u6709\u6548\u79e9\uff1a$p_i \\propto \\text{tr}(\\mathbf{H}_i)/|\\mathbf{H}_i|_2$</li>\n<li>\u5b66\u4e60\u7387\u9002\u5e94\uff1a\u901a\u8fc7\u7ebf\u641c\u7d22\u6216trust region\u8c03\u6574</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5206\u5757\u7b56\u7565</strong>\uff1a</li>\n</ol>\n<p>\u5bf9\u4e8e\u8d85\u5927\u7ef4\u5ea6$d_i$\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5206\u5757\uff1a\n$$\\mathbf{H}_i = \\begin{pmatrix}\n   \\mathbf{H}_{i,1} &amp; &amp; \\\n   &amp; \\ddots &amp; \\\n   &amp; &amp; \\mathbf{H}_{i,B}\n   \\end{pmatrix}$$\n\u8fd9\u727a\u7272\u4e86\u4e00\u4e9b\u6a21\u5f0f\u5185\u7684\u76f8\u5173\u6027\uff0c\u4f46\u5927\u5e45\u964d\u4f4e\u4e86\u8ba1\u7b97\u6210\u672c\u3002</p>\n<ol start=\"4\">\n<li><strong>\u52a8\u91cf\u4e0eShampoo\u7684\u7ed3\u5408</strong>\uff1a</li>\n</ol>\n<p><strong>\u9884\u6761\u4ef6\u52a8\u91cf\uff08PM-Shampoo\uff09</strong>\uff1a\n$$\\mathbf{m}_{t+1} = \\beta_1\\mathbf{m}_t + (1-\\beta_1)\\text{vec}(\\mathcal{G}_t)$$\n   $$\\mathcal{P}_t = \\text{reshape}(\\mathbf{m}_{t+1}) \\times_1 \\mathbf{H}_{1,t}^{-1/4} \\times_2 \\cdots$$\n<strong>\u540e\u6761\u4ef6\u52a8\u91cf\uff08AM-Shampoo\uff09</strong>\uff1a\n$$\\mathcal{P}_t = \\mathcal{G}_t \\times_1 \\mathbf{H}_{1,t}^{-1/4} \\times_2 \\cdots$$\n   $$\\mathbf{v}_{t+1} = \\beta_1\\mathbf{v}_t + (1-\\beta_1)\\text{vec}(\\mathcal{P}_t)$$\n<strong>\u6570\u503c\u7a33\u5b9a\u6027\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u63a7\u5236</strong>\uff1a\n$$\\tilde{\\mathbf{H}}_i = \\mathbf{H}_i + \\lambda_i\\mathbf{I}, \\quad \\lambda_i = \\max(\\epsilon, \\alpha\\cdot\\text{median}(\\text{diag}(\\mathbf{H}_i)))$$</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u88c1\u526a\u96c6\u6210</strong>\uff1a\n   \u5728\u9884\u6761\u4ef6\u524d\u540e\u90fd\u53ef\u4ee5\u5e94\u7528\u68af\u5ea6\u88c1\u526a\uff1a\n$$\\tilde{\\mathcal{G}} = \\begin{cases}\n   \\mathcal{G}, &amp; |\\mathcal{G}|_F \\leq c \\\n   c\\cdot\\mathcal{G}/|\\mathcal{G}|_F, &amp; \\text{otherwise}\n   \\end{cases}$$</p>\n</li>\n<li>\n<p><strong>\u5f02\u5e38\u68c0\u6d4b\u4e0e\u6062\u590d</strong>\uff1a\n   \u76d1\u63a7\u9884\u6761\u4ef6\u540e\u7684\u66f4\u65b0\u8303\u6570\uff0c\u5f02\u5e38\u65f6\u56de\u9000\u5230\u4e00\u9636\u66f4\u65b0\uff1a\n$$\\mathcal{P} = \\begin{cases}\n   \\mathcal{P}_{\\text{Shampoo}}, &amp; |\\mathcal{P}_{\\text{Shampoo}}|_F \\leq \\tau|\\mathcal{G}|_F \\\n   \\mathcal{G}, &amp; \\text{otherwise}\n   \\end{cases}$$</p>\n</li>\n</ol>\n<h3 id=\"323\">3.2.3 \u8ba1\u7b97\u590d\u6742\u5ea6\u5206\u6790</h3>\n<p><strong>\u5b58\u50a8\u590d\u6742\u5ea6</strong>\uff1a</p>\n<ul>\n<li>\u6807\u51c6\u5168\u77e9\u9635\u9884\u6761\u4ef6\uff1a$O((\\prod_i d_i)^2)$</li>\n<li>Shampoo\uff1a$O(\\sum_i d_i^2)$</li>\n</ul>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6</strong>\uff08\u6bcf\u6b21\u8fed\u4ee3\uff09\uff1a</p>\n<ul>\n<li>\u77e9\u9635\u6c42\u9006\uff1a$O(\\sum_i d_i^3)$</li>\n<li>\u5f20\u91cf\u6536\u7f29\uff1a$O(k \\prod_i d_i)$</li>\n</ul>\n<p>\u901a\u8fc7\u4f7f\u7528\u77e9\u9635\u51fd\u6570\u7684\u4f4e\u79e9\u8fd1\u4f3c\uff08\u5982Lanczos\u65b9\u6cd5\u8ba1\u7b97$\\mathbf{H}^{-1/4}$\uff09\uff0c\u53ef\u8fdb\u4e00\u6b65\u964d\u4f4e\u8ba1\u7b97\u6210\u672c\u3002</p>\n<h3 id=\"324-shampoo\">3.2.4 \u5206\u5e03\u5f0fShampoo\u5b9e\u73b0</h3>\n<p>\u5728\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u8bad\u7ec3\u4e2d\uff0cShampoo\u7684\u5b9e\u73b0\u9762\u4e34\u72ec\u7279\u6311\u6218\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9884\u6761\u4ef6\u77e9\u9635\u7684\u5206\u7247\u5b58\u50a8</strong>\uff1a\n   - \u4f7f\u7528\u5206\u5e03\u5f0f\u77e9\u9635\u5206\u89e3\u6280\u672f\n   - \u6bcf\u4e2a\u8282\u70b9\u8d1f\u8d23\u90e8\u5206\u6a21\u5f0f\u7684\u9884\u6761\u4ef6</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u4f18\u5316</strong>\uff1a\n   - \u68af\u5ea6\u805a\u5408\u4e0e\u9884\u6761\u4ef6\u8ba1\u7b97\u7684\u6d41\u6c34\u7ebf\u5316\n   - \u4f7f\u7528\u68af\u5ea6\u538b\u7f29\u6280\u672f\u51cf\u5c11\u901a\u4fe1\u91cf</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0\u7b56\u7565</strong>\uff1a\n   - \u5141\u8bb8\u4e0d\u540c\u6a21\u5f0f\u7684\u9884\u6761\u4ef6\u77e9\u9635\u5f02\u6b65\u66f4\u65b0\n   - \u4f7f\u7528\u7248\u672c\u63a7\u5236\u786e\u4fdd\u4e00\u81f4\u6027</p>\n</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u5757\u5927\u5c0f\u9009\u62e9</li>\n<li>\u7a00\u758fShampoo\u53d8\u4f53</li>\n<li>\u4e0e\u91cf\u5316\u6280\u672f\u7684\u7ed3\u5408</li>\n</ul>\n<h2 id=\"33\">3.3 \u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784\u7684\u5229\u7528</h2>\n<h3 id=\"331-woodbury\">3.3.1 Woodbury\u6052\u7b49\u5f0f\u7684\u6838\u5fc3\u4f5c\u7528</h3>\n<p>\u5bf9\u4e8e\u5f62\u5982$\\mathbf{H} = \\mathbf{D} + \\mathbf{U}\\mathbf{V}^T$\u7684\u77e9\u9635\uff0c\u5176\u4e2d$\\mathbf{D}$\u662f\u5bf9\u89d2\u9635\uff0c$\\mathbf{U}, \\mathbf{V} \\in \\mathbb{R}^{n \\times r}$\u4e14$r \\ll n$\uff0cWoodbury\u6052\u7b49\u5f0f\u7ed9\u51fa\uff1a\n$$\\mathbf{H}^{-1} = \\mathbf{D}^{-1} - \\mathbf{D}^{-1}\\mathbf{U}(\\mathbf{I}_r + \\mathbf{V}^T\\mathbf{D}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{D}^{-1}$$\n\u8fd9\u5c06$O(n^3)$\u7684\u6c42\u9006\u964d\u81f3$O(nr^2 + r^3)$\u3002</p>\n<h3 id=\"332\">3.3.2 \u5185\u5b58\u9ad8\u6548\u7684\u5b9e\u73b0\u7b56\u7565</h3>\n<p><strong>\u589e\u91cf\u79e9\u66f4\u65b0</strong>\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\uff1a$\\mathbf{H}_0 = \\mathbf{D}_0$\uff08\u5bf9\u89d2\u77e9\u9635\uff09</li>\n<li>\u79e9\u4e00\u66f4\u65b0\uff1a$\\mathbf{H}_{t+1} = \\mathbf{H}_t + \\mathbf{u}_t\\mathbf{v}_t^T$</li>\n<li>\u7ef4\u62a4\u7d27\u51d1\u8868\u793a\uff1a$\\mathbf{U}_t = [\\mathbf{u}_1, \\ldots, \\mathbf{u}_t]$, $\\mathbf{V}_t = [\\mathbf{v}_1, \\ldots, \\mathbf{v}_t]$</li>\n</ol>\n<p><strong>\u5185\u5b58\u7ba1\u7406</strong>\uff1a</p>\n<ul>\n<li>\u56fa\u5b9a\u79e9\u7a97\u53e3\uff1a\u4fdd\u6301\u6700\u8fd1$r$\u4e2a\u79e9\u4e00\u66f4\u65b0</li>\n<li>\u57fa\u4e8e\u91cd\u8981\u6027\u7684\u9009\u62e9\uff1a\u4f7f\u7528\u5947\u5f02\u503c\u9608\u503c</li>\n<li>\u5468\u671f\u6027\u91cd\u6784\uff1a\u5b9a\u671f\u5438\u6536\u4f4e\u79e9\u90e8\u5206\u5230\u5bf9\u89d2\u90e8\u5206</li>\n</ul>\n<h3 id=\"333\">3.3.3 \u81ea\u9002\u5e94\u79e9\u9009\u62e9</h3>\n<p>\u52a8\u6001\u8c03\u6574\u4f4e\u79e9\u8fd1\u4f3c\u7684\u79e9$r$\u662f\u5b9e\u73b0\u8ba1\u7b97\u6548\u7387\u4e0e\u8fd1\u4f3c\u7cbe\u5ea6\u5e73\u8861\u7684\u5173\u952e\uff1a</p>\n<p><strong>\u8c31\u5206\u6790\u65b9\u6cd5</strong>\uff1a\n\u76d1\u63a7\u8fd1\u4f3c\u8bef\u5dee\uff1a\n$$\\epsilon_r = \\frac{\\sum_{i=r+1}^n \\sigma_i^2}{\\sum_{i=1}^n \\sigma_i^2}$$\n\u5f53$\\epsilon_r &lt; \\tau$\u65f6\uff0c\u8ba4\u4e3a\u79e9$r$\u8db3\u591f\u3002</p>\n<p><strong>\u57fa\u4e8e\u68af\u5ea6\u7684\u65b9\u6cd5</strong>\uff1a\n\u4f7f\u7528\u68af\u5ea6\u4fe1\u606f\u81ea\u9002\u5e94\u8c03\u6574\uff1a\n$$r_{t+1} = \\begin{cases}\nr_t + 1, &amp; \\text{if } |\\mathbf{g}_t - \\mathbf{H}_t^{-1}\\mathbf{g}_t|/|\\mathbf{g}_t| &gt; \\delta \\\nr_t - 1, &amp; \\text{if } |\\mathbf{g}_t - \\mathbf{H}_t^{-1}\\mathbf{g}_t|/|\\mathbf{g}_t| &lt; \\delta/2 \\\nr_t, &amp; \\text{otherwise}\n\\end{cases}$$</p>\n<h3 id=\"334\">3.3.4 \u4e0e\u8c31\u5206\u6790\u7684\u8054\u7cfb</h3>\n<p>\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784\u4e0e\u77e9\u9635\u7684\u8c31\u5206\u89e3\u6709\u6df1\u523b\u8054\u7cfb\u3002\u8003\u8651\u8c31\u5206\u89e3\uff1a\n$$\\mathbf{H} = \\sum_{i=1}^n \\lambda_i \\mathbf{u}_i \\mathbf{u}_i^T$$\n\u4f4e\u79e9\u52a0\u5bf9\u89d2\u8fd1\u4f3c\u53ef\u89c6\u4e3a\uff1a\n$$\\mathbf{H} \\approx \\sum_{i=1}^r \\lambda_i \\mathbf{u}_i \\mathbf{u}_i^T + \\bar{\\lambda} \\sum_{i=r+1}^n \\mathbf{u}_i \\mathbf{u}_i^T$$\n\u5176\u4e2d$\\bar{\\lambda}$\u662f\u5c3e\u90e8\u7279\u5f81\u503c\u7684\u4ee3\u8868\u503c\uff08\u5982\u5e73\u5747\u503c\u6216\u4e2d\u4f4d\u6570\uff09\u3002</p>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u5728\u7ebf\u8c31\u5206\u89e3\u7b97\u6cd5</li>\n<li>\u968f\u673a\u5316\u4f4e\u79e9\u8fd1\u4f3c</li>\n<li>\u4e0e\u795e\u7ecf\u7f51\u7edc\u526a\u679d\u7684\u7406\u8bba\u8054\u7cfb</li>\n</ul>\n<h2 id=\"34-hessian\">3.4 \u7a00\u758fHessian\u6a21\u5f0f\u7684\u81ea\u52a8\u53d1\u73b0</h2>\n<h3 id=\"341\">3.4.1 \u57fa\u4e8e\u56fe\u7684\u7a00\u758f\u6027\u68c0\u6d4b</h3>\n<p>\u795e\u7ecf\u7f51\u7edc\u7684\u8ba1\u7b97\u56fe\u7ed3\u6784\u5929\u7136\u8bf1\u5bfc\u51faHessian\u7684\u7a00\u758f\u6a21\u5f0f\u3002\u5173\u952e\u89c2\u5bdf\u662f\uff1a\u5982\u679c\u53c2\u6570$w_i$\u548c$w_j$\u5728\u8ba1\u7b97\u56fe\u4e2d\u6ca1\u6709\u5171\u540c\u5f71\u54cd\u4efb\u4f55\u8f93\u51fa\uff0c\u5219$\\frac{\\partial^2 \\mathcal{L}}{\\partial w_i \\partial w_j} = 0$\u3002</p>\n<p><strong>\u7a00\u758f\u6a21\u5f0f\u53d1\u73b0\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6784\u5efa\u5f71\u54cd\u56fe</strong>\uff1a\n   - \u8282\u70b9\uff1a\u53c2\u6570\n   - \u8fb9\uff1a\u82e5\u4e24\u53c2\u6570\u5171\u540c\u5f71\u54cd\u67d0\u8f93\u51fa\uff0c\u5219\u8fde\u8fb9</p>\n</li>\n<li>\n<p><strong>\u56fe\u7740\u8272\u95ee\u9898</strong>\uff1a\n   - \u4f7f\u7528\u56fe\u7740\u8272\u7b97\u6cd5\u786e\u5b9aHessian-vector\u4e58\u79ef\u7684\u8ba1\u7b97\u7ec4\n   - \u6700\u5c0f\u5316\u6240\u9700\u7684\u524d\u5411-\u53cd\u5411\u4f20\u64ad\u6b21\u6570</p>\n</li>\n<li>\n<p><strong>\u6a21\u5f0f\u538b\u7f29</strong>\uff1a\n   - \u8bc6\u522b\u91cd\u590d\u7684\u7a00\u758f\u6a21\u5f0f\n   - \u4f7f\u7528\u6a21\u677f\u5339\u914d\u51cf\u5c11\u5b58\u50a8</p>\n</li>\n</ol>\n<h3 id=\"342\">3.4.2 \u52a8\u6001\u6a21\u5f0f\u9002\u5e94</h3>\n<p>\u8bad\u7ec3\u8fc7\u7a0b\u4e2dHessian\u7684\u7a00\u758f\u6a21\u5f0f\u53ef\u80fd\u53d8\u5316\uff0c\u9700\u8981\u52a8\u6001\u9002\u5e94\u673a\u5236\uff1a</p>\n<p><strong>\u81ea\u9002\u5e94\u9608\u503c\u7b56\u7565</strong>\uff1a\n$$\\mathbf{H}_{ij} = \\begin{cases}\n\\mathbf{H}_{ij}, &amp; \\text{if } |\\mathbf{H}_{ij}| &gt; \\tau_t \\\n0, &amp; \\text{otherwise}\n\\end{cases}$$\n\u5176\u4e2d$\\tau_t$\u6839\u636e\u4ee5\u4e0b\u51c6\u5219\u52a8\u6001\u8c03\u6574\uff1a</p>\n<ul>\n<li>\u4fdd\u6301\u56fa\u5b9a\u7a00\u758f\u5ea6\uff1a$|\\mathbf{H}|_0 = k$</li>\n<li>\u57fa\u4e8e\u8bef\u5dee\u7684\u8c03\u6574\uff1a$\\tau_{t+1} = \\tau_t \\cdot (1 + \\alpha \\cdot \\text{approx_error})$</li>\n</ul>\n<p><strong>\u6a21\u5f0f\u8fc1\u79fb\u5b66\u4e60</strong>\uff1a</p>\n<ul>\n<li>\u4ece\u9884\u8bad\u7ec3\u6a21\u578b\u7ee7\u627f\u7a00\u758f\u6a21\u5f0f</li>\n<li>\u9010\u6b65\u7cbe\u70bc\u4ee5\u9002\u5e94\u7279\u5b9a\u4efb\u52a1</li>\n</ul>\n<h3 id=\"343\">3.4.3 \u7a00\u758f\u56e0\u5b50\u5206\u89e3\u6280\u672f</h3>\n<p>\u5bf9\u4e8e\u53d1\u73b0\u7684\u7a00\u758f\u6a21\u5f0f\uff0c\u9009\u62e9\u5408\u9002\u7684\u56e0\u5b50\u5206\u89e3\u81f3\u5173\u91cd\u8981\uff1a</p>\n<p><strong>Cholesky\u5206\u89e3\u7684\u7a00\u758f\u53d8\u4f53</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u6700\u5c0f\u5ea6\u6392\u5e8f\u51cf\u5c11\u586b\u5145</li>\n<li>\u7b26\u53f7\u5206\u89e3\u9884\u8ba1\u7b97\u975e\u96f6\u6a21\u5f0f</li>\n<li>\u6570\u503c\u5206\u89e3\u7684\u5e76\u884c\u5316</li>\n</ul>\n<p><strong>\u4e0d\u5b8c\u5168LU\u5206\u89e3\uff08ILU\uff09</strong>\uff1a</p>\n<ul>\n<li>\u63a7\u5236\u586b\u5145\u7ea7\u522bILU(k)</li>\n<li>\u81ea\u9002\u5e94\u9009\u62e9\u4e22\u5f03\u9608\u503c</li>\n<li>\u4e0e\u9884\u6761\u4ef6\u5171\u8f6d\u68af\u5ea6\u6cd5\u7ed3\u5408</li>\n</ul>\n<p><strong>\u591a\u7ea7\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u6784\u5efa\u7a00\u758f\u77e9\u9635\u7684\u5c42\u6b21\u8868\u793a</li>\n<li>\u4f7f\u7528\u4ee3\u6570\u591a\u91cd\u7f51\u683c\uff08AMG\uff09\u6280\u672f</li>\n<li>\u5728\u4e0d\u540c\u5c3a\u5ea6\u4e0a\u6c42\u89e3</li>\n</ul>\n<h3 id=\"344\">3.4.4 \u5728\u795e\u7ecf\u67b6\u6784\u4e2d\u7684\u5e94\u7528</h3>\n<p><strong>\u5377\u79ef\u7f51\u7edc</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528\u6743\u91cd\u5171\u4eab\u5bfc\u81f4\u7684\u5757\u7a00\u758f\u7ed3\u6784</li>\n<li>\u901a\u9053\u95f4\u7a00\u758f\u6027\u7684\u81ea\u52a8\u53d1\u73b0</li>\n<li>\u4e0e\u7f51\u7edc\u526a\u679d\u7684\u534f\u540c\u4f18\u5316</li>\n</ul>\n<p><strong>Transformer\u67b6\u6784</strong>\uff1a</p>\n<ul>\n<li>\u6ce8\u610f\u529b\u673a\u5236\u7684\u7a00\u758f\u6a21\u5f0f</li>\n<li>\u591a\u5934\u7ed3\u6784\u7684\u5757\u5bf9\u89d2\u6027\u8d28</li>\n<li>\u957f\u5e8f\u5217\u7684\u5206\u5757\u5904\u7406\u7b56\u7565</li>\n</ul>\n<p><strong>\u56fe\u795e\u7ecf\u7f51\u7edc</strong>\uff1a</p>\n<ul>\n<li>\u90bb\u63a5\u77e9\u9635\u8bf1\u5bfc\u7684\u7a00\u758f\u6027</li>\n<li>\u6d88\u606f\u4f20\u9012\u7684\u5c40\u90e8\u6027</li>\n<li>\u5206\u5c42\u56fe\u7ed3\u6784\u7684\u5229\u7528</li>\n</ul>\n<p><strong>\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>\u7a00\u758f\u6a21\u5f0f\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u4e0e\u7f51\u7edc\u67b6\u6784\u641c\u7d22\uff08NAS\uff09\u7684\u7ed3\u5408</li>\n<li>\u786c\u4ef6\u53cb\u597d\u7684\u7a00\u758f\u683c\u5f0f\u8bbe\u8ba1</li>\n</ul>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u56db\u79cd\u4e3b\u8981\u7684\u7ed3\u6784\u5316\u4e8c\u9636\u4f18\u5316\u65b9\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>Kronecker\u56e0\u5b50\u5206\u89e3\uff08K-FAC\uff09</strong>\uff1a\u901a\u8fc7\u5047\u8bbeFisher\u4fe1\u606f\u77e9\u9635\u53ef\u5206\u89e3\u4e3aKronecker\u79ef\uff0c\u5c06\u5b58\u50a8\u548c\u8ba1\u7b97\u590d\u6742\u5ea6\u5927\u5e45\u964d\u4f4e\u3002\u5173\u952e\u516c\u5f0f\uff1a$\\mathbf{F}_l \\approx \\mathbf{A}_l \\otimes \\mathbf{B}_l$</p>\n</li>\n<li>\n<p><strong>Block\u5bf9\u89d2\u8fd1\u4f3c\uff08Shampoo\uff09</strong>\uff1a\u5c06\u9ad8\u7ef4\u5f20\u91cf\u53c2\u6570\u7684\u9884\u6761\u4ef6\u95ee\u9898\u5206\u89e3\u4e3a\u591a\u4e2a\u4f4e\u7ef4\u95ee\u9898\uff0c\u5b9e\u73b0\u4e86\u7075\u6d3b\u7684\u7ed3\u6784\u5316\u8fd1\u4f3c\u3002\u6838\u5fc3\u64cd\u4f5c\uff1a$\\mathcal{P} = \\mathcal{G} \\times_1 \\mathbf{H}_1^{-1/4} \\times_2 \\mathbf{H}_2^{-1/4} \\cdots$</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784</strong>\uff1a\u5229\u7528Woodbury\u6052\u7b49\u5f0f\u9ad8\u6548\u5904\u7406$\\mathbf{H} = \\mathbf{D} + \\mathbf{U}\\mathbf{V}^T$\u5f62\u5f0f\u7684\u77e9\u9635\uff0c\u5b9e\u73b0\u5185\u5b58\u548c\u8ba1\u7b97\u7684\u53cc\u91cd\u4f18\u5316\u3002</p>\n</li>\n<li>\n<p><strong>\u7a00\u758fHessian\u6a21\u5f0f</strong>\uff1a\u901a\u8fc7\u8ba1\u7b97\u56fe\u5206\u6790\u81ea\u52a8\u53d1\u73b0\u7a00\u758f\u7ed3\u6784\uff0c\u5e76\u4f7f\u7528\u4e13\u95e8\u7684\u7a00\u758f\u7ebf\u6027\u4ee3\u6570\u6280\u672f\u52a0\u901f\u8ba1\u7b97\u3002</p>\n</li>\n</ol>\n<p>\u8fd9\u4e9b\u65b9\u6cd5\u7684\u5171\u540c\u7279\u70b9\u662f\u5728\u4fdd\u6301\u4e8c\u9636\u4fe1\u606f\u4e3b\u8981\u7279\u5f81\u7684\u540c\u65f6\uff0c\u5927\u5e45\u964d\u4f4e\u8ba1\u7b97\u548c\u5b58\u50a8\u5f00\u9500\uff0c\u4f7f\u5f97\u4e8c\u9636\u4f18\u5316\u5728\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\u53d8\u5f97\u53ef\u884c\u3002</p>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"31\">\u7ec3\u4e603.1\uff08\u57fa\u7840\uff09</h3>\n<p>\u8bc1\u660e\u5bf9\u4e8eKronecker\u79ef$\\mathbf{A} \\otimes \\mathbf{B}$\uff0c\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a\n(a) $(\\mathbf{A} \\otimes \\mathbf{B})^T = \\mathbf{A}^T \\otimes \\mathbf{B}^T$\n(b) $(\\mathbf{A} \\otimes \\mathbf{B})(\\mathbf{C} \\otimes \\mathbf{D}) = \\mathbf{AC} \\otimes \\mathbf{BD}$\uff08\u5f53\u7ef4\u5ea6\u5339\u914d\u65f6\uff09</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u4f7f\u7528Kronecker\u79ef\u7684\u5b9a\u4e49\uff0c\u9010\u5143\u7d20\u9a8c\u8bc1\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) \u8bbe$\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$\uff0c$\\mathbf{B} \\in \\mathbb{R}^{p \\times q}$\u3002\nKronecker\u79ef\u7684\u7b2c$(i,j)$\u5757\u4e3a$a_{ij}\\mathbf{B}$\u3002\n\u8f6c\u7f6e\u540e\u7b2c$(j,i)$\u5757\u4e3a$(a_{ij}\\mathbf{B})^T = a_{ij}\\mathbf{B}^T = a_{ji}^T\\mathbf{B}^T$\u3002\n\u8fd9\u6b63\u662f$\\mathbf{A}^T \\otimes \\mathbf{B}^T$\u7684\u5b9a\u4e49\u3002</p>\n<p>(b) \u5229\u7528\u5206\u5757\u77e9\u9635\u4e58\u6cd5\uff0c\n$(\\mathbf{A} \\otimes \\mathbf{B})$\u7684\u7b2c$(i,j)$\u5757\u4e3a$a_{ij}\\mathbf{B}$\uff0c\n$(\\mathbf{C} \\otimes \\mathbf{D})$\u7684\u7b2c$(k,l)$\u5757\u4e3a$c_{kl}\\mathbf{D}$\u3002\n\u4e58\u79ef\u7684\u7b2c$(i,l)$\u5757\u4e3a$\\sum_k a_{ik}c_{kl}\\mathbf{BD} = (\\mathbf{AC})_{il}\\mathbf{BD}$\u3002</p>\n</details>\n<h3 id=\"32\">\u7ec3\u4e603.2\uff08\u57fa\u7840\uff09</h3>\n<p>\u5bf9\u4e8eShampoo\u7b97\u6cd5\u4e2d\u7684\u5f20\u91cf$\\mathcal{W} \\in \\mathbb{R}^{d_1 \\times d_2 \\times d_3}$\uff0c\u82e5\u6bcf\u4e2a\u6a21\u5f0f\u7684\u9884\u6761\u4ef6\u77e9\u9635\u4e3a$\\mathbf{H}_i \\in \\mathbb{R}^{d_i \\times d_i}$\uff0c\u8ba1\u7b97\uff1a\n(a) \u5b58\u50a8\u6240\u6709\u9884\u6761\u4ef6\u77e9\u9635\u6240\u9700\u7684\u5185\u5b58\n(b) \u4e0e\u5b58\u50a8\u5b8c\u6574\u7684$\\text{vec}(\\mathcal{W})$\u7684\u534f\u65b9\u5dee\u77e9\u9635\u76f8\u6bd4\uff0c\u5185\u5b58\u8282\u7701\u4e86\u591a\u5c11\uff1f</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u5b8c\u6574\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5927\u5c0f\u4e3a$(d_1d_2d_3)^2$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>(a) Shampoo\u5b58\u50a8\u9700\u6c42\uff1a$d_1^2 + d_2^2 + d_3^2$</p>\n<p>(b) \u5b8c\u6574\u534f\u65b9\u5dee\u77e9\u9635\u9700\u6c42\uff1a$(d_1d_2d_3)^2$</p>\n<p>\u5185\u5b58\u8282\u7701\u6bd4\u4f8b\uff1a\n$$\\frac{(d_1d_2d_3)^2 - (d_1^2 + d_2^2 + d_3^2)}{(d_1d_2d_3)^2} = 1 - \\frac{d_1^2 + d_2^2 + d_3^2}{(d_1d_2d_3)^2}$$\n\u4f8b\u5982\uff0c\u5f53$d_1 = d_2 = d_3 = 100$\u65f6\uff0c\u8282\u7701\u6bd4\u4f8b\u7ea6\u4e3a$99.97\\%$\u3002</p>\n</details>\n<h3 id=\"33_1\">\u7ec3\u4e603.3\uff08\u57fa\u7840\uff09</h3>\n<p>\u4f7f\u7528Woodbury\u6052\u7b49\u5f0f\u8ba1\u7b97\u4ee5\u4e0b\u77e9\u9635\u7684\u9006\uff1a\n$$\\mathbf{H} = \\mathbf{I} + \\mathbf{u}\\mathbf{v}^T$$\n\u5176\u4e2d$\\mathbf{u}, \\mathbf{v} \\in \\mathbb{R}^n$\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8fd9\u662f\u79e9\u4e00\u66f4\u65b0\u7684\u7279\u6b8a\u60c5\u51b5\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5e94\u7528Woodbury\u6052\u7b49\u5f0f\uff0c\u5176\u4e2d$\\mathbf{D} = \\mathbf{I}$\uff0c$\\mathbf{U} = \\mathbf{u}$\uff0c$\\mathbf{V} = \\mathbf{v}$\uff1a\n$$\\mathbf{H}^{-1} = \\mathbf{I} - \\frac{\\mathbf{u}\\mathbf{v}^T}{1 + \\mathbf{v}^T\\mathbf{u}}$$\n\u9a8c\u8bc1\uff1a\n$$\\mathbf{H}\\mathbf{H}^{-1} = (\\mathbf{I} + \\mathbf{u}\\mathbf{v}^T)(\\mathbf{I} - \\frac{\\mathbf{u}\\mathbf{v}^T}{1 + \\mathbf{v}^T\\mathbf{u}})$$\n$$= \\mathbf{I} + \\mathbf{u}\\mathbf{v}^T - \\frac{\\mathbf{u}\\mathbf{v}^T}{1 + \\mathbf{v}^T\\mathbf{u}} - \\frac{\\mathbf{u}\\mathbf{v}^T\\mathbf{u}\\mathbf{v}^T}{1 + \\mathbf{v}^T\\mathbf{u}}$$\n$$= \\mathbf{I} + \\mathbf{u}\\mathbf{v}^T - \\frac{\\mathbf{u}\\mathbf{v}^T(1 + \\mathbf{v}^T\\mathbf{u})}{1 + \\mathbf{v}^T\\mathbf{u}} = \\mathbf{I}$$</p>\n</details>\n<h3 id=\"34\">\u7ec3\u4e603.4\uff08\u6311\u6218\uff09</h3>\n<p>\u8003\u8651K-FAC\u8fd1\u4f3c$\\mathbf{F} \\approx \\mathbf{A} \\otimes \\mathbf{B}$\uff0c\u5176\u4e2d\u771f\u5b9e\u7684Fisher\u77e9\u9635\u4e3a$\\mathbf{F} = \\mathbb{E}[\\text{vec}(\\mathbf{g})\\text{vec}(\\mathbf{g})^T]$\uff0c$\\mathbf{g} = \\nabla_{\\mathbf{W}}\\mathcal{L}$\u3002\u63a8\u5bfcK-FAC\u8fd1\u4f3c\u7684\u6700\u4f18\u6027\u6761\u4ef6\uff0c\u5373\u627e\u5230\u4f7f\u5f97$|\\mathbf{F} - \\mathbf{A} \\otimes \\mathbf{B}|_F$\u6700\u5c0f\u7684$\\mathbf{A}$\u548c$\\mathbf{B}$\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u77e9\u9635\u5f62\u5f0f\uff0c\u5229\u7528\u8ff9\u7684\u6027\u8d28\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe$\\mathbf{G} = \\text{mat}(\\mathbf{g})$\u4e3a\u68af\u5ea6\u7684\u77e9\u9635\u5f62\u5f0f\uff0c\u5219\uff1a\n$$\\mathbf{F} = \\mathbb{E}[\\text{vec}(\\mathbf{G})\\text{vec}(\\mathbf{G})^T]$$\n\u6700\u4f18\u5316\u95ee\u9898\uff1a\n$$\\min_{\\mathbf{A},\\mathbf{B}} |\\mathbf{F} - \\mathbf{A} \\otimes \\mathbf{B}|_F^2$$\n\u5229\u7528Kronecker\u79ef\u7684\u6027\u8d28\u548c\u8ff9\u7684\u5faa\u73af\u6027\u8d28\uff0c\u53ef\u4ee5\u8bc1\u660e\u6700\u4f18\u89e3\u4e3a\uff1a\n$$\\mathbf{B} = \\mathbb{E}[\\mathbf{G}^T\\mathbf{A}^{-1}\\mathbf{G}] / \\text{tr}(\\mathbf{A}^{-1})$$\n$$\\mathbf{A} = \\mathbb{E}[\\mathbf{G}\\mathbf{B}^{-1}\\mathbf{G}^T] / \\text{tr}(\\mathbf{B}^{-1})$$\n\u8fd9\u5bfc\u51fa\u4e86K-FAC\u4e2d\u4f7f\u7528\u7684\u8fd1\u4f3c\uff1a\n$$\\mathbf{A} \\approx \\mathbb{E}[\\mathbf{g}_{\\text{out}}\\mathbf{g}_{\\text{out}}^T], \\quad \\mathbf{B} \\approx \\mathbb{E}[\\mathbf{a}_{\\text{in}}\\mathbf{a}_{\\text{in}}^T]$$</p>\n</details>\n<h3 id=\"35\">\u7ec3\u4e603.5\uff08\u6311\u6218\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7b97\u6cd5\uff0c\u6839\u636e\u5f53\u524d\u68af\u5ea6\u4fe1\u606f\u52a8\u6001\u9009\u62e9\u4f7f\u7528K-FAC\u3001Shampoo\u8fd8\u662f\u4f4e\u79e9\u52a0\u5bf9\u89d2\u8fd1\u4f3c\u3002\u7ed9\u51fa\u9009\u62e9\u51c6\u5219\u548c\u5207\u6362\u7b56\u7565\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u8ba1\u7b97\u6548\u7387\u3001\u5185\u5b58\u9650\u5236\u548c\u8fd1\u4f3c\u8d28\u91cf\u7684\u6743\u8861\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u9009\u62e9\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8ba1\u7b97\u7edf\u8ba1\u91cf</strong>\uff1a\n   - \u68af\u5ea6\u7684\u6709\u6548\u79e9\uff1a$r_{\\text{eff}} = \\frac{(\\sum_i \\sigma_i)^2}{\\sum_i \\sigma_i^2}$\n   - \u6a21\u5f0f\u76f8\u5173\u6027\uff1a$\\rho = \\frac{|\\mathbf{G}|_F^2}{|\\mathbf{G}|_1 |\\mathbf{G}^T|_1}$\n   - \u7a00\u758f\u5ea6\uff1a$s = \\frac{|\\text{vec}(\\mathbf{G})|_0}{n^2}$</p>\n</li>\n<li>\n<p><strong>\u9009\u62e9\u51c6\u5219</strong>\uff1a\n   - \u82e5$\\rho &gt; 0.8$\u4e14\u53c2\u6570\u4e3a\u77e9\u9635\u5f62\u5f0f\uff1a\u4f7f\u7528K-FAC\n   - \u82e5$r_{\\text{eff}} &lt; 0.1n$\uff1a\u4f7f\u7528\u4f4e\u79e9\u52a0\u5bf9\u89d2\n   - \u82e5\u53c2\u6570\u4e3a\u9ad8\u9636\u5f20\u91cf\uff1a\u4f7f\u7528Shampoo\n   - \u82e5$s &lt; 0.01$\uff1a\u4f7f\u7528\u7a00\u758f\u65b9\u6cd5</p>\n</li>\n<li>\n<p><strong>\u5e73\u6ed1\u5207\u6362</strong>\uff1a\n$$\\mathbf{H}_{\\text{new}} = \\alpha\\mathbf{H}_{\\text{method1}} + (1-\\alpha)\\mathbf{H}_{\\text{method2}}$$\n\u5176\u4e2d$\\alpha$\u4ece0\u9010\u6e10\u589e\u52a0\u52301\u3002</p>\n</li>\n</ol>\n</details>\n<h3 id=\"36\">\u7ec3\u4e603.6\uff08\u6311\u6218\uff09</h3>\n<p>\u8bc1\u660e\u5f53Hessian\u5177\u6709\u5757\u5bf9\u89d2\u7ed3\u6784\u65f6\uff0cShampoo\u7b97\u6cd5\u7ed9\u51fa\u7684\u66f4\u65b0\u65b9\u5411\u4e0e\u7cbe\u786eNewton\u65b9\u5411\u4e00\u81f4\u3002\u8ba8\u8bba\u8fd9\u4e00\u6027\u8d28\u7684\u5b9e\u9645\u610f\u4e49\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u5757\u5bf9\u89d2\u77e9\u9635\u7684Kronecker\u79ef\u8868\u793a\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbeHessian\u4e3a\u5757\u5bf9\u89d2\uff1a\n$$\\mathbf{H} = \\begin{pmatrix}\n\\mathbf{H}_1 &amp; &amp; \\\n&amp; \\ddots &amp; \\\n&amp; &amp; \\mathbf{H}_k\n\\end{pmatrix}$$</p>\n<p>\u82e5\u53c2\u6570\u53ef\u8868\u793a\u4e3a\u5f20\u91cf$\\mathcal{W} \\in \\mathbb{R}^{d_1 \\times \\cdots \\times d_k}$\uff0c\u4e14\u6bcf\u4e2a\u5757$\\mathbf{H}_i$\u5bf9\u5e94\u7b2c$i$\u4e2a\u6a21\u5f0f\uff0c\u5219\uff1a</p>\n<ol>\n<li>\n<p>Shampoo\u9884\u6761\u4ef6\uff1a$\\mathcal{P} = \\mathcal{G} \\times_1 \\mathbf{H}_1^{-1/2} \\times_2 \\mathbf{H}_2^{-1/2} \\cdots$</p>\n</li>\n<li>\n<p>\u7cbe\u786eNewton\u65b9\u5411\uff1a$\\mathbf{d} = \\mathbf{H}^{-1}\\mathbf{g}$</p>\n</li>\n</ol>\n<p>\u5f53Hessian\u6070\u597d\u53ef\u5206\u89e3\u4e3a$\\mathbf{H} = \\mathbf{H}_1 \\otimes \\cdots \\otimes \\mathbf{H}_k$\u65f6\uff0c\u4e24\u8005\u7b49\u4ef7\u3002</p>\n<p><strong>\u5b9e\u9645\u610f\u4e49</strong>\uff1a</p>\n<ul>\n<li>Shampoo\u81ea\u7136\u6355\u83b7\u4e86\u53c2\u6570\u7684\u5f20\u91cf\u7ed3\u6784</li>\n<li>\u5f53\u4e0d\u540c\u6a21\u5f0f\u95f4\u76f8\u4e92\u4f5c\u7528\u8f83\u5f31\u65f6\uff0cShampoo\u8fd1\u4f3c\u8d28\u91cf\u9ad8</li>\n<li>\u63d0\u4f9b\u4e86\u4e00\u79cd\u9690\u5f0f\u7684\u7ed3\u6784\u53d1\u73b0\u673a\u5236</li>\n</ul>\n</details>\n<h3 id=\"37\">\u7ec3\u4e603.7\uff08\u5f00\u653e\u601d\u8003\uff09</h3>\n<p>\u8003\u8651\u5c06\u7ed3\u6784\u5316\u4e8c\u9636\u65b9\u6cd5\u5e94\u7528\u4e8e\u8054\u90a6\u5b66\u4e60\u573a\u666f\uff0c\u5176\u4e2d\u6570\u636e\u5206\u5e03\u5728\u591a\u4e2a\u5ba2\u6237\u7aef\u3002\u8bbe\u8ba1\u4e00\u4e2a\u901a\u4fe1\u9ad8\u6548\u7684\u534f\u8bae\uff0c\u4f7f\u5f97\u5ba2\u6237\u7aef\u53ef\u4ee5\u534f\u4f5c\u8ba1\u7b97\u7ed3\u6784\u5316\u7684Hessian\u8fd1\u4f3c\uff0c\u540c\u65f6\u4fdd\u62a4\u9690\u79c1\u3002</p>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u5dee\u5206\u9690\u79c1\u3001\u5b89\u5168\u805a\u5408\u548c\u68af\u5ea6\u538b\u7f29\u6280\u672f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8054\u90a6\u7ed3\u6784\u5316\u4e8c\u9636\u4f18\u5316\u534f\u8bae\uff1a</p>\n<ol>\n<li>\n<p><strong>\u672c\u5730\u8ba1\u7b97</strong>\uff1a\n   - \u6bcf\u4e2a\u5ba2\u6237\u7aef\u8ba1\u7b97\u672c\u5730Kronecker\u56e0\u5b50\uff1a$\\mathbf{A}_i^{(c)}, \\mathbf{B}_i^{(c)}$\n   - \u6dfb\u52a0\u5dee\u5206\u9690\u79c1\u566a\u58f0\uff1a$\\tilde{\\mathbf{A}}_i^{(c)} = \\mathbf{A}_i^{(c)} + \\mathcal{N}(0, \\sigma^2\\mathbf{I})$</p>\n</li>\n<li>\n<p><strong>\u5b89\u5168\u805a\u5408</strong>\uff1a\n   - \u4f7f\u7528\u540c\u6001\u52a0\u5bc6\u6216\u79d8\u5bc6\u5206\u4eab\u805a\u5408\u56e0\u5b50\n   - \u670d\u52a1\u5668\u8ba1\u7b97\uff1a$\\bar{\\mathbf{A}}_i = \\frac{1}{C}\\sum_{c=1}^C \\tilde{\\mathbf{A}}_i^{(c)}$</p>\n</li>\n<li>\n<p><strong>\u538b\u7f29\u901a\u4fe1</strong>\uff1a\n   - \u53ea\u4f20\u8f93\u56e0\u5b50\u7684\u4e3b\u8981\u7279\u5f81\u5411\u91cf\n   - \u4f7f\u7528\u91cf\u5316\u548c\u7a00\u758f\u5316\u6280\u672f</p>\n</li>\n<li>\n<p><strong>\u9690\u79c1\u5206\u6790</strong>\uff1a\n   - Kronecker\u56e0\u5b50\u6bd4\u5b8c\u6574Hessian\u6cc4\u9732\u66f4\u5c11\u4fe1\u606f\n   - \u5dee\u5206\u9690\u79c1\u9884\u7b97\u5206\u914d\uff1a$\\epsilon_{\\text{total}} = \\epsilon_A + \\epsilon_B$</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7b56\u7565</strong>\uff1a\n   - \u6839\u636e\u901a\u4fe1\u5e26\u5bbd\u52a8\u6001\u8c03\u6574\u66f4\u65b0\u9891\u7387\n   - \u5f02\u6784\u5ba2\u6237\u7aef\u7684\u8d1f\u8f7d\u5747\u8861</p>\n</li>\n</ol>\n</details>\n<h3 id=\"38\">\u7ec3\u4e603.8\uff08\u7814\u7a76\u65b9\u5411\uff09</h3>\n<p>\u63a2\u8ba8\u5982\u4f55\u5c06\u7ed3\u6784\u5316\u4e8c\u9636\u65b9\u6cd5\u4e0e\u73b0\u4ee3\u786c\u4ef6\u52a0\u901f\u5668\uff08\u5982TPU\u3001GPU\uff09\u7684\u7279\u6027\u76f8\u7ed3\u5408\u3002\u7279\u522b\u5173\u6ce8\uff1a</p>\n<ul>\n<li>\u77e9\u9635\u4e58\u6cd5\u5355\u5143\u7684\u9ad8\u6548\u5229\u7528</li>\n<li>\u5185\u5b58\u5c42\u6b21\u7ed3\u6784\u7684\u4f18\u5316</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7684\u5e94\u7528</li>\n</ul>\n<p><strong>\u63d0\u793a</strong>\uff1a\u8003\u8651\u786c\u4ef6\u7684\u5e76\u884c\u7279\u6027\u548c\u5185\u5b58\u5e26\u5bbd\u9650\u5236\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u786c\u4ef6\u611f\u77e5\u7684\u7ed3\u6784\u5316\u4e8c\u9636\u4f18\u5316\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f20\u91cf\u6838\u5fc3\u5229\u7528</strong>\uff1a\n   - \u5c06Kronecker\u79ef\u8fd0\u7b97\u6620\u5c04\u5230\u5f20\u91cf\u6838\u5fc3\u64cd\u4f5c\n   - \u4f7f\u7528\u6df7\u5408\u7cbe\u5ea6\uff1aFP16\u8ba1\u7b97\uff0cFP32\u7d2f\u52a0\n   - \u6279\u91cf\u77e9\u9635\u4e58\u6cd5\uff08BLAS-3\uff09\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u4f18\u5316</strong>\uff1a\n   - \u56e0\u5b50\u77e9\u9635\u7684\u5206\u5757\u5b58\u50a8\uff0c\u9002\u914d\u7f13\u5b58\u5927\u5c0f\n   - \u9884\u6761\u4ef6\u8ba1\u7b97\u4e0e\u68af\u5ea6\u8ba1\u7b97\u7684\u878d\u5408\n   - \u4f7f\u7528\u73af\u5f62\u7f13\u51b2\u533a\u51cf\u5c11\u5185\u5b58\u5206\u914d</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u7b56\u7565</strong>\uff1a\n   - \u4e0d\u540cKronecker\u56e0\u5b50\u7684\u5e76\u884c\u8ba1\u7b97\n   - \u6a21\u5f0f\u5e76\u884c\u4e0e\u6570\u636e\u5e76\u884c\u7684\u7ed3\u5408\n   - \u5f02\u6b65\u56e0\u5b50\u66f4\u65b0\u51cf\u5c11\u540c\u6b65\u5f00\u9500</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\n   - \u5173\u952e\u64cd\u4f5c\uff08\u5982\u77e9\u9635\u6c42\u9006\uff09\u4f7f\u7528\u9ad8\u7cbe\u5ea6\n   - \u52a8\u6001\u7f29\u653e\u9632\u6b62\u6ea2\u51fa/\u4e0b\u6ea2\n   - Kahan\u6c42\u548c\u7b97\u6cd5\u63d0\u9ad8\u7cbe\u5ea6</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u6a21\u578b</strong>\uff1a\n   - \u5efa\u7acbroof-line\u6a21\u578b\u9884\u6d4b\u6027\u80fd\n   - \u81ea\u52a8\u8c03\u4f18\u9009\u62e9\u6700\u4f73\u5206\u5757\u5927\u5c0f\n   - \u8fd0\u884c\u65f6\u81ea\u9002\u5e94\u8c03\u6574\u8ba1\u7b97\u7b56\u7565</p>\n</li>\n</ol>\n</details>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<h3 id=\"1-kronecker\">1. Kronecker\u56e0\u5b50\u5206\u89e3\u7684\u9677\u9631</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u76f2\u76ee\u5e94\u7528K-FAC\u5230\u6240\u6709\u5c42</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u6279\u5f52\u4e00\u5316\u5c42\u3001\u6b8b\u5dee\u8fde\u63a5\u5904\u7684\u8fd1\u4f3c\u8d28\u91cf\u5dee</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u5bf9\u7279\u6b8a\u5c42\u4f7f\u7528\u4e0d\u540c\u7684\u8fd1\u4f3c\u7b56\u7565\uff0c\u5982\u5bf9BN\u5c42\u4f7f\u7528\u5bf9\u89d2\u8fd1\u4f3c</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u66f4\u65b0\u9891\u7387\u9009\u62e9\u4e0d\u5f53</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u9891\u7e41\u66f4\u65b0\u5bfc\u81f4\u8ba1\u7b97\u5f00\u9500\u8fc7\u5927\uff1b\u66f4\u65b0\u592a\u5c11\u5bfc\u81f4\u8fc7\u65f6\u7684\u4e8c\u9636\u4fe1\u606f</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u81ea\u9002\u5e94\u66f4\u65b0\u9891\u7387\uff0c\u57fa\u4e8e\u68af\u5ea6\u53d8\u5316\u7387\u8c03\u6574</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u6570\u503c\u4e0d\u7a33\u5b9a</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u77e9\u9635\u6c42\u9006\u65f6\u51fa\u73b0\u5947\u5f02\u6216\u75c5\u6001</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u6dfb\u52a0\u9002\u5f53\u7684\u963b\u5c3c\u9879$\\lambda$\uff0c\u4f7f\u7528Tikhonov\u6b63\u5219\u5316</li>\n</ul>\n<h3 id=\"2-shampoo\">2. Shampoo\u5b9e\u73b0\u7684\u5e38\u89c1\u9519\u8bef</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5f20\u91cf\u6a21\u5f0f\u987a\u5e8f\u6df7\u6dc6</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u9884\u6761\u4ef6\u5e94\u7528\u5230\u9519\u8bef\u7684\u7ef4\u5ea6</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u660e\u786e\u5b9a\u4e49\u5e76\u6587\u6863\u5316\u5f20\u91cf\u7ef4\u5ea6\u987a\u5e8f\uff0c\u4f7f\u7528\u547d\u540d\u7ef4\u5ea6</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5185\u5b58\u7206\u70b8</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u5bf9\u9ad8\u7ef4\u5f20\u91cf\uff0c\u9884\u6761\u4ef6\u77e9\u9635\u5360\u7528\u8fc7\u591a\u5185\u5b58</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u5206\u7ec4\u7b56\u7565\uff0c\u5c06\u5927\u7ef4\u5ea6\u5206\u5272\u6210\u5c0f\u5757</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u77e9\u9635\u5e42\u8fd0\u7b97\u7684\u6570\u503c\u8bef\u5dee</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a$\\mathbf{H}^{-1/4}$\u8ba1\u7b97\u4e0d\u51c6\u786e</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u7a33\u5b9a\u7684\u7279\u5f81\u5206\u89e3\u6216\u8fed\u4ee3\u65b9\u6cd5\uff08\u5982Newton-Schulz\u8fed\u4ee3\uff09</li>\n</ul>\n<h3 id=\"3_1\">3. \u4f4e\u79e9\u8fd1\u4f3c\u7684\u8bef\u533a</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u79e9\u9009\u62e9\u8fc7\u4e8e\u6fc0\u8fdb</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u4e22\u5931\u91cd\u8981\u7684\u66f2\u7387\u4fe1\u606f</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u76d1\u63a7\u8fd1\u4f3c\u8bef\u5dee\uff0c\u4fdd\u5b88\u5730\u9009\u62e9\u521d\u59cb\u79e9</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u5ffd\u89c6\u66f4\u65b0\u7684\u65f6\u5e8f\u76f8\u5173\u6027</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u65b0\u65e7\u66f4\u65b0\u6743\u91cd\u4e0d\u5f53</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u6307\u6570\u8870\u51cf\u6743\u91cd\uff0c\u91cd\u89c6\u8fd1\u671f\u66f4\u65b0</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1aWoodbury\u516c\u5f0f\u7684\u9519\u8bef\u5e94\u7528</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u516c\u5f0f\u5e94\u7528\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff08\u5982$\\mathbf{I} + \\mathbf{V}^T\\mathbf{D}^{-1}\\mathbf{U}$\u5947\u5f02\uff09</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u6dfb\u52a0\u6b63\u5219\u5316\u9879\u6216\u4f7f\u7528\u4f2a\u9006</li>\n</ul>\n<h3 id=\"4\">4. \u7a00\u758f\u6a21\u5f0f\u7684\u6311\u6218</h3>\n<p><strong>\u95ee\u9898</strong>\uff1a\u8fc7\u5ea6\u7a00\u758f\u5316</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u91cd\u8981\u7684\u4e8c\u9636\u4fe1\u606f\u88ab\u9519\u8bef\u5730\u7f6e\u96f6</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u81ea\u9002\u5e94\u9608\u503c\uff0c\u4fdd\u7559\u8db3\u591f\u7684\u975e\u96f6\u5143\u7d20</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u7a00\u758f\u6a21\u5f0f\u9891\u7e41\u53d8\u5316</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u9884\u5904\u7406\u5f00\u9500\u8d85\u8fc7\u8ba1\u7b97\u8282\u7701</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u6ede\u540e\u7b56\u7565\uff0c\u53ea\u5728\u6a21\u5f0f\u663e\u8457\u53d8\u5316\u65f6\u66f4\u65b0</li>\n</ul>\n<p><strong>\u95ee\u9898</strong>\uff1a\u586b\u5145\u73b0\u8c61</p>\n<ul>\n<li><strong>\u9519\u8bef\u8868\u73b0</strong>\uff1a\u7a00\u758f\u5206\u89e3\u4ea7\u751f\u5927\u91cf\u586b\u5145\u5143\u7d20</li>\n<li><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a\u4f7f\u7528\u5408\u9002\u7684\u91cd\u6392\u5e8f\u7b97\u6cd5\uff08\u5982AMD\u3001METIS\uff09</li>\n</ul>\n<h3 id=\"5\">5. \u901a\u7528\u8c03\u8bd5\u6280\u5de7</h3>\n<p><strong>\u68af\u5ea6\u68c0\u67e5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u9a8c\u8bc1\uff1ag^T H^{-1} g &gt; 0 \uff08\u6b63\u5b9a\u6027\uff09\n\u76d1\u63a7\uff1a||Hp - g|| / ||g|| \uff08\u8fd1\u4f3c\u8d28\u91cf\uff09\n</code></pre></div>\n\n<p><strong>\u6761\u4ef6\u6570\u76d1\u63a7</strong>\uff1a</p>\n<ul>\n<li>\u8ddf\u8e2a$\\kappa(\\mathbf{H})$\u7684\u53d8\u5316</li>\n<li>\u6761\u4ef6\u6570\u7206\u70b8\u65f6\u589e\u52a0\u6b63\u5219\u5316</li>\n</ul>\n<p><strong>\u589e\u91cf\u9a8c\u8bc1</strong>\uff1a</p>\n<ul>\n<li>\u5148\u5728\u5c0f\u6a21\u578b\u4e0a\u9a8c\u8bc1\u5b9e\u73b0</li>\n<li>\u9010\u6b65\u589e\u52a0\u6a21\u578b\u89c4\u6a21\u548c\u590d\u6742\u5ea6</li>\n</ul>\n<p><strong>\u53ef\u89c6\u5316\u8bca\u65ad</strong>\uff1a</p>\n<ul>\n<li>\u7ed8\u5236\u7279\u5f81\u503c\u5206\u5e03</li>\n<li>\u53ef\u89c6\u5316\u7a00\u758f\u6a21\u5f0f</li>\n<li>\u76d1\u63a7\u6536\u655b\u66f2\u7ebf</li>\n</ul>\n<h2 id=\"_3\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_4\">\u7b97\u6cd5\u9009\u62e9</h3>\n<ul>\n<li>[ ] \u5206\u6790\u53c2\u6570\u7ed3\u6784\uff08\u77e9\u9635/\u5f20\u91cf/\u7a00\u758f\uff09</li>\n<li>[ ] \u8bc4\u4f30\u5185\u5b58\u9884\u7b97\u548c\u8ba1\u7b97\u8d44\u6e90</li>\n<li>[ ] \u8003\u8651\u786c\u4ef6\u7279\u6027\uff08GPU/TPU/CPU\uff09</li>\n<li>[ ] \u6d4b\u8bd5\u4e0d\u540c\u65b9\u6cd5\u7684pilot\u8fd0\u884c</li>\n</ul>\n<h3 id=\"_5\">\u5b9e\u73b0\u8981\u70b9</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u6570\u503c\u7a33\u5b9a\u7684\u77e9\u9635\u8fd0\u7b97\u5e93</li>\n<li>[ ] \u5b9e\u73b0\u81ea\u9002\u5e94\u6b63\u5219\u5316\u673a\u5236</li>\n<li>[ ] \u6dfb\u52a0\u5f02\u5e38\u68c0\u6d4b\u548c\u6062\u590d\u673a\u5236</li>\n<li>[ ] \u5206\u79bb\u7edf\u8ba1\u6536\u96c6\u548c\u9884\u6761\u4ef6\u66f4\u65b0</li>\n</ul>\n<h3 id=\"_6\">\u6027\u80fd\u4f18\u5316</h3>\n<ul>\n<li>[ ] \u6279\u91cf\u5316\u77e9\u9635\u8fd0\u7b97</li>\n<li>[ ] \u91cd\u7528\u4e2d\u95f4\u8ba1\u7b97\u7ed3\u679c</li>\n<li>[ ] \u5e76\u884c\u5316\u72ec\u7acb\u7684\u8ba1\u7b97</li>\n<li>[ ] \u4f7f\u7528\u6df7\u5408\u7cbe\u5ea6where appropriate</li>\n</ul>\n<h3 id=\"_7\">\u76d1\u63a7\u4e0e\u8c03\u8bd5</h3>\n<ul>\n<li>[ ] \u8bb0\u5f55\u5173\u952e\u6307\u6807\uff08\u8fd1\u4f3c\u8bef\u5dee\u3001\u6761\u4ef6\u6570\u7b49\uff09</li>\n<li>[ ] \u5b9e\u73b0checkpoint\u548c\u6062\u590d\u673a\u5236</li>\n<li>[ ] \u8bbe\u7f6e\u5408\u7406\u7684\u9ed8\u8ba4\u8d85\u53c2\u6570</li>\n<li>[ ] \u63d0\u4f9b\u8be6\u7ec6\u7684\u9519\u8bef\u4fe1\u606f</li>\n</ul>\n<h3 id=\"_8\">\u6269\u5c55\u6027\u8003\u8651</h3>\n<ul>\n<li>[ ] \u8bbe\u8ba1\u6a21\u5757\u5316\u7684\u63a5\u53e3</li>\n<li>[ ] \u652f\u6301\u5206\u5e03\u5f0f\u8bad\u7ec3</li>\n<li>[ ] \u8003\u8651\u5f02\u6784\u8ba1\u7b97\u73af\u5883</li>\n<li>[ ] \u9884\u7559\u81ea\u5b9a\u4e49\u7ed3\u6784\u7684\u63a5\u53e3</li>\n</ul>\n<p>\u901a\u8fc7\u9075\u5faa\u8fd9\u4e9b\u6700\u4f73\u5b9e\u8df5\uff0c\u53ef\u4ee5\u6709\u6548\u907f\u514d\u5e38\u89c1\u9677\u9631\uff0c\u5b9e\u73b0\u9ad8\u6548\u7a33\u5b9a\u7684\u7ed3\u6784\u5316\u4e8c\u9636\u4f18\u5316\u3002\u8bb0\u4f4f\uff0c\u6ca1\u6709\u4e00\u79cd\u65b9\u6cd5\u9002\u7528\u4e8e\u6240\u6709\u573a\u666f\uff0c\u9700\u8981\u6839\u636e\u5177\u4f53\u95ee\u9898\u7279\u6027\u548c\u8ba1\u7b97\u73af\u5883\u505a\u51fa\u660e\u667a\u9009\u62e9\u3002</p>"
  },
  "../chapter13.md": {
    "hash": "820f3d7531931cf11f23c16cbfe6bf8d",
    "content": "<h1 id=\"13\">\u7b2c13\u7ae0\uff1a\u52a8\u6001\u4f4e\u79e9\u8fd1\u4f3c</h1>\n<p>\u5728\u5927\u89c4\u6a21\u6570\u636e\u6d41\u548c\u5728\u7ebf\u5b66\u4e60\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u9700\u8981\u7ef4\u62a4\u77e9\u9635\u7684\u4f4e\u79e9\u8fd1\u4f3c\uff0c\u540c\u65f6\u9002\u5e94\u6570\u636e\u7684\u52a8\u6001\u53d8\u5316\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u6d41\u5f0f\u73af\u5883\u4e0b\u7684\u77e9\u9635\u5206\u89e3\u66f4\u65b0\u3001\u81ea\u9002\u5e94\u79e9\u9009\u62e9\u3001\u5728\u7ebf\u8865\u5168\u7b97\u6cd5\uff0c\u4ee5\u53ca\u8fd9\u4e9b\u6280\u672f\u4e0e\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u4e2d\u6a21\u578b\u538b\u7f29\u7684\u6df1\u523b\u8054\u7cfb\u3002\u6211\u4eec\u5c06\u7279\u522b\u5173\u6ce8\u65f6\u95f4-\u7a7a\u95f4-\u7cbe\u5ea6\u7684\u4e09\u65b9\u6743\u8861\uff0c\u4ee5\u53ca\u5728\u975e\u5e73\u7a33\u73af\u5883\u4e2d\u7684\u7406\u8bba\u4fdd\u8bc1\u3002</p>\n<h2 id=\"_1\">\u5b66\u4e60\u76ee\u6807</h2>\n<ul>\n<li>\u638c\u63e1\u589e\u91cfSVD\u7684\u6838\u5fc3\u7b97\u6cd5\u53ca\u5176\u6570\u503c\u7a33\u5b9a\u6027\u5206\u6790</li>\n<li>\u7406\u89e3\u5728\u7ebf\u73af\u5883\u4e0b\u7684\u79e9\u9009\u62e9\u7406\u8bba\u4e0e\u5b9e\u8df5</li>\n<li>\u5b66\u4f1a\u8bbe\u8ba1\u9002\u5e94\u6027\u9057\u5fd8\u673a\u5236\u5904\u7406\u6982\u5ff5\u6f02\u79fb</li>\n<li>\u5efa\u7acb\u52a8\u6001\u4f4e\u79e9\u8fd1\u4f3c\u4e0e\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u7684\u8054\u7cfb</li>\n<li>\u638c\u63e1\u6d41\u5f0f\u77e9\u9635\u8ba1\u7b97\u7684regret\u5206\u6790\u6846\u67b6</li>\n</ul>\n<h2 id=\"131\">13.1 \u6d41\u5f0f\u77e9\u9635\u8fd1\u4f3c\u57fa\u7840</h2>\n<h3 id=\"1311\">13.1.1 \u95ee\u9898\u8bbe\u5b9a\u4e0e\u6311\u6218</h3>\n<p>\u8003\u8651\u6570\u636e\u6d41\u8bbe\u5b9a\uff1a\u65f6\u523b$t$\u89c2\u5bdf\u5230\u5411\u91cf$\\mathbf{x}_t \\in \\mathbb{R}^n$\u6216\u77e9\u9635\u66f4\u65b0$\\Delta\\mathbf{A}_t$\u3002\u76ee\u6807\u662f\u7ef4\u62a4\u5f53\u524d\u6570\u636e\u77e9\u9635$\\mathbf{A}_t$\u7684\u79e9$k$\u8fd1\u4f3c$\\tilde{\\mathbf{A}}_t$\uff1a</p>\n<p>$$\\mathbf{A}_t = \\sum_{i=1}^t \\mathbf{x}_i\\mathbf{x}_i^T \\quad \\text{\u6216} \\quad \\mathbf{A}_t = \\mathbf{A}_0 + \\sum_{i=1}^t \\Delta\\mathbf{A}_i$$\n\u6838\u5fc3\u6311\u6218\uff1a</p>\n<ol>\n<li><strong>\u7a7a\u95f4\u9650\u5236</strong>\uff1a\u53ea\u80fd\u5b58\u50a8$O(nk)$\u800c\u975e$O(n^2)$\u7684\u6570\u636e</li>\n<li><strong>\u5355\u904d\u5904\u7406</strong>\uff1a\u6bcf\u4e2a\u6570\u636e\u70b9\u53ea\u80fd\u8bbf\u95ee\u4e00\u6b21</li>\n<li><strong>\u5b9e\u65f6\u66f4\u65b0</strong>\uff1a\u66f4\u65b0\u590d\u6742\u5ea6\u9700\u8fdc\u4f4e\u4e8e\u6279\u5904\u7406SVD\u7684$O(n^3)$</li>\n<li><strong>\u7cbe\u5ea6\u4fdd\u8bc1</strong>\uff1a\u4e0e\u6700\u4f18\u79e9$k$\u8fd1\u4f3c\u7684\u8bef\u5dee\u6709\u754c</li>\n</ol>\n<p><strong>\u6570\u5b66\u5f62\u5f0f\u5316</strong>\uff1a\u5b9a\u4e49\u6d41\u5f0f\u4f4e\u79e9\u8fd1\u4f3c\u95ee\u9898\u4e3a\n$$\\min_{\\tilde{\\mathbf{A}}_t: \\text{rank}(\\tilde{\\mathbf{A}}_t) \\leq k} |\\mathbf{A}_t - \\tilde{\\mathbf{A}}_t|_F^2$$\n\u5728\u7ea6\u675f\u6761\u4ef6\u4e0b\uff1a</p>\n<ul>\n<li>\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a$O(nk + \\text{poly}(k))$</li>\n<li>\u66f4\u65b0\u65f6\u95f4\uff1a$O(nk^2)$\u6bcf\u4e2a\u6570\u636e\u70b9</li>\n<li>\u4ec5\u4f7f\u7528\u8fc7\u53bb\u89c2\u6d4b${\\mathbf{x}_1, \\ldots, \\mathbf{x}_t}$</li>\n</ul>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u573a\u666f</strong>\uff1a</p>\n<ul>\n<li><strong>\u63a8\u8350\u7cfb\u7edf</strong>\uff1a\u7528\u6237-\u7269\u54c1\u4ea4\u4e92\u77e9\u9635\u7684\u5b9e\u65f6\u66f4\u65b0</li>\n<li><strong>\u7f51\u7edc\u76d1\u63a7</strong>\uff1a\u6d41\u91cf\u77e9\u9635\u7684\u5f02\u5e38\u68c0\u6d4b</li>\n<li><strong>\u91d1\u878d\u6570\u636e</strong>\uff1a\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5728\u7ebf\u4f30\u8ba1</li>\n<li><strong>\u8ba1\u7b97\u673a\u89c6\u89c9</strong>\uff1a\u89c6\u9891\u6d41\u7684\u80cc\u666f\u5efa\u6a21</li>\n</ul>\n<h3 id=\"1312\">13.1.2 \u6027\u80fd\u5ea6\u91cf\u4e0e\u7406\u8bba\u754c\u9650</h3>\n<p>\u5b9a\u4e49\u7d2f\u79efregret\uff1a\n$$R_T = \\sum_{t=1}^T |\\mathbf{A}_t - \\tilde{\\mathbf{A}}_t|_F^2 - \\sum_{t=1}^T |\\mathbf{A}_t - \\mathbf{A}_t^{(k)}|_F^2$$\n\u5176\u4e2d$\\mathbf{A}_t^{(k)}$\u662f$\\mathbf{A}_t$\u7684\u6700\u4f18\u79e9$k$\u8fd1\u4f3c\u3002</p>\n<p><strong>\u5b9a\u740613.1</strong>\uff08\u6d41\u5f0fSVD\u7684regret\u754c\uff09\uff1a\u5b58\u5728\u7b97\u6cd5\u4f7f\u5f97\n$$R_T \\leq O(k\\log T \\cdot \\sum_{j=k+1}^n \\lambda_j(\\mathbf{A}_T))$$\n\u8fd9\u8868\u660e\u989d\u5916\u8bef\u5dee\u4ec5\u5bf9\u6570\u589e\u957f\u4e8e\u65f6\u95f4$T$\u3002</p>\n<p><strong>\u8bc1\u660e\u8981\u70b9</strong>\uff1a</p>\n<ol>\n<li>\u5229\u7528\u77e9\u9635\u6270\u52a8\u7406\u8bba\u5206\u6790\u5355\u6b65\u8bef\u5dee</li>\n<li>\u901a\u8fc7telescoping sum\u6280\u672f\u7d2f\u79ef\u8bef\u5dee\u754c</li>\n<li>\u5e94\u7528\u5728\u7ebf\u5b66\u4e60\u7684regret\u5206\u6790\u6846\u67b6</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u8bc1\u660e\u601d\u8def</strong>\uff1a\n\u8bbe$\\mathbf{E}_t = \\tilde{\\mathbf{A}}_t - \\mathbf{A}_t^{(k)}$\u4e3a\u65f6\u523b$t$\u7684\u989d\u5916\u8bef\u5dee\u3002\u5173\u952e\u89c2\u5bdf\u662f\uff1a\n$$|\\mathbf{E}_t|_F^2 \\leq |\\mathbf{E}_{t-1}|_F^2 + 2\\langle\\mathbf{E}_{t-1}, \\Delta_t\\rangle + |\\Delta_t|_F^2$$\n\u5176\u4e2d$\\Delta_t$\u662f\u65f6\u523b$t$\u7684\u66f4\u65b0\u3002\u901a\u8fc7\u7cbe\u5fc3\u9009\u62e9\u66f4\u65b0\u7b56\u7565\uff0c\u53ef\u4ee5\u63a7\u5236\u4ea4\u53c9\u9879$\\langle\\mathbf{E}_{t-1}, \\Delta_t\\rangle$\u3002</p>\n<p><strong>\u66f4\u7ec6\u81f4\u7684\u6027\u80fd\u5ea6\u91cf</strong>\uff1a</p>\n<p><strong>\u76f8\u5bf9\u8bef\u5dee</strong>\uff1a\n$$\\text{RelErr}_t = \\frac{|\\mathbf{A}_t - \\tilde{\\mathbf{A}}_t|_F}{|\\mathbf{A}_t|_F}$$\n<strong>\u5b50\u7a7a\u95f4\u8ddd\u79bb</strong>\uff08\u66f4\u654f\u611f\u7684\u5ea6\u91cf\uff09\uff1a\n$$d_{\\text{sub}}(\\mathbf{U}_t, \\tilde{\\mathbf{U}}_t) = |\\mathbf{U}_t\\mathbf{U}_t^T - \\tilde{\\mathbf{U}}_t\\tilde{\\mathbf{U}}_t^T|_F$$\n<strong>\u6295\u5f71\u8bef\u5dee</strong>\uff08\u5e94\u7528\u5bfc\u5411\uff09\uff1a\n$$\\text{ProjErr}_t = \\mathbb{E}_{\\mathbf{x}}[|\\mathbf{x} - \\tilde{\\mathbf{U}}_t\\tilde{\\mathbf{U}}_t^T\\mathbf{x}|^2]$$\n<strong>Grassmannian\u8ddd\u79bb</strong>\uff08\u51e0\u4f55\u89c6\u89d2\uff09\uff1a\n$$d_{\\text{Grass}}(\\mathbf{U}_t, \\tilde{\\mathbf{U}}_t) = \\left(\\sum_{i=1}^k \\theta_i^2\\right)^{1/2}$$\n\u5176\u4e2d$\\theta_i$\u662f\u4e24\u4e2a\u5b50\u7a7a\u95f4\u4e4b\u95f4\u7684\u4e3b\u89d2\u3002</p>\n<p><strong>\u5b9a\u740613.2</strong>\uff08\u5b50\u7a7a\u95f4\u8ffd\u8e2a\uff09\uff1a\u5728\u6e29\u548c\u6761\u4ef6\u4e0b\uff0c\n$$d_{\\text{sub}}(\\mathbf{U}_t, \\tilde{\\mathbf{U}}_t) \\leq \\frac{C}{\\lambda_k(\\mathbf{A}_t) - \\lambda_{k+1}(\\mathbf{A}_t)} \\cdot \\text{err}_t$$\n\u5176\u4e2d\u5206\u6bcd\u662f\u7279\u5f81\u503c\u95f4\u9699\uff0c\u51b3\u5b9a\u4e86\u5b50\u7a7a\u95f4\u5206\u79bb\u7684\u96be\u5ea6\u3002</p>\n<p><strong>\u5b9e\u9645\u542b\u4e49</strong>\uff1a</p>\n<ul>\n<li>\u7279\u5f81\u503c\u95f4\u9699\u5927 \u2192 \u5b50\u7a7a\u95f4\u7a33\u5b9a\uff0c\u6613\u8ffd\u8e2a</li>\n<li>\u7279\u5f81\u503c\u95f4\u9699\u5c0f \u2192 \u5b50\u7a7a\u95f4\u6df7\u6dc6\uff0c\u96be\u5206\u79bb</li>\n<li>\u9000\u5316\u60c5\u51b5\uff08$\\lambda_k = \\lambda_{k+1}$\uff09\u9700\u7279\u6b8a\u5904\u7406</li>\n</ul>\n<p><strong>\u9ad8\u9636\u8bef\u5dee\u5206\u6790</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u6709\u9650\u7cbe\u5ea6\u8ba1\u7b97\uff0c\u603b\u8bef\u5dee\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a</p>\n<ol>\n<li><strong>\u8fd1\u4f3c\u8bef\u5dee</strong>\uff1a$\\epsilon_{\\text{approx}} = |\\mathbf{A}_t - \\mathbf{A}_t^{(k)}|_F$</li>\n<li><strong>\u7b97\u6cd5\u8bef\u5dee</strong>\uff1a$\\epsilon_{\\text{algo}} = |\\mathbf{A}_t^{(k)} - \\tilde{\\mathbf{A}}_t^{\\text{exact}}|_F$</li>\n<li><strong>\u820d\u5165\u8bef\u5dee</strong>\uff1a$\\epsilon_{\\text{round}} = |\\tilde{\\mathbf{A}}_t^{\\text{exact}} - \\tilde{\\mathbf{A}}_t^{\\text{float}}|_F$</li>\n</ol>\n<p><strong>\u5b9a\u740613.3</strong>\uff08\u603b\u8bef\u5dee\u754c\uff09\uff1a\u5728IEEE\u53cc\u7cbe\u5ea6\u4e0b\uff0c\n$$|\\mathbf{A}_t - \\tilde{\\mathbf{A}}_t|_F \\leq \\epsilon_{\\text{approx}} + O(\\sqrt{k\\log t})\\sigma_{k+1} + O(t \\cdot \\epsilon_{\\text{machine}})|\\mathbf{A}_t|_F$$\n\u8fd9\u7ed9\u51fa\u4e86\u7cbe\u5ea6\u3001\u79e9\u9009\u62e9\u548c\u8fd0\u884c\u65f6\u95f4\u7684\u4e09\u65b9\u6743\u8861\u3002</p>\n<p><strong>\u5b9e\u7528\u6027\u80fd\u57fa\u51c6</strong>\uff1a</p>\n<p>| \u5ea6\u91cf | \u4f18\u79c0 | \u826f\u597d | \u9700\u6539\u8fdb |</p>\n<table>\n<thead>\n<tr>\n<th>\u5ea6\u91cf</th>\n<th>\u4f18\u79c0</th>\n<th>\u826f\u597d</th>\n<th>\u9700\u6539\u8fdb</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u76f8\u5bf9\u8bef\u5dee</td>\n<td>&lt; 1%</td>\n<td>1-5%</td>\n<td>&gt; 5%</td>\n</tr>\n<tr>\n<td>\u5b50\u7a7a\u95f4\u8ddd\u79bb</td>\n<td>&lt; 0.1</td>\n<td>0.1-0.3</td>\n<td>&gt; 0.3</td>\n</tr>\n<tr>\n<td>\u6bcf\u6837\u672c\u65f6\u95f4</td>\n<td>&lt; 10\u03bcs</td>\n<td>10-100\u03bcs</td>\n<td>&gt; 100\u03bcs</td>\n</tr>\n<tr>\n<td>\u5185\u5b58\u5f00\u9500</td>\n<td>&lt; 2nk</td>\n<td>2-5nk</td>\n<td>&gt; 5nk</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"1313\">13.1.3 \u57fa\u7840\u589e\u91cf\u6846\u67b6</h3>\n<p><strong>\u7b97\u6cd513.1</strong>\uff1a\u901a\u7528\u589e\u91cf\u4f4e\u79e9\u8fd1\u4f3c\u6846\u67b6</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u521d\u59cb\u5206\u89e3<span class=\"w\"> </span><span class=\"nv\">U</span>\u2080\u03a3\u2080<span class=\"nv\">V</span>\u2080\u1d40\uff0c\u6d41\u6570\u636e<span class=\"w\"> </span>{<span class=\"nv\">x</span>\u209c}\n\u7ef4\u62a4\uff1a\u5f53\u524d\u8fd1\u4f3c<span class=\"w\"> </span><span class=\"nv\">U</span>\u209c\u03a3\u209c<span class=\"nv\">V</span>\u209c\u1d40\uff0c\u79e9\u4e3a<span class=\"nv\">k</span>\n<span class=\"k\">For</span><span class=\"w\"> </span><span class=\"nv\">t</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>,<span class=\"w\"> </span><span class=\"mi\">2</span>,<span class=\"w\"> </span>...\n<span class=\"w\">  </span><span class=\"mi\">1</span>.<span class=\"w\"> </span>\u63a5\u6536\u65b0\u6570\u636e<span class=\"nv\">x</span>\u209c\uff08\u6216\u0394<span class=\"nv\">A</span>\u209c\uff09\n<span class=\"w\">  </span><span class=\"mi\">2</span>.<span class=\"w\"> </span>\u8ba1\u7b97\u6b8b\u5dee\uff1a<span class=\"nv\">r</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">x</span>\u209c<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">U</span>\u209c<span class=\"nv\">U</span>\u209c\u1d40<span class=\"nv\">x</span>\u209c\n<span class=\"w\">  </span><span class=\"mi\">3</span>.<span class=\"w\"> </span>\u66f4\u65b0\u5b50\u7a7a\u95f4\uff1a\n<span class=\"w\">     </span><span class=\"o\">-</span><span class=\"w\"> </span>\u82e5\u2016<span class=\"nv\">r</span>\u2016<span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span>\u03b8\uff1a\u6269\u5c55<span class=\"nv\">U</span>\u7a7a\u95f4\n<span class=\"w\">     </span><span class=\"o\">-</span><span class=\"w\"> </span>\u5426\u5219\uff1a\u4ec5\u66f4\u65b0\u7cfb\u6570\n<span class=\"w\">  </span><span class=\"mi\">4</span>.<span class=\"w\"> </span>\u53ef\u9009\uff1a\u79e9\u622a\u65ad\u4fdd\u6301<span class=\"nv\">k</span>\n<span class=\"w\">  </span><span class=\"mi\">5</span>.<span class=\"w\"> </span>\u53ef\u9009\uff1a\u5e94\u7528\u9057\u5fd8\u56e0\u5b50\n</code></pre></div>\n\n<p>\u5173\u952e\u8bbe\u8ba1\u9009\u62e9\uff1a</p>\n<ul>\n<li><strong>\u6269\u5c55\u7b56\u7565</strong>\uff1a\u4f55\u65f6\u589e\u52a0\u79e9vs.\u6295\u5f71\u5230\u73b0\u6709\u7a7a\u95f4</li>\n<li><strong>\u622a\u65ad\u7b56\u7565</strong>\uff1a\u5982\u4f55\u9009\u62e9\u4fdd\u7559\u7684\u5947\u5f02\u503c/\u5411\u91cf</li>\n<li><strong>\u6570\u503c\u7a33\u5b9a\u5316</strong>\uff1a\u5468\u671f\u6027\u6b63\u4ea4\u5316\u7684\u65f6\u673a</li>\n</ul>\n<p><strong>\u8be6\u7ec6\u7684\u6269\u5c55\u7b56\u7565\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u7b56\u75651\uff1a\u56fa\u5b9a\u9608\u503c</strong></p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span>\u2016<span class=\"nv\">r</span>\u2016<span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span>\u03b8:\n<span class=\"w\">    </span>\u6269\u5c55\u5b50\u7a7a\u95f4\n<span class=\"k\">else</span>:\n<span class=\"w\">    </span>\u4ec5\u66f4\u65b0\u7cfb\u6570\n</code></pre></div>\n\n<p>\u4f18\u70b9\uff1a\u7b80\u5355\u76f4\u89c2\n\u7f3a\u70b9\uff1a\u9608\u503c\u9009\u62e9\u56f0\u96be\uff0c\u5bf9\u6570\u636e\u5c3a\u5ea6\u654f\u611f</p>\n<p><strong>\u7b56\u75652\uff1a\u76f8\u5bf9\u9608\u503c</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>if \u2016r\u2016/\u2016x\u209c\u2016 &gt; \u03b8_rel:\n    \u6269\u5c55\u5b50\u7a7a\u95f4\n</code></pre></div>\n\n<p>\u4f18\u70b9\uff1a\u5c3a\u5ea6\u4e0d\u53d8\u6027\n\u9002\u7528\uff1a\u6570\u636e\u8303\u6570\u53d8\u5316\u5927\u7684\u573a\u666f</p>\n<p><strong>\u7b56\u75653\uff1a\u7d2f\u79ef\u8bef\u5dee</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>\u7ef4\u62a4\u7d2f\u79ef\u6b8b\u5dee\u80fd\u91cfE_res\nif E_res &gt; \u03b8_energy:\n    \u6269\u5c55\u5e76\u91cd\u7f6eE_res\n</code></pre></div>\n\n<p>\u4f18\u70b9\uff1a\u8003\u8651\u5386\u53f2\u4fe1\u606f\n\u9002\u7528\uff1a\u7f13\u6162\u53d8\u5316\u7684\u6570\u636e\u6d41</p>\n<p><strong>\u622a\u65ad\u7b56\u7565\u6bd4\u8f83</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u786c\u9608\u503c\u622a\u65ad</strong>\uff1a\u4fdd\u7559\u524d$k$\u4e2a\u5947\u5f02\u503c\n   - \u4f18\u70b9\uff1a\u79e9\u4e25\u683c\u53d7\u63a7\n   - \u7f3a\u70b9\uff1a\u53ef\u80fd\u4e22\u5931\u91cd\u8981\u4fe1\u606f</p>\n</li>\n<li>\n<p><strong>\u8f6f\u9608\u503c\u622a\u65ad</strong>\uff1a$\\sigma_i \\leftarrow \\max(\\sigma_i - \\tau, 0)$\n   - \u4f18\u70b9\uff1a\u5e73\u6ed1\u8fc7\u6e21\n   - \u5e94\u7528\uff1a\u53bb\u566a\u573a\u666f</p>\n</li>\n<li>\n<p><strong>\u80fd\u91cf\u4fdd\u7559\u622a\u65ad</strong>\uff1a\u4fdd\u755995%\u80fd\u91cf\u7684\u6700\u5c0f\u79e9\n   - \u4f18\u70b9\uff1a\u81ea\u9002\u5e94\u6570\u636e\u590d\u6742\u5ea6\n   - \u7f3a\u70b9\uff1a\u79e9\u53ef\u80fd\u6ce2\u52a8</p>\n</li>\n</ol>\n<h3 id=\"1314\">13.1.4 \u4e0e\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u8054\u7cfb</h3>\n<p>\u5c06\u4f4e\u79e9\u8fd1\u4f3c\u89c6\u4e3a\u7ea6\u675f\u4f18\u5316\uff1a\n$$\\min_{\\mathbf{U}\\in\\mathbb{R}^{n\\times k}} \\sum_{t=1}^T \\ell_t(\\mathbf{U}) = \\sum_{t=1}^T |\\mathbf{x}_t - \\mathbf{U}\\mathbf{U}^T\\mathbf{x}_t|^2$$\n\u8fd9\u5efa\u7acb\u4e86\u4e0e\u5728\u7ebf\u68af\u5ea6\u4e0b\u964d\u3001\u955c\u50cf\u4e0b\u964d\u7b49\u7ecf\u5178\u7b97\u6cd5\u7684\u8054\u7cfb\u3002\u7279\u522b\u5730\uff0cOja's rule\u53ef\u89c6\u4e3a\u6b64\u95ee\u9898\u7684\u968f\u673a\u68af\u5ea6\u89e3\u6cd5\u3002</p>\n<p><strong>Oja's\u7b97\u6cd5\u8be6\u89e3</strong>\uff1a\n\u66f4\u65b0\u89c4\u5219\uff1a\n$$\\mathbf{U}_{t+1} = \\mathbf{U}_t + \\eta_t(\\mathbf{x}_t\\mathbf{x}_t^T - \\mathbf{U}_t\\mathbf{U}_t^T\\mathbf{x}_t\\mathbf{x}_t^T)\\mathbf{U}_t$$\n<strong>\u6536\u655b\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li>\u6b65\u957f$\\eta_t = c/t$\u65f6\uff0c$\\mathbb{E}[|\\mathbf{U}_t\\mathbf{U}_t^T - \\mathbf{U}_*\\mathbf{U}_*^T|_F^2] = O(1/t)$</li>\n<li>\u9700\u8981\u7279\u5f81\u503c\u95f4\u9699\u6761\u4ef6\uff1a$\\lambda_k &gt; \\lambda_{k+1}$</li>\n</ul>\n<p><strong>Oja\u7b97\u6cd5\u7684\u51e0\u4f55\u89e3\u91ca</strong>\uff1a\nOja\u66f4\u65b0\u53ef\u5206\u89e3\u4e3a\u4e24\u6b65\uff1a</p>\n<ol>\n<li><strong>Hebbian\u9879</strong>\uff1a$\\mathbf{x}_t\\mathbf{x}_t^T\\mathbf{U}_t$\u589e\u5f3a$\\mathbf{x}_t$\u65b9\u5411</li>\n<li><strong>\u6b63\u4ea4\u5316\u9879</strong>\uff1a$-\\mathbf{U}_t\\mathbf{U}_t^T\\mathbf{x}_t\\mathbf{x}_t^T\\mathbf{U}_t$\u4fdd\u6301\u5217\u6b63\u4ea4</li>\n</ol>\n<p>\u8fd9\u79cd\"\u589e\u5f3a-\u6b63\u4ea4\u5316\"\u6a21\u5f0f\u5728\u795e\u7ecf\u79d1\u5b66\u4e2d\u6709\u5bf9\u5e94\uff1aHebbian\u5b66\u4e60\u4e0e\u4fa7\u5411\u6291\u5236\u3002</p>\n<p><strong>\u63a8\u5e7f\uff1a\u5728\u7ebf\u77e9\u9635\u6d41\u5f62\u4f18\u5316</strong></p>\n<p>\u8003\u8651Stiefel\u6d41\u5f62\u7ea6\u675f\uff1a$\\mathbf{U}^T\\mathbf{U} = \\mathbf{I}_k$</p>\n<p><strong>Riemannian SGD</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"mf\">1.</span><span class=\"w\"> </span><span class=\"n\">\u8ba1\u7b97\u6b27\u6c0f\u68af\u5ea6</span><span class=\"err\">\uff1a\u2207</span><span class=\"n\">f</span><span class=\"p\">(</span><span class=\"n\">U\u209c</span><span class=\"p\">)</span>\n<span class=\"mf\">2.</span><span class=\"w\"> </span><span class=\"n\">\u6295\u5f71\u5230\u5207\u7a7a\u95f4</span><span class=\"err\">\uff1a</span><span class=\"n\">grad</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">\u2207</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">U\u209c</span><span class=\"p\">(</span><span class=\"n\">U\u209c\u1d40</span><span class=\"err\">\u2207</span><span class=\"n\">f</span><span class=\"p\">)</span>\n<span class=\"mf\">3.</span><span class=\"w\"> </span><span class=\"n\">\u6cbf\u6d4b\u5730\u7ebf\u66f4\u65b0</span><span class=\"err\">\uff1a</span><span class=\"n\">U\u209c</span><span class=\"err\">\u208a</span><span class=\"n\">\u2081</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Retr</span><span class=\"p\">(</span><span class=\"n\">U\u209c</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">\u03b7\u209c</span><span class=\"err\">\u00b7</span><span class=\"n\">grad</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p>\u5176\u4e2dRetraction\u53ef\u9009\uff1a</p>\n<ul>\n<li>QR\u5206\u89e3\uff1a$\\text{Retr}(\\mathbf{U}, \\boldsymbol{\\xi}) = \\text{qr}(\\mathbf{U} + \\boldsymbol{\\xi})$</li>\n<li>Cayley\u53d8\u6362\uff1a\u8ba1\u7b97\u66f4\u7cbe\u786e\u4f46\u66f4\u6602\u8d35</li>\n<li>\u6307\u6570\u6620\u5c04\uff1a$\\text{exp}_{\\mathbf{U}}(\\boldsymbol{\\xi}) = [\\mathbf{U}, \\mathbf{Q}]\\exp\\left(\\begin{bmatrix}\\mathbf{U}^T\\boldsymbol{\\xi} \\ -\\boldsymbol{\\xi}^T\\mathbf{U}\\end{bmatrix}\\right)\\begin{bmatrix}\\mathbf{I}_k \\ \\mathbf{0}\\end{bmatrix}$</li>\n</ul>\n<p><strong>\u5728\u7ebf\u955c\u50cf\u4e0b\u964d\u89c6\u89d2</strong>\uff1a</p>\n<p>\u5b9a\u4e49Bregman\u6563\u5ea6\uff1a\n$$D_\\phi(\\mathbf{U}, \\mathbf{V}) = \\phi(\\mathbf{U}) - \\phi(\\mathbf{V}) - \\langle\\nabla\\phi(\\mathbf{V}), \\mathbf{U} - \\mathbf{V}\\rangle$$\n\u9009\u62e9\u5408\u9002\u7684$\\phi$\u53ef\u5f97\u5230\u4e0d\u540c\u7b97\u6cd5\uff1a</p>\n<ul>\n<li>$\\phi(\\mathbf{U}) = \\frac{1}{2}|\\mathbf{U}|_F^2$\uff1a\u6807\u51c6\u68af\u5ea6\u4e0b\u964d</li>\n<li>$\\phi(\\mathbf{U}) = -\\log\\det(\\mathbf{U}^T\\mathbf{U})$\uff1a\u81ea\u7136\u68af\u5ea6</li>\n<li>$\\phi(\\mathbf{U}) = \\text{tr}(\\mathbf{U}^T\\mathbf{U}\\log(\\mathbf{U}^T\\mathbf{U}))$\uff1a\u77e9\u9635\u71b5</li>\n</ul>\n<p><strong>\u52a0\u901f\u65b9\u6cd5</strong>\uff1a</p>\n<p><strong>\u52a8\u91cf\u52a0\u901fOja</strong>\uff1a\n$$\\begin{aligned}\n\\mathbf{V}_{t+1} &amp;= \\beta\\mathbf{V}_t + (1-\\beta)\\nabla_{\\mathbf{U}}\\ell_t(\\mathbf{U}_t) \\\n\\mathbf{U}_{t+1} &amp;= \\mathbf{U}_t - \\eta_t\\mathbf{V}_{t+1}\n\\end{aligned}$$\n<strong>Nesterov\u52a0\u901f\u53d8\u4f53</strong>\uff1a\n$$\\begin{aligned}\n\\mathbf{Y}_t &amp;= \\mathbf{U}_t + \\frac{t-1}{t+2}(\\mathbf{U}_t - \\mathbf{U}_{t-1}) \\\n\\mathbf{U}_{t+1} &amp;= \\mathbf{Y}_t - \\eta_t\\nabla\\ell_t(\\mathbf{Y}_t)\n\\end{aligned}$$\n<strong>\u4e0e\u7ecf\u5178\u5728\u7ebf\u7b97\u6cd5\u7684\u5bf9\u6bd4</strong>\uff1a</p>\n<p>| \u7b97\u6cd5 | \u66f4\u65b0\u590d\u6742\u5ea6 | \u6536\u655b\u7387 | \u7ea6\u675f\u5904\u7406 | \u5185\u5b58\u9700\u6c42 |</p>\n<table>\n<thead>\n<tr>\n<th>\u7b97\u6cd5</th>\n<th>\u66f4\u65b0\u590d\u6742\u5ea6</th>\n<th>\u6536\u655b\u7387</th>\n<th>\u7ea6\u675f\u5904\u7406</th>\n<th>\u5185\u5b58\u9700\u6c42</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Oja's rule</td>\n<td>$O(nk)$</td>\n<td>$O(1/t)$</td>\n<td>\u6e10\u8fd1\u6ee1\u8db3</td>\n<td>$O(nk)$</td>\n</tr>\n<tr>\n<td>\u5728\u7ebf\u68af\u5ea6\u4e0b\u964d</td>\n<td>$O(nk)$</td>\n<td>$O(\\sqrt{T})$</td>\n<td>\u6295\u5f71\u6b65</td>\n<td>$O(nk)$</td>\n</tr>\n<tr>\n<td>Riemannian SGD</td>\n<td>$O(nk^2)$</td>\n<td>$O(1/t)$</td>\n<td>\u7cbe\u786e\u6ee1\u8db3</td>\n<td>$O(nk)$</td>\n</tr>\n<tr>\n<td>Block power</td>\n<td>$O(nkb)$</td>\n<td>$O(1/t^2)$</td>\n<td>\u6e10\u8fd1\u6ee1\u8db3</td>\n<td>$O(nkb)$</td>\n</tr>\n<tr>\n<td>SVRG-style</td>\n<td>$O(nk)$</td>\n<td>$O(1/t^2)$</td>\n<td>\u6295\u5f71\u6b65</td>\n<td>$O(nk)$</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u5728\u7ebf\u6838PCA\u6269\u5c55</strong>\uff1a</p>\n<p>\u6620\u5c04\u5230RKHS\u7a7a\u95f4$\\phi: \\mathbb{R}^n \\rightarrow \\mathcal{H}$\uff1a\n$$\\min_{\\mathbf{U}} \\sum_{t=1}^T |\\phi(\\mathbf{x}_t) - \\mathbf{U}\\mathbf{U}^T\\phi(\\mathbf{x}_t)|_{\\mathcal{H}}^2$$\n\u4f7f\u7528\u6838\u6280\u5de7\u907f\u514d\u663e\u5f0f\u6620\u5c04\uff1a</p>\n<ul>\n<li>\u7ef4\u62a4\u6838\u77e9\u9635\u7684\u4f4e\u79e9\u8fd1\u4f3c</li>\n<li>\u589e\u91cf\u66f4\u65b0\u7279\u5f81\u5411\u91cf\u7cfb\u6570</li>\n<li>Nystr\u00f6m\u8fd1\u4f3c\u52a0\u901f\u8ba1\u7b97</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u975e\u51f8\u5728\u7ebf\u4f18\u5316\u7684\u6536\u655b\u6027\u5206\u6790</li>\n<li>\u81ea\u9002\u5e94\u6b65\u957f\u7684\u7406\u8bba\u4fdd\u8bc1\uff08AdaGrad/Adam\u53d8\u4f53\uff09</li>\n<li>\u5206\u5e03\u5f0f\u6d41\u5f0fPCA\u7684\u901a\u4fe1\u590d\u6742\u5ea6\u4e0b\u754c</li>\n<li>\u5e26\u7ea6\u675f\u7684\u5728\u7ebf\u77e9\u9635\u5206\u89e3\uff08\u5982\u975e\u8d1f\u3001\u7a00\u758f\uff09</li>\n<li>\u91cf\u5b50\u7b97\u6cd5\u52a0\u901f\u7684\u53ef\u80fd\u6027</li>\n<li>\u5bf9\u6297\u6027\u6270\u52a8\u4e0b\u7684\u9c81\u68d2\u6027\u5206\u6790</li>\n<li>\u4e0e\u5f3a\u5316\u5b66\u4e60\u4e2d\u8868\u793a\u5b66\u4e60\u7684\u8054\u7cfb</li>\n</ul>\n<h2 id=\"132-svd\">13.2 \u589e\u91cfSVD\u7b97\u6cd5\u6df1\u5ea6\u5256\u6790</h2>\n<h3 id=\"1321\">13.2.1 \u79e9\u4e00\u66f4\u65b0\u7684\u6270\u52a8\u5206\u6790</h3>\n<p>\u7ed9\u5b9aSVD\u5206\u89e3$\\mathbf{A} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^T$\uff0c\u8003\u8651\u79e9\u4e00\u66f4\u65b0$\\mathbf{A}' = \\mathbf{A} + \\mathbf{c}\\mathbf{d}^T$\u3002</p>\n<p><strong>\u5f15\u740613.1</strong>\uff08Bunch-Nielsen\uff09\uff1a\u66f4\u65b0\u540e\u7684SVD\u53ef\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u8ba1\u7b97\uff1a</p>\n<ol>\n<li>\u6295\u5f71\uff1a$\\mathbf{p} = \\mathbf{U}^T\\mathbf{c}$\uff0c$\\mathbf{q} = \\mathbf{V}^T\\mathbf{d}$</li>\n<li>\u6b63\u4ea4\u8865\uff1a$\\mathbf{r}_c = \\mathbf{c} - \\mathbf{U}\\mathbf{p}$\uff0c$\\mathbf{r}_d = \\mathbf{d} - \\mathbf{V}\\mathbf{q}$</li>\n<li>\n<p>\u6784\u9020\u4e2d\u95f4\u77e9\u9635\uff1a\n$$\\mathbf{K} = \\begin{bmatrix} \\boldsymbol{\\Sigma} + \\mathbf{p}\\mathbf{q}^T &amp; |\\mathbf{r}_d|\\mathbf{p} \\ |\\mathbf{r}_c|\\mathbf{q}^T &amp; \\mathbf{r}_c^T\\mathbf{r}_d \\end{bmatrix}$$</p>\n</li>\n<li>\n<p>\u5bf9$\\mathbf{K}$\u8fdb\u884cSVD\u5f97\u5230\u66f4\u65b0</p>\n</li>\n</ol>\n<p>\u8ba1\u7b97\u590d\u6742\u5ea6\uff1a$O(nk + k^3)$\uff0c\u8fdc\u4f18\u4e8e\u91cd\u65b0\u8ba1\u7b97\u7684$O(n^2k)$\u3002</p>\n<p><strong>\u8be6\u7ec6\u63a8\u5bfc</strong>\uff1a</p>\n<p>\u5c06$\\mathbf{A}' = \\mathbf{A} + \\mathbf{c}\\mathbf{d}^T$\u91cd\u5199\u4e3a\uff1a\n$$\\mathbf{A}' = [\\mathbf{U}, \\mathbf{c}] \\begin{bmatrix} \\boldsymbol{\\Sigma} &amp; \\mathbf{0} \\ \\mathbf{0}^T &amp; 1 \\end{bmatrix} [\\mathbf{V}, \\mathbf{d}]^T$$\n\u4f46$[\\mathbf{U}, \\mathbf{c}]$\u548c$[\\mathbf{V}, \\mathbf{d}]$\u53ef\u80fd\u4e0d\u6b63\u4ea4\u3002\u901a\u8fc7\u6b63\u4ea4\u5316\uff1a\n$$[\\mathbf{U}, \\mathbf{c}] = [\\mathbf{U}, \\tilde{\\mathbf{u}}]\\begin{bmatrix} \\mathbf{I} &amp; \\mathbf{p} \\ \\mathbf{0}^T &amp; \\rho_c \\end{bmatrix}$$\n\u5176\u4e2d$\\tilde{\\mathbf{u}} = \\mathbf{r}_c/|\\mathbf{r}_c|$\uff0c$\\rho_c = |\\mathbf{r}_c|$\u3002</p>\n<p><strong>\u7a33\u5b9a\u6027\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u5b9a\u740613.3</strong>\uff1a\u8bbe$\\kappa = |\\mathbf{c}||\\mathbf{d}|/\\sigma_{\\min}(\\mathbf{A})$\uff0c\u5219\u76f8\u5bf9\u8bef\u5dee\u6ee1\u8db3\uff1a\n$$\\frac{|\\tilde{\\mathbf{A}}' - \\mathbf{A}'|_F}{|\\mathbf{A}'|_F} \\leq \\epsilon_{\\text{machine}} \\cdot O(\\kappa^2)$$\n\u8fd9\u8868\u660e\u5f53\u66f4\u65b0\u5e45\u5ea6\u76f8\u5bf9\u4e8e\u6700\u5c0f\u5947\u5f02\u503c\u8fc7\u5927\u65f6\uff0c\u7b97\u6cd5\u53ef\u80fd\u4e0d\u7a33\u5b9a\u3002</p>\n<p><strong>\u7279\u6b8a\u60c5\u51b5\u5904\u7406</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f53$\\mathbf{r}_c \\approx 0$\u6216$\\mathbf{r}_d \\approx 0$</strong>\uff1a\n   - \u66f4\u65b0\u5728\u73b0\u6709\u5b50\u7a7a\u95f4\u5185\n   - \u4ec5\u66f4\u65b0$\\boldsymbol{\\Sigma}$\uff0c\u4e0d\u6539\u53d8$\\mathbf{U}, \\mathbf{V}$\n   - \u907f\u514d\u4e0d\u5fc5\u8981\u7684\u79e9\u589e\u52a0</p>\n</li>\n<li>\n<p><strong>\u5f53$\\mathbf{A}$\u4e0d\u662f\u6ee1\u79e9\u65f6</strong>\uff1a\n   - \u9700\u8981\u7279\u6b8a\u5904\u7406\u96f6\u5947\u5f02\u503c\n   - \u4f7f\u7528\u4f2a\u9006\u6216\u6b63\u5219\u5316\u6280\u672f</p>\n</li>\n</ol>\n<h3 id=\"1322-brand\">13.2.2 Brand\u7b97\u6cd5\u53ca\u5176\u7a33\u5b9a\u5316</h3>\n<p><strong>\u7b97\u6cd513.2</strong>\uff1aBrand's\u589e\u91cfSVD</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u5f53\u524dSVD U\u03a3V\u1d40 (\u79e9k)\uff0c\u65b0\u5217c\n1. \u8ba1\u7b97\u6295\u5f71\u7cfb\u6570\uff1am = U\u1d40c\n2. \u8ba1\u7b97\u6b63\u4ea4\u5206\u91cf\uff1ap = c - Um, \u03c1 = \u2016p\u2016\n3. \u82e5\u03c1 &gt; \u03b5\uff1a\n   \u6784\u9020\u6269\u5c55\u77e9\u9635\u5e76SVD\u5206\u89e3\n4. \u5426\u5219\uff1a\n   \u4ec5\u66f4\u65b0\u03a3\u4e2d\u7684\u7cfb\u6570\n5. \u5b9a\u671f\u91cd\u6b63\u4ea4\u5316U, V\n</code></pre></div>\n\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u6539\u8fdb</strong>\uff1a</p>\n<ul>\n<li>Gram-Schmidt vs. Householder\u6b63\u4ea4\u5316</li>\n<li>\u8fed\u4ee3refinement\u6280\u672f</li>\n<li>\u57fa\u4e8e\u6761\u4ef6\u6570\u7684\u81ea\u9002\u5e94\u91cd\u8ba1\u7b97</li>\n</ul>\n<p><strong>\u7a33\u5b9a\u6027\u5206\u6790\u7684\u6df1\u5165\u8003\u5bdf</strong>\uff1a</p>\n<p><strong>\u6d6e\u70b9\u8bef\u5dee\u4f20\u64ad\u6a21\u578b</strong>\uff1a\n\u8bbe$\\epsilon_m$\u4e3a\u673a\u5668\u7cbe\u5ea6\uff0c\u7b2c$t$\u6b65\u540e\u7684\u8bef\u5dee\u754c\uff1a\n$$E_t \\leq E_0 \\cdot \\kappa^t + \\epsilon_m \\cdot \\frac{\\kappa^t - 1}{\\kappa - 1}$$\n\u5176\u4e2d$\\kappa = \\sigma_1/\\sigma_k$\u662f\u6761\u4ef6\u6570\u3002\u8fd9\u8868\u660e\uff1a</p>\n<ul>\n<li>\u6761\u4ef6\u6570\u8d8a\u5927\uff0c\u8bef\u5dee\u589e\u957f\u8d8a\u5feb</li>\n<li>\u9700\u8981\u5728$t \\approx 1/\\epsilon_m$\u6b65\u524d\u91cd\u8ba1\u7b97</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u91cd\u6b63\u4ea4\u5316\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u5b9a\u4e49\u6b63\u4ea4\u6027\u635f\u5931\uff1a\u03b4 = \u2016U\u1d40U - I\u2016_F\n\u89e6\u53d1\u6761\u4ef6\uff1a\n1. \u03b4 &gt; \u03c4_orth (\u5178\u578b\u503c\uff1a10\u207b\u2078)\n2. \u66f4\u65b0\u6b21\u6570\u8fbe\u5230N_max = \u230a1/(10\u00b7\u03b5_machine)\u230b\n3. \u6761\u4ef6\u6570\u6fc0\u589e\uff1a\u03ba(t)/\u03ba(0) &gt; 100\n</code></pre></div>\n\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li>\u5173\u952e\u8fd0\u7b97\uff08\u5982\u5185\u79ef\uff09\u4f7f\u7528\u9ad8\u7cbe\u5ea6</li>\n<li>\u5b58\u50a8\u4f7f\u7528\u4f4e\u7cbe\u5ea6\u8282\u7701\u5185\u5b58</li>\n<li>\u8bef\u5dee\u8865\u507f\u7b97\u6cd5\uff08Kahan\u6c42\u548c\uff09</li>\n</ul>\n<p><strong>\u5b8c\u6574\u7684Brand\u7b97\u6cd5\u5b9e\u73b0\u7ec6\u8282</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">updateSVD</span><span class=\"p\">(</span>U, \u03a3, V, c<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa41<span class=\"p\">:</span><span class=\"w\"> </span>\u6295\u5f71\u5230\u5f53\u524d\u5b50\u7a7a\u95f4\n<span class=\"w\">    </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">U\u1d40c</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">Um</span>\n<span class=\"w\">    </span>\u03c1<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u2016<span class=\"n\">p</span>\u2016\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa42<span class=\"p\">:</span><span class=\"w\"> </span>\u5224\u65ad\u662f\u5426\u9700\u8981\u6269\u5c55\u79e9\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span>\u03c1<span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span>\u03b5<span class=\"n\">_threshold</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa43<span class=\"n\">a</span><span class=\"p\">:</span><span class=\"w\"> </span>\u6784\u9020\u6269\u5c55\u77e9\u9635\n<span class=\"w\">        </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">/</span>\u03c1<span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u5f52\u4e00\u5316\n<span class=\"w\">        </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">zeros</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">Q</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6784\u9020<span class=\"p\">(</span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\u00d7<span class=\"p\">(</span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\u77e9\u9635\n<span class=\"w\">        </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\u03a3<span class=\"w\">  </span><span class=\"n\">m</span><span class=\"p\">]</span>\n<span class=\"w\">            </span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"w\">  </span>\u03c1<span class=\"p\">]</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa44<span class=\"n\">a</span><span class=\"p\">:</span><span class=\"w\"> </span>\u5bf9<span class=\"n\">K\u8fdb\u884cSVD</span>\n<span class=\"w\">        </span><span class=\"p\">[</span><span class=\"n\">U</span><span class=\"o\">&#39;</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"o\">&#39;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">&#39;</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">svd</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa45<span class=\"n\">a</span><span class=\"p\">:</span><span class=\"w\"> </span>\u66f4\u65b0\u5927\u77e9\u9635\n<span class=\"w\">        </span><span class=\"n\">U_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">&#39;</span>\n<span class=\"w\">        </span><span class=\"n\">V_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">&#39;</span>\n<span class=\"w\">        </span>\u03a3<span class=\"n\">_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u03a3<span class=\"o\">&#39;</span>\n<span class=\"w\">    </span><span class=\"k\">else</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa43<span class=\"n\">b</span><span class=\"p\">:</span><span class=\"w\"> </span>\u4ec5\u66f4\u65b0\u7cfb\u6570\n<span class=\"w\">        </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u03a3<span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">*</span>1\u1d40<span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u79e9\u4e00\u66f4\u65b0\n<span class=\"w\">        </span><span class=\"p\">[</span><span class=\"n\">U</span><span class=\"o\">&#39;</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"o\">&#39;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">&#39;</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">svd</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">U_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">&#39;</span>\n<span class=\"w\">        </span><span class=\"n\">V_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">&#39;</span>\n<span class=\"w\">        </span>\u03a3<span class=\"n\">_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u03a3<span class=\"o\">&#39;</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">U_new</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_new</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V_new</span>\n</code></pre></div>\n\n<p><strong>\u9ad8\u7ea7\u5b9e\u73b0\u6280\u5de7</strong>\uff1a</p>\n<p><strong>1. \u5ef6\u8fdf\u66f4\u65b0\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7ef4\u62a4\u7f13\u51b2\u533aB\u5b58\u50a8\u5f85\u5904\u7406\u66f4\u65b0\nif size(B) &lt; batch_size:\n    B.append(c)\nelse:\n    // \u6279\u91cf\u66f4\u65b0\n    [Q_B, R_B] = qr(B)\n    K = [\u03a3     U\u1d40Q_B\u00b7R_B]\n        [0  Q_B&#39;\u1d40Q_B\u00b7R_B]\n    \u6267\u884c\u5757\u66f4\u65b0\n    \u6e05\u7a7aB\n</code></pre></div>\n\n<p><strong>2. \u81ea\u9002\u5e94\u9608\u503c\u9009\u62e9</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u03b5_threshold = max(\n    \u03b5_abs,                    // \u7edd\u5bf9\u9608\u503c\n    \u03b5_rel \u00b7 \u2016c\u2016,             // \u76f8\u5bf9\u9608\u503c\n    \u221a(\u03b5_machine) \u00b7 \u03c3_k        // \u6570\u503c\u9608\u503c\n)\n</code></pre></div>\n\n<p><strong>3. \u589e\u91cf\u6b63\u4ea4\u5316</strong>\uff1a\n\u4f7f\u7528\u4fee\u6b63Gram-Schmidt\u7684\u589e\u91cf\u7248\u672c\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"err\">:</span><span class=\"nl\">k</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"n\">\u03b1_j</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">u_j</span><span class=\"s1\">&#39;p</span>\n<span class=\"s1\">    p = p - \u03b1_j\u00b7u_j</span>\n<span class=\"s1\">    // \u4e8c\u6b21\u4fee\u6b63\u63d0\u9ad8\u7cbe\u5ea6</span>\n<span class=\"s1\">    \u03b2_j = u_j&#39;</span><span class=\"n\">p</span>\n<span class=\"w\">    </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">\u03b2_j</span><span class=\"err\">\u00b7</span><span class=\"n\">u_j</span>\n<span class=\"w\">    </span><span class=\"n\">m</span><span class=\"o\">[</span><span class=\"n\">j</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">[</span><span class=\"n\">j</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">\u03b2_j</span>\n</code></pre></div>\n\n<p><strong>\u6b63\u4ea4\u5316\u7b56\u7565\u6bd4\u8f83</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4fee\u6b63Gram-Schmidt (MGS)</strong>\n   - \u4f18\u70b9\uff1a\u5728\u7ebf\u66f4\u65b0\uff0c\u5185\u5b58\u9ad8\u6548\n   - \u7f3a\u70b9\uff1a\u6570\u503c\u7a33\u5b9a\u6027\u8f83\u5dee\n   - \u9002\u7528\uff1a\u4e2d\u7b49\u7cbe\u5ea6\u8981\u6c42</p>\n</li>\n<li>\n<p><strong>Householder\u53d8\u6362</strong>\n   - \u4f18\u70b9\uff1a\u6570\u503c\u7a33\u5b9a\u6027\u6700\u4f73\n   - \u7f3a\u70b9\uff1a\u8ba1\u7b97\u91cf\u5927\uff0c\u4e0d\u6613\u5e76\u884c\n   - \u9002\u7528\uff1a\u9ad8\u7cbe\u5ea6\u8981\u6c42</p>\n</li>\n<li>\n<p><strong>\u5feb\u901fGivens\u65cb\u8f6c</strong>\n   - \u4f18\u70b9\uff1a\u5c40\u90e8\u66f4\u65b0\uff0c\u9002\u5408\u7a00\u758f\n   - \u7f3a\u70b9\uff1a\u4e32\u884c\u6027\u8d28\n   - \u9002\u7528\uff1a\u7279\u5b9a\u7ed3\u6784</p>\n</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u91cd\u6b63\u4ea4\u5316</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">checkOrthogonality</span><span class=\"p\">(</span>U<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"n\">orth_error</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u2016<span class=\"n\">U\u1d40U</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">I</span>\u2016<span class=\"n\">_F</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">orth_error</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span>\u03b5<span class=\"n\">_reorth</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">reorthogonalize</span><span class=\"p\">(</span><span class=\"n\">U</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">U</span>\n</code></pre></div>\n\n<p>\u91cd\u6b63\u4ea4\u5316\u65f6\u673a\uff1a</p>\n<ul>\n<li>\u6bcf\u9694$O(1/\\epsilon_{\\text{machine}})$\u6b21\u66f4\u65b0</li>\n<li>\u5f53\u6b63\u4ea4\u6027\u8bef\u5dee\u8d85\u8fc7\u9608\u503c</li>\n<li>\u5728\u79e9\u622a\u65ad\u64cd\u4f5c\u540e</li>\n</ul>\n<h3 id=\"1323\">13.2.3 \u9ad8\u9636\u66f4\u65b0\uff1a\u5757\u7b97\u6cd5</h3>\n<p>\u5bf9\u4e8e\u6279\u91cf\u66f4\u65b0$\\mathbf{A}' = \\mathbf{A} + \\mathbf{C}\\mathbf{D}^T$\uff08$\\mathbf{C}, \\mathbf{D} \\in \\mathbb{R}^{n \\times b}$\uff09\uff1a</p>\n<p><strong>\u5b9a\u740613.2</strong>\uff1a\u5757\u66f4\u65b0\u53ef\u5206\u89e3\u4e3a\n$$\\mathbf{A}' = \\begin{bmatrix} \\mathbf{U} &amp; \\tilde{\\mathbf{U}} \\end{bmatrix} \\tilde{\\boldsymbol{\\Sigma}} \\begin{bmatrix} \\mathbf{V} &amp; \\tilde{\\mathbf{V}} \\end{bmatrix}^T$$\n\u5176\u4e2d$\\tilde{\\mathbf{U}}, \\tilde{\\mathbf{V}}$\u6765\u81ea$\\mathbf{C}, \\mathbf{D}$\u7684QR\u5206\u89e3\u3002</p>\n<p>\u8fd9\u5728\u5904\u7406mini-batch\u66f4\u65b0\u65f6\u7279\u522b\u9ad8\u6548\u3002</p>\n<p><strong>\u5757\u66f4\u65b0\u7b97\u6cd5\u8be6\u89e3</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">blockUpdateSVD</span><span class=\"p\">(</span>U, \u03a3, V, C, D<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa41<span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">QR\u5206\u89e3\u8f93\u5165\u77e9\u9635</span>\n<span class=\"w\">    </span><span class=\"p\">[</span><span class=\"n\">Q_C</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">R_C</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">qr</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"p\">(</span><span class=\"n\">U\u1d40C</span><span class=\"p\">))</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b63\u4ea4\u5316<span class=\"n\">C</span>\n<span class=\"w\">    </span><span class=\"p\">[</span><span class=\"n\">Q_D</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">R_D</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">qr</span><span class=\"p\">(</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"p\">(</span><span class=\"n\">V\u1d40D</span><span class=\"p\">))</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b63\u4ea4\u5316<span class=\"n\">D</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa42<span class=\"p\">:</span><span class=\"w\"> </span>\u6784\u9020\u6269\u5c55\u77e9\u9635\n<span class=\"w\">    </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\u03a3<span class=\"w\">      </span><span class=\"n\">U\u1d40C</span><span class=\"p\">]</span>\n<span class=\"w\">        </span><span class=\"p\">[</span><span class=\"n\">V\u1d40D</span><span class=\"w\">    </span><span class=\"n\">R_C</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">R_D\u1d40</span><span class=\"p\">]</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa43<span class=\"p\">:</span><span class=\"w\"> </span>\u5bf9<span class=\"n\">K\u8fdb\u884cSVD</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nb\">size</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"n\">b</span><span class=\"p\">)</span>\u00d7<span class=\"p\">(</span><span class=\"n\">k</span><span class=\"o\">+</span><span class=\"n\">b</span><span class=\"p\">))</span>\n<span class=\"w\">    </span><span class=\"p\">[</span><span class=\"n\">U_K</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_K</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V_K</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">svd</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa44<span class=\"p\">:</span><span class=\"w\"> </span>\u66f4\u65b0\u539f\u59cb\u77e9\u9635\n<span class=\"w\">    </span><span class=\"n\">U_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">U</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Q_C</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">U_K</span>\n<span class=\"w\">    </span><span class=\"n\">V_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Q_D</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">V_K</span>\n<span class=\"w\">    </span>\u03a3<span class=\"n\">_new</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_K</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6b65\u9aa45<span class=\"p\">:</span><span class=\"w\"> </span>\u53ef\u9009\u79e9\u622a\u65ad\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nb\">rank</span><span class=\"p\">(</span>\u03a3<span class=\"n\">_new</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">k_max</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"p\">[</span><span class=\"n\">U_new</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_new</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V_new</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">truncate</span><span class=\"p\">(</span><span class=\"n\">U_new</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_new</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V_new</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k_max</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">U_new</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_new</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">V_new</span>\n</code></pre></div>\n\n<p><strong>\u6548\u7387\u5206\u6790</strong>\uff1a</p>\n<p>\u590d\u6742\u5ea6\u5206\u89e3\uff1a</p>\n<ul>\n<li>QR\u5206\u89e3\uff1a$O(nb^2)$</li>\n<li>\u6784\u9020K\u77e9\u9635\uff1a$O(kb + b^2)$</li>\n<li>K\u7684SVD\uff1a$O((k+b)^3)$</li>\n<li>\u77e9\u9635\u4e58\u6cd5\uff1a$O(n(k+b)^2)$</li>\n</ul>\n<p>\u603b\u590d\u6742\u5ea6\uff1a$O(nb^2 + n(k+b)^2 + (k+b)^3)$</p>\n<p><strong>\u4e0e\u9010\u4e2a\u66f4\u65b0\u7684\u5bf9\u6bd4</strong>\uff1a</p>\n<ul>\n<li>\u9010\u4e2a\u66f4\u65b0$b$\u6b21\uff1a$O(nbk + bk^3)$</li>\n<li>\u5757\u66f4\u65b0\uff1a$O(nb^2 + n(k+b)^2)$</li>\n<li>\u5f53$b \\ll k$\u65f6\uff0c\u5757\u66f4\u65b0\u663e\u8457\u66f4\u5feb</li>\n</ul>\n<p><strong>\u7279\u6b8a\u5757\u7ed3\u6784\u7684\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5bf9\u79f0\u66f4\u65b0</strong>\uff1a$\\mathbf{A}' = \\mathbf{A} + \\mathbf{C}\\mathbf{C}^T$\n   - \u53ea\u9700\u4e00\u6b21QR\u5206\u89e3\n   - \u4fdd\u6301\u5bf9\u79f0\u6027</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u66f4\u65b0</strong>\uff1a\u5f53$b \\ll k$\u65f6\n   - \u4f7f\u7528Sherman-Morrison-Woodbury\u516c\u5f0f\n   - \u907f\u514d\u6269\u5c55\u5230$(k+b) \\times (k+b)$</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u66f4\u65b0</strong>\uff1a\u5f53$\\mathbf{C}, \\mathbf{D}$\u7a00\u758f\u65f6\n   - \u5229\u7528\u7a00\u758f\u6027\u51cf\u5c11\u8ba1\u7b97\n   - \u7279\u6b8a\u7684\u7d22\u5f15\u7ed3\u6784</p>\n</li>\n</ol>\n<h3 id=\"1324-svd\">13.2.4 \u5206\u5e03\u5f0f\u589e\u91cfSVD</h3>\n<p>\u5728\u5206\u5e03\u5f0f\u8bbe\u7f6e\u4e0b\uff0c\u4e0d\u540c\u8282\u70b9\u89c2\u5bdf\u6570\u636e\u6d41\u7684\u4e0d\u540c\u90e8\u5206\uff1a</p>\n<p><strong>\u7b97\u6cd513.3</strong>\uff1a\u5f02\u6b65\u5206\u5e03\u5f0fSVD\u66f4\u65b0</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8282\u70b9i\u7ef4\u62a4\u5c40\u90e8\u8fd1\u4f3cU\u1d62\n1. \u5c40\u90e8\u66f4\u65b0\uff1a\u5904\u7406\u672c\u5730\u6570\u636e\u6d41\n2. \u5468\u671f\u901a\u4fe1\uff1a\u4ea4\u6362\u5b50\u7a7a\u95f4\u4fe1\u606f\n3. \u5171\u8bc6\u6b65\u9aa4\uff1a\u5bf9\u9f50\u4e0d\u540c\u8282\u70b9\u7684\u5b50\u7a7a\u95f4\n4. \u5168\u5c40\u66f4\u65b0\uff1a\u5408\u5e76\u5f97\u5230\u5168\u5c40U\n</code></pre></div>\n\n<p>\u5173\u952e\u6311\u6218\uff1a</p>\n<ul>\n<li>\u5b50\u7a7a\u95f4\u5bf9\u9f50\u7684\u9ad8\u6548\u7b97\u6cd5</li>\n<li>\u901a\u4fe1\u4e0e\u7cbe\u5ea6\u7684\u6743\u8861</li>\n<li>\u62dc\u5360\u5ead\u8282\u70b9\u7684\u9c81\u68d2\u6027</li>\n</ul>\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u5b9a\u740613.4</strong>\uff08\u5206\u5e03\u5f0f\u6536\u655b\u6027\uff09\uff1a\u8bbe$m$\u4e2a\u8282\u70b9\uff0c\u901a\u4fe1\u5468\u671f$\\tau$\uff0c\u5219\uff1a\n$$\\mathbb{E}[|\\mathbf{U}_T - \\mathbf{U}_*|_F] \\leq O\\left(\\frac{\\sqrt{m\\tau}}{T} + \\frac{1}{\\sqrt{mT}}\\right)$$\n\u7b2c\u4e00\u9879\u6765\u81ea\u901a\u4fe1\u5ef6\u8fdf\uff0c\u7b2c\u4e8c\u9879\u6765\u81ea\u5206\u5e03\u5f0f\u5e73\u5747\u3002</p>\n<p><strong>\u901a\u4fe1\u590d\u6742\u5ea6\u4e0b\u754c</strong>\uff1a\n<strong>\u5b9a\u740613.5</strong>\uff1a\u4efb\u4f55$\\epsilon$-\u8fd1\u4f3c\u5206\u5e03\u5f0fPCA\u7b97\u6cd5\u9700\u8981\u81f3\u5c11$\\Omega(mk\\log(1/\\epsilon))$\u6bd4\u7279\u901a\u4fe1\u3002</p>\n<p>\u8bc1\u660e\u57fa\u4e8e\u4fe1\u606f\u8bba\uff1a\u6bcf\u4e2a\u8282\u70b9\u9700\u4f20\u9012\u8db3\u591f\u4fe1\u606f\u4ee5\u91cd\u6784\u5168\u5c40\u4e3b\u6210\u5206\u3002</p>\n<p><strong>\u5206\u5e03\u5f0f\u67b6\u6784\u8be6\u89e3</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">// \u8282\u70b9i\u7684\u672c\u5730\u7b97\u6cd5</span>\n<span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">nodeUpdate</span><span class=\"p\">(</span>local_data_stream<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"c1\">// \u672c\u5730\u72b6\u6001</span>\n<span class=\"w\">    </span><span class=\"n\">U_local</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"w\">  </span><span class=\"c1\">// n\u00d7k_local</span>\n<span class=\"w\">    </span>\u03a3<span class=\"n\">_local</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"w\">  </span><span class=\"c1\">// k_local\u00d7k_local</span>\n<span class=\"w\">    </span><span class=\"n\">buffer</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"w\">   </span><span class=\"c1\">// \u6570\u636e\u7f13\u51b2</span>\n\n<span class=\"w\">    </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"c1\">// \u9636\u6bb51: \u672c\u5730\u5904\u7406</span>\n<span class=\"w\">        </span><span class=\"n\">batch</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">collect_batch</span><span class=\"p\">(</span><span class=\"n\">local_data_stream</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">U_local</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_local</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">incrementalSVD</span><span class=\"p\">(</span><span class=\"n\">U_local</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_local</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">batch</span><span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"c1\">// \u9636\u6bb52: \u5468\u671f\u901a\u4fe1</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">time_to_communicate</span><span class=\"p\">():</span>\n<span class=\"w\">            </span><span class=\"c1\">// \u53d1\u9001\u672c\u5730\u5b50\u7a7a\u95f4\u7684\u7d27\u51d1\u8868\u793a</span>\n<span class=\"w\">            </span><span class=\"n\">sketch</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">compute_sketch</span><span class=\"p\">(</span><span class=\"n\">U_local</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_local</span><span class=\"p\">)</span>\n<span class=\"w\">            </span><span class=\"n\">broadcast</span><span class=\"p\">(</span><span class=\"n\">sketch</span><span class=\"p\">)</span>\n\n<span class=\"w\">            </span><span class=\"c1\">// \u63a5\u6536\u5176\u4ed6\u8282\u70b9\u7684sketch</span>\n<span class=\"w\">            </span><span class=\"n\">sketches</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">receive_all</span><span class=\"p\">()</span>\n\n<span class=\"w\">            </span><span class=\"c1\">// \u9636\u6bb53: \u5b50\u7a7a\u95f4\u5bf9\u9f50</span>\n<span class=\"w\">            </span><span class=\"n\">U_global</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">align_subspaces</span><span class=\"p\">(</span><span class=\"n\">sketches</span><span class=\"p\">)</span>\n\n<span class=\"w\">            </span><span class=\"c1\">// \u9636\u6bb54: \u672c\u5730\u6295\u5f71\u66f4\u65b0</span>\n<span class=\"w\">            </span><span class=\"n\">U_local</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">project_to_global</span><span class=\"p\">(</span><span class=\"n\">U_local</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">U_global</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>\u5b50\u7a7a\u95f4\u5bf9\u9f50\u7b97\u6cd5</strong>\uff1a</p>\n<p><strong>\u65b9\u6cd51\uff1aGrassmannian\u5e73\u5747</strong></p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">align_subspaces</span><span class=\"p\">(</span>U_list<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8ba1\u7b97<span class=\"n\">Grassmannian\u91cd\u5fc3</span>\n<span class=\"w\">    </span><span class=\"n\">U_mean</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">grassmannian_mean</span><span class=\"p\">(</span><span class=\"n\">U_list</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">U_mean</span>\n\n<span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">grassmannian_mean</span><span class=\"p\">(</span>U_list<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8fed\u4ee3\u7b97\u6cd5\n<span class=\"w\">    </span><span class=\"n\">U_avg</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">U_list</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">iter</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">max_iters</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8ba1\u7b97\u5230\u5404\u5b50\u7a7a\u95f4\u7684\u6d4b\u5730\u7ebf\n<span class=\"w\">        </span><span class=\"n\">tangents</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[]</span>\n<span class=\"w\">        </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"n\">U_list</span><span class=\"p\">:</span>\n<span class=\"w\">            </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">log_map</span><span class=\"p\">(</span><span class=\"n\">U_avg</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"p\">)</span>\n<span class=\"w\">            </span><span class=\"n\">tangents</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u5e73\u5747\u5207\u5411\u91cf\n<span class=\"w\">        </span><span class=\"n\">v_mean</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">mean</span><span class=\"p\">(</span><span class=\"n\">tangents</span><span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6cbf\u6d4b\u5730\u7ebf\u66f4\u65b0\n<span class=\"w\">        </span><span class=\"n\">U_avg</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">exp_map</span><span class=\"p\">(</span><span class=\"n\">U_avg</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v_mean</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">U_avg</span>\n</code></pre></div>\n\n<p><strong>\u65b9\u6cd52\uff1a\u5206\u5e03\u5f0f\u7279\u5f81\u5206\u89e3</strong></p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">distributed_eigen_alignment</span><span class=\"p\">():</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6784\u9020\u5206\u5e03\u5f0f\u534f\u65b9\u5dee\u77e9\u9635\n<span class=\"w\">    </span><span class=\"n\">C_global</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">sum_all_nodes</span><span class=\"p\">(</span><span class=\"n\">U_local</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span>\u03a3<span class=\"n\">_local\u00b2</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">U_local\u1d40</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u5206\u5e03\u5f0f\u7279\u5f81\u5206\u89e3\n<span class=\"w\">    </span><span class=\"p\">[</span><span class=\"n\">V</span><span class=\"p\">,</span><span class=\"w\"> </span>\u039b<span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">distributed_eig</span><span class=\"p\">(</span><span class=\"n\">C_global</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"p\">[:,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">k</span><span class=\"p\">]</span>\n</code></pre></div>\n\n<p><strong>\u901a\u4fe1\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91cf\u5316\u538b\u7f29</strong>\n   ```\n   function quantize_subspace(U, bits):\n       // \u968f\u673a\u65cb\u8f6c\n       R = random_orthogonal(k)\n       U_rot = U @ R</p>\n<p>// \u91cf\u5316\n   U_quant = quantize(U_rot, bits)</p>\n<p>return U_quant, R\n   ```</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u6295\u5f71</strong>\n   ```\n   function sketch_subspace(U, \u03a3, sketch_size):\n       // Johnson-Lindenstrauss\u6295\u5f71\n       S = randn(n, sketch_size) / sqrt(sketch_size)\n       Y = S\u1d40 @ U @ \u03a3</p>\n<p>return Y  // sketch_size \u00d7 k\n   ```</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u901a\u4fe1</strong>\n   - \u9891\u7e41\u4ea4\u6362\u4e3b\u8981\u6210\u5206\n   - \u7a00\u758f\u4ea4\u6362\u6b21\u8981\u6210\u5206\n   - \u57fa\u4e8e\u91cd\u8981\u6027\u7684\u81ea\u9002\u5e94\u9891\u7387</p>\n</li>\n</ol>\n<p><strong>\u62dc\u5360\u5ead\u9c81\u68d2\u6027</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">byzantine_robust_aggregation</span><span class=\"p\">(</span>sketches, f<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u62dc\u5360\u5ead\u8282\u70b9\u6570\u91cf\u4e0a\u754c\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u65b9\u6cd51<span class=\"p\">:</span><span class=\"w\"> </span>\u4e2d\u4f4d\u6570\u805a\u5408\n<span class=\"w\">    </span><span class=\"n\">median_sketch</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">geometric_median</span><span class=\"p\">(</span><span class=\"n\">sketches</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u65b9\u6cd52<span class=\"p\">:</span><span class=\"w\"> </span>\u4fee\u526a\u5747\u503c\n<span class=\"w\">    </span><span class=\"nb\">distances</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">compute_distances</span><span class=\"p\">(</span><span class=\"n\">sketches</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">good_nodes</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">trim_outliers</span><span class=\"p\">(</span><span class=\"nb\">distances</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">robust_mean</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">mean</span><span class=\"p\">(</span><span class=\"n\">sketches</span><span class=\"p\">[</span><span class=\"n\">good_nodes</span><span class=\"p\">])</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">robust_mean</span>\n</code></pre></div>\n\n<p><strong>\u9ad8\u7ea7\u901a\u4fe1\u534f\u8bae</strong>\uff1a</p>\n<p><strong>1. \u6e10\u8fdb\u5f0f\u7cbe\u5ea6\u534f\u8bae</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u521d\u59cb\u9636\u6bb5\uff1a\u4ea4\u6362\u4f4e\u7cbe\u5ea6sketch (1-2 bits)\n\u4e2d\u671f\u9636\u6bb5\uff1a\u63d0\u9ad8\u5230\u4e2d\u7b49\u7cbe\u5ea6 (8-16 bits)\n\u6700\u7ec8\u9636\u6bb5\uff1a\u5168\u7cbe\u5ea6\u4ea4\u6362\u5173\u952e\u6210\u5206\n\u4f18\u52bf\uff1a\u65e9\u671f\u5feb\u901f\u6536\u655b\uff0c\u540e\u671f\u7cbe\u786e\u5bf9\u9f50\n</code></pre></div>\n\n<p><strong>2. \u5f02\u6b65Gossip SVD</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u90bb\u5c45\u5217\u8868N(i)\n\u968f\u673a\u9009\u62e9\u90bb\u5c45j \u2208 N(i)\n\u4ea4\u6362\u5e76\u5e73\u5747\u5b50\u7a7a\u95f4\uff1a\n  U_i^new = geodesic_mean(U_i, U_j)\n  U_j^new = U_i^new\n\u6536\u655b\u901f\u5ea6\uff1aO(log m / \u03bb\u2082(G))\n</code></pre></div>\n\n<p>\u5176\u4e2d$\\lambda_2(G)$\u662f\u901a\u4fe1\u56fe\u7684\u7b2c\u4e8c\u5927\u7279\u5f81\u503c\u3002</p>\n<p><strong>3. \u5206\u5c42\u805a\u5408\u6811</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u53f6\u8282\u70b9\uff1a\u672c\u5730SVD\u66f4\u65b0\n\u4e2d\u95f4\u8282\u70b9\uff1a\u5408\u5e76\u5b50\u6811\u7ed3\u679c\n\u6839\u8282\u70b9\uff1a\u5168\u5c40SVD\n\u4f18\u52bf\uff1a\u901a\u4fe1\u590d\u6742\u5ea6O(log m)\n\u7f3a\u70b9\uff1a\u5355\u70b9\u6545\u969c\u98ce\u9669\n</code></pre></div>\n\n<p><strong>\u5b9e\u9645\u7cfb\u7edf\u8003\u8651</strong>\uff1a</p>\n<p><strong>\u5e26\u5bbd\u611f\u77e5\u8c03\u5ea6</strong>\uff1a</p>\n<ul>\n<li>\u6d4b\u91cf\u8282\u70b9\u95f4\u5e26\u5bbd\uff1a$B_{ij}$</li>\n<li>\u4f18\u5148\u9ad8\u5e26\u5bbd\u94fe\u8def\u901a\u4fe1</li>\n<li>\u81ea\u9002\u5e94\u8c03\u6574\u901a\u4fe1\u9891\u7387</li>\n</ul>\n<p><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">robustAggregation</span><span class=\"p\">(</span>sketches<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u68c0\u6d4b\u5f02\u5e38\u503c\n<span class=\"w\">    </span><span class=\"nb\">median</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">geometric_median</span><span class=\"p\">(</span><span class=\"n\">sketches</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">deviations</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">distance</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">median</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"n\">sketches</span><span class=\"p\">]</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u79fb\u9664\u5f02\u5e38\n<span class=\"w\">    </span><span class=\"n\">threshold</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">median</span><span class=\"p\">(</span><span class=\"n\">deviations</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"mi\">3</span>\n<span class=\"w\">    </span><span class=\"n\">valid</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"p\">,</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">sketches</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">deviations</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">threshold</span><span class=\"p\">]</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u52a0\u6743\u805a\u5408\n<span class=\"w\">    </span><span class=\"n\">weights</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"o\">/</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"n\">valid_deviations</span><span class=\"p\">]</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">weighted_mean</span><span class=\"p\">(</span><span class=\"n\">valid</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weights</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u8349\u56fe\u7684\u5206\u5e03\u5f0fSVD\u901a\u4fe1\u538b\u7f29</li>\n<li>\u53bb\u4e2d\u5fc3\u5316\u5171\u8bc6SVD\u7b97\u6cd5</li>\n<li>\u5f02\u6784\u6570\u636e\u5206\u5e03\u4e0b\u7684\u7406\u8bba\u5206\u6790</li>\n<li>\u52a8\u6001\u7f51\u7edc\u62d3\u6251\u4e0b\u7684\u9002\u5e94\u6027\u7b97\u6cd5</li>\n<li>\u5dee\u5206\u9690\u79c1\u4fdd\u62a4\u7684\u5206\u5e03\u5f0fPCA</li>\n<li>\u8054\u90a6\u5b66\u4e60\u6846\u67b6\u4e0b\u7684\u5b89\u5168SVD</li>\n<li>\u91cf\u5b50\u901a\u4fe1\u52a0\u901f\u7684\u53ef\u80fd\u6027</li>\n</ul>\n<h2 id=\"133\">13.3 \u81ea\u9002\u5e94\u79e9\u9009\u62e9</h2>\n<h3 id=\"1331\">13.3.1 \u5728\u7ebf\u6a21\u578b\u9009\u62e9\u7406\u8bba</h3>\n<p>\u6d41\u5f0f\u73af\u5883\u4e0b\u7684\u79e9\u9009\u62e9\u9762\u4e34\u72ec\u7279\u6311\u6218\uff1a\u9700\u5728\u89c2\u5bdf\u5b8c\u6574\u6570\u636e\u524d\u505a\u51fa\u51b3\u7b56\u3002\u6838\u5fc3\u6743\u8861\uff1a</p>\n<ul>\n<li>\u79e9\u8fc7\u5c0f\uff1a\u6b20\u62df\u5408\uff0c\u4e22\u5931\u91cd\u8981\u4fe1\u606f</li>\n<li>\u79e9\u8fc7\u5927\uff1a\u8ba1\u7b97/\u5b58\u50a8\u5f00\u9500\uff0c\u8fc7\u62df\u5408\u566a\u58f0</li>\n</ul>\n<p><strong>\u5b9a\u4e4913.1</strong>\uff08\u5728\u7ebf\u79e9\u9009\u62e9regret\uff09\uff1a\n$$R_k(T) = \\sum_{t=1}^T |\\mathbf{A}_t - \\tilde{\\mathbf{A}}_{t,k_t}|_F^2 - \\min_{k^*} \\sum_{t=1}^T |\\mathbf{A}_t - \\tilde{\\mathbf{A}}_{t,k^*}|_F^2$$\n\u5176\u4e2d$k_t$\u662f\u7b97\u6cd5\u5728\u65f6\u523b$t$\u9009\u62e9\u7684\u79e9\u3002</p>\n<h3 id=\"1332\">13.3.2 \u80fd\u91cf\u9608\u503c\u65b9\u6cd5</h3>\n<p><strong>\u7b97\u6cd513.4</strong>\uff1a\u81ea\u9002\u5e94\u80fd\u91cf\u9608\u503c</p>\n<div class=\"codehilite\"><pre><span></span><code>\u53c2\u6570\uff1a\u80fd\u91cf\u4fdd\u7559\u6bd4\u4f8b\u03c4 \u2208 (0,1)\n\u7ef4\u62a4\uff1a\u5947\u5f02\u503c{\u03c3\u1d62}\u53ca\u5bf9\u5e94\u5411\u91cf\n1. \u66f4\u65b0\u5947\u5f02\u503c\u5206\u89e3\n2. \u8ba1\u7b97\u7d2f\u79ef\u80fd\u91cf\uff1aE\u2c7c = \u03a3\u1d62\u208c\u2081\u02b2 \u03c3\u1d62\u00b2 / \u03a3\u1d62 \u03c3\u1d62\u00b2\n3. \u9009\u62e9\u79e9\uff1ak* = min{j : E\u2c7c \u2265 \u03c4}\n4. \u81ea\u9002\u5e94\u8c03\u6574\u03c4\u57fa\u4e8e\u5386\u53f2\u6027\u80fd\n</code></pre></div>\n\n<p><strong>\u5b9a\u740613.3</strong>\uff1a\u5728\u5e73\u7a33\u5047\u8bbe\u4e0b\uff0c\u81ea\u9002\u5e94\u80fd\u91cf\u9608\u503c\u8fbe\u5230\n$$\\mathbb{E}[R_k(T)] \\leq O(\\sqrt{T\\log K})$$\n\u5176\u4e2d$K$\u662f\u6700\u5927\u5141\u8bb8\u79e9\u3002</p>\n<p><strong>\u8bc1\u660e\u601d\u8def</strong>\uff1a\n\u4f7f\u7528\u5728\u7ebf\u5b66\u4e60\u7684expert advice\u6846\u67b6\uff1a</p>\n<ol>\n<li>\u5c06\u6bcf\u4e2a\u53ef\u80fd\u7684\u79e9$k \\in {1, ..., K}$\u89c6\u4e3aexpert</li>\n<li>\u4f7f\u7528exponential weights\u7b97\u6cd5\u9009\u62e9\u79e9</li>\n<li>\u5229\u7528\u80fd\u91cf\u96c6\u4e2d\u6027\u8d28\u5f97\u5230\u66f4\u7d27\u7684\u754c</li>\n</ol>\n<p><strong>\u5b9e\u7528\u589e\u5f3a\u7248\u672c</strong>\uff1a</p>\n<p><strong>\u52a8\u6001\u9608\u503c\u8c03\u6574</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">adaptThreshold</span><span class=\"p\">(</span>\u03c4, history<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8ba1\u7b97\u8fd1\u671f\u91cd\u6784\u8bef\u5dee\n<span class=\"w\">    </span><span class=\"n\">recent_error</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">mean</span><span class=\"p\">(</span><span class=\"n\">history</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"n\">window</span><span class=\"p\">:])</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8bef\u5dee\u8d8b\u52bf\u5206\u6790\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">increasing_trend</span><span class=\"p\">(</span><span class=\"n\">history</span><span class=\"p\">):</span>\n<span class=\"w\">        </span>\u03c4<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">min</span><span class=\"p\">(</span>\u03c4<span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span>\u0394\u03c4<span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.99</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u9700\u8981\u66f4\u591a\u80fd\u91cf\n<span class=\"w\">    </span><span class=\"n\">elif</span><span class=\"w\"> </span><span class=\"n\">stable_low_error</span><span class=\"p\">(</span><span class=\"n\">history</span><span class=\"p\">):</span>\n<span class=\"w\">        </span>\u03c4<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">max</span><span class=\"p\">(</span>\u03c4<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span>\u0394\u03c4<span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.90</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u53ef\u4ee5\u51cf\u5c11\u80fd\u91cf\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span>\u03c4\n</code></pre></div>\n\n<p><strong>\u591a\u5c3a\u5ea6\u80fd\u91cf\u5206\u6790</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">multiScaleEnergy</span><span class=\"p\">(</span>\u03c3_values<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"n\">scales</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">10</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">20</span><span class=\"p\">]</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u4e0d\u540c\u89c2\u5bdf\u5c3a\u5ea6\n<span class=\"w\">    </span><span class=\"n\">energy_profiles</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">[]</span>\n\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"n\">scales</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8ba1\u7b97\u524d<span class=\"n\">s\u4e2a\u5947\u5f02\u503c\u7684\u80fd\u91cf\u6bd4</span>\n<span class=\"w\">        </span><span class=\"n\">E_s</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">sum</span><span class=\"p\">(</span>\u03c3\u00b2<span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">s</span><span class=\"p\">])</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nb\">sum</span><span class=\"p\">(</span>\u03c3\u00b2<span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">energy_profiles</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">E_s</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u68c0\u6d4b\u201c\u8098\u90e8\u201d\u4f4d\u7f6e\n<span class=\"w\">    </span><span class=\"n\">k_elbow</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">detectElbow</span><span class=\"p\">(</span><span class=\"n\">energy_profiles</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">k_elbow</span>\n</code></pre></div>\n\n<p><strong>\u566a\u58f0\u9c81\u68d2\u6027\u8003\u8651</strong>\uff1a</p>\n<p>\u5f53\u6570\u636e\u5305\u542b\u566a\u58f0\u65f6\uff0c\u9700\u8981\u907f\u514d\u8fc7\u62df\u5408\uff1a</p>\n<p><strong>Marcenko-Pastur\u5f8b\u5e94\u7528</strong>\uff1a\n\u5bf9\u4e8e\u968f\u673a\u77e9\u9635\uff0c\u5947\u5f02\u503c\u5206\u5e03\u904d\u5faa\uff1a\n$$\\rho(\\sigma) = \\frac{1}{2\\pi\\sigma c}\\sqrt{(\\sigma_+ - \\sigma)(\\sigma - \\sigma_-)}$$\n\u5176\u4e2d$\\sigma_\\pm = (1 \\pm \\sqrt{c})^2$\uff0c$c = n/T$\u3002</p>\n<p><strong>\u566a\u58f0\u9608\u503c\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">noiseAwareRank</span><span class=\"p\">(</span>\u03c3_values, n, T<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">/</span><span class=\"n\">T</span>\n<span class=\"w\">    </span>\u03c3<span class=\"n\">_threshold</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span>\u221a<span class=\"n\">c</span><span class=\"p\">)</span>\u00b2<span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">noise_level</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u53ea\u4fdd\u7559\u663e\u8457\u5927\u4e8e\u566a\u58f0\u7684\u5947\u5f02\u503c\n<span class=\"w\">    </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">sum</span><span class=\"p\">(</span>\u03c3<span class=\"n\">_values</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span>\u03c3<span class=\"n\">_threshold</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\n</code></pre></div>\n\n<h3 id=\"1333\">13.3.3 \u57fa\u4e8e\u9884\u6d4b\u7684\u79e9\u9009\u62e9</h3>\n<p>\u5229\u7528\u5947\u5f02\u503c\u8870\u51cf\u6a21\u5f0f\u9884\u6d4b\u672a\u6765\uff1a</p>\n<p><strong>\u6a21\u578b\u5047\u8bbe</strong>\uff1a</p>\n<ol>\n<li>\u5e42\u5f8b\u8870\u51cf\uff1a$\\sigma_i \\sim i^{-\\alpha}$</li>\n<li>\u6307\u6570\u8870\u51cf\uff1a$\\sigma_i \\sim e^{-\\beta i}$</li>\n<li>\u6df7\u5408\u6a21\u578b\uff1a\u7ec4\u5408\u591a\u79cd\u8870\u51cf\u6a21\u5f0f</li>\n</ol>\n<p><strong>\u7b97\u6cd513.5</strong>\uff1a\u9884\u6d4b\u6027\u79e9\u9009\u62e9</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"mf\">1.</span><span class=\"w\"> </span><span class=\"n\">\u5728\u7ebf\u4f30\u8ba1\u8870\u51cf\u53c2\u6570\u03b1\u6216\u03b2</span>\n<span class=\"mf\">2.</span><span class=\"w\"> </span><span class=\"n\">\u9884\u6d4b\u672a\u6765L\u6b65\u7684\u5947\u5f02\u503c\u5206\u5e03</span>\n<span class=\"mf\">3.</span><span class=\"w\"> </span><span class=\"n\">\u9009\u62e9\u79e9k\u6700\u5c0f\u5316\u9884\u671f\u8bef\u5dee</span><span class=\"err\">\uff1a</span>\n<span class=\"w\">   </span><span class=\"n\">k</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">argmin_k</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"err\">[</span><span class=\"n\">\u03a3\u209c</span><span class=\"err\">\u208a</span><span class=\"n\">\u2081\u1d57</span><span class=\"err\">\u207a</span><span class=\"n\">\u1d38</span><span class=\"w\"> </span><span class=\"err\">\u2016</span><span class=\"n\">A\u209c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">\u00c3\u209c</span><span class=\"p\">,</span><span class=\"n\">\u2096</span><span class=\"err\">\u2016</span><span class=\"n\">\u00b2</span><span class=\"err\">]</span>\n<span class=\"mf\">4.</span><span class=\"w\"> </span><span class=\"n\">\u4f7f\u7528\u6ed1\u52a8\u7a97\u53e3\u66f4\u65b0\u53c2\u6570\u4f30\u8ba1</span>\n</code></pre></div>\n\n<p><strong>\u8be6\u7ec6\u7684\u53c2\u6570\u4f30\u8ba1\u65b9\u6cd5</strong>\uff1a</p>\n<p><strong>1. \u5e42\u5f8b\u6a21\u578b\u7684\u5728\u7ebf\u4f30\u8ba1</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">estimatePowerLaw</span><span class=\"p\">(</span>\u03c3_history<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u53d6\u5bf9\u6570\u53d8\u6362\n<span class=\"w\">    </span><span class=\"n\">log_i</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">log</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"nb\">length</span><span class=\"p\">(</span>\u03c3<span class=\"p\">))</span>\n<span class=\"w\">    </span><span class=\"n\">log_\u03c3</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">log</span><span class=\"p\">(</span>\u03c3<span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u52a0\u6743\u6700\u5c0f\u4e8c\u4e58\n<span class=\"w\">    </span><span class=\"n\">weights</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">./</span><span class=\"nb\">sqrt</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"nb\">length</span><span class=\"p\">(</span>\u03c3<span class=\"p\">))</span><span class=\"w\">  </span><span class=\"o\">//</span><span class=\"w\"> </span>\u524d\u9762\u7684\u5947\u5f02\u503c\u66f4\u91cd\u8981\n<span class=\"w\">    </span>\u03b1<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">weightedLeastSquares</span><span class=\"p\">(</span><span class=\"n\">log_i</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">log_\u03c3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weights</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u9c81\u68d2\u6027\u68c0\u67e5\n<span class=\"w\">    </span><span class=\"n\">residuals</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">log_\u03c3</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">-</span>\u03b1<span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">log_i</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"nb\">abs</span><span class=\"p\">(</span><span class=\"n\">residuals</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">threshold</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u4f7f\u7528<span class=\"n\">Huber\u56de\u5f52</span>\n<span class=\"w\">        </span>\u03b1<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">huberRegression</span><span class=\"p\">(</span><span class=\"n\">log_i</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">log_\u03c3</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span>\u03b1\n</code></pre></div>\n\n<p><strong>2. \u6307\u6570\u6a21\u578b\u7684\u81ea\u9002\u5e94\u4f30\u8ba1</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">estimateExponential</span><span class=\"p\">(</span>\u03c3_history, window<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u4f7f\u7528\u6700\u8fd1\u7684<span class=\"n\">window\u4e2a\u70b9</span>\n<span class=\"w\">    </span><span class=\"n\">recent_\u03c3</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span>\u03c3<span class=\"n\">_history</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"n\">window</span><span class=\"p\">:]</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">MLE\u4f30\u8ba1</span>\n<span class=\"w\">    </span>\u03b2<span class=\"n\">_mle</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nb\">mean</span><span class=\"p\">(</span><span class=\"n\">recent_\u03c3</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8d1d\u53f6\u65af\u66f4\u65b0\uff08\u7ed3\u5408\u5148\u9a8c\uff09\n<span class=\"w\">    </span><span class=\"n\">prior_mean</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nb\">median</span><span class=\"p\">(</span>\u03c3<span class=\"n\">_history</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">prior_weight</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"mf\">0.1</span>\n\n<span class=\"w\">    </span>\u03b2<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"n\">prior_weight</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span>\u03b2<span class=\"n\">_mle</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">prior_weight</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">prior_mean</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span>\u03b2\n</code></pre></div>\n\n<p><strong>3. \u6df7\u5408\u6a21\u578b\u8bc6\u522b</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">identifyDecayPattern</span><span class=\"p\">(</span>\u03c3<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8ba1\u7b97\u4e0d\u540c\u6a21\u578b\u7684\u62df\u5408\u5ea6\n<span class=\"w\">    </span><span class=\"n\">power_fit</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">fitPowerLaw</span><span class=\"p\">(</span>\u03c3<span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">exp_fit</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">fitExponential</span><span class=\"p\">(</span>\u03c3<span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">mixed_fit</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">fitMixedModel</span><span class=\"p\">(</span>\u03c3<span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">AIC\u51c6\u5219\u9009\u62e9</span>\n<span class=\"w\">    </span><span class=\"n\">aic_power</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">AIC</span><span class=\"p\">(</span><span class=\"n\">power_fit</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03c3<span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">aic_exp</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">AIC</span><span class=\"p\">(</span><span class=\"n\">exp_fit</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03c3<span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">aic_mixed</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">AIC</span><span class=\"p\">(</span><span class=\"n\">mixed_fit</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03c3<span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">argmin</span><span class=\"p\">([</span><span class=\"n\">aic_power</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aic_exp</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">aic_mixed</span><span class=\"p\">])</span>\n</code></pre></div>\n\n<p><strong>\u9884\u6d4b\u8bef\u5dee\u7684\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u5b9a\u740613.6</strong>\uff08\u9884\u6d4b\u8bef\u5dee\u754c\uff09\uff1a\u8bbe\u771f\u5b9e\u8870\u51cf\u7387\u4e3a$\\alpha_*$\uff0c\u4f30\u8ba1\u503c\u4e3a$\\hat{\\alpha}_t$\uff0c\u5219\uff1a\n$$\\mathbb{E}[\\text{PredErr}_t] \\leq C_1 \\cdot \\mathbb{E}[|\\hat{\\alpha}_t - \\alpha_*|] + C_2 \\cdot \\frac{\\log t}{t}$$\n\u7b2c\u4e00\u9879\u6765\u81ea\u53c2\u6570\u4f30\u8ba1\u8bef\u5dee\uff0c\u7b2c\u4e8c\u9879\u6765\u81ea\u6709\u9650\u6837\u672c\u6548\u5e94\u3002</p>\n<p><strong>\u5b9e\u7528\u7b56\u7565\uff1a\u4fdd\u5b88\u9009\u62e9</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">conservativeRankSelection</span><span class=\"p\">(</span>predicted_k, confidence<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u52a0\u5165\u5b89\u5168\u8fb9\u754c\n<span class=\"w\">    </span><span class=\"n\">safety_margin</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">ceil</span><span class=\"p\">(</span><span class=\"n\">predicted_k</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">confidence</span><span class=\"p\">))</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8003\u8651\u9884\u6d4b\u4e0d\u786e\u5b9a\u6027\n<span class=\"w\">    </span><span class=\"n\">uncertainty</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">estimatePredictionUncertainty</span><span class=\"p\">()</span>\n<span class=\"w\">    </span><span class=\"n\">extra_ranks</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">ceil</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"nb\">sqrt</span><span class=\"p\">(</span><span class=\"n\">uncertainty</span><span class=\"p\">))</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">predicted_k</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">safety_margin</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">extra_ranks</span>\n</code></pre></div>\n\n<h3 id=\"1334\">13.3.4 \u8d1d\u53f6\u65af\u79e9\u9009\u62e9</h3>\n<p>\u5c06\u79e9\u89c6\u4e3a\u9690\u53d8\u91cf\uff0c\u4f7f\u7528\u5728\u7ebf\u8d1d\u53f6\u65af\u63a8\u65ad\uff1a</p>\n<p><strong>\u6982\u7387\u6a21\u578b</strong>\uff1a\n$$p(\\mathbf{A}|k) = \\mathcal{MN}(\\mathbf{0}, \\mathbf{I}_n, \\boldsymbol{\\Sigma}_k)$$\n\u5176\u4e2d$\\boldsymbol{\\Sigma}_k$\u662f\u79e9$k$\u534f\u65b9\u5dee\u3002</p>\n<p><strong>\u5728\u7ebf\u63a8\u65ad</strong>\uff1a</p>\n<ol>\n<li>\u7ef4\u62a4\u79e9\u7684\u540e\u9a8c\u5206\u5e03$p(k|D_{1:t})$</li>\n<li>\u4f7f\u7528\u7c92\u5b50\u6ee4\u6ce2\u6216\u53d8\u5206\u63a8\u65ad\u66f4\u65b0</li>\n<li>\u9009\u62e9MAP\u4f30\u8ba1\u6216\u540e\u9a8c\u671f\u671b</li>\n</ol>\n<p><strong>\u8be6\u7ec6\u7684\u8d1d\u53f6\u65af\u6846\u67b6</strong>\uff1a</p>\n<p><strong>\u5148\u9a8c\u8bbe\u8ba1</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">// \u57fa\u4e8e\u9886\u57df\u77e5\u8bc6\u7684\u5148\u9a8c</span>\n\u03c0<span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span><span class=\"w\"> </span>\u221d<span class=\"w\"> </span><span class=\"n\">k</span>^<span class=\"p\">{</span><span class=\"o\">-</span>\u03b3<span class=\"p\">}</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"nb\">exp</span><span class=\"p\">(</span><span class=\"o\">-</span>\u03bb<span class=\"o\">*</span><span class=\"n\">k</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"c1\">// \u504f\u597d\u4f4e\u79e9</span>\n\n<span class=\"c1\">// \u53c2\u6570\u9009\u62e9</span>\n\u03b3<span class=\"p\">:</span><span class=\"w\"> </span>\u63a7\u5236\u5e42\u5f8b\u8870\u51cf<span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">typical</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n\u03bb<span class=\"p\">:</span><span class=\"w\"> </span>\u63a7\u5236\u6307\u6570\u60e9\u7f5a<span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">typical</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mf\">0.01</span><span class=\"o\">-</span><span class=\"mf\">0.1</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>\u4f3c\u7136\u6a21\u578b</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">// \u6982\u7387\u6027PCA\u6a21\u578b</span>\n<span class=\"n\">p</span><span class=\"p\">(</span>\u03c3\u00b2<span class=\"n\">_i</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">InverseGamma</span><span class=\"p\">(</span>\u03b1<span class=\"p\">,</span><span class=\"w\"> </span>\u03b2<span class=\"p\">),</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span>\u2264<span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\">  </span><span class=\"c1\">// \u4fe1\u53f7\u5947\u5f02\u503c</span>\n<span class=\"w\">    </span><span class=\"n\">InverseGamma</span><span class=\"p\">(</span>\u03b1<span class=\"n\">_0</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03b2<span class=\"n\">_0</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\">  </span><span class=\"c1\">// \u566a\u58f0\u5947\u5f02\u503c</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\">// \u53c2\u6570\u5b66\u4e60</span>\n\u03b1<span class=\"p\">,</span><span class=\"w\"> </span>\u03b2<span class=\"p\">:</span><span class=\"w\"> </span>\u4ece\u6570\u636e\u4e2d\u5b66\u4e60\n\u03b1<span class=\"n\">_0</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03b2<span class=\"n\">_0</span><span class=\"p\">:</span><span class=\"w\"> </span>\u566a\u58f0\u5148\u9a8c\n</code></pre></div>\n\n<p><strong>\u5728\u7ebf\u66f4\u65b0\u7b97\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">bayesianRankUpdate</span><span class=\"p\">(</span>posterior_t, new_data<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8ba1\u7b97\u6bcf\u4e2a\u79e9\u7684\u4f3c\u7136\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">K_max</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"n\">likelihood</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">computeLikelihood</span><span class=\"p\">(</span><span class=\"n\">new_data</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u8d1d\u53f6\u65af\u66f4\u65b0\n<span class=\"w\">    </span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">posterior_t</span><span class=\"w\"> </span><span class=\"o\">.*</span><span class=\"w\"> </span><span class=\"n\">likelihood</span>\n<span class=\"w\">    </span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u9632\u6b62\u6570\u503c\u4e0b\u6ea2\n<span class=\"w\">    </span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">renormalize</span><span class=\"p\">(</span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">posterior_t</span><span class=\"o\">+</span><span class=\"mi\">1</span>\n</code></pre></div>\n\n<p><strong>\u53d8\u5206\u63a8\u65ad\u52a0\u901f</strong>\uff1a</p>\n<p>\u4e3a\u907f\u514d\u8ba1\u7b97\u6240\u6709$K$\u4e2a\u53ef\u80fd\u79e9\u7684\u4f3c\u7136\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">variationalRankInference</span><span class=\"p\">(</span>data<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u53d8\u5206\u5206\u5e03<span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">Categorical</span><span class=\"p\">(</span>\u03c0<span class=\"p\">)</span>\n<span class=\"w\">    </span>\u03c0<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">uniform</span><span class=\"p\">(</span><span class=\"n\">K_max</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">iter</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">max_iters</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">-</span><span class=\"nb\">step</span><span class=\"p\">:</span><span class=\"w\"> </span>\u66f4\u65b0\u79e9\u5206\u5e03\n<span class=\"w\">        </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">K_max</span><span class=\"p\">:</span>\n<span class=\"w\">            </span>\u03c0<span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">]</span><span class=\"w\"> </span>\u221d<span class=\"w\"> </span><span class=\"nb\">exp</span><span class=\"p\">(</span><span class=\"n\">ELBO</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">))</span>\n<span class=\"w\">        </span>\u03c0<span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">normalize</span><span class=\"p\">(</span>\u03c0<span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">-</span><span class=\"nb\">step</span><span class=\"p\">:</span><span class=\"w\"> </span>\u66f4\u65b0\u6a21\u578b\u53c2\u6570\n<span class=\"w\">        </span><span class=\"n\">updateModelParams</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span><span class=\"w\"> </span>\u03c0<span class=\"p\">)</span>\n\n<span class=\"w\">        </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6536\u655b\u68c0\u67e5\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">converged</span><span class=\"p\">(</span>\u03c0<span class=\"p\">):</span>\n<span class=\"w\">            </span><span class=\"k\">break</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span>\u03c0\n</code></pre></div>\n\n<p><strong>\u5b9e\u65f6\u51b3\u7b56\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">selectRank</span><span class=\"p\">(</span>posterior, risk_aversion<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">MAP\u4f30\u8ba1</span>\uff08\u6700\u6fc0\u8fdb\uff09\n<span class=\"w\">    </span><span class=\"n\">k_map</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">argmax</span><span class=\"p\">(</span><span class=\"n\">posterior</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u540e\u9a8c\u5747\u503c\uff08\u5e73\u8861\uff09\n<span class=\"w\">    </span><span class=\"n\">k_mean</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">posterior</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">K_max</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u98ce\u9669\u654f\u611f\u51b3\u7b56\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6700\u5c0f\u5316\u9884\u671f\u635f\u5931<span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"n\">k</span><span class=\"o\">&#39;</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">k</span><span class=\"o\">-</span><span class=\"n\">k</span><span class=\"o\">&#39;|</span>^\u03b1\n<span class=\"w\">    </span><span class=\"n\">k_bayes</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">argmin_k</span><span class=\"w\"> </span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">L</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"n\">k</span><span class=\"o\">&#39;</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">posterior</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"o\">&#39;</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">&#39;</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"n\">K_max</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"o\">//</span><span class=\"w\"> </span>\u6839\u636e\u98ce\u9669\u504f\u597d\u9009\u62e9\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">risk_aversion</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s\">&quot;low&quot;</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">k_map</span>\n<span class=\"w\">    </span><span class=\"n\">elif</span><span class=\"w\"> </span><span class=\"n\">risk_aversion</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"s\">&quot;medium&quot;</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">k_mean</span>\n<span class=\"w\">    </span><span class=\"k\">else</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">k_bayes</span>\n</code></pre></div>\n\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u975e\u5e73\u7a31\u73af\u5883\u4e0b\u7684\u79e9\u8ffd\u8e2a</li>\n<li>\u591a\u5c3a\u5ea6\u79e9\u9009\u62e9\uff08\u4e0d\u540c\u65f6\u95f4\u5c3a\u5ea6\u4e0d\u540c\u79e9\uff09</li>\n<li>\u4e0e\u5728\u7ebf\u6838\u5b66\u4e60\u7684\u8054\u7cfb</li>\n<li>\u5206\u5e03\u5f0f\u8d1d\u53f6\u65af\u63a8\u65ad</li>\n<li>\u975e\u53c2\u6570\u8d1d\u53f6\u65af\u65b9\u6cd5\uff08Dirichlet Process\uff09</li>\n</ul>\n<h2 id=\"134\">13.4 \u5728\u7ebf\u77e9\u9635\u8865\u5168</h2>\n<h3 id=\"1341\">13.4.1 \u6d41\u5f0f\u89c2\u6d4b\u6a21\u578b</h3>\n<p>\u8003\u8651\u90e8\u5206\u89c2\u6d4b\u7684\u6d41\u5f0f\u8bbe\u5b9a\uff1a</p>\n<ul>\n<li>\u65f6\u523b$t$\uff1a\u89c2\u6d4b\u4f4d\u7f6e$(i_t, j_t)$\u7684\u503c$M_{i_t,j_t}$</li>\n<li>\u76ee\u6807\uff1a\u5b9e\u65f6\u9884\u6d4b\u672a\u89c2\u6d4b\u4f4d\u7f6e</li>\n<li>\u7ea6\u675f\uff1a\u4f4e\u79e9\u5047\u8bbe$\\text{rank}(\\mathbf{M}) \\leq r$</li>\n</ul>\n<p><strong>\u5f62\u5f0f\u5316</strong>\uff1a\u5728\u7ebf\u5b66\u4e60\u534f\u8bae</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">For</span><span class=\"w\"> </span><span class=\"nv\">t</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>,<span class=\"w\"> </span><span class=\"mi\">2</span>,<span class=\"w\"> </span>...,<span class=\"w\"> </span><span class=\"nv\">T</span>:\n<span class=\"w\">  </span><span class=\"mi\">1</span>.<span class=\"w\"> </span>\u7b97\u6cd5\u9884\u6d4b<span class=\"nv\">M</span>\u0302\u209c\uff08\u79e9\u2264<span class=\"nv\">r</span>\uff09\n<span class=\"w\">  </span><span class=\"mi\">2</span>.<span class=\"w\"> </span>\u5bf9\u624b\u9009\u62e9<span class=\"ss\">(</span><span class=\"nv\">i</span>\u209c,<span class=\"w\"> </span><span class=\"nv\">j</span>\u209c<span class=\"ss\">)</span>\n<span class=\"w\">  </span><span class=\"mi\">3</span>.<span class=\"w\"> </span>\u89c2\u6d4b\u771f\u5b9e\u503c<span class=\"nv\">M</span>\u1d62\u209c,\u2c7c\u209c\n<span class=\"w\">  </span><span class=\"mi\">4</span>.<span class=\"w\"> </span>\u906d\u53d7\u635f\u5931\u2113\u209c<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ss\">(</span><span class=\"nv\">M</span>\u0302\u209c[<span class=\"nv\">i</span>\u209c,<span class=\"nv\">j</span>\u209c]<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">M</span>\u1d62\u209c,\u2c7c\u209c<span class=\"ss\">)</span>\u00b2\n</code></pre></div>\n\n<h3 id=\"1342\">13.4.2 \u5728\u7ebf\u68af\u5ea6\u4e0b\u964d\u65b9\u6cd5</h3>\n<p>\u77e9\u9635\u8865\u5168\u7684\u56e0\u5b50\u5206\u89e3\u5f62\u5f0f\uff1a$\\mathbf{M} \\approx \\mathbf{U}\\mathbf{V}^T$</p>\n<p><strong>\u7b97\u6cd513.6</strong>\uff1a\u6d41\u5f0f\u77e9\u9635\u5206\u89e3</p>\n<div class=\"codehilite\"><pre><span></span><code>\u521d\u59cb\u5316\uff1a<span class=\"nv\">U</span>\u2080,<span class=\"w\"> </span><span class=\"nv\">V</span>\u2080<span class=\"w\"> </span>\u2208<span class=\"w\"> </span>\u211d\u207f\u02e3\u02b3\n<span class=\"k\">For</span><span class=\"w\"> </span><span class=\"nv\">each</span>\u89c2\u6d4b<span class=\"ss\">(</span><span class=\"nv\">i</span>,<span class=\"nv\">j</span>,<span class=\"nv\">M</span>\u1d62\u2c7c<span class=\"ss\">)</span>:\n<span class=\"w\">  </span><span class=\"mi\">1</span>.<span class=\"w\"> </span>\u9884\u6d4b\uff1a<span class=\"nv\">M</span>\u0302\u1d62\u2c7c<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>\u27e8<span class=\"nv\">u</span>\u1d62,<span class=\"w\"> </span><span class=\"nv\">v</span>\u2c7c\u27e9\n<span class=\"w\">  </span><span class=\"mi\">2</span>.<span class=\"w\"> </span>\u68af\u5ea6\u8ba1\u7b97\uff1a\n<span class=\"w\">     </span>\u2207\u1d64\u1d62<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"ss\">(</span><span class=\"nv\">M</span>\u1d62\u2c7c<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">M</span>\u0302\u1d62\u2c7c<span class=\"ss\">)</span><span class=\"nv\">v</span>\u2c7c\n<span class=\"w\">     </span>\u2207\u1d65\u2c7c<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"ss\">(</span><span class=\"nv\">M</span>\u1d62\u2c7c<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">M</span>\u0302\u1d62\u2c7c<span class=\"ss\">)</span><span class=\"nv\">u</span>\u1d62\n<span class=\"w\">  </span><span class=\"mi\">3</span>.<span class=\"w\"> </span>\u66f4\u65b0\uff1a\n<span class=\"w\">     </span><span class=\"nv\">u</span>\u1d62<span class=\"w\"> </span>\u2190<span class=\"w\"> </span><span class=\"nv\">u</span>\u1d62<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span>\u03b7\u209c\u2207\u1d64\u1d62\n<span class=\"w\">     </span><span class=\"nv\">v</span>\u2c7c<span class=\"w\"> </span>\u2190<span class=\"w\"> </span><span class=\"nv\">v</span>\u2c7c<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span>\u03b7\u209c\u2207\u1d65\u2c7c\n<span class=\"w\">  </span><span class=\"mi\">4</span>.<span class=\"w\"> </span>\u53ef\u9009\u6b63\u5219\u5316<span class=\"o\">/</span>\u6295\u5f71\u6b65\u9aa4\n</code></pre></div>\n\n<p><strong>\u6536\u655b\u6027\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u51f8\u677e\u5f1b\u4e0b\uff1a$O(\\sqrt{T})$ regret</li>\n<li>\u975e\u51f8\u4f46\u6ee1\u8db3RIP\uff1a\u7ebf\u6027\u6536\u655b\u5230\u5c40\u90e8\u6700\u4f18</li>\n<li>\u4e00\u822c\u60c5\u51b5\uff1a\u4f9d\u8d56\u521d\u59cb\u5316\u8d28\u91cf</li>\n</ul>\n<h3 id=\"1343-riemannian\">13.4.3 Riemannian\u4f18\u5316\u89c6\u89d2</h3>\n<p>\u5c06\u4f4e\u79e9\u7ea6\u675f\u89c6\u4e3a\u6d41\u5f62\u7ea6\u675f\uff1a\n$$\\mathcal{M}_r = {\\mathbf{X} \\in \\mathbb{R}^{m \\times n} : \\text{rank}(\\mathbf{X}) = r}$$\n<strong>\u7b97\u6cd513.7</strong>\uff1a\u5728\u7ebfRiemannian\u68af\u5ea6\u4e0b\u964d</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7ef4\u62a4\uff1a\u5f53\u524d\u70b9X\u209c \u2208 \ud835\udcdc\u1d63\n1. \u8ba1\u7b97\u6b27\u6c0f\u68af\u5ea6\u2207f(X\u209c)\n2. \u6295\u5f71\u5230\u5207\u7a7a\u95f4\uff1agrad\u209c = Proj_{TX\u209c}(\u2207f)\n3. \u6cbf\u6d4b\u5730\u7ebf\u66f4\u65b0\uff1a\n   X\u209c\u208a\u2081 = Retr_X\u209c(-\u03b7\u209c grad\u209c)\n</code></pre></div>\n\n<p>\u5173\u952e\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u81ea\u52a8\u6ee1\u8db3\u79e9\u7ea6\u675f</li>\n<li>\u66f4\u597d\u7684\u6536\u655b\u6027\u8d28</li>\n<li>\u81ea\u7136\u5904\u7406\u77e9\u9635\u7684\u5185\u5728\u51e0\u4f55</li>\n</ul>\n<h3 id=\"1344\">13.4.4 \u5e26\u8fb9\u4fe1\u606f\u7684\u5728\u7ebf\u8865\u5168</h3>\n<p>\u5b9e\u9645\u5e94\u7528\u5e38\u6709\u8f85\u52a9\u4fe1\u606f\uff08\u5982\u7528\u6237\u7279\u5f81\u3001\u65f6\u95f4\u6233\uff09\uff1a</p>\n<p><strong>\u6a21\u578b\u6269\u5c55</strong>\uff1a\n$$M_{ij} = \\langle \\mathbf{u}_i, \\mathbf{v}_j \\rangle + f(\\mathbf{x}_i, \\mathbf{y}_j; \\boldsymbol{\\theta})$$\n\u5176\u4e2d$f$\u53ef\u4ee5\u662f\uff1a</p>\n<ul>\n<li>\u7ebf\u6027\uff1a$\\boldsymbol{\\theta}^T[\\mathbf{x}_i; \\mathbf{y}_j]$</li>\n<li>\u795e\u7ecf\u7f51\u7edc\uff1a\u66f4\u590d\u6742\u7684\u7279\u5f81\u4ea4\u4e92</li>\n<li>\u6838\u65b9\u6cd5\uff1a\u975e\u7ebf\u6027\u4f46\u8ba1\u7b97\u9ad8\u6548</li>\n</ul>\n<p><strong>\u5728\u7ebf\u5b66\u4e60\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\u4ea4\u66ff\u4f18\u5316\u6f5c\u5728\u56e0\u5b50\u548c\u7279\u5f81\u51fd\u6570</li>\n<li>\u7aef\u5230\u7aef\u68af\u5ea6\u4e0b\u964d</li>\n<li>\u4e24\u9636\u6bb5\uff1a\u5148\u5b66\u7279\u5f81\u518d\u8865\u5168</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u51b7\u542f\u52a8\u573a\u666f\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u975e\u5747\u5300\u91c7\u6837\u4e0b\u7684\u65e0\u504f\u4f30\u8ba1</li>\n<li>\u5bf9\u6297\u6027corruptions\u7684\u9c81\u68d2\u6027</li>\n</ul>\n<h2 id=\"135\">13.5 \u9057\u5fd8\u673a\u5236\u4e0e\u6982\u5ff5\u6f02\u79fb</h2>\n<h3 id=\"1351\">13.5.1 \u6307\u6570\u9057\u5fd8\u6a21\u578b</h3>\n<p>\u5904\u7406\u975e\u5e73\u7a33\u6570\u636e\u6d41\u7684\u7ecf\u5178\u65b9\u6cd5\uff1a</p>\n<p><strong>\u66f4\u65b0\u89c4\u5219</strong>\uff1a\n$$\\mathbf{A}_t = \\gamma \\mathbf{A}_{t-1} + \\mathbf{x}_t\\mathbf{x}_t^T$$\n\u5176\u4e2d$\\gamma \\in (0,1)$\u662f\u9057\u5fd8\u56e0\u5b50\u3002</p>\n<p><strong>\u6027\u8d28\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6709\u6548\u7a97\u53e3\u957f\u5ea6\uff1a$\\approx 1/(1-\\gamma)$</li>\n<li>\u7279\u5f81\u503c\u8870\u51cf\uff1a$\\lambda_i(t) = \\gamma\\lambda_i(t-1) + \\text{\u65b0\u8d21\u732e}$</li>\n<li>\u504f\u5dee-\u65b9\u5dee\u6743\u8861\uff1a$\\gamma$\u8d8a\u5c0f\u9002\u5e94\u8d8a\u5feb\u4f46\u65b9\u5dee\u8d8a\u5927</li>\n</ul>\n<h3 id=\"1352\">13.5.2 \u81ea\u9002\u5e94\u9057\u5fd8\u56e0\u5b50</h3>\n<p><strong>\u7b97\u6cd513.8</strong>\uff1a\u57fa\u4e8e\u53d8\u5316\u68c0\u6d4b\u7684\u81ea\u9002\u5e94\u9057\u5fd8</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7ef4\u62a4\uff1a\u591a\u4e2a\u65f6\u95f4\u5c3a\u5ea6\u7684\u7edf\u8ba1\u91cf\n<span class=\"mi\">1</span>.<span class=\"w\"> </span>\u77ed\u671f\u7edf\u8ba1\uff1a<span class=\"nv\">S</span>\u209b<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>\u6700\u8fd1<span class=\"nv\">k</span>\u4e2a\u6837\u672c\n<span class=\"mi\">2</span>.<span class=\"w\"> </span>\u957f\u671f\u7edf\u8ba1\uff1a<span class=\"nv\">S</span>\u2097<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>\u6307\u6570\u5e73\u6ed1\u5386\u53f2\n<span class=\"mi\">3</span>.<span class=\"w\"> </span>\u68c0\u6d4b\u53d8\u5316\uff1a<span class=\"nv\">D</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">d</span><span class=\"ss\">(</span><span class=\"nv\">S</span>\u209b,<span class=\"w\"> </span><span class=\"nv\">S</span>\u2097<span class=\"ss\">)</span>\n<span class=\"mi\">4</span>.<span class=\"w\"> </span>\u8c03\u6574\u9057\u5fd8\uff1a\n<span class=\"w\">   </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nv\">D</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"nv\">threshold</span>:\n<span class=\"w\">     </span>\u03b3<span class=\"w\"> </span>\u2190<span class=\"w\"> </span><span class=\"nv\">max</span><span class=\"ss\">(</span>\u03b3<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span>\u03b4,<span class=\"w\"> </span>\u03b3\u2098\u1d62\u2099<span class=\"ss\">)</span><span class=\"w\">  </span>#<span class=\"w\"> </span>\u52a0\u5feb\u9057\u5fd8\n<span class=\"w\">   </span><span class=\"k\">else</span>:\n<span class=\"w\">     </span>\u03b3<span class=\"w\"> </span>\u2190<span class=\"w\"> </span><span class=\"nv\">min</span><span class=\"ss\">(</span>\u03b3<span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span>\u03b4,<span class=\"w\"> </span>\u03b3\u2098\u2090\u2093<span class=\"ss\">)</span><span class=\"w\">  </span>#<span class=\"w\"> </span>\u51cf\u6162\u9057\u5fd8\n</code></pre></div>\n\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\u5728\u5206\u6bb5\u5e73\u7a33\u5047\u8bbe\u4e0b\uff0c\u81ea\u9002\u5e94\u7b97\u6cd5\u8fbe\u5230\n$$\\text{Regret} \\leq O(\\sqrt{T(1 + N_c)})$$\n\u5176\u4e2d$N_c$\u662f\u53d8\u5316\u70b9\u6570\u91cf\u3002</p>\n<h3 id=\"1353\">13.5.3 \u6ed1\u52a8\u7a97\u53e3\u6280\u672f</h3>\n<p>\u4fdd\u6301\u56fa\u5b9a\u5927\u5c0f$W$\u7684\u6570\u636e\u7a97\u53e3\uff1a</p>\n<p><strong>\u7cbe\u786e\u6ed1\u7a97SVD</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u6570\u636e\u7ed3\u6784\uff1a\u5faa\u73af\u7f13\u51b2\u533a\u5b58\u50a8\u6700\u8fd1W\u4e2a\u6837\u672c\n\u66f4\u65b0\u7b56\u7565\uff1a\n1. \u52a0\u5165\u65b0\u6837\u672c\uff1a\u79e91\u66f4\u65b0\n2. \u79fb\u9664\u65e7\u6837\u672c\uff1a\u79e91\u964d\u7ea7\uff08downdating\uff09\n3. \u5468\u671f\u6027\u4ece\u5934\u8ba1\u7b97\u4ee5\u63a7\u5236\u8bef\u5dee\u7d2f\u79ef\n</code></pre></div>\n\n<p><strong>\u8fd1\u4f3c\u6ed1\u7a97\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>Sketching\uff1a\u7ef4\u62a4\u6570\u636e\u7684\u7ebf\u6027\u8349\u56fe</li>\n<li>\u91c7\u6837\uff1a\u6982\u7387\u4fdd\u7559\u5386\u53f2\u6837\u672c</li>\n<li>\u5206\u5c42\uff1a\u591a\u5206\u8fa8\u7387\u65f6\u95f4\u8868\u793a</li>\n</ul>\n<h3 id=\"1354\">13.5.4 \u591a\u5c3a\u5ea6\u9057\u5fd8</h3>\n<p>\u4e0d\u540c\u5947\u5f02\u5411\u91cf\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u65f6\u95f4\u5c3a\u5ea6\uff1a</p>\n<p><strong>\u6a21\u578b</strong>\uff1a\n$$\\mathbf{u}_i(t) = \\gamma_i \\mathbf{u}_i(t-1) + \\text{update}$$</p>\n<p>\u5176\u4e2d$\\gamma_i$\u4f9d\u8d56\u4e8e\u7b2c$i$\u4e2a\u6a21\u5f0f\u7684\u7a33\u5b9a\u6027\u3002</p>\n<p><strong>\u81ea\u52a8\u5c3a\u5ea6\u53d1\u73b0</strong>\uff1a</p>\n<ol>\n<li>\u76d1\u63a7\u6bcf\u4e2a\u5947\u5f02\u5411\u91cf\u7684\u53d8\u5316\u7387</li>\n<li>\u7a33\u5b9a\u6a21\u5f0f\uff1a\u5927$\\gamma_i$\uff08\u6162\u9057\u5fd8\uff09</li>\n<li>\u5feb\u53d8\u6a21\u5f0f\uff1a\u5c0f$\\gamma_i$\uff08\u5feb\u9057\u5fd8\uff09</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u8fde\u7eed\u65f6\u95f4\u9057\u5fd8\u8fc7\u7a0b\u7684SDE\u5efa\u6a21</li>\n<li>\u9057\u5fd8\u673a\u5236\u7684\u4fe1\u606f\u8bba\u5206\u6790</li>\n<li>\u4e0e\u6301\u7eed\u5b66\u4e60(continual learning)\u7684\u7edf\u4e00\u6846\u67b6</li>\n</ul>\n<h2 id=\"136\">13.6 \u4e0e\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u7684\u8054\u7cfb</h2>\n<h3 id=\"1361\">13.6.1 \u6743\u91cd\u77e9\u9635\u7684\u52a8\u6001\u4f4e\u79e9\u5206\u89e3</h3>\n<p>\u6df1\u5ea6\u7f51\u7edc\u4e2d\u7684\u6743\u91cd\u77e9\u9635$\\mathbf{W} \\in \\mathbb{R}^{m \\times n}$\u5e38\u5448\u73b0\u4f4e\u79e9\u7ed3\u6784\uff1a</p>\n<p><strong>\u5728\u7ebf\u538b\u7f29\u6846\u67b6</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff1a\n1. \u76d1\u63a7\u6743\u91cd\u77e9\u9635\u7684\u6709\u6548\u79e9\n2. \u5f53\u68c0\u6d4b\u5230\u4f4e\u79e9\u7ed3\u6784\u65f6\u5206\u89e3\uff1aW \u2248 UV^T\n3. \u7ee7\u7eed\u4ee5\u56e0\u5b50\u5f62\u5f0f\u8bad\u7ec3\n4. \u5468\u671f\u6027\u8bc4\u4f30\u662f\u5426\u9700\u8981\u8c03\u6574\u79e9\n</code></pre></div>\n\n<p><strong>\u4e0e\u526a\u679d\u7684\u5bf9\u6bd4</strong>\uff1a</p>\n<ul>\n<li>\u526a\u679d\uff1a\u79bb\u6563\u76840/1\u51b3\u7b56</li>\n<li>\u4f4e\u79e9\uff1a\u8fde\u7eed\u7684\u5b50\u7a7a\u95f4\u9009\u62e9</li>\n<li>\u7edf\u4e00\u89c6\u89d2\uff1a\u90fd\u5728\u51cf\u5c11\u6709\u6548\u81ea\u7531\u5ea6</li>\n</ul>\n<h3 id=\"1362-svd\">13.6.2 \u589e\u91cfSVD\u7528\u4e8e\u5728\u7ebf\u538b\u7f29</h3>\n<p><strong>\u7b97\u6cd513.9</strong>\uff1a\u8bad\u7ec3\u65f6\u52a8\u6001\u538b\u7f29</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"err\">\u6bcf</span><span class=\"n\">E\u4e2aepoch</span><span class=\"o\">:</span>\n<span class=\"mi\">1</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u5bf9\u5f53\u524d\u6743\u91cd</span><span class=\"n\">W\u8ba1\u7b97SVD</span>\n<span class=\"mi\">2</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u8bc4\u4f30\u80fd\u91cf\u5206\u5e03\u786e\u5b9a\u6709\u6548\u79e9</span><span class=\"n\">k</span>\n<span class=\"mi\">3</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u538b\u7f29\uff1a</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"err\">\u2190</span><span class=\"w\"> </span><span class=\"n\">U\u2096\u03a3\u2096V\u2096\u1d40</span>\n<span class=\"mi\">4</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u53ef\u9009\uff1a\u5207\u6362\u5230\u56e0\u5b50\u5f62\u5f0f\u7ee7\u7eed\u8bad\u7ec3</span>\n<span class=\"mi\">5</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u76d1\u63a7\u538b\u7f29\u5bf9\u6027\u80fd\u7684\u5f71\u54cd</span>\n</code></pre></div>\n\n<p><strong>\u5173\u952e\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u538b\u7f29\u65f6\u673a\uff1aloss\u5e73\u53f0\u671fvs.\u56fa\u5b9a\u5468\u671f</li>\n<li>\u79e9\u7684\u81ea\u9002\u5e94\uff1a\u57fa\u4e8e\u68af\u5ea6\u4fe1\u606f\u6216\u9a8c\u8bc1\u6027\u80fd</li>\n<li>\u4e0e\u4f18\u5316\u5668\u72b6\u6001\u7684\u534f\u8c03\uff08\u5982Adam\u7684\u52a8\u91cf\uff09</li>\n</ul>\n<h3 id=\"1363\">13.6.3 \u5f69\u7968\u5047\u8bf4\u7684\u4f4e\u79e9\u89c6\u89d2</h3>\n<p><strong>\u5f69\u7968\u5047\u8bf4</strong>\uff1a\u968f\u673a\u521d\u59cb\u5316\u7684\u7f51\u7edc\u5305\u542b\u80fd\u72ec\u7acb\u8bad\u7ec3\u5230\u540c\u7b49\u7cbe\u5ea6\u7684\u7a00\u758f\u5b50\u7f51\u7edc\u3002</p>\n<p><strong>\u4f4e\u79e9\u91cd\u8ff0</strong>\uff1a</p>\n<ul>\n<li>\u7a00\u758fmask $\\leftrightarrow$ \u4f4e\u79e9\u6295\u5f71</li>\n<li>\u5bfb\u627e\"\u4e2d\u5956\u5f69\u7968\" $\\leftrightarrow$ \u53d1\u73b0\u4e3b\u8981\u5b50\u7a7a\u95f4</li>\n<li>\u8fed\u4ee3\u526a\u679d $\\leftrightarrow$ \u6e10\u8fdb\u79e9\u51cf\u5c11</li>\n</ul>\n<p><strong>\u5b9e\u9a8c\u89c2\u5bdf</strong>\uff1a</p>\n<ol>\n<li>\u65e9\u671f\u8bad\u7ec3\u5feb\u901f\u5f62\u6210\u4f4e\u79e9\u7ed3\u6784</li>\n<li>\u540e\u671f\u8bad\u7ec3\u4e3b\u8981\u662f\u7ec6\u5316\u5df2\u6709\u7ed3\u6784</li>\n<li>\u4e0d\u540c\u5c42\u7684\u79e9\u6f14\u5316\u6a21\u5f0f\u4e0d\u540c</li>\n</ol>\n<h3 id=\"1364\">13.6.4 \u6301\u7eed\u5b66\u4e60\u4e2d\u7684\u5b50\u7a7a\u95f4\u7ba1\u7406</h3>\n<p>\u5728\u5e8f\u5217\u4efb\u52a1\u5b66\u4e60\u4e2d\u9632\u6b62\u9057\u5fd8\uff1a</p>\n<p><strong>\u7b56\u756513.1</strong>\uff1a\u6b63\u4ea4\u5b50\u7a7a\u95f4\u5206\u914d</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"err\">\u5bf9\u6bcf\u4e2a\u65b0\u4efb\u52a1</span><span class=\"n\">t</span><span class=\"o\">:</span>\n<span class=\"mi\">1</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u8bc6\u522b\u4e4b\u524d\u4efb\u52a1\u4f7f\u7528\u7684\u5b50\u7a7a\u95f4</span><span class=\"n\">U\u209a\u1d63\u2091\u1d65</span>\n<span class=\"mi\">2</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u5728\u6b63\u4ea4\u8865\u7a7a\u95f4\u4e2d\u5b66\u4e60\uff1a</span><span class=\"n\">U</span><span class=\"err\">\u22a5</span>\n<span class=\"mi\">3</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u5408\u5e76\uff1a</span><span class=\"n\">U\u209c\u2092\u209c\u2090\u2097</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">U\u209a\u1d63\u2091\u1d65</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">U\u2099\u2091w</span><span class=\"o\">]</span>\n<span class=\"mi\">4</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"err\">\u5f53\u7a7a\u95f4\u8017\u5c3d\u65f6\u538b\u7f29\u6216\u5408\u5e76</span>\n</code></pre></div>\n\n<p><strong>\u7b56\u756513.2</strong>\uff1a\u5f39\u6027\u6743\u91cd\u5de9\u56fa(EWC)\u7684\u4f4e\u79e9\u7248\u672c</p>\n<ul>\n<li>\u539f\u59cbEWC\uff1a\u4fdd\u62a4\u91cd\u8981\u53c2\u6570</li>\n<li>\u4f4e\u79e9EWC\uff1a\u4fdd\u62a4\u91cd\u8981\u5b50\u7a7a\u95f4</li>\n<li>\u8ba1\u7b97Fisher\u4fe1\u606f\u77e9\u9635\u7684\u4f4e\u79e9\u8fd1\u4f3c</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u4efb\u52a1\u76f8\u4f3c\u5ea6\u4e0e\u5b50\u7a7a\u95f4\u91cd\u53e0\u7684\u5173\u7cfb</li>\n<li>\u6700\u4f18\u5b50\u7a7a\u95f4\u5206\u914d\u7b56\u7565</li>\n<li>\u4e0e\u5143\u5b66\u4e60\u7684\u7406\u8bba\u8054\u7cfb</li>\n</ul>\n<h2 id=\"_2\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u7cfb\u7edf\u4ecb\u7ecd\u4e86\u52a8\u6001\u4f4e\u79e9\u8fd1\u4f3c\u7684\u7406\u8bba\u4e0e\u7b97\u6cd5\uff1a</p>\n<p><strong>\u6838\u5fc3\u6982\u5ff5</strong>\uff1a</p>\n<ol>\n<li><strong>\u6d41\u5f0fSVD\u66f4\u65b0</strong>\uff1aBrand\u7b97\u6cd5\u53ca\u5176\u53d8\u4f53\u5b9e\u73b0$O(nk)$\u590d\u6742\u5ea6\u7684\u589e\u91cf\u66f4\u65b0</li>\n<li><strong>\u81ea\u9002\u5e94\u79e9\u9009\u62e9</strong>\uff1a\u80fd\u91cf\u9608\u503c\u3001\u9884\u6d4b\u6a21\u578b\u3001\u8d1d\u53f6\u65af\u65b9\u6cd5\u5904\u7406\u6a21\u578b\u9009\u62e9</li>\n<li><strong>\u5728\u7ebf\u77e9\u9635\u8865\u5168</strong>\uff1a\u68af\u5ea6\u65b9\u6cd5\u3001Riemannian\u4f18\u5316\u5904\u7406\u6d41\u5f0f\u89c2\u6d4b</li>\n<li><strong>\u9057\u5fd8\u673a\u5236</strong>\uff1a\u6307\u6570\u8870\u51cf\u3001\u6ed1\u52a8\u7a97\u53e3\u3001\u81ea\u9002\u5e94\u9057\u5fd8\u5904\u7406\u6982\u5ff5\u6f02\u79fb</li>\n<li><strong>\u795e\u7ecf\u7f51\u7edc\u8054\u7cfb</strong>\uff1a\u4f4e\u79e9\u7ed3\u6784\u5728\u6df1\u5ea6\u5b66\u4e60\u538b\u7f29\u548c\u6301\u7eed\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</li>\n</ol>\n<p><strong>\u5173\u952e\u516c\u5f0f</strong>\uff1a</p>\n<ul>\n<li>Bunch-Nielsen\u66f4\u65b0\uff1a$\\mathbf{A}' = \\mathbf{A} + \\mathbf{c}\\mathbf{d}^T$\u7684SVD\u589e\u91cf\u8ba1\u7b97</li>\n<li>\u5728\u7ebfregret\u754c\uff1a$R_T \\leq O(k\\log T \\cdot \\sum_{j&gt;k}\\lambda_j)$</li>\n<li>\u9057\u5fd8\u56e0\u5b50\u66f4\u65b0\uff1a$\\mathbf{A}_t = \\gamma\\mathbf{A}_{t-1} + \\mathbf{x}_t\\mathbf{x}_t^T$</li>\n<li>\u80fd\u91cf\u4fdd\u7559\u51c6\u5219\uff1a$k^* = \\min{j : \\sum_{i=1}^j \\sigma_i^2 \\geq \\tau \\sum_i \\sigma_i^2}$</li>\n</ul>\n<p><strong>\u5b9e\u8df5\u8981\u70b9</strong>\uff1a</p>\n<ul>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u9700\u8981\u5468\u671f\u6027\u91cd\u6b63\u4ea4\u5316</li>\n<li>\u79e9\u9009\u62e9\u4e0e\u8ba1\u7b97\u8d44\u6e90\u7684\u6743\u8861</li>\n<li>\u975e\u5e73\u7a33\u73af\u5883\u9700\u8981\u81ea\u9002\u5e94\u673a\u5236</li>\n<li>\u5206\u5e03\u5f0f\u573a\u666f\u7684\u901a\u4fe1\u4f18\u5316</li>\n</ul>\n<h2 id=\"_3\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_4\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u989813.1</strong>\uff1a\u63a8\u5bfc\u79e9\u4e00\u66f4\u65b0\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\n\u7ed9\u5b9a$n \\times n$\u77e9\u9635\u7684SVD\u548c\u79e9\u4e00\u66f4\u65b0$\\mathbf{u}\\mathbf{v}^T$\uff0c\u8bc1\u660e\u66f4\u65b0\u540e\u7684SVD\u53ef\u5728$O(n^2)$\u65f6\u95f4\u5185\u8ba1\u7b97\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5229\u7528Woodbury\u77e9\u9635\u6052\u7b49\u5f0f\u548cSVD\u7684\u6270\u52a8\u7406\u8bba\u3002</p>\n</details>\n<p><strong>\u4e60\u989813.2</strong>\uff1a\u8bbe\u8ba1\u6ed1\u52a8\u7a97\u53e3SVD\u7b97\u6cd5\n\u5b9e\u73b0\u4fdd\u6301\u6700\u8fd1$W$\u4e2a\u6837\u672c\u7684\u7cbe\u786eSVD\uff0c\u5206\u6790\u6dfb\u52a0\u65b0\u6837\u672c\u548c\u5220\u9664\u65e7\u6837\u672c\u7684\u590d\u6742\u5ea6\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651downdating\u6280\u672f\u548c\u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898\u3002</p>\n</details>\n<p><strong>\u4e60\u989813.3</strong>\uff1a\u6bd4\u8f83\u4e0d\u540c\u9057\u5fd8\u56e0\u5b50\n\u5bf9\u4e8e$\\gamma \\in {0.9, 0.95, 0.99}$\uff0c\u8ba1\u7b97\u6709\u6548\u7a97\u53e3\u957f\u5ea6\uff0c\u5e76\u5206\u6790\u5176\u5bf9\u7a81\u53d8\u68c0\u6d4b\u7684\u5f71\u54cd\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u6709\u6548\u7a97\u53e3\u957f\u5ea6\u7ea6\u4e3a$1/(1-\\gamma)$\u3002</p>\n</details>\n<p><strong>\u4e60\u989813.4</strong>\uff1a\u5728\u7ebf\u77e9\u9635\u8865\u5168\u7684\u6536\u655b\u6027\n\u8bc1\u660e\u5728\u5f3a\u51f8\u5047\u8bbe\u4e0b\uff0c\u5728\u7ebf\u68af\u5ea6\u4e0b\u964d\u8fbe\u5230$O(\\log T)$ regret\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4f7f\u7528\u5728\u7ebf\u51f8\u4f18\u5316\u7684\u6807\u51c6\u5206\u6790\u6280\u672f\u3002</p>\n</details>\n<h3 id=\"_5\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u989813.5</strong>\uff1a\u975e\u5747\u5300\u91c7\u6837\u7684\u504f\u5dee\u6821\u6b63\n\u5728\u77e9\u9635\u8865\u5168\u4e2d\uff0c\u82e5\u4f4d\u7f6e$(i,j)$\u4ee5\u6982\u7387$p_{ij}$\u88ab\u89c2\u6d4b\uff0c\u8bbe\u8ba1\u65e0\u504f\u4f30\u8ba1\u7b97\u6cd5\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4f7f\u7528\u91cd\u8981\u6027\u91c7\u6837\u548cinverse propensity weighting\u3002</p>\n</details>\n<p><strong>\u4e60\u989813.6</strong>\uff1a\u591a\u5c3a\u5ea6\u9057\u5fd8\u7684\u6700\u4f18\u6027\n\u8bc1\u660e\u5bf9\u4e8e\u5206\u5c42\u65f6\u95f4\u5e8f\u5217\u6570\u636e\uff0c\u591a\u5c3a\u5ea6\u9057\u5fd8\u4f18\u4e8e\u5355\u4e00\u9057\u5fd8\u56e0\u5b50\u3002\u6784\u9020\u5177\u4f53\u53cd\u4f8b\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u5305\u542b\u5feb\u53d8\u548c\u6162\u53d8\u6210\u5206\u7684\u5408\u6210\u6570\u636e\u3002</p>\n</details>\n<p><strong>\u4e60\u989813.7</strong>\uff1a\u5206\u5e03\u5f0f\u6d41\u5f0fPCA\u7684\u901a\u4fe1\u4e0b\u754c\n$m$\u4e2a\u8282\u70b9\u89c2\u6d4b\u6570\u636e\u6d41\uff0c\u8bc1\u660e\u8fbe\u5230$\\epsilon$-\u8fd1\u4f3c\u9700\u8981$\\Omega(mk/\\epsilon)$\u901a\u4fe1\u91cf\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4f7f\u7528\u4fe1\u606f\u8bba\u4e0b\u754c\u548c\u901a\u4fe1\u590d\u6742\u5ea6\u7406\u8bba\u3002</p>\n</details>\n<p><strong>\u4e60\u989813.8</strong>\uff1a\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u7684\u7406\u8bba\u4fdd\u8bc1\n\u7ed9\u5b9a\u9884\u8bad\u7ec3\u7f51\u7edc\uff0c\u8bc1\u660e\u5b58\u5728\u79e9$k$\u5206\u89e3\u4f7f\u5f97\u7cbe\u5ea6\u635f\u5931\u4e0d\u8d85\u8fc7$\\epsilon$\uff0c\u5176\u4e2d$k$\u5982\u4f55\u4f9d\u8d56\u4e8e$\\epsilon$\uff1f</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u7ed3\u5408\u77e9\u9635\u6270\u52a8\u7406\u8bba\u548c\u795e\u7ecf\u7f51\u7edc\u7684Lipschitz\u6027\u8d28\u3002</p>\n</details>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u8bef\u5dee\u7d2f\u79ef</strong>\uff1a\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u589e\u91cf\u7b97\u6cd5\u4f1a\u7d2f\u79ef\u820d\u5165\u8bef\u5dee\n   - \u89e3\u51b3\u65b9\u6848\uff1a\u5468\u671f\u6027\u4ece\u96f6\u5f00\u59cb\u91cd\u7b97\n   - \u76d1\u63a7\u6b63\u4ea4\u6027\uff1a\u68c0\u67e5$|\\mathbf{U}^T\\mathbf{U} - \\mathbf{I}|$</p>\n</li>\n<li>\n<p><strong>\u79e9\u7206\u70b8\u95ee\u9898</strong>\uff1a\u6ca1\u6709\u53ca\u65f6\u622a\u65ad\u4f1a\u5bfc\u81f4\u79e9\u4e0d\u65ad\u589e\u957f\n   - \u8bbe\u7f6e\u6700\u5927\u79e9\u9650\u5236\n   - \u4f7f\u7528\u80fd\u91cf\u9608\u503c\u81ea\u52a8\u622a\u65ad</p>\n</li>\n<li>\n<p><strong>\u9057\u5fd8\u56e0\u5b50\u9009\u62e9</strong>\uff1a\u56fa\u5b9a\u9057\u5fd8\u56e0\u5b50\u5728\u53d8\u5316\u73af\u5883\u4e0b\u8868\u73b0\u5dee\n   - \u4f7f\u7528\u81ea\u9002\u5e94\u65b9\u6cd5\n   - \u76d1\u63a7\u9884\u6d4b\u8bef\u5dee\u8c03\u6574</p>\n</li>\n<li>\n<p><strong>\u5e76\u53d1\u66f4\u65b0\u51b2\u7a81</strong>\uff1a\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u6570\u636e\u7ade\u4e89\n   - \u4f7f\u7528lock-free\u6570\u636e\u7ed3\u6784\n   - \u8bbe\u8ba1\u5f02\u6b65\u53cb\u597d\u7684\u7b97\u6cd5</p>\n</li>\n<li>\n<p><strong>\u521d\u59cb\u5316\u654f\u611f\u6027</strong>\uff1a\u5728\u7ebf\u7b97\u6cd5\u53ef\u80fd\u6536\u655b\u5230\u6b21\u4f18\u89e3\n   - \u4f7f\u7528\u591a\u6b21\u968f\u673a\u521d\u59cb\u5316\n   - \u501f\u9274\u79bb\u7ebf\u7b97\u6cd5\u7684\u521d\u59cb\u5316\u7b56\u7565</p>\n</li>\n</ol>\n<h2 id=\"_6\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_7\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u660e\u786e\u6570\u636e\u6d41\u7279\u6027\uff08\u5e73\u7a33\u6027\u3001\u5230\u8fbe\u7387\u3001\u566a\u58f0\u6c34\u5e73\uff09</li>\n<li>[ ] \u786e\u5b9a\u7cbe\u5ea6vs.\u6548\u7387\u7684\u6743\u8861\u70b9</li>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u79e9\u9009\u62e9\u7b56\u7565</li>\n<li>[ ] \u8bbe\u8ba1\u5f02\u5e38\u68c0\u6d4b\u548c\u6062\u590d\u673a\u5236</li>\n</ul>\n<h3 id=\"_8\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u6570\u503c\u7a33\u5b9a\u7684\u66f4\u65b0\u516c\u5f0f</li>\n<li>[ ] \u5b9e\u73b0\u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784\uff08\u5faa\u73af\u7f13\u51b2\u3001\u4f18\u5148\u961f\u5217\uff09</li>\n<li>[ ] \u6dfb\u52a0\u6b63\u4ea4\u6027\u68c0\u67e5\u548c\u81ea\u52a8\u4fee\u6b63</li>\n<li>[ ] \u652f\u6301checkpoint\u548c\u6062\u590d</li>\n</ul>\n<h3 id=\"_9\">\u8c03\u4f18\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u76d1\u63a7\u5173\u952e\u6307\u6807\uff08\u8fd1\u4f3c\u8bef\u5dee\u3001\u8ba1\u7b97\u65f6\u95f4\u3001\u5185\u5b58\u4f7f\u7528\uff09</li>\n<li>[ ] \u6839\u636e\u6570\u636e\u7279\u6027\u8c03\u6574\u8d85\u53c2\u6570</li>\n<li>[ ] \u8bc4\u4f30\u4e0d\u540c\u9057\u5fd8\u7b56\u7565\u7684\u6548\u679c</li>\n<li>[ ] \u6d4b\u8bd5\u6781\u7aef\u60c5\u51b5\uff08\u7a81\u53d8\u3001\u7f3a\u5931\u6570\u636e\uff09</li>\n</ul>\n<h3 id=\"_10\">\u90e8\u7f72\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u8bbe\u7f6e\u81ea\u52a8\u62a5\u8b66\u673a\u5236</li>\n<li>[ ] \u5b9e\u73b0\u4f18\u96c5\u964d\u7ea7\u7b56\u7565</li>\n<li>[ ] \u51c6\u5907\u79bb\u7ebf\u91cd\u7b97\u65b9\u6848</li>\n<li>[ ] \u8bb0\u5f55\u8be6\u7ec6\u65e5\u5fd7\u7528\u4e8e\u8c03\u8bd5</li>\n</ul>"
  },
  "../chapter7.md": {
    "hash": "8f949b6fb3e04239172f16728a3f2d54",
    "content": "<h1 id=\"7\">\u7b2c7\u7ae0\uff1a\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570</h1>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u968f\u673a\u5316\u6280\u672f\u5728\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u4e2d\u7684\u9769\u547d\u6027\u5e94\u7528\u3002\u6211\u4eec\u5c06\u4ece\u7406\u8bba\u57fa\u7840\u51fa\u53d1\uff0c\u5206\u6790\u968f\u673a\u5316\u7b97\u6cd5\u7684\u8bef\u5dee\u754c\uff0c\u63a2\u7d22\u5176\u5728\u5927\u89c4\u6a21\u8ba1\u7b97\u4e2d\u7684\u5b9e\u9645\u4f18\u52bf\uff0c\u5e76\u5c55\u671b\u91cf\u5b50\u8ba1\u7b97\u5e26\u6765\u7684\u65b0\u601d\u8def\u3002\u901a\u8fc7\u672c\u7ae0\u5b66\u4e60\uff0c\u60a8\u5c06\u638c\u63e1\u8bbe\u8ba1\u548c\u5206\u6790\u968f\u673a\u5316\u77e9\u9635\u7b97\u6cd5\u7684\u6838\u5fc3\u6280\u672f\uff0c\u7406\u89e3\u6982\u7387\u4fdd\u8bc1\u4e0e\u786e\u5b9a\u6027\u4fdd\u8bc1\u7684\u6743\u8861\uff0c\u5e76\u80fd\u591f\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u505a\u51fa\u660e\u667a\u7684\u7b97\u6cd5\u9009\u62e9\u3002</p>\n<h2 id=\"_1\">\u7ae0\u8282\u5927\u7eb2</h2>\n<h3 id=\"71\">7.1 \u5f15\u8a00\uff1a\u4e3a\u4ec0\u4e48\u9700\u8981\u968f\u673a\u5316\uff1f</h3>\n<ul>\n<li>\u786e\u5b9a\u6027\u7b97\u6cd5\u7684\u8ba1\u7b97\u74f6\u9888</li>\n<li>\u968f\u673a\u5316\u5e26\u6765\u7684\u8ba1\u7b97\u4f18\u52bf</li>\n<li>\u6982\u7387\u4fdd\u8bc1vs\u786e\u5b9a\u6027\u4fdd\u8bc1</li>\n<li>\u5728\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\u573a\u666f</li>\n</ul>\n<h3 id=\"72-svd\">7.2 \u968f\u673aSVD\u7684\u8bef\u5dee\u5206\u6790</h3>\n<ul>\n<li>7.2.1 \u968f\u673a\u6295\u5f71\u7684\u57fa\u672c\u539f\u7406</li>\n<li>7.2.2 \u5e42\u8fed\u4ee3\u4e0e\u7cbe\u5ea6\u63d0\u5347</li>\n<li>7.2.3 \u8bef\u5dee\u754c\u7684\u63a8\u5bfc\u4e0e\u610f\u4e49</li>\n<li>7.2.4 \u81ea\u9002\u5e94\u79e9\u9009\u62e9\u7b56\u7565</li>\n</ul>\n<h3 id=\"73-nystrom\">7.3 Nystr\u00f6m\u65b9\u6cd5\u7684\u73b0\u4ee3\u89c6\u89d2</h3>\n<ul>\n<li>7.3.1 \u4ece\u6838\u65b9\u6cd5\u5230\u4e00\u822c\u77e9\u9635\u8fd1\u4f3c</li>\n<li>7.3.2 \u5217\u91c7\u6837\u7b56\u7565\uff1a\u5747\u5300vs\u6760\u6746\u5206\u6570</li>\n<li>7.3.3 Nystr\u00f6m\u4e0e\u968f\u673aSVD\u7684\u8054\u7cfb</li>\n<li>7.3.4 \u5728\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635\u4e0a\u7684\u5e94\u7528</li>\n</ul>\n<h3 id=\"74\">7.4 \u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</h3>\n<ul>\n<li>7.4.1 \u7a00\u758f\u5316\u9884\u6761\u4ef6\u5b50</li>\n<li>7.4.2 \u968f\u673a\u5316\u4e0d\u5b8c\u5168\u5206\u89e3</li>\n<li>7.4.3 \u591a\u7ea7\u9884\u6761\u4ef6\u5b50\u7684\u968f\u673a\u6784\u9020</li>\n<li>7.4.4 \u5728\u8fed\u4ee3\u6c42\u89e3\u5668\u4e2d\u7684\u96c6\u6210</li>\n</ul>\n<h3 id=\"75\">7.5 \u91cf\u5b50\u542f\u53d1\u7684\u91c7\u6837\u7b56\u7565</h3>\n<ul>\n<li>7.5.1 \u91cf\u5b50\u6001\u91c7\u6837\u7684\u7ecf\u5178\u6a21\u62df</li>\n<li>7.5.2 \u91cd\u8981\u6027\u91c7\u6837\u7684\u65b0\u89c6\u89d2</li>\n<li>7.5.3 \u77e9\u9635\u5143\u7d20\u7684\u9ad8\u6548\u4f30\u8ba1</li>\n<li>7.5.4 \u4e0e\u4f20\u7edf\u8499\u7279\u5361\u7f57\u65b9\u6cd5\u7684\u5bf9\u6bd4</li>\n</ul>\n<hr />\n<h2 id=\"76\">7.6 \u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u7cfb\u7edf\u63a2\u8ba8\u4e86\u968f\u673a\u5316\u6280\u672f\u5728\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u4e2d\u7684\u9769\u547d\u6027\u5e94\u7528\u3002\u4ece\u7406\u8bba\u57fa\u7840\u5230\u5b9e\u9645\u7b97\u6cd5\uff0c\u4ece\u7ecf\u5178\u65b9\u6cd5\u5230\u91cf\u5b50\u542f\u53d1\uff0c\u6211\u4eec\u89c1\u8bc1\u4e86\u6982\u7387\u601d\u7ef4\u5982\u4f55\u4e3a\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u5f00\u8f9f\u65b0\u9053\u8def\u3002</p>\n<h3 id=\"_2\">\u6838\u5fc3\u6982\u5ff5\u56de\u987e</h3>\n<ol>\n<li>\n<p><strong>\u968f\u673a\u5316\u7684\u672c\u8d28\u4f18\u52bf</strong>\n- <strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u964d\u4f4e</strong>\uff1a\u4ece $\\mathcal{O}(n^3)$ \u964d\u81f3 $\\mathcal{O}(n^2k)$ \u6216\u66f4\u4f4e\n- <strong>\u6982\u7387\u4fdd\u8bc1\u8db3\u591f\u5f3a</strong>\uff1a\u5931\u8d25\u6982\u7387\u53ef\u63a7\u5236\u5728 $10^{-10}$ \u4ee5\u4e0b\n- <strong>\u5e76\u884c\u6027\u5929\u7136\u826f\u597d</strong>\uff1a\u968f\u673a\u7b97\u6cd5\u6613\u4e8e\u5206\u5e03\u5f0f\u5b9e\u73b0\n- <strong>\u81ea\u9002\u5e94\u80fd\u529b\u5f3a</strong>\uff1a\u53ef\u6839\u636e\u7cbe\u5ea6\u9700\u6c42\u52a8\u6001\u8c03\u6574</p>\n</li>\n<li>\n<p><strong>\u5173\u952e\u6280\u672f\u603b\u7ed3</strong></p>\n</li>\n</ol>\n<p>| \u6280\u672f | \u6838\u5fc3\u601d\u60f3 | \u6700\u4f73\u5e94\u7528\u573a\u666f | \u590d\u6742\u5ea6 |</p>\n<table>\n<thead>\n<tr>\n<th>\u6280\u672f</th>\n<th>\u6838\u5fc3\u601d\u60f3</th>\n<th>\u6700\u4f73\u5e94\u7528\u573a\u666f</th>\n<th>\u590d\u6742\u5ea6</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u968f\u673aSVD</td>\n<td>\u968f\u673a\u6295\u5f71+\u5b50\u7a7a\u95f4\u8fed\u4ee3</td>\n<td>\u4f4e\u79e9\u8fd1\u4f3c\u3001PCA</td>\n<td>$\\mathcal{O}(mnk + nk^2)$</td>\n</tr>\n<tr>\n<td>Nystr\u00f6m\u65b9\u6cd5</td>\n<td>\u5217\u91c7\u6837+\u6269\u5c55</td>\n<td>\u6838\u77e9\u9635\u3001\u56fe\u62c9\u666e\u62c9\u65af</td>\n<td>$\\mathcal{O}(n\\ell^2 + n\\ell k)$</td>\n</tr>\n<tr>\n<td>\u968f\u673a\u9884\u6761\u4ef6\u5b50</td>\n<td>\u7a00\u758f\u5316+\u6982\u7387\u4fee\u6b63</td>\n<td>\u8fed\u4ee3\u6c42\u89e3\u5668\u52a0\u901f</td>\n<td>$\\mathcal{O}(n\\log n)$</td>\n</tr>\n<tr>\n<td>\u91cf\u5b50\u542f\u53d1\u91c7\u6837</td>\n<td>\u91cd\u8981\u6027\u91c7\u6837+\u76f8\u5173\u6027</td>\n<td>\u77e9\u9635\u51fd\u6570\u4f30\u8ba1</td>\n<td>\u95ee\u9898\u76f8\u5173</td>\n</tr>\n</tbody>\n</table>\n<ol start=\"3\">\n<li><strong>\u7406\u8bba\u4fdd\u8bc1\u7684\u7edf\u4e00\u6846\u67b6</strong></li>\n</ol>\n<p>\u5927\u591a\u6570\u968f\u673a\u5316\u7b97\u6cd5\u7684\u8bef\u5dee\u754c\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a\n$$\\mathbb{P}[\\text{\u8bef\u5dee} \\leq (1+\\epsilon) \\cdot \\text{\u6700\u4f18\u8bef\u5dee}] \\geq 1 - \\delta$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\epsilon$\uff1a\u76f8\u5bf9\u8bef\u5dee\u5bb9\u5fcd\u5ea6</li>\n<li>$\\delta$\uff1a\u5931\u8d25\u6982\u7387</li>\n<li>\u91c7\u6837\u590d\u6742\u5ea6\u901a\u5e38\u4e3a $\\mathcal{O}(\\text{poly}(k, 1/\\epsilon, \\log(1/\\delta)))$</li>\n</ul>\n<h3 id=\"_3\">\u5b9e\u8df5\u7ecf\u9a8c\u603b\u7ed3</h3>\n<ol>\n<li>\n<p><strong>\u7b97\u6cd5\u9009\u62e9\u6307\u5357</strong>\n- <strong>\u6570\u636e\u7279\u5f81\u51b3\u5b9a\u65b9\u6cd5</strong>\uff1a\n  - \u5feb\u901f\u8870\u51cf\u8c31 \u2192 \u57fa\u672c\u968f\u673aSVD\n  - \u7f13\u6162\u8870\u51cf\u8c31 \u2192 \u5e26\u5e42\u8fed\u4ee3\u7684\u968f\u673aSVD\n  - \u7a00\u758f\u7ed3\u6784 \u2192 Nystr\u00f6m\u65b9\u6cd5\n  - \u7279\u6b8a\u7ed3\u6784\uff08\u5982PSD\uff09 \u2192 \u5b9a\u5236\u5316\u65b9\u6cd5</p>\n</li>\n<li>\n<p><strong>\u53c2\u6570\u8c03\u4f18\u539f\u5219</strong>\n- <strong>\u8fc7\u91c7\u6837\u53c2\u6570</strong>\uff1a$p = 5-10$ \u9002\u7528\u4e8e\u5927\u591a\u6570\u60c5\u51b5\n- <strong>\u5e42\u8fed\u4ee3\u6b21\u6570</strong>\uff1a$q = 1-2$ \u901a\u5e38\u8db3\u591f\n- <strong>\u91c7\u6837\u7b56\u7565</strong>\uff1a\u6760\u6746\u5206\u6570 &gt; \u91cd\u8981\u6027\u91c7\u6837 &gt; \u5747\u5300\u91c7\u6837</p>\n</li>\n<li>\n<p><strong>\u5b9e\u73b0\u8981\u70b9</strong>\n- <strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\u4f7f\u7528QR\u5206\u89e3\u800c\u975eGram-Schmidt\n- <strong>\u5185\u5b58\u6548\u7387</strong>\uff1a\u6d41\u5f0f\u5904\u7406\u548c\u5206\u5757\u6280\u672f\n- <strong>\u5e76\u884c\u5316</strong>\uff1a\u5145\u5206\u5229\u7528BLAS 3\u7ea7\u64cd\u4f5c</p>\n</li>\n</ol>\n<h3 id=\"_4\">\u4e0e\u5176\u4ed6\u7ae0\u8282\u7684\u8054\u7cfb</h3>\n<ol>\n<li>\n<p><strong>\u4e0e\u7b2c2\u7ae0\uff08Hessian\u8fd1\u4f3c\uff09\u7684\u8054\u7cfb</strong>\n- \u968f\u673a\u5316\u6280\u672f\u53ef\u52a0\u901fHessian-vector\u79ef\u8ba1\u7b97\n- \u4f4e\u79e9\u8fd1\u4f3c\u9002\u7528\u4e8equasi-Newton\u65b9\u6cd5\n- \u968f\u673a\u91c7\u6837\u6539\u8fdbBFGS\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u4e0e\u7b2c6\u7ae0\uff08\u77e9\u9635Sketching\uff09\u7684\u534f\u540c</strong>\n- Sketching\u662f\u968f\u673a\u6295\u5f71\u7684\u7279\u4f8b\n- \u4e24\u8005\u53ef\u7ec4\u5408\u4f7f\u7528\u83b7\u5f97\u66f4\u597d\u6548\u679c\n- \u7406\u8bba\u5de5\u5177\u76f8\u4e92\u501f\u9274</p>\n</li>\n<li>\n<p><strong>\u4e0e\u7b2c8\u7ae0\uff08\u5206\u5e03\u5f0f\u8ba1\u7b97\uff09\u7684\u7ed3\u5408</strong>\n- \u968f\u673a\u5316\u51cf\u5c11\u901a\u4fe1\u9700\u6c42\n- \u6982\u7387\u7b97\u6cd5\u66f4\u5bb9\u9519\n- \u5f02\u6b65\u66f4\u65b0\u7684\u7406\u8bba\u57fa\u7840</p>\n</li>\n</ol>\n<h3 id=\"_5\">\u524d\u6cbf\u7814\u7a76\u65b9\u5411</h3>\n<ol>\n<li>\n<p><strong>\u7406\u8bba\u7a81\u7834\u70b9</strong>\n- <strong>\u4e0b\u754c\u7406\u8bba</strong>\uff1a\u4f55\u65f6\u968f\u673a\u5316\u662f\u5fc5\u8981\u7684\uff1f\n- <strong>\u6700\u4f18\u91c7\u6837</strong>\uff1a\u4fe1\u606f\u8bba\u89c6\u89d2\u7684\u91c7\u6837\u7b56\u7565\n- <strong>\u53bb\u968f\u673a\u5316</strong>\uff1a\u5c06\u968f\u673a\u7b97\u6cd5\u8f6c\u5316\u4e3a\u786e\u5b9a\u6027\u7b97\u6cd5</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u521b\u65b0</strong>\n- <strong>\u81ea\u9002\u5e94\u7b97\u6cd5</strong>\uff1a\u673a\u5668\u5b66\u4e60\u6307\u5bfc\u7684\u53c2\u6570\u9009\u62e9\n- <strong>\u6df7\u5408\u65b9\u6cd5</strong>\uff1a\u968f\u673a\u5316\u4e0e\u786e\u5b9a\u6027\u65b9\u6cd5\u7684\u6700\u4f18\u7ec4\u5408\n- <strong>\u65b0\u578b\u968f\u673a\u77e9\u9635</strong>\uff1a\u7ed3\u6784\u5316\u968f\u673a\u6295\u5f71\u7684\u8bbe\u8ba1</p>\n</li>\n<li>\n<p><strong>\u5e94\u7528\u62d3\u5c55</strong>\n- <strong>\u91cf\u5b50-\u7ecf\u5178\u6df7\u5408</strong>\uff1aNISQ\u8bbe\u5907\u7684\u5b9e\u9645\u5e94\u7528\n- <strong>\u751f\u7269\u542f\u53d1\u7b97\u6cd5</strong>\uff1a\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u968f\u673a\u8ba1\u7b97\n- <strong>\u5728\u7ebf\u5b66\u4e60</strong>\uff1a\u6d41\u6570\u636e\u7684\u589e\u91cf\u968f\u673a\u7b97\u6cd5</p>\n</li>\n</ol>\n<h3 id=\"_6\">\u5173\u952e\u516c\u5f0f\u6c47\u603b</h3>\n<ol>\n<li>\n<p><strong>\u968f\u673aSVD\u8bef\u5dee\u754c</strong>\uff1a\n$$\\mathbb{E}[|\\mathbf{A} - \\tilde{\\mathbf{A}}_k|_F] \\leq \\left(1 + \\frac{k}{p-1}\\right)^{1/2}|\\mathbf{A} - \\mathbf{A}_k|_F$$</p>\n</li>\n<li>\n<p><strong>Nystr\u00f6m\u8fd1\u4f3c</strong>\uff1a\n$$\\tilde{\\mathbf{K}} = \\mathbf{C}\\mathbf{W}^{\\dagger}\\mathbf{C}^T$$</p>\n</li>\n<li>\n<p><strong>\u8c31\u7a00\u758f\u5316\u6761\u4ef6</strong>\uff1a\n$$(1-\\epsilon)\\mathbf{A} \\preceq \\mathbf{M} \\preceq (1+\\epsilon)\\mathbf{A}$$</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u542f\u53d1\u91c7\u6837\u6982\u7387</strong>\uff1a\n$$p_{ij} = \\frac{|a_{ij}|^2}{|\\mathbf{A}|_F^2}$$</p>\n</li>\n</ol>\n<h3 id=\"_7\">\u672c\u7ae0\u8981\u70b9</h3>\n<p>\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u4e0d\u4ec5\u662f\u4e00\u5957\u6280\u672f\u5de5\u5177\uff0c\u66f4\u662f\u4e00\u79cd\u601d\u7ef4\u65b9\u5f0f\u3002\u5b83\u6559\u4f1a\u6211\u4eec\uff1a</p>\n<ol>\n<li><strong>\u62e5\u62b1\u4e0d\u786e\u5b9a\u6027</strong>\uff1a\u6982\u7387\u4fdd\u8bc1\u5728\u5b9e\u8df5\u4e2d\u5f80\u5f80\u8db3\u591f</li>\n<li><strong>\u5229\u7528\u95ee\u9898\u7ed3\u6784</strong>\uff1a\u968f\u673a\u5316\u653e\u5927\u4e86\u7ed3\u6784\u4fe1\u606f</li>\n<li><strong>\u6743\u8861\u7cbe\u5ea6\u4e0e\u6548\u7387</strong>\uff1a\u9002\u5ea6\u7684\u7cbe\u5ea6\u635f\u5931\u6362\u6765\u5de8\u5927\u7684\u6548\u7387\u63d0\u5347</li>\n<li><strong>\u8de8\u5b66\u79d1\u501f\u9274</strong>\uff1a\u4ece\u91cf\u5b50\u7269\u7406\u5230\u7edf\u8ba1\u5b66\u7684\u667a\u6167</li>\n</ol>\n<p>\u638c\u63e1\u8fd9\u4e9b\u6280\u672f\uff0c\u60a8\u5c06\u80fd\u591f\u5904\u7406\u4f20\u7edf\u65b9\u6cd5\u65e0\u6cd5\u4f01\u53ca\u7684\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u4e3a\u73b0\u4ee3\u6570\u636e\u79d1\u5b66\u548c\u4eba\u5de5\u667a\u80fd\u5e94\u7528\u63d0\u4f9b\u5f3a\u5927\u7684\u8ba1\u7b97\u652f\u6301\u3002</p>\n<hr />\n<h2 id=\"77\">7.7 \u7ec3\u4e60\u9898</h2>\n<p>\u672c\u8282\u5305\u542b8\u9053\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u7ec3\u4e60\u9898\uff0c\u6db5\u76d6\u57fa\u7840\u7406\u89e3\u3001\u7b97\u6cd5\u5b9e\u73b0\u3001\u7406\u8bba\u5206\u6790\u548c\u5f00\u653e\u7814\u7a76\u7b49\u4e0d\u540c\u5c42\u6b21\u3002</p>\n<h3 id=\"_8\">\u57fa\u7840\u9898\uff08\u7406\u89e3\u6982\u5ff5\uff09</h3>\n<p><strong>\u7ec3\u4e60 7.1</strong> \uff08\u968f\u673a\u6295\u5f71\u7684\u4fdd\u8ddd\u6027\uff09\n\u8bbe $\\mathbf{G} \\in \\mathbb{R}^{k \\times n}$ \u662f\u968f\u673a\u9ad8\u65af\u77e9\u9635\uff0c\u5176\u5143\u7d20 $g_{ij} \\sim \\mathcal{N}(0, 1/k)$\u3002\u8bc1\u660e\u5bf9\u4e8e\u4efb\u610f\u5411\u91cf $\\mathbf{x} \\in \\mathbb{R}^n$\uff0c\u6709\uff1a\n$$\\mathbb{E}[|\\mathbf{Gx}|_2^2] = |\\mathbf{x}|_2^2$$\n\u5e76\u8ba1\u7b97 $\\text{Var}[|\\mathbf{Gx}|_2^2]$\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5229\u7528\u9ad8\u65af\u968f\u673a\u53d8\u91cf\u7684\u6027\u8d28\uff1a</p>\n<ul>\n<li>$\\mathbb{E}[g_{ij}] = 0$</li>\n<li>$\\mathbb{E}[g_{ij}^2] = 1/k$</li>\n<li>$(\\mathbf{Gx})_i = \\sum_{j=1}^n g_{ij}x_j$</li>\n</ul>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p><strong>\u8bc1\u660e\u671f\u671b</strong>\uff1a\n$$\\mathbb{E}[|\\mathbf{Gx}|_2^2] = \\mathbb{E}\\left[\\sum_{i=1}^k (\\mathbf{Gx})_i^2\\right] = \\sum_{i=1}^k \\mathbb{E}\\left[\\left(\\sum_{j=1}^n g_{ij}x_j\\right)^2\\right]$$\n\u7531\u4e8e $g_{ij}$ \u72ec\u7acb\u4e14 $\\mathbb{E}[g_{ij}] = 0$\uff1a\n$$\\mathbb{E}\\left[\\left(\\sum_{j=1}^n g_{ij}x_j\\right)^2\\right] = \\sum_{j=1}^n x_j^2 \\mathbb{E}[g_{ij}^2] = \\frac{1}{k}\\sum_{j=1}^n x_j^2$$\n\u56e0\u6b64\uff1a\n$$\\mathbb{E}[|\\mathbf{Gx}|_2^2] = k \\cdot \\frac{1}{k}|\\mathbf{x}|_2^2 = |\\mathbf{x}|_2^2$$\n<strong>\u8ba1\u7b97\u65b9\u5dee</strong>\uff1a\n\u5229\u7528 $\\text{Var}[Y] = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$ \u548c\u9ad8\u65af\u56db\u9636\u77e9\u516c\u5f0f\uff0c\u53ef\u5f97\uff1a\n$$\\text{Var}[|\\mathbf{Gx}|_2^2] = \\frac{2}{k}|\\mathbf{x}|_2^4$$\n\u8fd9\u8bf4\u660e\u5f53 $k$ \u589e\u5927\u65f6\uff0c\u96c6\u4e2d\u6027\u589e\u5f3a\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 7.2</strong> \uff08\u5e42\u8fed\u4ee3\u7684\u6548\u679c\u5206\u6790\uff09\n\u8bbe\u77e9\u9635 $\\mathbf{A}$ \u7684\u5947\u5f02\u503c\u4e3a $100, 90, 10, 1, 0.1$\u3002\u6bd4\u8f83\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u524d3\u4e2a\u5947\u5f02\u503c\u7684\u76f8\u5bf9\u5206\u79bb\u5ea6\uff1a\n(a) \u539f\u59cb\u77e9\u9635 $\\mathbf{A}$\n(b) $\\mathbf{AA}^T\\mathbf{A}$\uff08\u4e00\u6b21\u5e42\u8fed\u4ee3\uff09\n(c) $(\\mathbf{AA}^T)^2\\mathbf{A}$\uff08\u4e24\u6b21\u5e42\u8fed\u4ee3\uff09</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5e42\u8fed\u4ee3\u540e\uff0c\u5947\u5f02\u503c\u53d8\u4e3a $\\sigma_i^{2q+1}$\uff0c\u5176\u4e2d $q$ \u662f\u8fed\u4ee3\u6b21\u6570\u3002\u8ba1\u7b97\u76f8\u90bb\u5947\u5f02\u503c\u7684\u6bd4\u503c\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p><strong>(a) \u539f\u59cb\u77e9\u9635</strong>\uff1a</p>\n<ul>\n<li>$\\sigma_1/\\sigma_2 = 100/90 = 1.11$</li>\n<li>$\\sigma_2/\\sigma_3 = 90/10 = 9$</li>\n</ul>\n<p><strong>(b) \u4e00\u6b21\u5e42\u8fed\u4ee3</strong> ($\\sigma_i^3$)\uff1a</p>\n<ul>\n<li>$\\sigma_1^3/\\sigma_2^3 = (100/90)^3 = 1.37$</li>\n<li>$\\sigma_2^3/\\sigma_3^3 = (90/10)^3 = 729$</li>\n</ul>\n<p><strong>(c) \u4e24\u6b21\u5e42\u8fed\u4ee3</strong> ($\\sigma_i^5$)\uff1a</p>\n<ul>\n<li>$\\sigma_1^5/\\sigma_2^5 = (100/90)^5 = 1.69$</li>\n<li>$\\sigma_2^5/\\sigma_3^5 = (90/10)^5 = 59049$</li>\n</ul>\n<p>\u7ed3\u8bba\uff1a\u5e42\u8fed\u4ee3\u663e\u8457\u589e\u5f3a\u4e86\u5947\u5f02\u503c\u7684\u5206\u79bb\u5ea6\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u672c\u5c31\u6709\u8f83\u5927\u5dee\u8ddd\u7684\u5947\u5f02\u503c\u5bf9\u3002</p>\n</details>\n<h3 id=\"_9\">\u4e2d\u7ea7\u9898\uff08\u7b97\u6cd5\u5206\u6790\uff09</h3>\n<p><strong>\u7ec3\u4e60 7.3</strong> \uff08Nystr\u00f6m\u65b9\u6cd5\u7684\u8bef\u5dee\u5206\u6790\uff09\n\u7ed9\u5b9a\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635 $\\mathbf{K} \\in \\mathbb{R}^{n \\times n}$\uff0c\u4f7f\u7528Nystr\u00f6m\u65b9\u6cd5\u91c7\u6837 $\\ell$ \u5217\u5f97\u5230\u8fd1\u4f3c $\\tilde{\\mathbf{K}}$\u3002\u8bbe $\\mathbf{K}$ \u7684\u7279\u5f81\u503c\u4e3a $\\lambda_1 \\geq \\lambda_2 \\geq \\cdots \\geq \\lambda_n &gt; 0$\u3002</p>\n<p>(a) \u8bc1\u660e $\\tilde{\\mathbf{K}}$ \u4e5f\u662f\u534a\u6b63\u5b9a\u7684\n(b) \u5982\u679c\u91c7\u6837\u5305\u542b\u4e86\u524d $k$ \u4e2a\u7279\u5f81\u5411\u91cf\u5f20\u6210\u7a7a\u95f4\u7684\u4e00\u7ec4\u57fa\uff0c\u8bc1\u660e\uff1a\n$$|\\mathbf{K} - \\tilde{\\mathbf{K}}|_2 \\leq \\lambda_{k+1}$$</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>(a) \u5229\u7528 $\\tilde{\\mathbf{K}} = \\mathbf{CW}^{\\dagger}\\mathbf{C}^T$ \u7684\u5f62\u5f0f\n(b) \u8003\u8651 $\\mathbf{K}$ \u5728\u91c7\u6837\u5217\u7a7a\u95f4\u4e0a\u7684\u6295\u5f71</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p><strong>(a) \u534a\u6b63\u5b9a\u6027\u8bc1\u660e</strong>\uff1a\n\u7531\u4e8e $\\mathbf{K}$ \u662f\u6b63\u5b9a\u7684\uff0c\u5b50\u77e9\u9635 $\\mathbf{W} = \\mathbf{K}(\\mathcal{S}, \\mathcal{S})$ \u4e5f\u662f\u6b63\u5b9a\u7684\u3002\n\u5bf9\u4efb\u610f $\\mathbf{x} \\in \\mathbb{R}^n$\uff1a\n$$\\mathbf{x}^T\\tilde{\\mathbf{K}}\\mathbf{x} = \\mathbf{x}^T\\mathbf{C}\\mathbf{W}^{\\dagger}\\mathbf{C}^T\\mathbf{x} = |\\mathbf{W}^{\\dagger/2}\\mathbf{C}^T\\mathbf{x}|_2^2 \\geq 0$$\n<strong>(b) \u8bef\u5dee\u754c\u8bc1\u660e</strong>\uff1a\n\u8bbe $\\mathbf{V}_k$ \u662f\u524d $k$ \u4e2a\u7279\u5f81\u5411\u91cf\uff0c$\\mathbf{P}$ \u662f\u5230\u91c7\u6837\u5217\u7a7a\u95f4\u7684\u6295\u5f71\u3002\n\u7531\u5047\u8bbe\uff0c$\\text{span}(\\mathbf{V}_k) \\subseteq \\text{span}(\\mathbf{C})$\u3002</p>\n<p>Nystr\u00f6m\u8fd1\u4f3c\u5b9e\u9645\u4e0a\u662f $\\mathbf{K}$ \u5728 $\\text{span}(\\mathbf{C})$ \u4e0a\u7684\u6700\u4f73\u4f4e\u79e9\u8fd1\u4f3c\u3002\u56e0\u6b64\uff1a\n$$|\\mathbf{K} - \\tilde{\\mathbf{K}}|_2 = |\\mathbf{K} - \\mathbf{PKP}|_2 \\leq |\\mathbf{K} - \\mathbf{V}_k\\mathbf{V}_k^T\\mathbf{K}\\mathbf{V}_k\\mathbf{V}_k^T|_2 = \\lambda_{k+1}$$</p>\n</details>\n<p><strong>\u7ec3\u4e60 7.4</strong> \uff08\u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u7684\u6761\u4ef6\u6570\u5206\u6790\uff09\n\u8bbe $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ \u662f\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\uff0c\u6761\u4ef6\u6570 $\\kappa(\\mathbf{A}) = \\lambda_{\\max}/\\lambda_{\\min}$\u3002\u901a\u8fc7\u968f\u673a\u7a00\u758f\u5316\u5f97\u5230\u9884\u6761\u4ef6\u5b50 $\\mathbf{M}$\uff0c\u6ee1\u8db3\uff1a\n$$(1-\\epsilon)\\mathbf{A} \\preceq \\mathbf{M} \\preceq (1+\\epsilon)\\mathbf{A}$$\n\u8bc1\u660e\u4f7f\u7528 $\\mathbf{M}$ \u4f5c\u4e3a\u9884\u6761\u4ef6\u5b50\u540e\uff0c\u6761\u4ef6\u6570\u6ee1\u8db3\uff1a\n$$\\kappa(\\mathbf{M}^{-1}\\mathbf{A}) \\leq \\frac{1+\\epsilon}{1-\\epsilon}$$</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5229\u7528\u8c31\u4e0d\u7b49\u5f0f\u548cRayleigh\u5546\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u4ece\u8c31\u4e0d\u7b49\u5f0f\u51fa\u53d1\uff1a\n$$(1-\\epsilon)\\mathbf{A} \\preceq \\mathbf{M} \\preceq (1+\\epsilon)\\mathbf{A}$$\n\u53d6\u9006\uff08\u6ce8\u610f\u4e0d\u7b49\u53f7\u65b9\u5411\u6539\u53d8\uff09\uff1a\n$$\\frac{1}{1+\\epsilon}\\mathbf{A}^{-1} \\preceq \\mathbf{M}^{-1} \\preceq \\frac{1}{1-\\epsilon}\\mathbf{A}^{-1}$$\n\u56e0\u6b64\uff1a\n$$\\frac{1}{1+\\epsilon}\\mathbf{I} \\preceq \\mathbf{M}^{-1}\\mathbf{A} \\preceq \\frac{1}{1-\\epsilon}\\mathbf{I}$$\n\u8fd9\u610f\u5473\u7740 $\\mathbf{M}^{-1}\\mathbf{A}$ \u7684\u7279\u5f81\u503c\u90fd\u5728\u533a\u95f4 $[\\frac{1}{1+\\epsilon}, \\frac{1}{1-\\epsilon}]$ \u5185\u3002</p>\n<p>\u6240\u4ee5\uff1a\n$$\\kappa(\\mathbf{M}^{-1}\\mathbf{A}) = \\frac{\\lambda_{\\max}(\\mathbf{M}^{-1}\\mathbf{A})}{\\lambda_{\\min}(\\mathbf{M}^{-1}\\mathbf{A})} \\leq \\frac{1/(1-\\epsilon)}{1/(1+\\epsilon)} = \\frac{1+\\epsilon}{1-\\epsilon}$$\n\u6ce8\u610f\uff1a\u5f53 $\\epsilon$ \u5f88\u5c0f\u65f6\uff0c$\\frac{1+\\epsilon}{1-\\epsilon} \\approx 1 + 2\\epsilon$\u3002</p>\n</details>\n<h3 id=\"_10\">\u9ad8\u7ea7\u9898\uff08\u7406\u8bba\u6df1\u5165\uff09</h3>\n<p><strong>\u7ec3\u4e60 7.5</strong> \uff08\u81ea\u9002\u5e94\u91c7\u6837\u7684\u6700\u4f18\u6027\uff09\n\u8003\u8651\u77e9\u9635 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ \u7684\u5217\u91c7\u6837\u95ee\u9898\u3002\u5b9a\u4e49\u7b2c $j$ \u5217\u7684\"\u91cd\u8981\u6027\u5206\u6570\"\u4e3a\uff1a\n$$s_j = |\\mathbf{A}(:,j)|_2^2 + \\alpha \\cdot \\text{leverage}_j$$\n\u5176\u4e2d $\\text{leverage}_j$ \u662f\u7b2c $j$ \u5217\u7684\u6760\u6746\u5206\u6570\uff0c$\\alpha &gt; 0$ \u662f\u5e73\u8861\u53c2\u6570\u3002</p>\n<p>(a) \u63a8\u5bfc\u4f7f\u671f\u671b\u8bef\u5dee $\\mathbb{E}[|\\mathbf{A} - \\tilde{\\mathbf{A}}|_F^2]$ \u6700\u5c0f\u7684\u6700\u4f18 $\\alpha$ \u503c\n(b) \u8bc1\u660e\u8fd9\u79cd\u6df7\u5408\u91c7\u6837\u7b56\u7565\u4f18\u4e8e\u5355\u7eaf\u7684\u8303\u6570\u91c7\u6837\u6216\u6760\u6746\u5206\u6570\u91c7\u6837</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5efa\u7acb\u8bef\u5dee\u7684\u671f\u671b\u8868\u8fbe\u5f0f\uff0c\u5bf9 $\\alpha$ \u6c42\u5bfc\u3002\u8003\u8651\u6781\u7aef\u60c5\u51b5\u5206\u6790\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p><strong>(a) \u6700\u4f18 $\\alpha$ \u63a8\u5bfc</strong>\uff1a</p>\n<p>\u91c7\u6837\u6982\u7387\uff1a$p_j = s_j / \\sum_i s_i$</p>\n<p>\u671f\u671b\u8bef\u5dee\u53ef\u4ee5\u5206\u89e3\u4e3a\u4e24\u90e8\u5206\uff1a</p>\n<ol>\n<li>\u7531\u4e8e\u672a\u91c7\u6837\u5217\u5bfc\u81f4\u7684\u8bef\u5dee</li>\n<li>\u7531\u4e8e\u4f4e\u79e9\u8fd1\u4f3c\u5bfc\u81f4\u7684\u8bef\u5dee\n$$\\mathbb{E}[|\\mathbf{A} - \\tilde{\\mathbf{A}}|_F^2] = \\sum_{j \\not\\in \\mathcal{S}} |\\mathbf{A}(:,j)|_2^2 + \\text{\u4f4e\u79e9\u8fd1\u4f3c\u8bef\u5dee}$$\n\u4f4e\u79e9\u8fd1\u4f3c\u8bef\u5dee\u4e0e\u6760\u6746\u5206\u6570\u76f8\u5173\u3002\u901a\u8fc7\u53d8\u5206\u6cd5\u53ef\u5f97\u6700\u4f18 $\\alpha$\uff1a\n$$\\alpha^* = \\frac{\\sum_j |\\mathbf{A}(:,j)|_2^2 \\cdot (1 - \\text{leverage}_j)}{\\sum_j \\text{leverage}_j \\cdot (1 - |\\mathbf{A}(:,j)|_2^2/|\\mathbf{A}|_F^2)}$$\n<strong>(b) \u4f18\u8d8a\u6027\u8bc1\u660e</strong>\uff1a</li>\n</ol>\n<p>\u8003\u8651\u4e24\u4e2a\u6781\u7aef\u60c5\u51b5\uff1a</p>\n<p><strong>\u60c5\u51b51</strong>\uff1a\u77e9\u9635\u5217\u8303\u6570\u5dee\u5f02\u5f88\u5927\u4f46\u6760\u6746\u5206\u6570\u76f8\u8fd1</p>\n<ul>\n<li>\u7eaf\u6760\u6746\u5206\u6570\u91c7\u6837\uff1a\u53ef\u80fd\u9519\u8fc7\u5927\u8303\u6570\u5217</li>\n<li>\u6df7\u5408\u7b56\u7565\uff1a\u4ecd\u4f1a\u4f18\u5148\u91c7\u6837\u5927\u8303\u6570\u5217</li>\n</ul>\n<p><strong>\u60c5\u51b52</strong>\uff1a\u77e9\u9635\u5217\u8303\u6570\u76f8\u8fd1\u4f46\u67d0\u4e9b\u5217\u5bf9\u4f4e\u79e9\u7ed3\u6784\u66f4\u91cd\u8981</p>\n<ul>\n<li>\u7eaf\u8303\u6570\u91c7\u6837\uff1a\u65e0\u6cd5\u8bc6\u522b\u7ed3\u6784\u91cd\u8981\u6027</li>\n<li>\u6df7\u5408\u7b56\u7565\uff1a\u901a\u8fc7\u6760\u6746\u5206\u6570\u8bc6\u522b\u91cd\u8981\u5217</li>\n</ul>\n<p>\u6df7\u5408\u7b56\u7565\u5728\u4e24\u79cd\u60c5\u51b5\u4e0b\u90fd\u8868\u73b0\u826f\u597d\uff0c\u5b9e\u73b0\u4e86 robust performance\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 7.6</strong> \uff08\u91cf\u5b50\u542f\u53d1\u91c7\u6837\u7684\u7ecf\u5178\u590d\u6742\u5ea6\uff09\n\u91cf\u5b50\u7b97\u6cd5\u53ef\u4ee5\u5728 $\\mathcal{O}(\\text{polylog}(n))$ \u65f6\u95f4\u5185\u4ece\u5206\u5e03 $p_{ij} = |a_{ij}|^2/|\\mathbf{A}|_F^2$ \u91c7\u6837\u3002\u8bbe\u8ba1\u4e00\u4e2a\u7ecf\u5178\u7b97\u6cd5\u5b9e\u73b0\u7c7b\u4f3c\u91c7\u6837\uff0c\u5e76\u5206\u6790\u5176\u590d\u6742\u5ea6\u3002\u8981\u6c42\uff1a\n(a) \u9884\u5904\u7406\u65f6\u95f4 $\\mathcal{O}(n^2)$\n(b) \u6bcf\u6b21\u91c7\u6837\u65f6\u95f4 $\\mathcal{O}(\\log n)$\n(c) \u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^2)$</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u4f7f\u7528\u5206\u5c42\u6570\u636e\u7ed3\u6784\u548c\u4e8c\u5206\u641c\u7d22\u3002\u8003\u8651alias method\u6216binary indexed tree\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p><strong>\u7b97\u6cd5\u8bbe\u8ba1</strong>\uff1a\u4f7f\u7528\u4e8c\u7ef4Alias Method</p>\n<p><strong>\u9884\u5904\u7406\u9636\u6bb5</strong>\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u6bcf\u884c\u7684\u8303\u6570\u5e73\u65b9\uff1a$r_i = \\sum_j |a_{ij}|^2$</li>\n<li>\u6784\u5efa\u884c\u91c7\u6837\u7684Alias\u8868\uff1a\u57fa\u4e8e\u5206\u5e03 ${r_i/|\\mathbf{A}|_F^2}$</li>\n<li>\u5bf9\u6bcf\u884c $i$\uff0c\u6784\u5efa\u5217\u91c7\u6837\u7684Alias\u8868\uff1a\u57fa\u4e8e\u5206\u5e03 ${|a_{ij}|^2/r_i}$</li>\n</ol>\n<p>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n)$ + $n \\times \\mathcal{O}(n) = \\mathcal{O}(n^2)$</p>\n<p><strong>\u91c7\u6837\u9636\u6bb5</strong>\uff1a</p>\n<ol>\n<li>\u4f7f\u7528\u884cAlias\u8868\u91c7\u6837\u884c\u7d22\u5f15 $i$\uff1a$\\mathcal{O}(1)$</li>\n<li>\u4f7f\u7528\u7b2c $i$ \u884c\u7684\u5217Alias\u8868\u91c7\u6837\u5217\u7d22\u5f15 $j$\uff1a$\\mathcal{O}(1)$</li>\n</ol>\n<p>\u603b\u65f6\u95f4\uff1a$\\mathcal{O}(1)$\uff08\u6bd4\u8981\u6c42\u7684 $\\mathcal{O}(\\log n)$ \u66f4\u597d\uff09</p>\n<p><strong>\u7a7a\u95f4\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u884cAlias\u8868\uff1a$\\mathcal{O}(n)$</li>\n<li>$n$ \u4e2a\u5217Alias\u8868\uff1a$\\mathcal{O}(n^2)$</li>\n<li>\u603b\u7a7a\u95f4\uff1a$\\mathcal{O}(n^2)$</li>\n</ul>\n<p><strong>\u4f18\u5316\u7248\u672c</strong>\uff1a\u5982\u679c\u77e9\u9635\u7a00\u758f\uff0c\u53ef\u4ee5\u53ea\u5b58\u50a8\u975e\u96f6\u5143\u7d20\uff0c\u7a7a\u95f4\u964d\u81f3 $\\mathcal{O}(\\text{nnz})$\u3002</p>\n</details>\n<h3 id=\"_11\">\u5f00\u653e\u7814\u7a76\u9898</h3>\n<p><strong>\u7ec3\u4e60 7.7</strong> \uff08\u65b0\u578b\u968f\u673a\u6295\u5f71\u8bbe\u8ba1\uff09\n\u6807\u51c6\u968f\u673a\u6295\u5f71\u4f7f\u7528\u72ec\u7acb\u540c\u5206\u5e03\u7684\u77e9\u9635\u5143\u7d20\u3002\u7814\u7a76\u4ee5\u4e0b\u7ed3\u6784\u5316\u968f\u673a\u6295\u5f71\u7684\u6027\u8d28\uff1a\n$$\\mathbf{\\Omega} = \\mathbf{HD}_1\\mathbf{PD}_2$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathbf{H}$\uff1aHadamard\u77e9\u9635</li>\n<li>$\\mathbf{D}_1, \\mathbf{D}_2$\uff1a\u968f\u673a\u5bf9\u89d2\u7b26\u53f7\u77e9\u9635</li>\n<li>$\\mathbf{P}$\uff1a\u968f\u673a\u7f6e\u6362\u77e9\u9635</li>\n</ul>\n<p>\u63a2\u8ba8\uff1a\n(a) \u8fd9\u79cd\u7ed3\u6784\u5982\u4f55\u5f71\u54cd JL-\u5f15\u7406\u7684\u5e38\u6570\uff1f\n(b) \u8ba1\u7b97\u6548\u7387\u76f8\u6bd4\u6807\u51c6\u9ad8\u65af\u6295\u5f71\u7684\u63d0\u5347\n(c) \u5728\u7279\u5b9a\u77e9\u9635\u7c7b\u522b\u4e0a\u7684\u8868\u73b0\uff08\u5982\u7a00\u758f\u77e9\u9635\u3001Toeplitz\u77e9\u9635\uff09</p>\n<details>\n<summary>\u7814\u7a76\u65b9\u5411\u63d0\u793a</summary>\n<ol>\n<li>\u5206\u6790\u6295\u5f71\u7684\u7b49\u8ddd\u6027\u8d28</li>\n<li>\u5229\u7528\u5feb\u901fHadamard\u53d8\u6362</li>\n<li>\u8003\u8651\u4e0e\u8f93\u5165\u77e9\u9635\u7ed3\u6784\u7684\u76f8\u4e92\u4f5c\u7528</li>\n<li>\u5b9e\u9a8c\u9a8c\u8bc1\u7406\u8bba\u9884\u6d4b</li>\n</ol>\n</details>\n<p><strong>\u7ec3\u4e60 7.8</strong> \uff08\u81ea\u9002\u5e94\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\uff09\n\u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7b97\u6cd5\uff0c\u7ed3\u5408\u91cf\u5b50\u9000\u706b\u601d\u60f3\u548c\u7ecf\u5178\u4f18\u5316\uff0c\u7528\u4e8e\u77e9\u9635\u7684\u4f4e\u79e9\u5206\u89e3\u3002\u7b97\u6cd5\u5e94\u8be5\uff1a</p>\n<ul>\n<li>\u521d\u59cb\u9636\u6bb5\u8fdb\u884c\u5168\u5c40\u63a2\u7d22\uff08\u9ad8\"\u6e29\u5ea6\"\uff09</li>\n<li>\u9010\u6e10\u805a\u7126\u4e8e\u91cd\u8981\u7684\u5b50\u7a7a\u95f4\uff08\u964d\u6e29\u8fc7\u7a0b\uff09</li>\n<li>\u81ea\u52a8\u786e\u5b9a\u5408\u9002\u7684\u79e9</li>\n</ul>\n<p>\u63d0\u51fa\uff1a\n(a) \u6e29\u5ea6\u8c03\u5ea6\u7b56\u7565\n(b) \u63a2\u7d22\u4e0e\u5229\u7528\u7684\u5e73\u8861\u673a\u5236\n(c) \u6536\u655b\u6027\u5206\u6790\u6846\u67b6\n(d) \u4e0e\u73b0\u6709\u65b9\u6cd5\u7684\u5b9e\u9a8c\u6bd4\u8f83</p>\n<details>\n<summary>\u7814\u7a76\u65b9\u5411\u63d0\u793a</summary>\n<ol>\n<li>\u501f\u9274\u6a21\u62df\u9000\u706b\u548c\u91cf\u5b50\u9000\u706b\u7684\u7406\u8bba</li>\n<li>\u8bbe\u8ba1\u9002\u5408\u77e9\u9635\u95ee\u9898\u7684\"\u80fd\u91cf\u51fd\u6570\"</li>\n<li>\u8003\u8651\u5e76\u884c\u5316\u548c\u5206\u5e03\u5f0f\u5b9e\u73b0</li>\n<li>\u7406\u8bba\u5206\u6790\u53ef\u4ee5\u4ece\u9a6c\u5c14\u53ef\u592b\u94fe\u89d2\u5ea6\u5165\u624b</li>\n</ol>\n</details>\n<hr />\n<h2 id=\"78\">7.8 \u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<p>\u5728\u5b9e\u73b0\u548c\u5e94\u7528\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u7b97\u6cd5\u65f6\uff0c\u5373\u4f7f\u662f\u7ecf\u9a8c\u4e30\u5bcc\u7684\u4ece\u4e1a\u8005\u4e5f\u5bb9\u6613\u9677\u5165\u4e00\u4e9b\u9677\u9631\u3002\u672c\u8282\u603b\u7ed3\u4e86\u6700\u5e38\u89c1\u7684\u9519\u8bef\u53ca\u5176\u89e3\u51b3\u65b9\u6848\u3002</p>\n<h3 id=\"781\">7.8.1 \u6982\u7387\u4fdd\u8bc1\u7684\u8bef\u89e3</h3>\n<p><strong>\u9677\u96311\uff1a\u6df7\u6dc6\u671f\u671b\u8bef\u5dee\u548c\u9ad8\u6982\u7387\u754c</strong></p>\n<p>\u274c <strong>\u9519\u8bef\u7406\u89e3</strong>\uff1a\n\"\u7b97\u6cd5\u4fdd\u8bc1\u8bef\u5dee\u5c0f\u4e8e $\\epsilon$\"</p>\n<p>\u2705 <strong>\u6b63\u786e\u7406\u89e3</strong>\uff1a</p>\n<ul>\n<li>\u671f\u671b\u754c\uff1a$\\mathbb{E}[\\text{error}] \\leq \\epsilon$</li>\n<li>\u9ad8\u6982\u7387\u754c\uff1a$\\mathbb{P}[\\text{error} \\leq \\epsilon] \\geq 1 - \\delta$</li>\n</ul>\n<p><strong>\u5b9e\u9645\u5f71\u54cd</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u573a\u666f\uff1a\u4f7f\u7528\u968f\u673aSVD\u8fd1\u4f3c\u79e9-100\u7684\u77e9\u9635\n\u9519\u8bef\u505a\u6cd5\uff1a\u8fd0\u884c\u4e00\u6b21\uff0c\u5047\u8bbe\u7ed3\u679c\u6ee1\u8db3\u8bef\u5dee\u754c\n\u6b63\u786e\u505a\u6cd5\uff1a\n1. \u7406\u89e3\u8fd9\u662f\u6982\u7387\u4fdd\u8bc1\n2. \u591a\u6b21\u8fd0\u884c\u53d6\u6700\u4f73\uff08\u8fdb\u4e00\u6b65\u964d\u4f4e\u5931\u8d25\u6982\u7387\uff09\n3. \u6216\u4f7f\u7528\u8db3\u591f\u5927\u7684\u8fc7\u91c7\u6837\u53c2\u6570\u786e\u4fdd\u5355\u6b21\u6210\u529f\n</code></pre></div>\n\n<p><strong>\u9677\u96312\uff1a\u5ffd\u89c6\u5e38\u6570\u56e0\u5b50</strong></p>\n<p>\u274c <strong>\u9519\u8bef</strong>\uff1a\n\"\u968f\u673a\u7b97\u6cd5\u603b\u662f\u66f4\u5feb\"</p>\n<p>\u2705 <strong>\u6b63\u786e</strong>\uff1a\n\u968f\u673a\u7b97\u6cd5\u7684\u5b9e\u9645\u8fd0\u884c\u65f6\u95f4\u5305\u542b\u9690\u85cf\u5e38\u6570\u3002\u5bf9\u4e8e\u4e2d\u7b49\u89c4\u6a21\u95ee\u9898\uff0c\u786e\u5b9a\u6027\u7b97\u6cd5\u53ef\u80fd\u66f4\u5feb\u3002</p>\n<p><strong>\u7ecf\u9a8c\u6cd5\u5219</strong>\uff1a</p>\n<ul>\n<li>$n &lt; 1000$\uff1a\u8003\u8651\u786e\u5b9a\u6027\u7b97\u6cd5</li>\n<li>$1000 &lt; n &lt; 10000$\uff1a\u6839\u636e\u79e9\u548c\u7cbe\u5ea6\u8981\u6c42\u9009\u62e9</li>\n<li>$n &gt; 10000$\uff1a\u968f\u673a\u7b97\u6cd5\u901a\u5e38\u5360\u4f18</li>\n</ul>\n<h3 id=\"782\">7.8.2 \u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898</h3>\n<p><strong>\u9677\u96313\uff1a\u76f4\u63a5\u6b63\u4ea4\u5316\u7684\u6570\u503c\u95ee\u9898</strong></p>\n<p>\u274c <strong>\u4e0d\u7a33\u5b9a\u7684\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u8ba1\u7b97 Y = A\u03a9 \u540e\u7684\u6b63\u4ea4\u5316</span>\n<span class=\"n\">Q</span> <span class=\"o\">=</span> <span class=\"n\">Y</span>\n<span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">):</span>\n    <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">j</span><span class=\"p\">):</span>\n        <span class=\"n\">Q</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">-=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">Q</span><span class=\"p\">[:,</span> <span class=\"n\">i</span><span class=\"p\">],</span> <span class=\"n\">Q</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">])</span> <span class=\"o\">*</span> <span class=\"n\">Q</span><span class=\"p\">[:,</span> <span class=\"n\">i</span><span class=\"p\">]</span>\n    <span class=\"n\">Q</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">/=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">Q</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">])</span>\n</code></pre></div>\n\n<p>\u2705 <strong>\u7a33\u5b9a\u7684\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u4f7f\u7528QR\u5206\u89e3</span>\n<span class=\"n\">Q</span><span class=\"p\">,</span> <span class=\"n\">R</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">qr</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s1\">&#39;reduced&#39;</span><span class=\"p\">)</span>\n<span class=\"c1\"># \u6216\u4f7f\u7528SVD\u83b7\u5f97\u66f4\u597d\u7684\u6570\u503c\u6027\u8d28</span>\n<span class=\"n\">U</span><span class=\"p\">,</span> <span class=\"n\">S</span><span class=\"p\">,</span> <span class=\"n\">Vt</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">svd</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">full_matrices</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">Q</span> <span class=\"o\">=</span> <span class=\"n\">U</span>\n</code></pre></div>\n\n<p><strong>\u9677\u96314\uff1a\u5e42\u8fed\u4ee3\u4e2d\u7684\u6ea2\u51fa</strong></p>\n<p>\u274c <strong>\u95ee\u9898</strong>\uff1a\n\u8ba1\u7b97 $(\\mathbf{AA}^T)^q\\mathbf{A}\\mathbf{\\Omega}$ \u65f6\uff0c\u5947\u5f02\u503c $\\sigma_i^{2q+1}$ \u53ef\u80fd\u6ea2\u51fa</p>\n<p>\u2705 <strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u5728\u6bcf\u6b21\u8fed\u4ee3\u540e\u5f52\u4e00\u5316</span>\n<span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">@</span> <span class=\"n\">Omega</span>\n<span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">):</span>\n    <span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">A</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"o\">@</span> <span class=\"n\">Y</span>\n    <span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">Y</span> <span class=\"o\">/</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>  <span class=\"c1\"># \u5217\u5f52\u4e00\u5316</span>\n    <span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">@</span> <span class=\"n\">Y</span>\n    <span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">Y</span> <span class=\"o\">/</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<h3 id=\"783\">7.8.3 \u91c7\u6837\u7b56\u7565\u7684\u9519\u8bef</h3>\n<p><strong>\u9677\u96315\uff1a\u91c7\u6837\u6982\u7387\u7684\u6570\u503c\u95ee\u9898</strong></p>\n<p>\u274c <strong>\u9519\u8bef\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u57fa\u4e8e\u6760\u6746\u5206\u6570\u91c7\u6837</span>\n<span class=\"n\">probs</span> <span class=\"o\">=</span> <span class=\"n\">leverage_scores</span> <span class=\"o\">/</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">leverage_scores</span><span class=\"p\">)</span>\n<span class=\"c1\"># \u95ee\u9898\uff1a\u5982\u679c\u67d0\u4e9b\u5206\u6570\u975e\u5e38\u5c0f\uff0c\u5f52\u4e00\u5316\u540e\u53ef\u80fd\u4e3a0</span>\n</code></pre></div>\n\n<p>\u2705 <strong>\u6b63\u786e\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u6dfb\u52a0\u5c0f\u7684\u6b63\u5219\u5316\u9879</span>\n<span class=\"n\">epsilon</span> <span class=\"o\">=</span> <span class=\"mf\">1e-10</span>\n<span class=\"n\">probs</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">leverage_scores</span> <span class=\"o\">+</span> <span class=\"n\">epsilon</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">leverage_scores</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"n\">n</span> <span class=\"o\">*</span> <span class=\"n\">epsilon</span><span class=\"p\">)</span>\n<span class=\"c1\"># \u6216\u4f7f\u7528log\u7a7a\u95f4\u8ba1\u7b97\u907f\u514d\u4e0b\u6ea2</span>\n<span class=\"n\">log_probs</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"n\">leverage_scores</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">leverage_scores</span><span class=\"p\">))</span>\n</code></pre></div>\n\n<p><strong>\u9677\u96316\uff1a\u91cd\u590d\u91c7\u6837\u95ee\u9898</strong></p>\n<p>\u274c <strong>\u9519\u8bef</strong>\uff1a\n\u5141\u8bb8\u91cd\u590d\u91c7\u6837\u540c\u4e00\u5217/\u884c\u53ef\u80fd\u5bfc\u81f4\u5947\u5f02\u6027</p>\n<p>\u2705 <strong>\u6b63\u786e</strong>\uff1a</p>\n<ul>\n<li>\u65e0\u653e\u56de\u91c7\u6837\u7528\u4e8eNystr\u00f6m\u65b9\u6cd5</li>\n<li>\u6709\u653e\u56de\u91c7\u6837\u9700\u8981\u9002\u5f53\u7684\u6743\u91cd\u8c03\u6574</li>\n<li>\u68c0\u6d4b\u5e76\u5904\u7406\u91cd\u590d\u60c5\u51b5</li>\n</ul>\n<h3 id=\"784\">7.8.4 \u6027\u80fd\u4f18\u5316\u7684\u8bef\u533a</h3>\n<p><strong>\u9677\u96317\uff1a\u5ffd\u89c6BLAS\u6548\u7387</strong></p>\n<p>\u274c <strong>\u4f4e\u6548\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u9010\u5217\u8ba1\u7b97 Y = A @ Omega</span>\n<span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"n\">m</span><span class=\"p\">,</span> <span class=\"n\">ell</span><span class=\"p\">))</span>\n<span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">ell</span><span class=\"p\">):</span>\n    <span class=\"n\">Y</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">@</span> <span class=\"n\">Omega</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">]</span>\n</code></pre></div>\n\n<p>\u2705 <strong>\u9ad8\u6548\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u5229\u7528BLAS-3\u77e9\u9635\u4e58\u6cd5</span>\n<span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">@</span> <span class=\"n\">Omega</span>  <span class=\"c1\"># \u4e00\u6b21\u6027\u8ba1\u7b97\u6240\u6709\u5217</span>\n</code></pre></div>\n\n<p><strong>\u6027\u80fd\u5dee\u5f02</strong>\uff1a\u53ef\u8fbe10-100\u500d</p>\n<p><strong>\u9677\u96318\uff1a\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</strong></p>\n<p>\u274c <strong>\u7f13\u5b58\u4e0d\u53cb\u597d</strong>\uff1a\n\u968f\u673a\u8bbf\u95ee\u77e9\u9635\u5143\u7d20\u5bfc\u81f4cache miss</p>\n<p>\u2705 <strong>\u4f18\u5316\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u6309\u5757\u5904\u7406\u6570\u636e</li>\n<li>\u5217\u4e3b\u5e8fvs\u884c\u4e3b\u5e8f\u7684\u9009\u62e9</li>\n<li>\u9884\u53d6\u53ef\u80fd\u8bbf\u95ee\u7684\u6570\u636e</li>\n</ul>\n<h3 id=\"785\">7.8.5 \u7b97\u6cd5\u9009\u62e9\u7684\u8bef\u533a</h3>\n<p><strong>\u9677\u96319\uff1a\u76f2\u76ee\u4f7f\u7528\u590d\u6742\u65b9\u6cd5</strong></p>\n<p>\u274c <strong>\u8fc7\u5ea6\u5de5\u7a0b</strong>\uff1a\n\u5bf9\u4e8e\u6761\u4ef6\u826f\u597d\u7684\u77e9\u9635\u4f7f\u7528\u590d\u6742\u7684\u9884\u6761\u4ef6\u968f\u673a\u7b97\u6cd5</p>\n<p>\u2705 <strong>\u5408\u7406\u9009\u62e9</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u51b3\u7b56\u6811\uff1a\n1. \u77e9\u9635\u662f\u5426\u4f4e\u79e9\uff1f\u2192 \u662f\uff1a\u968f\u673aSVD\n2. \u77e9\u9635\u662f\u5426\u7a00\u758f\uff1f\u2192 \u662f\uff1a\u8003\u8651Nystr\u00f6m\u6216\u7a00\u758f\u968f\u673a\u6295\u5f71\n3. \u662f\u5426\u9700\u8981\u7cbe\u786e\u89e3\uff1f\u2192 \u662f\uff1a\u968f\u673a\u5316\u4f5c\u4e3a\u9884\u5904\u7406\n4. \u662f\u5426\u6709\u7279\u6b8a\u7ed3\u6784\uff1f\u2192 \u662f\uff1a\u5229\u7528\u7ed3\u6784\u7684\u4e13\u95e8\u7b97\u6cd5\n</code></pre></div>\n\n<p><strong>\u9677\u963110\uff1a\u53c2\u6570\u9009\u62e9\u4e0d\u5f53</strong></p>\n<p>\u274c <strong>\u7ecf\u9a8c\u53c2\u6570</strong>\uff1a\n\"\u603b\u662f\u4f7f\u7528 p=10 \u7684\u8fc7\u91c7\u6837\"</p>\n<p>\u2705 <strong>\u81ea\u9002\u5e94\u9009\u62e9</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u57fa\u4e8e\u8c31\u8870\u51cf\u4f30\u8ba1\u7684\u81ea\u9002\u5e94\u53c2\u6570</span>\n<span class=\"k\">def</span> <span class=\"nf\">estimate_oversampling</span><span class=\"p\">(</span><span class=\"n\">singular_values</span><span class=\"p\">,</span> <span class=\"n\">target_rank</span><span class=\"p\">,</span> <span class=\"n\">epsilon</span><span class=\"p\">):</span>\n    <span class=\"n\">tail_energy</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">singular_values</span><span class=\"p\">[</span><span class=\"n\">target_rank</span><span class=\"p\">:]</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n    <span class=\"n\">total_energy</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">(</span><span class=\"n\">singular_values</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">tail_energy</span> <span class=\"o\">/</span> <span class=\"n\">total_energy</span> <span class=\"o\">&lt;</span> <span class=\"n\">epsilon</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"mi\">5</span>  <span class=\"c1\"># \u5feb\u901f\u8870\u51cf</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"nb\">min</span><span class=\"p\">(</span><span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"n\">target_rank</span> <span class=\"o\">//</span> <span class=\"mi\">2</span><span class=\"p\">)</span>  <span class=\"c1\"># \u7f13\u6162\u8870\u51cf</span>\n</code></pre></div>\n\n<h3 id=\"786\">7.8.6 \u5e76\u884c\u5316\u7684\u9677\u9631</h3>\n<p><strong>\u9677\u963111\uff1a\u968f\u673a\u6570\u751f\u6210\u7684\u7ade\u4e89</strong></p>\n<p>\u274c <strong>\u9519\u8bef</strong>\uff1a\n\u591a\u7ebf\u7a0b\u5171\u4eab\u540c\u4e00\u968f\u673a\u6570\u751f\u6210\u5668</p>\n<p>\u2705 <strong>\u6b63\u786e</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u6bcf\u4e2a\u7ebf\u7a0b\u72ec\u7acb\u7684\u968f\u673a\u6d41</span>\n<span class=\"k\">def</span> <span class=\"nf\">parallel_random_projection</span><span class=\"p\">(</span><span class=\"n\">thread_id</span><span class=\"p\">,</span> <span class=\"n\">n_threads</span><span class=\"p\">):</span>\n    <span class=\"n\">rng</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">RandomState</span><span class=\"p\">(</span><span class=\"n\">seed</span> <span class=\"o\">+</span> <span class=\"n\">thread_id</span><span class=\"p\">)</span>\n    <span class=\"n\">local_omega</span> <span class=\"o\">=</span> <span class=\"n\">rng</span><span class=\"o\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">//</span> <span class=\"n\">n_threads</span><span class=\"p\">,</span> <span class=\"n\">ell</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">local_omega</span>\n</code></pre></div>\n\n<p><strong>\u9677\u963112\uff1a\u8d1f\u8f7d\u4e0d\u5747\u8861</strong></p>\n<p>\u274c <strong>\u7b80\u5355\u5212\u5206</strong>\uff1a\n\u5c06\u77e9\u9635\u5e73\u5747\u5206\u914d\u7ed9\u5404\u4e2a\u8fdb\u7a0b</p>\n<p>\u2705 <strong>\u667a\u80fd\u5212\u5206</strong>\uff1a</p>\n<ul>\n<li>\u8003\u8651\u77e9\u9635\u7a00\u758f\u6a21\u5f0f</li>\n<li>\u52a8\u6001\u8d1f\u8f7d\u5747\u8861</li>\n<li>\u901a\u4fe1\u4e0e\u8ba1\u7b97\u7684\u6743\u8861</li>\n</ul>\n<h3 id=\"787\">7.8.7 \u9a8c\u8bc1\u548c\u8c03\u8bd5</h3>\n<p><strong>\u9677\u963113\uff1a\u4e0d\u5145\u5206\u7684\u9a8c\u8bc1</strong></p>\n<p>\u274c <strong>\u9519\u8bef\u5047\u8bbe</strong>\uff1a\n\"\u968f\u673a\u7b97\u6cd5\u96be\u4ee5\u8c03\u8bd5\"</p>\n<p>\u2705 <strong>\u7cfb\u7edf\u5316\u9a8c\u8bc1</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">validate_randomized_svd</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span> <span class=\"n\">U</span><span class=\"p\">,</span> <span class=\"n\">S</span><span class=\"p\">,</span> <span class=\"n\">V</span><span class=\"p\">,</span> <span class=\"n\">k</span><span class=\"p\">):</span>\n    <span class=\"c1\"># 1. \u68c0\u67e5\u6b63\u4ea4\u6027</span>\n    <span class=\"k\">assert</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">allclose</span><span class=\"p\">(</span><span class=\"n\">U</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"o\">@</span> <span class=\"n\">U</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">eye</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">),</span> <span class=\"n\">atol</span><span class=\"o\">=</span><span class=\"mf\">1e-10</span><span class=\"p\">)</span>\n    <span class=\"k\">assert</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">allclose</span><span class=\"p\">(</span><span class=\"n\">V</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"o\">@</span> <span class=\"n\">V</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">eye</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">),</span> <span class=\"n\">atol</span><span class=\"o\">=</span><span class=\"mf\">1e-10</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># 2. \u68c0\u67e5\u91cd\u6784\u8bef\u5dee</span>\n    <span class=\"n\">A_approx</span> <span class=\"o\">=</span> <span class=\"n\">U</span> <span class=\"o\">@</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">diag</span><span class=\"p\">(</span><span class=\"n\">S</span><span class=\"p\">)</span> <span class=\"o\">@</span> <span class=\"n\">V</span><span class=\"o\">.</span><span class=\"n\">T</span>\n    <span class=\"n\">error</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">A</span> <span class=\"o\">-</span> <span class=\"n\">A_approx</span><span class=\"p\">,</span> <span class=\"s1\">&#39;fro&#39;</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># 3. \u68c0\u67e5\u5947\u5f02\u503c\u987a\u5e8f</span>\n    <span class=\"k\">assert</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">all</span><span class=\"p\">(</span><span class=\"n\">S</span><span class=\"p\">[:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">&gt;=</span> <span class=\"n\">S</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:])</span>\n\n    <span class=\"c1\"># 4. \u4e0e\u786e\u5b9a\u6027\u65b9\u6cd5\u5bf9\u6bd4\uff08\u5c0f\u89c4\u6a21\uff09</span>\n    <span class=\"k\">if</span> <span class=\"n\">A</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">&lt;</span> <span class=\"mi\">1000</span><span class=\"p\">:</span>\n        <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">S_true</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">svd</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">)</span>\n        <span class=\"n\">relative_error</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"n\">S</span> <span class=\"o\">-</span> <span class=\"n\">S_true</span><span class=\"p\">[:</span><span class=\"n\">k</span><span class=\"p\">])</span> <span class=\"o\">/</span> <span class=\"n\">S_true</span><span class=\"p\">[:</span><span class=\"n\">k</span><span class=\"p\">]</span>\n        <span class=\"k\">assert</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">all</span><span class=\"p\">(</span><span class=\"n\">relative_error</span> <span class=\"o\">&lt;</span> <span class=\"mf\">0.1</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<h3 id=\"788\">7.8.8 \u5b9e\u6218\u6848\u4f8b\u603b\u7ed3</h3>\n<p><strong>\u6848\u4f8b1\uff1a\u63a8\u8350\u7cfb\u7edf\u7684\u968f\u673aSVD\u5931\u8d25</strong></p>\n<ul>\n<li><strong>\u95ee\u9898</strong>\uff1a\u9690\u5f0f\u53cd\u9988\u77e9\u9635\u6781\u5ea6\u7a00\u758f\uff0c\u968f\u673a\u6295\u5f71\u6355\u83b7\u4fe1\u606f\u4e0d\u8db3</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u6539\u7528\u52a0\u6743\u91c7\u6837\u7684Nystr\u00f6m\u65b9\u6cd5</li>\n<li><strong>\u6559\u8bad</strong>\uff1a\u7b97\u6cd5\u9009\u62e9\u5fc5\u987b\u8003\u8651\u6570\u636e\u7279\u6027</li>\n</ul>\n<p><strong>\u6848\u4f8b2\uff1a\u5206\u5e03\u5f0f\u9884\u6761\u4ef6\u5b50\u7684\u6570\u503c\u5d29\u6e83</strong></p>\n<ul>\n<li><strong>\u95ee\u9898</strong>\uff1a\u5404\u8282\u70b9\u72ec\u7acb\u968f\u673a\u5316\u5bfc\u81f4\u5168\u5c40\u4e0d\u4e00\u81f4</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u4f7f\u7528\u786e\u5b9a\u6027\u54c8\u5e0c\u51fd\u6570\u751f\u6210\"\u4f2a\u968f\u673a\"\u77e9\u9635</li>\n<li><strong>\u6559\u8bad</strong>\uff1a\u5206\u5e03\u5f0f\u73af\u5883\u9700\u8981\u7279\u6b8a\u7684\u968f\u673a\u5316\u7b56\u7565</li>\n</ul>\n<p><strong>\u6848\u4f8b3\uff1a\u91cf\u5b50\u542f\u53d1\u7b97\u6cd5\u7684\u6027\u80fd\u9000\u5316</strong></p>\n<ul>\n<li><strong>\u95ee\u9898</strong>\uff1a\u7406\u8bba\u6700\u4f18\u7684\u91c7\u6837\u5206\u5e03\u8ba1\u7b97\u4ee3\u4ef7\u592a\u9ad8</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u4f7f\u7528\u5206\u5c42\u8fd1\u4f3c\u548c\u7f13\u5b58\u673a\u5236</li>\n<li><strong>\u6559\u8bad</strong>\uff1a\u5b9e\u8df5\u4e2d\u9700\u8981\u5728\u7406\u8bba\u6700\u4f18\u548c\u8ba1\u7b97\u53ef\u884c\u4e4b\u95f4\u6743\u8861</li>\n</ul>\n<h3 id=\"_12\">\u8c03\u8bd5\u5efa\u8bae\u6e05\u5355</h3>\n<ol>\n<li><strong>\u8bbe\u7f6e\u968f\u673a\u79cd\u5b50</strong>\uff1a\u786e\u4fdd\u53ef\u91cd\u73b0\u6027</li>\n<li><strong>\u9010\u6b65\u9a8c\u8bc1</strong>\uff1a\u6bcf\u4e2a\u4e2d\u95f4\u6b65\u9aa4\u90fd\u68c0\u67e5</li>\n<li><strong>\u5c3a\u5ea6\u6d4b\u8bd5</strong>\uff1a\u4ece\u5c0f\u89c4\u6a21\u5f00\u59cb\uff0c\u9010\u6b65\u589e\u5927</li>\n<li><strong>\u5bf9\u6bd4\u57fa\u51c6</strong>\uff1a\u4e0e\u786e\u5b9a\u6027\u7b97\u6cd5\u5bf9\u6bd4</li>\n<li><strong>\u76d1\u63a7\u6570\u503c\u6307\u6807</strong>\uff1a\u6761\u4ef6\u6570\u3001\u6b63\u4ea4\u6027\u3001\u6b8b\u5dee</li>\n<li><strong>\u53ef\u89c6\u5316</strong>\uff1a\u5947\u5f02\u503c\u5206\u5e03\u3001\u8bef\u5dee\u6536\u655b\u66f2\u7ebf</li>\n<li><strong>\u6781\u7aef\u6848\u4f8b</strong>\uff1a\u6d4b\u8bd5\u75c5\u6001\u77e9\u9635\u3001\u96f6\u77e9\u9635\u7b49</li>\n</ol>\n<hr />\n<h2 id=\"79\">7.9 \u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<p>\u672c\u8282\u63d0\u4f9b\u4e00\u4efd\u5168\u9762\u7684\u68c0\u67e5\u6e05\u5355\uff0c\u5e2e\u52a9\u60a8\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u6b63\u786e\u3001\u9ad8\u6548\u5730\u5e94\u7528\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u6280\u672f\u3002</p>\n<h3 id=\"791\">7.9.1 \u7b97\u6cd5\u9009\u62e9\u51b3\u7b56\u6811</h3>\n<div class=\"codehilite\"><pre><span></span><code>\u5f00\u59cb\n\u2502\n\u251c\u2500 \u95ee\u9898\u89c4\u6a21\uff1f\n\u2502  \u251c\u2500 n &lt; 1000\uff1a\u8003\u8651\u786e\u5b9a\u6027\u7b97\u6cd5\n\u2502  \u2514\u2500 n \u2265 1000\uff1a\u7ee7\u7eed\n\u2502\n\u251c\u2500 \u4e3b\u8981\u76ee\u6807\uff1f\n\u2502  \u251c\u2500 \u4f4e\u79e9\u8fd1\u4f3c\uff1a\u2192 \u968f\u673aSVD\u5bb6\u65cf\n\u2502  \u251c\u2500 \u7ebf\u6027\u7cfb\u7edf\u6c42\u89e3\uff1a\u2192 \u968f\u673a\u9884\u6761\u4ef6\u5b50\n\u2502  \u251c\u2500 \u7279\u5f81\u503c\u95ee\u9898\uff1a\u2192 \u968f\u673a\u5b50\u7a7a\u95f4\u8fed\u4ee3\n\u2502  \u2514\u2500 \u77e9\u9635\u51fd\u6570\uff1a\u2192 \u91cf\u5b50\u542f\u53d1\u91c7\u6837\n\u2502\n\u251c\u2500 \u77e9\u9635\u6027\u8d28\uff1f\n\u2502  \u251c\u2500 \u7a20\u5bc6\uff1a\u6807\u51c6\u968f\u673a\u6295\u5f71\n\u2502  \u251c\u2500 \u7a00\u758f\uff1a\u7ed3\u6784\u5316\u968f\u673a\u6295\u5f71\u6216Nystr\u00f6m\n\u2502  \u251c\u2500 \u7ed3\u6784\u5316\uff08Toeplitz\u7b49\uff09\uff1a\u4e13\u95e8\u7b97\u6cd5\n\u2502  \u2514\u2500 \u5bf9\u79f0\u6b63\u5b9a\uff1a\u5229\u7528\u6027\u8d28\u7684\u53d8\u4f53\n\u2502\n\u2514\u2500 \u7cbe\u5ea6\u8981\u6c42\uff1f\n   \u251c\u2500 \u9ad8\u7cbe\u5ea6\uff08\u03b5 &lt; 0.01\uff09\uff1a\u589e\u52a0\u91c7\u6837/\u4f7f\u7528\u5e42\u8fed\u4ee3\n   \u251c\u2500 \u4e2d\u7b49\u7cbe\u5ea6\uff080.01 \u2264 \u03b5 &lt; 0.1\uff09\uff1a\u6807\u51c6\u53c2\u6570\n   \u2514\u2500 \u4f4e\u7cbe\u5ea6\uff08\u03b5 \u2265 0.1\uff09\uff1a\u6fc0\u8fdb\u53c2\u6570/\u5355\u904d\u7b97\u6cd5\n</code></pre></div>\n\n<h3 id=\"792\">7.9.2 \u5b9e\u73b0\u68c0\u67e5\u6e05\u5355</h3>\n<h4 id=\"_13\"><strong>\u524d\u671f\u51c6\u5907</strong></h4>\n<ul>\n<li>[ ] <strong>\u9700\u6c42\u5206\u6790</strong></li>\n<li>[ ] \u660e\u786e\u7cbe\u5ea6\u8981\u6c42\uff08\u76f8\u5bf9/\u7edd\u5bf9\u8bef\u5dee\uff09</li>\n<li>[ ] \u786e\u5b9a\u65f6\u95f4\u9884\u7b97</li>\n<li>[ ] \u8bc4\u4f30\u5185\u5b58\u9650\u5236</li>\n<li>\n<p>[ ] \u4e86\u89e3\u6570\u636e\u7279\u6027\uff08\u7a00\u758f\u5ea6\u3001\u6761\u4ef6\u6570\u3001\u8c31\u5206\u5e03\uff09</p>\n</li>\n<li>\n<p>[ ] <strong>\u7b97\u6cd5\u9009\u62e9</strong></p>\n</li>\n<li>[ ] \u4f7f\u7528\u4e0a\u8ff0\u51b3\u7b56\u6811\u9009\u62e9\u57fa\u7840\u7b97\u6cd5</li>\n<li>[ ] \u8003\u8651\u6df7\u5408\u65b9\u6cd5\u7684\u53ef\u80fd\u6027</li>\n<li>[ ] \u8bc4\u4f30\u5e76\u884c\u5316\u6f5c\u529b</li>\n<li>[ ] \u51c6\u5907\u540e\u5907\u65b9\u6848</li>\n</ul>\n<h4 id=\"_14\"><strong>\u5b9e\u73b0\u9636\u6bb5</strong></h4>\n<ul>\n<li>[ ] <strong>\u6570\u503c\u7a33\u5b9a\u6027</strong></li>\n<li>[ ] \u4f7f\u7528\u7a33\u5b9a\u7684\u6b63\u4ea4\u5316\u65b9\u6cd5\uff08QR\u800c\u975eGram-Schmidt\uff09</li>\n<li>[ ] \u907f\u514d\u663e\u5f0f\u6c42\u9006\uff08\u4f7f\u7528\u4f2a\u9006\u6216\u8fed\u4ee3\u6c42\u89e3\uff09</li>\n<li>[ ] \u5904\u7406\u63a5\u8fd1\u96f6\u7684\u5947\u5f02\u503c</li>\n<li>\n<p>[ ] \u8003\u8651\u4f7f\u7528\u66f4\u9ad8\u7cbe\u5ea6\u7684\u5173\u952e\u8ba1\u7b97</p>\n</li>\n<li>\n<p>[ ] <strong>\u6027\u80fd\u4f18\u5316</strong></p>\n</li>\n<li>[ ] \u5229\u7528BLAS/LAPACK\u4f18\u5316\u7684\u4f8b\u7a0b</li>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u6570\u636e\u5e03\u5c40\uff08\u884c\u4e3b\u5e8f/\u5217\u4e3b\u5e8f\uff09</li>\n<li>[ ] \u5b9e\u73b0\u7f13\u5b58\u53cb\u597d\u7684\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>\n<p>[ ] \u8003\u8651\u5411\u91cf\u5316\u673a\u4f1a\uff08SIMD\uff09</p>\n</li>\n<li>\n<p>[ ] <strong>\u968f\u673a\u6027\u7ba1\u7406</strong></p>\n</li>\n<li>[ ] \u4f7f\u7528\u9ad8\u8d28\u91cf\u968f\u673a\u6570\u751f\u6210\u5668</li>\n<li>[ ] \u8bbe\u7f6e\u53ef\u63a7\u7684\u968f\u673a\u79cd\u5b50</li>\n<li>[ ] \u5e76\u884c\u73af\u5883\u4e0b\u7684\u72ec\u7acb\u968f\u673a\u6d41</li>\n<li>\n<p>[ ] \u8bb0\u5f55\u968f\u673a\u53c2\u6570\u7528\u4e8e\u590d\u73b0</p>\n</li>\n<li>\n<p>[ ] <strong>\u5185\u5b58\u7ba1\u7406</strong></p>\n</li>\n<li>[ ] \u4f30\u7b97\u5cf0\u503c\u5185\u5b58\u4f7f\u7528</li>\n<li>[ ] \u5b9e\u73b0\u6d41\u5f0f\u5904\u7406\uff08\u5982\u9700\u8981\uff09</li>\n<li>[ ] \u53ca\u65f6\u91ca\u653e\u4e34\u65f6\u53d8\u91cf</li>\n<li>[ ] \u8003\u8651\u5916\u5b58\u7b97\u6cd5\uff08\u8d85\u5927\u89c4\u6a21\uff09</li>\n</ul>\n<h4 id=\"_15\"><strong>\u9a8c\u8bc1\u6d4b\u8bd5</strong></h4>\n<ul>\n<li>[ ] <strong>\u6b63\u786e\u6027\u9a8c\u8bc1</strong></li>\n<li>[ ] \u5355\u5143\u6d4b\u8bd5\u6838\u5fc3\u7ec4\u4ef6</li>\n<li>[ ] \u4e0e\u53c2\u8003\u5b9e\u73b0\u5bf9\u6bd4</li>\n<li>[ ] \u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5</li>\n<li>\n<p>[ ] \u9a8c\u8bc1\u6982\u7387\u4fdd\u8bc1</p>\n</li>\n<li>\n<p>[ ] <strong>\u6027\u80fd\u6d4b\u8bd5</strong></p>\n</li>\n<li>[ ] \u4e0d\u540c\u89c4\u6a21\u7684\u57fa\u51c6\u6d4b\u8bd5</li>\n<li>[ ] \u4e0e\u7ade\u4e89\u7b97\u6cd5\u5bf9\u6bd4</li>\n<li>[ ] \u5206\u6790\u6027\u80fd\u74f6\u9888</li>\n<li>\n<p>[ ] \u6d4b\u8bd5\u5e76\u884c\u53ef\u6269\u5c55\u6027</p>\n</li>\n<li>\n<p>[ ] <strong>\u9c81\u68d2\u6027\u6d4b\u8bd5</strong></p>\n</li>\n<li>[ ] \u75c5\u6001\u77e9\u9635\u6d4b\u8bd5</li>\n<li>[ ] \u6781\u7aef\u7a00\u758f/\u7a20\u5bc6\u60c5\u51b5</li>\n<li>[ ] \u6570\u503c\u6781\u503c\u5904\u7406</li>\n<li>[ ] \u5f02\u5e38\u8f93\u5165\u5904\u7406</li>\n</ul>\n<h3 id=\"793\">7.9.3 \u53c2\u6570\u8c03\u4f18\u6307\u5357</h3>\n<h4 id=\"svd\"><strong>\u968f\u673aSVD\u53c2\u6570</strong></h4>\n<p>| \u53c2\u6570 | \u9ed8\u8ba4\u503c | \u8c03\u4f18\u5efa\u8bae | \u5f71\u54cd |</p>\n<table>\n<thead>\n<tr>\n<th>\u53c2\u6570</th>\n<th>\u9ed8\u8ba4\u503c</th>\n<th>\u8c03\u4f18\u5efa\u8bae</th>\n<th>\u5f71\u54cd</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u8fc7\u91c7\u6837 p</td>\n<td>10</td>\n<td>\u5feb\u901f\u8870\u51cf\u8c31\uff1a5<br>\u7f13\u6162\u8870\u51cf\u8c31\uff1a20+</td>\n<td>\u7cbe\u5ea6vs\u8ba1\u7b97\u91cf</td>\n</tr>\n<tr>\n<td>\u5e42\u8fed\u4ee3 q</td>\n<td>0-2</td>\n<td>\u6761\u4ef6\u6570&lt;10\u00b3\uff1a0<br>\u6761\u4ef6\u6570&gt;10\u2076\uff1a2</td>\n<td>\u7cbe\u5ea6vs\u8ba1\u7b97\u91cf</td>\n</tr>\n<tr>\n<td>\u5757\u5927\u5c0f</td>\n<td>32-64</td>\n<td>\u5339\u914d\u7f13\u5b58\u884c\u5927\u5c0f</td>\n<td>\u5185\u5b58\u6548\u7387</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"nystrom\"><strong>Nystr\u00f6m\u65b9\u6cd5\u53c2\u6570</strong></h4>\n<p>| \u53c2\u6570 | \u9ed8\u8ba4\u503c | \u8c03\u4f18\u5efa\u8bae | \u5f71\u54cd |</p>\n<table>\n<thead>\n<tr>\n<th>\u53c2\u6570</th>\n<th>\u9ed8\u8ba4\u503c</th>\n<th>\u8c03\u4f18\u5efa\u8bae</th>\n<th>\u5f71\u54cd</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u91c7\u6837\u6570 \u2113</td>\n<td>2k+10</td>\n<td>\u5747\u5300\u8c31\uff1ak+5<br>\u96c6\u4e2d\u8c31\uff1a3k</td>\n<td>\u7cbe\u5ea6vs\u5185\u5b58</td>\n</tr>\n<tr>\n<td>\u91c7\u6837\u7b56\u7565</td>\n<td>\u6760\u6746\u5206\u6570</td>\n<td>\u7a00\u758f\uff1a\u5ea6\u91c7\u6837<br>\u7a20\u5bc6\uff1a\u6df7\u5408\u7b56\u7565</td>\n<td>\u7cbe\u5ea6\u5206\u5e03</td>\n</tr>\n<tr>\n<td>\u6b63\u5219\u5316 \u03b5</td>\n<td>1e-10</td>\n<td>\u75c5\u6001\u65f6\u589e\u5927</td>\n<td>\u6570\u503c\u7a33\u5b9a\u6027</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"_16\"><strong>\u9884\u6761\u4ef6\u5b50\u53c2\u6570</strong></h4>\n<p>| \u53c2\u6570 | \u9ed8\u8ba4\u503c | \u8c03\u4f18\u5efa\u8bae | \u5f71\u54cd |</p>\n<table>\n<thead>\n<tr>\n<th>\u53c2\u6570</th>\n<th>\u9ed8\u8ba4\u503c</th>\n<th>\u8c03\u4f18\u5efa\u8bae</th>\n<th>\u5f71\u54cd</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u7a00\u758f\u5ea6</td>\n<td>10%</td>\n<td>\u826f\u6001\uff1a5%<br>\u75c5\u6001\uff1a20%</td>\n<td>\u6548\u679cvs\u6210\u672c</td>\n</tr>\n<tr>\n<td>\u5c42\u7ea7\u6570</td>\n<td>3-5</td>\n<td>2D\u95ee\u9898\uff1a3<br>3D\u95ee\u9898\uff1a5</td>\n<td>\u6536\u655b\u901f\u5ea6</td>\n</tr>\n<tr>\n<td>\u5e73\u6ed1\u6b21\u6570</td>\n<td>1-2</td>\n<td>\u6839\u636e\u8c31\u5206\u5e03\u8c03\u6574</td>\n<td>\u6bcf\u6b65\u6210\u672c</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"794\">7.9.4 \u6027\u80fd\u4f18\u5316\u6280\u5de7</h3>\n<h4 id=\"_17\"><strong>\u8ba1\u7b97\u4f18\u5316</strong></h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u2705 \u597d\uff1a\u6279\u91cf\u77e9\u9635\u4e58\u6cd5</span>\n<span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">@</span> <span class=\"n\">Omega</span>  <span class=\"c1\"># \u5229\u7528BLAS-3</span>\n\n<span class=\"c1\"># \u274c \u5dee\uff1a\u9010\u5217\u8ba1\u7b97</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">ell</span><span class=\"p\">):</span>\n    <span class=\"n\">Y</span><span class=\"p\">[:,</span> <span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">@</span> <span class=\"n\">Omega</span><span class=\"p\">[:,</span> <span class=\"n\">i</span><span class=\"p\">]</span>\n\n<span class=\"c1\"># \u2705 \u597d\uff1a\u91cd\u7528\u5206\u89e3\u7ed3\u679c</span>\n<span class=\"n\">Q</span><span class=\"p\">,</span> <span class=\"n\">R</span> <span class=\"o\">=</span> <span class=\"n\">qr</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">)</span>\n<span class=\"n\">B</span> <span class=\"o\">=</span> <span class=\"n\">Q</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"o\">@</span> <span class=\"n\">A</span>  <span class=\"c1\"># \u91cd\u7528Q</span>\n\n<span class=\"c1\"># \u274c \u5dee\uff1a\u91cd\u590d\u8ba1\u7b97</span>\n<span class=\"n\">B</span> <span class=\"o\">=</span> <span class=\"n\">pinv</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"p\">)</span> <span class=\"o\">@</span> <span class=\"n\">A</span>  <span class=\"c1\"># \u5185\u90e8\u91cd\u65b0\u5206\u89e3</span>\n</code></pre></div>\n\n<h4 id=\"_18\"><strong>\u5185\u5b58\u4f18\u5316</strong></h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u2705 \u597d\uff1a\u539f\u5730\u64cd\u4f5c</span>\n<span class=\"n\">Y</span> <span class=\"o\">*=</span> <span class=\"n\">scale_factor</span>\n\n<span class=\"c1\"># \u274c \u5dee\uff1a\u521b\u5efa\u4e34\u65f6\u53d8\u91cf</span>\n<span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">Y</span> <span class=\"o\">*</span> <span class=\"n\">scale_factor</span>\n\n<span class=\"c1\"># \u2705 \u597d\uff1a\u5206\u5757\u5904\u7406</span>\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"p\">,</span> <span class=\"n\">block_size</span><span class=\"p\">):</span>\n    <span class=\"n\">process_block</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">:</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"n\">block_size</span><span class=\"p\">,</span> <span class=\"p\">:])</span>\n\n<span class=\"c1\"># \u274c \u5dee\uff1a\u4e00\u6b21\u6027\u52a0\u8f7d</span>\n<span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">process_all</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">)</span>  <span class=\"c1\"># \u53ef\u80fdOOM</span>\n</code></pre></div>\n\n<h3 id=\"795\">7.9.5 \u751f\u4ea7\u73af\u5883\u90e8\u7f72</h3>\n<h4 id=\"_19\"><strong>\u53ef\u9760\u6027\u4fdd\u969c</strong></h4>\n<ul>\n<li>\n<p>[ ] <strong>\u5f02\u5e38\u5904\u7406</strong>\n  <code>python\n  try:\n      U, S, V = randomized_svd(A, rank=k)\n  except NumericalError:\n      # \u56de\u9000\u5230\u786e\u5b9a\u6027\u65b9\u6cd5\n      U, S, V = truncated_svd(A, rank=k)</code></p>\n</li>\n<li>\n<p>[ ] <strong>\u8fdb\u5ea6\u76d1\u63a7</strong>\n  <code>python\n  for iteration in range(max_iter):\n      # \u6267\u884c\u8fed\u4ee3\n      if iteration % check_interval == 0:\n          error = estimate_error()\n          if error &lt; tolerance:\n              break\n          log_progress(iteration, error)</code></p>\n</li>\n<li>\n<p>[ ] <strong>\u8d44\u6e90\u9650\u5236</strong>\n  ```python\n  # \u8bbe\u7f6e\u5185\u5b58\u4e0a\u9650\n  memory_limit = get_available_memory() * 0.8\n  batch_size = estimate_batch_size(memory_limit)</p>\n</li>\n</ul>\n<p># \u8bbe\u7f6e\u65f6\u95f4\u4e0a\u9650\n  with timeout(seconds=max_time):\n      result = expensive_computation()\n  ```</p>\n<h4 id=\"_20\"><strong>\u76d1\u63a7\u6307\u6807</strong></h4>\n<p>| \u6307\u6807 | \u76d1\u63a7\u65b9\u6cd5 | \u62a5\u8b66\u9608\u503c |</p>\n<table>\n<thead>\n<tr>\n<th>\u6307\u6807</th>\n<th>\u76d1\u63a7\u65b9\u6cd5</th>\n<th>\u62a5\u8b66\u9608\u503c</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u76f8\u5bf9\u8bef\u5dee</td>\n<td><code>\u2016A-\u00c3k\u2016/\u2016A\u2016</code></td>\n<td>&gt; 2\u00d7\u9884\u671f\u8bef\u5dee</td>\n</tr>\n<tr>\n<td>\u8ba1\u7b97\u65f6\u95f4</td>\n<td>\u6bcf\u6b21\u8fed\u4ee3\u8017\u65f6</td>\n<td>&gt; 1.5\u00d7\u5386\u53f2\u5747\u503c</td>\n</tr>\n<tr>\n<td>\u5185\u5b58\u4f7f\u7528</td>\n<td>\u5cf0\u503c\u5185\u5b58</td>\n<td>&gt; 90%\u53ef\u7528\u5185\u5b58</td>\n</tr>\n<tr>\n<td>\u6570\u503c\u7a33\u5b9a\u6027</td>\n<td>\u6761\u4ef6\u6570\u4f30\u8ba1</td>\n<td>&gt; 10^12</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"796\">7.9.6 \u56e2\u961f\u534f\u4f5c\u89c4\u8303</h3>\n<h4 id=\"_21\"><strong>\u4ee3\u7801\u89c4\u8303</strong></h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">randomized_svd</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span> <span class=\"n\">rank</span><span class=\"p\">,</span> <span class=\"n\">oversample</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">n_iter</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    \u8ba1\u7b97\u77e9\u9635A\u7684\u968f\u673a\u5316SVD\u5206\u89e3\u3002</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    A : array_like, shape (m, n)</span>\n<span class=\"sd\">        \u8f93\u5165\u77e9\u9635</span>\n<span class=\"sd\">    rank : int</span>\n<span class=\"sd\">        \u76ee\u6807\u79e9</span>\n<span class=\"sd\">    oversample : int, optional</span>\n<span class=\"sd\">        \u8fc7\u91c7\u6837\u53c2\u6570 (\u9ed8\u8ba4: 10)</span>\n<span class=\"sd\">    n_iter : int, optional</span>\n<span class=\"sd\">        \u5e42\u8fed\u4ee3\u6b21\u6570 (\u9ed8\u8ba4: 2)</span>\n<span class=\"sd\">    random_state : int or RandomState, optional</span>\n<span class=\"sd\">        \u968f\u673a\u6570\u79cd\u5b50</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    U : ndarray, shape (m, rank)</span>\n<span class=\"sd\">        \u5de6\u5947\u5f02\u5411\u91cf</span>\n<span class=\"sd\">    S : ndarray, shape (rank,)</span>\n<span class=\"sd\">        \u5947\u5f02\u503c</span>\n<span class=\"sd\">    V : ndarray, shape (n, rank)</span>\n<span class=\"sd\">        \u53f3\u5947\u5f02\u5411\u91cf</span>\n\n<span class=\"sd\">    References</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    .. [1] Halko et al. &quot;Finding structure with randomness&quot;</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n</code></pre></div>\n\n<h4 id=\"_22\"><strong>\u6587\u6863\u8981\u6c42</strong></h4>\n<ul>\n<li>[ ] \u7b97\u6cd5\u9009\u62e9\u7406\u7531</li>\n<li>[ ] \u53c2\u6570\u8bbe\u7f6e\u4f9d\u636e</li>\n<li>[ ] \u6027\u80fd\u6d4b\u8bd5\u7ed3\u679c</li>\n<li>[ ] \u5df2\u77e5\u9650\u5236\u8bf4\u660e</li>\n<li>[ ] \u6545\u969c\u6062\u590d\u65b9\u6848</li>\n</ul>\n<h3 id=\"797\">7.9.7 \u6301\u7eed\u6539\u8fdb</h3>\n<h4 id=\"_23\"><strong>\u6027\u80fd\u8ffd\u8e2a</strong></h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u6027\u80fd\u65e5\u5fd7</span>\n<span class=\"p\">{</span>\n    <span class=\"s2\">&quot;timestamp&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;2024-01-15T10:30:00Z&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;algorithm&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;randomized_svd&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;matrix_size&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">10000</span><span class=\"p\">,</span> <span class=\"mi\">5000</span><span class=\"p\">],</span>\n    <span class=\"s2\">&quot;rank&quot;</span><span class=\"p\">:</span> <span class=\"mi\">100</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;parameters&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;oversample&quot;</span><span class=\"p\">:</span> <span class=\"mi\">10</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;n_iter&quot;</span><span class=\"p\">:</span> <span class=\"mi\">2</span>\n    <span class=\"p\">},</span>\n    <span class=\"s2\">&quot;metrics&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;time_seconds&quot;</span><span class=\"p\">:</span> <span class=\"mf\">2.34</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;memory_mb&quot;</span><span class=\"p\">:</span> <span class=\"mi\">1250</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;relative_error&quot;</span><span class=\"p\">:</span> <span class=\"mf\">0.0012</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<h4 id=\"_24\"><strong>\u4f18\u5316\u673a\u4f1a\u8bc6\u522b</strong></h4>\n<ol>\n<li>\n<p><strong>\u5206\u6790\u65e5\u5fd7\u627e\u51fa\u6a21\u5f0f</strong>\n   - \u54ea\u4e9b\u53c2\u6570\u7ec4\u5408\u6700\u5e38\u7528\uff1f\n   - \u6027\u80fd\u74f6\u9888\u5728\u54ea\u91cc\uff1f\n   - \u5931\u8d25\u6848\u4f8b\u7684\u5171\u6027\uff1f</p>\n</li>\n<li>\n<p><strong>A/B\u6d4b\u8bd5\u65b0\u65b9\u6cd5</strong>\n   - \u5e76\u884c\u8fd0\u884c\u65b0\u65e7\u7b97\u6cd5\n   - \u7edf\u8ba1\u6bd4\u8f83\u6027\u80fd\u6307\u6807\n   - \u9010\u6b65\u8fc1\u79fb\u5230\u66f4\u4f18\u65b9\u6848</p>\n</li>\n<li>\n<p><strong>\u77e5\u8bc6\u79ef\u7d2f</strong>\n   - \u7ef4\u62a4\u6700\u4f73\u5b9e\u8df5\u6587\u6863\n   - \u8bb0\u5f55\u8e29\u5751\u7ecf\u9a8c\n   - \u5206\u4eab\u4f18\u5316\u6280\u5de7</p>\n</li>\n</ol>\n<h3 id=\"_25\">\u6700\u7ec8\u5efa\u8bae</h3>\n<p>\u6210\u529f\u5e94\u7528\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u7684\u5173\u952e\u5728\u4e8e\uff1a</p>\n<ol>\n<li><strong>\u6df1\u5165\u7406\u89e3</strong>\uff1a\u4e0d\u4ec5\u77e5\u9053\u600e\u4e48\u7528\uff0c\u66f4\u8981\u7406\u89e3\u4e3a\u4ec0\u4e48</li>\n<li><strong>\u8c28\u614e\u9009\u62e9</strong>\uff1a\u6ca1\u6709\u4e07\u80fd\u7b97\u6cd5\uff0c\u9009\u62e9\u9002\u5408\u95ee\u9898\u7684\u65b9\u6cd5</li>\n<li><strong>\u5145\u5206\u6d4b\u8bd5</strong>\uff1a\u968f\u673a\u4e0d\u7b49\u4e8e\u968f\u610f\uff0c\u9700\u8981\u4e25\u683c\u9a8c\u8bc1</li>\n<li><strong>\u6301\u7eed\u4f18\u5316</strong>\uff1a\u6839\u636e\u5b9e\u9645\u4f7f\u7528\u60c5\u51b5\u4e0d\u65ad\u6539\u8fdb</li>\n</ol>\n<p>\u8bb0\u4f4f\uff1a\u968f\u673a\u5316\u662f\u5de5\u5177\uff0c\u4e0d\u662f\u76ee\u7684\u3002\u53ea\u6709\u5728\u80fd\u5e26\u6765\u5b9e\u9645\u597d\u5904\u65f6\u624d\u4f7f\u7528\u5b83\u3002</p>\n<hr />\n<h2 id=\"71_1\">7.1 \u5f15\u8a00\uff1a\u4e3a\u4ec0\u4e48\u9700\u8981\u968f\u673a\u5316\uff1f</h2>\n<p>\u5728\u4f20\u7edf\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u4e2d\uff0c\u6211\u4eec\u8ffd\u6c42\u7684\u662f\u786e\u5b9a\u6027\u7b97\u6cd5\uff1a\u7ed9\u5b9a\u8f93\u5165\uff0c\u603b\u80fd\u5f97\u5230\u76f8\u540c\u7684\u8f93\u51fa\u3002\u7136\u800c\uff0c\u5f53\u9762\u5bf9\u73b0\u4ee3\u6570\u636e\u79d1\u5b66\u4e2d\u52a8\u8f84\u6570\u767e\u4e07\u7ef4\u5ea6\u7684\u77e9\u9635\u65f6\uff0c\u5373\u4f7f\u662f\u6700\u4f18\u5316\u7684\u786e\u5b9a\u6027\u7b97\u6cd5\u4e5f\u4f1a\u9047\u5230\u8ba1\u7b97\u548c\u5b58\u50a8\u7684\u74f6\u9888\u3002\u968f\u673a\u5316\u6280\u672f\u63d0\u4f9b\u4e86\u4e00\u6761\u7a81\u7834\u4e4b\u8def\u3002</p>\n<h3 id=\"711\">7.1.1 \u786e\u5b9a\u6027\u7b97\u6cd5\u7684\u8ba1\u7b97\u74f6\u9888</h3>\n<p>\u8003\u8651\u8ba1\u7b97\u4e00\u4e2a $n \\times n$ \u77e9\u9635\u7684SVD\u5206\u89e3\u3002\u6807\u51c6\u7684Golub-Kahan\u53cc\u5bf9\u89d2\u5316\u7b97\u6cd5\u9700\u8981 $\\mathcal{O}(n^3)$ \u7684\u8ba1\u7b97\u590d\u6742\u5ea6\u3002\u5f53 $n = 10^6$ \u65f6\uff0c\u5373\u4f7f\u5728\u73b0\u4ee3\u9ad8\u6027\u80fd\u8ba1\u7b97\u673a\u4e0a\uff0c\u8fd9\u4e5f\u9700\u8981\u6570\u5929\u751a\u81f3\u6570\u5468\u7684\u8ba1\u7b97\u65f6\u95f4\u3002\u66f4\u7cdf\u7cd5\u7684\u662f\uff0c\u5b58\u50a8\u8fd9\u6837\u7684\u77e9\u9635\u9700\u8981 8TB \u7684\u5185\u5b58\uff08\u5047\u8bbe\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570\uff09\u3002</p>\n<p><strong>\u5173\u952e\u89c2\u5bdf</strong>\uff1a\u5728\u8bb8\u591a\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u5b8c\u6574\u7684\u5206\u89e3\u7ed3\u679c\u3002\u4f8b\u5982\uff1a</p>\n<ul>\n<li>\u4e3b\u6210\u5206\u5206\u6790\uff08PCA\uff09\u901a\u5e38\u53ea\u9700\u8981\u524d\u51e0\u4e2a\u4e3b\u6210\u5206</li>\n<li>\u63a8\u8350\u7cfb\u7edf\u7684\u77e9\u9635\u5206\u89e3\u53ea\u9700\u8981\u4f4e\u79e9\u8fd1\u4f3c</li>\n<li>\u8c31\u805a\u7c7b\u53ea\u9700\u8981\u5c11\u6570\u51e0\u4e2a\u7279\u5f81\u5411\u91cf</li>\n</ul>\n<h3 id=\"712\">7.1.2 \u968f\u673a\u5316\u5e26\u6765\u7684\u8ba1\u7b97\u4f18\u52bf</h3>\n<p>\u968f\u673a\u5316\u7b97\u6cd5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0\u52a0\u901f\uff1a</p>\n<ol>\n<li><strong>\u964d\u7ef4\u4f18\u5148</strong>\uff1a\u5148\u5c06\u9ad8\u7ef4\u95ee\u9898\u6295\u5f71\u5230\u4f4e\u7ef4\u7a7a\u95f4\uff0c\u518d\u8fdb\u884c\u7cbe\u786e\u8ba1\u7b97</li>\n<li><strong>\u91c7\u6837\u4ee3\u66ff\u904d\u5386</strong>\uff1a\u901a\u8fc7\u5de7\u5999\u7684\u91c7\u6837\u7b56\u7565\u4f30\u8ba1\u5168\u5c40\u6027\u8d28</li>\n<li><strong>\u6982\u7387\u4fdd\u8bc1</strong>\uff1a\u4ee5\u6781\u9ad8\u6982\u7387\uff08\u5982 $1-\\delta$\uff0c\u5176\u4e2d $\\delta$ \u53ef\u4ee5\u4efb\u610f\u5c0f\uff09\u5f97\u5230\u8fd1\u4f3c\u89e3</li>\n</ol>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5bf9\u6bd4</strong>\uff1a</p>\n<ul>\n<li>\u7cbe\u786eSVD\uff1a$\\mathcal{O}(n^3)$</li>\n<li>\u968f\u673a\u5316SVD\uff08\u79e9-$k$ \u8fd1\u4f3c\uff09\uff1a$\\mathcal{O}(n^2k) + \\mathcal{O}(nk^2)$</li>\n<li>\u5f53 $k \\ll n$ \u65f6\uff0c\u52a0\u901f\u6bd4\u53ef\u8fbe $\\mathcal{O}(n/k)$</li>\n</ul>\n<h3 id=\"713-vs\">7.1.3 \u6982\u7387\u4fdd\u8bc1vs\u786e\u5b9a\u6027\u4fdd\u8bc1</h3>\n<p>\u968f\u673a\u5316\u7b97\u6cd5\u7684\u4e00\u4e2a\u5173\u952e\u7279\u5f81\u662f\u5176\u63d0\u4f9b\u6982\u7387\u4fdd\u8bc1\u800c\u975e\u786e\u5b9a\u6027\u4fdd\u8bc1\u3002\u8fd9\u5f15\u53d1\u4e86\u4e00\u4e2a\u91cd\u8981\u95ee\u9898\uff1a\u6982\u7387\u4fdd\u8bc1\u5728\u5b9e\u8df5\u4e2d\u591f\u7528\u5417\uff1f</p>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1\u7684\u5f62\u5f0f</strong>\uff1a\n$$\\mathbb{P}\\left[|\\mathbf{A} - \\mathbf{\\tilde{A}}|_F \\leq (1+\\epsilon)|\\mathbf{A} - \\mathbf{A}_k|_F\\right] \\geq 1 - \\delta$$\n\u5176\u4e2d $\\mathbf{A}_k$ \u662f $\\mathbf{A}$ \u7684\u6700\u4f73\u79e9-$k$ \u8fd1\u4f3c\u3002</p>\n<p><strong>\u5b9e\u8df5\u7ecf\u9a8c</strong>\uff1a</p>\n<ul>\n<li>\u5931\u8d25\u6982\u7387 $\\delta$ \u53ef\u4ee5\u6307\u6570\u7ea7\u964d\u4f4e\uff1a\u901a\u8fc7\u589e\u52a0\u5c11\u91cf\u8ba1\u7b97\uff0c\u53ef\u4f7f $\\delta &lt; 10^{-10}$</li>\n<li>\u591a\u6b21\u8fd0\u884c\u53d6\u6700\u4f73\uff1a\u72ec\u7acb\u8fd0\u884c $t$ \u6b21\uff0c\u5931\u8d25\u6982\u7387\u964d\u81f3 $\\delta^t$</li>\n<li>\u81ea\u9002\u5e94\u7b97\u6cd5\uff1a\u52a8\u6001\u68c0\u6d4b\u8fd1\u4f3c\u8d28\u91cf\uff0c\u5fc5\u8981\u65f6\u589e\u52a0\u91c7\u6837</li>\n</ul>\n<h3 id=\"714\">7.1.4 \u5728\u5927\u89c4\u6a21\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\u573a\u666f</h3>\n<p>\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u5728\u4ee5\u4e0b\u573a\u666f\u4e2d\u5c55\u73b0\u51fa\u72ec\u7279\u4f18\u52bf\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u4e8c\u9636\u4f18\u5316</strong>\n   - \u4f7f\u7528\u968f\u673a\u5316\u65b9\u6cd5\u4f30\u8ba1Hessian-vector\u79ef\n   - \u901a\u8fc7\u4f4e\u79e9\u8fd1\u4f3c\u52a0\u901fNatural Gradient\u8ba1\u7b97\n   - \u76f8\u5173\u51fd\u6570\uff1a<code>randomized_svd</code>, <code>sketched_hessian</code></p>\n</li>\n<li>\n<p><strong>\u63a8\u8350\u7cfb\u7edf\u7684\u5b9e\u65f6\u66f4\u65b0</strong>\n   - \u589e\u91cf\u5f0f\u968f\u673aSVD\u5904\u7406\u65b0\u7528\u6237/\u7269\u54c1\n   - \u901a\u8fc7\u91c7\u6837\u5904\u7406\u9690\u5f0f\u53cd\u9988\u6570\u636e\n   - \u76f8\u5173\u51fd\u6570\uff1a<code>incremental_rsvd</code>, <code>sampled_als</code></p>\n</li>\n<li>\n<p><strong>\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u53ef\u6269\u5c55\u8bad\u7ec3</strong>\n   - \u968f\u673a\u5316\u8ba1\u7b97\u56fe\u62c9\u666e\u62c9\u65af\u7684\u8c31\n   - \u901a\u8fc7\u91c7\u6837\u8fd1\u4f3c\u56fe\u5377\u79ef\u64cd\u4f5c\n   - \u76f8\u5173\u51fd\u6570\uff1a<code>random_walk_sampling</code>, <code>spectral_clustering</code></p>\n</li>\n<li>\n<p><strong>\u79d1\u5b66\u8ba1\u7b97\u4e2d\u7684\u5927\u89c4\u6a21\u7ebf\u6027\u7cfb\u7edf</strong>\n   - \u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u52a0\u901f\u8fed\u4ee3\u6c42\u89e3\n   - \u901a\u8fc7\u91c7\u6837\u4f30\u8ba1\u6761\u4ef6\u6570\n   - \u76f8\u5173\u51fd\u6570\uff1a<code>randomized_preconditioner</code>, <code>condition_number_estimator</code></p>\n</li>\n</ol>\n<h3 id=\"715\">7.1.5 \u672c\u8282\u8981\u70b9</h3>\n<p>\u968f\u673a\u5316\u65b9\u6cd5\u4e3a\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u63d0\u4f9b\u4e86\u4e00\u6761\u5b9e\u7528\u4e4b\u8def\u3002\u901a\u8fc7\u727a\u7272\u4e00\u5b9a\u7684\u786e\u5b9a\u6027\uff08\u4f46\u4fdd\u6301\u9ad8\u6982\u7387\u4fdd\u8bc1\uff09\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u663e\u8457\u7684\u8ba1\u7b97\u6548\u7387\u63d0\u5347\u3002\u63a5\u4e0b\u6765\u7684\u7ae0\u8282\u5c06\u6df1\u5165\u63a2\u8ba8\u5177\u4f53\u7684\u968f\u673a\u5316\u6280\u672f\u53ca\u5176\u7406\u8bba\u57fa\u7840\u3002</p>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u968f\u673a\u5316\u7b97\u6cd5\u7684\u4e0b\u754c\u7406\u8bba\uff1a\u4ec0\u4e48\u65f6\u5019\u968f\u673a\u5316\u662f\u5fc5\u8981\u7684\uff1f</li>\n<li>\u91cf\u5b50\u7b97\u6cd5\u4e0e\u7ecf\u5178\u968f\u673a\u7b97\u6cd5\u7684\u672c\u8d28\u8054\u7cfb</li>\n<li>\u9488\u5bf9\u7279\u5b9a\u786c\u4ef6\uff08GPU\u3001TPU\uff09\u4f18\u5316\u7684\u968f\u673a\u5316\u7b97\u6cd5\u8bbe\u8ba1</li>\n</ul>\n<hr />\n<h2 id=\"72-svd_1\">7.2 \u968f\u673aSVD\u7684\u8bef\u5dee\u5206\u6790</h2>\n<p>\u968f\u673a\u5316\u5947\u5f02\u503c\u5206\u89e3\uff08Randomized SVD\uff09\u662f\u968f\u673a\u5316\u6570\u503c\u7ebf\u6027\u4ee3\u6570\u7684\u65d7\u8230\u7b97\u6cd5\u3002\u5b83\u4e0d\u4ec5\u5728\u7406\u8bba\u4e0a\u4f18\u96c5\uff0c\u66f4\u5728\u5b9e\u8df5\u4e2d\u5c55\u73b0\u51fa\u5353\u8d8a\u7684\u6027\u80fd\u3002\u672c\u8282\u5c06\u6df1\u5165\u5256\u6790\u5176\u5de5\u4f5c\u539f\u7406\u3001\u8bef\u5dee\u754c\u4ee5\u53ca\u5404\u79cd\u6539\u8fdb\u6280\u672f\u3002</p>\n<h3 id=\"721\">7.2.1 \u968f\u673a\u6295\u5f71\u7684\u57fa\u672c\u539f\u7406</h3>\n<p>\u968f\u673aSVD\u7684\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u968f\u673a\u6295\u5f71\u6355\u83b7\u77e9\u9635\u7684\u4e3b\u8981\u4fe1\u606f\u3002\u7ed9\u5b9a\u77e9\u9635 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$\uff0c\u6211\u4eec\u5e0c\u671b\u627e\u5230\u5176\u79e9-$k$ \u8fd1\u4f3c\u3002</p>\n<p><strong>\u57fa\u672c\u7b97\u6cd5\u6d41\u7a0b</strong>\uff1a</p>\n<ol>\n<li>\u751f\u6210\u968f\u673a\u77e9\u9635 $\\boldsymbol{\\Omega} \\in \\mathbb{R}^{n \\times \\ell}$\uff0c\u5176\u4e2d $\\ell = k + p$\uff08$p$ \u662f\u8fc7\u91c7\u6837\u53c2\u6570\uff09</li>\n<li>\u8ba1\u7b97 $\\mathbf{Y} = \\mathbf{A}\\boldsymbol{\\Omega}$\uff08\u6355\u83b7 $\\mathbf{A}$ \u7684\u5217\u7a7a\u95f4\u4fe1\u606f\uff09</li>\n<li>\u6b63\u4ea4\u5316\uff1a$\\mathbf{Q}\\mathbf{R} = \\mathbf{Y}$\uff08QR\u5206\u89e3\uff09</li>\n<li>\u5f62\u6210\u4f4e\u7ef4\u6295\u5f71\uff1a$\\mathbf{B} = \\mathbf{Q}^T\\mathbf{A}$</li>\n<li>\u8ba1\u7b97 $\\mathbf{B}$ \u7684SVD\uff1a$\\mathbf{B} = \\tilde{\\mathbf{U}}\\boldsymbol{\\Sigma}\\mathbf{V}^T$</li>\n<li>\u6062\u590d\uff1a$\\mathbf{U} = \\mathbf{Q}\\tilde{\\mathbf{U}}$</li>\n</ol>\n<p><strong>\u4e3a\u4ec0\u4e48\u968f\u673a\u6295\u5f71\u6709\u6548\uff1f</strong></p>\n<p>\u5173\u952e\u6d1e\u5bdf\u6765\u81ea\u4e8e Johnson-Lindenstrauss \u5f15\u7406\u7684\u77e9\u9635\u7248\u672c\uff1a\u968f\u673a\u6295\u5f71\u4ee5\u9ad8\u6982\u7387\u4fdd\u6301\u77e9\u9635\u7684\u8c31\u4fe1\u606f\u3002\u5177\u4f53\u800c\u8a00\uff0c\u5982\u679c $\\mathbf{A}$ \u6709\u5feb\u901f\u8870\u51cf\u7684\u5947\u5f02\u503c\uff08\u8fd9\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u5f88\u5e38\u89c1\uff09\uff0c\u90a3\u4e48\u968f\u673a\u6295\u5f71\u80fd\u591f\u6709\u6548\u6355\u83b7\u4e3b\u8981\u7684\u5947\u5f02\u5411\u91cf\u3002</p>\n<p><strong>\u968f\u673a\u77e9\u9635\u7684\u9009\u62e9</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9ad8\u65af\u968f\u673a\u77e9\u9635</strong>\uff1a$\\omega_{ij} \\sim \\mathcal{N}(0,1)$\n   - \u7406\u8bba\u6027\u8d28\u6700\u597d\uff0c\u4f46\u751f\u6210\u548c\u5b58\u50a8\u5f00\u9500\u5927</p>\n</li>\n<li>\n<p><strong>\u4e9a\u9ad8\u65af\u5206\u5e03</strong>\uff1a\u5982Rademacher\u5206\u5e03 $\\omega_{ij} \\in {-1, +1}$\n   - \u8ba1\u7b97\u6548\u7387\u66f4\u9ad8\uff0c\u7406\u8bba\u4fdd\u8bc1\u76f8\u4f3c</p>\n</li>\n<li>\n<p><strong>\u7ed3\u6784\u5316\u968f\u673a\u77e9\u9635</strong>\uff1a\u5982\u4e9a\u91c7\u6837\u968f\u673a\u5085\u91cc\u53f6\u53d8\u6362\uff08SRFT\uff09\n   - $\\boldsymbol{\\Omega} = \\sqrt{\\frac{n}{\\ell}}\\mathbf{DFS}$\n   - \u5176\u4e2d $\\mathbf{D}$ \u662f\u968f\u673a\u5bf9\u89d2\u7b26\u53f7\u77e9\u9635\uff0c$\\mathbf{F}$ \u662fFFT\u77e9\u9635\uff0c$\\mathbf{S}$ \u662f\u91c7\u6837\u77e9\u9635\n   - \u8ba1\u7b97\u590d\u6742\u5ea6\u964d\u81f3 $\\mathcal{O}(mn\\log\\ell)$</p>\n</li>\n</ol>\n<h3 id=\"722\">7.2.2 \u5e42\u8fed\u4ee3\u4e0e\u7cbe\u5ea6\u63d0\u5347</h3>\n<p>\u57fa\u672c\u968f\u673aSVD\u7b97\u6cd5\u5bf9\u4e8e\u5947\u5f02\u503c\u7f13\u6162\u8870\u51cf\u7684\u77e9\u9635\u53ef\u80fd\u8868\u73b0\u4e0d\u4f73\u3002\u5e42\u8fed\u4ee3\uff08Power Iteration\uff09\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u5355\u800c\u6709\u6548\u7684\u6539\u8fdb\u65b9\u6cd5\u3002</p>\n<p><strong>\u5e26\u5e42\u8fed\u4ee3\u7684\u968f\u673aSVD</strong>\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97 $\\mathbf{Y} = (\\mathbf{AA}^T)^q\\mathbf{A}\\boldsymbol{\\Omega}$</li>\n<li>\u540e\u7eed\u6b65\u9aa4\u4e0e\u57fa\u672c\u7b97\u6cd5\u76f8\u540c</li>\n</ol>\n<p><strong>\u4e3a\u4ec0\u4e48\u5e42\u8fed\u4ee3\u6709\u6548\uff1f</strong></p>\n<p>\u5e42\u8fed\u4ee3\u653e\u5927\u4e86\u5927\u5947\u5f02\u503c\u5bf9\u5e94\u7684\u5947\u5f02\u5411\u91cf\u7684\u6743\u91cd\u3002\u5177\u4f53\u5730\uff0c\u5982\u679c $\\mathbf{A} = \\sum_{i=1}^n \\sigma_i \\mathbf{u}_i \\mathbf{v}_i^T$\uff0c\u90a3\u4e48\uff1a\n$$(\\mathbf{AA}^T)^q\\mathbf{A} = \\sum_{i=1}^n \\sigma_i^{2q+1} \\mathbf{u}_i \\mathbf{v}_i^T$$\n\u5947\u5f02\u503c\u7684\u76f8\u5bf9\u5dee\u8ddd\u4ece $\\sigma_i/\\sigma_j$ \u653e\u5927\u5230 $(\\sigma_i/\\sigma_j)^{2q+1}$\u3002</p>\n<p><strong>\u5b9e\u7528\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u901a\u5e38 $q = 1$ \u6216 $2$ \u5c31\u8db3\u591f</li>\n<li>\u9700\u8981\u989d\u5916 $2q$ \u6b21\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5</li>\n<li>\u5bf9\u4e8e\u7a00\u758f\u77e9\u9635\u7279\u522b\u6709\u6548</li>\n</ul>\n<h3 id=\"723\">7.2.3 \u8bef\u5dee\u754c\u7684\u63a8\u5bfc\u4e0e\u610f\u4e49</h3>\n<p>\u968f\u673aSVD\u7684\u7406\u8bba\u5206\u6790\u63d0\u4f9b\u4e86\u6982\u7387\u8bef\u5dee\u754c\uff0c\u8fd9\u5bf9\u4e8e\u7b97\u6cd5\u53c2\u6570\u9009\u62e9\u81f3\u5173\u91cd\u8981\u3002</p>\n<p><strong>\u4e3b\u8981\u5b9a\u7406</strong>\uff08Halko, Martinsson &amp; Tropp, 2011\uff09\uff1a\n\u8bbe $\\mathbf{A}$ \u7684\u5947\u5f02\u503c\u4e3a $\\sigma_1 \\geq \\sigma_2 \\geq \\cdots \\geq \\sigma_n$\uff0c\u4f7f\u7528\u9ad8\u65af\u968f\u673a\u77e9\u9635\u548c\u8fc7\u91c7\u6837\u53c2\u6570 $p \\geq 2$\uff0c\u90a3\u4e48\uff1a\n$$\\mathbb{E}[|\\mathbf{A} - \\mathbf{QQ}^T\\mathbf{A}|_F] \\leq \\left(1 + \\frac{k}{p-1}\\right)^{1/2} \\left(\\sum_{j=k+1}^n \\sigma_j^2\\right)^{1/2}$$\n<strong>\u8bef\u5dee\u754c\u7684\u89e3\u8bfb</strong>\uff1a</p>\n<ol>\n<li>\u7b2c\u4e00\u9879 $(1 + k/(p-1))^{1/2}$ \u662f\u968f\u673a\u5316\u5e26\u6765\u7684\u989d\u5916\u56e0\u5b50</li>\n<li>\u7b2c\u4e8c\u9879\u662f\u6700\u4f18\u79e9-$k$ \u8fd1\u4f3c\u7684\u8bef\u5dee\uff08\u4e0d\u53ef\u907f\u514d\uff09</li>\n<li>\u8fc7\u91c7\u6837\u53c2\u6570 $p$ \u63a7\u5236\u968f\u673a\u5316\u7684\u8d28\u91cf</li>\n</ol>\n<p><strong>\u5c3e\u90e8\u6982\u7387\u754c</strong>\uff1a\n\u5bf9\u4e8e\u4efb\u610f $t \\geq 1$\uff0c\u4ee5\u81f3\u5c11 $1 - 2t^{-p}$ \u7684\u6982\u7387\uff1a\n$$|\\mathbf{A} - \\mathbf{QQ}^T\\mathbf{A}|_2 \\leq \\left(1 + t\\sqrt{\\frac{k+p}{p-1}}\\right)\\sigma_{k+1} + t\\frac{e\\sqrt{k+p}}{p}\\left(\\sum_{j=k+1}^n \\sigma_j^2\\right)^{1/2}$$\n<strong>\u5b9e\u8df5\u6307\u5bfc</strong>\uff1a</p>\n<ul>\n<li>$p = 5$ \u901a\u5e38\u7ed9\u51fa $1 + k/(p-1) \\approx 1.25$ \u7684\u56e0\u5b50</li>\n<li>$p = 10$ \u65f6\uff0c\u5931\u8d25\u6982\u7387\u5c0f\u4e8e $10^{-10}$</li>\n<li>\u5bf9\u4e8e\u9ad8\u7cbe\u5ea6\u8981\u6c42\uff0c\u4f7f\u7528\u5e42\u8fed\u4ee3\u6bd4\u589e\u52a0 $p$ \u66f4\u6709\u6548</li>\n</ul>\n<h3 id=\"724\">7.2.4 \u81ea\u9002\u5e94\u79e9\u9009\u62e9\u7b56\u7565</h3>\n<p>\u5728\u8bb8\u591a\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u4e8b\u5148\u4e0d\u77e5\u9053\u5408\u9002\u7684\u79e9 $k$\u3002\u81ea\u9002\u5e94\u7b97\u6cd5\u80fd\u591f\u52a8\u6001\u786e\u5b9a\u79e9\uff0c\u4ee5\u6ee1\u8db3\u7ed9\u5b9a\u7684\u7cbe\u5ea6\u8981\u6c42\u3002</p>\n<p><strong>\u589e\u91cf\u5f0f\u968f\u673aSVD</strong>\uff1a</p>\n<ol>\n<li>\u4ece\u5c0f\u7684 $\\ell$ \u5f00\u59cb</li>\n<li>\u9010\u6b65\u589e\u52a0\u91c7\u6837\u5217\uff0c\u76f4\u5230\u6ee1\u8db3\u7cbe\u5ea6\u8981\u6c42</li>\n<li>\u5229\u7528\u5df2\u8ba1\u7b97\u7684\u4fe1\u606f\uff0c\u907f\u514d\u91cd\u590d\u8ba1\u7b97</li>\n</ol>\n<p><strong>\u8bef\u5dee\u4f30\u8ba1\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u4e8e\u8303\u6570\u7684\u4f30\u8ba1</strong>\uff1a\n$$\\text{err}_\\text{est} = |\\mathbf{A} - \\mathbf{QQ}^T\\mathbf{A}|_F \\approx |\\mathbf{A}\\boldsymbol{\\omega} - \\mathbf{QQ}^T\\mathbf{A}\\boldsymbol{\\omega}|_2$$\n\u5176\u4e2d $\\boldsymbol{\\omega}$ \u662f\u968f\u673a\u5411\u91cf</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u5947\u5f02\u503c\u7684\u4f30\u8ba1</strong>\uff1a\n   \u76d1\u63a7\u8ba1\u7b97\u5f97\u5230\u7684\u5947\u5f02\u503c\u7684\u8870\u51cf\u901f\u5ea6</p>\n</li>\n<li>\n<p><strong>\u4ea4\u53c9\u9a8c\u8bc1\u65b9\u6cd5</strong>\uff1a\n   \u4fdd\u7559\u90e8\u5206\u5217\u4f5c\u4e3a\u9a8c\u8bc1\u96c6</p>\n</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u76ee\u6807\uff1a\u627e\u5230\u79e9 k \u4f7f\u5f97 ||A - A_k||_F \u2264 \u03b5||A||_F\n1. \u521d\u59cb\u5316\uff1a\u2113 = k_init, Q = []\n2. while (error_estimate &gt; \u03b5):\n3.     \u751f\u6210\u65b0\u7684\u968f\u673a\u5411\u91cf \u03a9_new\n4.     Y_new = A * \u03a9_new\n5.     \u6b63\u4ea4\u5316\u5e76\u66f4\u65b0 Q\n6.     \u4f30\u8ba1\u8bef\u5dee\n7.     \u2113 = \u2113 + increment\n8. \u8fd4\u56de\u5f53\u524d\u7684 Q \u548c\u5bf9\u5e94\u7684\u79e9\n</code></pre></div>\n\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u975e\u5747\u5300\u91c7\u6837\u7b56\u7565\uff1a\u57fa\u4e8e\u6760\u6746\u5206\u6570\u7684\u91cd\u8981\u6027\u91c7\u6837</li>\n<li>\u6d41\u5f0f\u7b97\u6cd5\uff1a\u5355\u904d\u626b\u63cf\u6570\u636e\u7684\u968f\u673aSVD</li>\n<li>\u5206\u5e03\u5f0f\u968f\u673aSVD\uff1a\u901a\u4fe1\u9ad8\u6548\u7684\u5e76\u884c\u7b97\u6cd5</li>\n</ul>\n<hr />\n<h2 id=\"73-nystrom_1\">7.3 Nystr\u00f6m\u65b9\u6cd5\u7684\u73b0\u4ee3\u89c6\u89d2</h2>\n<p>Nystr\u00f6m\u65b9\u6cd5\u6700\u521d\u6e90\u4e8e\u79ef\u5206\u65b9\u7a0b\u7684\u6570\u503c\u89e3\u6cd5\uff0c\u4f46\u5728\u73b0\u4ee3\u673a\u5668\u5b66\u4e60\u4e2d\u83b7\u5f97\u4e86\u65b0\u751f\u3002\u5b83\u901a\u8fc7\u91c7\u6837\u77e9\u9635\u7684\u884c\u5217\u6765\u6784\u9020\u4f4e\u79e9\u8fd1\u4f3c\uff0c\u5728\u6838\u65b9\u6cd5\u3001\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635\u548c\u5927\u89c4\u6a21\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5904\u7406\u4e2d\u53d1\u6325\u7740\u91cd\u8981\u4f5c\u7528\u3002</p>\n<h3 id=\"731\">7.3.1 \u4ece\u6838\u65b9\u6cd5\u5230\u4e00\u822c\u77e9\u9635\u8fd1\u4f3c</h3>\n<p><strong>\u5386\u53f2\u80cc\u666f</strong>\uff1aNystr\u00f6m\u65b9\u6cd5\u6700\u65e9\u7528\u4e8e\u6c42\u89e3\u7b2c\u4e8c\u7c7bFredholm\u79ef\u5206\u65b9\u7a0b\u3002\u5728\u673a\u5668\u5b66\u4e60\u4e2d\uff0cWilliams\u548cSeeger\uff082001\uff09\u9996\u6b21\u5c06\u5176\u5e94\u7528\u4e8e\u52a0\u901f\u9ad8\u65af\u8fc7\u7a0b\u3002</p>\n<p><strong>\u6838\u77e9\u9635\u7684Nystr\u00f6m\u8fd1\u4f3c</strong>\uff1a\n\u7ed9\u5b9a\u6838\u77e9\u9635 $\\mathbf{K} \\in \\mathbb{R}^{n \\times n}$\uff0cNystr\u00f6m\u65b9\u6cd5\u901a\u8fc7\u91c7\u6837 $\\ell \\ll n$ \u4e2a\u6570\u636e\u70b9\u6765\u8fd1\u4f3c\uff1a</p>\n<ol>\n<li>\u9009\u62e9\u7d22\u5f15\u96c6 $\\mathcal{S} = {i_1, \\ldots, i_\\ell}$</li>\n<li>\u6784\u9020\u5b50\u77e9\u9635\uff1a\n   - $\\mathbf{C} = \\mathbf{K}(:, \\mathcal{S}) \\in \\mathbb{R}^{n \\times \\ell}$\n   - $\\mathbf{W} = \\mathbf{K}(\\mathcal{S}, \\mathcal{S}) \\in \\mathbb{R}^{\\ell \\times \\ell}$</li>\n<li>Nystr\u00f6m\u8fd1\u4f3c\uff1a$\\tilde{\\mathbf{K}} = \\mathbf{CW}^{\\dagger}\\mathbf{C}^T$</li>\n</ol>\n<p><strong>\u63a8\u5e7f\u5230\u4e00\u822c\u77e9\u9635</strong>\uff1a\n\u5bf9\u4e8e\u975e\u5bf9\u79f0\u77e9\u9635 $\\mathbf{A}$\uff0c\u5e7f\u4e49Nystr\u00f6m\u65b9\u6cd5\u9009\u62e9\u884c\u7d22\u5f15 $\\mathcal{I}$ \u548c\u5217\u7d22\u5f15 $\\mathcal{J}$\uff1a\n$$\\tilde{\\mathbf{A}} = \\mathbf{A}(:,\\mathcal{J})\\mathbf{A}(\\mathcal{I},\\mathcal{J})^{\\dagger}\\mathbf{A}(\\mathcal{I},:)$$\n<strong>\u4e0eCUR\u5206\u89e3\u7684\u8054\u7cfb</strong>\uff1a\nNystr\u00f6m\u65b9\u6cd5\u53ef\u4ee5\u770b\u4f5cCUR\u5206\u89e3\u7684\u7279\u4f8b\uff1a</p>\n<ul>\n<li>$\\mathbf{C} = \\mathbf{A}(:,\\mathcal{J})$</li>\n<li>$\\mathbf{U} = \\mathbf{A}(\\mathcal{I},\\mathcal{J})^{\\dagger}$</li>\n<li>$\\mathbf{R} = \\mathbf{A}(\\mathcal{I},:)$</li>\n</ul>\n<h3 id=\"732-vs\">7.3.2 \u5217\u91c7\u6837\u7b56\u7565\uff1a\u5747\u5300vs\u6760\u6746\u5206\u6570</h3>\n<p>\u91c7\u6837\u7b56\u7565\u662fNystr\u00f6m\u65b9\u6cd5\u6027\u80fd\u7684\u5173\u952e\u3002\u4e0d\u540c\u7684\u91c7\u6837\u65b9\u6cd5\u5728\u7406\u8bba\u4fdd\u8bc1\u548c\u5b9e\u9645\u6548\u679c\u4e0a\u6709\u663e\u8457\u5dee\u5f02\u3002</p>\n<ol>\n<li>\n<p><strong>\u5747\u5300\u91c7\u6837</strong>\n- \u7b80\u5355\u76f4\u63a5\uff1a\u6bcf\u5217\u4ee5\u6982\u7387 $\\ell/n$ \u88ab\u9009\u4e2d\n- \u7406\u8bba\u4fdd\u8bc1\u8f83\u5f31\uff0c\u4f46\u5b9e\u73b0\u7b80\u5355\n- \u9002\u7528\u4e8e\u5217\u91cd\u8981\u6027\u76f8\u8fd1\u7684\u60c5\u51b5</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u6760\u6746\u5206\u6570\u7684\u91c7\u6837</strong></p>\n</li>\n</ol>\n<p>\u6760\u6746\u5206\u6570\uff08Leverage Score\uff09\u5ea6\u91cf\u6bcf\u884c/\u5217\u5bf9\u77e9\u9635\u4f4e\u79e9\u7ed3\u6784\u7684\u91cd\u8981\u6027\uff1a\n$$\\ell_i = |\\mathbf{U}_k(i,:)|_2^2$$\n\u5176\u4e2d $\\mathbf{U}_k$ \u662f\u524d $k$ \u4e2a\u5de6\u5947\u5f02\u5411\u91cf\u3002</p>\n<p><strong>\u91c7\u6837\u6982\u7387</strong>\uff1a\n$$p_i = \\min\\left{1, c\\frac{\\ell_i}{k}\\log(k/\\delta)\\right}$$\n<strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\u4ee5\u81f3\u5c11 $1-\\delta$ \u7684\u6982\u7387\uff1a\n$$|\\mathbf{A} - \\tilde{\\mathbf{A}}|_F \\leq (1+\\epsilon)|\\mathbf{A} - \\mathbf{A}_k|_F$$</p>\n<ol start=\"3\">\n<li>\n<p><strong>\u81ea\u9002\u5e94\u91c7\u6837</strong>\n\u8fed\u4ee3\u5730\u9009\u62e9\u6700\u80fd\u51cf\u5c11\u8fd1\u4f3c\u8bef\u5dee\u7684\u5217\uff1a</p>\n</li>\n<li>\n<p>\u521d\u59cb\u5316\uff1a\u968f\u673a\u9009\u62e9\u7b2c\u4e00\u5217</p>\n</li>\n<li>\u8d2a\u5a6a\u9009\u62e9\uff1a\u9009\u62e9\u4f7f\u6b8b\u5dee\u8303\u6570\u6700\u5927\u4e0b\u964d\u7684\u5217</li>\n<li>\n<p>\u7ec8\u6b62\u6761\u4ef6\uff1a\u8fbe\u5230\u76ee\u6807\u79e9\u6216\u7cbe\u5ea6\u8981\u6c42</p>\n</li>\n<li>\n<p><strong>DPP\u91c7\u6837\uff08\u884c\u5217\u5f0f\u70b9\u8fc7\u7a0b\uff09</strong>\n\u57fa\u4e8e\u591a\u6837\u6027\u7684\u91c7\u6837\uff0c\u786e\u4fdd\u9009\u4e2d\u7684\u5217\u5177\u6709\u826f\u597d\u7684\u6761\u4ef6\u6570\uff1a\n$$\\mathbb{P}(\\mathcal{S}) \\propto \\det(\\mathbf{K}_\\mathcal{S})$$\n<strong>\u5b9e\u8df5\u8003\u8651</strong>\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u8ba1\u7b97\u7cbe\u786e\u6760\u6746\u5206\u6570\u672c\u8eab\u9700\u8981SVD\uff0c\u56e0\u6b64\u5e38\u7528\u8fd1\u4f3c\u65b9\u6cd5</li>\n<li>\u5bf9\u4e8e\u6d41\u6570\u636e\uff0c\u4f7f\u7528reservoir sampling\u7684\u53d8\u4f53</li>\n<li>\u6df7\u5408\u7b56\u7565\uff1a\u5148\u7528\u4fbf\u5b9c\u7684\u65b9\u6cd5\u7b5b\u9009\u5019\u9009\uff0c\u518d\u7cbe\u7ec6\u9009\u62e9</li>\n</ul>\n<h3 id=\"733-nystromsvd\">7.3.3 Nystr\u00f6m\u4e0e\u968f\u673aSVD\u7684\u8054\u7cfb</h3>\n<p>\u867d\u7136Nystr\u00f6m\u65b9\u6cd5\u548c\u968f\u673aSVD\u770b\u4f3c\u4e0d\u540c\uff0c\u4f46\u5b83\u4eec\u6709\u6df1\u523b\u7684\u6570\u5b66\u8054\u7cfb\u3002</p>\n<p><strong>\u7edf\u4e00\u89c6\u89d2</strong>\uff1a\n\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u770b\u4f5c\u662f\u5bfb\u627e\u77e9\u9635\u7684\"\u4ee3\u8868\u6027\"\u5b50\u7a7a\u95f4\uff1a</p>\n<ul>\n<li>\u968f\u673aSVD\uff1a\u901a\u8fc7\u968f\u673a\u6295\u5f71\u627e\u5230\u5217\u7a7a\u95f4\u7684\u8fd1\u4f3c\u57fa</li>\n<li>Nystr\u00f6m\uff1a\u901a\u8fc7\u91c7\u6837\u5b9e\u9645\u7684\u5217\u627e\u5230\u5217\u7a7a\u95f4\u7684\u8fd1\u4f3c\u57fa</li>\n</ul>\n<p><strong>\u7b49\u4ef7\u6027\u6761\u4ef6</strong>\uff1a\n\u5f53\u4f7f\u7528\u6b63\u4ea4\u6295\u5f71\u65f6\uff0cNystr\u00f6m\u65b9\u6cd5\u7b49\u4ef7\u4e8e\u7279\u5b9a\u5f62\u5f0f\u7684\u968f\u673aSVD\uff1a</p>\n<ol>\n<li>\u8bbe $\\mathbf{S}$ \u662f\u91c7\u6837\u77e9\u9635\uff08\u6bcf\u5217\u662f\u6807\u51c6\u57fa\u5411\u91cf\uff09</li>\n<li>Nystr\u00f6m\u4f7f\u7528 $\\boldsymbol{\\Omega} = \\mathbf{S}$</li>\n<li>\u968f\u673aSVD\u4f7f\u7528 $\\boldsymbol{\\Omega} = \\mathbf{S}\\mathbf{G}$\uff0c\u5176\u4e2d $\\mathbf{G}$ \u662f\u9ad8\u65af\u968f\u673a\u77e9\u9635</li>\n</ol>\n<p><strong>\u6027\u80fd\u5bf9\u6bd4</strong>\uff1a</p>\n<ul>\n<li><strong>Nystr\u00f6m\u4f18\u52bf</strong>\uff1a</li>\n<li>\u4fdd\u6301\u77e9\u9635\u7a00\u758f\u6027</li>\n<li>\u53ef\u89e3\u91ca\u6027\u66f4\u5f3a\uff08\u4f7f\u7528\u5b9e\u9645\u6570\u636e\u5217\uff09</li>\n<li>\n<p>\u9002\u5408\u6838\u77e9\u9635\u7b49\u6709\u7279\u6b8a\u7ed3\u6784\u7684\u60c5\u51b5</p>\n</li>\n<li>\n<p><strong>\u968f\u673aSVD\u4f18\u52bf</strong>\uff1a</p>\n</li>\n<li>\u7406\u8bba\u4fdd\u8bc1\u66f4\u5f3a</li>\n<li>\u5bf9\u75c5\u6001\u77e9\u9635\u66f4\u9c81\u68d2</li>\n<li>\u5e42\u8fed\u4ee3\u53ef\u663e\u8457\u63d0\u5347\u7cbe\u5ea6</li>\n</ul>\n<p><strong>\u6df7\u5408\u65b9\u6cd5</strong>\uff1a\n\u7ed3\u5408\u4e24\u8005\u4f18\u52bf\u7684\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u7528Nystr\u00f6m\u65b9\u6cd5\u83b7\u5f97\u521d\u59cb\u8fd1\u4f3c</li>\n<li>\u7528\u968f\u673a\u6295\u5f71\u7ec6\u5316\u5b50\u7a7a\u95f4</li>\n<li>\u76f8\u5173\u51fd\u6570\uff1a<code>hybrid_nystrom_rsvd</code></li>\n</ol>\n<h3 id=\"734\">7.3.4 \u5728\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635\u4e0a\u7684\u5e94\u7528</h3>\n<p>\u56fe\u62c9\u666e\u62c9\u65af\u77e9\u9635\u7684\u8c31\u5206\u89e3\u5728\u8c31\u805a\u7c7b\u3001\u56fe\u4fe1\u53f7\u5904\u7406\u7b49\u9886\u57df\u81f3\u5173\u91cd\u8981\u3002Nystr\u00f6m\u65b9\u6cd5\u5728\u6b64\u573a\u666f\u4e0b\u6709\u72ec\u7279\u4f18\u52bf\u3002</p>\n<p><strong>\u56fe\u62c9\u666e\u62c9\u65af\u7684\u7279\u6b8a\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li>\u534a\u6b63\u5b9a\u6027\uff1a\u6240\u6709\u7279\u5f81\u503c\u975e\u8d1f</li>\n<li>\u7a00\u758f\u6027\uff1a\u901a\u5e38\u6bcf\u884c\u53ea\u6709\u5c11\u6570\u975e\u96f6\u5143</li>\n<li>\u5c40\u90e8\u6027\uff1a\u77e9\u9635\u5143\u7d20\u53cd\u6620\u5c40\u90e8\u8fde\u63a5</li>\n</ul>\n<p><strong>Nystr\u00f6m\u5728\u8c31\u805a\u7c7b\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li><strong>\u6807\u51c6\u8c31\u805a\u7c7b</strong>\uff1a\u9700\u8981\u8ba1\u7b97\u524d $k$ \u4e2a\u7279\u5f81\u5411\u91cf\uff0c\u590d\u6742\u5ea6 $\\mathcal{O}(n^3)$</li>\n<li><strong>Nystr\u00f6m\u52a0\u901f</strong>\uff1a\n   - \u91c7\u6837 $\\ell$ \u4e2a\u4ee3\u8868\u6027\u8282\u70b9\n   - \u6784\u9020 $\\ell \\times \\ell$ \u7684\u5c0f\u56fe\u62c9\u666e\u62c9\u65af\n   - \u901a\u8fc7Nystr\u00f6m\u6269\u5c55\u83b7\u5f97\u6240\u6709\u8282\u70b9\u7684\u5d4c\u5165\n   - \u590d\u6742\u5ea6\u964d\u81f3 $\\mathcal{O}(n\\ell^2)$</li>\n</ol>\n<p><strong>\u91c7\u6837\u7b56\u7565\u7684\u7279\u6b8a\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li><strong>\u5ea6\u91c7\u6837</strong>\uff1a\u6839\u636e\u8282\u70b9\u5ea6\u6570\u91c7\u6837\uff0c\u9ad8\u5ea6\u8282\u70b9\u66f4\u53ef\u80fd\u88ab\u9009\u4e2d</li>\n<li><strong>k-\u4e2d\u5fc3\u91c7\u6837</strong>\uff1a\u786e\u4fdd\u91c7\u6837\u8282\u70b9\u5728\u56fe\u4e0a\u5747\u5300\u5206\u5e03</li>\n<li><strong>\u8c31\u91c7\u6837</strong>\uff1a\u57fa\u4e8e\u8fd1\u4f3c\u7279\u5f81\u5411\u91cf\u7684\u6760\u6746\u5206\u6570</li>\n</ol>\n<p><strong>\u8bef\u5dee\u5206\u6790</strong>\uff1a\n\u5bf9\u4e8e\u56fe\u62c9\u666e\u62c9\u65af $\\mathbf{L}$\uff0cNystr\u00f6m\u8fd1\u4f3c\u8bef\u5dee\u4e0e\u56fe\u7684\u6269\u5f20\u6027\u76f8\u5173\uff1a\n$$|\\mathbf{L} - \\tilde{\\mathbf{L}}|_2 \\leq \\frac{\\lambda_{k+1}}{1-\\lambda_{k+1}/\\lambda_n} \\cdot \\text{sampling error}$$\n\u5176\u4e2d $\\lambda_k$ \u662f\u7b2c $k$ \u4e2a\u7279\u5f81\u503c\u3002</p>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u6848\u4f8b</strong>\uff1a</p>\n<ol>\n<li><strong>\u5927\u89c4\u6a21\u793e\u4ea4\u7f51\u7edc\u5206\u6790</strong>\uff1aFacebook\u89c4\u6a21\u7684\u56fe\u8c31\u805a\u7c7b</li>\n<li><strong>\u56fe\u795e\u7ecf\u7f51\u7edc\u52a0\u901f</strong>\uff1a\u901a\u8fc7Nystr\u00f6m\u8fd1\u4f3c\u56fe\u5377\u79ef</li>\n<li><strong>\u52a8\u6001\u56fe\u7684\u589e\u91cf\u66f4\u65b0</strong>\uff1a\u65b0\u8fb9\u52a0\u5165\u65f6\u7684\u5feb\u901f\u8c31\u66f4\u65b0</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u591a\u7ea7Nystr\u00f6m\u65b9\u6cd5\uff1a\u9012\u5f52\u5e94\u7528\u83b7\u5f97\u66f4\u597d\u7684\u8fd1\u4f3c</li>\n<li>\u65f6\u53d8\u56fe\u7684\u5728\u7ebfNystr\u00f6m\u66f4\u65b0</li>\n<li>\u4e0e\u56fe\u91c7\u6837\u7406\u8bba\u7684\u6df1\u5ea6\u7ed3\u5408</li>\n</ul>\n<hr />\n<h2 id=\"74_1\">7.4 \u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</h2>\n<p>\u9884\u6761\u4ef6\u5b50\u662f\u52a0\u901f\u8fed\u4ee3\u6c42\u89e3\u5668\u6536\u655b\u7684\u5173\u952e\u6280\u672f\u3002\u4f20\u7edf\u9884\u6761\u4ef6\u5b50\u7684\u6784\u9020\u5f80\u5f80\u8ba1\u7b97\u5bc6\u96c6\uff0c\u968f\u673a\u5316\u6280\u672f\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5728\u7cbe\u5ea6\u548c\u6548\u7387\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u7684\u65b0\u9014\u5f84\u3002\u672c\u8282\u63a2\u8ba8\u5982\u4f55\u5229\u7528\u968f\u673a\u5316\u601d\u60f3\u8bbe\u8ba1\u9ad8\u6548\u7684\u9884\u6761\u4ef6\u5b50\u3002</p>\n<h3 id=\"741\">7.4.1 \u7a00\u758f\u5316\u9884\u6761\u4ef6\u5b50</h3>\n<p>\u7a00\u758f\u5316\u662f\u6784\u9020\u9884\u6761\u4ef6\u5b50\u7684\u91cd\u8981\u7b56\u7565\uff0c\u901a\u8fc7\u4fdd\u7559\u77e9\u9635\u7684\u4e3b\u8981\u7ed3\u6784\u4fe1\u606f\u540c\u65f6\u5927\u5e45\u51cf\u5c11\u975e\u96f6\u5143\u7d20\u3002</p>\n<p><strong>\u57fa\u672c\u601d\u60f3</strong>\uff1a\n\u7ed9\u5b9a\u7a20\u5bc6\u77e9\u9635 $\\mathbf{A}$\uff0c\u6784\u9020\u7a00\u758f\u77e9\u9635 $\\mathbf{M}$ \u4f7f\u5f97\uff1a</p>\n<ol>\n<li>$\\mathbf{M}$ \u4fdd\u6301 $\\mathbf{A}$ \u7684\u4e3b\u8981\u8c31\u6027\u8d28</li>\n<li>$\\mathbf{M}$ \u7684\u975e\u96f6\u5143\u7d20\u6570\u91cf\u53ef\u63a7</li>\n<li>$\\mathbf{M}^{-1}$ \u6613\u4e8e\u8ba1\u7b97\u6216\u5e94\u7528</li>\n</ol>\n<p><strong>\u968f\u673a\u7a00\u758f\u5316\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9608\u503c\u7a00\u758f\u5316\u4e0e\u968f\u673a\u4fee\u6b63</strong>\n\u57fa\u672c\u9608\u503c\u65b9\u6cd5\u4f1a\u4e22\u5f03\u5c0f\u4e8e $\\tau$ \u7684\u5143\u7d20\uff0c\u4f46\u8fd9\u53ef\u80fd\u7834\u574f\u91cd\u8981\u6027\u8d28\u3002\u968f\u673a\u4fee\u6b63\u7248\u672c\uff1a\n$$\\tilde{a}_{ij} = \\begin{cases}\na_{ij} &amp; \\text{if } |a_{ij}| \\geq \\tau \\\na_{ij}/p_{ij} &amp; \\text{\u4ee5\u6982\u7387 } p_{ij} \\\n0 &amp; \\text{\u4ee5\u6982\u7387 } 1-p_{ij}\n\\end{cases}$$\n\u5176\u4e2d $p_{ij} = \\min(1, |a_{ij}|/\\tau)$ \u786e\u4fdd\u671f\u671b\u503c\u4e0d\u53d8\u3002</p>\n</li>\n<li>\n<p><strong>\u57fa\u4e8e\u91cd\u8981\u6027\u91c7\u6837\u7684\u7a00\u758f\u5316</strong>\n\u5b9a\u4e49\u5143\u7d20\u91cd\u8981\u6027\uff1a\n$$w_{ij} = |a_{ij}| \\cdot (|\\mathbf{A}(i,:)|_2 + |\\mathbf{A}(:,j)|_2)$$\n\u91c7\u6837\u6982\u7387\u6b63\u6bd4\u4e8e\u91cd\u8981\u6027\uff0c\u786e\u4fdd\u5173\u952e\u7ed3\u6784\u5f97\u4ee5\u4fdd\u7559\u3002</p>\n</li>\n<li>\n<p><strong>\u8c31\u7a00\u758f\u5316\uff08Spectral Sparsification\uff09</strong>\n\u5bf9\u4e8e\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\uff0c\u76ee\u6807\u662f\u627e\u5230\u7a00\u758f\u77e9\u9635 $\\mathbf{M}$ \u4f7f\u5f97\uff1a\n$$(1-\\epsilon)\\mathbf{A} \\preceq \\mathbf{M} \\preceq (1+\\epsilon)\\mathbf{A}$$\n\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n</li>\n<li>\n<p>\u8ba1\u7b97\u6709\u6548\u963b\u6297\uff08effective resistance\uff09</p>\n</li>\n<li>\u6839\u636e\u963b\u6297\u8fdb\u884c\u91cd\u8981\u6027\u91c7\u6837</li>\n<li>\u5bf9\u91c7\u6837\u7684\u5143\u7d20\u8fdb\u884c\u9002\u5f53\u7f29\u653e</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\nSpielman\u548cSrivastava (2011) \u8bc1\u660e\u4e86\u53ef\u4ee5\u7528 $\\mathcal{O}(n\\log n/\\epsilon^2)$ \u4e2a\u975e\u96f6\u5143\u7d20\u8fbe\u5230 $(1+\\epsilon)$ \u8fd1\u4f3c\u3002</p>\n<p><strong>\u5b9e\u8df5\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u4fdd\u6301\u5bf9\u79f0\u6027\uff1a\u540c\u65f6\u91c7\u6837 $(i,j)$ \u548c $(j,i)$</li>\n<li>\u4fdd\u6301\u5bf9\u89d2\u4f18\u52bf\uff1a\u4f18\u5148\u4fdd\u7559\u5bf9\u89d2\u5143\u7d20\u9644\u8fd1\u7684\u9879</li>\n<li>\u5206\u5757\u7a00\u758f\u5316\uff1a\u5bf9\u4e0d\u540c\u5757\u4f7f\u7528\u4e0d\u540c\u7684\u7a00\u758f\u5316\u7b56\u7565</li>\n</ul>\n<h3 id=\"742\">7.4.2 \u968f\u673a\u5316\u4e0d\u5b8c\u5168\u5206\u89e3</h3>\n<p>\u4e0d\u5b8c\u5168LU/Cholesky\u5206\u89e3\u662f\u7ecf\u5178\u7684\u9884\u6761\u4ef6\u6280\u672f\uff0c\u968f\u673a\u5316\u53ef\u4ee5\u6539\u5584\u5176\u9c81\u68d2\u6027\u548c\u6548\u7387\u3002</p>\n<p><strong>\u6807\u51c6ILU\u7684\u5c40\u9650\u6027</strong>\uff1a</p>\n<ul>\n<li>\u586b\u5145\u6a21\u5f0f\u7684\u9009\u62e9\u56f0\u96be</li>\n<li>\u5bf9\u6392\u5e8f\u654f\u611f</li>\n<li>\u53ef\u80fd\u9047\u5230\u96f6\u4e3b\u5143</li>\n</ul>\n<p><strong>\u968f\u673a\u5316\u6539\u8fdb\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>\u968f\u673a\u884c\u5217\u7f6e\u6362</strong>\n\u5728\u5206\u89e3\u524d\u8fdb\u884c\u968f\u673a\u7f6e\u6362\uff1a\n$$\\mathbf{PAQ} = \\mathbf{LU} + \\mathbf{E}$$\n\u5176\u4e2d $\\mathbf{P}, \\mathbf{Q}$ \u662f\u968f\u673a\u7f6e\u6362\u77e9\u9635\u3002</li>\n</ol>\n<p>\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u6539\u5584\u6570\u503c\u7a33\u5b9a\u6027</li>\n<li>\u6253\u7834\u75c5\u6001\u7ed3\u6784</li>\n<li>\u591a\u6b21\u8fd0\u884c\u53d6\u6700\u4f73</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u6982\u7387\u9608\u503cILU\uff08Probabilistic ILU\uff09</strong>\n\u4e0d\u662f\u786c\u6027\u4e22\u5f03\u5c0f\u5143\u7d20\uff0c\u800c\u662f\u6982\u7387\u6027\u4fdd\u7559\uff1a\n$$p_{ij}^{(\\text{keep})} = \\min\\left(1, \\frac{|l_{ij}u_{ji}|}{\\tau \\cdot \\text{scale}_{ij}}\\right)$$\n\u5176\u4e2d $\\text{scale}_{ij}$ \u8003\u8651\u4e86\u5c40\u90e8\u77e9\u9635\u8303\u6570\u3002</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u5316\u5217\u4e3b\u5143\u9009\u62e9</strong>\n\u5728\u6bcf\u6b65\u9009\u62e9\u4e3b\u5143\u65f6\u52a0\u5165\u968f\u673a\u6027\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u4e0d\u603b\u662f\u9009\u6700\u5927\u5143\u7d20</li>\n<li>\u4ee5\u6982\u7387\u6b63\u6bd4\u4e8e\u5143\u7d20\u5927\u5c0f\u9009\u62e9</li>\n<li>\u5e73\u8861\u6570\u503c\u7a33\u5b9a\u6027\u548c\u5e76\u884c\u6027</li>\n</ul>\n<p><strong>\u7b97\u6cd5\uff1a\u968f\u673a\u5316ILU(k)</strong></p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u77e9\u9635 A, \u5c42\u7ea7 k, \u968f\u673a\u79cd\u5b50\n1. \u968f\u673a\u7f6e\u6362\uff1aP, Q = random_permutation()\n2. B = PAQ\n3. for i = 1 to n:\n4.     \u8ba1\u7b97\u7b2c i \u884c/\u5217\u7684 ILU \u56e0\u5b50\n5.     \u6982\u7387\u6027\u4fdd\u7559\u586b\u5145\u5143\u7d20\uff08\u57fa\u4e8e\u5c42\u7ea7\u548c\u5927\u5c0f\uff09\n6.     \u968f\u673a\u6270\u52a8\u5c0f\u4e3b\u5143\u907f\u514d\u5d29\u6e83\n7. \u8fd4\u56de L, U \u4f7f\u5f97 B \u2248 LU\n</code></pre></div>\n\n<p><strong>\u5e76\u884c\u5316\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u968f\u673a\u5316\u6709\u52a9\u4e8e\u8d1f\u8f7d\u5747\u8861</li>\n<li>\u5f02\u6b65\u66f4\u65b0\u7684\u6536\u655b\u6027\u66f4\u597d</li>\n<li>\u901a\u4fe1\u6a21\u5f0f\u66f4\u89c4\u5219</li>\n</ul>\n<h3 id=\"743\">7.4.3 \u591a\u7ea7\u9884\u6761\u4ef6\u5b50\u7684\u968f\u673a\u6784\u9020</h3>\n<p>\u591a\u7ea7\uff08\u6216\u591a\u91cd\u7f51\u683c\uff09\u9884\u6761\u4ef6\u5b50\u901a\u8fc7\u5c42\u6b21\u7ed3\u6784\u52a0\u901f\u6c42\u89e3\u3002\u968f\u673a\u5316\u5728\u7c97\u5316\u548c\u63d2\u503c\u7b97\u5b50\u6784\u9020\u4e2d\u53d1\u6325\u91cd\u8981\u4f5c\u7528\u3002</p>\n<p><strong>\u4ee3\u6570\u591a\u91cd\u7f51\u683c\uff08AMG\uff09\u4e2d\u7684\u968f\u673a\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u968f\u673a\u7c97\u5316\u7b56\u7565</strong>\n\u4f20\u7edf\u7684\u5f3a\u8fde\u63a5\u5b9a\u4e49\uff1a\n$$|a_{ij}| \\geq \\theta \\max_{k \\neq i} |a_{ik}|$$\n\u968f\u673a\u5316\u7248\u672c\u8003\u8651\u6982\u7387\u9009\u62e9\uff1a</li>\n</ol>\n<ul>\n<li>\u8fb9\u754c\u60c5\u51b5\u7684\u968f\u673a\u5224\u5b9a</li>\n<li>\u907f\u514d\u8fc7\u5ea6\u89c4\u5219\u7684\u7c97\u7f51\u683c</li>\n<li>\u63d0\u9ad8\u5e76\u884c\u6548\u7387</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u968f\u673a\u63d2\u503c\u7b97\u5b50</strong>\n\u6807\u51c6\u63d2\u503c\u516c\u5f0f\u7684\u968f\u673a\u5316\u589e\u5f3a\uff1a\n$$(\\mathbf{P}x)_i = x_i + \\sum_{j \\in \\mathcal{C}_i} w_{ij}^{(\\text{random})} x_j$$\n\u5176\u4e2d\u6743\u91cd\u5305\u542b\u968f\u673a\u6270\u52a8\uff1a\n$$w_{ij}^{(\\text{random})} = w_{ij}^{(\\text{classical})} \\cdot (1 + \\epsilon \\xi_{ij})$$\n$\\xi_{ij} \\sim \\mathcal{U}(-1, 1)$</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u968f\u673aAMG</strong>\n\u4f7f\u7528\u968f\u673a\u6d4b\u8bd5\u5411\u91cf\u6539\u8fdb\u5c42\u6b21\u7ed3\u6784\uff1a</p>\n</li>\n<li>\n<p>\u751f\u6210\u5149\u6ed1\u8bef\u5dee\u7684\u968f\u673a\u6837\u672c</p>\n</li>\n<li>\u57fa\u4e8e\u6837\u672c\u4f18\u5316\u63d2\u503c\u7b97\u5b50</li>\n<li>\u8fed\u4ee3\u6539\u8fdb\u76f4\u5230\u6ee1\u8db3\u6536\u655b\u8981\u6c42</li>\n</ol>\n<p><strong>\u968f\u673a\u5316\u57df\u5206\u89e3\u9884\u6761\u4ef6\u5b50</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u968f\u673a\u5b50\u57df\u5212\u5206</strong>\n- \u907f\u514d\u89c4\u5219\u7f51\u683c\u7684\u5171\u632f\u95ee\u9898\n- \u6539\u5584\u8d1f\u8f7d\u5747\u8861\n- \u589e\u5f3a\u9c81\u68d2\u6027</p>\n</li>\n<li>\n<p><strong>\u91cd\u53e0\u533a\u57df\u7684\u968f\u673a\u5316</strong>\n- \u968f\u673a\u9009\u62e9\u91cd\u53e0\u5927\u5c0f\n- \u6982\u7387\u6027\u5305\u542b\u8fb9\u754c\u8282\u70b9\n- \u81ea\u9002\u5e94\u8c03\u6574\u91cd\u53e0\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u7c97\u7a7a\u95f4\u7684\u968f\u673a\u6784\u9020</strong>\n\u4f7f\u7528\u968f\u673a\u6295\u5f71\u6784\u9020\u7c97\u7a7a\u95f4\u57fa\uff1a\n$$\\mathbf{Z} = \\text{orth}(\\mathbf{A}\\boldsymbol{\\Omega})$$\n\u5176\u4e2d $\\boldsymbol{\\Omega}$ \u662f\u968f\u673a\u77e9\u9635\u3002</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6784\u9020\u65f6\u95f4\uff1a$\\mathcal{O}(n\\log n)$ vs \u4f20\u7edf\u7684 $\\mathcal{O}(n^{3/2})$</li>\n<li>\u8fed\u4ee3\u6b21\u6570\uff1a\u8f7b\u5fae\u589e\u52a0\u4f46\u53ef\u901a\u8fc7\u591a\u4e2a\u968f\u673a\u5b9e\u73b0\u7f13\u89e3</li>\n<li>\u5e76\u884c\u53ef\u6269\u5c55\u6027\uff1a\u663e\u8457\u6539\u5584</li>\n</ul>\n<h3 id=\"744\">7.4.4 \u5728\u8fed\u4ee3\u6c42\u89e3\u5668\u4e2d\u7684\u96c6\u6210</h3>\n<p>\u5c06\u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u6709\u6548\u96c6\u6210\u5230\u8fed\u4ee3\u6c42\u89e3\u5668\u4e2d\u9700\u8981\u7279\u6b8a\u8003\u8651\u3002</p>\n<p><strong>\u4e0eKrylov\u5b50\u7a7a\u95f4\u65b9\u6cd5\u7684\u7ed3\u5408</strong>\uff1a</p>\n<ol>\n<li><strong>\u9884\u6761\u4ef6\u5171\u8f6d\u68af\u5ea6\u6cd5\uff08PCG\uff09\u7684\u968f\u673a\u5316\u7248\u672c</strong>\n\u6807\u51c6PCG\u4e2d\uff0c\u9884\u6761\u4ef6\u5b50 $\\mathbf{M}$ \u56fa\u5b9a\u3002\u968f\u673a\u5316\u7248\u672c\u4e2d\uff1a</li>\n</ol>\n<ul>\n<li>\u6bcf\u6b21\u8fed\u4ee3\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u968f\u673a\u5b9e\u73b0</li>\n<li>\u9700\u8981\u4fdd\u6301 $\\mathbf{M}$ \u7684\u5bf9\u79f0\u6b63\u5b9a\u6027</li>\n<li>\u6536\u655b\u7406\u8bba\u9700\u8981\u4fee\u6b63</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u7075\u6d3bGMRES\uff08FGMRES\uff09</strong>\nFGMRES\u5141\u8bb8\u53d8\u5316\u7684\u9884\u6761\u4ef6\u5b50\uff0c\u5929\u7136\u9002\u5408\u968f\u673a\u5316\uff1a</li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><code>for k = 1, 2, ...:\n    M_k = random_preconditioner(A, seed_k)\n    z_k = M_k^(-1) * r_k\n    \u66f4\u65b0Krylov\u5b50\u7a7a\u95f4\n</code></pre></div>\n\n<ol start=\"3\">\n<li><strong>\u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u7684\u7ec4\u5408</strong>\n\u591a\u4e2a\u7b80\u5355\u968f\u673a\u9884\u6761\u4ef6\u5b50\u7684\u7ec4\u5408\uff1a\n$$\\mathbf{M}^{-1} = \\sum_{i=1}^s w_i \\mathbf{M}_i^{-1}$$\n\u5176\u4e2d $\\mathbf{M}_i$ \u662f\u4e0d\u540c\u7684\u968f\u673a\u5b9e\u73b0\uff0c$w_i$ \u662f\u6743\u91cd\u3002</li>\n</ol>\n<p><strong>\u5b9e\u7528\u6307\u5357</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u79cd\u5b50\u7ba1\u7406</strong>\n- \u53ef\u91cd\u73b0\u6027\uff1a\u56fa\u5b9a\u79cd\u5b50\u5e8f\u5217\n- \u591a\u6837\u6027\uff1a\u786e\u4fdd\u4e0d\u540c\u5b9e\u73b0\u7684\u72ec\u7acb\u6027\n- \u5e76\u884c\u73af\u5883\uff1a\u6bcf\u4e2a\u8fdb\u7a0b\u72ec\u7acb\u7684\u968f\u673a\u6d41</p>\n</li>\n<li>\n<p><strong>\u8d28\u91cf\u76d1\u63a7</strong>\n- \u5728\u7ebf\u4f30\u8ba1\u6761\u4ef6\u6570\uff1a$\\kappa(\\mathbf{M}^{-1}\\mathbf{A})$\n- \u8ddf\u8e2a\u6b8b\u5dee\u4e0b\u964d\u7387\n- \u81ea\u9002\u5e94\u8c03\u6574\u968f\u673a\u5316\u53c2\u6570</p>\n</li>\n<li>\n<p><strong>\u5931\u8d25\u6062\u590d</strong>\n- \u68c0\u6d4b\u9884\u6761\u4ef6\u5b50\u8d28\u91cf\u5dee\u7684\u60c5\u51b5\n- \u51c6\u5907\u540e\u5907\u7b56\u7565\uff08\u5982\u5bf9\u89d2\u9884\u6761\u4ef6\uff09\n- \u6e10\u8fdb\u5f0f\u6539\u8fdb\u673a\u5236</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u4e0e\u8ba1\u7b97\u6743\u8861</strong>\n- \u5b58\u50a8\u591a\u4e2a\u968f\u673a\u5b9e\u73b0 vs \u52a8\u6001\u751f\u6210\n- \u9884\u8ba1\u7b97 vs \u5728\u7ebf\u6784\u9020\n- \u7cbe\u5ea6\u9700\u6c42 vs \u8ba1\u7b97\u9884\u7b97</p>\n</li>\n</ol>\n<p><strong>\u6848\u4f8b\u7814\u7a76\uff1a\u968f\u673a\u5316ILU\u5728CFD\u4e2d\u7684\u5e94\u7528</strong>\n\u8ba1\u7b97\u6d41\u4f53\u52a8\u529b\u5b66\u7684\u79bb\u6563\u5316\u4ea7\u751f\u5927\u89c4\u6a21\u7a00\u758f\u7ebf\u6027\u7cfb\u7edf\uff1a</p>\n<ul>\n<li>\u95ee\u9898\u89c4\u6a21\uff1a$10^7-10^9$ \u672a\u77e5\u6570</li>\n<li>\u77e9\u9635\u7279\u70b9\uff1a\u975e\u5bf9\u79f0\u3001\u75c5\u6001</li>\n<li>\u4f20\u7edfILU\uff1a\u5185\u5b58\u9700\u6c42\u5927\u3001\u5e76\u884c\u6027\u5dee</li>\n</ul>\n<p>\u968f\u673a\u5316\u6539\u8fdb\uff1a</p>\n<ol>\n<li>\u4f7f\u7528\u6982\u7387\u9608\u503cILU(0.1)</li>\n<li>\u968f\u673a\u884c\u5217\u7f6e\u6362\u6539\u5584\u7a33\u5b9a\u6027</li>\n<li>\u591a\u4e2a\u968f\u673a\u5b9e\u73b0\u7684\u52a0\u6743\u7ec4\u5408</li>\n</ol>\n<p>\u7ed3\u679c\uff1a</p>\n<ul>\n<li>\u5185\u5b58\u4f7f\u7528\u51cf\u5c1140%</li>\n<li>\u5e76\u884c\u6548\u7387\u63d0\u53473\u500d</li>\n<li>\u603b\u6c42\u89e3\u65f6\u95f4\u51cf\u5c1125%</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u968f\u673a\u5316\u9884\u6761\u4ef6\u5b50\u7684\u6700\u4f18\u7ec4\u5408\u7406\u8bba</li>\n<li>\u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u7684\u81ea\u9002\u5e94\u968f\u673a\u5316\u7b56\u7565</li>\n<li>\u91cf\u5b50\u542f\u53d1\u7684\u9884\u6761\u4ef6\u6280\u672f</li>\n</ul>\n<hr />\n<h2 id=\"75_1\">7.5 \u91cf\u5b50\u542f\u53d1\u7684\u91c7\u6837\u7b56\u7565</h2>\n<p>\u91cf\u5b50\u8ba1\u7b97\u7684\u6982\u5ff5\u548c\u6280\u672f\u4e3a\u7ecf\u5178\u7b97\u6cd5\u8bbe\u8ba1\u63d0\u4f9b\u4e86\u65b0\u7684\u7075\u611f\u3002\u867d\u7136\u5927\u89c4\u6a21\u91cf\u5b50\u8ba1\u7b97\u673a\u5c1a\u672a\u5b9e\u73b0\uff0c\u4f46\u91cf\u5b50\u7b97\u6cd5\u7684\u6838\u5fc3\u601d\u60f3\u2014\u2014\u5982\u53e0\u52a0\u3001\u7ea0\u7f20\u548c\u6d4b\u91cf\u2014\u2014\u53ef\u4ee5\u542f\u53d1\u6211\u4eec\u8bbe\u8ba1\u66f4\u9ad8\u6548\u7684\u7ecf\u5178\u968f\u673a\u7b97\u6cd5\u3002\u672c\u8282\u63a2\u8ba8\u8fd9\u4e9b\u91cf\u5b50\u542f\u53d1\u7684\u65b9\u6cd5\u5728\u77e9\u9635\u8ba1\u7b97\u4e2d\u7684\u5e94\u7528\u3002</p>\n<h3 id=\"751\">7.5.1 \u91cf\u5b50\u6001\u91c7\u6837\u7684\u7ecf\u5178\u6a21\u62df</h3>\n<p>\u91cf\u5b50\u8ba1\u7b97\u4e2d\uff0c\u4fe1\u606f\u4ee5\u91cf\u5b50\u6001\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u6d4b\u91cf\u65f6\u6309\u7167\u6982\u7387\u5206\u5e03\u574d\u7f29\u3002\u8fd9\u79cd\u6982\u7387\u6027\u89c6\u89d2\u4e3a\u77e9\u9635\u91c7\u6837\u63d0\u4f9b\u4e86\u65b0\u601d\u8def\u3002</p>\n<p><strong>\u91cf\u5b50\u6001\u8868\u793a\u4e0e\u77e9\u9635\u5143\u7d20</strong>\uff1a\n\u8003\u8651\u77e9\u9635 $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5143\u7d20\u7f16\u7801\u4e3a\"\u91cf\u5b50\u6001\"\uff1a\n$$|\\psi\\rangle = \\sum_{i,j} \\frac{a_{ij}}{|\\mathbf{A}|_F} |i\\rangle|j\\rangle$$\n\u6d4b\u91cf\u8fd9\u4e2a\u6001\u5f97\u5230\u7d22\u5f15 $(i,j)$ \u7684\u6982\u7387\u4e3a\uff1a\n$$p_{ij} = \\frac{|a_{ij}|^2}{|\\mathbf{A}|_F^2}$$\n<strong>\u57fa\u4e8e\u91cf\u5b50\u6001\u7684\u91cd\u8981\u6027\u91c7\u6837</strong>\uff1a</p>\n<ol>\n<li><strong>Frobenius\u8303\u6570\u91c7\u6837</strong>\n\u76f4\u63a5\u6a21\u62df\u91cf\u5b50\u6d4b\u91cf\u8fc7\u7a0b\uff1a</li>\n</ol>\n<ul>\n<li>\u91c7\u6837\u6982\u7387\uff1a$p_{ij} \\propto |a_{ij}|^2$</li>\n<li>\u4f30\u8ba1\u5668\uff1a$\\tilde{a}_{ij} = \\frac{|\\mathbf{A}|_F^2}{s \\cdot a_{ij}}$ \uff08$s$ \u662f\u91c7\u6837\u6570\uff09</li>\n<li>\u5e94\u7528\uff1a\u77e9\u9635\u8303\u6570\u4f30\u8ba1\u3001\u8ff9\u4f30\u8ba1</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u5947\u5f02\u503c\u76f8\u5173\u7684\u91cf\u5b50\u6001</strong>\n\u6784\u9020\u4e0e\u5947\u5f02\u503c\u5206\u89e3\u76f8\u5173\u7684\u91cf\u5b50\u6001\uff1a\n$$|\\phi_k\\rangle = \\sigma_k |\\mathbf{u}_k\\rangle|\\mathbf{v}_k\\rangle$$\n\u8fd9\u542f\u53d1\u4e86\u57fa\u4e8e\u8c31\u4fe1\u606f\u7684\u91c7\u6837\u7b56\u7565\u3002</p>\n</li>\n<li>\n<p><strong>\u7ea0\u7f20\u6001\u542f\u53d1\u7684\u76f8\u5173\u91c7\u6837</strong>\n\u91cf\u5b50\u7ea0\u7f20\u6697\u793a\u4e86\u77e9\u9635\u4e0d\u540c\u90e8\u5206\u4e4b\u95f4\u7684\u76f8\u5173\u6027\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u884c\u5217\u8054\u5408\u91c7\u6837\uff1a\u540c\u65f6\u9009\u62e9\u76f8\u5173\u7684\u884c\u548c\u5217</li>\n<li>\u5757\u91c7\u6837\uff1a\u4fdd\u6301\u5c40\u90e8\u7ed3\u6784\u7684\u5b8c\u6574\u6027</li>\n<li>\u76f8\u5173\u6027\u4f20\u64ad\uff1a\u57fa\u4e8e\u77e9\u9635\u6a21\u5f0f\u7684\u91c7\u6837\u4f9d\u8d56</li>\n</ul>\n<p><strong>\u91cf\u5b50\u632f\u5e45\u653e\u5927\u7684\u7ecf\u5178\u7c7b\u6bd4</strong>\uff1a\nGrover\u7b97\u6cd5\u901a\u8fc7\u632f\u5e45\u653e\u5927\u627e\u5230\u6807\u8bb0\u9879\u3002\u7ecf\u5178\u7c7b\u6bd4\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5747\u5300\u91c7\u6837</li>\n<li>\u57fa\u4e8e\u5f53\u524d\u4f30\u8ba1\u8c03\u6574\u91c7\u6837\u6743\u91cd</li>\n<li>\u8fed\u4ee3\u653e\u5927\u91cd\u8981\u5143\u7d20\u7684\u91c7\u6837\u6982\u7387</li>\n</ol>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u521d\u59cb\u5316\uff1auniform_weights\nfor iteration = 1 to T:\n    \u91c7\u6837\u4e00\u6279\u5143\u7d20\n    \u8bc4\u4f30\u91cd\u8981\u6027\uff08\u5982\u5bf9\u76ee\u6807\u51fd\u6570\u7684\u8d21\u732e\uff09\n    \u66f4\u65b0\u6743\u91cd\uff1a\u653e\u5927\u91cd\u8981\u5143\u7d20\n    \u5f52\u4e00\u5316\u6743\u91cd\n\u8fd4\u56de\u57fa\u4e8e\u6700\u7ec8\u6743\u91cd\u7684\u91c7\u6837\u7ed3\u679c\n</code></pre></div>\n\n<h3 id=\"752\">7.5.2 \u91cd\u8981\u6027\u91c7\u6837\u7684\u65b0\u89c6\u89d2</h3>\n<p>\u91cf\u5b50\u6d4b\u91cf\u7684\u6982\u7387\u89e3\u91ca\u4e3a\u91cd\u8981\u6027\u91c7\u6837\u63d0\u4f9b\u4e86\u65b0\u7684\u7406\u8bba\u6846\u67b6\u3002</p>\n<p><strong>\u91cf\u5b50\u6d4b\u91cf\u4e0e\u7ecf\u5178\u91c7\u6837\u7684\u5bf9\u5e94</strong>\uff1a</p>\n<ul>\n<li>\u91cf\u5b50\u6001\u5236\u5907 \u2194 \u6982\u7387\u5206\u5e03\u8bbe\u8ba1</li>\n<li>\u91cf\u5b50\u6d4b\u91cf \u2194 \u968f\u673a\u91c7\u6837</li>\n<li>\u6d4b\u91cf\u540e\u574d\u7f29 \u2194 \u6761\u4ef6\u6982\u7387\u66f4\u65b0</li>\n</ul>\n<p><strong>\u6700\u4f18\u91c7\u6837\u5206\u5e03\u7684\u91cf\u5b50\u542f\u53d1\u8bbe\u8ba1</strong>\uff1a</p>\n<ol>\n<li><strong>\u80fd\u91cf\u57fa\u6001\u91c7\u6837</strong>\n\u501f\u9274\u91cf\u5b50\u7cfb\u7edf\u8d8b\u5411\u6700\u4f4e\u80fd\u91cf\u6001\u7684\u539f\u7406\uff1a\n$$p_i \\propto \\exp(-\\beta E_i)$$\n\u5176\u4e2d $E_i$ \u662f\u4e0e\u77e9\u9635\u5143\u7d20 $i$ \u76f8\u5173\u7684\"\u80fd\u91cf\"\u3002</li>\n</ol>\n<p>\u5bf9\u4e8e\u77e9\u9635\u8fd1\u4f3c\uff0c\u5b9a\u4e49\u80fd\u91cf\uff1a\n$$E_{ij} = -\\log|a_{ij}| - \\alpha\\log(\\text{row_importance}_i \\cdot \\text{col_importance}_j)$$</p>\n<ol start=\"2\">\n<li>\n<p><strong>\u91cf\u5b50\u9000\u706b\u542f\u53d1\u7684\u81ea\u9002\u5e94\u91c7\u6837</strong>\n\u6a21\u62df\u91cf\u5b50\u9000\u706b\u8fc7\u7a0b\uff1a</p>\n</li>\n<li>\n<p>\u9ad8\u6e29\u9636\u6bb5\uff1a\u63a5\u8fd1\u5747\u5300\u91c7\u6837\uff08\u63a2\u7d22\uff09</p>\n</li>\n<li>\u964d\u6e29\u8fc7\u7a0b\uff1a\u9010\u6e10\u805a\u7126\u4e8e\u91cd\u8981\u5143\u7d20\uff08\u5229\u7528\uff09</li>\n<li>\u4f4e\u6e29\u9636\u6bb5\uff1a\u96c6\u4e2d\u4e8e\u6700\u91cd\u8981\u7684\u5143\u7d20\uff08\u7cbe\u70bc\uff09</li>\n</ol>\n<p>\u6e29\u5ea6\u8c03\u5ea6\uff1a\n$$\\beta(t) = \\beta_0 \\cdot \\left(\\frac{\\beta_f}{\\beta_0}\\right)^{t/T}$$</p>\n<ol start=\"3\">\n<li><strong>\u591a\u4f53\u7cfb\u7edf\u542f\u53d1\u7684\u76f8\u4e92\u4f5c\u7528\u91c7\u6837</strong>\n\u8003\u8651\u77e9\u9635\u5143\u7d20\u4e4b\u95f4\u7684\"\u76f8\u4e92\u4f5c\u7528\"\uff1a\n$$p_{ij} \\propto |a_{ij}|^2 \\cdot \\exp\\left(\\sum_{(k,\\ell) \\in \\mathcal{N}(i,j)} J_{ij,k\\ell} \\cdot \\mathbb{I}[(k,\\ell) \\text{ \u5df2\u91c7\u6837}]\\right)$$\n\u5176\u4e2d $J_{ij,k\\ell}$ \u8868\u793a\u5143\u7d20\u95f4\u7684\u8026\u5408\u5f3a\u5ea6\u3002</li>\n</ol>\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a\n\u4f7f\u7528\u91cf\u5b50\u4fe1\u606f\u8bba\u7684\u5de5\u5177\u5206\u6790\u91c7\u6837\u6548\u7387\uff1a</p>\n<ul>\n<li>Von Neumann\u71b5\uff1a\u8861\u91cf\u91c7\u6837\u5206\u5e03\u7684\u4fe1\u606f\u91cf</li>\n<li>\u76f8\u5bf9\u71b5\uff1a\u6bd4\u8f83\u91c7\u6837\u5206\u5e03\u4e0e\u76ee\u6807\u5206\u5e03</li>\n<li>\u7ea0\u7f20\u71b5\uff1a\u91cf\u5316\u4e0d\u540c\u91c7\u6837\u7ef4\u5ea6\u7684\u76f8\u5173\u6027</li>\n</ul>\n<h3 id=\"753\">7.5.3 \u77e9\u9635\u5143\u7d20\u7684\u9ad8\u6548\u4f30\u8ba1</h3>\n<p>\u91cf\u5b50\u7b97\u6cd5\u5e38\u901a\u8fc7\u5de7\u5999\u7684\u5e72\u6d89\u6548\u5e94\u5b9e\u73b0\u6307\u6570\u52a0\u901f\u3002\u867d\u7136\u7ecf\u5178\u7b97\u6cd5\u65e0\u6cd5\u76f4\u63a5\u5b9e\u73b0\u91cf\u5b50\u5e72\u6d89\uff0c\u4f46\u53ef\u4ee5\u501f\u9274\u5176\u6838\u5fc3\u601d\u60f3\u3002</p>\n<p><strong>\u91cf\u5b50\u76f8\u4f4d\u4f30\u8ba1\u7684\u7ecf\u5178\u7c7b\u6bd4</strong>\uff1a</p>\n<ol>\n<li><strong>\u76f8\u4f4d\u7f16\u7801\u65b9\u6cd5</strong>\n\u5c06\u77e9\u9635\u4fe1\u606f\u7f16\u7801\u5728\u590d\u6570\u76f8\u4f4d\u4e2d\uff1a\n$$z_{ij} = |a_{ij}| \\exp(i\\theta_{ij})$$\n\u901a\u8fc7\u91c7\u6837\u4f30\u8ba1\uff1a</li>\n</ol>\n<ul>\n<li>\u5e45\u5ea6\uff1a\u591a\u6b21\u91c7\u6837\u7684\u5e73\u5747</li>\n<li>\u76f8\u4f4d\uff1a\u5229\u7528\u4e09\u89d2\u6052\u7b49\u5f0f</li>\n</ul>\n<ol start=\"2\">\n<li><strong>Hadamard\u6d4b\u8bd5\u7684\u7ecf\u5178\u7248\u672c</strong>\n\u91cf\u5b50Hadamard\u6d4b\u8bd5\u4f30\u8ba1 $\\langle\\psi|\\mathbf{U}|\\phi\\rangle$\u3002\u7ecf\u5178\u7c7b\u6bd4\uff1a</li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><code>\u5bf9\u4e8e\u4f30\u8ba1 x^T A y:\n1. \u751f\u6210\u968f\u673a\u7b26\u53f7\u5411\u91cf s\n2. \u8ba1\u7b97 z1 = (x + sy)^T A (x + sy)\n3. \u8ba1\u7b97 z2 = (x - sy)^T A (x - sy)\n4. \u4f30\u8ba1\uff1a(z1 - z2) / 4 \u2248 Re(x^T A y)\n</code></pre></div>\n\n<ol start=\"3\">\n<li>\n<p><strong>\u4ea4\u6362\u6d4b\u8bd5\u7684\u63a8\u5e7f</strong>\n\u4f30\u8ba1\u4e24\u4e2a\u77e9\u9635\u7684\u76f8\u4f3c\u5ea6\uff1a\n$$\\text{similarity}(\\mathbf{A}, \\mathbf{B}) = \\frac{\\text{Tr}(\\mathbf{A}^T\\mathbf{B})}{|\\mathbf{A}|_F |\\mathbf{B}|_F}$$\n\u91cf\u5b50\u542f\u53d1\u7684\u4f30\u8ba1\uff1a</p>\n</li>\n<li>\n<p>\u8054\u5408\u91c7\u6837\uff1a\u540c\u65f6\u4ece $\\mathbf{A}$ \u548c $\\mathbf{B}$ \u91c7\u6837</p>\n</li>\n<li>\u76f8\u5173\u6027\u5229\u7528\uff1a\u57fa\u4e8e\u4e00\u4e2a\u77e9\u9635\u7684\u91c7\u6837\u6307\u5bfc\u53e6\u4e00\u4e2a</li>\n<li>\u591a\u5c3a\u5ea6\u65b9\u6cd5\uff1a\u4e0d\u540c\u5206\u8fa8\u7387\u7684\u5d4c\u5957\u91c7\u6837</li>\n</ol>\n<p><strong>\u77e9\u9635\u51fd\u6570\u7684\u91cf\u5b50\u542f\u53d1\u4f30\u8ba1</strong>\uff1a</p>\n<ol>\n<li><strong>\u77e9\u9635\u6307\u6570\u7684\u91c7\u6837\u4f30\u8ba1</strong>\n\u5bf9\u4e8e $\\exp(\\mathbf{A})$\uff0c\u5229\u7528\u6cf0\u52d2\u5c55\u5f00\uff1a\n$$\\exp(\\mathbf{A}) = \\sum_{k=0}^{\\infty} \\frac{\\mathbf{A}^k}{k!}$$\n\u91cf\u5b50\u542f\u53d1\u7684\u968f\u673a\u4f30\u8ba1\uff1a</li>\n</ol>\n<ul>\n<li>\u6309\u6982\u7387 $p_k \\propto 1/k!$ \u9009\u62e9\u9636\u6570</li>\n<li>\u4f7f\u7528\u968f\u673a\u884c\u8d70\u4f30\u8ba1 $\\mathbf{A}^k$</li>\n<li>\u91cd\u8981\u6027\u91c7\u6837\u4fee\u6b63\u504f\u5dee</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u77e9\u9635\u5bf9\u6570\u548c\u5e73\u65b9\u6839</strong>\n\u5229\u7528\u8fde\u5206\u6570\u5c55\u5f00\u548c\u968f\u673a\u903c\u8fd1\uff1a\n$$\\log(\\mathbf{I} + \\mathbf{A}) = \\mathbf{A} - \\frac{\\mathbf{A}^2}{2} + \\frac{\\mathbf{A}^3}{3} - \\cdots$$</li>\n</ol>\n<p>\u81ea\u9002\u5e94\u622a\u65ad\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u76d1\u63a7\u7ea7\u6570\u6536\u655b</li>\n<li>\u57fa\u4e8e\u8bef\u5dee\u4f30\u8ba1\u52a8\u6001\u8c03\u6574</li>\n<li>\u5229\u7528\u77e9\u9635\u8303\u6570\u754c\u4f18\u5316</li>\n</ul>\n<h3 id=\"754\">7.5.4 \u4e0e\u4f20\u7edf\u8499\u7279\u5361\u7f57\u65b9\u6cd5\u7684\u5bf9\u6bd4</h3>\n<p>\u91cf\u5b50\u542f\u53d1\u65b9\u6cd5\u4e0e\u4f20\u7edf\u8499\u7279\u5361\u7f57\u65b9\u6cd5\u7684\u672c\u8d28\u533a\u522b\u5728\u4e8e\u5bf9\u6982\u7387\u548c\u76f8\u5173\u6027\u7684\u5904\u7406\u3002</p>\n<p><strong>\u5173\u952e\u5dee\u5f02</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6982\u7387\u5206\u5e03\u8bbe\u8ba1</strong>\n- \u4f20\u7edfMC\uff1a\u57fa\u4e8e\u7ecf\u9a8c\u6216\u7b80\u5355\u89c4\u5219\n- \u91cf\u5b50\u542f\u53d1\uff1a\u5229\u7528\u7269\u7406\u76f4\u89c9\u548c\u6700\u4f18\u6027\u539f\u7406</p>\n</li>\n<li>\n<p><strong>\u76f8\u5173\u6027\u5229\u7528</strong>\n- \u4f20\u7edfMC\uff1a\u72ec\u7acb\u91c7\u6837\u4e3a\u4e3b\n- \u91cf\u5b50\u542f\u53d1\uff1a\u5f3a\u8c03\u76f8\u5173\u6027\u548c\u7ea0\u7f20</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u673a\u5236</strong>\n- \u4f20\u7edfMC\uff1a\u56fa\u5b9a\u6216\u7b80\u5355\u81ea\u9002\u5e94\n- \u91cf\u5b50\u542f\u53d1\uff1a\u591a\u5c42\u6b21\u3001\u591a\u5c3a\u5ea6\u81ea\u9002\u5e94</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u6bd4\u8f83\u5b9e\u9a8c</strong>\uff1a\n\u5728\u6807\u51c6\u6d4b\u8bd5\u77e9\u9635\u4e0a\u7684\u6bd4\u8f83\uff1a</p>\n<p>| \u65b9\u6cd5 | \u76f8\u5bf9\u8bef\u5dee | \u91c7\u6837\u590d\u6742\u5ea6 | \u5e76\u884c\u6548\u7387 |</p>\n<table>\n<thead>\n<tr>\n<th>\u65b9\u6cd5</th>\n<th>\u76f8\u5bf9\u8bef\u5dee</th>\n<th>\u91c7\u6837\u590d\u6742\u5ea6</th>\n<th>\u5e76\u884c\u6548\u7387</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u5747\u5300MC</td>\n<td>1.0</td>\n<td>$O(1/\\epsilon^2)$</td>\n<td>100%</td>\n</tr>\n<tr>\n<td>\u91cd\u8981\u6027\u91c7\u6837</td>\n<td>0.3-0.5</td>\n<td>$O(1/\\epsilon^{1.5})$</td>\n<td>95%</td>\n</tr>\n<tr>\n<td>\u91cf\u5b50\u542f\u53d1</td>\n<td>0.1-0.3</td>\n<td>$O(1/\\epsilon^{1.2})$</td>\n<td>85%</td>\n</tr>\n</tbody>\n</table>\n<p><strong>\u6df7\u5408\u7b56\u7565</strong>\uff1a\n\u7ed3\u5408\u4e24\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u9636\u6bb5\uff1a\u91cf\u5b50\u542f\u53d1\u63a2\u7d22</li>\n<li>\u4e2d\u95f4\u9636\u6bb5\uff1a\u91cd\u8981\u6027\u91c7\u6837\u7cbe\u5316</li>\n<li>\u6700\u7ec8\u9636\u6bb5\uff1a\u786e\u5b9a\u6027\u4fee\u6b63</li>\n</ol>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u6848\u4f8b</strong>\uff1a</p>\n<ol>\n<li><strong>\u5927\u89c4\u6a21\u63a8\u8350\u7cfb\u7edf</strong>\n\u95ee\u9898\uff1a$10^8 \\times 10^7$ \u7684\u7528\u6237-\u7269\u54c1\u77e9\u9635</li>\n</ol>\n<ul>\n<li>\u4f20\u7edfSVD\uff1a\u4e0d\u53ef\u884c</li>\n<li>\u968f\u673aSVD\uff1a2\u5c0f\u65f6</li>\n<li>\u91cf\u5b50\u542f\u53d1\u91c7\u6837\uff1a45\u5206\u949f\uff0c\u76f8\u4f3c\u7cbe\u5ea6</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u91d1\u878d\u98ce\u9669\u77e9\u9635</strong>\n\u95ee\u9898\uff1a\u8ba1\u7b97\u5927\u89c4\u6a21\u76f8\u5173\u77e9\u9635\u7684\u51fd\u6570</li>\n</ol>\n<ul>\n<li>\u8499\u7279\u5361\u7f57\uff1a\u6536\u655b\u6162\uff0c\u65b9\u5dee\u5927</li>\n<li>\u91cf\u5b50\u542f\u53d1\uff1a\u5229\u7528\u5e02\u573a\u7ed3\u6784\uff0c\u5feb\u901f\u6536\u655b</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5206\u5b50\u6a21\u62df</strong>\n\u95ee\u9898\uff1a\u91cf\u5b50\u5316\u5b66\u4e2d\u7684\u5927\u89c4\u6a21\u77e9\u9635</li>\n</ol>\n<ul>\n<li>\u76f4\u63a5\u65b9\u6cd5\uff1a$O(N^3)$</li>\n<li>\u91cf\u5b50\u542f\u53d1\u91c7\u6837\uff1a$O(N^{1.5})$\uff0c\u5316\u5b66\u7cbe\u5ea6</li>\n</ul>\n<p><strong>\u672a\u6765\u5c55\u671b</strong>\uff1a</p>\n<ul>\n<li>\u771f\u5b9e\u91cf\u5b50\u8bbe\u5907\u7684\u96c6\u6210\uff1aNISQ\u65f6\u4ee3\u7684\u6df7\u5408\u7b97\u6cd5</li>\n<li>\u5f20\u91cf\u7f51\u7edc\u4e0e\u91cf\u5b50\u542f\u53d1\u7684\u7ed3\u5408</li>\n<li>\u673a\u5668\u5b66\u4e60\u4f18\u5316\u7684\u91c7\u6837\u7b56\u7565</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u91cf\u5b50\u4f18\u52bf\u7684\u7ecf\u5178\u6a21\u62df\u6781\u9650</li>\n<li>\u65b0\u578b\u91cf\u5b50\u7b97\u6cd5\u7684\u7ecf\u5178\u5316</li>\n<li>\u91cf\u5b50-\u7ecf\u5178\u6df7\u5408\u7b97\u6cd5\u7684\u7406\u8bba\u6846\u67b6</li>\n</ul>"
  },
  "../chapter12.md": {
    "hash": "99949f9283ead5134e90b50b60404268",
    "content": "<h1 id=\"12\">\u7b2c12\u7ae0\uff1a\u7ed3\u6784\u5316\u77e9\u9635\u7684\u5feb\u901f\u7b97\u6cd5</h1>\n<p>\u5728\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u4e2d\uff0c\u5229\u7528\u77e9\u9635\u7684\u7279\u6b8a\u7ed3\u6784\u662f\u5b9e\u73b0\u9ad8\u6548\u7b97\u6cd5\u7684\u5173\u952e\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u51e0\u7c7b\u91cd\u8981\u7684\u7ed3\u6784\u5316\u77e9\u9635\uff1aToeplitz\u77e9\u9635\u3001\u5faa\u73af\u77e9\u9635\u3001Kronecker\u79ef\u7ed3\u6784\u4ee5\u53ca\u5206\u5c42\u77e9\u9635\uff08H-matrices\uff09\u3002\u6211\u4eec\u5c06\u5b66\u4e60\u5982\u4f55\u5229\u7528\u8fd9\u4e9b\u7ed3\u6784\u8bbe\u8ba1\u4e9a\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\uff0c\u5e76\u63a2\u8ba8\u5176\u5728\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u7279\u522b\u662f\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5e94\u7528\u3002\u8fd9\u4e9b\u6280\u672f\u4e0d\u4ec5\u80fd\u663e\u8457\u964d\u4f4e\u8ba1\u7b97\u590d\u6742\u5ea6\uff0c\u8fd8\u80fd\u5927\u5e45\u51cf\u5c11\u5185\u5b58\u5360\u7528\uff0c\u5bf9\u4e8e\u90e8\u7f72\u5927\u89c4\u6a21AI\u6a21\u578b\u81f3\u5173\u91cd\u8981\u3002</p>\n<h2 id=\"121-toeplitzfft\">12.1 Toeplitz\u4e0e\u5faa\u73af\u77e9\u9635\u7684FFT\u6280\u5de7</h2>\n<h3 id=\"1211-toeplitz\">12.1.1 Toeplitz\u77e9\u9635\u7684\u7ed3\u6784\u4e0e\u6027\u8d28</h3>\n<p>Toeplitz\u77e9\u9635\u662f\u4e00\u7c7b\u6cbf\u5bf9\u89d2\u7ebf\u5143\u7d20\u76f8\u540c\u7684\u77e9\u9635\uff0c\u5f62\u5f0f\u4e3a\uff1a</p>\n<p>$$\\mathbf{T} = \\begin{bmatrix}\nt_0 &amp; t_{-1} &amp; t_{-2} &amp; \\cdots &amp; t_{-(n-1)} \\\nt_1 &amp; t_0 &amp; t_{-1} &amp; \\cdots &amp; t_{-(n-2)} \\\nt_2 &amp; t_1 &amp; t_0 &amp; \\cdots &amp; t_{-(n-3)} \\\n\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\nt_{n-1} &amp; t_{n-2} &amp; t_{n-3} &amp; \\cdots &amp; t_0\n\\end{bmatrix}$$\n\u8fd9\u79cd\u77e9\u9635\u4ec5\u9700\u8981$2n-1$\u4e2a\u53c2\u6570\u5b8c\u5168\u786e\u5b9a\uff0c\u76f8\u6bd4\u4e00\u822c$n \\times n$\u77e9\u9635\u7684$n^2$\u4e2a\u53c2\u6570\uff0c\u5b58\u50a8\u6548\u7387\u5927\u5e45\u63d0\u5347\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0cToeplitz\u7ed3\u6784\u5141\u8bb8\u4f7f\u7528\u5feb\u901f\u7b97\u6cd5\u8fdb\u884c\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5\u3002</p>\n<p><strong>\u6df1\u5165\u7406\u89e3Toeplitz\u7ed3\u6784</strong>\uff1a\n\u4ece\u4fe1\u53f7\u5904\u7406\u89d2\u5ea6\u770b\uff0cToeplitz\u77e9\u9635\u4ee3\u8868\u7ebf\u6027\u65f6\u4e0d\u53d8\uff08LTI\uff09\u7cfb\u7edf\u3002\u77e9\u9635\u5143\u7d20$t_k$\u5b9e\u9645\u4e0a\u662f\u7cfb\u7edf\u7684\u8109\u51b2\u54cd\u5e94\u3002\u8fd9\u79cd\u8054\u7cfb\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u501f\u7528\u4fe1\u53f7\u5904\u7406\u7684\u4e30\u5bcc\u7406\u8bba\u5de5\u5177\u3002</p>\n<p><strong>\u5173\u952e\u6027\u8d28</strong>\uff1a</p>\n<ol>\n<li><strong>\u4f4d\u79fb\u4e0d\u53d8\u6027</strong>\uff1a\u82e5$\\mathbf{T}\\mathbf{x} = \\mathbf{y}$\uff0c\u5219$\\mathbf{T}\\mathbf{S}\\mathbf{x} = \\mathbf{S}\\mathbf{y}$\uff0c\u5176\u4e2d$\\mathbf{S}$\u662f\u5faa\u73af\u4f4d\u79fb\u7b97\u5b50</li>\n<li><strong>\u4e0e\u5377\u79ef\u7684\u8054\u7cfb</strong>\uff1a\u6709\u9650\u957f\u5e8f\u5217\u7684\u7ebf\u6027\u5377\u79ef$(h * x)[n] = \\sum_{k} h[k]x[n-k]$\u53ef\u8868\u793a\u4e3aToeplitz\u77e9\u9635\u4e58\u6cd5</li>\n<li><strong>\u8c31\u6027\u8d28</strong>\uff1aToeplitz\u77e9\u9635\u7684\u7279\u5f81\u503c\u5206\u5e03\u4e0e\u751f\u6210\u51fd\u6570\u7684Fourier\u7cfb\u6570\u5bc6\u5207\u76f8\u5173</li>\n<li><strong>\u6e10\u8fd1\u8c31\u5206\u5e03</strong>\uff1a\u5bf9\u4e8e\u7531\u8fde\u7eed\u51fd\u6570$f(\\theta)$\u751f\u6210\u7684Toeplitz\u5e8f\u5217\uff0c\u5176\u7279\u5f81\u503c\u6e10\u8fd1\u5206\u5e03\u4e8e$f$\u7684\u503c\u57df\uff08Szeg\u0151\u5b9a\u7406\uff09</li>\n</ol>\n<p><strong>\u751f\u6210\u51fd\u6570\u89c6\u89d2</strong>\uff1a\n\u7ed9\u5b9aToeplitz\u77e9\u9635$\\mathbf{T}_n$\uff0c\u5b9a\u4e49\u5176\u751f\u6210\u51fd\u6570\uff08\u6216\u7b26\u53f7\uff09\uff1a\n$$f(\\theta) = \\sum_{k=-(n-1)}^{n-1} t_k e^{ik\\theta}$$\n\u8fd9\u4e2a\u51fd\u6570\u5b8c\u5168\u523b\u753b\u4e86\u77e9\u9635\u7684\u6e10\u8fd1\u884c\u4e3a\u3002\u4f8b\u5982\uff1a</p>\n<ul>\n<li>\u82e5$f(\\theta) &gt; 0$\u5bf9\u6240\u6709$\\theta$\u6210\u7acb\uff0c\u5219\u5bf9\u5145\u5206\u5927\u7684$n$\uff0c$\\mathbf{T}_n$\u6b63\u5b9a</li>\n<li>\u77e9\u9635\u7684\u6761\u4ef6\u6570\u4e0e$\\max|f(\\theta)|/\\min|f(\\theta)|$\u76f8\u5173</li>\n</ul>\n<p><strong>\u5757Toeplitz\u77e9\u9635</strong>\uff1a\n\u5728\u591a\u901a\u9053\u4fe1\u53f7\u5904\u7406\u548cMIMO\u7cfb\u7edf\u4e2d\uff0c\u7ecf\u5e38\u9047\u5230\u5757Toeplitz\u77e9\u9635\uff1a\n$$\\mathbf{T}_{\\text{block}} = \\begin{bmatrix}\n\\mathbf{T}_0 &amp; \\mathbf{T}_{-1} &amp; \\cdots &amp; \\mathbf{T}_{-(m-1)} \\\n\\mathbf{T}_1 &amp; \\mathbf{T}_0 &amp; \\cdots &amp; \\mathbf{T}_{-(m-2)} \\\n\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\n\\mathbf{T}_{m-1} &amp; \\mathbf{T}_{m-2} &amp; \\cdots &amp; \\mathbf{T}_0\n\\end{bmatrix}$$\n\u5176\u4e2d\u6bcf\u4e2a$\\mathbf{T}_k$\u672c\u8eab\u662f\u77e9\u9635\u3002\u8fd9\u79cd\u7ed3\u6784\u5728\u591a\u7ef4\u4fe1\u53f7\u5904\u7406\u548c\u5f20\u91cf\u5206\u89e3\u4e2d\u81ea\u7136\u51fa\u73b0\u3002</p>\n<h3 id=\"1212-fourier\">12.1.2 \u5faa\u73af\u77e9\u9635\u4e0e\u79bb\u6563Fourier\u53d8\u6362</h3>\n<p>\u5faa\u73af\u77e9\u9635\u662fToeplitz\u77e9\u9635\u7684\u7279\u4f8b\uff0c\u5176\u7b2c\u4e00\u884c\u5b8c\u5168\u786e\u5b9a\u6574\u4e2a\u77e9\u9635\uff1a\n$$\\mathbf{C} = \\begin{bmatrix}\nc_0 &amp; c_{n-1} &amp; c_{n-2} &amp; \\cdots &amp; c_1 \\\nc_1 &amp; c_0 &amp; c_{n-1} &amp; \\cdots &amp; c_2 \\\nc_2 &amp; c_1 &amp; c_0 &amp; \\cdots &amp; c_3 \\\n\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\nc_{n-1} &amp; c_{n-2} &amp; c_{n-3} &amp; \\cdots &amp; c_0\n\\end{bmatrix}$$\n<strong>\u6838\u5fc3\u5b9a\u7406\uff08\u5faa\u73af\u77e9\u9635\u5bf9\u89d2\u5316\uff09</strong>\uff1a\u4efb\u4f55\u5faa\u73af\u77e9\u9635\u90fd\u53ef\u4ee5\u88abDFT\u77e9\u9635\u5bf9\u89d2\u5316\uff1a\n$$\\mathbf{C} = \\mathbf{F}^* \\mathbf{\\Lambda} \\mathbf{F}$$\n\u5176\u4e2d$\\mathbf{F}$\u662fDFT\u77e9\u9635\uff0c\u5176$(j,k)$\u5143\u7d20\u4e3a$F_{jk} = \\frac{1}{\\sqrt{n}}\\omega^{jk}$\uff0c$\\omega = e^{-2\\pi i/n}$\uff0c$\\mathbf{\\Lambda}$\u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5176\u5bf9\u89d2\u5143\u7d20\u4e3a$\\lambda_k = \\sqrt{n}(\\mathbf{F}\\mathbf{c})_k$\u3002</p>\n<p><strong>\u6df1\u5165\u7406\u89e3\u5bf9\u89d2\u5316\u673a\u5236</strong>\uff1a</p>\n<ol>\n<li><strong>\u7fa4\u8bba\u89c6\u89d2</strong>\uff1a\u5faa\u73af\u77e9\u9635\u6784\u6210\u7684\u96c6\u5408\u5728\u77e9\u9635\u4e58\u6cd5\u4e0b\u5f62\u6210\u4ea4\u6362\u7fa4\uff0cDFT\u63d0\u4f9b\u4e86\u8be5\u7fa4\u7684\u4e0d\u53ef\u7ea6\u8868\u793a</li>\n<li><strong>\u591a\u9879\u5f0f\u89c6\u89d2</strong>\uff1a\u5faa\u73af\u77e9\u9635\u5bf9\u5e94\u4e8e\u591a\u9879\u5f0f\u73af$\\mathbb{C}[x]/(x^n-1)$\u4e2d\u7684\u4e58\u6cd5\u7b97\u5b50</li>\n<li><strong>\u56fe\u8bba\u89c6\u89d2</strong>\uff1a\u5faa\u73af\u77e9\u9635\u662f\u5faa\u73af\u56fe\u7684\u90bb\u63a5\u77e9\u9635\uff0c\u5176\u7279\u5f81\u5411\u91cf\u662f\u56fe\u7684Fourier\u6a21\u5f0f</li>\n</ol>\n<p>\u8fd9\u4e00\u6027\u8d28\u5e26\u6765\u7684\u7b97\u6cd5\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5\uff1a$\\mathbf{C}\\mathbf{x} = \\mathbf{F}^*(\\mathbf{\\Lambda}(\\mathbf{F}\\mathbf{x}))$\uff0c\u590d\u6742\u5ea6$\\mathcal{O}(n \\log n)$</li>\n<li>\u77e9\u9635\u6c42\u9006\uff1a$\\mathbf{C}^{-1} = \\mathbf{F}^* \\mathbf{\\Lambda}^{-1} \\mathbf{F}$\uff0c\u590d\u6742\u5ea6$\\mathcal{O}(n \\log n)$</li>\n<li>\u77e9\u9635\u5e42\uff1a$\\mathbf{C}^k = \\mathbf{F}^* \\mathbf{\\Lambda}^k \\mathbf{F}$\uff0c\u4efb\u610f\u5e42\u6b21\u7684\u590d\u6742\u5ea6\u4ecd\u4e3a$\\mathcal{O}(n \\log n)$</li>\n<li>\u77e9\u9635\u51fd\u6570\uff1a$f(\\mathbf{C}) = \\mathbf{F}^* f(\\mathbf{\\Lambda}) \\mathbf{F}$\uff0c\u5982\u77e9\u9635\u6307\u6570\u3001\u5bf9\u6570\u7b49</li>\n</ul>\n<p><strong>\u5e7f\u4e49\u5faa\u73af\u77e9\u9635</strong>\uff1a\n\u8003\u8651\u66f4\u4e00\u822c\u7684\u7ed3\u6784\uff0c\u5982\uff1a</p>\n<ol>\n<li><strong>\u659c\u5faa\u73af\u77e9\u9635</strong>\uff1a\u6700\u540e\u4e00\u5217\u5230\u7b2c\u4e00\u5217\u6709\u7b26\u53f7\u53d8\u5316\uff0c\u53ef\u901a\u8fc7\u4fee\u6539\u7684DFT\u5bf9\u89d2\u5316</li>\n<li><strong>f-\u5faa\u73af\u77e9\u9635</strong>\uff1a\u63a8\u5e7f\u5230\u4efb\u610f\u7f6e\u6362\uff0c\u9700\u8981\u76f8\u5e94\u7684\u5e7f\u4e49DFT</li>\n<li><strong>\u591a\u7ea7\u5faa\u73af\u77e9\u9635</strong>\uff1a\u5757\u5faa\u73af\u4e14\u6bcf\u5757\u4e5f\u662f\u5faa\u73af\uff0c\u53ef\u9012\u5f52\u5e94\u7528FFT</li>\n</ol>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a\n\u867d\u7136\u7406\u8bba\u4e0a\u4f18\u7f8e\uff0c\u5b9e\u8df5\u4e2d\u9700\u6ce8\u610f\uff1a</p>\n<ul>\n<li>FFT\u7684\u820d\u5165\u8bef\u5dee\u7d2f\u79ef\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u75c5\u6001\u77e9\u9635</li>\n<li>\u4f7f\u7528\u9002\u5f53\u7684FFT\u7b97\u6cd5\uff08\u5982Cooley-Tukey vs. Bluestein\uff09</li>\n<li>\u5bf9\u4e8e\u5b9e\u5faa\u73af\u77e9\u9635\uff0c\u53ef\u5229\u7528\u5bf9\u79f0\u6027\u51cf\u5c11\u8ba1\u7b97\u91cf\u548c\u63d0\u9ad8\u7cbe\u5ea6</li>\n</ul>\n<h3 id=\"1213-toeplitz\">12.1.3 Toeplitz\u77e9\u9635\u7684\u5feb\u901f\u7b97\u6cd5</h3>\n<p>\u867d\u7136\u4e00\u822cToeplitz\u77e9\u9635\u4e0d\u80fd\u76f4\u63a5\u5bf9\u89d2\u5316\uff0c\u4f46\u53ef\u4ee5\u5d4c\u5165\u5230\u66f4\u5927\u7684\u5faa\u73af\u77e9\u9635\u4e2d\uff1a</p>\n<p><strong>\u5faa\u73af\u5d4c\u5165\u6280\u5de7</strong>\uff1a\n\u7ed9\u5b9a$n \\times n$ Toeplitz\u77e9\u9635$\\mathbf{T}$\uff0c\u6784\u9020$m \\times m$\uff08$m \\geq 2n-1$\uff09\u5faa\u73af\u77e9\u9635$\\mathbf{C}$\uff1a\n$$\\mathbf{C} = \\begin{bmatrix}\n\\mathbf{T} &amp; \\mathbf{B} \\\n\\mathbf{B}^T &amp; \\mathbf{T}^T\n\\end{bmatrix}$$\n\u5177\u4f53\u6784\u9020\uff1a</p>\n<ol>\n<li>\u9009\u62e9$m = 2^k \\geq 2n-1$\uff08\u4e3aFFT\u6548\u7387\uff09</li>\n<li>\u5faa\u73af\u77e9\u9635\u7684\u7b2c\u4e00\u884c\u4e3a$(t_0, t_{-1}, ..., t_{-(n-1)}, *, ..., *, t_{n-1}, ..., t_1)$</li>\n<li>\u4e2d\u95f4\u7684$*$\u53ef\u4ee5\u4efb\u610f\u9009\u62e9\uff08\u5f71\u54cd\u6761\u4ef6\u6570\uff09</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nt\">Toeplitz\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5</span><span class=\"w\"> </span><span class=\"nt\">T</span><span class=\"o\">*</span><span class=\"nt\">x</span><span class=\"o\">:</span>\n<span class=\"nt\">1</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"nt\">\u5c06x\u6269\u5c55\u4e3a\u957f\u5ea6m\u7684\u5411\u91cfx_ext</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"cp\">[</span><span class=\"nx\">x</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"cp\">]</span>\n<span class=\"nt\">2</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"nt\">\u8ba1\u7b97c\u7684FFT</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nt\">c_hat</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nt\">FFT</span><span class=\"o\">(</span><span class=\"nt\">c</span><span class=\"o\">)</span>\n<span class=\"nt\">3</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"nt\">\u8ba1\u7b97x_ext\u7684FFT</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nt\">x_hat</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nt\">FFT</span><span class=\"o\">(</span><span class=\"nt\">x_ext</span><span class=\"o\">)</span>\n<span class=\"nt\">4</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"nt\">\u9891\u57df\u76f8\u4e58</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nt\">y_hat</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nt\">c_hat</span><span class=\"w\"> </span><span class=\"o\">.*</span><span class=\"w\"> </span><span class=\"nt\">x_hat</span>\n<span class=\"nt\">5</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"nt\">\u9006\u53d8\u6362</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nt\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nt\">IFFT</span><span class=\"o\">(</span><span class=\"nt\">y_hat</span><span class=\"o\">)</span>\n<span class=\"nt\">6</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"nt\">\u63d0\u53d6\u524dn\u4e2a\u5143\u7d20</span>\n</code></pre></div>\n\n<p><strong>Levinson-Durbin\u7b97\u6cd5</strong>\uff1a\n\u4e13\u95e8\u7528\u4e8e\u6c42\u89e3Toeplitz\u7cfb\u7edf$\\mathbf{T}\\mathbf{x} = \\mathbf{b}$\uff0c\u5229\u7528Toeplitz\u77e9\u9635\u7684\u9012\u5f52\u7ed3\u6784\uff1a</p>\n<p>\u6838\u5fc3\u601d\u60f3\uff1a\n$$\\mathbf{T}_{n+1} = \\begin{bmatrix}\n\\mathbf{T}_n &amp; \\mathbf{t}_n \\\n\\mathbf{t}_n^T &amp; t_0\n\\end{bmatrix}$$\n\u7b97\u6cd5\u6b65\u9aa4\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\uff1a$x^{(1)} = b_1/t_0$</li>\n<li>\u5bf9$k = 2, ..., n$\u9012\u5f52\uff1a\n   - \u8ba1\u7b97\u53cd\u5c04\u7cfb\u6570$\\rho_k$\n   - \u66f4\u65b0\u89e3\u5411\u91cf$x^{(k)}$\n   - \u66f4\u65b0\u8bef\u5dee</li>\n</ol>\n<p>\u590d\u6742\u5ea6\u4e0e\u7a33\u5b9a\u6027\uff1a</p>\n<ul>\n<li>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n^2)$</li>\n<li>\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n)$</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\uff1a\u8981\u6c42$\\mathbf{T}$\u5f3a\u6b63\u5b9a\uff0c\u5426\u5219\u53ef\u80fd\u5931\u8d25</li>\n</ul>\n<p><strong>Superfast\u7b97\u6cd5</strong>\uff1a\n\u5bf9\u4e8e\u826f\u6001Toeplitz\u77e9\u9635\uff0c\u5b58\u5728$\\mathcal{O}(n\\log^2 n)$\u7684\u7b97\u6cd5\uff1a</p>\n<ol>\n<li><strong>\u5206\u6cbb\u7b56\u7565</strong>\uff1a\u5c06Toeplitz\u77e9\u9635\u9012\u5f52\u5206\u89e3</li>\n<li><strong>\u751f\u6210\u51fd\u6570\u65b9\u6cd5</strong>\uff1a\u5229\u7528\u6709\u7406\u51fd\u6570\u903c\u8fd1</li>\n<li><strong>\u4f4d\u79fb\u7ed3\u6784\u5229\u7528</strong>\uff1a$\\mathbf{T} - \\mathbf{Z}\\mathbf{T}\\mathbf{Z}^T$\u662f\u4f4e\u79e9\u7684</li>\n</ol>\n<p>\u8fd9\u4e9b\u7b97\u6cd5\u5728\u7406\u8bba\u4e0a\u4f18\u7f8e\u4f46\u5b9e\u73b0\u590d\u6742\uff0c\u6570\u503c\u7a33\u5b9a\u6027\u662f\u4e3b\u8981\u6311\u6218\u3002</p>\n<h3 id=\"1214\">12.1.4 \u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1</h3>\n<p>\u5728\u8fed\u4ee3\u65b9\u6cd5\u4e2d\uff0c\u597d\u7684\u9884\u6761\u4ef6\u5b50\u5bf9\u6536\u655b\u901f\u5ea6\u81f3\u5173\u91cd\u8981\u3002\u5bf9\u4e8eToeplitz\u7cfb\u7edf\uff0c\u5e38\u7528\u7684\u9884\u6761\u4ef6\u5b50\u5305\u62ec\uff1a</p>\n<ol>\n<li><strong>\u5faa\u73af\u9884\u6761\u4ef6\u5b50</strong>\uff1a\u9009\u62e9\u4e0e$\\mathbf{T}$\"\u6700\u63a5\u8fd1\"\u7684\u5faa\u73af\u77e9\u9635</li>\n</ol>\n<p><strong>Strang\u9884\u6761\u4ef6\u5b50</strong>\uff1a\n   \u6784\u9020\u539f\u5219\uff1a\u590d\u5236Toeplitz\u77e9\u9635\u7684\u4e2d\u5fc3\u5e26\n$$c_j = \\begin{cases}\n   t_j, &amp; |j| \\leq n/2 \\\n   t_{j-n}, &amp; n/2 &lt; j &lt; n\n   \\end{cases}$$\n\u4f18\u70b9\uff1a\u4fdd\u6301\u4e86\u539f\u77e9\u9635\u7684\u4e3b\u8981\u9891\u8c31\u7279\u6027</p>\n<p><strong>T. Chan\u9884\u6761\u4ef6\u5b50</strong>\uff1a\n   \u6700\u5c0f\u5316$|\\mathbf{C} - \\mathbf{T}|_F$\uff0c\u89e3\u4e3a\uff1a\n$$c_j = \\frac{(n-|j|)t_j}{n}$$\n\u7406\u8bba\u4fdd\u8bc1\uff1a\u5bf9\u4e8e\u67d0\u4e9b\u77e9\u9635\u7c7b\uff0c\u53ef\u8bc1\u660e\u8d85\u7ebf\u6027\u6536\u655b</p>\n<ol start=\"2\">\n<li><strong>\u5e26\u72b6\u9884\u6761\u4ef6\u5b50</strong>\uff1a\u4fdd\u7559\u539f\u77e9\u9635\u7684\u5e26\u72b6\u90e8\u5206</li>\n</ol>\n<p>\u5bf9\u4e8e\u5e26\u5bbd$b$\u7684\u5e26\u72b6Toeplitz\u77e9\u9635\uff1a</p>\n<ul>\n<li>\u76f4\u63a5\u5206\u89e3\uff1a$\\mathcal{O}(nb^2)$</li>\n<li>\u9002\u7528\u4e8e$b \\ll n$\u7684\u60c5\u51b5</li>\n<li>\u53ef\u4e0e\u4e0d\u5b8c\u5168\u5206\u89e3\u7ed3\u5408</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u591a\u7ea7\u9884\u6761\u4ef6\u5b50</strong>\uff1a\u7ed3\u5408\u4e0d\u540c\u5c3a\u5ea6\u7684\u8fd1\u4f3c</li>\n</ol>\n<p><strong>\u4ee3\u6570\u591a\u91cd\u7f51\u683c\u601d\u60f3</strong>\uff1a</p>\n<ul>\n<li>\u7c97\u7f51\u683c\u6355\u83b7\u4f4e\u9891\u8bef\u5dee</li>\n<li>\u7ec6\u7f51\u683c\u5904\u7406\u9ad8\u9891\u5206\u91cf</li>\n<li>\u9012\u5f52\u5e94\u7528\u5f62\u6210V-cycle\u6216W-cycle</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u8c31\u7b49\u4ef7\u9884\u6761\u4ef6\u5b50</strong>\uff1a</li>\n</ol>\n<p>\u5bfb\u627e$\\mathbf{P}$\u4f7f\u5f97$\\mathbf{P}^{-1}\\mathbf{T}$\u7684\u7279\u5f81\u503c\u805a\u96c6\uff1a\n$$c_1 \\leq \\frac{\\lambda(\\mathbf{P}^{-1}\\mathbf{T})}{\\lambda_{\\max}(\\mathbf{P}^{-1}\\mathbf{T})} \\leq c_2$$\n\u5176\u4e2d$c_2/c_1$\u5c3d\u53ef\u80fd\u63a5\u8fd11\u3002</p>\n<p><strong>\u9884\u6761\u4ef6\u5b50\u9009\u62e9\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u77e9\u9635\u6027\u8d28\u5206\u6790\uff1a\u8c31\u5206\u5e03\u3001\u5e26\u5bbd\u3001\u5bf9\u79f0\u6027</li>\n<li>\u8ba1\u7b97\u8d44\u6e90\u6743\u8861\uff1a\u9884\u6761\u4ef6\u5b50\u6784\u9020\u6210\u672cvs\u8fed\u4ee3\u6b21\u6570\u51cf\u5c11</li>\n<li>\u5e76\u884c\u6027\u8003\u8651\uff1a\u67d0\u4e9b\u9884\u6761\u4ef6\u5b50\u66f4\u9002\u5408\u5e76\u884c\u5b9e\u73b0</li>\n</ul>\n<p><strong>\u6700\u65b0\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li><strong>\u6570\u636e\u9a71\u52a8\u7684\u9884\u6761\u4ef6\u5b50</strong>\uff1a\u4f7f\u7528\u673a\u5668\u5b66\u4e60\u9009\u62e9\u6700\u4f18\u53c2\u6570</li>\n<li><strong>\u968f\u673a\u5316\u9884\u6761\u4ef6</strong>\uff1a\u7ed3\u5408sketching\u6280\u672f</li>\n<li><strong>\u81ea\u9002\u5e94\u9884\u6761\u4ef6\u5b50</strong>\uff1a\u6839\u636e\u8fed\u4ee3\u5386\u53f2\u52a8\u6001\u8c03\u6574</li>\n</ol>\n<h3 id=\"1215\">12.1.5 \u7814\u7a76\u7ebf\u7d22\u4e0e\u5f00\u653e\u95ee\u9898</h3>\n<ol>\n<li><strong>\u975e\u5bf9\u79f0Toeplitz\u7cfb\u7edf\u7684\u5feb\u901f\u7b97\u6cd5</strong>\uff1a</li>\n</ol>\n<p><strong>\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u975e\u5bf9\u79f0\u60c5\u51b5\u4e0b\u7f3a\u4e4f\u4f18\u7f8e\u7684\u8c31\u7406\u8bba</li>\n<li>Superfast\u7b97\u6cd5\u7684\u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898</li>\n<li>\u6761\u4ef6\u6570\u4f30\u8ba1\u66f4\u52a0\u56f0\u96be</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u7ed3\u5408\u968f\u673a\u5316\u7ebf\u6027\u4ee3\u6570\u6280\u672f</li>\n<li>\u5f00\u53d1\u81ea\u9002\u5e94\u7cbe\u5ea6\u7b97\u6cd5</li>\n<li>\u63a2\u7d22\u4e0e\u77e9\u9635\u51fd\u6570\u903c\u8fd1\u7406\u8bba\u7684\u8054\u7cfb</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u591a\u7ea7Toeplitz\u77e9\u9635</strong>\uff08\u77e9\u9635\u7684\u77e9\u9635\u4ecd\u662fToeplitz\uff09\uff1a</li>\n</ol>\n<p><strong>\u5e94\u7528\u80cc\u666f</strong>\uff1a</p>\n<ul>\n<li>\u591a\u7ef4\u5377\u79ef\u548c\u76f8\u5173\u8fd0\u7b97</li>\n<li>\u56fe\u50cf\u5904\u7406\u4e2d\u7684\u5757\u5339\u914d</li>\n<li>\u5f20\u91cf\u5206\u89e3\u7684\u7279\u6b8a\u60c5\u51b5</li>\n</ul>\n<p><strong>\u7406\u8bba\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u6700\u4f18\u590d\u6742\u5ea6\u754c\u7684\u786e\u5b9a</li>\n<li>\u591a\u7ea7FFT\u7684\u6570\u503c\u8bef\u5dee\u5206\u6790</li>\n<li>\u5e76\u884c\u7b97\u6cd5\u7684\u8d1f\u8f7d\u5747\u8861</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u8fd1\u4f3cToeplitz\u7ed3\u6784\u7684\u8bc6\u522b</strong>\uff1a</li>\n</ol>\n<p><strong>\u95ee\u9898\u8868\u8ff0</strong>\uff1a\n   \u7ed9\u5b9a\u77e9\u9635$\\mathbf{M}$\uff0c\u627e\u5230\u6700\u4f18Toeplitz\u8fd1\u4f3c\uff1a\n$$\\min_{\\mathbf{T} \\in \\mathcal{T}} |\\mathbf{M} - \\mathbf{T}|$$\n<strong>\u7814\u7a76\u7ebf\u7d22</strong>\uff1a</p>\n<ul>\n<li>\u4e0e\u4f4e\u79e9\u77e9\u9635\u6062\u590d\u7684\u8054\u7cfb</li>\n<li>\u9c81\u68d2\u4e3b\u6210\u5206\u5206\u6790\u7684\u63a8\u5e7f</li>\n<li>\u5728\u7ebf/\u6d41\u5f0f\u7b97\u6cd5\u8bbe\u8ba1</li>\n</ul>\n<ol start=\"4\">\n<li><strong>GPU\u52a0\u901f\u5b9e\u73b0</strong>\uff1a</li>\n</ol>\n<p><strong>\u6280\u672f\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u89c4\u5219\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>Warp divergence\u95ee\u9898</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7b56\u7565</li>\n</ul>\n<p><strong>\u4f18\u5316\u673a\u4f1a</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528tensor core\u52a0\u901f</li>\n<li>\u878d\u5408kernel\u51cf\u5c11\u5185\u5b58\u4f20\u8f93</li>\n<li>\u81ea\u52a8\u8c03\u4f18\u6846\u67b6\u5f00\u53d1</li>\n</ul>\n<ol start=\"5\">\n<li><strong>\u91cf\u5b50\u7b97\u6cd5\u8fde\u63a5</strong>\uff1a</li>\n</ol>\n<p><strong>\u65b0\u5174\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u91cf\u5b50Fourier\u53d8\u6362\u5728Toeplitz\u7cfb\u7edf\u4e2d\u7684\u5e94\u7528</li>\n<li>HHL\u7b97\u6cd5\u7684\u7279\u6b8a\u5316</li>\n<li>\u91cf\u5b50\u4f18\u52bf\u7684\u7406\u8bba\u5206\u6790</li>\n</ul>\n<ol start=\"6\">\n<li><strong>\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5e94\u7528</strong>\uff1a</li>\n</ol>\n<p><strong>\u6f5c\u5728\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>\u5377\u79ef\u5c42\u7684Toeplitz\u7ed3\u6784\u538b\u7f29</li>\n<li>\u5faa\u73af\u795e\u7ecf\u7f51\u7edc\u7684\u5feb\u901f\u8bad\u7ec3</li>\n<li>Attention\u673a\u5236\u7684\u7ed3\u6784\u5316\u8fd1\u4f3c</li>\n</ul>\n<p><strong>\u5f00\u653e\u7684\u6570\u5b66\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>Toeplitz\u77e9\u9635\u7279\u5f81\u503c\u7684\u7cbe\u786e\u5206\u5e03\uff08\u975e\u6e10\u8fd1\uff09</li>\n<li>\u6700\u4f18\u9884\u6761\u4ef6\u5b50\u7684\u81ea\u52a8\u6784\u9020</li>\n<li>\u591a\u9879\u5f0f\u9884\u6761\u4ef6\u5b50\u7684\u7cfb\u7edf\u7406\u8bba</li>\n<li>\u4e0e\u968f\u673a\u77e9\u9635\u7406\u8bba\u7684\u6df1\u5c42\u8054\u7cfb</li>\n</ol>\n<h3 id=\"1216-toeplitz\">12.1.6 \u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684Toeplitz\u7ed3\u6784</h3>\n<p><strong>\u5377\u79ef\u5c42\u7684Toeplitz\u8868\u793a</strong>\uff1a</p>\n<p>\u6df1\u5ea6\u5b66\u4e60\u4e2d\u76841D\u5377\u79ef\u53ef\u4ee5\u7cbe\u786e\u8868\u793a\u4e3aToeplitz\u77e9\u9635\u4e58\u6cd5\u3002\u5bf9\u4e8e\u5377\u79ef\u6838$\\mathbf{w} = [w_0, w_1, ..., w_{k-1}]$\u548c\u8f93\u5165$\\mathbf{x} = [x_0, x_1, ..., x_{n-1}]$\uff1a\n$$\\mathbf{T}_{\\text{conv}} = \\begin{bmatrix}\nw_{k-1} &amp; \\cdots &amp; w_1 &amp; w_0 &amp; 0 &amp; \\cdots &amp; 0 \\\n0 &amp; w_{k-1} &amp; \\cdots &amp; w_1 &amp; w_0 &amp; \\cdots &amp; 0 \\\n\\vdots &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\vdots \\\n0 &amp; \\cdots &amp; 0 &amp; w_{k-1} &amp; \\cdots &amp; w_1 &amp; w_0\n\\end{bmatrix}$$\n<strong>\u56e0\u679c\u5377\u79ef\u4e0e\u4e0b\u4e09\u89d2Toeplitz</strong>\uff1a</p>\n<p>\u5728\u5e8f\u5217\u5efa\u6a21\uff08\u5982WaveNet\uff09\u4e2d\uff0c\u56e0\u679c\u5377\u79ef\u5bf9\u5e94\u4e0b\u4e09\u89d2Toeplitz\u77e9\u9635\uff1a</p>\n<ul>\n<li>\u4fdd\u8bc1\u65f6\u95f4\u56e0\u679c\u6027\uff1a\u8f93\u51fa\u53ea\u4f9d\u8d56\u4e8e\u8fc7\u53bb\u8f93\u5165</li>\n<li>\u652f\u6301\u81ea\u56de\u5f52\u751f\u6210</li>\n<li>\u53ef\u901a\u8fc7\u5206\u5757\u6280\u672f\u5b9e\u73b0\u5e76\u884c\u8bad\u7ec3</li>\n</ul>\n<p><strong>\u7a7a\u6d1e\u5377\u79ef\u7684\u7a00\u758fToeplitz\u7ed3\u6784</strong>\uff1a</p>\n<p>\u7a7a\u6d1e\u5377\u79ef\uff08dilated convolution\uff09\u4ea7\u751f\u7279\u6b8a\u7684\u7a00\u758fToeplitz\u6a21\u5f0f\uff1a\n$$\\mathbf{T}_{\\text{dilated}} = \\begin{bmatrix}\nw_2 &amp; 0 &amp; w_1 &amp; 0 &amp; w_0 &amp; 0 &amp; \\cdots \\\n0 &amp; w_2 &amp; 0 &amp; w_1 &amp; 0 &amp; w_0 &amp; \\cdots \\\n\\vdots &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\ddots &amp; \\ddots\n\\end{bmatrix}$$\n\u8fd9\u79cd\u7ed3\u6784\u5141\u8bb8\uff1a</p>\n<ul>\n<li>\u6307\u6570\u7ea7\u589e\u957f\u7684\u611f\u53d7\u91ce</li>\n<li>\u4fdd\u6301\u53c2\u6570\u6570\u91cf\u4e0d\u53d8</li>\n<li>\u9ad8\u6548\u7684\u591a\u5c3a\u5ea6\u7279\u5f81\u63d0\u53d6</li>\n</ul>\n<p><strong>\u5faa\u73af\u5377\u79ef\u5728\u5468\u671f\u4fe1\u53f7\u5904\u7406\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u97f3\u9891\u5904\u7406</strong>\uff1a\n   - \u5468\u671f\u6027\u5047\u8bbe\u9002\u7528\u4e8e\u8bb8\u591a\u97f3\u9891\u4fe1\u53f7\n   - FFT\u52a0\u901f\u7279\u522b\u6709\u6548\n   - \u76f8\u4f4d\u4fe1\u606f\u7684\u4fdd\u6301</p>\n</li>\n<li>\n<p><strong>\u56fe\u50cf\u5904\u7406\u7684\u5468\u671f\u8fb9\u754c\u6761\u4ef6</strong>\uff1a\n   - \u7eb9\u7406\u5408\u6210\u4e2d\u7684\u65e0\u7f1d\u62fc\u63a5\n   - \u9891\u57df\u6ee4\u6ce2\u7684\u81ea\u7136\u5b9e\u73b0\n   - \u907f\u514d\u8fb9\u754c\u4f2a\u5f71</p>\n</li>\n</ol>\n<p><strong>Toeplitz\u6ce8\u610f\u529b\u673a\u5236</strong>\uff1a</p>\n<p>\u6700\u8fd1\u7684\u7814\u7a76\u5c06Toeplitz\u7ed3\u6784\u5f15\u5165\u6ce8\u610f\u529b\u673a\u5236\uff1a\n$$\\mathbf{A}_{\\text{Toeplitz}} = \\text{Toeplitz}(a_0, a_1, ..., a_{n-1})$$\n\u5176\u4e2d$a_i$\u8868\u793a\u76f8\u5bf9\u4f4d\u7f6e$i$\u7684\u6ce8\u610f\u529b\u6743\u91cd\u3002\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u53c2\u6570\u5171\u4eab\uff1a$\\mathcal{O}(n)$\u800c\u975e$\\mathcal{O}(n^2)$</li>\n<li>\u5e73\u79fb\u4e0d\u53d8\u6027</li>\n<li>\u53ef\u5b66\u4e60\u7684\u5f52\u7eb3\u504f\u7f6e</li>\n</ul>\n<p><strong>\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u68af\u5ea6\u8ba1\u7b97\u7684\u7ed3\u6784\u5229\u7528</strong>\uff1a\n   \u5bf9\u4e8e\u635f\u5931$L = f(\\mathbf{T}\\mathbf{x})$\uff0c\u68af\u5ea6$\\nabla_{\\mathbf{t}} L$\u4fdd\u6301Toeplitz\u7ed3\u6784\u7ea6\u675f</p>\n</li>\n<li>\n<p><strong>\u6279\u5904\u7406\u7684\u9ad8\u6548\u5b9e\u73b0</strong>\uff1a\n   ```\n   \u6279\u91cfToeplitz\u4e58\u6cd5\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u5171\u4eabFFT\u8ba1\u5212</li>\n<li>\u5411\u91cf\u5316\u7684\u9891\u57df\u8fd0\u7b97</li>\n<li>\u7f13\u5b58\u53cb\u597d\u7684\u5185\u5b58\u8bbf\u95ee\n   ```</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u6df7\u5408\u7cbe\u5ea6\u8bad\u7ec3\u8003\u8651</strong>\uff1a\n   - Toeplitz\u7ed3\u6784\u7684\u6570\u503c\u654f\u611f\u6027\n   - \u52a8\u6001\u635f\u5931\u7f29\u653e\u7b56\u7565\n   - \u68af\u5ea6\u7d2f\u79ef\u6280\u672f</li>\n</ol>\n<h3 id=\"1217\">12.1.7 \u9ad8\u7ea7\u6570\u503c\u65b9\u6cd5</h3>\n<p><strong>\u591a\u9879\u5f0f\u9884\u6761\u4ef6\u5b50\u7406\u8bba</strong>\uff1a</p>\n<p>\u5bf9\u4e8eToeplitz\u7cfb\u7edf$\\mathbf{T}\\mathbf{x} = \\mathbf{b}$\uff0c\u8003\u8651\u591a\u9879\u5f0f\u9884\u6761\u4ef6\u5b50\uff1a\n$$\\mathbf{P}^{-1} = p(\\mathbf{T}) = \\sum_{k=0}^m \\alpha_k \\mathbf{T}^k$$\n<strong>\u6700\u4f18\u591a\u9879\u5f0f\u9009\u62e9</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Chebyshev\u591a\u9879\u5f0f\u65b9\u6cd5</strong>\uff1a\n   \u6700\u5c0f\u5316$\\max_{\\lambda \\in \\sigma(\\mathbf{T})} |1 - \\lambda p(\\lambda)|$</p>\n</li>\n<li>\n<p><strong>\u6700\u5c0f\u4e8c\u4e58\u591a\u9879\u5f0f</strong>\uff1a\n   \u6700\u5c0f\u5316$\\int |1 - \\lambda p(\\lambda)|^2 d\\mu(\\lambda)$</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6784\u9020</strong>\uff1a\n   \u57fa\u4e8eLanczos\u8fc7\u7a0b\u7684\u8c31\u4fe1\u606f</p>\n</li>\n</ol>\n<p><strong>\u4f4d\u79fb\u7ed3\u6784\u7684\u6df1\u5165\u5229\u7528</strong>\uff1a</p>\n<p>Toeplitz\u77e9\u9635\u6ee1\u8db3\u4f4d\u79fb\u65b9\u7a0b\uff1a\n$$\\mathbf{T} - \\mathbf{Z}_1\\mathbf{T}\\mathbf{Z}_0^T = \\mathbf{G}\\mathbf{H}^T$$\n\u5176\u4e2d$\\mathbf{Z}_0, \\mathbf{Z}_1$\u662f\u4f4d\u79fb\u77e9\u9635\uff0c$\\mathbf{G}, \\mathbf{H}$\u662f\u751f\u6210\u5668\uff08\u4f4e\u79e9\uff09\u3002</p>\n<p><strong>\u7b97\u6cd5implications</strong>\uff1a</p>\n<ul>\n<li>\u4ec5\u9700\u5b58\u50a8\u751f\u6210\u5668\uff1a$\\mathcal{O}(n)$\u5b58\u50a8</li>\n<li>\u5feb\u901f\u77e9\u9635\u66f4\u65b0\uff1a\u79e9-1\u4fee\u6539\u7684\u9ad8\u6548\u5904\u7406</li>\n<li>\u4e0eSchur\u7b97\u6cd5\u7684\u8054\u7cfb</li>\n</ul>\n<p><strong>\u5e7f\u4e49Schur\u7b97\u6cd5</strong>\uff1a</p>\n<p>\u5229\u7528\u4f4d\u79fb\u7ed3\u6784\u7684\u9012\u5f52\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\u751f\u6210\u5668\u8868\u793a</li>\n<li>\u9012\u5f52\u6d88\u5143\u8fc7\u7a0b\u4fdd\u6301\u4f4d\u79fb\u7ed3\u6784</li>\n<li>\u590d\u6742\u5ea6$\\mathcal{O}(n^2)$\uff0c\u4f46\u5e38\u6570\u56e0\u5b50\u5c0f</li>\n</ol>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u7684\u6df1\u5165\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u524d\u5411\u8bef\u5dee\u5206\u6790</strong>\uff1a\n$$|(\\mathbf{T} + \\Delta\\mathbf{T})\\tilde{\\mathbf{x}} - \\mathbf{b}| \\leq \\varepsilon |\\mathbf{b}|$$\n\u5176\u4e2d$|\\Delta\\mathbf{T}| \\leq c(n)\\varepsilon_{\\text{machine}}|\\mathbf{T}|$</p>\n</li>\n<li>\n<p><strong>\u540e\u5411\u7a33\u5b9a\u6027</strong>\uff1a\n   - FFT\u65b9\u6cd5\uff1a\u6761\u4ef6\u540e\u5411\u7a33\u5b9a\n   - Levinson\u7b97\u6cd5\uff1a\u9700\u8981\u5f3a\u6b63\u5b9a\u6027\n   - Schur\u7b97\u6cd5\uff1a\u53cc\u6b63\u4ea4\u6027\u4fdd\u8bc1</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7b97\u6cd5\u7b56\u7565</strong>\uff1a\n   \u6839\u636e\u6761\u4ef6\u6570\u81ea\u52a8\u9009\u62e9\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u826f\u6001\uff1a\u4f7f\u7528\u5feb\u901f\u7b97\u6cd5</li>\n<li>\u75c5\u6001\uff1a\u5207\u6362\u5230\u7a33\u5b9a\u4f46\u8f83\u6162\u7684\u65b9\u6cd5</li>\n</ul>\n<h3 id=\"1218\">12.1.8 \u5e76\u884c\u4e0e\u5206\u5e03\u5f0f\u7b97\u6cd5</h3>\n<p><strong>\u5e76\u884cFFT\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6570\u636e\u5e76\u884c\u5206\u89e3</strong>\uff1a\n   - Cooley-Tukey\u7b97\u6cd5\u7684\u81ea\u7136\u5e76\u884c\u6027\n   - \u8776\u5f62\u8fd0\u7b97\u7684\u72ec\u7acb\u6027\n   - \u901a\u4fe1\u6a21\u5f0f\u7684\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u4efb\u52a1\u5e76\u884c\u65b9\u6cd5</strong>\uff1a\n   - \u591a\u7ef4FFT\u7684\u7ef4\u5ea6\u5206\u89e3\n   - \u6d41\u6c34\u7ebf\u5e76\u884c\n   - \u5f02\u6784\u8ba1\u7b97\u5229\u7528</p>\n</li>\n</ol>\n<p><strong>\u5206\u5e03\u5f0fToeplitz\u6c42\u89e3\u5668</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u8d85\u5927\u89c4\u6a21Toeplitz\u7cfb\u7edf\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57df\u5206\u89e3\u65b9\u6cd5</strong>\uff1a\n   \u5c06\u95ee\u9898\u5206\u89e3\u4e3a\u91cd\u53e0\u5b50\u95ee\u9898\n$$\\mathbf{T} = \\begin{bmatrix}\n   \\mathbf{T}_{11} &amp; \\mathbf{T}_{12} \\\n   \\mathbf{T}_{21} &amp; \\mathbf{T}_{22}\n   \\end{bmatrix}$$\n\u5229\u7528Schur\u8865\u8fdb\u884c\u6c42\u89e3</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a\n   - \u70b9\u5bf9\u70b9\u901a\u4fe1\uff1a$\\mathcal{O}(n/p)$\u6bcf\u5904\u7406\u5668\n   - \u5168\u5c40\u5f52\u7ea6\uff1a$\\mathcal{O}(\\log p)$\u8f6e\u6b21\n   - \u5e26\u5bbd\u9700\u6c42\uff1a\u5173\u952e\u74f6\u9888</p>\n</li>\n<li>\n<p><strong>\u5bb9\u9519\u7b97\u6cd5\u8bbe\u8ba1</strong>\uff1a\n   - \u7b97\u6cd5\u7ea7\u68c0\u67e5\u70b9\n   - \u57fa\u4e8e\u5197\u4f59\u7684\u6062\u590d\n   - \u65e0\u9700\u5168\u5c40\u540c\u6b65\u7684\u7b97\u6cd5</p>\n</li>\n</ol>\n<p><strong>GPU\u5b9e\u73b0\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</strong>\uff1a\n   - \u5408\u5e76\u8bbf\u95ee\u4f18\u5316\n   - \u5171\u4eab\u5185\u5b58\u5229\u7528\n   - \u7eb9\u7406\u5185\u5b58\u7684\u7279\u6b8a\u7528\u9014</p>\n</li>\n<li>\n<p><strong>Warp\u7ea7\u522b\u4f18\u5316</strong>\uff1a\n   - \u907f\u514d\u5206\u652f\u53d1\u6563\n   - \u534f\u4f5c\u7ec4\u7684\u4f7f\u7528\n   - Tensor Core\u52a0\u901f\uff08\u9002\u7528\u65f6\uff09</p>\n</li>\n<li>\n<p><strong>\u591aGPU\u7b56\u7565</strong>\uff1a\n   - NVLink\u5229\u7528\n   - \u5f02\u6b65\u6267\u884c\u6d41\n   - \u6df7\u5408\u7cbe\u5ea6\u7b56\u7565</p>\n</li>\n</ol>\n<h3 id=\"1219\">12.1.9 \u8f6f\u4ef6\u5de5\u7a0b\u5b9e\u8df5</h3>\n<p><strong>\u5e93\u8bbe\u8ba1\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li><strong>\u63a5\u53e3\u8bbe\u8ba1\u539f\u5219</strong>\uff1a\n   ```\n   ToeplitzMatrix:</li>\n</ol>\n<ul>\n<li>\u60f0\u6027\u6c42\u503c</li>\n<li>\u8fd0\u7b97\u7b26\u91cd\u8f7d</li>\n<li>\u81ea\u52a8\u7b97\u6cd5\u9009\u62e9\n   ```</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406</strong>\uff1a\n   - \u5f15\u7528\u8ba1\u6570\n   - \u5185\u5b58\u6c60\u6280\u672f\n   - \u5bf9\u9f50\u8981\u6c42\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u9519\u8bef\u5904\u7406</strong>\uff1a\n   - \u6570\u503c\u8b66\u544a\u7cfb\u7edf\n   - \u4f18\u96c5\u964d\u7ea7\n   - \u8bca\u65ad\u4fe1\u606f\u6536\u96c6</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u76d1\u63a7\u4e0e\u8c03\u4f18</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8fd0\u884c\u65f6\u81ea\u9002\u5e94</strong>\uff1a\n   - \u57fa\u4e8e\u8f93\u5165\u7684\u7b97\u6cd5\u9009\u62e9\n   - \u52a8\u6001\u5e76\u884c\u5ea6\u8c03\u6574\n   - \u7f13\u5b58\u884c\u4e3a\u9002\u5e94</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u8ba1\u6570\u5668\u5229\u7528</strong>\uff1a\n   - \u7f13\u5b58\u547d\u4e2d\u7387\u76d1\u63a7\n   - \u5206\u652f\u9884\u6d4b\u5931\u8d25\u7edf\u8ba1\n   - \u5185\u5b58\u5e26\u5bbd\u4f7f\u7528</p>\n</li>\n<li>\n<p><strong>\u81ea\u52a8\u8c03\u4f18\u6846\u67b6</strong>\uff1a\n   - \u53c2\u6570\u7a7a\u95f4\u63a2\u7d22\n   - \u673a\u5668\u5b66\u4e60\u5f15\u5bfc\n   - \u8de8\u5e73\u53f0\u4f18\u5316</p>\n</li>\n</ol>\n<p><strong>\u4e0e\u73b0\u6709\u751f\u6001\u7cfb\u7edf\u96c6\u6210</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>BLAS/LAPACK\u517c\u5bb9\u6027</strong>\uff1a\n   - \u6807\u51c6\u63a5\u53e3\u5c01\u88c5\n   - \u56de\u9000\u673a\u5236\n   - \u6027\u80fd\u5bf9\u6bd4\u57fa\u51c6</p>\n</li>\n<li>\n<p><strong>\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\u96c6\u6210</strong>\uff1a\n   - \u81ea\u5b9a\u4e49\u7b97\u5b50\u5b9e\u73b0\n   - \u81ea\u52a8\u5fae\u5206\u652f\u6301\n   - JIT\u7f16\u8bd1\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0f\u6846\u67b6\u652f\u6301</strong>\uff1a\n   - MPI\u540e\u7aef\n   - \u96c6\u5408\u901a\u4fe1\u4f18\u5316\n   - \u8d1f\u8f7d\u5747\u8861\u7b56\u7565</p>\n</li>\n</ol>\n<h2 id=\"122-kronecker\">12.2 Kronecker\u79ef\u7684\u9ad8\u6548\u8fd0\u7b97</h2>\n<h3 id=\"1221-kronecker\">12.2.1 Kronecker\u79ef\u7684\u4ee3\u6570\u6027\u8d28</h3>\n<p>Kronecker\u79ef\uff08\u5f20\u91cf\u79ef\uff09\u5b9a\u4e49\u4e3a\uff1a\n$$\\mathbf{A} \\otimes \\mathbf{B} = \\begin{bmatrix}\na_{11}\\mathbf{B} &amp; a_{12}\\mathbf{B} &amp; \\cdots &amp; a_{1n}\\mathbf{B} \\\na_{21}\\mathbf{B} &amp; a_{22}\\mathbf{B} &amp; \\cdots &amp; a_{2n}\\mathbf{B} \\\n\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\na_{m1}\\mathbf{B} &amp; a_{m2}\\mathbf{B} &amp; \\cdots &amp; a_{mn}\\mathbf{B}\n\\end{bmatrix}$$\n<strong>\u57fa\u672c\u6027\u8d28</strong>\uff1a</p>\n<ol>\n<li><strong>\u6df7\u5408\u79ef\u89c4\u5219</strong>\uff1a$(\\mathbf{A} \\otimes \\mathbf{B})(\\mathbf{C} \\otimes \\mathbf{D}) = (\\mathbf{A}\\mathbf{C}) \\otimes (\\mathbf{B}\\mathbf{D})$</li>\n<li><strong>\u8f6c\u7f6e\u89c4\u5219</strong>\uff1a$(\\mathbf{A} \\otimes \\mathbf{B})^T = \\mathbf{A}^T \\otimes \\mathbf{B}^T$</li>\n<li><strong>\u9006\u77e9\u9635\u89c4\u5219</strong>\uff1a$(\\mathbf{A} \\otimes \\mathbf{B})^{-1} = \\mathbf{A}^{-1} \\otimes \\mathbf{B}^{-1}$</li>\n<li><strong>\u7279\u5f81\u503c\u5173\u7cfb</strong>\uff1a\u82e5$\\lambda_i, \\mu_j$\u5206\u522b\u662f$\\mathbf{A}, \\mathbf{B}$\u7684\u7279\u5f81\u503c\uff0c\u5219$\\lambda_i\\mu_j$\u662f$\\mathbf{A} \\otimes \\mathbf{B}$\u7684\u7279\u5f81\u503c</li>\n</ol>\n<p><strong>\u6df1\u5c42\u6027\u8d28\u4e0e\u5e94\u7528</strong>\uff1a</p>\n<ol start=\"5\">\n<li>\n<p><strong>\u79e9\u5173\u7cfb</strong>\uff1a$\\text{rank}(\\mathbf{A} \\otimes \\mathbf{B}) = \\text{rank}(\\mathbf{A}) \\cdot \\text{rank}(\\mathbf{B})$</p>\n</li>\n<li>\n<p><strong>\u8ff9\u4e0e\u884c\u5217\u5f0f</strong>\uff1a\n   - $\\text{tr}(\\mathbf{A} \\otimes \\mathbf{B}) = \\text{tr}(\\mathbf{A}) \\cdot \\text{tr}(\\mathbf{B})$\n   - $\\det(\\mathbf{A} \\otimes \\mathbf{B}) = \\det(\\mathbf{A})^n \\cdot \\det(\\mathbf{B})^m$\uff08$\\mathbf{A}$\u662f$m \\times m$\uff0c$\\mathbf{B}$\u662f$n \\times n$\uff09</p>\n</li>\n<li>\n<p><strong>\u8303\u6570\u6027\u8d28</strong>\uff1a\n   - Frobenius\u8303\u6570\uff1a$|\\mathbf{A} \\otimes \\mathbf{B}|_F = |\\mathbf{A}|_F |\\mathbf{B}|_F$\n   - \u8c31\u8303\u6570\uff1a$|\\mathbf{A} \\otimes \\mathbf{B}|_2 = |\\mathbf{A}|_2 |\\mathbf{B}|_2$</p>\n</li>\n<li>\n<p><strong>\u4e0eHadamard\u79ef\u7684\u5173\u7cfb</strong>\uff08Khatri-Rao\u79ef\uff09\uff1a\n   \u5bf9\u4e8e\u76f8\u540c\u5927\u5c0f\u7684\u77e9\u9635\u5206\u5757\uff0c\u5b58\u5728\u6df1\u523b\u8054\u7cfb</p>\n</li>\n</ol>\n<p><strong>\u8ba1\u7b97\u4f18\u5316\u539f\u7406</strong>\uff1a\nKronecker\u79ef\u7684\u5173\u952e\u4f18\u52bf\u5728\u4e8e\u5176\u7ed3\u6784\u6027\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\uff1a</p>\n<ul>\n<li>\u907f\u514d\u663e\u5f0f\u5f62\u6210\u5927\u77e9\u9635</li>\n<li>\u5229\u7528\u56e0\u5b50\u77e9\u9635\u7684\u6027\u8d28\uff08\u7a00\u758f\u6027\u3001\u5bf9\u79f0\u6027\u7b49\uff09</li>\n<li>\u5b9e\u73b0\u5206\u5e03\u5f0f\u5e76\u884c\u8ba1\u7b97</li>\n</ul>\n<p><strong>\u5728\u91cf\u5b50\u8ba1\u7b97\u4e2d\u7684\u6838\u5fc3\u5730\u4f4d</strong>\uff1a\nKronecker\u79ef\u63cf\u8ff0\u4e86\u91cf\u5b50\u7cfb\u7edf\u7684\u5f20\u91cf\u79ef\u7ed3\u6784\uff1a</p>\n<ul>\n<li>$n$\u91cf\u5b50\u6bd4\u7279\u7cfb\u7edf\u7684\u72b6\u6001\u7a7a\u95f4\u7ef4\u5ea6\u4e3a$2^n$</li>\n<li>\u590d\u5408\u7cfb\u7edf\u7684\u54c8\u5bc6\u987f\u91cf\u901a\u8fc7Kronecker\u79ef\u6784\u9020</li>\n<li>\u91cf\u5b50\u95e8\u7684\u5e76\u884c\u64cd\u4f5c\u8868\u793a\u4e3aKronecker\u79ef</li>\n</ul>\n<h3 id=\"1222-vec-trick\">12.2.2 Vec-trick\u4e0e\u77e9\u9635\u65b9\u7a0b</h3>\n<p>Vec\u64cd\u4f5c\u5c06\u77e9\u9635\u6309\u5217\u5806\u53e0\u6210\u5411\u91cf\u3002\u5173\u952e\u6052\u7b49\u5f0f\uff1a\n$$\\text{vec}(\\mathbf{A}\\mathbf{X}\\mathbf{B}) = (\\mathbf{B}^T \\otimes \\mathbf{A})\\text{vec}(\\mathbf{X})$$\n<strong>Vec\u64cd\u4f5c\u7684\u6269\u5c55\u6027\u8d28</strong>\uff1a</p>\n<ol>\n<li><strong>\u94fe\u5f0f\u6cd5\u5219</strong>\uff1a$\\text{vec}(\\mathbf{A}\\mathbf{X}\\mathbf{B}\\mathbf{Y}\\mathbf{C}) = (\\mathbf{C}^T \\otimes \\mathbf{A})\\text{vec}(\\mathbf{X}\\mathbf{B}\\mathbf{Y})$</li>\n<li><strong>\u8ff9\u7684\u8054\u7cfb</strong>\uff1a$\\text{tr}(\\mathbf{A}^T\\mathbf{B}) = \\text{vec}(\\mathbf{A})^T\\text{vec}(\\mathbf{B})$</li>\n<li><strong>Kronecker\u79ef\u7684vec</strong>\uff1a$\\text{vec}(\\mathbf{A} \\otimes \\mathbf{B}) = \\text{vec}(\\mathbf{A}) \\otimes \\text{vec}(\\mathbf{B})$\u7684\u6392\u5217</li>\n</ol>\n<p>\u8fd9\u4f7f\u5f97\u77e9\u9635\u65b9\u7a0b\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5411\u91cf\u65b9\u7a0b\uff1a</p>\n<p><strong>Sylvester\u65b9\u7a0b</strong>\uff1a$\\mathbf{A}\\mathbf{X} + \\mathbf{X}\\mathbf{B} = \\mathbf{C}$\n\u8f6c\u5316\u4e3a\uff1a$(\\mathbf{I} \\otimes \\mathbf{A} + \\mathbf{B}^T \\otimes \\mathbf{I})\\text{vec}(\\mathbf{X}) = \\text{vec}(\\mathbf{C})$</p>\n<p><strong>Lyapunov\u65b9\u7a0b</strong>\uff1a$\\mathbf{A}\\mathbf{X} + \\mathbf{X}\\mathbf{A}^T = \\mathbf{C}$\n\u7279\u6b8a\u60c5\u51b5\uff0c\u53ef\u5229\u7528\u5bf9\u79f0\u6027\uff1a\u4ec5\u9700\u6c42\u89e3$\\frac{n(n+1)}{2}$\u4e2a\u672a\u77e5\u6570</p>\n<p><strong>\u5e7f\u4e49Sylvester\u65b9\u7a0b</strong>\uff1a$\\sum_{i=1}^k \\mathbf{A}_i\\mathbf{X}\\mathbf{B}_i = \\mathbf{C}$\n\u8f6c\u5316\u4e3a\uff1a$\\sum_{i=1}^k (\\mathbf{B}_i^T \\otimes \\mathbf{A}_i)\\text{vec}(\\mathbf{X}) = \\text{vec}(\\mathbf{C})$</p>\n<p><strong>\u8ba1\u7b97\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Bartels-Stewart\u7b97\u6cd5</strong>\uff1a\n   - \u5148\u5c06$\\mathbf{A}, \\mathbf{B}$\u5316\u4e3aSchur\u5f62\u5f0f\n   - \u5229\u7528\u4e09\u89d2\u7ed3\u6784\u9012\u5f52\u6c42\u89e3\n   - \u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n^3)$\u800c\u975e\u6734\u7d20\u7684$\\mathcal{O}(n^6)$</p>\n</li>\n<li>\n<p><strong>Krylov\u5b50\u7a7a\u95f4\u65b9\u6cd5</strong>\uff1a\n   - \u5bf9\u4e8e\u5927\u89c4\u6a21\u7a00\u758f\u95ee\u9898\n   - \u6784\u9020\u8fd1\u4f3c\u89e3\uff1a$\\mathbf{X}_k \\in \\mathcal{K}_k(\\mathbf{A}, \\mathbf{C})$\n   - \u9002\u7528\u4e8e$\\mathbf{A}, \\mathbf{B}$\u7279\u5f81\u503c\u5206\u79bb\u826f\u597d\u7684\u60c5\u51b5</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u8fd1\u4f3c</strong>\uff1a\n   \u5f53$\\mathbf{C} = \\mathbf{U}\\mathbf{V}^T$\u4f4e\u79e9\u65f6\uff0c\u5bfb\u627e$\\mathbf{X} = \\mathbf{Y}\\mathbf{Z}^T$</p>\n</li>\n</ol>\n<ul>\n<li>ADI\uff08Alternating Direction Implicit\uff09\u65b9\u6cd5</li>\n<li>\u7406\u8bba\u4fdd\u8bc1\uff1a\u6307\u6570\u6536\u655b\u901f\u5ea6</li>\n</ul>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u6761\u4ef6\u6570\uff1a$\\kappa = \\frac{1}{\\min_{i,j}|\\lambda_i(\\mathbf{A}) + \\mu_j(\\mathbf{B})|}$</li>\n<li>\u5f53$\\mathbf{A}, \\mathbf{B}$\u6709\u63a5\u8fd1\u7684\u76f8\u53cd\u7279\u5f81\u503c\u65f6\uff0c\u95ee\u9898\u75c5\u6001</li>\n<li>\u9884\u5904\u7406\u7b56\u7565\uff1a\u5e73\u8861\u53d8\u6362\u3001\u7f29\u653e\u6280\u672f</li>\n</ul>\n<h3 id=\"1223-kronecker\">12.2.3 \u5206\u5e03\u5f0fKronecker\u79ef\u8ba1\u7b97</h3>\n<p>\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\uff0cKronecker\u79ef\u7684\u8ba1\u7b97\u5177\u6709\u5929\u7136\u7684\u5e76\u884c\u6027\uff1a</p>\n<p><strong>\u6570\u636e\u5206\u5e03\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>\u884c\u5206\u5757\u65b9\u6848</strong>\uff1a\n   \u5c06$\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$\u6309\u884c\u5206\u4e3a$p$\u5757\uff1a\n$$\\mathbf{A} = \\begin{bmatrix} \\mathbf{A}_1 \\ \\mathbf{A}_2 \\ \\vdots \\ \\mathbf{A}_p \\end{bmatrix}$$\n\u5219$\\mathbf{A} \\otimes \\mathbf{B} = \\begin{bmatrix} \\mathbf{A}_1 \\otimes \\mathbf{B} \\ \\mathbf{A}_2 \\otimes \\mathbf{B} \\ \\vdots \\ \\mathbf{A}_p \\otimes \\mathbf{B} \\end{bmatrix}$</li>\n</ol>\n<p>\u4f18\u70b9\uff1a\u65e0\u9700\u901a\u4fe1\u5373\u53ef\u8ba1\u7b97\u5404\u5757\n   \u7f3a\u70b9\uff1a\u8d1f\u8f7d\u53ef\u80fd\u4e0d\u5747\u8861</p>\n<ol start=\"2\">\n<li>\n<p><strong>2D\u5206\u5757\u65b9\u6848</strong>\uff1a\n   \u4f7f\u7528$p \\times q$\u5904\u7406\u5668\u7f51\u683c\uff0c\u5206\u5757\u4e3a\uff1a\n$$\\mathbf{A} = \\begin{bmatrix} \\mathbf{A}_{11} &amp; \\cdots &amp; \\mathbf{A}_{1q} \\ \\vdots &amp; \\ddots &amp; \\vdots \\ \\mathbf{A}_{p1} &amp; \\cdots &amp; \\mathbf{A}_{pq} \\end{bmatrix}$$\n\u5904\u7406\u5668$(i,j)$\u8d1f\u8d23$\\mathbf{A}_{ij} \\otimes \\mathbf{B}_{ij}$</p>\n</li>\n<li>\n<p><strong>\u9012\u5f52\u5206\u5757</strong>\uff1a\n   \u5bf9\u4e8e\u591a\u91cdKronecker\u79ef$\\mathbf{A}_1 \\otimes \\mathbf{A}_2 \\otimes \\cdots \\otimes \\mathbf{A}_k$</p>\n</li>\n</ol>\n<ul>\n<li>\u5229\u7528\u7ed3\u5408\u5f8b\u4f18\u5316\u8ba1\u7b97\u987a\u5e8f</li>\n<li>\u52a8\u6001\u8c03\u6574\u5206\u5757\u7c92\u5ea6</li>\n</ul>\n<p><strong>\u901a\u4fe1\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u901a\u4fe1\u907f\u514d\u7b97\u6cd5</strong>\uff1a\n   - \u9884\u8ba1\u7b97\u901a\u4fe1\u6a21\u5f0f\n   - \u6279\u91cf\u4f20\u8f93\u51cf\u5c11\u5ef6\u8fdf\u5f71\u54cd\n   - \u4f7f\u7528\u5355\u8fb9\u901a\u4fe1\u539f\u8bed\uff08MPI-3\uff09</p>\n</li>\n<li>\n<p><strong>\u91cd\u53e0\u8ba1\u7b97\u4e0e\u901a\u4fe1</strong>\uff1a\n   <code>for each local block:\n       \u542f\u52a8\u5f02\u6b65\u53d1\u9001\n       \u8ba1\u7b97\u672c\u5730Kronecker\u79ef\n       \u63a5\u6536\u8fdc\u7a0b\u6570\u636e\n       \u878d\u5408\u7ed3\u679c</code></p>\n</li>\n<li>\n<p><strong>\u62d3\u6251\u611f\u77e5\u4f18\u5316</strong>\uff1a\n   - \u8003\u8651\u7f51\u7edc\u62d3\u6251\uff08\u5982\u80d6\u6811\u3001\u873b\u8713\u7f51\u7edc\uff09\n   - \u6700\u5c0f\u5316\u8de8\u673a\u67b6\u901a\u4fe1\n   - \u5229\u7528NUMA\u67b6\u6784\u7684\u5c40\u90e8\u6027</p>\n</li>\n</ol>\n<p><strong>\u8d1f\u8f7d\u5747\u8861\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u4efb\u52a1\u7a83\u53d6</li>\n<li>\u57fa\u4e8e\u8ba1\u7b97\u91cf\u7684\u9759\u6001\u5206\u914d</li>\n<li>\u8003\u8651\u77e9\u9635\u7a00\u758f\u6a21\u5f0f\u7684\u81ea\u9002\u5e94\u5206\u5757</li>\n</ul>\n<p><strong>\u5bb9\u9519\u673a\u5236</strong>\uff1a</p>\n<ul>\n<li>\u68c0\u67e5\u70b9/\u91cd\u542f</li>\n<li>\u7b97\u6cd5\u7ea7\u5bb9\u9519\uff08\u5982\u57fa\u4e8e\u7f16\u7801\u7684\u65b9\u6cd5\uff09</li>\n<li>\u5229\u7528Kronecker\u79ef\u7684\u5197\u4f59\u6027</li>\n</ul>\n<h3 id=\"1224\">12.2.4 \u5728\u5f20\u91cf\u5206\u89e3\u4e2d\u7684\u5e94\u7528</h3>\n<p>Kronecker\u79ef\u5728\u5f20\u91cf\u8ba1\u7b97\u4e2d\u65e0\u5904\u4e0d\u5728\uff1a</p>\n<ol>\n<li><strong>Tucker\u5206\u89e3\u7684\u6838\u5fc3\u8fd0\u7b97</strong>\uff1a</li>\n</ol>\n<p>\u5bf9\u4e8e\u4e09\u9636\u5f20\u91cf$\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times I_2 \\times I_3}$\uff1a\n$$\\mathcal{X} = \\mathcal{G} \\times_1 \\mathbf{U}^{(1)} \\times_2 \\mathbf{U}^{(2)} \\times_3 \\mathbf{U}^{(3)}$$\n\u77e9\u9635\u5316\u5f62\u5f0f\u6d89\u53caKronecker\u79ef\uff1a\n$$\\mathbf{X}_{(1)} = \\mathbf{U}^{(1)} \\mathbf{G}_{(1)} (\\mathbf{U}^{(3)} \\otimes \\mathbf{U}^{(2)})^T$$\n<strong>\u9ad8\u6548\u7b97\u6cd5</strong>\uff1a</p>\n<ul>\n<li>HOOI\uff08Higher-Order Orthogonal Iteration\uff09</li>\n<li>\u907f\u514d\u663e\u5f0fKronecker\u79ef\u7684\u6a21\u5f0f\u8ba1\u7b97</li>\n<li>\u5229\u7528\u7a00\u758f\u6027\u548c\u5bf9\u79f0\u6027</li>\n</ul>\n<ol start=\"2\">\n<li><strong>CP\u5206\u89e3\u4e0eKronecker\u79ef</strong>\uff1a</li>\n</ol>\n<p>CP\u5206\u89e3\u8868\u793a\u4e3a\uff1a\n$$\\mathcal{X} = \\sum_{r=1}^R \\mathbf{a}_r^{(1)} \\circ \\mathbf{a}_r^{(2)} \\circ \\mathbf{a}_r^{(3)}$$\n\u5176Khatri-Rao\u79ef\u5f62\u5f0f\uff1a\n$$\\mathbf{X}_{(1)} = \\mathbf{A}^{(1)}(\\mathbf{A}^{(3)} \\odot \\mathbf{A}^{(2)})^T$$\n\u5176\u4e2d$\\odot$\u662fKhatri-Rao\u79ef\uff08\u5217\u5f0fKronecker\u79ef\uff09</p>\n<ol start=\"3\">\n<li><strong>Tensor-Train\uff08TT\uff09\u683c\u5f0f</strong>\uff1a</li>\n</ol>\n<p>TT\u5206\u89e3\u5c06\u9ad8\u9636\u5f20\u91cf\u8868\u793a\u4e3a\u4e09\u9636\u5f20\u91cf\u94fe\uff1a\n$$\\mathcal{X}(i_1,...,i_d) = \\mathbf{G}_1(i_1)\\mathbf{G}_2(i_2)...\\mathbf{G}_d(i_d)$$\n<strong>Kronecker\u79ef\u89c6\u89d2</strong>\uff1a</p>\n<ul>\n<li>TT-\u77e9\u9635\uff1a$\\mathbf{A} = \\sum_{k} \\mathbf{A}_1^{(k)} \\otimes \\mathbf{A}_2^{(k)} \\otimes ... \\otimes \\mathbf{A}_d^{(k)}$</li>\n<li>\u5b58\u50a8\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(dnr^2)$\u800c\u975e$\\mathcal{O}(n^d)$</li>\n<li>\u5feb\u901f\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5\uff1a$\\mathcal{O}(dnr^2)$</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u5f20\u91cf\u65b9\u7a0b\u6c42\u89e3</strong>\uff1a</li>\n</ol>\n<p><strong>\u5f20\u91cfSylvester\u65b9\u7a0b</strong>\uff1a\n$$\\mathcal{X} \\times_1 \\mathbf{A}_1 + \\mathcal{X} \\times_2 \\mathbf{A}_2 + \\mathcal{X} \\times_3 \\mathbf{A}_3 = \\mathcal{C}$$\n\u8f6c\u5316\u4e3a\uff1a\n$$(\\mathbf{I} \\otimes \\mathbf{I} \\otimes \\mathbf{A}_1 + \\mathbf{I} \\otimes \\mathbf{A}_2 \\otimes \\mathbf{I} + \\mathbf{A}_3 \\otimes \\mathbf{I} \\otimes \\mathbf{I})\\text{vec}(\\mathcal{X}) = \\text{vec}(\\mathcal{C})$$</p>\n<ol start=\"5\">\n<li><strong>\u91cf\u5b50\u591a\u4f53\u7cfb\u7edf\u5e94\u7528</strong>\uff1a</li>\n</ol>\n<p><strong>DMRG\uff08Density Matrix Renormalization Group\uff09</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528\u77e9\u9635\u4e58\u79ef\u6001\uff08MPS\uff09\u8868\u793a</li>\n<li>\u5c40\u90e8\u4f18\u5316\u901a\u8fc7Kronecker\u79ef\u7ed3\u6784</li>\n<li>\u7ea0\u7f20\u71b5\u7684\u6709\u6548\u63a7\u5236</li>\n</ul>\n<p><strong>\u7814\u7a76\u524d\u6cbf</strong>\uff1a</p>\n<ul>\n<li>\u968f\u673a\u5316\u5f20\u91cf\u5206\u89e3\u7b97\u6cd5</li>\n<li>\u91cf\u5b50\u542f\u53d1\u7684\u5f20\u91cf\u7f51\u7edc</li>\n<li>\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5f20\u91cf\u5206\u89e3\u52a0\u901f</li>\n</ul>\n<h3 id=\"1225\">12.2.5 \u7814\u7a76\u7ebf\u7d22\u4e0e\u5f00\u653e\u95ee\u9898</h3>\n<ol>\n<li><strong>\u7a00\u758fKronecker\u79ef\u7684\u9ad8\u6548\u7b97\u6cd5</strong>\uff1a</li>\n</ol>\n<p><strong>\u95ee\u9898\u63cf\u8ff0</strong>\uff1a\n   \u5f53$\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$\u6709$\\text{nnz}(\\mathbf{A})$\u4e2a\u975e\u96f6\u5143\uff0c$\\mathbf{B} \\in \\mathbb{R}^{p \\times q}$\u6709$\\text{nnz}(\\mathbf{B})$\u4e2a\u975e\u96f6\u5143\u65f6\uff1a</p>\n<ul>\n<li>$\\mathbf{A} \\otimes \\mathbf{B}$\u6709$\\text{nnz}(\\mathbf{A}) \\cdot \\text{nnz}(\\mathbf{B})$\u4e2a\u975e\u96f6\u5143</li>\n<li>\u5b58\u50a8\u548c\u8ba1\u7b97\u5feb\u901f\u589e\u957f</li>\n</ul>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u538b\u7f29\u5b58\u50a8\u683c\u5f0f\uff08\u5982hierarchical CSR\uff09</li>\n<li>\u4e0e\u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u8054\u7cfb\uff1a\u90bb\u63a5\u77e9\u9635\u7684Kronecker\u79ef\u8868\u793a\u56fe\u7684\u7b1b\u5361\u5c14\u79ef</li>\n<li>\u52a8\u6001\u7a00\u758f\u6a21\u5f0f\u7684\u81ea\u9002\u5e94\u7b97\u6cd5</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u8fd1\u4f3cKronecker\u79ef\u5206\u89e3</strong>\uff1a</li>\n</ol>\n<p><strong>\u4f18\u5316\u95ee\u9898</strong>\uff1a\n$$\\min_{\\mathbf{A}, \\mathbf{B}} |\\mathbf{M} - \\mathbf{A} \\otimes \\mathbf{B}|_F^2$$\n<strong>\u7b97\u6cd5\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u975e\u51f8\u4f18\u5316\uff0c\u591a\u4e2a\u5c40\u90e8\u6700\u4f18</li>\n<li>SVD-based\u521d\u59cb\u5316\u7b56\u7565</li>\n<li>\u4e0e\u5f20\u91cf\u5206\u89e3\u7684\u8054\u7cfb</li>\n</ul>\n<p><strong>\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>\u795e\u7ecf\u7f51\u7edc\u6743\u91cd\u77e9\u9635\u538b\u7f29</li>\n<li>\u534f\u65b9\u5dee\u77e9\u9635\u7684\u7ed3\u6784\u5316\u8fd1\u4f3c</li>\n<li>\u4fe1\u53f7\u5904\u7406\u4e2d\u7684\u5206\u79bb\u6ee4\u6ce2\u5668\u8bbe\u8ba1</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u591a\u91cdKronecker\u79ef\u548c</strong>\uff1a</li>\n</ol>\n<p><strong>\u8868\u793a\u5f62\u5f0f</strong>\uff1a\n$$\\mathbf{M} \\approx \\sum_{k=1}^K \\mathbf{A}_k \\otimes \\mathbf{B}_k$$\n<strong>\u7406\u8bba\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>\u6700\u4f18\u79e9$K$\u7684\u786e\u5b9a</li>\n<li>\u552f\u4e00\u6027\u6761\u4ef6</li>\n<li>\u4e0eCP\u5206\u89e3\u7684\u7b49\u4ef7\u6027</li>\n</ul>\n<p><strong>\u7b97\u6cd5\u53d1\u5c55</strong>\uff1a</p>\n<ul>\n<li>\u4ea4\u66ff\u6700\u5c0f\u4e8c\u4e58\u7684\u6536\u655b\u6027\u5206\u6790</li>\n<li>\u968f\u673a\u5316\u65b9\u6cd5\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u5728\u7ebf/\u589e\u91cf\u7b97\u6cd5</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</strong>\uff1a</li>\n</ol>\n<p><strong>\u7cbe\u5ea6\u5206\u914d\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u5947\u5f02\u503c\u5206\u5e03</li>\n<li>\u8003\u8651\u786c\u4ef6\u7ea6\u675f\uff08\u5982INT8/FP16\u6df7\u5408\uff09</li>\n<li>\u7aef\u5230\u7aef\u8bef\u5dee\u5206\u6790</li>\n</ul>\n<p><strong>\u7814\u7a76\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>Kronecker\u79ef\u7684\u8bef\u5dee\u4f20\u64ad\u89c4\u5f8b</li>\n<li>\u6700\u4f18\u91cf\u5316\u65b9\u6848</li>\n<li>\u4e0e\u795e\u7ecf\u7f51\u7edc\u8bad\u7ec3\u7684\u534f\u540c\u8bbe\u8ba1</li>\n</ul>\n<ol start=\"5\">\n<li><strong>\u91cf\u5b50-\u7ecf\u5178\u7b97\u6cd5\u754c\u9762</strong>\uff1a</li>\n</ol>\n<p><strong>\u91cf\u5b50\u4f18\u52bf\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u4f55\u65f6\u91cf\u5b50\u7b97\u6cd5\u771f\u6b63\u8d85\u8d8a\u7ecf\u5178Kronecker\u6280\u5de7</li>\n<li>\u566a\u58f0\u4e2d\u7b49\u89c4\u6a21\u91cf\u5b50\uff08NISQ\uff09\u8bbe\u5907\u7684\u5b9e\u7528\u7b97\u6cd5</li>\n<li>\u6df7\u5408\u91cf\u5b50-\u7ecf\u5178\u7b97\u6cd5\u8bbe\u8ba1</li>\n</ul>\n<p><strong>\u5177\u4f53\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u91cf\u5b50\u8fd1\u4f3c\u4f18\u5316\u7b97\u6cd5\uff08QAOA\uff09\u4e2d\u7684Kronecker\u7ed3\u6784</li>\n<li>\u53d8\u5206\u91cf\u5b50\u672c\u5f81\u6c42\u89e3\u5668\uff08VQE\uff09\u7684\u7ecf\u5178\u9884\u5904\u7406</li>\n<li>\u5f20\u91cf\u7f51\u7edc\u7684\u91cf\u5b50\u7535\u8def\u7f16\u8bd1</li>\n</ul>\n<ol start=\"6\">\n<li><strong>\u9ad8\u7ef4Kronecker\u79ef</strong>\uff1a</li>\n</ol>\n<p><strong>\u63a8\u5e7f\u5f62\u5f0f</strong>\uff1a\n$$\\mathcal{A} \\otimes_n \\mathcal{B}$$\uff08\u6cbf\u7b2c$n$\u6a21\u7684Kronecker\u79ef\uff09</p>\n<p><strong>\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>\u9ad8\u6548\u7b97\u6cd5\u8bbe\u8ba1</li>\n<li>\u4e0e\u591a\u7ebf\u6027\u4ee3\u6570\u7684\u7edf\u4e00\u7406\u8bba</li>\n<li>\u5728\u9ad8\u7ef4\u504f\u5fae\u5206\u65b9\u7a0b\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<p><strong>\u6570\u5b66\u57fa\u7840\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>Kronecker\u79ef\u7684\u8c31\u7406\u8bba\u5b8c\u5584</li>\n<li>\u7ed3\u6784\u5316\u6270\u52a8\u5206\u6790</li>\n<li>\u4e0e\u8868\u793a\u8bba\u7684\u6df1\u5c42\u8054\u7cfb</li>\n<li>\u8ba1\u7b97\u590d\u6742\u5ea6\u7684\u7cbe\u786e\u523b\u753b</li>\n</ol>\n<h3 id=\"1226-kronecker\">12.2.6 Kronecker\u79ef\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</h3>\n<p><strong>\u795e\u7ecf\u7f51\u7edc\u6743\u91cd\u538b\u7f29</strong>\uff1a</p>\n<p>Kronecker\u5206\u89e3\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f3a\u5927\u7684\u6a21\u578b\u538b\u7f29\u6280\u672f\u3002\u5bf9\u4e8e\u5168\u8fde\u63a5\u5c42\u6743\u91cd$\\mathbf{W} \\in \\mathbb{R}^{mn \\times pq}$\uff1a\n$$\\mathbf{W} \\approx \\mathbf{A} \\otimes \\mathbf{B}, \\quad \\mathbf{A} \\in \\mathbb{R}^{m \\times p}, \\mathbf{B} \\in \\mathbb{R}^{n \\times q}$$\n\u538b\u7f29\u7387\uff1a$\\frac{mnpq}{mp + nq}$\uff0c\u5bf9\u4e8e\u65b9\u9635\u53ef\u8fbe$\\mathcal{O}(n^2)$\u500d\u3002</p>\n<p><strong>Kronecker\u56e0\u5b50\u5206\u6790\uff08KFA\uff09</strong>\uff1a</p>\n<p>\u5728\u4e8c\u9636\u4f18\u5316\u4e2d\uff0cFisher\u4fe1\u606f\u77e9\u9635\u7684Kronecker\u8fd1\u4f3c\uff1a\n$$\\mathbf{F} \\approx \\mathbf{A} \\otimes \\mathbf{B}$$\n\u5176\u4e2d$\\mathbf{A}$\u6355\u83b7\u6fc0\u6d3b\u7684\u534f\u65b9\u5dee\uff0c$\\mathbf{B}$\u6355\u83b7\u68af\u5ea6\u7684\u534f\u65b9\u5dee\u3002\u8fd9\u5bfc\u81f4\u4e86K-FAC\u4f18\u5316\u5668\uff1a</p>\n<ul>\n<li>\u8ba1\u7b97\u6548\u7387\uff1a$\\mathcal{O}(m^3 + n^3)$\u800c\u975e$\\mathcal{O}((mn)^3)$</li>\n<li>\u5185\u5b58\u6548\u7387\uff1a\u5b58\u50a8\u4e24\u4e2a\u5c0f\u77e9\u9635\u800c\u975e\u4e00\u4e2a\u5927\u77e9\u9635</li>\n<li>\u81ea\u7136\u68af\u5ea6\u7684\u5b9e\u7528\u8fd1\u4f3c</li>\n</ul>\n<p><strong>\u56fe\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<p>\u56fe\u7684Kronecker\u79ef\u5b9a\u4e49\u4e86\u590d\u5408\u56fe\u7ed3\u6784\uff1a</p>\n<ul>\n<li>\u8282\u70b9\u96c6\uff1a$V(G_1 \\times G_2) = V(G_1) \\times V(G_2)$</li>\n<li>\u8fb9\u96c6\uff1a\u57fa\u4e8e\u56e0\u5b50\u56fe\u7684\u8fb9\u5173\u7cfb</li>\n<li>\u5e94\u7528\uff1a\u591a\u5173\u7cfb\u5b66\u4e60\u3001\u56fe\u7684\u5c42\u6b21\u8868\u793a</li>\n</ul>\n<p><strong>\u5f20\u91cf\u56de\u5f52\u4e0eKronecker\u56de\u5f52</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u5f20\u91cf\u54cd\u5e94\u7684\u56de\u5f52\u95ee\u9898\uff1a\n$$\\mathcal{Y} = \\mathcal{X} \\times_1 \\mathbf{B}_1 \\times_2 \\mathbf{B}_2 \\times_3 \\mathbf{B}_3 + \\mathcal{E}$$\n\u53ef\u8f6c\u5316\u4e3a\u5411\u91cf\u5316\u5f62\u5f0f\uff1a\n$$\\text{vec}(\\mathcal{Y}) = (\\mathbf{B}_3 \\otimes \\mathbf{B}_2 \\otimes \\mathbf{B}_1)\\text{vec}(\\mathcal{X}) + \\text{vec}(\\mathcal{E})$$\n<strong>\u591a\u4efb\u52a1\u5b66\u4e60\u7684Kronecker\u6b63\u5219\u5316</strong>\uff1a</p>\n<p>\u5bf9\u4e8e$T$\u4e2a\u4efb\u52a1\uff0c\u6743\u91cd\u77e9\u9635$\\mathbf{W} = [\\mathbf{w}_1, ..., \\mathbf{w}_T]$\uff0c\u4f7f\u7528Kronecker\u7ed3\u6784\uff1a\n$$\\mathbf{W} = \\mathbf{W}_{\\text{feature}} \\otimes \\mathbf{W}_{\\text{task}}$$\n\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u4efb\u52a1\u95f4\u77e5\u8bc6\u5171\u4eab</li>\n<li>\u53c2\u6570\u5927\u5e45\u51cf\u5c11</li>\n<li>\u53ef\u89e3\u91ca\u7684\u5206\u89e3\u7ed3\u6784</li>\n</ul>\n<h3 id=\"1227\">12.2.7 \u9ad8\u6027\u80fd\u8ba1\u7b97\u4f18\u5316</h3>\n<p><strong>SIMD\u5411\u91cf\u5316\u7b56\u7565</strong>\uff1a</p>\n<p>Kronecker\u79ef\u7684\u8ba1\u7b97\u7279\u522b\u9002\u5408SIMD\u4f18\u5316\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u5bf9\u4e8e (A \u2297 B)x\uff1a\n1. \u5c06x\u91cd\u5851\u4e3a\u77e9\u9635X\n2. \u8ba1\u7b97Y = B X A^T\uff08\u9ad8\u5ea6\u5411\u91cf\u5316\uff09\n3. \u5c06Y\u5411\u91cf\u5316\u4e3ay\n</code></pre></div>\n\n<p><strong>\u7f13\u5b58\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5757Kronecker\u79ef</strong>\uff1a\n   \u5c06\u5927\u77e9\u9635\u5206\u5757\u4ee5\u9002\u5e94\u7f13\u5b58\uff1a\n$$\\mathbf{A} \\otimes \\mathbf{B} = \\begin{bmatrix}\n   \\mathbf{A}_{11} \\otimes \\mathbf{B} &amp; \\mathbf{A}_{12} \\otimes \\mathbf{B} \\\n   \\mathbf{A}_{21} \\otimes \\mathbf{B} &amp; \\mathbf{A}_{22} \\otimes \\mathbf{B}\n   \\end{bmatrix}$$</p>\n</li>\n<li>\n<p><strong>\u5faa\u73af\u91cd\u6392</strong>\uff1a\n   \u4f18\u5316\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u6700\u5c0f\u5316\u7f13\u5b58\u672a\u547d\u4e2d</p>\n</li>\n<li>\n<p><strong>\u9884\u53d6\u7b56\u7565</strong>\uff1a\n   \u5229\u7528Kronecker\u79ef\u7684\u89c4\u5219\u8bbf\u95ee\u6a21\u5f0f\u8fdb\u884c\u9884\u53d6</p>\n</li>\n</ol>\n<p><strong>GPU\u6838\u51fd\u6570\u8bbe\u8ba1</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Warp\u7ea7\u539f\u8bed\u5229\u7528</strong>\uff1a\n   - Shuffle\u6307\u4ee4\u52a0\u901f\u6570\u636e\u4ea4\u6362\n   - Warp\u7ea7\u5f52\u7ea6\u64cd\u4f5c\n   - \u534f\u4f5c\u7ec4\u7f16\u7a0b\u6a21\u578b</p>\n</li>\n<li>\n<p><strong>\u5171\u4eab\u5185\u5b58\u4f18\u5316</strong>\uff1a\n   - \u5206\u5757\u52a0\u8f7d\u56e0\u5b50\u77e9\u9635\n   - \u51cf\u5c11\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\n   - Bank\u51b2\u7a81\u907f\u514d</p>\n</li>\n<li>\n<p><strong>Tensor Core\u52a0\u901f</strong>\uff1a\n   \u5c06Kronecker\u79ef\u8fd0\u7b97\u6620\u5c04\u5230Tensor Core\u7684\u77e9\u9635\u4e58\u6cd5\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565</li>\n<li>\u6570\u636e\u5e03\u5c40\u4f18\u5316</li>\n<li>\u6d41\u6c34\u7ebf\u8bbe\u8ba1</li>\n</ul>\n<p><strong>\u5206\u5e03\u5f0f\u5185\u5b58\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u901a\u4fe1\u907f\u514d\u7b97\u6cd5</strong>\uff1a\n   \u6700\u5c0f\u5316\u5904\u7406\u5668\u95f4\u6570\u636e\u4f20\u8f93\uff1a</li>\n</ol>\n<ul>\n<li>2.5D\u7b97\u6cd5\u63a8\u5e7f</li>\n<li>\u9012\u5f52\u5206\u5757\u7b56\u7565</li>\n<li>\u5f02\u6b65\u901a\u4fe1\u9690\u85cf</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\n   - \u8003\u8651\u77e9\u9635\u7a00\u758f\u6027\u7684\u4efb\u52a1\u5206\u914d\n   - \u52a8\u6001\u8d1f\u8f7d\u5747\u8861\u673a\u5236\n   - \u5de5\u4f5c\u7a83\u53d6\u7b97\u6cd5</li>\n</ol>\n<h3 id=\"1228\">12.2.8 \u6570\u503c\u5206\u6790\u6df1\u5316</h3>\n<p><strong>\u6761\u4ef6\u6570\u5206\u6790</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u7ebf\u6027\u7cfb\u7edf$(\\mathbf{A} \\otimes \\mathbf{B})\\mathbf{x} = \\mathbf{b}$\uff1a\n$$\\kappa(\\mathbf{A} \\otimes \\mathbf{B}) = \\kappa(\\mathbf{A}) \\cdot \\kappa(\\mathbf{B})$$\n\u8fd9\u610f\u5473\u7740\uff1a</p>\n<ul>\n<li>\u6761\u4ef6\u6570\u76f8\u4e58\u53ef\u80fd\u5bfc\u81f4\u4e25\u91cd\u75c5\u6001</li>\n<li>\u9700\u8981\u4ed4\u7ec6\u7684\u9884\u6761\u4ef6\u8bbe\u8ba1</li>\n<li>\u8fed\u4ee3\u7ec6\u5316\u53ef\u80fd\u5fc5\u8981</li>\n</ul>\n<p><strong>\u8bef\u5dee\u4f20\u64ad\u5206\u6790</strong>\uff1a</p>\n<p>\u5728\u8fd1\u4f3cKronecker\u5206\u89e3$\\mathbf{M} \\approx \\mathbf{A} \\otimes \\mathbf{B}$\u4e2d\uff1a</p>\n<ol>\n<li>\n<p><strong>\u524d\u5411\u8bef\u5dee\u754c</strong>\uff1a\n$$|(\\mathbf{A} + \\Delta\\mathbf{A}) \\otimes (\\mathbf{B} + \\Delta\\mathbf{B}) - \\mathbf{A} \\otimes \\mathbf{B}| \\leq$$\n   $$|\\Delta\\mathbf{A}||\\mathbf{B}| + |\\mathbf{A}||\\Delta\\mathbf{B}| + |\\Delta\\mathbf{A}||\\Delta\\mathbf{B}|$$</p>\n</li>\n<li>\n<p><strong>\u540e\u5411\u7a33\u5b9a\u6027</strong>\uff1a\n   \u7b97\u6cd5\u662f\u540e\u5411\u7a33\u5b9a\u7684\u5982\u679c\u8ba1\u7b97\u7ed3\u679c\u662f\u7cbe\u786e\u95ee\u9898\u7684\u8f7b\u5fae\u6270\u52a8\u7684\u7cbe\u786e\u89e3</p>\n</li>\n</ol>\n<p><strong>\u8fed\u4ee3\u65b9\u6cd5\u7684\u6536\u655b\u6027</strong>\uff1a</p>\n<p>\u5bf9\u4e8eKronecker\u7ed3\u6784\u7684\u7ebf\u6027\u7cfb\u7edf\uff0cKrylov\u65b9\u6cd5\u7684\u6536\u655b\u6027\u5206\u6790\uff1a</p>\n<ul>\n<li>\u8c31\u5206\u5e03\uff1a$\\sigma(\\mathbf{A} \\otimes \\mathbf{B}) = {\\lambda_i\\mu_j}$</li>\n<li>\u7279\u5f81\u5411\u91cf\u7ed3\u6784\uff1a$\\mathbf{v}_i \\otimes \\mathbf{w}_j$</li>\n<li>\u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\uff1a\u5229\u7528\u56e0\u5b50\u7ed3\u6784</li>\n</ul>\n<p><strong>\u820d\u5165\u8bef\u5dee\u7684\u7d2f\u79ef</strong>\uff1a</p>\n<p>\u5728\u9012\u5f52Kronecker\u8fd0\u7b97\u4e2d\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8bef\u5dee\u589e\u957f\u6a21\u578b\uff1a\n\u03b5_k \u2264 c\u00b7k\u00b7\u03b5_machine\u00b7(\u4ea7\u54c1\u7684\u8303\u6570)\n\u9700\u8981\uff1a\n<span class=\"k\">-</span> \u4e2d\u95f4\u7ed3\u679c\u5f52\u4e00\u5316\n<span class=\"k\">-</span> \u8865\u507f\u6c42\u548c\u6280\u672f\n<span class=\"k\">-</span> \u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\n</code></pre></div>\n\n<h3 id=\"1229\">12.2.9 \u524d\u6cbf\u7814\u7a76\u65b9\u5411</h3>\n<p><strong>\u91cf\u5b50\u8ba1\u7b97\u4e2d\u7684Kronecker\u7ed3\u6784</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91cf\u5b50\u7535\u8def\u7684\u5f20\u91cf\u7f51\u7edc\u8868\u793a</strong>\uff1a\n   - \u91cf\u5b50\u95e8\u4f5c\u4e3a\u5f20\u91cf\n   - Kronecker\u79ef\u63cf\u8ff0\u5e76\u884c\u64cd\u4f5c\n   - \u7ea0\u7f20\u7684\u4ee3\u6570\u523b\u753b</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50-\u7ecf\u5178\u6df7\u5408\u7b97\u6cd5</strong>\uff1a\n   - VQE\u4e2d\u7684Kronecker\u7ed3\u6784\u5229\u7528\n   - \u53c2\u6570\u5316\u91cf\u5b50\u7535\u8def\u7684\u7ecf\u5178\u4f18\u5316\n   - \u91cf\u5b50\u6838\u65b9\u6cd5\u7684Kronecker\u6280\u5de7</p>\n</li>\n</ol>\n<p><strong>\u968f\u673aKronecker\u79ef</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u968f\u673a\u77e9\u9635\u7406\u8bba\u89c6\u89d2</strong>\uff1a\n   - \u968f\u673aKronecker\u79ef\u7684\u8c31\u5206\u5e03\n   - \u6781\u9650\u5b9a\u7406\u548c\u96c6\u4e2d\u4e0d\u7b49\u5f0f\n   - \u5728\u7edf\u8ba1\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u6982\u7387\u56fe\u6a21\u578b</strong>\uff1a\n   - Kronecker\u56fe\u751f\u6210\u6a21\u578b\n   - \u793e\u4ea4\u7f51\u7edc\u7684\u591a\u5c3a\u5ea6\u5efa\u6a21\n   - \u53c2\u6570\u5b66\u4e60\u7b97\u6cd5</p>\n</li>\n</ol>\n<p><strong>\u975e\u7ebf\u6027Kronecker\u7ed3\u6784</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Kronecker\u79ef\u7684\u63a8\u5e7f</strong>\uff1a\n   - \u975e\u7ebf\u6027Kronecker\u6620\u5c04\n   - \u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\n   - \u8868\u8fbe\u80fd\u529b\u5206\u6790</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001Kronecker\u7cfb\u7edf</strong>\uff1a\n   - \u65f6\u53d8Kronecker\u7ed3\u6784\n   - \u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5\n   - \u7a33\u5b9a\u6027\u5206\u6790</p>\n</li>\n</ol>\n<p><strong>\u81ea\u52a8\u5fae\u5206\u4e0eKronecker\u79ef</strong>\uff1a</p>\n<ol>\n<li><strong>\u9ad8\u6548\u68af\u5ea6\u8ba1\u7b97</strong>\uff1a\n   \u5229\u7528Kronecker\u7ed3\u6784\u52a0\u901f\u81ea\u52a8\u5fae\u5206\uff1a</li>\n</ol>\n<ul>\n<li>\u8ba1\u7b97\u56fe\u4f18\u5316</li>\n<li>\u5185\u5b58\u6548\u7387\u63d0\u5347</li>\n<li>\u9ad8\u9636\u5bfc\u6570\u8ba1\u7b97</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u9690\u5f0f\u5fae\u5206</strong>\uff1a\n   \u5bf9\u4e8e$(\\mathbf{A} \\otimes \\mathbf{B})\\mathbf{x} = \\mathbf{b}$\u7684\u9690\u5f0f\u5fae\u5206\uff1a</li>\n</ol>\n<ul>\n<li>\u907f\u514d\u663e\u5f0f\u6c42\u9006</li>\n<li>\u8fed\u4ee3\u6c42\u89e3\u68af\u5ea6</li>\n<li>\u5728\u53cc\u5c42\u4f18\u5316\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h3 id=\"12210\">12.2.10 \u5de5\u4e1a\u5e94\u7528\u6848\u4f8b</h3>\n<p><strong>\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u591a\u6a21\u6001\u63a8\u8350</strong>\uff1a\n   \u7528\u6237-\u7269\u54c1\u4ea4\u4e92\u5f20\u91cf\u7684Kronecker\u5206\u89e3\uff1a\n$$\\mathcal{R} \\approx \\mathcal{G} \\times_1 \\mathbf{U} \\times_2 \\mathbf{I} \\times_3 \\mathbf{C}$$\n\u5176\u4e2dU=\u7528\u6237\uff0cI=\u7269\u54c1\uff0cC=\u4e0a\u4e0b\u6587</p>\n</li>\n<li>\n<p><strong>\u51b7\u542f\u52a8\u95ee\u9898</strong>\uff1a\n   \u5229\u7528Kronecker\u7ed3\u6784\u8fc1\u79fb\u77e5\u8bc6\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u8de8\u57df\u63a8\u8350</li>\n<li>\u5c11\u6837\u672c\u5b66\u4e60</li>\n<li>\u5143\u5b66\u4e60\u6846\u67b6</li>\n</ul>\n<p><strong>\u8ba1\u7b97\u673a\u89c6\u89c9\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li><strong>\u591a\u5c3a\u5ea6\u7279\u5f81\u63d0\u53d6</strong>\uff1a\n   Kronecker\u5377\u79ef\u5206\u89e3\uff1a</li>\n</ol>\n<ul>\n<li>\u6df1\u5ea6\u53ef\u5206\u79bb\u5377\u79ef\u7684\u63a8\u5e7f</li>\n<li>\u8ba1\u7b97\u6548\u7387\u4e0e\u8868\u8fbe\u80fd\u529b\u5e73\u8861</li>\n<li>\u79fb\u52a8\u7aef\u90e8\u7f72\u4f18\u5316</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u89c6\u9891\u7406\u89e3</strong>\uff1a\n   \u65f6\u7a7aKronecker\u5206\u89e3\uff1a</li>\n</ol>\n<ul>\n<li>\u5206\u79bb\u7a7a\u95f4\u548c\u65f6\u95f4\u5904\u7406</li>\n<li>3D\u5377\u79ef\u7684\u9ad8\u6548\u8fd1\u4f3c</li>\n<li>\u957f\u7a0b\u4f9d\u8d56\u5efa\u6a21</li>\n</ul>\n<p><strong>\u79d1\u5b66\u8ba1\u7b97\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li><strong>\u504f\u5fae\u5206\u65b9\u7a0b\u6c42\u89e3</strong>\uff1a\n   Kronecker\u79ef\u5728\u6709\u9650\u5dee\u5206/\u6709\u9650\u5143\u4e2d\uff1a</li>\n</ol>\n<ul>\n<li>\u5206\u79bb\u53d8\u91cf\u6cd5\u7684\u77e9\u9635\u5f62\u5f0f</li>\n<li>\u9ad8\u7ef4\u95ee\u9898\u7684\u5f20\u91cf\u5206\u89e3</li>\n<li>\u591a\u91cd\u7f51\u683c\u65b9\u6cd5\u52a0\u901f</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u91cf\u5b50\u5316\u5b66\u8ba1\u7b97</strong>\uff1a\n   \u7535\u5b50\u7ed3\u6784\u8ba1\u7b97\u4e2d\u7684Kronecker\u6280\u672f\uff1a</li>\n</ol>\n<ul>\n<li>\u591a\u7535\u5b50\u79ef\u5206\u7684\u5206\u89e3</li>\n<li>\u5bc6\u5ea6\u77e9\u9635\u7684\u538b\u7f29\u8868\u793a</li>\n<li>\u7ebf\u6027\u6807\u5ea6\u7b97\u6cd5</li>\n</ul>\n<h2 id=\"123-h-matrices\">12.3 \u5206\u5c42\u77e9\u9635\uff08H-matrices\uff09</h2>\n<h3 id=\"1231-h-matrices\">12.3.1 H-matrices\u7684\u9012\u5f52\u7ed3\u6784</h3>\n<p>\u5206\u5c42\u77e9\u9635\uff08Hierarchical matrices\uff09\u662f\u4e00\u7c7b\u901a\u8fc7\u9012\u5f52\u5206\u5757\u548c\u4f4e\u79e9\u8fd1\u4f3c\u5b9e\u73b0\u9ad8\u6548\u5b58\u50a8\u548c\u8ba1\u7b97\u7684\u77e9\u9635\u8868\u793a\u65b9\u6cd5\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u8fdc\u79bb\u5bf9\u89d2\u7ebf\u7684\u5b50\u5757\u901a\u5e38\u53ef\u4ee5\u7528\u4f4e\u79e9\u77e9\u9635\u8fd1\u4f3c\u3002</p>\n<p><strong>\u9012\u5f52\u5206\u5757\u7ed3\u6784</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>level 0: [    \u5b8c\u6574\u77e9\u9635    ]\nlevel 1: [  A11  |  A12  ]\n         [  A21  |  A22  ]\nlevel 2: \u7ee7\u7eed\u7ec6\u5206...\n</code></pre></div>\n\n<p><strong>\u53ef\u5bb9\u8bb8\u6027\u6761\u4ef6</strong>\uff1a\n\u5b50\u5757$\\mathbf{A}_{ij}$\u662f\u5426\u53ef\u4ee5\u4f4e\u79e9\u8fd1\u4f3c\u53d6\u51b3\u4e8e\u5bf9\u5e94\u7684\u7d22\u5f15\u96c6\u7684\u51e0\u4f55\u5206\u79bb\u7a0b\u5ea6\uff1a\n$$\\min({\\rm diam}(I_i), {\\rm diam}(I_j)) \\leq \\eta \\cdot {\\rm dist}(I_i, I_j)$$\n\u5176\u4e2d$\\eta$\u662f\u53ef\u5bb9\u8bb8\u6027\u53c2\u6570\uff0c\u901a\u5e38\u53d60.5-2.0\u3002</p>\n<h3 id=\"1232\">12.3.2 \u4f4e\u79e9\u5757\u7684\u81ea\u9002\u5e94\u538b\u7f29</h3>\n<p>\u5bf9\u4e8e\u53ef\u5bb9\u8bb8\u5757\uff0c\u6211\u4eec\u5bfb\u6c42\u8fd1\u4f3c\uff1a\n$$\\mathbf{A}_{ij} \\approx \\mathbf{U}_{ij}\\mathbf{V}_{ij}^T, \\quad \\mathbf{U}_{ij} \\in \\mathbb{R}^{m \\times k}, \\mathbf{V}_{ij} \\in \\mathbb{R}^{n \\times k}$$\n<strong>\u538b\u7f29\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>ACA\uff08Adaptive Cross Approximation\uff09</strong>\uff1a\n   - \u901a\u8fc7\u81ea\u9002\u5e94\u9009\u62e9\u884c\u5217\u6784\u9020\u4f4e\u79e9\u8fd1\u4f3c\n   - \u65e0\u9700\u8bbf\u95ee\u6574\u4e2a\u77e9\u9635\uff0c\u4ec5\u9700\u77e9\u9635\u5143\u7d20\u7684\u6309\u9700\u8ba1\u7b97\n   - \u8bef\u5dee\u63a7\u5236\uff1a$|\\mathbf{A}_{ij} - \\mathbf{U}_{ij}\\mathbf{V}_{ij}^T| \\leq \\varepsilon|\\mathbf{A}_{ij}|$</p>\n</li>\n<li>\n<p><strong>HCA\uff08Hybrid Cross Approximation\uff09</strong>\uff1a\n   - \u7ed3\u5408\u89e3\u6790\u4fe1\u606f\u52a0\u901f\u6536\u655b\n   - \u5bf9\u4e8e\u7279\u5b9a\u6838\u51fd\u6570\uff08\u5982Green\u51fd\u6570\uff09\u7279\u522b\u6709\u6548</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u5316\u65b9\u6cd5</strong>\uff1a\n   - \u4f7f\u7528\u968f\u673a\u6295\u5f71\u964d\u4f4e\u8ba1\u7b97\u590d\u6742\u5ea6\n   - \u6982\u7387\u8bef\u5dee\u4fdd\u8bc1</p>\n</li>\n</ol>\n<h3 id=\"1233\">12.3.3 \u5feb\u901f\u77e9\u9635\u8fd0\u7b97\u7b97\u6cd5</h3>\n<p>H-matrices\u652f\u6301\u591a\u79cd\u77e9\u9635\u8fd0\u7b97\u7684\u5feb\u901f\u7b97\u6cd5\uff1a</p>\n<p><strong>\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n\\log n)$\u6216$\\mathcal{O}(n)$\uff08\u53d6\u51b3\u4e8e\u77e9\u9635\u7ed3\u6784\uff09</li>\n<li>\u9012\u5f52\u7b97\u6cd5\uff1a\n  1. \u5bf9\u4e8e\u4f4e\u79e9\u5757\uff1a$(\\mathbf{U}\\mathbf{V}^T)\\mathbf{x} = \\mathbf{U}(\\mathbf{V}^T\\mathbf{x})$\n  2. \u5bf9\u4e8e\u6ee1\u79e9\u5757\uff1a\u76f4\u63a5\u8ba1\u7b97\n  3. \u9012\u5f52\u5904\u7406\u5b50\u5757</li>\n</ul>\n<p><strong>\u77e9\u9635\u52a0\u6cd5\u548c\u4e58\u6cd5</strong>\uff1a</p>\n<ul>\n<li>H-matrix\u683c\u5f0f\u4e0b\u7684\u7b97\u672f\u8fd0\u7b97</li>\n<li>\u9700\u8981\u91cd\u65b0\u538b\u7f29\u4ee5\u63a7\u5236\u79e9\u7684\u589e\u957f</li>\n<li>truncation\u7b56\u7565\u7684\u9009\u62e9\u5f71\u54cd\u7cbe\u5ea6\u548c\u6548\u7387</li>\n</ul>\n<p><strong>\u77e9\u9635\u6c42\u9006\u548cLU\u5206\u89e3</strong>\uff1a</p>\n<ul>\n<li>\u9012\u5f52\u5757LU\u5206\u89e3</li>\n<li>Schur\u8865\u7684\u4f4e\u79e9\u66f4\u65b0</li>\n<li>\u8fd1\u4f3c\u6c42\u9006\u7684\u8bef\u5dee\u7d2f\u79ef\u63a7\u5236</li>\n</ul>\n<h3 id=\"1234\">12.3.4 \u8bef\u5dee\u5206\u6790\u4e0e\u590d\u6742\u5ea6</h3>\n<p><strong>\u903c\u8fd1\u8bef\u5dee</strong>\uff1a\n\u5bf9\u4e8e\u6ee1\u8db3\u4e00\u5b9a\u8870\u51cf\u6761\u4ef6\u7684\u6838\u51fd\u6570\uff08\u5982$|K(x,y)| \\leq \\frac{C}{|x-y|^\\alpha}$\uff09\uff0cH-matrix\u8fd1\u4f3c\u8bef\u5dee\u4e3a\uff1a\n$$|\\mathbf{K} - \\mathbf{K}_\\mathcal{H}| \\leq C_{\\rm approx} \\cdot h^p$$\n\u5176\u4e2d$h$\u662f\u6700\u7ec6\u5c42\u7684\u5757\u5927\u5c0f\uff0c$p$\u662f\u8fd1\u4f3c\u9636\u6570\u3002</p>\n<p><strong>\u5b58\u50a8\u590d\u6742\u5ea6</strong>\uff1a</p>\n<ul>\n<li>\u6807\u51c6\u77e9\u9635\uff1a$\\mathcal{O}(n^2)$</li>\n<li>H-matrix\uff1a$\\mathcal{O}(n\\log n)$\u6216$\\mathcal{O}(n)$</li>\n</ul>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u5bf9\u6bd4</strong>\uff1a\n| \u8fd0\u7b97 | \u6807\u51c6\u683c\u5f0f | H-matrix\u683c\u5f0f |</p>\n<table>\n<thead>\n<tr>\n<th>\u8fd0\u7b97</th>\n<th>\u6807\u51c6\u683c\u5f0f</th>\n<th>H-matrix\u683c\u5f0f</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u77e9\u9635-\u5411\u91cf\u4e58</td>\n<td>$\\mathcal{O}(n^2)$</td>\n<td>$\\mathcal{O}(n\\log n)$</td>\n</tr>\n<tr>\n<td>\u77e9\u9635\u4e58\u6cd5</td>\n<td>$\\mathcal{O}(n^3)$</td>\n<td>$\\mathcal{O}(n\\log^2 n)$</td>\n</tr>\n<tr>\n<td>LU\u5206\u89e3</td>\n<td>$\\mathcal{O}(n^3)$</td>\n<td>$\\mathcal{O}(n\\log^2 n)$</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"1235\">12.3.5 \u7814\u7a76\u7ebf\u7d22\u4e0e\u5f00\u653e\u95ee\u9898</h3>\n<ol>\n<li>\n<p><strong>\u9ad8\u7ef4\u95ee\u9898\u7684H-matrix\u63a8\u5e7f</strong>\uff1a\n   - \u7ef4\u5ea6\u8bc5\u5492\u7684\u7f13\u89e3\u7b56\u7565\n   - \u4e0e\u5f20\u91cf\u5206\u89e3\u65b9\u6cd5\u7684\u7ed3\u5408</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001H-matrix\u66f4\u65b0</strong>\uff1a\n   - \u77e9\u9635\u5143\u7d20\u53d8\u5316\u65f6\u7684\u589e\u91cf\u66f4\u65b0\n   - \u5728\u65f6\u53d8\u7cfb\u7edf\u4e2d\u7684\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u4e0eGPU\u52a0\u901f</strong>\uff1a\n   - \u4efb\u52a1\u4f9d\u8d56\u56fe\u7684\u4f18\u5316\u8c03\u5ea6\n   - \u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</strong>\uff1a\n   - \u6838\u77e9\u9635\u7684H-matrix\u8868\u793a\n   - \u4e0e\u795e\u7ecf\u7f51\u7edc\u7ed3\u6784\u7684\u8054\u7cfb</p>\n</li>\n</ol>\n<h3 id=\"1236-h-matrices\">12.3.6 H-matrices\u7684\u9ad8\u7ea7\u7406\u8bba</h3>\n<p><strong>\u4ee3\u6570\u591a\u91cd\u7f51\u683c\uff08AMG\uff09\u7684\u8054\u7cfb</strong>\uff1a</p>\n<p>H-matrices\u4e0eAMG\u65b9\u6cd5\u6709\u6df1\u523b\u8054\u7cfb\uff1a</p>\n<ul>\n<li>\u5c42\u6b21\u7ed3\u6784\u7684\u6784\u5efa</li>\n<li>\u7c97\u5316\u7b56\u7565\u7684\u9009\u62e9</li>\n<li>\u63d2\u503c\u7b97\u5b50\u7684\u8bbe\u8ba1</li>\n</ul>\n<p>\u5173\u952e\u533a\u522b\uff1a</p>\n<ul>\n<li>H-matrices\u5f3a\u8c03\u4f4e\u79e9\u8fd1\u4f3c</li>\n<li>AMG\u5f3a\u8c03\u7a00\u758f\u6027\u4fdd\u6301</li>\n<li>\u53ef\u7ed3\u5408\u4e24\u8005\u4f18\u52bf</li>\n</ul>\n<p><strong>\u8c31\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<p>\u5bf9\u4e8eH-matrix\u8fd1\u4f3c$\\mathbf{A}_\\mathcal{H}$\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7279\u5f81\u503c\u6270\u52a8</strong>\uff1a\n$$|\\lambda_i(\\mathbf{A}) - \\lambda_i(\\mathbf{A}_\\mathcal{H})| \\leq |\\mathbf{A} - \\mathbf{A}_\\mathcal{H}|$$</p>\n</li>\n<li>\n<p><strong>\u805a\u7c7b\u6027\u8d28</strong>\uff1a\n   \u8fdc\u79bb\u5bf9\u89d2\u7ebf\u5757\u7684\u4f4e\u79e9\u6027\u5bfc\u81f4\u7279\u5f81\u503c\u805a\u7c7b</p>\n</li>\n<li>\n<p><strong>\u8c31\u7b49\u4ef7\u6027</strong>\uff1a\n   \u5b58\u5728\u5e38\u6570$c_1, c_2$\u4f7f\u5f97\uff1a\n$$c_1(\\mathbf{A}\\mathbf{x}, \\mathbf{x}) \\leq (\\mathbf{A}_\\mathcal{H}\\mathbf{x}, \\mathbf{x}) \\leq c_2(\\mathbf{A}\\mathbf{x}, \\mathbf{x})$$\n<strong>\u590d\u6742\u5ea6\u7684\u7cbe\u7ec6\u5206\u6790</strong>\uff1a</p>\n</li>\n<li>\n<p><strong>\u5b58\u50a8\u590d\u6742\u5ea6</strong>\uff1a\n   - \u6700\u4f18\u60c5\u51b5\uff1a$\\mathcal{O}(n)$\uff08\u4e00\u7ef4\u95ee\u9898\uff09\n   - \u5178\u578b\u60c5\u51b5\uff1a$\\mathcal{O}(n\\log n)$\uff08\u4e8c\u7ef4\u95ee\u9898\uff09\n   - \u6700\u574f\u60c5\u51b5\uff1a$\\mathcal{O}(n\\log^{d-1} n)$\uff08d\u7ef4\u95ee\u9898\uff09</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u590d\u6742\u5ea6\u7ec6\u5316</strong>\uff1a\n   \u77e9\u9635-\u5411\u91cf\u4e58\u6cd5\u7684\u5e38\u6570\u56e0\u5b50\u5206\u6790\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u79e9\u7684\u5f71\u54cd\uff1a$\\mathcal{O}(k n \\log n)$\uff0ck\u662f\u6700\u5927\u79e9</li>\n<li>\u6df1\u5ea6\u7684\u5f71\u54cd\uff1a\u4e0e\u6811\u7684\u6df1\u5ea6\u6210\u6b63\u6bd4</li>\n<li>\u53ef\u5bb9\u8bb8\u6027\u53c2\u6570\u03b7\u7684\u5f71\u54cd</li>\n</ul>\n<p><strong>\u7a33\u5b9a\u6027\u7406\u8bba</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u622a\u65ad\u8bef\u5dee\u7d2f\u79ef</strong>\uff1a\n   \u5728\u9012\u5f52\u7b97\u6cd5\u4e2d\uff0c\u8bef\u5dee\u4ee5\u53ef\u63a7\u65b9\u5f0f\u7d2f\u79ef\uff1a\n$$\\varepsilon_{\\text{total}} \\leq C \\log n \\cdot \\varepsilon_{\\text{local}}$$</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u4fdd\u6301</strong>\uff1a\n   \u826f\u597d\u7684H-matrix\u8fd1\u4f3c\u4fdd\u6301\u539f\u77e9\u9635\u7684\u6761\u4ef6\u6570\uff1a\n$$\\kappa(\\mathbf{A}_\\mathcal{H}) \\leq (1 + \\varepsilon)\\kappa(\\mathbf{A})$$</p>\n</li>\n</ol>\n<h3 id=\"1237\">12.3.7 \u5b9e\u73b0\u6280\u672f\u4e0e\u4f18\u5316</h3>\n<p><strong>\u5185\u5b58\u5e03\u5c40\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u5206\u5c42\u5b58\u50a8\u7ed3\u6784</strong>\uff1a\n   ```\n   H-matrix\u8282\u70b9\uff1a</li>\n</ol>\n<ul>\n<li>\u7c7b\u578b\u6807\u5fd7\uff08\u6ee1\u79e9/\u4f4e\u79e9\uff09</li>\n<li>\u5b50\u8282\u70b9\u6307\u9488\uff08\u9012\u5f52\u7ed3\u6784\uff09</li>\n<li>\u6570\u636e\u6307\u9488\uff08U, V\u56e0\u5b50\u6216\u6ee1\u79e9\u5757\uff09</li>\n<li>\u5143\u6570\u636e\uff08\u5927\u5c0f\u3001\u79e9\u7b49\uff09\n   ```</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u5185\u5b58\u6c60\u7ba1\u7406</strong>\uff1a\n   - \u9884\u5206\u914d\u5185\u5b58\u6c60\u51cf\u5c11\u788e\u7247\n   - \u5bf9\u9f50\u4f18\u5316\u63d0\u9ad8\u7f13\u5b58\u6548\u7387\n   - \u5f15\u7528\u8ba1\u6570\u7ba1\u7406\u751f\u547d\u5468\u671f</li>\n</ol>\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4efb\u52a1\u5e76\u884c</strong>\uff1a\n   - \u57fa\u4e8e\u6811\u7ed3\u6784\u7684\u4efb\u52a1\u5206\u89e3\n   - \u4f7f\u7528\u4efb\u52a1\u4f9d\u8d56\u56fe\n   - \u52a8\u6001\u8c03\u5ea6\u907f\u514d\u8d1f\u8f7d\u4e0d\u5747</p>\n</li>\n<li>\n<p><strong>\u6570\u636e\u5e76\u884c</strong>\uff1a\n   - SIMD\u5411\u91cf\u5316\u4f4e\u79e9\u77e9\u9635\u8fd0\u7b97\n   - \u6279\u91cf\u5904\u7406\u76f8\u540c\u5927\u5c0f\u7684\u5757\n   - GPU\u52a0\u901f\u7684\u6df7\u5408\u7b56\u7565</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0fH-matrices</strong>\uff1a\n   - \u6811\u7684\u5206\u5e03\u5f0f\u8868\u793a\n   - \u901a\u4fe1\u6a21\u5f0f\u4f18\u5316\n   - \u8d1f\u8f7d\u5747\u8861\u8003\u8651</p>\n</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5c40\u90e8\u8bef\u5dee\u4f30\u8ba1</strong>\uff1a\n   \u4f7f\u7528\u968f\u673a\u91c7\u6837\u4f30\u8ba1\u622a\u65ad\u8bef\u5dee\uff1a\n$$|\\mathbf{A}_{ij} - \\mathbf{U}_{ij}\\mathbf{V}_{ij}^T| \\approx |\\mathbf{A}_{ij}\\mathbf{\\Omega} - \\mathbf{U}_{ij}\\mathbf{V}_{ij}^T\\mathbf{\\Omega}|$$</p>\n</li>\n<li>\n<p><strong>\u5168\u5c40\u8bef\u5dee\u63a7\u5236</strong>\uff1a\n   - \u81ea\u9002\u5e94\u9009\u62e9\u4e0d\u540c\u5757\u7684\u7cbe\u5ea6\n   - \u57fa\u4e8e\u91cd\u8981\u6027\u7684\u8d44\u6e90\u5206\u914d\n   - \u540e\u9a8c\u8bef\u5dee\u4f30\u8ba1</p>\n</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u53d8\u4f53</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>H\u00b2-matrices</strong>\uff1a\n   - \u5bf9U, V\u56e0\u5b50\u4e5f\u91c7\u7528\u5206\u5c42\u7ed3\u6784\n   - \u8fdb\u4e00\u6b65\u964d\u4f4e\u590d\u6742\u5ea6\u5230$\\mathcal{O}(n)$\n   - \u5b9e\u73b0\u66f4\u52a0\u590d\u6742</p>\n</li>\n<li>\n<p><strong>HODLR\uff08Hierarchically Off-Diagonal Low-Rank\uff09</strong>\uff1a\n   - \u7b80\u5316\u7684H-matrix\u53d8\u4f53\n   - \u4ec5\u5bf9\u89d2\u7ebf\u5916\u5757\u4f4e\u79e9\n   - \u66f4\u6613\u4e8e\u5b9e\u73b0\u548c\u5206\u6790</p>\n</li>\n<li>\n<p><strong>HSS\uff08Hierarchically Semi-Separable\uff09</strong>\uff1a\n   - \u7279\u6b8a\u7684\u5d4c\u5957\u57fa\u8868\u793a\n   - \u5feb\u901f\u6c42\u89e3\u5668\u8bbe\u8ba1\n   - \u4e0e\u5feb\u901f\u591a\u6781\u65b9\u6cd5\u7684\u8054\u7cfb</p>\n</li>\n</ol>\n<h3 id=\"1238\">12.3.8 \u5e94\u7528\u9886\u57df\u6df1\u5316</h3>\n<p><strong>\u79ef\u5206\u65b9\u7a0b\u6c42\u89e3</strong>\uff1a</p>\n<ol>\n<li><strong>\u8fb9\u754c\u5143\u65b9\u6cd5\uff08BEM\uff09</strong>\uff1a\n   \u5bf9\u4e8eLaplace\u65b9\u7a0b\u7684\u8fb9\u754c\u79ef\u5206\uff1a\n$$\\frac{1}{2}u(x) + \\int_\\Gamma K(x,y)u(y)dy = f(x)$$\n\u79bb\u6563\u5316\u540e\u7684\u77e9\u9635\u662fH-matrix\u7684\u7406\u60f3\u5019\u9009\uff1a</li>\n</ol>\n<ul>\n<li>\u6838\u51fd\u6570\u7684\u8870\u51cf\u6027\u8d28</li>\n<li>\u51e0\u4f55\u5206\u79bb\u5bfc\u81f4\u4f4e\u79e9</li>\n<li>\u9ad8\u7cbe\u5ea6\u5feb\u901f\u6c42\u89e3</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u4f53\u79ef\u5206\u65b9\u7a0b</strong>\uff1a\n   - \u6563\u5c04\u95ee\u9898\n   - \u7535\u78c1\u573a\u8ba1\u7b97\n   - \u6d41\u4f53\u529b\u5b66\u5e94\u7528</li>\n</ol>\n<p><strong>\u534f\u65b9\u5dee\u77e9\u9635\u8ba1\u7b97</strong>\uff1a</p>\n<ol>\n<li><strong>\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52</strong>\uff1a\n   \u534f\u65b9\u5dee\u77e9\u9635$\\mathbf{K}_{ij} = k(x_i, x_j)$\u7684H-matrix\u8868\u793a\uff1a</li>\n</ol>\n<ul>\n<li>\u5927\u89c4\u6a21\u6570\u636e\u70b9</li>\n<li>\u5feb\u901f\u9884\u6d4b</li>\n<li>\u4e0d\u786e\u5b9a\u6027\u91cf\u5316</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u7a7a\u95f4\u7edf\u8ba1</strong>\uff1a\n   - \u5730\u7edf\u8ba1\u5b66\u4e2d\u7684\u514b\u91cc\u91d1\u63d2\u503c\n   - \u5927\u89c4\u6a21\u7a7a\u95f4\u6570\u636e\u5206\u6790\n   - \u975e\u5e73\u7a33\u534f\u65b9\u5dee\u5efa\u6a21</li>\n</ol>\n<p><strong>\u504f\u5fae\u5206\u65b9\u7a0b\u9884\u6761\u4ef6</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u692d\u5706\u7b97\u5b50</strong>\uff1a\n   - \u9006\u77e9\u9635\u7684H-matrix\u8fd1\u4f3c\n   - \u591a\u91cd\u7f51\u683c\u7684\u66ff\u4ee3\u65b9\u6848\n   - \u590d\u6742\u51e0\u4f55\u7684\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u65f6\u95f4\u6b65\u8fdb\u65b9\u6848</strong>\uff1a\n   - \u9690\u5f0f\u65b9\u6cd5\u7684\u5feb\u901f\u6c42\u89e3\n   - \u957f\u65f6\u95f4\u79ef\u5206\u7684\u6548\u7387\n   - \u81ea\u9002\u5e94\u65f6\u95f4\u6b65\u957f</p>\n</li>\n</ol>\n<h3 id=\"1239\">12.3.9 \u4e0e\u5176\u4ed6\u65b9\u6cd5\u7684\u6bd4\u8f83\u4e0e\u7ed3\u5408</h3>\n<p><strong>\u5feb\u901f\u591a\u6781\u65b9\u6cd5\uff08FMM\uff09vs H-matrices</strong>\uff1a</p>\n<p>\u6bd4\u8f83\u7ef4\u5ea6\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7406\u8bba\u57fa\u7840</strong>\uff1a\n   - FMM\uff1a\u89e3\u6790\u5c55\u5f00\uff08\u591a\u6781/\u5c40\u90e8\uff09\n   - H-matrices\uff1a\u7eaf\u4ee3\u6570\u4f4e\u79e9\u8fd1\u4f3c</p>\n</li>\n<li>\n<p><strong>\u9002\u7528\u8303\u56f4</strong>\uff1a\n   - FMM\uff1a\u7279\u5b9a\u6838\u51fd\u6570\n   - H-matrices\uff1a\u4e00\u822c\u77e9\u9635</p>\n</li>\n<li>\n<p><strong>\u5b9e\u73b0\u590d\u6742\u5ea6</strong>\uff1a\n   - FMM\uff1a\u9700\u8981\u6838\u51fd\u6570\u7684\u89e3\u6790\u6027\u8d28\n   - H-matrices\uff1a\u9ed1\u76d2\u65b9\u6cd5</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u7279\u70b9</strong>\uff1a\n   - FMM\uff1a\u5e38\u6570\u56e0\u5b50\u5c0f\n   - H-matrices\uff1a\u66f4\u901a\u7528</p>\n</li>\n</ol>\n<p><strong>\u7ed3\u5408\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528FMM\u6784\u9020H-matrix\u7684\u521d\u59cb\u8fd1\u4f3c</li>\n<li>H-matrix\u6846\u67b6\u4e0b\u7684FMM\u5b9e\u73b0</li>\n<li>\u6df7\u5408\u8868\u793a\u4f18\u5316\u5185\u5b58\u4f7f\u7528</li>\n</ul>\n<p><strong>\u4e0e\u5f20\u91cf\u5206\u89e3\u7684\u8054\u7cfb</strong>\uff1a</p>\n<ol>\n<li><strong>\u9ad8\u7ef4\u63a8\u5e7f</strong>\uff1a\n   H-matrices\u53ef\u89c6\u4e3a\u4e8c\u7ef4\u5f20\u91cf\u7684\u7279\u6b8a\u5206\u89e3\uff1a</li>\n</ol>\n<ul>\n<li>Tucker\u5206\u89e3\u7684\u5206\u5c42\u7248\u672c</li>\n<li>\u4e0e\u5f20\u91cf\u7f51\u7edc\u7684\u8054\u7cfb</li>\n<li>\u9ad8\u7ef4\u79ef\u5206\u7b97\u5b50\u7684\u8868\u793a</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u7b97\u6cd5\u501f\u9274</strong>\uff1a\n   - ALS\u7b97\u6cd5\u7684\u63a8\u5e7f\n   - \u968f\u673a\u5316\u65b9\u6cd5\u7684\u5e94\u7528\n   - \u4f4e\u79e9\u66f4\u65b0\u6280\u672f</li>\n</ol>\n<h3 id=\"12310\">12.3.10 \u672a\u6765\u53d1\u5c55\u65b9\u5411</h3>\n<p><strong>\u673a\u5668\u5b66\u4e60\u96c6\u6210</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u795e\u7ecf\u7f51\u7edc\u52a0\u901f</strong>\uff1a\n   - Transformer\u6ce8\u610f\u529b\u77e9\u9635\u7684H-matrix\u8fd1\u4f3c\n   - \u5377\u79ef\u5c42\u7684\u5206\u5c42\u8868\u793a\n   - \u8bad\u7ec3\u8fc7\u7a0b\u7684\u52a0\u901f</p>\n</li>\n<li>\n<p><strong>\u6838\u65b9\u6cd5\u4f18\u5316</strong>\uff1a\n   - \u5927\u89c4\u6a21SVM\u8bad\u7ec3\n   - \u8c31\u805a\u7c7b\u7b97\u6cd5\n   - \u6d41\u5f62\u5b66\u4e60\u65b9\u6cd5</p>\n</li>\n</ol>\n<p><strong>\u91cf\u5b50\u8ba1\u7b97\u63a5\u53e3</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91cf\u5b50\u7ebf\u8def\u6a21\u62df</strong>\uff1a\n   - \u5927\u89c4\u6a21\u91cf\u5b50\u7cfb\u7edf\u7684\u7ecf\u5178\u6a21\u62df\n   - H-matrix\u8868\u793a\u5bc6\u5ea6\u77e9\u9635\n   - \u7ea0\u7f20\u7ed3\u6784\u7684\u5229\u7528</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7b97\u6cd5</strong>\uff1a\n   - \u91cf\u5b50-\u7ecf\u5178\u8fed\u4ee3\n   - \u53d8\u5206\u7b97\u6cd5\u7684\u7ecf\u5178\u90e8\u5206\n   - \u8bef\u5dee\u7f13\u89e3\u6280\u672f</p>\n</li>\n</ol>\n<p><strong>\u81ea\u52a8\u5316\u4e0e\u667a\u80fd\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u81ea\u52a8\u53c2\u6570\u9009\u62e9</strong>\uff1a\n   - \u673a\u5668\u5b66\u4e60\u9884\u6d4b\u6700\u4f18\u53c2\u6570\n   - \u5728\u7ebf\u81ea\u9002\u5e94\u8c03\u6574\n   - \u6027\u80fd\u6a21\u578b\u6784\u5efa</p>\n</li>\n<li>\n<p><strong>\u4ee3\u7801\u751f\u6210</strong>\uff1a\n   - \u9488\u5bf9\u7279\u5b9a\u95ee\u9898\u7684\u4f18\u5316\u4ee3\u7801\n   - \u786c\u4ef6\u7279\u5b9a\u7684\u5b9e\u73b0\n   - \u81ea\u52a8\u5e76\u884c\u5316</p>\n</li>\n</ol>\n<p><strong>\u65b0\u5e94\u7528\u9886\u57df</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u751f\u7269\u4fe1\u606f\u5b66</strong>\uff1a\n   - \u57fa\u56e0\u7ec4\u6570\u636e\u5206\u6790\n   - \u86cb\u767d\u8d28\u76f8\u4e92\u4f5c\u7528\u7f51\u7edc\n   - \u7cfb\u7edf\u751f\u7269\u5b66\u5efa\u6a21</p>\n</li>\n<li>\n<p><strong>\u91d1\u878d\u5de5\u7a0b</strong>\uff1a\n   - \u5927\u89c4\u6a21\u76f8\u5173\u6027\u77e9\u9635\n   - \u98ce\u9669\u7ba1\u7406\u8ba1\u7b97\n   - \u671f\u6743\u5b9a\u4ef7\u52a0\u901f</p>\n</li>\n<li>\n<p><strong>\u793e\u4ea4\u7f51\u7edc\u5206\u6790</strong>\uff1a\n   - \u5927\u89c4\u6a21\u56fe\u7684\u8c31\u5206\u6790\n   - \u793e\u533a\u68c0\u6d4b\u7b97\u6cd5\n   - \u5f71\u54cd\u529b\u4f20\u64ad\u6a21\u578b</p>\n</li>\n</ol>\n<h2 id=\"124\">12.4 \u5728\u5377\u79ef\u7f51\u7edc\u4e2d\u7684\u5e94\u7528</h2>\n<h3 id=\"1241-as\">12.4.1 \u5377\u79efas\u77e9\u9635\u4e58\u6cd5\u7684\u7ed3\u6784</h3>\n<p>\u5377\u79ef\u64cd\u4f5c\u53ef\u4ee5\u5c55\u5f00\u4e3a\u77e9\u9635\u4e58\u6cd5\uff0c\u4f46\u4ea7\u751f\u7684\u77e9\u9635\u5177\u6709\u7279\u6b8a\u7ed3\u6784\uff1a</p>\n<p><strong>im2col\u53d8\u6362</strong>\uff1a\n\u5c06\u8f93\u5165\u7279\u5f81\u56fe\u5c55\u5f00\u4e3a\u77e9\u9635\uff0c\u4f7f\u5f97\u5377\u79ef\u53d8\u4e3a\u77e9\u9635\u4e58\u6cd5\uff1a</p>\n<ul>\n<li>\u8f93\u5165\uff1a$\\mathbb{R}^{C_{\\rm in} \\times H \\times W}$</li>\n<li>\u5377\u79ef\u6838\uff1a$\\mathbb{R}^{C_{\\rm out} \\times C_{\\rm in} \\times K \\times K}$</li>\n<li>\u5c55\u5f00\u77e9\u9635\uff1a\u5177\u6709\u5927\u91cf\u91cd\u590d\u5143\u7d20\u7684\u7ed3\u6784</li>\n</ul>\n<p><strong>\u7ed3\u6784\u7279\u6027</strong>\uff1a</p>\n<ol>\n<li><strong>\u5757Toeplitz\u7ed3\u6784</strong>\uff1a\u5bf9\u4e8e1D\u5377\u79ef</li>\n<li><strong>\u53cc\u91cd\u5757Toeplitz</strong>\uff1a\u5bf9\u4e8e2D\u5377\u79ef</li>\n<li><strong>\u7a00\u758f\u6027</strong>\uff1a\u96f6\u586b\u5145\u5bfc\u81f4\u7684\u7a00\u758f\u6a21\u5f0f</li>\n</ol>\n<h3 id=\"1242-fft\">12.4.2 FFT\u52a0\u901f\u7684\u6570\u5b66\u57fa\u7840</h3>\n<p><strong>\u5377\u79ef\u5b9a\u7406</strong>\uff1a\n\u65f6\u57df\u5377\u79ef\u7b49\u4ef7\u4e8e\u9891\u57df\u9010\u70b9\u4e58\u6cd5\uff1a\n$$\\mathbf{y} = \\mathbf{h} * \\mathbf{x} \\Leftrightarrow \\mathbf{Y} = \\mathbf{H} \\odot \\mathbf{X}$$\n<strong>2D\u5377\u79ef\u7684FFT\u52a0\u901f</strong>\uff1a</p>\n<ol>\n<li>\u5bf9\u8f93\u5165\u548c\u5377\u79ef\u6838\u8fdb\u884c2D FFT</li>\n<li>\u9891\u57df\u9010\u70b9\u76f8\u4e58</li>\n<li>\u9006FFT\u5f97\u5230\u7ed3\u679c</li>\n</ol>\n<p><strong>\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u76f4\u63a5\u5377\u79ef\uff1a$\\mathcal{O}(C_{\\rm out} \\cdot C_{\\rm in} \\cdot H \\cdot W \\cdot K^2)$</li>\n<li>FFT\u65b9\u6cd5\uff1a$\\mathcal{O}(C_{\\rm out} \\cdot C_{\\rm in} \\cdot H \\cdot W \\cdot \\log(HW))$</li>\n</ul>\n<p>\u5f53$K$\u8f83\u5927\u65f6\uff0cFFT\u65b9\u6cd5\u4f18\u52bf\u660e\u663e\u3002</p>\n<h3 id=\"1243-winograd\">12.4.3 Winograd\u53d8\u6362</h3>\n<p>Winograd\u7b97\u6cd5\u901a\u8fc7\u6570\u8bba\u6280\u5de7\u51cf\u5c11\u4e58\u6cd5\u6b21\u6570\uff1a</p>\n<p><strong>\u57fa\u672c\u601d\u60f3</strong>\uff1a\n\u5bf9\u4e8e$F(m,r)$\uff08\u8f93\u51fa\u5927\u5c0f$m$\uff0c\u5377\u79ef\u6838\u5927\u5c0f$r$\uff09\uff1a\n$$Y = A^T[(G g G^T) \\odot (B^T d B)]A$$\n\u5176\u4e2d$A, G, B$\u662f\u9884\u8ba1\u7b97\u7684\u53d8\u6362\u77e9\u9635\u3002</p>\n<p><strong>\u5178\u578b\u914d\u7f6e</strong>\uff1a</p>\n<ul>\n<li>$F(2,3)$\uff1a\u5c06$2 \\times 2$\u8f93\u51fa\u7684$3 \\times 3$\u5377\u79ef\u4ece9\u6b21\u4e58\u6cd5\u51cf\u5c11\u52304\u6b21</li>\n<li>$F(4,3)$\uff1a\u66f4\u5927\u7684tile size\uff0c\u66f4\u9ad8\u7684\u52a0\u901f\u6bd4</li>\n</ul>\n<p><strong>\u5b9e\u8df5\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u968ftile size\u589e\u5927\u800c\u4e0b\u964d</li>\n<li>\u9700\u8981\u989d\u5916\u7684\u53d8\u6362\u5f00\u9500</li>\n<li>\u5bf9\u4e8e\u5c0f\u5377\u79ef\u6838\u7279\u522b\u6709\u6548</li>\n</ol>\n<h3 id=\"1244\">12.4.4 \u7a00\u758f\u5377\u79ef\u7684\u4f18\u5316</h3>\n<p>\u5728\u8bb8\u591a\u5e94\u7528\u4e2d\uff08\u59823D\u70b9\u4e91\u5904\u7406\uff09\uff0c\u5377\u79ef\u5177\u6709\u9ad8\u5ea6\u7a00\u758f\u6027\uff1a</p>\n<p><strong>\u7a00\u758f\u6a21\u5f0f\u5229\u7528</strong>\uff1a</p>\n<ol>\n<li><strong>\u7ed3\u6784\u5316\u7a00\u758f</strong>\uff1a\u89c4\u5219\u7684\u7a00\u758f\u6a21\u5f0f\uff08\u5982\u68cb\u76d8\u683c\uff09</li>\n<li><strong>\u975e\u7ed3\u6784\u5316\u7a00\u758f</strong>\uff1a\u9700\u8981\u52a8\u6001\u7d22\u5f15</li>\n</ol>\n<p><strong>\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u54c8\u5e0c\u8868\u52a0\u901f</strong>\uff1a\n   - \u5feb\u901f\u5b9a\u4f4d\u975e\u96f6\u5143\u7d20\n   - \u9002\u7528\u4e8e\u6781\u5ea6\u7a00\u758f\u7684\u60c5\u51b5</p>\n</li>\n<li>\n<p><strong>\u5b50\u6d41\u5f62\u7a00\u758f\u5377\u79ef</strong>\uff1a\n   - \u4fdd\u6301\u7a00\u758f\u6027\u4e0d\u6269\u6563\n   - \u57283D\u89c6\u89c9\u4e2d\u5e7f\u6cdb\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u8ba1\u7b97\u56fe</strong>\uff1a\n   - \u6839\u636e\u8f93\u5165\u7a00\u758f\u6027\u52a8\u6001\u6784\u5efa\u8ba1\u7b97\u56fe\n   - \u907f\u514d\u5197\u4f59\u8ba1\u7b97</p>\n</li>\n</ol>\n<h3 id=\"1245\">12.4.5 \u7814\u7a76\u7ebf\u7d22\u4e0e\u5f00\u653e\u95ee\u9898</h3>\n<ol>\n<li>\n<p><strong>\u65b0\u578b\u5377\u79ef\u7ed3\u6784\u7684\u77e9\u9635\u5206\u6790</strong>\uff1a\n   - \u53ef\u5206\u79bb\u5377\u79ef\u7684\u6700\u4f18\u5206\u89e3\n   - \u6df1\u5ea6\u53ef\u5206\u79bb\u5377\u79ef\u7684\u7406\u8bba\u5206\u6790</p>\n</li>\n<li>\n<p><strong>\u786c\u4ef6\u534f\u540c\u8bbe\u8ba1</strong>\uff1a\n   - \u9488\u5bf9\u7279\u5b9a\u77e9\u9635\u7ed3\u6784\u7684\u4e13\u7528\u52a0\u901f\u5668\n   - \u5185\u5b58\u5c42\u6b21\u7684\u4f18\u5316\u5229\u7528</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u7b97\u6cd5\u9009\u62e9</strong>\uff1a\n   - \u6839\u636e\u8f93\u5165\u7279\u5f81\u52a8\u6001\u9009\u62e9\u6700\u4f18\u7b97\u6cd5\n   - \u673a\u5668\u5b66\u4e60\u6307\u5bfc\u7684\u8c03\u4f18</p>\n</li>\n<li>\n<p><strong>\u91cf\u5316\u4e0e\u7ed3\u6784\u7684\u4ea4\u4e92</strong>\uff1a\n   - \u4f4e\u6bd4\u7279\u91cf\u5316\u5bf9\u7ed3\u6784\u5316\u7b97\u6cd5\u7684\u5f71\u54cd\n   - \u8054\u5408\u4f18\u5316\u7b56\u7565</p>\n</li>\n</ol>\n<h3 id=\"1246\">12.4.6 \u6df1\u5ea6\u53ef\u5206\u79bb\u5377\u79ef\u7684\u77e9\u9635\u89c6\u89d2</h3>\n<p><strong>\u6df1\u5ea6\u53ef\u5206\u79bb\u5377\u79ef\u5206\u89e3</strong>\uff1a</p>\n<p>\u6807\u51c6\u5377\u79ef\u53ef\u5206\u89e3\u4e3a\uff1a</p>\n<ol>\n<li><strong>\u6df1\u5ea6\u5377\u79ef</strong>\uff08Depthwise\uff09\uff1a\u6bcf\u4e2a\u901a\u9053\u72ec\u7acb\u5377\u79ef</li>\n<li><strong>\u9010\u70b9\u5377\u79ef</strong>\uff08Pointwise\uff09\uff1a1\u00d71\u5377\u79ef\u6df7\u5408\u901a\u9053</li>\n</ol>\n<p>\u77e9\u9635\u8868\u793a\uff1a\n$$\\mathbf{Y} = \\mathbf{W}_{\\text{point}} \\cdot (\\mathbf{W}_{\\text{depth}} \\odot \\mathbf{X})$$\n\u5176\u4e2d$\\odot$\u8868\u793a\u901a\u9053\u72ec\u7acb\u7684\u5377\u79ef\u64cd\u4f5c\u3002</p>\n<p><strong>\u8ba1\u7b97\u6548\u7387\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6807\u51c6\u5377\u79ef\uff1a$\\mathcal{O}(C_{\\text{in}} \\cdot C_{\\text{out}} \\cdot K^2 \\cdot H \\cdot W)$</li>\n<li>\u6df1\u5ea6\u53ef\u5206\u79bb\uff1a$\\mathcal{O}(C_{\\text{in}} \\cdot K^2 \\cdot H \\cdot W + C_{\\text{in}} \\cdot C_{\\text{out}} \\cdot H \\cdot W)$</li>\n<li>\u52a0\u901f\u6bd4\uff1a\u7ea6$K^2$\u500d</li>\n</ul>\n<p><strong>\u77e9\u9635\u7ed3\u6784\u7279\u6027</strong>\uff1a</p>\n<ol>\n<li><strong>\u7a00\u758f\u5757\u5bf9\u89d2\u7ed3\u6784</strong>\uff1a\u6df1\u5ea6\u5377\u79ef\u5bf9\u5e94\u5757\u5bf9\u89d2\u77e9\u9635</li>\n<li><strong>\u4f4e\u79e9\u6027\u8d28</strong>\uff1a\u9010\u70b9\u5377\u79ef\u9650\u5236\u4e86\u8868\u8fbe\u80fd\u529b</li>\n<li><strong>\u6b63\u5219\u5316\u6548\u679c</strong>\uff1a\u9690\u5f0f\u7684\u7ed3\u6784\u5316\u6b63\u5219</li>\n</ol>\n<p><strong>\u53d8\u4f53\u4e0e\u63a8\u5e7f</strong>\uff1a</p>\n<ol>\n<li><strong>\u5206\u7ec4\u5377\u79ef</strong>\uff1a\u4ecb\u4e8e\u6807\u51c6\u548c\u6df1\u5ea6\u53ef\u5206\u79bb\u4e4b\u95f4</li>\n<li><strong>\u901a\u9053\u6d17\u724c</strong>\uff1a\u6253\u7834\u5206\u7ec4\u72ec\u7acb\u6027</li>\n<li><strong>\u53ef\u5b66\u4e60\u7684\u5206\u89e3\u7ed3\u6784</strong>\uff1a\u81ea\u52a8\u53d1\u73b0\u6700\u4f18\u5206\u89e3</li>\n</ol>\n<h3 id=\"1247\">12.4.7 \u52a8\u6001\u7a00\u758f\u5377\u79ef</h3>\n<p><strong>\u6761\u4ef6\u8ba1\u7b97\u539f\u7406</strong>\uff1a</p>\n<p>\u6839\u636e\u8f93\u5165\u52a8\u6001\u51b3\u5b9a\u8ba1\u7b97\u6a21\u5f0f\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>if (activation_magnitude &lt; threshold):\n    skip computation\nelse:\n    perform convolution\n</code></pre></div>\n\n<p><strong>\u7a00\u758f\u6a21\u5f0f\u7684\u5229\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9759\u6001\u7a00\u758f\u6027</strong>\uff1a\n   - \u6743\u91cd\u526a\u679d\u4ea7\u751f\u7684\u56fa\u5b9a\u6a21\u5f0f\n   - \u7f16\u8bd1\u65f6\u4f18\u5316\n   - \u786c\u4ef6\u53cb\u597d\u7684\u89c4\u5219\u6a21\u5f0f</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u7a00\u758f\u6027</strong>\uff1a\n   - \u6fc0\u6d3b\u7684\u7a00\u758f\u6027\n   - \u8fd0\u884c\u65f6\u51b3\u7b56\n   - \u81ea\u9002\u5e94\u8ba1\u7b97\u56fe</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u73b0\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7a00\u758f\u6570\u636e\u7ed3\u6784</strong>\uff1a\n   - CSR/CSC\u683c\u5f0f\u7684\u53d8\u4f53\n   - \u54c8\u5e0c\u8868\u52a0\u901f\n   - \u4f4d\u56fe\u7d22\u5f15</p>\n</li>\n<li>\n<p><strong>\u6838\u878d\u5408\u4f18\u5316</strong>\uff1a\n   ```\n   \u878d\u5408\u64cd\u4f5c\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u7a00\u758f\u5377\u79ef + ReLU + \u6c60\u5316</li>\n<li>\u51cf\u5c11\u5185\u5b58\u8bbf\u95ee</li>\n<li>\u63d0\u9ad8\u7f13\u5b58\u5229\u7528\u7387\n   ```</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\n   - \u52a8\u6001\u4efb\u52a1\u5206\u914d\n   - \u5de5\u4f5c\u7a83\u53d6\u961f\u5217\n   - GPU warp\u7ea7\u8c03\u5ea6</li>\n</ol>\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6709\u6548\u611f\u53d7\u91ce</strong>\uff1a\n   \u7a00\u758f\u6027\u5982\u4f55\u5f71\u54cd\u611f\u53d7\u91ce\u7684\u589e\u957f</p>\n</li>\n<li>\n<p><strong>\u68af\u5ea6\u6d41\u52a8</strong>\uff1a\n   \u7a00\u758f\u8def\u5f84\u5bf9\u68af\u5ea6\u4f20\u64ad\u7684\u5f71\u54cd</p>\n</li>\n<li>\n<p><strong>\u8868\u8fbe\u80fd\u529b</strong>\uff1a\n   \u7a00\u758f\u7f51\u7edc\u7684\u4e07\u80fd\u903c\u8fd1\u6027\u8d28</p>\n</li>\n</ol>\n<h3 id=\"1248\">12.4.8 \u9891\u57df\u5377\u79ef\u7f51\u7edc</h3>\n<p><strong>\u5085\u91cc\u53f6\u5377\u79ef\u5c42</strong>\uff1a</p>\n<p>\u5728\u9891\u57df\u6267\u884c\u5377\u79ef\uff1a\n$$\\mathcal{F}(y) = \\mathcal{F}(h) \\cdot \\mathcal{F}(x)$$\n\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u5927\u5377\u79ef\u6838\u7684\u6548\u7387</li>\n<li>\u5168\u5c40\u611f\u53d7\u91ce</li>\n<li>\u5468\u671f\u6027\u6a21\u5f0f\u5b66\u4e60</li>\n</ul>\n<p><strong>\u8c31\u53c2\u6570\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u76f4\u63a5\u53c2\u6570\u5316</strong>\uff1a\n   \u5b66\u4e60\u9891\u57df\u7cfb\u6570\n$$\\mathbf{W}_{\\text{freq}} = {\\hat{w}_{i,j}}$$</p>\n</li>\n<li>\n<p><strong>\u7ea6\u675f\u53c2\u6570\u5316</strong>\uff1a\n   - \u4fdd\u8bc1\u5b9e\u503c\u8f93\u51fa\n   - \u5171\u8f6d\u5bf9\u79f0\u7ea6\u675f\n   - \u5e26\u9650\u7ea6\u675f</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u73b0\u8003\u8651</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6570\u503c\u7cbe\u5ea6</strong>\uff1a\n   - FFT\u7684\u820d\u5165\u8bef\u5dee\n   - \u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\n   - \u8bef\u5dee\u8865\u507f\u6280\u672f</p>\n</li>\n<li>\n<p><strong>\u8fb9\u754c\u5904\u7406</strong>\uff1a\n   - \u5468\u671f\u586b\u5145vs\u96f6\u586b\u5145\n   - \u7a97\u51fd\u6570\u7684\u4f7f\u7528\n   - \u8fb9\u754c\u4f2a\u5f71\u6291\u5236</p>\n</li>\n<li>\n<p><strong>\u6279\u5904\u7406\u4f18\u5316</strong>\uff1a\n   - \u6279\u91cfFFT\u8ba1\u5212\n   - \u5185\u5b58\u5e03\u5c40\u4f18\u5316\n   - GPU\u7279\u5b9a\u4f18\u5316</p>\n</li>\n</ol>\n<p><strong>\u4e0e\u7a7a\u57df\u5377\u79ef\u7684\u6bd4\u8f83</strong>\uff1a</p>\n<p>| \u65b9\u9762 | \u7a7a\u57df\u5377\u79ef | \u9891\u57df\u5377\u79ef |</p>\n<table>\n<thead>\n<tr>\n<th>\u65b9\u9762</th>\n<th>\u7a7a\u57df\u5377\u79ef</th>\n<th>\u9891\u57df\u5377\u79ef</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\u5c0f\u5377\u79ef\u6838</td>\n<td>\u9ad8\u6548</td>\n<td>\u5f00\u9500\u5927</td>\n</tr>\n<tr>\n<td>\u5927\u5377\u79ef\u6838</td>\n<td>\u4f4e\u6548</td>\n<td>\u9ad8\u6548</td>\n</tr>\n<tr>\n<td>\u7a00\u758f\u6027\u5229\u7528</td>\n<td>\u5bb9\u6613</td>\n<td>\u56f0\u96be</td>\n</tr>\n<tr>\n<td>\u786c\u4ef6\u652f\u6301</td>\n<td>\u5e7f\u6cdb</td>\n<td>\u6709\u9650</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"1249\">12.4.9 \u53ef\u53d8\u5f62\u5377\u79ef\u7684\u77e9\u9635\u8868\u793a</h3>\n<p><strong>\u53ef\u53d8\u5f62\u5377\u79ef\u539f\u7406</strong>\uff1a</p>\n<p>\u6807\u51c6\u5377\u79ef\u7684\u91c7\u6837\u4f4d\u7f6e\u56fa\u5b9a\uff0c\u53ef\u53d8\u5f62\u5377\u79ef\u5b66\u4e60\u504f\u79fb\uff1a\n$$y(p) = \\sum_{k=1}^K w_k \\cdot x(p + p_k + \\Delta p_k)$$\n\u5176\u4e2d$\\Delta p_k$\u662f\u5b66\u4e60\u7684\u504f\u79fb\u91cf\u3002</p>\n<p><strong>\u77e9\u9635\u8868\u793a\u7684\u6311\u6218</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u975e\u89c4\u5219\u91c7\u6837</strong>\uff1a\n   - \u65e0\u6cd5\u7528\u7b80\u5355\u7684Toeplitz\u7ed3\u6784\n   - \u9700\u8981\u63d2\u503c\u5904\u7406\n   - \u52a8\u6001\u7d22\u5f15\u8ba1\u7b97</p>\n</li>\n<li>\n<p><strong>\u53cc\u7ebf\u6027\u63d2\u503c</strong>\uff1a\n$$x(p + \\Delta p) = \\sum_{q} G(q, p + \\Delta p) \\cdot x(q)$$</p>\n</li>\n</ol>\n<p>\u5176\u4e2d$G$\u662f\u63d2\u503c\u6838</p>\n<p><strong>\u9ad8\u6548\u5b9e\u73b0\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91c7\u6837\u70b9\u805a\u7c7b</strong>\uff1a\n   - \u76f8\u4f3c\u504f\u79fb\u5206\u7ec4\n   - \u6279\u91cf\u5904\u7406\n   - \u7f13\u5b58\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u77e9\u9635\u8868\u793a</strong>\uff1a\n   - \u52a8\u6001\u6784\u5efa\u7a00\u758f\u77e9\u9635\n   - \u91cd\u7528\u8ba1\u7b97\u6a21\u5f0f\n   - \u589e\u91cf\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u786c\u4ef6\u52a0\u901f</strong>\uff1a\n   - \u7eb9\u7406\u5185\u5b58\u5229\u7528\uff08GPU\uff09\n   - \u4e13\u7528\u91c7\u6837\u5355\u5143\n   - SIMD\u5411\u91cf\u5316</p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u6027\u8d28</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u611f\u53d7\u91ce\u81ea\u9002\u5e94</strong>\uff1a\n   \u6839\u636e\u5185\u5bb9\u8c03\u6574\u611f\u53d7\u91ce\u5f62\u72b6</p>\n</li>\n<li>\n<p><strong>\u51e0\u4f55\u53d8\u6362\u5b66\u4e60</strong>\uff1a\n   \u9690\u5f0f\u5b66\u4e60\u7269\u4f53\u7684\u51e0\u4f55\u53d8\u6362</p>\n</li>\n<li>\n<p><strong>\u4e0e\u6ce8\u610f\u529b\u673a\u5236\u7684\u8054\u7cfb</strong>\uff1a\n   \u53ef\u89c6\u4e3a\u7a7a\u95f4\u6ce8\u610f\u529b\u7684\u7279\u4f8b</p>\n</li>\n</ol>\n<h3 id=\"12410\">12.4.10 \u672a\u6765\u8d8b\u52bf\u4e0e\u7814\u7a76\u65b9\u5411</h3>\n<p><strong>\u795e\u7ecf\u67b6\u6784\u641c\u7d22\uff08NAS\uff09\u4e2d\u7684\u7ed3\u6784\u5316\u8bbe\u8ba1</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u641c\u7d22\u7a7a\u95f4\u8bbe\u8ba1</strong>\uff1a\n   - \u5305\u542b\u7ed3\u6784\u5316\u64cd\u4f5c\n   - \u6548\u7387-\u7cbe\u5ea6\u6743\u8861\n   - \u786c\u4ef6\u611f\u77e5\u641c\u7d22</p>\n</li>\n<li>\n<p><strong>\u53ef\u5fae\u5206\u7ed3\u6784\u9009\u62e9</strong>\uff1a\n   - \u8fde\u7eed\u677e\u5f1b\n   - \u68af\u5ea6\u4f30\u8ba1\n   - \u591a\u76ee\u6807\u4f18\u5316</p>\n</li>\n</ol>\n<p><strong>\u91cf\u5b50\u5377\u79ef\u7f51\u7edc</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u91cf\u5b50\u5377\u79ef\u5b9a\u4e49</strong>\uff1a\n   \u5229\u7528\u91cf\u5b50\u53e0\u52a0\u548c\u7ea0\u7f20</p>\n</li>\n<li>\n<p><strong>\u7ecf\u5178\u6a21\u62df</strong>\uff1a\n   - \u5f20\u91cf\u7f51\u7edc\u8868\u793a\n   - \u6709\u6548\u7ef4\u5ea6\u7ea6\u51cf\n   - \u6df7\u5408\u91cf\u5b50-\u7ecf\u5178\u67b6\u6784</p>\n</li>\n</ol>\n<p><strong>\u751f\u7269\u542f\u53d1\u7684\u7a00\u758f\u5377\u79ef</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8109\u51b2\u795e\u7ecf\u7f51\u7edc</strong>\uff1a\n   - \u4e8b\u4ef6\u9a71\u52a8\u8ba1\u7b97\n   - \u65f6\u7a7a\u7a00\u758f\u6027\n   - \u80fd\u6548\u4f18\u52bf</p>\n</li>\n<li>\n<p><strong>\u76ae\u5c42\u5fae\u67f1\u7ed3\u6784</strong>\uff1a\n   - \u5c42\u6b21\u5316\u7a00\u758f\u8fde\u63a5\n   - \u5c40\u90e8\u7ade\u4e89\u673a\u5236\n   - \u81ea\u7ec4\u7ec7\u7279\u6027</p>\n</li>\n</ol>\n<p><strong>\u7f16\u8bd1\u5668\u4e0e\u786c\u4ef6\u534f\u540c\u8bbe\u8ba1</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u56fe\u4f18\u5316\u6280\u672f</strong>\uff1a\n   - \u7b97\u5b50\u878d\u5408\n   - \u5185\u5b58\u89c4\u5212\n   - \u5e76\u884c\u6a21\u5f0f\u8bc6\u522b</p>\n</li>\n<li>\n<p><strong>\u4e13\u7528\u52a0\u901f\u5668</strong>\uff1a\n   - \u7ed3\u6784\u5316\u7a00\u758f\u652f\u6301\n   - \u53ef\u91cd\u6784\u6570\u636e\u901a\u8def\n   - \u8fd1\u6570\u636e\u8ba1\u7b97</p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u57fa\u7840\u7814\u7a76</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8868\u8fbe\u80fd\u529b\u5206\u6790</strong>\uff1a\n   \u4e0d\u540c\u7ed3\u6784\u7684\u903c\u8fd1\u80fd\u529b</p>\n</li>\n<li>\n<p><strong>\u4f18\u5316\u666f\u89c2</strong>\uff1a\n   \u7ed3\u6784\u5316\u7ea6\u675f\u5bf9\u4f18\u5316\u7684\u5f71\u54cd</p>\n</li>\n<li>\n<p><strong>\u6cdb\u5316\u7406\u8bba</strong>\uff1a\n   \u7ed3\u6784\u5316\u5f52\u7eb3\u504f\u7f6e\u7684\u4f5c\u7528</p>\n</li>\n</ol>\n<p><strong>\u8de8\u9886\u57df\u5e94\u7528</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u79d1\u5b66\u8ba1\u7b97</strong>\uff1a\n   - PDE\u6c42\u89e3\u5668\u5b66\u4e60\n   - \u591a\u5c3a\u5ea6\u5efa\u6a21\n   - \u7269\u7406\u7ea6\u675f\u96c6\u6210</p>\n</li>\n<li>\n<p><strong>\u4fe1\u53f7\u5904\u7406</strong>\uff1a\n   - \u81ea\u9002\u5e94\u6ee4\u6ce2\u5668\n   - \u538b\u7f29\u611f\u77e5\n   - \u8d85\u5206\u8fa8\u7387\u91cd\u5efa</p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97\u673a\u56fe\u5f62\u5b66</strong>\uff1a\n   - \u795e\u7ecf\u6e32\u67d3\n   - \u51e0\u4f55\u5904\u7406\n   - \u6750\u8d28\u5408\u6210</p>\n</li>\n</ol>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u7ed3\u6784\u5316\u77e9\u9635\u7684\u5feb\u901f\u7b97\u6cd5\uff0c\u6db5\u76d6\u4e86\u56db\u4e2a\u6838\u5fc3\u4e3b\u9898\uff1a</p>\n<ol>\n<li>\n<p><strong>Toeplitz\u4e0e\u5faa\u73af\u77e9\u9635</strong>\uff1a\u5229\u7528FFT\u5c06$\\mathcal{O}(n^2)$\u7684\u77e9\u9635\u8fd0\u7b97\u964d\u81f3$\\mathcal{O}(n\\log n)$\uff0c\u5173\u952e\u5728\u4e8e\u5faa\u73af\u77e9\u9635\u7684\u5bf9\u89d2\u5316\u6027\u8d28\u548cToeplitz\u77e9\u9635\u7684\u5faa\u73af\u5d4c\u5165\u6280\u5de7\u3002</p>\n</li>\n<li>\n<p><strong>Kronecker\u79ef\u8fd0\u7b97</strong>\uff1a\u901a\u8fc7vec-trick\u548c\u6df7\u5408\u79ef\u89c4\u5219\u907f\u514d\u663e\u5f0f\u5f62\u6210\u5927\u77e9\u9635\uff0c\u5728\u6c42\u89e3\u77e9\u9635\u65b9\u7a0b\u548c\u5f20\u91cf\u8ba1\u7b97\u4e2d\u53d1\u6325\u91cd\u8981\u4f5c\u7528\u3002</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u77e9\u9635\uff08H-matrices\uff09</strong>\uff1a\u901a\u8fc7\u9012\u5f52\u5206\u5757\u548c\u4f4e\u79e9\u8fd1\u4f3c\u5b9e\u73b0\u8fd1\u7ebf\u6027\u590d\u6742\u5ea6\uff0c\u9002\u7528\u4e8e\u5177\u6709\u5feb\u901f\u8870\u51cf\u6838\u7684\u79ef\u5206\u65b9\u7a0b\u3002</p>\n</li>\n<li>\n<p><strong>\u5377\u79ef\u7f51\u7edc\u5e94\u7528</strong>\uff1a\u5c06\u5377\u79ef\u89c6\u4e3a\u7ed3\u6784\u5316\u77e9\u9635\u4e58\u6cd5\uff0c\u901a\u8fc7FFT\u3001Winograd\u53d8\u6362\u548c\u7a00\u758f\u6027\u5229\u7528\u5b9e\u73b0\u52a0\u901f\u3002</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u6570\u5b66\u5de5\u5177</strong>\uff1a</p>\n<ul>\n<li>\u79bb\u6563Fourier\u53d8\u6362\uff08DFT\uff09\u53ca\u5176\u5feb\u901f\u7b97\u6cd5</li>\n<li>\u4f4e\u79e9\u77e9\u9635\u5206\u89e3\uff08SVD\u3001ACA\uff09</li>\n<li>\u9012\u5f52\u5206\u5757\u7b56\u7565</li>\n<li>\u6570\u8bba\u5728\u7b97\u6cd5\u4f18\u5316\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<p><strong>\u590d\u6742\u5ea6\u6539\u8fdb\u603b\u7ed3</strong>\uff1a\n| \u7ed3\u6784\u7c7b\u578b | \u6807\u51c6\u590d\u6742\u5ea6 | \u4f18\u5316\u590d\u6742\u5ea6 |</p>\n<table>\n<thead>\n<tr>\n<th>\u7ed3\u6784\u7c7b\u578b</th>\n<th>\u6807\u51c6\u590d\u6742\u5ea6</th>\n<th>\u4f18\u5316\u590d\u6742\u5ea6</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Toeplitz\u77e9\u9635\u4e58\u6cd5</td>\n<td>$\\mathcal{O}(n^2)$</td>\n<td>$\\mathcal{O}(n\\log n)$</td>\n</tr>\n<tr>\n<td>Kronecker\u79ef\u8fd0\u7b97</td>\n<td>$\\mathcal{O}(n^4)$</td>\n<td>$\\mathcal{O}(n^2)$</td>\n</tr>\n<tr>\n<td>H-matrix LU\u5206\u89e3</td>\n<td>$\\mathcal{O}(n^3)$</td>\n<td>$\\mathcal{O}(n\\log^2 n)$</td>\n</tr>\n<tr>\n<td>\u5927\u6838\u5377\u79ef</td>\n<td>$\\mathcal{O}(K^2HW)$</td>\n<td>$\\mathcal{O}(HW\\log(HW))$</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u989812.1</strong> \u8bc1\u660e\u4efb\u4f55\u5faa\u73af\u77e9\u9635\u90fd\u53ef\u4ee5\u88abDFT\u77e9\u9635\u5bf9\u89d2\u5316\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u5faa\u73af\u77e9\u9635\u7684\u751f\u6210\u591a\u9879\u5f0f\u548cDFT\u7684\u5b9a\u4e49\uff0c\u5229\u7528\u5355\u4f4d\u6839\u7684\u6027\u8d28\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe\u5faa\u73af\u77e9\u9635$\\mathbf{C}$\u7684\u7b2c\u4e00\u884c\u4e3a$(c_0, c_1, ..., c_{n-1})$\uff0cDFT\u77e9\u9635$\\mathbf{F}$\u7684$(j,k)$\u5143\u7d20\u4e3a$\\omega^{jk}/\\sqrt{n}$\uff0c\u5176\u4e2d$\\omega = e^{-2\\pi i/n}$\u3002\u9a8c\u8bc1$\\mathbf{C}$\u7684\u7279\u5f81\u5411\u91cf\u6070\u597d\u662f$\\mathbf{F}$\u7684\u5217\uff0c\u5bf9\u5e94\u7279\u5f81\u503c\u4e3a$\\sum_{k=0}^{n-1} c_k \\omega^{jk}$\u3002</p>\n</details>\n<p><strong>\u4e60\u989812.2</strong> \u7ed9\u5b9a\u4e24\u4e2a$n \\times n$\u77e9\u9635$\\mathbf{A}, \\mathbf{B}$\uff0c\u63a8\u5bfc\u4f7f\u7528vec-trick\u6c42\u89e3Sylvester\u65b9\u7a0b$\\mathbf{A}\\mathbf{X} + \\mathbf{X}\\mathbf{B} = \\mathbf{C}$\u7684\u5177\u4f53\u6b65\u9aa4\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5e94\u7528vec\u64cd\u4f5c\u548cKronecker\u79ef\u7684\u6027\u8d28\uff0c\u5c06\u77e9\u9635\u65b9\u7a0b\u8f6c\u5316\u4e3a\u7ebf\u6027\u7cfb\u7edf\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5e94\u7528vec\u64cd\u4f5c\uff1a$\\text{vec}(\\mathbf{A}\\mathbf{X}) + \\text{vec}(\\mathbf{X}\\mathbf{B}) = \\text{vec}(\\mathbf{C})$\u3002\u5229\u7528\u6052\u7b49\u5f0f\u5f97\u5230\uff1a$(\\mathbf{I} \\otimes \\mathbf{A})\\text{vec}(\\mathbf{X}) + (\\mathbf{B}^T \\otimes \\mathbf{I})\\text{vec}(\\mathbf{X}) = \\text{vec}(\\mathbf{C})$\uff0c\u5373$(\\mathbf{I} \\otimes \\mathbf{A} + \\mathbf{B}^T \\otimes \\mathbf{I})\\text{vec}(\\mathbf{X}) = \\text{vec}(\\mathbf{C})$\u3002</p>\n</details>\n<p><strong>\u4e60\u989812.3</strong> \u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\uff0c\u8ba1\u7b97\u5e26\u72b6Toeplitz\u77e9\u9635\uff08\u5e26\u5bbd\u4e3a$b$\uff09\u4e0e\u5411\u91cf\u7684\u4e58\u79ef\uff0c\u5206\u6790\u5176\u590d\u6742\u5ea6\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5229\u7528\u5e26\u72b6\u7ed3\u6784\uff0c\u53ea\u9700\u5b58\u50a8$2b+1$\u4e2a\u4e0d\u540c\u5143\u7d20\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\uff1a\u5bf9\u6bcf\u4e2a\u8f93\u51fa\u5143\u7d20$y_i$\uff0c\u53ea\u9700\u8ba1\u7b97$y_i = \\sum_{j=\\max(0,i-b)}^{\\min(n-1,i+b)} T_{ij}x_j$\u3002\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal{O}(nb)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6$\\mathcal{O}(b)$\u3002</p>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u989812.4</strong> \u5bf9\u4e8e\u5206\u5757Toeplitz\u77e9\u9635\uff08\u6bcf\u4e2a\u5757\u672c\u8eab\u4e5f\u662fToeplitz\uff09\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u4e24\u7ea7FFT\u7b97\u6cd5\u5e76\u5206\u6790\u5176\u590d\u6742\u5ea6\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u5148\u5bf9\u5757\u7ea7\u522b\u5e94\u7528FFT\uff0c\u518d\u5bf9\u6bcf\u4e2a\u5757\u5185\u90e8\u5e94\u7528FFT\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe\u77e9\u9635\u5927\u5c0f$N = nm$\uff0c\u5206\u4e3a$n \\times n$\u4e2a$m \\times m$\u7684Toeplitz\u5757\u3002\u7b97\u6cd5\uff1a(1)\u5bf9\u6bcf\u4e2a\u5757\u8fdb\u884cFFT\u9884\u5904\u7406\uff0c\u590d\u6742\u5ea6$\\mathcal{O}(n^2 m\\log m)$\uff1b(2)\u5757\u7ea7\u522b\u7684FFT\u8fd0\u7b97\uff0c\u590d\u6742\u5ea6$\\mathcal{O}(m n^2\\log n)$\u3002\u603b\u590d\u6742\u5ea6$\\mathcal{O}(N^{3/2}\\log N)$\uff0c\u4f18\u4e8e\u76f4\u63a5\u65b9\u6cd5\u7684$\\mathcal{O}(N^2)$\u3002</p>\n</details>\n<p><strong>\u4e60\u989812.5</strong> \u63a8\u5bfcH-matrix\u683c\u5f0f\u4e0b\u77e9\u9635\u4e58\u6cd5$\\mathbf{C} = \\mathbf{A}\\mathbf{B}$\u7684\u9012\u5f52\u7b97\u6cd5\uff0c\u5e76\u5206\u6790\u79e9\u589e\u957f\u95ee\u9898\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u4e0d\u540c\u7c7b\u578b\u5757\uff08\u4f4e\u79e9\u3001\u6ee1\u79e9\uff09\u76f8\u4e58\u7684\u60c5\u51b5\uff0c\u4ee5\u53ca\u5982\u4f55\u63a7\u5236\u7ed3\u679c\u7684\u79e9\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u9012\u5f52\u516c\u5f0f\uff1a$\\mathbf{C}_{ij} = \\sum_k \\mathbf{A}_{ik}\\mathbf{B}_{kj}$\u3002\u5f53$\\mathbf{A}_{ik} = \\mathbf{U}_{ik}\\mathbf{V}_{ik}^T$\uff0c$\\mathbf{B}_{kj} = \\mathbf{X}_{kj}\\mathbf{Y}_{kj}^T$\u65f6\uff0c\u4e58\u79ef\u7684\u79e9\u6700\u591a\u4e3a$r_{ik} + r_{kj}$\u3002\u9700\u8981\u901a\u8fc7SVD\u622a\u65ad\u63a7\u5236\u79e9\u589e\u957f\uff0c\u5f15\u5165\u53ef\u63a7\u7684\u8fd1\u4f3c\u8bef\u5dee\u3002</p>\n</details>\n<p><strong>\u4e60\u989812.6</strong> \u5206\u6790Winograd\u5377\u79ef\u7b97\u6cd5$F(4,3)$\u7684\u6570\u503c\u7a33\u5b9a\u6027\uff0c\u89e3\u91ca\u4e3a\u4ec0\u4e48\u5b9e\u8df5\u4e2d\u5f88\u5c11\u4f7f\u7528\u66f4\u5927\u7684tile size\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8ba1\u7b97\u53d8\u6362\u77e9\u9635\u7684\u6761\u4ef6\u6570\uff0c\u5206\u6790\u8bef\u5dee\u653e\u5927\u56e0\u5b50\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>$F(4,3)$\u7684\u53d8\u6362\u77e9\u9635\u6761\u4ef6\u6570\u7ea6\u4e3a10\u00b3\uff0c\u610f\u5473\u7740\u8f93\u5165\u8bef\u5dee\u53ef\u80fd\u88ab\u653e\u59271000\u500d\u3002\u5bf9\u4e8e$F(6,3)$\uff0c\u6761\u4ef6\u6570\u8d85\u8fc710\u2076\u3002\u5728\u4f4e\u7cbe\u5ea6\uff08\u5982FP16\uff09\u8ba1\u7b97\u4e2d\uff0c\u8fd9\u79cd\u8bef\u5dee\u653e\u5927\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\u5b9e\u8df5\u4e2d\u901a\u5e38\u4f7f\u7528$F(2,3)$\u6216$F(4,3)$\u7684\u6298\u4e2d\u65b9\u6848\u3002</p>\n</details>\n<p><strong>\u4e60\u989812.7</strong>\uff08\u5f00\u653e\u6027\u95ee\u9898\uff09\u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94\u7b97\u6cd5\uff0c\u6839\u636e\u8f93\u5165\u77e9\u9635\u7684\u7ed3\u6784\u81ea\u52a8\u9009\u62e9\u6700\u4f18\u7684\u8ba1\u7b97\u7b56\u7565\uff08\u76f4\u63a5\u8ba1\u7b97\u3001FFT\u3001H-matrix\u7b49\uff09\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u8003\u8651\u7ed3\u6784\u68c0\u6d4b\u7684\u5f00\u9500\u3001\u4e0d\u540c\u7b97\u6cd5\u7684break-even point\u3001\u786c\u4ef6\u7279\u6027\u7b49\u56e0\u7d20\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5173\u952e\u8bbe\u8ba1\u8981\u7d20\uff1a(1)\u5feb\u901f\u7ed3\u6784\u68c0\u6d4b\uff1a\u91c7\u6837\u6d4b\u8bd5Toeplitz\u6027\u3001\u4f4e\u79e9\u6027\u7b49\uff1b(2)\u6027\u80fd\u6a21\u578b\uff1a\u57fa\u4e8e\u77e9\u9635\u5927\u5c0f\u3001\u7a00\u758f\u5ea6\u3001\u786c\u4ef6\u53c2\u6570\u9884\u6d4b\u4e0d\u540c\u7b97\u6cd5\u7684\u8fd0\u884c\u65f6\u95f4\uff1b(3)\u5728\u7ebf\u5b66\u4e60\uff1a\u6536\u96c6\u5386\u53f2\u6570\u636e\u6539\u8fdb\u9884\u6d4b\u6a21\u578b\uff1b(4)\u5206\u5c42\u51b3\u7b56\uff1a\u5148\u505a\u7c97\u7c92\u5ea6\u5206\u7c7b\uff0c\u518d\u7ec6\u5316\u9009\u62e9\u3002\u5b9e\u73b0\u65f6\u9700\u5e73\u8861\u68c0\u6d4b\u5f00\u9500\u4e0e\u6027\u80fd\u63d0\u5347\u3002</p>\n</details>\n<p><strong>\u4e60\u989812.8</strong> \u63a2\u8ba8\u5982\u4f55\u5c06H-matrix\u6280\u672f\u5e94\u7528\u4e8eTransformer\u4e2d\u7684\u6ce8\u610f\u529b\u77e9\u9635\u8ba1\u7b97\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u539f\u578b\u7b97\u6cd5\u3002</p>\n<details>\n<summary>\u63d0\u793a</summary>\n<p>\u6ce8\u610f\u529b\u77e9\u9635\u901a\u5e38\u5177\u6709\u5c40\u90e8\u6027\u548c\u4f4e\u79e9\u7ed3\u6784\uff0c\u9002\u5408H-matrix\u8868\u793a\u3002</p>\n</details>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7b97\u6cd5\u6846\u67b6\uff1a(1)\u5c06\u5e8f\u5217\u4f4d\u7f6e\u6620\u5c04\u5230\u51e0\u4f55\u7a7a\u95f4\uff0c\u5b9a\u4e49\u8ddd\u79bb\u5ea6\u91cf\uff1b(2)\u57fa\u4e8e\u6ce8\u610f\u529b\u6a21\u5f0f\u7684\u5c40\u90e8\u6027\u6784\u5efaH-matrix\u5206\u5757\u7ed3\u6784\uff1b(3)\u4f7f\u7528\u5b66\u4e60\u7684\u79e9\u53c2\u6570\u8fdb\u884c\u81ea\u9002\u5e94\u538b\u7f29\uff1b(4)\u5728\u53cd\u5411\u4f20\u64ad\u4e2d\u7ef4\u62a4H-matrix\u683c\u5f0f\u3002\u5173\u952e\u6311\u6218\uff1a\u52a8\u6001\u79e9\u9009\u62e9\u3001\u4e0e\u73b0\u6709\u4f18\u5316\u5668\u7684\u517c\u5bb9\u6027\u3001\u8bad\u7ec3\u7a33\u5b9a\u6027\u3002\u8fd9\u662f\u6d3b\u8dc3\u7684\u7814\u7a76\u65b9\u5411\u3002</p>\n</details>\n<h2 id=\"_5\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</h2>\n<h3 id=\"1-fft\">1. FFT\u8fb9\u754c\u5904\u7406\u9519\u8bef</h3>\n<p><strong>\u9677\u9631</strong>\uff1a\u76f4\u63a5\u5bf9\u975e\u5468\u671f\u4fe1\u53f7\u4f7f\u7528FFT\u5377\u79ef\u4f1a\u4ea7\u751f\u5faa\u73af\u5377\u79ef\u800c\u975e\u7ebf\u6027\u5377\u79ef\u3002\n<strong>\u6b63\u786e\u505a\u6cd5</strong>\uff1a\u4f7f\u7528\u8db3\u591f\u7684\u96f6\u586b\u5145\uff08padding\uff09\uff0c\u786e\u4fdd\u7ed3\u679c\u957f\u5ea6\u81f3\u5c11\u4e3a$n + m - 1$\u3002</p>\n<h3 id=\"2-toeplitz\">2. Toeplitz\u6c42\u9006\u7684\u6570\u503c\u4e0d\u7a33\u5b9a</h3>\n<p><strong>\u9677\u9631</strong>\uff1aLevinson\u7b97\u6cd5\u867d\u7136\u5feb\u901f\uff0c\u4f46\u5bf9\u4e8e\u63a5\u8fd1\u5947\u5f02\u7684\u77e9\u9635\u53ef\u80fd\u4e25\u91cd\u4e0d\u7a33\u5b9a\u3002\n<strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u68c0\u67e5\u77e9\u9635\u6761\u4ef6\u6570</li>\n<li>\u4f7f\u7528\u7a33\u5b9a\u7684\u8fed\u4ee3\u65b9\u6cd5\u914d\u5408\u826f\u597d\u7684\u9884\u6761\u4ef6\u5b50</li>\n<li>\u8003\u8651\u6b63\u5219\u5316\u6280\u672f</li>\n</ul>\n<h3 id=\"3-kronecker\">3. Kronecker\u79ef\u7684\u5185\u5b58\u7206\u70b8</h3>\n<p><strong>\u9677\u9631</strong>\uff1a\u663e\u5f0f\u8ba1\u7b97$\\mathbf{A} \\otimes \\mathbf{B}$\u4f1a\u4ea7\u751f\u5de8\u5927\u77e9\u9635\u3002</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u9519\u8bef\uff1aA\u662f100\u00d7100\uff0cB\u662f100\u00d7100</span>\n<span class=\"n\">C</span> <span class=\"o\">=</span> <span class=\"n\">kron</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span> <span class=\"n\">B</span><span class=\"p\">)</span>  <span class=\"c1\"># \u4ea7\u751f10000\u00d710000\u77e9\u9635\uff01</span>\n</code></pre></div>\n\n<p><strong>\u6b63\u786e\u505a\u6cd5</strong>\uff1a\u5229\u7528\u6052\u7b49\u5f0f\u907f\u514d\u663e\u5f0f\u5f62\u6210\uff0c\u5982$(\\mathbf{A} \\otimes \\mathbf{B})\\text{vec}(\\mathbf{X}) = \\text{vec}(\\mathbf{B}\\mathbf{X}\\mathbf{A}^T)$\u3002</p>\n<h3 id=\"4-h-matrix\">4. H-matrix\u7684\u8fc7\u5ea6\u538b\u7f29</h3>\n<p><strong>\u9677\u9631</strong>\uff1a\u76f2\u76ee\u8ffd\u6c42\u4f4e\u79e9\u4f1a\u5bfc\u81f4\u7cbe\u5ea6\u4e25\u91cd\u635f\u5931\u3002\n<strong>\u5e73\u8861\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u81ea\u9002\u5e94\u79e9\u9009\u62e9</li>\n<li>\u76d1\u63a7\u8fd1\u4f3c\u8bef\u5dee</li>\n<li>\u5728\u5173\u952e\u8ba1\u7b97\u6b65\u9aa4\u4fdd\u7559\u66f4\u9ad8\u7cbe\u5ea6</li>\n</ul>\n<h3 id=\"5-winograd\">5. Winograd\u53d8\u6362\u7684\u7cbe\u5ea6\u635f\u5931</h3>\n<p><strong>\u9677\u9631</strong>\uff1a\u5728\u4f4e\u7cbe\u5ea6\u786c\u4ef6\uff08\u5982INT8\uff09\u4e0a\u4f7f\u7528\u5927tile size\u7684Winograd\u3002\n<strong>\u5efa\u8bae</strong>\uff1a</p>\n<ul>\n<li>FP32\uff1a\u53ef\u4ee5\u4f7f\u7528$F(4,3)$</li>\n<li>FP16\uff1a\u5efa\u8bae\u4f7f\u7528$F(2,3)$</li>\n<li>INT8\uff1a\u901a\u5e38\u907f\u514d\u4f7f\u7528Winograd</li>\n</ul>\n<h3 id=\"6\">6. \u7a00\u758f\u5377\u79ef\u7684\u8d1f\u8f7d\u4e0d\u5747\u8861</h3>\n<p><strong>\u9677\u9631</strong>\uff1a\u975e\u5747\u5300\u7a00\u758f\u6a21\u5f0f\u5bfc\u81f4\u5e76\u884c\u6548\u7387\u4f4e\u4e0b\u3002\n<strong>\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u8d1f\u8f7d\u5747\u8861</li>\n<li>\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\u5904\u7406\u51b2\u7a81</li>\n<li>\u8003\u8651\u7ed3\u6784\u5316\u7a00\u758f\u6a21\u5f0f</li>\n</ul>\n<h2 id=\"_6\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_7\">\u7b97\u6cd5\u9009\u62e9</h3>\n<ul>\n<li>[ ] \u5206\u6790\u77e9\u9635\u7ed3\u6784\uff1a\u662f\u5426\u5177\u6709Toeplitz\u3001\u5faa\u73af\u3001\u4f4e\u79e9\u6216\u5206\u5c42\u7ed3\u6784\uff1f</li>\n<li>[ ] \u4f30\u7b97\u95ee\u9898\u89c4\u6a21\uff1a\u77e9\u9635\u5927\u5c0f\u3001\u5e26\u5bbd\u3001\u79e9\u7b49\u53c2\u6570</li>\n<li>[ ] \u8bc4\u4f30\u7cbe\u5ea6\u8981\u6c42\uff1a\u53ef\u63a5\u53d7\u7684\u8fd1\u4f3c\u8bef\u5dee\u662f\u591a\u5c11\uff1f</li>\n<li>[ ] \u8003\u8651\u786c\u4ef6\u9650\u5236\uff1a\u5185\u5b58\u5927\u5c0f\u3001\u7f13\u5b58\u5c42\u6b21\u3001\u5e76\u884c\u80fd\u529b</li>\n</ul>\n<h3 id=\"_8\">\u5b9e\u73b0\u4f18\u5316</h3>\n<ul>\n<li>[ ] \u5185\u5b58\u5e03\u5c40\uff1a\u9009\u62e9\u9002\u5408\u7f13\u5b58\u7684\u6570\u636e\u7ed3\u6784</li>\n<li>[ ] \u5411\u91cf\u5316\uff1a\u5229\u7528SIMD\u6307\u4ee4\u52a0\u901f\u57fa\u672c\u8fd0\u7b97</li>\n<li>[ ] \u5e76\u884c\u7b56\u7565\uff1a\u4efb\u52a1\u7ea7\u5e76\u884cvs\u6570\u636e\u7ea7\u5e76\u884c</li>\n<li>[ ] \u6570\u503c\u7a33\u5b9a\u6027\uff1a\u6dfb\u52a0\u5fc5\u8981\u7684\u6b63\u5219\u5316\u548c\u8bef\u5dee\u68c0\u67e5</li>\n</ul>\n<h3 id=\"_9\">\u6027\u80fd\u8c03\u4f18</h3>\n<ul>\n<li>[ ] Profile\u70ed\u70b9\uff1a\u8bc6\u522b\u8ba1\u7b97\u74f6\u9888</li>\n<li>[ ] \u5185\u5b58\u5e26\u5bbd\uff1a\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u6570\u636e\u79fb\u52a8</li>\n<li>[ ] \u9884\u8ba1\u7b97\u5f00\u9500\uff1a\u5e73\u8861\u9884\u5904\u7406\u65f6\u95f4\u548c\u52a0\u901f\u6536\u76ca</li>\n<li>[ ] \u81ea\u9002\u5e94\u7b56\u7565\uff1a\u6839\u636e\u8f93\u5165\u7279\u5f81\u52a8\u6001\u8c03\u6574\u7b97\u6cd5</li>\n</ul>\n<h3 id=\"_10\">\u6b63\u786e\u6027\u9a8c\u8bc1</h3>\n<ul>\n<li>[ ] \u5355\u5143\u6d4b\u8bd5\uff1a\u8986\u76d6\u8fb9\u754c\u60c5\u51b5</li>\n<li>[ ] \u6570\u503c\u9a8c\u8bc1\uff1a\u4e0e\u6807\u51c6\u7b97\u6cd5\u5bf9\u6bd4</li>\n<li>[ ] \u8bef\u5dee\u5206\u6790\uff1a\u7406\u8bba\u8bef\u5dee\u754cvs\u5b9e\u9645\u8bef\u5dee</li>\n<li>[ ] \u538b\u529b\u6d4b\u8bd5\uff1a\u5927\u89c4\u6a21\u95ee\u9898\u7684\u7a33\u5b9a\u6027</li>\n</ul>\n<h3 id=\"_11\">\u53ef\u6269\u5c55\u6027</h3>\n<ul>\n<li>[ ] \u6a21\u5757\u5316\u8bbe\u8ba1\uff1a\u6613\u4e8e\u66ff\u6362\u548c\u6269\u5c55\u7ec4\u4ef6</li>\n<li>[ ] \u63a5\u53e3\u6807\u51c6\u5316\uff1a\u4e0e\u73b0\u6709\u5e93\u517c\u5bb9</li>\n<li>[ ] \u6587\u6863\u5b8c\u5584\uff1a\u7b97\u6cd5\u5047\u8bbe\u548c\u4f7f\u7528\u9650\u5236</li>\n<li>[ ] \u6027\u80fd\u6a21\u578b\uff1a\u9884\u6d4b\u4e0d\u540c\u89c4\u6a21\u4e0b\u7684\u8868\u73b0</li>\n</ul>"
  },
  "../CLAUDE.md": {
    "hash": "e346b3029320b50ca73363187d989198",
    "content": "<p>\uff08\u4ea4\u6d41\u53ef\u4ee5\u7528\u82f1\u6587\uff0c\u672c\u6587\u6863\u4e2d\u6587\uff0c\u4fdd\u7559\u8fd9\u53e5\uff09</p>\n<h1 id=\"_1\">\u9ad8\u7ea7\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u6559\u7a0b\u9879\u76ee\u8bf4\u660e</h1>\n<h2 id=\"_2\">\u9879\u76ee\u76ee\u6807</h2>\n<p>\u7f16\u5199\u4e00\u4efd\u5927\u89c4\u6a21\u77e9\u9635\u8ba1\u7b97\u7684\u9ad8\u7ea7\u6559\u7a0bmarkdown\uff0c\u8981\u5305\u542b\u5927\u91cf\u7684\u4e60\u9898\u548c\u53c2\u8003\u7b54\u6848\uff08\u7b54\u6848\u9ed8\u8ba4\u6298\u53e0\uff09\u3002\u5408\u9002\u65f6\u63d0\u53ca\u76f8\u5173\u51fd\u6570\u540d\u4f46\u4e0d\u5199\u4ee3\u7801\u3002\n\u8986\u76d6\u8bdd\u9898\u5305\u62ecpreconditioning, optimization on manifold, matrix sketching, distributed matrix computation, online incremental algorithm \u7b49\uff1a\u8986\u76d6\u6280\u672f\u6709incremental hessian computation, Schur complement, L-BFGS \u6df1\u5165\u89e3\u6790\u7b49\n\u9879\u76ee\u7279\u8272\u662f\uff0c\u5305\u542b\u5927\u91cf\u7684\u53ef\u7ee7\u7eed\u7814\u7a76\u7684\u7ebf\u7d22\n\u6587\u4ef6\u7ec4\u7ec7\u662f index.md + chapter1.md + ...</p>\n<h2 id=\"_3\">\u7ae0\u8282\u7ed3\u6784\u8981\u6c42</h2>\n<p>\u6bcf\u4e2a\u7ae0\u8282\u5e94\u5305\u542b\uff1a</p>\n<ol>\n<li><strong>\u5f00\u7bc7\u6bb5\u843d</strong>\uff1a\u7b80\u8981\u4ecb\u7ecd\u672c\u7ae0\u5185\u5bb9\u548c\u5b66\u4e60\u76ee\u6807</li>\n<li><strong>\u672c\u7ae0\u5c0f\u7ed3</strong>\uff1a\u603b\u7ed3\u5173\u952e\u6982\u5ff5\u548c\u516c\u5f0f</li>\n<li><strong>\u7ec3\u4e60\u9898</strong>\uff1a\n   - \u6bcf\u7ae0\u5305\u542b6-8\u9053\u7ec3\u4e60\u9898\n   - 50%\u57fa\u7840\u9898\uff08\u5e2e\u52a9\u719f\u6089\u6750\u6599\uff09\n   - 50%\u6311\u6218\u9898\uff08\u5305\u62ec\u5f00\u653e\u6027\u601d\u8003\u9898\uff09\n   - \u6bcf\u9898\u63d0\u4f9b\u63d0\u793a\uff08Hint\uff09\n   - \u7b54\u6848\u9ed8\u8ba4\u6298\u53e0\uff0c\u4e0d\u5305\u542b\u4ee3\u7801</li>\n<li><strong>\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef</strong> (Gotchas)\uff1a\u6bcf\u7ae0\u5305\u542b\u8be5\u4e3b\u9898\u7684\u5e38\u89c1\u9519\u8bef\u548c\u8c03\u8bd5\u6280\u5de7</li>\n<li><strong>\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</strong>\uff1a\u6bcf\u7ae0\u672b\u5c3e\u63d0\u4f9b\u8bbe\u8ba1\u5ba1\u67e5\u8981\u70b9</li>\n</ol>"
  },
  "../chapter6.md": {
    "hash": "ea4b2946086322f483b0d679cd5aee6f",
    "content": "<h1 id=\"6sketching\">\u7b2c6\u7ae0\uff1a\u77e9\u9635Sketching\u6280\u672f</h1>\n<h2 id=\"_1\">\u672c\u7ae0\u6982\u8ff0</h2>\n<p>\u77e9\u9635sketching\u662f\u73b0\u4ee3\u5927\u89c4\u6a21\u6570\u636e\u5904\u7406\u7684\u6838\u5fc3\u6280\u672f\u4e4b\u4e00\uff0c\u901a\u8fc7\u6784\u9020\u539f\u59cb\u77e9\u9635\u7684\u4f4e\u7ef4\"\u8349\u56fe\"\u6765\u52a0\u901f\u8ba1\u7b97\u5e76\u964d\u4f4e\u5b58\u50a8\u9700\u6c42\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8sketching\u7684\u6570\u5b66\u57fa\u7840\u3001\u7b97\u6cd5\u8bbe\u8ba1\u548c\u5b9e\u9645\u5e94\u7528\uff0c\u7279\u522b\u5173\u6ce8\u5728\u6df1\u5ea6\u5b66\u4e60\u548c\u6570\u636e\u5206\u6790\u4e2d\u7684\u521b\u65b0\u5e94\u7528\u3002\u6211\u4eec\u5c06\u4eceJohnson-Lindenstrauss\u5f15\u7406\u7684\u5b9e\u7528\u5316\u5f00\u59cb\uff0c\u9010\u6b65\u6df1\u5165\u5230CountSketch\u3001Frequent Directions\u7b49\u524d\u6cbf\u7b97\u6cd5\uff0c\u5e76\u63a2\u8ba8\u8fd9\u4e9b\u6280\u672f\u5728\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u4e2d\u7684\u5e94\u7528\u6f5c\u529b\u3002</p>\n<h3 id=\"_2\">\u5b66\u4e60\u76ee\u6807</h3>\n<ul>\n<li>\u638c\u63e1\u7ef4\u5ea6\u7ea6\u7b80\u7684\u7406\u8bba\u4fdd\u8bc1\u4e0e\u5b9e\u9645\u754c\u9650</li>\n<li>\u7406\u89e3\u4e0d\u540csketching\u6280\u672f\u7684\u9002\u7528\u573a\u666f</li>\n<li>\u5b66\u4f1a\u8bbe\u8ba1\u95ee\u9898\u7279\u5b9a\u7684sketching\u65b9\u6848</li>\n<li>\u63a2\u7d22sketching\u5728\u73b0\u4ee3AI\u7cfb\u7edf\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<h2 id=\"61-johnson-lindenstrauss\">6.1 Johnson-Lindenstrauss\u5f15\u7406\u7684\u5b9e\u7528\u5316</h2>\n<h3 id=\"611\">6.1.1 \u4ece\u7406\u8bba\u5230\u5b9e\u8df5\u7684\u9e3f\u6c9f</h3>\n<p>Johnson-Lindenstrauss (JL) \u5f15\u7406\u4fdd\u8bc1\uff1a\u5bf9\u4e8e $n$ \u4e2a\u70b9\uff0c\u5b58\u5728\u4ece $\\mathbb{R}^d$ \u5230 $\\mathbb{R}^k$ \u7684\u6620\u5c04\uff0c\u5176\u4e2d $k = O(\\log n / \\epsilon^2)$\uff0c\u4f7f\u5f97\u6240\u6709\u70b9\u5bf9\u4e4b\u95f4\u7684\u8ddd\u79bb\u4ee5 $(1 \\pm \\epsilon)$ \u56e0\u5b50\u4fdd\u6301\u3002</p>\n<p><strong>\u7406\u8bba\u754c\u9650\u4e0e\u5b9e\u9645\u6027\u80fd</strong>\uff1a</p>\n<ul>\n<li>\u7406\u8bba\uff1a$k \\geq 4(\\epsilon^2/2 - \\epsilon^3/3)^{-1} \\log n$</li>\n<li>\u5b9e\u8df5\uff1a\u901a\u5e38\u9700\u8981 $k = O(\\log n / \\epsilon^2)$ \u7684\u5e38\u6570\u500d</li>\n<li>\u5173\u952e\u89c2\u5bdf\uff1a\u5bf9\u4e8e\u7279\u5b9a\u6570\u636e\u5206\u5e03\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u7d27\u7684\u754c\u9650</li>\n</ul>\n<p><strong>\u6df1\u5165\u7406\u89e3JL\u5f15\u7406</strong>\uff1a</p>\n<p>JL\u5f15\u7406\u7684\u672c\u8d28\u662f\u5229\u7528\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u7684\u96c6\u4e2d\u73b0\u8c61\uff08concentration of measure\uff09\u3002\u5177\u4f53\u6765\u8bf4\uff1a</p>\n<ul>\n<li>\u5728\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\uff0c\u968f\u673a\u5411\u91cf\u51e0\u4e4e\u6b63\u4ea4</li>\n<li>\u968f\u673a\u6295\u5f71\u4fdd\u6301\u4e86\u8fd9\u79cd\u8fd1\u4f3c\u6b63\u4ea4\u6027</li>\n<li>\u8ddd\u79bb\u4fdd\u6301\u662f\u5185\u79ef\u4fdd\u6301\u7684\u81ea\u7136\u7ed3\u679c</li>\n</ul>\n<p>\u6570\u5b66\u5f62\u5f0f\u5316\uff1a\u5bf9\u4e8e\u4efb\u610f $\\mathbf{x}, \\mathbf{y} \\in \\mathbb{R}^d$\uff0c\u5982\u679c $\\mathbf{S} \\in \\mathbb{R}^{k \\times d}$ \u662f\u9002\u5f53\u7684\u968f\u673a\u77e9\u9635\uff0c\u5219\uff1a\n$$\\Pr[(1-\\epsilon)|\\mathbf{x}-\\mathbf{y}|^2 \\leq |\\mathbf{S}(\\mathbf{x}-\\mathbf{y})|^2 \\leq (1+\\epsilon)|\\mathbf{x}-\\mathbf{y}|^2] \\geq 1 - 2e^{-c\\epsilon^2 k}$$\n\u5176\u4e2d $c$ \u662f\u4f9d\u8d56\u4e8e\u5177\u4f53\u6784\u9020\u7684\u5e38\u6570\u3002</p>\n<p><strong>\u5b9e\u8df5\u4e2d\u7684\u5173\u952e\u6311\u6218</strong>\uff1a</p>\n<ol>\n<li><strong>\u5e38\u6570\u56e0\u5b50\u7684\u5f71\u54cd</strong>\uff1a\u7406\u8bba\u754c\u9650\u4e2d\u7684\u5e38\u6570\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u53ef\u80fd\u5f88\u5927\u3002\u4f8b\u5982\uff0c\u4fdd\u8bc1 $\\epsilon = 0.1$ \u7684\u5931\u771f\u5bf9\u4e8e $n = 10^6$ \u4e2a\u70b9\uff0c\u7406\u8bba\u4e0a\u9700\u8981 $k \\approx 10^4$\uff0c\u4f46\u5b9e\u8df5\u4e2d\u53ef\u80fd\u9700\u8981 $2-3$ \u500d\u3002</li>\n</ol>\n<p><strong>\u7cbe\u786e\u5206\u6790</strong>\uff1a\u5bf9\u4e8e\u9ad8\u65af\u968f\u673a\u6295\u5f71\uff0c\u6700\u4f18\u5e38\u6570 $c \\approx 1/4$\uff0c\u8fd9\u610f\u5473\u7740\uff1a\n$$k \\geq \\frac{8 \\log(n) + 8\\log(2/\\delta)}{\\epsilon^2}$$\n\u5176\u4e2d $\\delta$ \u662f\u5931\u8d25\u6982\u7387\u3002\u5b9e\u8df5\u4e2d\uff0c\u8fd9\u4e2a\u754c\u9650\u901a\u5e38\u8fc7\u4e8e\u4fdd\u5b88\uff0c\u56e0\u4e3a\uff1a</p>\n<ul>\n<li>\u5b9e\u9645\u6570\u636e\u4e0d\u662f\u6700\u574f\u60c5\u51b5\u5206\u5e03</li>\n<li>\u5e94\u7528\u5f80\u5f80\u80fd\u5bb9\u5fcd\u5c11\u91cf\u5931\u8d25</li>\n<li>\u53ef\u4ee5\u4f7f\u7528\u540e\u9a8c\u9a8c\u8bc1\u6765\u68c0\u6d4b\u5931\u8d25\u60c5\u51b5</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u6570\u636e\u7684\u5185\u5728\u7ef4\u5ea6</strong>\uff1a\u771f\u5b9e\u6570\u636e\u5f80\u5f80\u4f4d\u4e8e\u4f4e\u7ef4\u6d41\u5f62\u4e0a\u3002\u5229\u7528\u8c31\u8870\u51cf\u53ef\u4ee5\u663e\u8457\u964d\u4f4e\u6240\u9700\u7ef4\u5ea6\uff1a\n   - \u5982\u679c\u6570\u636e\u7684\u6709\u6548\u79e9 $r_{eff} = \\text{tr}(\\mathbf{C})/|\\mathbf{C}|_2 \\ll d$\uff08\u5176\u4e2d $\\mathbf{C}$ \u662f\u534f\u65b9\u5dee\u77e9\u9635\uff09\n   - \u5219\u53ef\u4ee5\u4f7f\u7528 $k = O(\\log n / \\epsilon^2 + r_{eff})$ \u7684\u7ef4\u5ea6</li>\n</ol>\n<p><strong>\u8c31\u8870\u51cf\u7684\u91cf\u5316</strong>\uff1a\u8bbe $\\lambda_1 \\geq \\lambda_2 \\geq ... \\geq \\lambda_d$ \u662f\u534f\u65b9\u5dee\u77e9\u9635\u7684\u7279\u5f81\u503c\uff0c\u5b9a\u4e49\uff1a</p>\n<ul>\n<li>\u6709\u6548\u79e9\uff1a$r_{eff} = (\\sum_i \\lambda_i)^2 / \\sum_i \\lambda_i^2$</li>\n<li>$\\alpha$-\u6709\u6548\u79e9\uff1a$r_\\alpha = \\min{k: \\sum_{i=1}^k \\lambda_i \\geq \\alpha \\sum_i \\lambda_i}$</li>\n<li>\u8c31\u71b5\uff1a$H = -\\sum_i \\frac{\\lambda_i}{|\\mathbf{C}|_*} \\log \\frac{\\lambda_i}{|\\mathbf{C}|_*}$</li>\n</ul>\n<p>\u8fd9\u4e9b\u5ea6\u91cf\u63d0\u4f9b\u4e86\u6570\u636e\u590d\u6742\u5ea6\u7684\u4e0d\u540c\u89c6\u89d2\uff0c\u53ef\u4ee5\u6307\u5bfc\u6295\u5f71\u7ef4\u5ea6\u7684\u9009\u62e9\u3002</p>\n<ol start=\"3\">\n<li><strong>\u5931\u771f\u7684\u975e\u5747\u5300\u6027</strong>\uff1aJL\u4fdd\u8bc1\u662f\u6700\u574f\u60c5\u51b5\u7684\uff0c\u4f46\u5b9e\u9645\u4e2d\uff1a\n   - \u5927\u90e8\u5206\u70b9\u5bf9\u7684\u5931\u771f\u8fdc\u5c0f\u4e8e $\\epsilon$\n   - \u53ef\u4ee5\u63a5\u53d7\u5c11\u6570\u70b9\u5bf9\u6709\u8f83\u5927\u5931\u771f\n   - \u4f7f\u7528\u81ea\u9002\u5e94\u65b9\u6cd5\u8bc6\u522b\u548c\u7279\u6b8a\u5904\u7406\"\u56f0\u96be\"\u7684\u70b9\u5bf9</li>\n</ol>\n<p><strong>\u5931\u771f\u5206\u5e03\u7684\u7ecf\u9a8c\u89c4\u5f8b</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u4e8e\u9ad8\u65af\u6570\u636e\uff0c\u7ea695%\u7684\u70b9\u5bf9\u5931\u771f\u5c0f\u4e8e $\\epsilon/2$</li>\n<li>\u5931\u771f\u5927\u4e8e $\\epsilon$ \u7684\u70b9\u5bf9\u901a\u5e38\u5bf9\u5e94\u4e8e\uff1a<ul>\n<li>\u975e\u5e38\u63a5\u8fd1\u7684\u70b9\uff08\u5c0f\u8ddd\u79bb\u653e\u5927\u6548\u5e94\uff09</li>\n<li>\u4f4d\u4e8e\u6570\u636e\u5206\u5e03\u5c3e\u90e8\u7684\u5f02\u5e38\u70b9</li>\n<li>\u9ad8\u5ea6\u76f8\u5173\u7684\u70b9\u5bf9</li>\n</ul>\n</li>\n</ul>\n<p><strong>\u81ea\u9002\u5e94\u7b56\u7565</strong>\uff1a</p>\n<ul>\n<li><strong>\u4e24\u9636\u6bb5\u65b9\u6cd5</strong>\uff1a\u5148\u7528\u8f83\u5c0f\u7684 $k$ \u8bc6\u522b\u56f0\u96be\u70b9\u5bf9\uff0c\u7136\u540e\u589e\u52a0\u7ef4\u5ea6\u6216\u7279\u6b8a\u5904\u7406</li>\n<li><strong>\u91cd\u8981\u6027\u52a0\u6743</strong>\uff1a\u5bf9\u5173\u952e\u70b9\u5bf9\u5206\u914d\u66f4\u591a\u7684\u6295\u5f71\u7ef4\u5ea6</li>\n<li><strong>\u5c40\u90e8\u654f\u611f\u54c8\u5e0c</strong>\uff1a\u7ed3\u5408LSH\u6280\u672f\u5904\u7406\u8fd1\u90bb\u67e5\u8be2</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u8ba1\u7b97\u4e0e\u5b58\u50a8\u7684\u6743\u8861</strong>\uff1a</li>\n</ol>\n<p><strong>\u65f6\u7a7a\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6295\u5f71\u8ba1\u7b97\uff1a$O(ndk)$ \u6d6e\u70b9\u8fd0\u7b97</li>\n<li>\u5b58\u50a8\u9700\u6c42\uff1a$O(dk)$ \u5b58\u50a8\u6295\u5f71\u77e9\u9635\uff0c$O(nk)$ \u5b58\u50a8\u6295\u5f71\u540e\u6570\u636e</li>\n<li>\u8ddd\u79bb\u8ba1\u7b97\uff1a\u4ece $O(d)$ \u964d\u81f3 $O(k)$ \u6bcf\u5bf9</li>\n</ul>\n<p><strong>\u5b9e\u9645\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u5f53 $k/d &lt; 0.3$ \u65f6\uff0c\u6295\u5f71\u901a\u5e38\u662f\u503c\u5f97\u7684</li>\n<li>\u5bf9\u4e8e\u7a00\u758f\u6570\u636e\uff0c\u9700\u8981\u8003\u8651\u7a00\u758f\u6027\u4fdd\u6301</li>\n<li>\u5728\u7ebf\u573a\u666f\u4e0b\uff0c\u6295\u5f71\u77e9\u9635\u7684\u751f\u6210\u548c\u5b58\u50a8\u53ef\u80fd\u6210\u4e3a\u74f6\u9888</li>\n</ul>\n<ol start=\"5\">\n<li><strong>\u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898</strong>\uff1a</li>\n</ol>\n<p>\u9ad8\u7ef4\u6295\u5f71\u53ef\u80fd\u7d2f\u79ef\u6d6e\u70b9\u8bef\u5dee\uff1a</p>\n<ul>\n<li><strong>Kahan\u6c42\u548c</strong>\uff1a\u51cf\u5c11\u7d2f\u52a0\u8bef\u5dee</li>\n<li><strong>\u5206\u5757\u8ba1\u7b97</strong>\uff1a\u907f\u514d\u5927\u89c4\u6a21\u70b9\u79ef</li>\n<li><strong>\u6b63\u4ea4\u5316</strong>\uff1a\u786e\u4fdd\u6295\u5f71\u77e9\u9635\u7684\u6761\u4ef6\u6570\u826f\u597d</li>\n</ul>\n<p><strong>\u8bef\u5dee\u754c\u9650</strong>\uff1a\u8bbe\u673a\u5668\u7cbe\u5ea6\u4e3a $u$\uff0c\u5219\u6570\u503c\u8bef\u5dee\u5927\u81f4\u4e3a\uff1a\n$$|\\tilde{\\mathbf{S}}\\mathbf{x} - \\mathbf{S}\\mathbf{x}| \\lesssim \\sqrt{dk}u|\\mathbf{S}||\\mathbf{x}|$$</p>\n<h3 id=\"612\">6.1.2 \u968f\u673a\u6295\u5f71\u77e9\u9635\u7684\u6784\u9020</h3>\n<p><strong>\u9ad8\u65af\u968f\u673a\u6295\u5f71</strong>\uff1a\n$$\\mathbf{S}_{ij} \\sim \\mathcal{N}(0, 1/k)$$\n\u4f18\u70b9\uff1a\u7406\u8bba\u6027\u8d28\u4f18\u7f8e\uff0c\u65cb\u8f6c\u4e0d\u53d8\u6027\n\u7f3a\u70b9\uff1a\u8ba1\u7b97\u5bc6\u96c6\uff0c\u5b58\u50a8\u5f00\u9500\u5927</p>\n<p><strong>\u6df1\u5165\u5206\u6790\u9ad8\u65af\u6295\u5f71</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u4e3a\u4ec0\u4e48\u662f $1/k$ \u7f29\u653e</strong>\uff1a\n   - \u4fdd\u8bc1 $\\mathbb{E}[|\\mathbf{S}\\mathbf{x}|^2] = |\\mathbf{x}|^2$\n   - \u6bcf\u4e2a\u6295\u5f71\u5750\u6807\u7684\u65b9\u5dee\u4e3a $|\\mathbf{x}|^2/k$\n   - $k$ \u4e2a\u72ec\u7acb\u5750\u6807\u7684\u548c\u63a5\u8fd1 $|\\mathbf{x}|^2$</p>\n</li>\n<li>\n<p><strong>\u65cb\u8f6c\u4e0d\u53d8\u6027\u7684\u91cd\u8981\u6027</strong>\uff1a\n   - \u9ad8\u65af\u5206\u5e03\u5728\u6b63\u4ea4\u53d8\u6362\u4e0b\u4e0d\u53d8\n   - \u610f\u5473\u7740\u6295\u5f71\u8d28\u91cf\u4e0d\u4f9d\u8d56\u4e8e\u5750\u6807\u7cfb\u9009\u62e9\n   - \u5bf9\u4e8e\u5404\u5411\u540c\u6027\u6570\u636e\u7279\u522b\u6709\u6548</p>\n</li>\n<li>\n<p><strong>\u96c6\u4e2d\u6027\u8d28</strong>\uff1a\n   \u5bf9\u4e8e\u5355\u4f4d\u5411\u91cf $\\mathbf{x}$\uff0c\u6295\u5f71\u957f\u5ea6\u7684\u5206\u5e03\uff1a\n$$|\\mathbf{S}\\mathbf{x}|^2 \\sim \\frac{1}{k}\\chi^2_k$$\n\u5229\u7528\u5361\u65b9\u5206\u5e03\u7684\u96c6\u4e2d\u6027\uff1a\n$$\\Pr[||\\mathbf{S}\\mathbf{x}|^2 - 1| &gt; \\epsilon] \\leq 2\\exp(-k\\epsilon^2/8)$$\n\u5b9e\u73b0\u7ec6\u8282\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u4f7f\u7528Box-Muller\u53d8\u6362\u6216Ziggurat\u7b97\u6cd5\u751f\u6210\u9ad8\u65af\u968f\u673a\u6570</li>\n<li>\u6279\u91cf\u751f\u6210\u4ee5\u5229\u7528BLAS-3\u64cd\u4f5c</li>\n<li>\u8003\u8651\u4f7f\u7528\u4f4e\u7cbe\u5ea6\uff08\u5982float16\uff09\u5728\u4fdd\u6301\u7cbe\u5ea6\u7684\u540c\u65f6\u52a0\u901f</li>\n</ul>\n<p><strong>\u9ad8\u6548\u5b9e\u73b0\u6280\u5de7</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">// \u4f2a\u4ee3\u7801\uff1a\u6279\u91cf\u9ad8\u65af\u6295\u5f71</span>\n<span class=\"k\">function</span><span class=\"w\"> </span><span class=\"nf\">gaussian_projection</span><span class=\"p\">(</span>X, k<span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"c1\">// X: n\u00d7d \u6570\u636e\u77e9\u9635</span>\n<span class=\"w\">    </span><span class=\"c1\">// \u751f\u6210\u6295\u5f71\u77e9\u9635\uff0c\u6bcf\u6b21\u751f\u6210\u4e00\u4e2a\u5757</span>\n<span class=\"w\">    </span><span class=\"n\">block_size</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">min</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">available_memory</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">sizeof</span><span class=\"p\">(</span><span class=\"n\">float</span><span class=\"p\">)))</span>\n<span class=\"w\">    </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"nb\">zeros</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">)</span>\n\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">in</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"n\">k</span><span class=\"p\">:</span><span class=\"n\">block_size</span><span class=\"p\">:</span>\n<span class=\"w\">        </span><span class=\"n\">S_block</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"nb\">min</span><span class=\"p\">(</span><span class=\"n\">block_size</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">-</span><span class=\"n\">i</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"nb\">sqrt</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"n\">Y</span><span class=\"p\">[:,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"p\">:</span><span class=\"n\">i</span><span class=\"o\">+</span><span class=\"n\">block_size</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"p\">@</span><span class=\"w\"> </span><span class=\"n\">S_block</span><span class=\"p\">.</span><span class=\"n\">T</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">Y</span>\n</code></pre></div>\n\n<p><strong>\u7a00\u758f\u968f\u673a\u6295\u5f71</strong>\uff08Achlioptas, 2003\uff09\uff1a\n$$\\mathbf{S}_{ij} = \\sqrt{s/k} \\times \\begin{cases}\n+1 &amp; \\text{\u6982\u7387 } 1/(2s) \\\n0 &amp; \\text{\u6982\u7387 } 1-1/s \\\n-1 &amp; \\text{\u6982\u7387 } 1/(2s)\n\\end{cases}$$\n\u5176\u4e2d $s = 3$ \u6216 $s = \\sqrt{d}$ \u662f\u5e38\u89c1\u9009\u62e9\u3002</p>\n<p>\u7a00\u758f\u6027\u7684\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u5b58\u50a8\u9700\u6c42\uff1a\u4ece $O(kd)$ \u964d\u81f3 $O(kd/s)$</li>\n<li>\u8ba1\u7b97\u52a0\u901f\uff1a\u7a00\u758f\u77e9\u9635\u4e58\u6cd5</li>\n<li>\u5b9e\u8df5\u5efa\u8bae\uff1a$s = 3$ \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u6548\u679c\u826f\u597d</li>\n</ul>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1\u7684\u7ec6\u8282</strong>\uff1a</p>\n<ul>\n<li>Li\u7b49\u4eba(2006)\u8bc1\u660e $s = 3$ \u65f6\u4ecd\u6ee1\u8db3JL\u6027\u8d28</li>\n<li>\u7a00\u758f\u5ea6 $s = \\Omega(\\log^2 n)$ \u65f6\u53ef\u8fbe\u5230\u4e0e\u9ad8\u65af\u76f8\u540c\u7684\u754c\u9650</li>\n<li>\u5b9e\u8df5\u4e2d $s = 3$ \u5df2\u7ecf\u8db3\u591f\uff0c\u7279\u522b\u662f\u5f53 $d$ \u5f88\u5927\u65f6</li>\n</ul>\n<p><strong>\u8d85\u7a00\u758f\u6295\u5f71</strong>\uff1a\n\u5f53 $s = \\sqrt{d}$ \u65f6\uff0c\u6bcf\u884c\u671f\u671b\u53ea\u6709 $\\sqrt{d}$ \u4e2a\u975e\u96f6\u5143\u7d20\uff1a</p>\n<ul>\n<li>\u5b58\u50a8\uff1a$O(k\\sqrt{d})$</li>\n<li>\u8ba1\u7b97\uff1a$O(nk\\sqrt{d})$</li>\n<li>\u9002\u7528\u4e8e\u8d85\u9ad8\u7ef4\u7a00\u758f\u6570\u636e\uff08\u5982\u6587\u672c\u3001\u57fa\u56e0\u7ec4\u6570\u636e\uff09</li>\n</ul>\n<p><strong>\u5feb\u901fJL\u53d8\u6362</strong>\uff08Ailon &amp; Chazelle, 2009\uff09\uff1a\n$$\\mathbf{S} = \\sqrt{d/k} \\cdot \\mathbf{P} \\mathbf{H} \\mathbf{D}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathbf{D}$\uff1a\u968f\u673a\u5bf9\u89d2\u7b26\u53f7\u77e9\u9635</li>\n<li>$\\mathbf{H}$\uff1aHadamard\u77e9\u9635\uff08\u6216DCT\u3001FFT\uff09</li>\n<li>$\\mathbf{P}$\uff1a\u7a00\u758f\u91c7\u6837\u77e9\u9635</li>\n</ul>\n<p>\u8ba1\u7b97\u590d\u6742\u5ea6\uff1a$O(d \\log d)$ vs \u6734\u7d20\u7684 $O(dk)$</p>\n<p><strong>\u7b97\u6cd5\u76f4\u89c9</strong>\uff1a</p>\n<ol>\n<li><strong>\u9884\u5904\u7406\uff08$\\mathbf{H}\\mathbf{D}$\uff09</strong>\uff1a\u5c06\u80fd\u91cf\u5747\u5300\u5206\u6563\u5230\u6240\u6709\u5750\u6807</li>\n<li><strong>\u91c7\u6837\uff08$\\mathbf{P}$\uff09</strong>\uff1a\u968f\u673a\u9009\u62e9 $k$ \u4e2a\u5750\u6807</li>\n<li><strong>\u7406\u8bba\u57fa\u7840</strong>\uff1a\u9884\u5904\u7406\u540e\u7684\u5411\u91cf\u63a5\u8fd1\u5404\u5411\u540c\u6027</li>\n</ol>\n<p><strong>\u5b9e\u73b0\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u5f53 $k &lt; d/\\log d$ \u65f6\uff0c\u5feb\u901fJL\u6bd4\u76f4\u63a5\u6295\u5f71\u66f4\u5feb</li>\n<li>Hadamard\u53d8\u6362\u9700\u8981 $d$ \u662f2\u7684\u5e42\uff08\u53ef\u901a\u8fc7padding\u89e3\u51b3\uff09</li>\n<li>\u53ef\u4ee5\u7528DCT\u6216\u5176\u4ed6\u6b63\u4ea4\u53d8\u6362\u66ff\u4ee3Hadamard</li>\n</ul>\n<p>\u5b9e\u9645\u4f18\u5316\uff1a</p>\n<ul>\n<li>\u4f7f\u7528FFTW\u6216\u7c7b\u4f3c\u5e93\u5b9e\u73b0\u5feb\u901f\u53d8\u6362</li>\n<li>\u9884\u8ba1\u7b97Hadamard\u77e9\u9635\u7684\u4f4d\u53cd\u8f6c\u6392\u5217</li>\n<li>\u6d41\u5f0f\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u907f\u514d\u5185\u5b58\u74f6\u9888</li>\n</ul>\n<p><strong>\u5b50\u91c7\u6837\u968f\u673aHadamard\u53d8\u6362\uff08SRHT\uff09</strong>\uff1a\n\u66f4\u5b9e\u7528\u7684\u53d8\u4f53\uff0c\u7ed3\u5408\u4e86\u901f\u5ea6\u548c\u7406\u8bba\u4fdd\u8bc1\uff1a\n$$\\mathbf{S} = \\sqrt{d/k} \\cdot \\mathbf{R} \\mathbf{H} \\mathbf{D}$$\n\u5176\u4e2d $\\mathbf{R}$ \u662f\u968f\u673a\u9009\u62e9 $k$ \u884c\u7684\u9650\u5236\u77e9\u9635\u3002</p>\n<p>\u5173\u952e\u6539\u8fdb\uff1a</p>\n<ul>\n<li>\u907f\u514d\u4e86\u5b8c\u6574\u7684 $\\mathbf{P}$ \u77e9\u9635</li>\n<li>\u66f4\u597d\u7684\u7f13\u5b58\u5c40\u90e8\u6027</li>\n<li>\u6613\u4e8e\u5e76\u884c\u5316</li>\n</ul>\n<p><strong>SRHT\u7684\u8bef\u5dee\u5206\u6790</strong>\uff1a\nTropp (2011) \u8bc1\u660e\u4e86\u66f4\u7d27\u7684\u754c\u9650\uff1a\n$$\\Pr[|\\mathbf{S}\\mathbf{x}|^2 \\in (1\\pm\\epsilon)|\\mathbf{x}|^2] \\geq 1 - \\delta$$\n\u5f53 $k = O(\\epsilon^{-2}(\\log(1/\\delta) + \\log(1/\\epsilon)))$ \u65f6\u6210\u7acb\u3002</p>\n<p><strong>\u5b9e\u7528\u53d8\u4f53\u548c\u6269\u5c55</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5757SRHT</strong>\uff1a\n   \u5bf9\u4e8e\u8d85\u5927\u89c4\u6a21\u6570\u636e\uff0c\u5206\u5757\u5904\u7406\uff1a\n   <code>\u5c06\u6570\u636e\u5206\u6210\u5927\u5c0f\u4e3a B \u7684\u5757\n   \u5bf9\u6bcf\u5757\u5e94\u7528SRHT\n   \u7ec4\u5408\u7ed3\u679c</code>\n   \u4f18\u52bf\uff1a\u5185\u5b58\u6548\u7387\uff0c\u53ef\u5e76\u884c\uff0c\u652f\u6301\u6d41\u5f0f\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u8f93\u5165\u7684\u4f18\u5316</strong>\uff1a\n   \u5f53\u8f93\u5165\u7a00\u758f\u65f6\uff0c\u53ef\u4ee5\u4f18\u5316SRHT\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u53ea\u5bf9\u975e\u96f6\u5750\u6807\u5e94\u7528\u7b26\u53f7\u7ffb\u8f6c</li>\n<li>\u4f7f\u7528\u7a00\u758fFFT\u7b97\u6cd5</li>\n<li>\u590d\u6742\u5ea6\uff1a$O(nnz(x) \\log d + k)$</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u6df7\u5408\u65b9\u6cd5</strong>\uff1a\n   \u7ed3\u5408\u4e0d\u540c\u6295\u5f71\u7684\u4f18\u70b9\uff1a</li>\n</ol>\n<ul>\n<li>\u5bf9\u5bc6\u96c6\u90e8\u5206\u4f7f\u7528SRHT</li>\n<li>\u5bf9\u7a00\u758f\u90e8\u5206\u4f7f\u7528\u7a00\u758f\u6295\u5f71</li>\n<li>\u81ea\u9002\u5e94\u9009\u62e9\u6700\u4f18\u65b9\u6cd5</li>\n</ul>\n<h3 id=\"613\">6.1.3 \u6570\u636e\u76f8\u5173\u7684\u4f18\u5316</h3>\n<p><strong>\u4e3b\u6210\u5206\u5206\u6790\u5f15\u5bfc\u7684\u6295\u5f71</strong>\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97\u6570\u636e\u7684\u4e3b\u8981\u65b9\u5411</li>\n<li>\u5728\u6b63\u4ea4\u8865\u7a7a\u95f4\u4e2d\u5e94\u7528JL</li>\n<li>\u7ec4\u5408\u4e24\u4e2a\u5b50\u7a7a\u95f4\u7684\u6295\u5f71</li>\n</ol>\n<p>\u5177\u4f53\u7b97\u6cd5\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u6570\u636e\u77e9\u9635 A \u2208 \u211d^{n\u00d7d}, \u76ee\u6807\u7ef4\u5ea6 k, \u80fd\u91cf\u9608\u503c \u03c4\n1. \u8ba1\u7b97\u524d r \u4e2a\u4e3b\u6210\u5206 U_r\uff0c\u4f7f\u5f97\u4fdd\u7559 \u03c4 \u6bd4\u4f8b\u7684\u80fd\u91cf\n2. \u6295\u5f71\u5230\u6b63\u4ea4\u8865\uff1aA_\u22a5 = A - A U_r U_r^T\n3. \u5bf9 A_\u22a5 \u5e94\u7528\u7ef4\u5ea6 (k-r) \u7684JL\u53d8\u6362\uff1aB_\u22a5 = S A_\u22a5\n4. \u6700\u7ec8\u6295\u5f71\uff1a[U_r^T A; B_\u22a5]\n</code></pre></div>\n\n<p>\u7406\u8bba\u4fdd\u8bc1\uff1a\u5982\u679c\u539f\u59cb\u6570\u636e\u6709\u5feb\u901f\u8c31\u8870\u51cf\uff0c\u6b64\u65b9\u6cd5\u53ef\u4ee5\u663e\u8457\u51cf\u5c11\u6240\u9700\u7ef4\u5ea6\u3002</p>\n<p><strong>\u7406\u8bba\u5206\u6790\u7684\u6df1\u5316</strong>\uff1a</p>\n<p>\u8bbe $\\sigma_1 \\geq \\sigma_2 \\geq ... \\geq \\sigma_d$ \u662f\u6570\u636e\u77e9\u9635 $\\mathbf{A}$ \u7684\u5947\u5f02\u503c\u3002</p>\n<ol>\n<li><strong>\u6700\u4f18\u6027\u4fdd\u8bc1</strong>\uff1a\n   \u5bf9\u4e8e\u79e9\u4e3a $r$ \u7684\u77e9\u9635\u52a0\u566a\u58f0\u6a21\u578b $\\mathbf{A} = \\mathbf{L} + \\mathbf{E}$\uff0c\u5176\u4e2d $rank(\\mathbf{L}) = r$\uff1a</li>\n</ol>\n<ul>\n<li>PCA\u90e8\u5206\u5b8c\u7f8e\u4fdd\u7559 $\\mathbf{L}$ \u7684\u4fe1\u606f</li>\n<li>JL\u90e8\u5206\u4ee5\u9ad8\u6982\u7387\u4fdd\u7559 $\\mathbf{E}$ \u7684\u51e0\u4f55\u7ed3\u6784</li>\n<li>\u603b\u4f53\u8bef\u5dee\uff1a$|\\mathbf{A} - \\tilde{\\mathbf{A}}|_F \\leq (1+\\epsilon)|\\mathbf{E}|_F$</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>\u7ef4\u5ea6\u8282\u7701\u5206\u6790</strong>\uff1a\n   - \u6807\u51c6JL\u9700\u8981\uff1a$k = O(\\log n / \\epsilon^2)$\n   - PCA\u5f15\u5bfc\u9700\u8981\uff1a$k = r + O(\\log n / \\epsilon^2) \\cdot \\frac{\\sum_{i&gt;r} \\sigma_i^2}{\\sum_{i=1}^d \\sigma_i^2}$\n   - \u5f53\u8c31\u5feb\u901f\u8870\u51cf\u65f6\uff0c\u8282\u7701\u663e\u8457</p>\n</li>\n<li>\n<p><strong>\u5b9e\u8df5\u6307\u5bfc</strong>\uff1a\n   - \u5f53 $\\sigma_r / \\sigma_1 &lt; 0.1$ \u65f6\uff0c\u9009\u62e9\u524d $r$ \u4e2a\u4e3b\u6210\u5206\n   - \u4fdd\u7559\u80fd\u91cf\u6bd4\u4f8b $\\tau$ \u901a\u5e38\u9009\u62e9 0.95 \u6216 0.99\n   - \u5bf9\u5269\u4f59\u90e8\u5206\u7684\u6295\u5f71\u7ef4\u5ea6\u53ef\u4ee5\u76f8\u5e94\u51cf\u5c11</p>\n</li>\n</ol>\n<p><strong>\u81ea\u9002\u5e94\u76ee\u6807\u7ef4\u5ea6\u9009\u62e9</strong>\uff1a</p>\n<ul>\n<li>\u5728\u7ebf\u4f30\u8ba1\u6709\u6548\u79e9\uff1a$r_{eff} = |\\mathbf{A}|_F^2 / |\\mathbf{A}|_2^2$</li>\n<li>\u57fa\u4e8e\u8c31\u8870\u51cf\u8c03\u6574\u6295\u5f71\u7ef4\u5ea6</li>\n<li>\u5229\u7528\u77e9\u9635\u76f8\u5e72\u6027\u964d\u4f4e\u91c7\u6837\u590d\u6742\u5ea6</li>\n</ul>\n<p><strong>\u8be6\u7ec6\u7684\u81ea\u9002\u5e94\u7b97\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7b97\u6cd5\uff1a\u81ea\u9002\u5e94\u7ef4\u5ea6\u9009\u62e9\n\u8f93\u5165\uff1a\u6570\u636e\u6d41 {x_t}, \u76ee\u6807\u7cbe\u5ea6 \u03b5, \u521d\u59cb\u7ef4\u5ea6 k_0\n\u8f93\u51fa\uff1a\u52a8\u6001\u8c03\u6574\u7684\u6295\u5f71\u7ef4\u5ea6 k_t\n\n1. \u521d\u59cb\u5316\uff1a\n   <span class=\"k\">-</span> \u7ef4\u62a4\u4e24\u4e2asketch: S_k \u548c S_{2k}\n   <span class=\"k\">-</span> \u8bef\u5dee\u4f30\u8ba1\u5668 E = 0\n\n2. \u5bf9\u6bcf\u6279\u6570\u636e\uff1a\n   a. \u66f4\u65b0\u4e24\u4e2asketch\n   b. \u8ba1\u7b97\u8bef\u5dee\u4f30\u8ba1\uff1a\n      E_t = ||S_{2k}(X) - upsample(S_k(X))||_F / ||S_{2k}(X)||_F\n   c. \u5982\u679c E_t &gt; \u03b5:\n      <span class=\"k\">-</span> k \u2190 2k\n      <span class=\"k\">-</span> \u91cd\u65b0\u521d\u59cb\u5316S_k, S_{2k}\n   d. \u5982\u679c\u8fde\u7eedT\u6279 E_t &lt; \u03b5/2:\n      <span class=\"k\">-</span> k \u2190 max(k/2, k_min)\n\n3. \u8fd4\u56de\u5f53\u524d\u7ef4\u5ea6k\n</code></pre></div>\n\n<p><strong>\u8c31\u81ea\u9002\u5e94\u968f\u673a\u6295\u5f71</strong>\uff1a\n\u6839\u636e\u6570\u636e\u7684\u8c31\u7279\u6027\u52a8\u6001\u8c03\u6574\u6295\u5f71\uff1a</p>\n<ol>\n<li><strong>\u5feb\u901f\u8c31\u4f30\u8ba1</strong>\uff1a\u4f7f\u7528\u968f\u673a\u5316\u5e42\u6cd5\u4f30\u8ba1\u524d\u51e0\u4e2a\u7279\u5f81\u503c\n$$\\lambda_i \\approx |\\mathbf{A}\\mathbf{v}_i|^2 / |\\mathbf{v}_i|^2$$\n\u5176\u4e2d $\\mathbf{v}_i$ \u662f\u968f\u673a\u5411\u91cf\u7ecf\u8fc7\u82e5\u5e72\u6b21\u5e42\u8fed\u4ee3\u540e\u7684\u7ed3\u679c</li>\n</ol>\n<p><strong>\u7b97\u6cd5\u7ec6\u8282</strong>\uff1a\n   ```\n   function estimate_spectrum(A, r, q):\n       // r: \u4f30\u8ba1\u7684\u7279\u5f81\u503c\u6570\u91cf\n       // q: \u5e42\u8fed\u4ee3\u6b21\u6570\uff08\u901a\u5e38q=1\u62162\u8db3\u591f\uff09\n       \u03a9 = randn(d, r+p)  // p\u662f\u8fc7\u91c7\u6837\u53c2\u6570\n       Y = A^T A \u03a9\n       for j in 1:q:\n           Y = A^T A Y\n           Y = qr(Y).Q  // \u6b63\u4ea4\u5316\u9632\u6b62\u6570\u503c\u95ee\u9898</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"nv\">B</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">A</span><span class=\"w\"> </span><span class=\"nv\">Y</span>\n<span class=\"w\">   </span>[<span class=\"nv\">U</span>,<span class=\"w\"> </span>\u03a3,<span class=\"w\"> </span><span class=\"o\">~</span>]<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">svd</span><span class=\"ss\">(</span><span class=\"nv\">B</span><span class=\"ss\">)</span>\n<span class=\"w\">   </span>\u03bb<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">diag</span><span class=\"ss\">(</span>\u03a3<span class=\"ss\">)</span><span class=\"o\">^</span><span class=\"mi\">2</span>\n<span class=\"w\">   </span><span class=\"k\">return</span><span class=\"w\"> </span>\u03bb[<span class=\"mi\">1</span>:<span class=\"nv\">r</span>]\n</code></pre></div>\n\n<p>```</p>\n<ol start=\"2\">\n<li><strong>\u7ef4\u5ea6\u9009\u62e9\u51c6\u5219</strong>\uff1a\n   - \u4fdd\u7559 $(1-\\delta)$ \u80fd\u91cf\uff1a$k = \\min{j: \\sum_{i=1}^j \\lambda_i \\geq (1-\\delta)\\sum_i \\lambda_i}$\n   - \u76f8\u5bf9\u8bef\u5dee\u63a7\u5236\uff1a$k = \\min{j: \\lambda_{j+1} \\leq \\epsilon \\lambda_1}$</li>\n</ol>\n<p><strong>\u5b9e\u7528\u5efa\u8bae</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u4e8e\u673a\u5668\u5b66\u4e60\u4efb\u52a1\uff0c$\\delta = 0.01$ \u901a\u5e38\u8db3\u591f</li>\n<li>\u5bf9\u4e8e\u6570\u503c\u8ba1\u7b97\uff0c\u53ef\u80fd\u9700\u8981 $\\delta = 0.001$ \u6216\u66f4\u5c0f</li>\n<li>\u8003\u8651\u4efb\u52a1\u7279\u5b9a\u7684\u8bef\u5dee\u5bb9\u5fcd\u5ea6</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u975e\u5747\u5300\u91c7\u6837</strong>\uff1a\u6839\u636e\u6760\u6746\u5206\u6570\uff08leverage scores\uff09\u91c7\u6837\n$$\\ell_i = \\mathbf{u}_i^T (\\mathbf{U}\\mathbf{\\Lambda}\\mathbf{U}^T)^+ \\mathbf{u}_i$$\n\u5176\u4e2d $\\mathbf{u}_i$ \u662f\u7b2c $i$ \u884c\uff0c\u53ef\u4ee5\u9ad8\u6548\u8fd1\u4f3c\u8ba1\u7b97</li>\n</ol>\n<p><strong>\u6760\u6746\u5206\u6570\u7684\u610f\u4e49</strong>\uff1a</p>\n<ul>\n<li>\u8861\u91cf\u6bcf\u884c\u5bf9\u77e9\u9635\u6574\u4f53\u7ed3\u6784\u7684\"\u91cd\u8981\u6027\"</li>\n<li>\u9ad8\u6760\u6746\u5206\u6570\u7684\u884c\u9700\u8981\u66f4\u9ad8\u7684\u91c7\u6837\u6982\u7387</li>\n<li>\u4e0e\u77e9\u9635\u7684\u6761\u4ef6\u6570\u548c\u76f8\u5e72\u6027\u76f8\u5173</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li><strong>\u591a\u5c3a\u5ea6\u6295\u5f71</strong>\uff1a\n   ```\n   \u6784\u5efa\u6295\u5f71\u5c42\u6b21\uff1a\n   Level 0: \u4fdd\u7559\u6240\u6709\u4e3b\u6210\u5206\uff08\u524dr\u4e2a\uff09\n   Level 1: \u4e2d\u7b49\u538b\u7f29\uff08k = 2r\uff09\n   Level 2: \u9ad8\u5ea6\u538b\u7f29\uff08k = r + O(log n)\uff09</li>\n</ol>\n<p>\u6839\u636e\u67e5\u8be2\u9700\u6c42\u9009\u62e9\u5408\u9002\u7ea7\u522b\n   ```</p>\n<ol start=\"2\">\n<li><strong>\u6d41\u5f62\u611f\u77e5\u6295\u5f71</strong>\uff1a\n   \u5f53\u6570\u636e\u4f4d\u4e8e\u4f4e\u7ef4\u6d41\u5f62\u65f6\uff1a</li>\n</ol>\n<ul>\n<li>\u4f7f\u7528\u5c40\u90e8\u7ebf\u6027\u5d4c\u5165\uff08LLE\uff09\u6216Isomap\u8bc6\u522b\u6d41\u5f62\u7ed3\u6784</li>\n<li>\u5728\u5207\u7a7a\u95f4\u4e2d\u5e94\u7528JL\u6295\u5f71</li>\n<li>\u4fdd\u6301\u5c40\u90e8\u51e0\u4f55\u6027\u8d28</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u4efb\u52a1\u7279\u5b9a\u4f18\u5316</strong>\uff1a\n   - <strong>\u5206\u7c7b\u4efb\u52a1</strong>\uff1a\u4fdd\u7559\u7c7b\u95f4\u5dee\u5f02\u6700\u5927\u7684\u65b9\u5411\uff08LDA\u5f15\u5bfc\uff09\n   - <strong>\u805a\u7c7b\u4efb\u52a1</strong>\uff1a\u4fdd\u7559\u805a\u7c7b\u7ed3\u6784\u7684\u6295\u5f71\uff08\u8c31\u805a\u7c7b\u5f15\u5bfc\uff09\n   - <strong>\u56de\u5f52\u4efb\u52a1</strong>\uff1a\u4fdd\u7559\u4e0e\u76ee\u6807\u53d8\u91cf\u76f8\u5173\u6027\u9ad8\u7684\u65b9\u5411</li>\n</ol>\n<p><strong>\u5b9e\u9a8c\u9a8c\u8bc1\u7684\u8981\u70b9</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u51c6\u6d4b\u8bd5\u8bbe\u7f6e</strong>\uff1a\n   - \u5408\u6210\u6570\u636e\uff1a\u63a7\u5236\u79e9\u3001\u566a\u58f0\u6c34\u5e73\u3001\u76f8\u5e72\u6027\n   - \u771f\u5b9e\u6570\u636e\uff1a\u56fe\u50cf\uff08MNIST, CIFAR\uff09\u3001\u6587\u672c\uff0820NewsGroups\uff09\u3001\u57fa\u56e0\u7ec4\u6570\u636e\n   - \u8bc4\u4f30\u6307\u6807\uff1a\u8ddd\u79bb\u4fdd\u6301\u3001\u4e0b\u6e38\u4efb\u52a1\u6027\u80fd\u3001\u8ba1\u7b97\u65f6\u95f4</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u66f2\u7ebf</strong>\uff1a\n   - \u6295\u5f71\u7ef4\u5ea6 vs \u91cd\u6784\u8bef\u5dee\n   - \u6295\u5f71\u7ef4\u5ea6 vs \u4efb\u52a1\u7cbe\u5ea6\n   - \u6570\u636e\u89c4\u6a21 vs \u8ba1\u7b97\u65f6\u95f4</p>\n</li>\n<li>\n<p><strong>\u9c81\u68d2\u6027\u5206\u6790</strong>\uff1a\n   - \u5bf9\u566a\u58f0\u7684\u654f\u611f\u6027\n   - \u5bf9\u5f02\u5e38\u503c\u7684\u5904\u7406\n   - \u5bf9\u5206\u5e03\u6f02\u79fb\u7684\u9002\u5e94\u6027</p>\n</li>\n</ol>\n<h3 id=\"614\">6.1.4 \u5b9e\u7528\u6280\u5de7\u4e0e\u52a0\u901f</h3>\n<p><strong>\u5206\u5757\u8ba1\u7b97\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u5c06\u5927\u77e9\u9635A\u5206\u5757\u4e3a[A\u2081 A\u2082 ... A\u2098]\n\u5206\u522b\u8ba1\u7b97SA\u2081, SA\u2082, ..., SA\u2098\n\u5229\u7528\u7ebf\u6027\u6027\u8d28\u7ec4\u5408\u7ed3\u679c\n</code></pre></div>\n\n<p>\u8be6\u7ec6\u5b9e\u73b0\u8003\u8651\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5757\u5927\u5c0f\u9009\u62e9</strong>\uff1a\u5e73\u8861\u5185\u5b58\u5e26\u5bbd\u548c\u8ba1\u7b97\u5f3a\u5ea6\n   - CPU\uff1a\u5757\u5927\u5c0f \u2248 L3 cache\u5927\u5c0f / (sizeof(float) \u00d7 k)\n   - GPU\uff1a\u5757\u5927\u5c0f \u2248 \u5171\u4eab\u5185\u5b58\u5927\u5c0f / (sizeof(float) \u00d7 k)</p>\n</li>\n<li>\n<p><strong>\u6d41\u6c34\u7ebf\u5904\u7406</strong>\uff1a\n   - \u8bfb\u53d6\u5757 i+1 \u7684\u540c\u65f6\u8ba1\u7b97\u5757 i \u7684\u6295\u5f71\n   - \u4f7f\u7528\u53cc\u7f13\u51b2\u51cf\u5c11\u5185\u5b58\u7b49\u5f85</p>\n</li>\n<li>\n<p><strong>\u538b\u7f29\u4e2d\u95f4\u7ed3\u679c</strong>\uff1a\n   - \u5bf9\u6bcf\u4e2a $\\mathbf{S}\\mathbf{A}_i$ \u8fdb\u884c\u5728\u7ebf\u805a\u5408\n   - \u907f\u514d\u5b58\u50a8\u6240\u6709\u4e2d\u95f4\u7ed3\u679c</p>\n</li>\n</ol>\n<p><strong>GPU\u52a0\u901f\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u7ed3\u6784\u5316\u53d8\u6362\uff08\u5982SRHT\uff09\u4ee5\u5229\u7528FFT</li>\n<li>\u6279\u91cf\u77e9\u9635\u4e58\u6cd5\u7684\u5e76\u884c\u5316</li>\n<li>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97\u7684\u8bef\u5dee\u5206\u6790</li>\n</ul>\n<p>GPU\u4f18\u5316\u7ec6\u8282\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5185\u6838\u878d\u5408</strong>\uff1a\u5c06\u968f\u673a\u6570\u751f\u6210\u548c\u77e9\u9635\u4e58\u6cd5\u878d\u5408\n   <code>// \u4f2a\u4ee3\u7801\n   __global__ void fused_random_projection(A, S_seed, output) {\n     // \u5728\u7ebf\u751f\u6210S\u7684\u4e00\u884c\n     generate_random_row(S_row, S_seed, row_id);\n     // \u7acb\u5373\u8ba1\u7b97\u5185\u79ef\n     output[row_id] = dot_product(S_row, A[col_id]);\n   }</code></p>\n</li>\n<li>\n<p><strong>Tensor Core\u5229\u7528</strong>\uff08NVIDIA GPU\uff09\uff1a\n   - \u4f7f\u7528\u534a\u7cbe\u5ea6\u8fdb\u884c\u4e3b\u8981\u8ba1\u7b97\n   - \u5173\u952e\u7d2f\u52a0\u4f7f\u7528\u5355\u7cbe\u5ea6\n   - \u8bef\u5dee\u754c\u9650\uff1a$|\\mathbf{S}_{fp16}\\mathbf{x} - \\mathbf{S}_{fp32}\\mathbf{x}| \\leq O(\\sqrt{k}u)|\\mathbf{x}|$\n   \u5176\u4e2d $u$ \u662f\u673a\u5668\u7cbe\u5ea6</p>\n</li>\n<li>\n<p><strong>\u591a\u6d41\u5e76\u53d1</strong>\uff1a\n   - \u4e0d\u540c\u6570\u636e\u5757\u5728\u4e0d\u540cCUDA\u6d41\u4e0a\u5904\u7406\n   - \u91cd\u53e0\u8ba1\u7b97\u548c\u6570\u636e\u4f20\u8f93</p>\n</li>\n</ol>\n<h3 id=\"615\">6.1.5 \u8bef\u5dee\u5206\u6790\u7684\u7cbe\u7ec6\u5316</h3>\n<p><strong>\u5c3e\u90e8\u6982\u7387\u7684\u6539\u8fdb\u754c\u9650</strong>\uff1a\n$$\\Pr[||\\mathbf{S}\\mathbf{x}|^2 - |\\mathbf{x}|^2| &gt; \\epsilon|\\mathbf{x}|^2] \\leq 2\\exp\\left(-\\frac{k\\epsilon^2}{4-2\\epsilon/3}\\right)$$\n\u66f4\u7d27\u7684\u754c\u9650\uff08\u4f7f\u7528\u77e9\u9635Bernstein\u4e0d\u7b49\u5f0f\uff09\uff1a\n$$\\Pr[||\\mathbf{S}\\mathbf{x}|^2 - |\\mathbf{x}|^2| &gt; \\epsilon|\\mathbf{x}|^2] \\leq 2\\exp\\left(-\\frac{k\\epsilon^2/2}{1+\\epsilon/3}\\right)$$\n\u8fd9\u5728 $\\epsilon$ \u8f83\u5c0f\u65f6\u7ed9\u51fa\u66f4\u597d\u7684\u5e38\u6570\u3002</p>\n<p><strong>\u6709\u9650\u7cbe\u5ea6\u6548\u5e94</strong>\uff1a</p>\n<ul>\n<li>\u6d6e\u70b9\u8fd0\u7b97\u7684\u8bef\u5dee\u7d2f\u79ef</li>\n<li>\u6761\u4ef6\u6570\u5bf9\u7cbe\u5ea6\u7684\u5f71\u54cd</li>\n<li>\u6570\u503c\u7a33\u5b9a\u7684\u6b63\u4ea4\u5316\u6280\u672f</li>\n</ul>\n<p>\u8be6\u7ec6\u5206\u6790\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8bef\u5dee\u4f20\u64ad\u6a21\u578b</strong>\uff1a\n   \u8bbe\u6d6e\u70b9\u8fd0\u7b97\u8bef\u5dee\u4e3a $u$\uff08\u901a\u5e38 $u \\approx 10^{-7}$ for float32\uff09\uff0c\u5219\uff1a\n$$|\\tilde{\\mathbf{S}}\\mathbf{x} - \\mathbf{S}\\mathbf{x}| \\leq C\\sqrt{kd}u|\\mathbf{S}||\\mathbf{x}|$$\n\u5176\u4e2d $C$ \u662f\u4e0e\u5177\u4f53\u5b9e\u73b0\u76f8\u5173\u7684\u5e38\u6570\uff08\u901a\u5e38 $C \\in [1, 10]$\uff09\u3002</p>\n</li>\n<li>\n<p><strong>\u6761\u4ef6\u6570\u7684\u5f71\u54cd</strong>\uff1a\n   - \u5bf9\u4e8e\u7ed3\u6784\u5316\u77e9\u9635\uff08\u5982SRHT\uff09\uff0c\u6761\u4ef6\u6570\u6709\u754c\uff1a$\\kappa(\\mathbf{S}) = O(\\sqrt{d/k})$ w.h.p.\n   - \u5bf9\u4e8e\u9ad8\u65af\u968f\u673a\u77e9\u9635\uff0c$\\kappa(\\mathbf{S}) = O(\\sqrt{d/k} + \\sqrt{k/d})$ w.h.p.</p>\n</li>\n<li>\n<p><strong>\u7a33\u5b9a\u6027\u589e\u5f3a\u6280\u672f</strong>\uff1a\n   - <strong>Kahan\u6c42\u548c</strong>\uff1a\u51cf\u5c11\u7d2f\u52a0\u8bef\u5dee\n   - <strong>\u5206\u5757\u6b63\u4ea4\u5316</strong>\uff1a\u907f\u514d\u5927\u89c4\u6a21Gram-Schmidt\u7684\u6570\u503c\u95ee\u9898\n   - <strong>\u8fed\u4ee3\u7cbe\u5316</strong>\uff1a\u5bf9\u5173\u952e\u8ba1\u7b97\u4f7f\u7528\u9ad8\u7cbe\u5ea6\u9a8c\u8bc1</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u7528\u8bef\u5dee\u4f30\u8ba1</strong>\uff1a\n\u7ed9\u5b9a\u76ee\u6807\u7cbe\u5ea6 $\\epsilon_{target}$\uff0c\u9009\u62e9\uff1a</p>\n<ul>\n<li>\u6295\u5f71\u7ef4\u5ea6\uff1a$k \\geq C_1 \\log(n/\\delta) / \\epsilon_{target}^2$</li>\n<li>\u6570\u503c\u7cbe\u5ea6\uff1a\u786e\u4fdd $\\sqrt{kd}u \\ll \\epsilon_{target}$</li>\n<li>\u5176\u4e2d $\\delta$ \u662f\u5931\u8d25\u6982\u7387\uff0c$C_1 \\approx 8$ \u5728\u5b9e\u8df5\u4e2d\u6548\u679c\u826f\u597d</li>\n</ul>\n<h3 id=\"616\">6.1.6 \u7814\u7a76\u524d\u6cbf</h3>\n<p><strong>\u6700\u4f18\u6027\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u4e8e\u7279\u5b9a\u77e9\u9635\u7c7b\uff0cJL\u754c\u9650\u662f\u5426\u53ef\u4ee5\u6539\u8fdb\uff1f</li>\n<li>\u6570\u636e\u76f8\u5173\u7684\u6295\u5f71\u662f\u5426\u603b\u662f\u4f18\u4e8e\u6570\u636e\u65e0\u5173\u7684\uff1f</li>\n</ul>\n<p>\u5f00\u653e\u7814\u7a76\u95ee\u9898\uff1a</p>\n<ol>\n<li><strong>\u4e0b\u754c\u7684\u7d27\u81f4\u6027</strong>\uff1aLarsen &amp; Nelson (2017) \u8bc1\u660e\u4e86 $k = \\Omega(\\log n / \\epsilon^2)$ \u7684\u4e0b\u754c\uff0c\u4f46\u5e38\u6570\u56e0\u5b50\u4ecd\u6709\u6539\u8fdb\u7a7a\u95f4</li>\n<li><strong>\u7ed3\u6784\u5316\u6570\u636e\u7684\u7279\u6b8a\u754c\u9650</strong>\uff1a\n   - \u7a00\u758f\u5411\u91cf\uff1a\u53ef\u5426\u5229\u7528\u7a00\u758f\u6027\u964d\u4f4e\u7ef4\u5ea6\uff1f\n   - \u4f4e\u79e9+\u7a00\u758f\uff1a\u5982\u4f55\u8bbe\u8ba1\u6700\u4f18\u6295\u5f71\uff1f</li>\n<li><strong>\u81ea\u9002\u5e94vs\u975e\u81ea\u9002\u5e94</strong>\uff1a\u8bc1\u660e\u6216\u53cd\u9a73\u81ea\u9002\u5e94\u65b9\u6cd5\u7684\u4e25\u683c\u4f18\u8d8a\u6027</li>\n</ol>\n<p><strong>\u91cf\u5b50JL\u53d8\u6362</strong>\uff1a</p>\n<ul>\n<li>\u5229\u7528\u91cf\u5b50\u53e0\u52a0\u5b9e\u73b0\u6307\u6570\u52a0\u901f</li>\n<li>\u7ecf\u5178\u6a21\u62df\u7684\u53ef\u80fd\u6027\u4e0e\u9650\u5236</li>\n</ul>\n<p>\u91cf\u5b50\u4f18\u52bf\u7684\u6f5c\u5728\u6765\u6e90\uff1a</p>\n<ol>\n<li><strong>\u632f\u5e45\u7f16\u7801</strong>\uff1a\u5c06 $d$ \u7ef4\u5411\u91cf\u7f16\u7801\u5728 $\\log d$ \u4e2a\u91cf\u5b50\u6bd4\u7279\u4e2d</li>\n<li><strong>\u5e76\u884c\u5185\u79ef\u8ba1\u7b97</strong>\uff1a\u91cf\u5b50\u53e0\u52a0\u5141\u8bb8\u540c\u65f6\u8ba1\u7b97\u591a\u4e2a\u6295\u5f71</li>\n<li><strong>\u6d4b\u91cf\u540e\u9009\u62e9</strong>\uff1a\u9009\u62e9\u6027\u5730\u4fdd\u7559\u597d\u7684\u6295\u5f71\u7ed3\u679c</li>\n</ol>\n<p>\u6311\u6218\u4e0e\u673a\u9047\uff1a</p>\n<ul>\n<li>\u91cf\u5b50\u566a\u58f0\u5bf9JL\u4fdd\u8bc1\u7684\u5f71\u54cd</li>\n<li>NISQ\u8bbe\u5907\u4e0a\u7684\u5b9e\u73b0\u53ef\u80fd\u6027</li>\n<li>\u7ecf\u5178\u7b97\u6cd5\u501f\u9274\u91cf\u5b50\u601d\u60f3\uff08\u5982\u5f20\u91cf\u7f51\u7edc\u65b9\u6cd5\uff09</li>\n</ul>\n<p><strong>\u65b0\u5174\u5e94\u7528\u9a71\u52a8\u7684\u7406\u8bba\u53d1\u5c55</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8054\u90a6\u5b66\u4e60\u4e2d\u7684\u9690\u79c1\u4fdd\u62a4\u6295\u5f71</strong>\uff1a\n   - \u8bbe\u8ba1\u6ee1\u8db3\u5dee\u5206\u9690\u79c1\u7684JL\u53d8\u6362\n   - \u9690\u79c1-\u6548\u7528\u6743\u8861\u7684\u6700\u4f18\u5316</p>\n</li>\n<li>\n<p><strong>\u795e\u7ecf\u7f51\u7edc\u67b6\u6784\u641c\u7d22</strong>\uff1a\n   - \u4f7f\u7528JL\u52a0\u901f\u67b6\u6784\u8bc4\u4f30\n   - \u4fdd\u6301\u68af\u5ea6\u4fe1\u606f\u7684\u6295\u5f71\u8bbe\u8ba1</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u51b3\u7b56\u4e2d\u7684\u7ef4\u5ea6\u7ea6\u7b80</strong>\uff1a\n   - \u540e\u6094\u754c\u4e0e\u6295\u5f71\u7ef4\u5ea6\u7684\u5173\u7cfb\n   - \u81ea\u9002\u5e94\u7ef4\u5ea6\u9009\u62e9\u7684bandit\u7b97\u6cd5</p>\n</li>\n</ol>\n<h2 id=\"62-countsketch\">6.2 CountSketch\u4e0e\u968f\u673a\u6295\u5f71</h2>\n<h3 id=\"621-countsketch\">6.2.1 CountSketch\u7684\u6838\u5fc3\u601d\u60f3</h3>\n<p>CountSketch\u901a\u8fc7\u54c8\u5e0c\u51fd\u6570\u5c06\u9ad8\u7ef4\u5411\u91cf\u6620\u5c04\u5230\u4f4e\u7ef4\u7a7a\u95f4\uff1a</p>\n<p><strong>\u57fa\u672c\u6784\u9020</strong>\uff1a</p>\n<ul>\n<li>\u54c8\u5e0c\u51fd\u6570\uff1a$h: [d] \\rightarrow [k]$</li>\n<li>\u7b26\u53f7\u51fd\u6570\uff1a$s: [d] \\rightarrow {-1, +1}$</li>\n<li>Sketch\u5411\u91cf\uff1a$\\mathbf{y}_j = \\sum_{i: h(i)=j} s(i) \\mathbf{x}_i$</li>\n</ul>\n<p><strong>\u77e9\u9635\u5f62\u5f0f</strong>\uff1a\n$$\\mathbf{S} = \\mathbf{\\Phi} \\mathbf{D}$$\n\u5176\u4e2d $\\mathbf{\\Phi}$ \u662f\u91c7\u6837\u77e9\u9635\uff0c$\\mathbf{D}$ \u662f\u968f\u673a\u7b26\u53f7\u5bf9\u89d2\u77e9\u9635\u3002</p>\n<p><strong>\u4e3a\u4ec0\u4e48\u9700\u8981\u7b26\u53f7\u51fd\u6570\uff1f</strong>\n\u7b26\u53f7\u51fd\u6570 $s$ \u7684\u4f5c\u7528\u662f\u6253\u7834\u5bf9\u79f0\u6027\uff0c\u907f\u514d\u7cfb\u7edf\u6027\u504f\u5dee\uff1a</p>\n<ul>\n<li>\u6ca1\u6709\u7b26\u53f7\u51fd\u6570\uff1a\u54c8\u5e0c\u78b0\u649e\u603b\u662f\u5bfc\u81f4\u6b63\u5411\u53e0\u52a0</li>\n<li>\u6709\u7b26\u53f7\u51fd\u6570\uff1a\u78b0\u649e\u7684\u671f\u671b\u8d21\u732e\u4e3a\u96f6\uff0c$\\mathbb{E}[s(i)s(j)] = 0$ for $i \\neq j$</li>\n</ul>\n<p><strong>\u4e0eJL\u7684\u5173\u7cfb</strong>\uff1a\nCountSketch\u53ef\u4ee5\u770b\u4f5c\u6781\u5ea6\u7a00\u758f\u7684JL\u53d8\u6362\uff1a</p>\n<ul>\n<li>JL\uff1a\u6bcf\u4e2a\u8f93\u51fa\u5750\u6807\u4f9d\u8d56\u6240\u6709\u8f93\u5165\u5750\u6807</li>\n<li>CountSketch\uff1a\u6bcf\u4e2a\u8f93\u51fa\u5750\u6807\u53ea\u4f9d\u8d56 $O(d/k)$ \u4e2a\u8f93\u5165\u5750\u6807</li>\n<li>\u6743\u8861\uff1a\u66f4\u5feb\u7684\u8ba1\u7b97 vs \u7565\u5dee\u7684\u6d53\u5ea6\u6027\u8d28</li>\n</ul>\n<p><strong>\u7406\u8bba\u76f4\u89c9</strong>\uff1a\n\u8003\u8651sketch\u7684\u7b2c $j$ \u4e2a\u5750\u6807\uff1a\n$$\\mathbf{y}_j = \\sum_{i: h(i)=j} s(i) \\mathbf{x}_i = s(i_0)\\mathbf{x}_{i_0} + \\sum_{i \\neq i_0, h(i)=j} s(i) \\mathbf{x}_i$$\n\u7b2c\u4e00\u9879\u662f\"\u4fe1\u53f7\"\uff0c\u7b2c\u4e8c\u9879\u662f\"\u566a\u58f0\"\u3002\u901a\u8fc7\u968f\u673a\u7b26\u53f7\uff0c\u566a\u58f0\u9879\u7684\u671f\u671b\u4e3a\u96f6\uff0c\u65b9\u5dee\u4e0e\u78b0\u649e\u6570\u91cf\u6210\u6b63\u6bd4\u3002</p>\n<h3 id=\"622\">6.2.2 \u7406\u8bba\u4fdd\u8bc1\u4e0e\u4f18\u5316</h3>\n<p><strong>\u57fa\u672c\u4fdd\u8bc1</strong>\uff1a\n$$\\mathbb{E}[|\\mathbf{S}\\mathbf{x}|^2] = |\\mathbf{x}|^2$$\n$$\\text{Var}[|\\mathbf{S}\\mathbf{x}|^2] \\leq \\frac{2}{k}|\\mathbf{x}|^4$$\n\u66f4\u7cbe\u786e\u7684\u5206\u6790\u663e\u793a\uff1a\n$$\\Pr[||\\mathbf{S}\\mathbf{x}|^2 - |\\mathbf{x}|^2| &gt; \\epsilon|\\mathbf{x}|^2] \\leq \\frac{2}{k\\epsilon^2}$$\n\u8fd9\u6bd4JL\u7684\u6307\u6570\u754c\u9650\u5f31\uff0c\u4f46CountSketch\u7684\u8ba1\u7b97\u901f\u5ea6\u5feb\u5f97\u591a\u3002</p>\n<p><strong>\u6539\u8fdb\u7684CountSketch</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u591a\u4e2a\u72ec\u7acb\u54c8\u5e0c\u51fd\u6570</li>\n<li>\u4e2d\u503c\u4f30\u8ba1\u5668\u63d0\u9ad8\u9c81\u68d2\u6027</li>\n<li>\u5206\u5c42\u54c8\u5e0c\u51cf\u5c11\u78b0\u649e</li>\n</ul>\n<p><strong>\u591a\u54c8\u5e0c\u51fd\u6570\u8bbe\u8ba1</strong>\uff1a\n\u4f7f\u7528 $t$ \u4e2a\u72ec\u7acb\u7684\u54c8\u5e0c\u51fd\u6570\u5bf9\uff1a$(h_1, s_1), ..., (h_t, s_t)$</p>\n<ol>\n<li>\n<p><strong>\u5e76\u884c\u7248\u672c</strong>\uff1a\u6bcf\u4e2a\u54c8\u5e0c\u4ea7\u751f\u72ec\u7acb\u7684sketch\n   - \u4f18\u70b9\uff1a\u5b8c\u5168\u5e76\u884c\uff0c\u7406\u8bba\u5206\u6790\u7b80\u5355\n   - \u7f3a\u70b9\uff1a\u5b58\u50a8\u5f00\u9500 $O(tk)$</p>\n</li>\n<li>\n<p><strong>\u7279\u5f81\u54c8\u5e0c(Feature Hashing)</strong>\uff1a\u5171\u4eab\u540c\u4e00\u4e2a\u8f93\u51fa\u7a7a\u95f4\n   <code>for i in 1:d\n     for j in 1:t\n       output[h_j(i)] += s_j(i) * x[i] / sqrt(t)</code></p>\n</li>\n</ol>\n<ul>\n<li>\u4f18\u70b9\uff1a\u5b58\u50a8\u4ec5 $O(k)$</li>\n<li>\u7f3a\u70b9\uff1a\u54c8\u5e0c\u95f4\u53ef\u80fd\u76f8\u4e92\u5e72\u6270</li>\n</ul>\n<p><strong>\u4e2d\u503c\u4f30\u8ba1\u7684\u5a01\u529b</strong>\uff1a\n\u5bf9\u4e8e $t$ \u4e2a\u72ec\u7acb\u4f30\u8ba1 $\\tilde{x}_1, ..., \\tilde{x}_t$\uff1a</p>\n<ul>\n<li>\u5747\u503c\u4f30\u8ba1\uff1a$\\text{Var}[\\text{mean}] = O(1/tk)$</li>\n<li>\u4e2d\u503c\u4f30\u8ba1\uff1a\u5c3e\u90e8\u6982\u7387 $\\exp(-\\Omega(t))$</li>\n</ul>\n<p>\u4e2d\u503c\u7279\u522b\u9002\u5408\u5904\u7406heavy-tailed\u5206\u5e03\u6216\u5b58\u5728\u5f02\u5e38\u503c\u7684\u60c5\u51b5\u3002</p>\n<h3 id=\"623\">6.2.3 \u77e9\u9635\u4e58\u6cd5\u7684\u52a0\u901f</h3>\n<p><strong>\u8fd1\u4f3c\u77e9\u9635\u4e58\u79ef</strong>\uff1a\n$$\\mathbf{A}\\mathbf{B} \\approx (\\mathbf{S}_A\\mathbf{A})^T(\\mathbf{S}_B\\mathbf{B})$$\n\u590d\u6742\u5ea6\uff1a$O(nnz(\\mathbf{A}) + nnz(\\mathbf{B}) + k^2n)$ vs $O(n^3)$</p>\n<p><strong>\u8bef\u5dee\u754c\u9650</strong>\uff1a\n$$|\\mathbf{A}\\mathbf{B} - \\tilde{\\mathbf{A}}\\tilde{\\mathbf{B}}|_F \\leq \\epsilon|\\mathbf{A}|_F|\\mathbf{B}|_F$$\n\u5f53 $k = O(1/\\epsilon^2)$ \u65f6\u4ee5\u9ad8\u6982\u7387\u6210\u7acb\u3002</p>\n<p><strong>\u66f4\u7d27\u7684\u5206\u6790\uff08Clarkson &amp; Woodruff, 2013\uff09</strong>\uff1a\n\u5bf9\u4e8e\u79e9\u4e3a $r$ \u7684\u77e9\u9635\u4e58\u79ef\uff1a\n$$|\\mathbf{A}\\mathbf{B} - \\tilde{\\mathbf{A}}\\tilde{\\mathbf{B}}|_F \\leq \\epsilon|\\mathbf{A}|_F|\\mathbf{B}|_F$$\n\u5f53 $k = O(r/\\epsilon^2)$ \u65f6\u6210\u7acb\u3002\u8fd9\u8868\u660esketch\u5927\u5c0f\u53ef\u4ee5\u9002\u5e94\u95ee\u9898\u7684\u5185\u5728\u7ef4\u5ea6\u3002</p>\n<p><strong>\u9ad8\u7ea7\u6280\u5de7\uff1aTensorSketch</strong>\n\u5bf9\u4e8e\u4e09\u4e2a\u6216\u66f4\u591a\u77e9\u9635\u7684\u4e58\u79ef\uff0c\u4f7f\u7528TensorSketch\u907f\u514d\u4e2d\u95f4\u5c55\u5f00\uff1a\n$$\\mathbf{A} \\otimes \\mathbf{B} \\approx \\text{FFT}^{-1}(\\text{FFT}(\\mathbf{S}_A\\mathbf{A}) \\odot \\text{FFT}(\\mathbf{S}_B\\mathbf{B}))$$\n\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u907f\u514d\u663e\u5f0f\u6784\u9020Kronecker\u79ef</li>\n<li>\u5229\u7528FFT\u5c06\u590d\u6742\u5ea6\u964d\u81f3 $O(k \\log k)$</li>\n<li>\u4fdd\u6301\u76f8\u540c\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n</ul>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u573a\u666f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6838\u65b9\u6cd5\u52a0\u901f</strong>\uff1a\n   - \u591a\u9879\u5f0f\u6838\uff1a$K(x,y) = (x^T y + c)^d$\n   - \u4f7f\u7528TensorSketch\u8fd1\u4f3c\u9ad8\u9636\u7279\u5f81\u6620\u5c04\n   - \u590d\u6742\u5ea6\u4ece $O(d^p)$ \u964d\u81f3 $O(k \\log k)$</p>\n</li>\n<li>\n<p><strong>\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u5e94\u7528</strong>\uff1a\n   - \u52a0\u901f\u5168\u8fde\u63a5\u5c42\uff1a$\\mathbf{W}\\mathbf{x} \\approx (\\mathbf{S}_W\\mathbf{W})^T(\\mathbf{S}_x\\mathbf{x})$\n   - \u6ce8\u610f\u529b\u673a\u5236\uff1a\u8fd1\u4f3c $\\mathbf{Q}\\mathbf{K}^T$\n   - \u53c2\u6570\u6548\u7387\uff1a\u5b58\u50a8sketch\u800c\u975e\u5b8c\u6574\u6743\u91cd</p>\n</li>\n</ol>\n<h3 id=\"624\">6.2.4 \u7a00\u758f\u6062\u590d\u4e0e\u538b\u7f29\u611f\u77e5</h3>\n<p><strong>\u4e0e\u538b\u7f29\u611f\u77e5\u7684\u8054\u7cfb</strong>\uff1a</p>\n<ul>\n<li>CountSketch\u4f5c\u4e3a\u6d4b\u91cf\u77e9\u9635</li>\n<li>RIP\u6027\u8d28\u7684\u9a8c\u8bc1</li>\n<li>\u7a00\u758f\u4fe1\u53f7\u7684\u7cbe\u786e\u6062\u590d\u6761\u4ef6</li>\n</ul>\n<p><strong>Heavy Hitters\u95ee\u9898</strong>\uff1a\n\u627e\u51fa\u5411\u91cf\u4e2d\u6700\u5927\u7684 $k$ \u4e2a\u5143\u7d20</p>\n<ul>\n<li>CountSketch\u7684\u81ea\u7136\u5e94\u7528</li>\n<li>\u8bef\u5dee\u4fdd\u8bc1\uff1a$|\\mathbf{x} - \\hat{\\mathbf{x}}|_2 \\leq \\epsilon|\\mathbf{x}_{-k}|_2$</li>\n</ul>\n<p><strong>CountSketch\u7684RIP\u6027\u8d28</strong>\uff1a\n\u5bf9\u4e8e $s$-\u7a00\u758f\u5411\u91cf\uff0cCountSketch\u6ee1\u8db3\u9650\u5236\u7b49\u8ddd\u6027\u8d28(RIP)\uff1a\n$$(1-\\delta)|\\mathbf{x}|_2^2 \\leq |\\mathbf{S}\\mathbf{x}|_2^2 \\leq (1+\\delta)|\\mathbf{x}|_2^2$$\n\u5f53 $k = O(s \\log(d/s) / \\delta^2)$ \u65f6\uff0c\u4ee5\u9ad8\u6982\u7387\u6210\u7acb\u3002</p>\n<p><strong>\u7a00\u758f\u6062\u590d\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>CountMin-Sketch\u6062\u590d</strong>\uff1a\n   <code>for each potential heavy hitter i:\n     estimate[i] = median over t sketches of:\n       sign(s_j(i)) * sketch_j[h_j(i)]</code></p>\n</li>\n<li>\n<p><strong>\u8fed\u4ee3\u6062\u590d\uff08\u7a00\u758f\u8ffd\u8e2a\uff09</strong>\uff1a\n   - \u8bc6\u522b\u6700\u5927\u5750\u6807\n   - \u4ecesketch\u4e2d\u51cf\u53bb\u5176\u8d21\u732e\n   - \u91cd\u590d\u76f4\u5230\u6062\u590d $k$ \u4e2a\u5143\u7d20</p>\n</li>\n</ol>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1\u7684\u7cbe\u7ec6\u5316</strong>\uff1a</p>\n<ul>\n<li>$\\ell_2/\\ell_2$ \u4fdd\u8bc1\uff1a$|\\mathbf{x} - \\hat{\\mathbf{x}}|_2 \\leq (1+\\epsilon)|\\mathbf{x}_{-k}|_2$</li>\n<li>$\\ell_\\infty/\\ell_2$ \u4fdd\u8bc1\uff1a$|\\mathbf{x} - \\hat{\\mathbf{x}}|_\\infty \\leq \\epsilon|\\mathbf{x}_{-k}|_2/\\sqrt{k}$</li>\n<li>\u8fd9\u4e9b\u754c\u9650\u5728 $k = O(\\log d / \\epsilon^2)$ \u65f6\u6210\u7acb</li>\n</ul>\n<p><strong>\u5b9e\u9645\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u81ea\u9002\u5e94\u9608\u503c</strong>\uff1a\u52a8\u6001\u8c03\u6574heavy hitter\u7684\u68c0\u6d4b\u9608\u503c</li>\n<li><strong>\u5206\u5c42\u7ed3\u6784</strong>\uff1a\u4f7f\u7528dyadic tree\u5904\u7406\u4e0d\u540c\u5c3a\u5ea6\u7684\u5143\u7d20</li>\n<li><strong>\u5e76\u884c\u6062\u590d</strong>\uff1a\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u6062\u590d\u4e0d\u540c\u8303\u56f4\u7684\u5750\u6807</li>\n</ol>\n<h3 id=\"625-countsketch\">6.2.5 \u5206\u5e03\u5f0fCountSketch</h3>\n<p><strong>MapReduce\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">Map</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"err\">\u5bf9\u6bcf\u4e2a\u6570\u636e\u70b9\u8ba1\u7b97\u5c40\u90e8</span><span class=\"n\">sketch</span>\n<span class=\"n\">Reduce</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"err\">\u5408\u5e76\u76f8\u540c\u54c8\u5e0c\u4f4d\u7f6e\u7684\u503c</span>\n</code></pre></div>\n\n<p><strong>\u901a\u4fe1\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6bcf\u4e2a\u8282\u70b9\u53d1\u9001 $O(k)$ \u6570\u636e</li>\n<li>\u603b\u901a\u4fe1\u91cf\uff1a$O(pk)$\uff0c\u5176\u4e2d $p$ \u662f\u8282\u70b9\u6570</li>\n<li>\u4e0e\u5168\u901a\u4fe1 $O(pd)$ \u76f8\u6bd4\u7684\u8282\u7701</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u5206\u5e03\u5f0f\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5c42\u805a\u5408</strong>\uff1a\n   <code>Level 0: \u6bcf\u4e2aworker\u8ba1\u7b97\u5c40\u90e8sketch\n   Level 1: \u7ec4\u5185\u805a\u5408\uff08\u5982\u673a\u67b6\u5185\uff09\n   Level 2: \u8de8\u7ec4\u805a\u5408\n   ...\n   Level log p: \u5168\u5c40\u805a\u5408</code>\n   \u4f18\u52bf\uff1a\u51cf\u5c11\u8de8\u6570\u636e\u4e2d\u5fc3\u901a\u4fe1\uff0c\u603b\u901a\u4fe1 $O(k \\log p)$</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0</strong>\uff1a\n   - Worker\u63a8\u9001\u589e\u91cf\u66f4\u65b0\u800c\u975e\u5b8c\u6574sketch\n   - \u53c2\u6570\u670d\u52a1\u5668\u7ef4\u62a4\u5168\u5c40sketch\n   - \u5bb9\u5fcd\u6709\u754c\u7684\u5ef6\u8fdf\uff1a$|\\mathbf{S}_{delay} - \\mathbf{S}_{current}| \\leq \\tau$</p>\n</li>\n<li>\n<p><strong>\u538b\u7f29\u901a\u4fe1</strong>\uff1a\n   - \u53ea\u53d1\u9001sketch\u7684\u975e\u96f6\u9879\n   - \u4f7f\u7528\u5dee\u5206\u7f16\u7801\uff1a$\\Delta\\mathbf{S}_t = \\mathbf{S}_t - \\mathbf{S}_{t-1}$\n   - \u91cf\u5316\uff1a\u5c06\u6d6e\u70b9\u6570\u6620\u5c04\u5230\u6709\u9650\u7cbe\u5ea6</p>\n</li>\n</ol>\n<p><strong>\u5bb9\u9519\u6027\u8bbe\u8ba1</strong>\uff1a</p>\n<ul>\n<li><strong>\u5197\u4f59\u8ba1\u7b97</strong>\uff1a\u6bcf\u4e2a\u6570\u636e\u5206\u7247\u7531\u591a\u4e2a\u8282\u70b9\u5904\u7406</li>\n<li><strong>Checkpoint\u673a\u5236</strong>\uff1a\u5468\u671f\u6027\u4fdd\u5b58sketch\u72b6\u6001</li>\n<li><strong>\u62dc\u5360\u5ead\u9c81\u68d2\u6027</strong>\uff1a\u4f7f\u7528\u4e2d\u503c\u800c\u975e\u5747\u503c\u805a\u5408</li>\n</ul>\n<p><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a\n\u5728\u5f02\u6b65\u8bbe\u7f6e\u4e0b\uff0c\u5982\u679c\u5ef6\u8fdf\u6709\u754c $\\tau$\uff0c\u5219\u8bef\u5dee\u754c\u53d8\u4e3a\uff1a\n$$|\\mathbf{x} - \\hat{\\mathbf{x}}|_2 \\leq \\epsilon|\\mathbf{x}_{-k}|_2 + O(\\tau/\\sqrt{k})$$\n\u8fd9\u8868\u660e\u9002\u5ea6\u7684\u5f02\u6b65\u4e0d\u4f1a\u663e\u8457\u635f\u5bb3\u7cbe\u5ea6\u3002</p>\n<h3 id=\"626\">6.2.6 \u5b9e\u9645\u5e94\u7528\u4e2d\u7684\u6280\u5de7</h3>\n<p><strong>\u52a8\u6001\u66f4\u65b0</strong>\uff1a</p>\n<ul>\n<li>\u6d41\u5f0f\u6570\u636e\u7684\u589e\u91cf\u66f4\u65b0</li>\n<li>\u6ed1\u52a8\u7a97\u53e3\u7684\u9ad8\u6548\u7ef4\u62a4</li>\n<li>\u65f6\u95f4\u8870\u51cf\u7684sketch</li>\n</ul>\n<p><strong>\u6ed1\u52a8\u7a97\u53e3CountSketch</strong>\uff1a\n\u7ef4\u62a4\u6700\u8fd1 $W$ \u4e2a\u65f6\u95f4\u6b65\u7684sketch\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u5faa\u73af\u7f13\u51b2\u533a\u5b58\u50a8\u6bcf\u4e2a\u65f6\u95f4\u6b65\u7684\u589e\u91cf\n\u66f4\u65b0\u65f6\uff1a\n  - \u6dfb\u52a0\u65b0\u65f6\u95f4\u6b65\u7684\u8d21\u732e\n  - \u51cf\u53bb\u6700\u65e7\u65f6\u95f4\u6b65\u7684\u8d21\u732e\n  - \u66f4\u65b0\u6307\u9488\n</code></pre></div>\n\n<p><strong>\u6307\u6570\u8870\u51cf\u53d8\u4f53</strong>\uff1a\n$$\\mathbf{S}_t = \\alpha \\mathbf{S}_{t-1} + \\mathbf{S}(\\mathbf{x}_t)$$\n\u5176\u4e2d $\\alpha \\in (0,1)$ \u63a7\u5236\u5386\u53f2\u6570\u636e\u7684\u8870\u51cf\u901f\u5ea6\u3002</p>\n<p><strong>\u5185\u5b58\u5e03\u5c40\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>Cache\u53cb\u597d\u7684\u54c8\u5e0c\u51fd\u6570\u8bbe\u8ba1</li>\n<li>SIMD\u52a0\u901f\u7684\u5411\u91cf\u5316\u5b9e\u73b0</li>\n<li>\u907f\u514dfalse sharing\u7684\u6570\u636e\u7ed3\u6784</li>\n</ul>\n<p><strong>\u5177\u4f53\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u54c8\u5e0c\u51fd\u6570\u9009\u62e9</strong>\uff1a\n   - MurmurHash3\uff1a\u5feb\u901f\u4e14\u5206\u5e03\u5747\u5300\n   - TabHash\uff1a\u4f7f\u7528\u67e5\u8868\u907f\u514d\u4e58\u6cd5\n   - 2-universal family\uff1a\u7406\u8bba\u4fdd\u8bc1+\u5b9e\u9645\u6548\u7387</p>\n</li>\n<li>\n<p><strong>SIMD\u5b9e\u73b0</strong>\uff1a\n   <code>cpp\n   // \u4f7f\u7528AVX2\u5904\u74068\u4e2a\u5143\u7d20\n   __m256 signs = _mm256_load_ps(sign_table + i);\n   __m256 values = _mm256_load_ps(input + i);\n   __m256 products = _mm256_mul_ps(signs, values);\n   // \u7d2f\u52a0\u5230\u76f8\u5e94\u7684sketch\u4f4d\u7f6e</code></p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u5bf9\u9f50</strong>\uff1a\n   - Sketch\u6570\u7ec4\u6309cache line (64\u5b57\u8282)\u5bf9\u9f50\n   - \u4f7f\u7528padding\u907f\u514dfalse sharing\n   - \u9884\u53d6(prefetch)\u5373\u5c06\u8bbf\u95ee\u7684\u6570\u636e</p>\n</li>\n</ol>\n<p><strong>\u6027\u80fd\u8c03\u4f18\u6e05\u5355</strong>\uff1a</p>\n<ul>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684\u54c8\u5e0c\u51fd\u6570\u65cf</li>\n<li>[ ] \u5b9e\u73b0SIMD\u52a0\u901f\u7248\u672c</li>\n<li>[ ] \u4f18\u5316\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>[ ] \u4f7f\u7528\u65e0\u9501\u6570\u636e\u7ed3\u6784\uff08\u5982\u53ef\u80fd\uff09</li>\n<li>[ ] Profile\u70ed\u70b9\u5e76\u9488\u5bf9\u6027\u4f18\u5316</li>\n</ul>\n<h2 id=\"63-frequent-directions\">6.3 Frequent Directions\u7b97\u6cd5</h2>\n<h3 id=\"631\">6.3.1 \u7b97\u6cd5\u52a8\u673a\u4e0e\u8bbe\u8ba1</h3>\n<p>Frequent Directions (FD) \u662f\u77e9\u9635sketching\u7684\"\u6700\u4f18\"\u7b97\u6cd5\uff0c\u7c7b\u4f3c\u4e8eMisra-Gries\u7b97\u6cd5\u5728\u9891\u7e41\u9879\u95ee\u9898\u4e2d\u7684\u5730\u4f4d\u3002</p>\n<p><strong>\u6838\u5fc3\u601d\u60f3</strong>\uff1a\n\u7ef4\u62a4\u4e00\u4e2a\u4f4e\u79e9\u8fd1\u4f3c $\\mathbf{B} \\in \\mathbb{R}^{k \\times d}$\uff0c\u4f7f\u5f97\uff1a\n$$\\mathbf{B}^T\\mathbf{B} \\approx \\mathbf{A}^T\\mathbf{A}$$\n<strong>\u7b97\u6cd5\u6d41\u7a0b</strong>\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\uff1a$\\mathbf{B} = \\mathbf{0}$</li>\n<li>\u5bf9\u6bcf\u4e2a\u65b0\u884c $\\mathbf{a}_t$\uff1a\n   - \u6dfb\u52a0\u5230 $\\mathbf{B}$\uff1a$\\mathbf{B} \\leftarrow [\\mathbf{B}; \\mathbf{a}_t]$\n   - \u8ba1\u7b97SVD\uff1a$\\mathbf{B} = \\mathbf{U}\\mathbf{\\Sigma}\\mathbf{V}^T$\n   - \u6536\u7f29\uff1a$\\sigma_i \\leftarrow \\sqrt{\\max(0, \\sigma_i^2 - \\sigma_k^2)}$\n   - \u4fdd\u7559\u524d $k-1$ \u884c</li>\n</ol>\n<h3 id=\"632\">6.3.2 \u7406\u8bba\u6027\u8d28</h3>\n<p><strong>\u8c31\u8303\u6570\u4fdd\u8bc1</strong>\uff1a\n$$|\\mathbf{A}^T\\mathbf{A} - \\mathbf{B}^T\\mathbf{B}|_2 \\leq \\frac{1}{k}|\\mathbf{A} - \\mathbf{A}_k|_F^2$$\n\u5176\u4e2d $\\mathbf{A}_k$ \u662f $\\mathbf{A}$ \u7684\u6700\u4f73\u79e9-$k$ \u8fd1\u4f3c\u3002</p>\n<p><strong>\u534f\u65b9\u5dee\u4f30\u8ba1</strong>\uff1a\n$$\\mathbf{0} \\preceq \\mathbf{A}^T\\mathbf{A} - \\mathbf{B}^T\\mathbf{B} \\preceq \\frac{1}{k}|\\mathbf{A}|_F^2 \\mathbf{I}$$\n\u8fd9\u4fdd\u8bc1\u4e86FD\u7ed9\u51fa\u7684\u662f\u534f\u65b9\u5dee\u77e9\u9635\u7684\u6b20\u4f30\u8ba1\u3002</p>\n<h3 id=\"633\">6.3.3 \u5feb\u901f\u53d8\u4f53</h3>\n<p><strong>Fast Frequent Directions</strong>\uff1a</p>\n<ul>\n<li>\u5ef6\u8fdfSVD\u8ba1\u7b97</li>\n<li>\u6279\u91cf\u5904\u7406\u591a\u884c</li>\n<li>\u5229\u7528QR\u5206\u89e3\u4ee3\u66ff\u5b8c\u6574SVD</li>\n</ul>\n<p><strong>\u968f\u673a\u5316\u52a0\u901f</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u4f7f\u7528\u968f\u673a\u6295\u5f71\u8fd1\u4f3cSVD\n\u8bef\u5dee\u4ecd\u7136\u6709\u754c\uff0c\u4f46\u5e38\u6570\u7565\u5927\n\u8ba1\u7b97\u590d\u6742\u5ea6\u4eceO(dk\u00b2)\u964d\u81f3O(dk log k)\n</code></pre></div>\n\n<h3 id=\"634\">6.3.4 \u4e0e\u5176\u4ed6\u65b9\u6cd5\u7684\u6bd4\u8f83</h3>\n<p><strong>vs \u968f\u673a\u91c7\u6837</strong>\uff1a</p>\n<ul>\n<li>FD\uff1a\u786e\u5b9a\u6027\u4fdd\u8bc1\uff0c\u7a7a\u95f4 $O(kd)$</li>\n<li>\u91c7\u6837\uff1a\u6982\u7387\u4fdd\u8bc1\uff0c\u53ef\u80fd\u9700\u8981 $O(k^2d)$ \u7a7a\u95f4</li>\n</ul>\n<p><strong>vs \u968f\u673a\u6295\u5f71</strong>\uff1a</p>\n<ul>\n<li>FD\uff1a\u4fdd\u6301\u6b63\u5b9a\u6027\uff0c\u9002\u5408\u534f\u65b9\u5dee\u4f30\u8ba1</li>\n<li>RP\uff1a\u66f4\u5feb\u4f46\u53ef\u80fd\u4ea7\u751f\u8d1f\u7279\u5f81\u503c</li>\n</ul>\n<h3 id=\"635\">6.3.5 \u5e94\u7528\u573a\u666f</h3>\n<p><strong>\u4e3b\u6210\u5206\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u6d41\u5f0fPCA\u7684\u6700\u4f18\u7b97\u6cd5</li>\n<li>\u5728\u7ebf\u7279\u5f81\u503c\u8ddf\u8e2a</li>\n<li>\u5f02\u5e38\u68c0\u6d4b\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<p><strong>\u77e9\u9635\u8865\u5168\u9884\u5904\u7406</strong>\uff1a</p>\n<ul>\n<li>\u5feb\u901f\u4f30\u8ba1\u77e9\u9635\u7684\u6709\u6548\u79e9</li>\n<li>\u4e3a\u8fed\u4ee3\u7b97\u6cd5\u63d0\u4f9b\u521d\u59cb\u5316</li>\n<li>\u52a0\u901f\u6536\u655b\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n</ul>\n<h3 id=\"636\">6.3.6 \u6269\u5c55\u4e0e\u53d8\u4f53</h3>\n<p><strong>\u52a0\u6743Frequent Directions</strong>\uff1a\n\u5904\u7406\u91cd\u8981\u6027\u4e0d\u540c\u7684\u6570\u636e\u70b9\n$$\\text{\u6536\u7f29\u6b65\u9aa4\uff1a} \\sigma_i \\leftarrow \\sqrt{\\max(0, \\sigma_i^2 - w_t\\sigma_k^2)}$$\n<strong>\u5206\u5e03\u5f0fFD</strong>\uff1a</p>\n<ul>\n<li>\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u5c40\u90e8sketch</li>\n<li>\u5468\u671f\u6027\u5408\u5e76\u4e0e\u6536\u7f29</li>\n<li>\u901a\u4fe1\u4e0e\u7cbe\u5ea6\u7684\u6743\u8861</li>\n</ul>\n<p><strong>\u65f6\u95f4\u8870\u51cfFD</strong>\uff1a\n\u5bf9\u5386\u53f2\u6570\u636e\u65bd\u52a0\u6307\u6570\u8870\u51cf</p>\n<ul>\n<li>\u9002\u5e94\u6982\u5ff5\u6f02\u79fb</li>\n<li>\u6709\u754c\u5185\u5b58\u4e0b\u7684\u65e0\u9650\u6d41\u5904\u7406</li>\n</ul>\n<h2 id=\"64\">6.4 \u5728\u795e\u7ecf\u7f51\u7edc\u538b\u7f29\u4e2d\u7684\u5e94\u7528</h2>\n<h3 id=\"641\">6.4.1 \u6743\u91cd\u77e9\u9635\u7684\u4f4e\u79e9\u8fd1\u4f3c</h3>\n<p><strong>\u57fa\u672c\u601d\u8def</strong>\uff1a\n\u5c06\u6743\u91cd\u77e9\u9635 $\\mathbf{W} \\in \\mathbb{R}^{m \\times n}$ \u5206\u89e3\u4e3a\uff1a\n$$\\mathbf{W} \\approx \\mathbf{U}\\mathbf{V}^T$$\n\u5176\u4e2d $\\mathbf{U} \\in \\mathbb{R}^{m \\times r}$\uff0c$\\mathbf{V} \\in \\mathbb{R}^{n \\times r}$\uff0c$r \\ll \\min(m,n)$\u3002</p>\n<p><strong>Sketching\u52a0\u901f\u5206\u89e3</strong>\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97sketch\uff1a$\\mathbf{S}_1\\mathbf{W}$ \u548c $\\mathbf{W}\\mathbf{S}_2^T$</li>\n<li>\u5728sketch\u4e0a\u8fdb\u884cSVD</li>\n<li>\u6062\u590d\u539f\u59cb\u7a7a\u95f4\u7684\u56e0\u5b50</li>\n</ol>\n<h3 id=\"642\">6.4.2 \u6fc0\u6d3b\u503c\u538b\u7f29</h3>\n<p><strong>\u52a8\u6001\u8303\u56f4\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>\u6fc0\u6d3b\u503c\u7684\u5206\u5e03\u968f\u5c42\u6df1\u5ea6\u53d8\u5316\u5f88\u5927</li>\n<li>\u9700\u8981\u81ea\u9002\u5e94\u7684quantization\u7b56\u7565</li>\n<li>Sketching\u53ef\u4ee5\u5feb\u901f\u4f30\u8ba1\u5206\u5e03\u53c2\u6570</li>\n</ul>\n<p><strong>\u5728\u7ebf\u6fc0\u6d3b\u538b\u7f29</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7ef4\u62a4\u6fc0\u6d3b\u503c\u7684Frequent Directions sketch\n\u52a8\u6001\u8c03\u6574\u91cf\u5316\u9608\u503c\n\u5b9e\u73b0\u901a\u4fe1-\u7cbe\u5ea6\u7684\u6700\u4f18\u6743\u8861\n</code></pre></div>\n\n<h3 id=\"643\">6.4.3 \u68af\u5ea6\u538b\u7f29\u4e0e\u901a\u4fe1</h3>\n<p><strong>\u5206\u5e03\u5f0f\u8bad\u7ec3\u4e2d\u7684\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u68af\u5ea6\u901a\u4fe1\u662f\u4e3b\u8981\u74f6\u9888</li>\n<li>\u9700\u8981\u4fdd\u6301\u6536\u655b\u6027\u4fdd\u8bc1</li>\n<li>\u5904\u7406\u975e\u51f8\u4f18\u5316\u7684\u7279\u6b8a\u6027</li>\n</ul>\n<p><strong>Sketched\u68af\u5ea6\u4e0b\u964d</strong>\uff1a\n$$\\mathbf{g}_t^{(i)} = \\nabla f_i(\\mathbf{w}_t)$$\n$$\\tilde{\\mathbf{g}}_t = \\frac{1}{n}\\sum_{i=1}^n \\mathbf{S}^T\\mathbf{S}\\mathbf{g}_t^{(i)}$$\n\u6536\u655b\u4fdd\u8bc1\u9700\u8981\u4ed4\u7ec6\u7684\u8bef\u5dee\u5206\u6790\u3002</p>\n<h3 id=\"644\">6.4.4 \u6ce8\u610f\u529b\u673a\u5236\u7684\u52a0\u901f</h3>\n<p><strong>\u81ea\u6ce8\u610f\u529b\u7684\u8ba1\u7b97\u74f6\u9888</strong>\uff1a\n$$\\text{Attention}(\\mathbf{Q}, \\mathbf{K}, \\mathbf{V}) = \\text{softmax}\\left(\\frac{\\mathbf{Q}\\mathbf{K}^T}{\\sqrt{d}}\\right)\\mathbf{V}$$\n\u590d\u6742\u5ea6\uff1a$O(n^2d)$\uff0c\u5176\u4e2d $n$ \u662f\u5e8f\u5217\u957f\u5ea6\u3002</p>\n<p><strong>\u7ebf\u6027\u6ce8\u610f\u529bvia Sketching</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u968f\u673a\u7279\u5f81\u8fd1\u4f3csoftmax</li>\n<li>CountSketch\u52a0\u901f\u77e9\u9635\u4e58\u6cd5</li>\n<li>\u4fdd\u6301\u7aef\u5230\u7aef\u7684\u53ef\u5fae\u6027</li>\n</ul>\n<h3 id=\"645\">6.4.5 \u6a21\u578b\u84b8\u998f\u4e2d\u7684\u5e94\u7528</h3>\n<p><strong>\u77e5\u8bc6\u8f6c\u79fb\u7684\u65b0\u89c6\u89d2</strong>\uff1a</p>\n<ul>\n<li>Teacher\u7f51\u7edc\u7684\u6fc0\u6d3b\u6a21\u5f0fsketching</li>\n<li>\u4fdd\u7559\u5173\u952e\u7684\u7edf\u8ba1\u4fe1\u606f</li>\n<li>\u6307\u5bfcStudent\u7f51\u7edc\u7684\u8bad\u7ec3</li>\n</ul>\n<p><strong>Sketched\u84b8\u998f\u635f\u5931</strong>\uff1a\n$$\\mathcal{L} = |\\mathbf{S}(\\mathbf{A}_{teacher}) - \\mathbf{S}(\\mathbf{A}_{student})|_F^2$$\n\u5176\u4e2d $\\mathbf{S}$ \u662f\u9002\u5f53\u9009\u62e9\u7684sketching\u7b97\u5b50\u3002</p>\n<h3 id=\"646\">6.4.6 \u672a\u6765\u7814\u7a76\u65b9\u5411</h3>\n<p><strong>\u786c\u4ef6\u534f\u540c\u8bbe\u8ba1</strong>\uff1a</p>\n<ul>\n<li>\u4e13\u95e8\u7684sketching\u52a0\u901f\u5668</li>\n<li>\u4e0e\u7a00\u758f\u8ba1\u7b97\u7684\u7ed3\u5408</li>\n<li>\u80fd\u91cf\u6548\u7387\u4f18\u5316</li>\n</ul>\n<p><strong>\u7406\u8bba\u7a81\u7834\u9700\u6c42</strong>\uff1a</p>\n<ul>\n<li>\u975e\u7ebf\u6027\u7f51\u7edc\u7684sketching\u7406\u8bba</li>\n<li>\u7aef\u5230\u7aef\u7684\u538b\u7f29\u7387\u4fdd\u8bc1</li>\n<li>\u4e0e\u5176\u4ed6\u538b\u7f29\u6280\u672f\u7684\u6700\u4f18\u7ec4\u5408</li>\n</ul>\n<h2 id=\"_3\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u77e9\u9635sketching\u6280\u672f\u4e3a\u5927\u89c4\u6a21\u8ba1\u7b97\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5de5\u5177\u3002\u5173\u952e\u8981\u70b9\uff1a</p>\n<ol>\n<li><strong>JL\u5f15\u7406\u7684\u5b9e\u7528\u5316</strong>\u9700\u8981\u5728\u7406\u8bba\u4fdd\u8bc1\u548c\u5b9e\u9645\u6548\u7387\u95f4\u5e73\u8861</li>\n<li><strong>CountSketch</strong>\u63d0\u4f9b\u4e86\u7b80\u5355\u9ad8\u6548\u7684\u968f\u673a\u5316\u65b9\u6cd5</li>\n<li><strong>Frequent Directions</strong>\u7ed9\u51fa\u4e86\u6700\u4f18\u7684\u786e\u5b9a\u6027\u4fdd\u8bc1</li>\n<li><strong>\u795e\u7ecf\u7f51\u7edc\u538b\u7f29</strong>\u662fsketching\u6280\u672f\u7684\u91cd\u8981\u5e94\u7528\u9886\u57df</li>\n</ol>\n<p>\u6838\u5fc3\u89c1\u89e3\uff1a</p>\n<ul>\n<li>Sketching\u4e0d\u4ec5\u662f\u964d\u7ef4\uff0c\u66f4\u662f\u4fe1\u606f\u7684\u667a\u80fd\u538b\u7f29</li>\n<li>\u4e0d\u540csketching\u65b9\u6cd5\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u95ee\u9898\u7ed3\u6784</li>\n<li>\u7406\u8bba\u5206\u6790\u6307\u5bfc\u5b9e\u8df5\uff0c\u5b9e\u8df5\u9700\u6c42\u63a8\u52a8\u7406\u8bba\u53d1\u5c55</li>\n</ul>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<ol>\n<li>\n<p><strong>\u76f2\u76ee\u8ffd\u6c42\u4f4e\u7ef4</strong>\n   - \u9519\u8bef\uff1a\u603b\u662f\u4f7f\u7528\u7406\u8bba\u6700\u5c0f\u7ef4\u5ea6\n   - \u6b63\u786e\uff1a\u6839\u636e\u5b9e\u9645\u7cbe\u5ea6\u9700\u6c42\u8c03\u6574\uff0c\u8003\u8651\u5e38\u6570\u56e0\u5b50</p>\n</li>\n<li>\n<p><strong>\u5ffd\u89c6\u6570\u503c\u7a33\u5b9a\u6027</strong>\n   - \u9519\u8bef\uff1a\u76f4\u63a5\u5b9e\u73b0\u6559\u79d1\u4e66\u7b97\u6cd5\n   - \u6b63\u786e\uff1a\u4f7f\u7528\u6570\u503c\u7a33\u5b9a\u7684\u53d8\u4f53\uff0c\u5982QR-based FD</p>\n</li>\n<li>\n<p><strong>\u4e0d\u5f53\u7684\u6027\u80fd\u8bc4\u4f30</strong>\n   - \u9519\u8bef\uff1a\u53ea\u770b\u538b\u7f29\u7387\n   - \u6b63\u786e\uff1a\u7efc\u5408\u8003\u8651\u7cbe\u5ea6\u3001\u901f\u5ea6\u3001\u5185\u5b58\u4f7f\u7528</p>\n</li>\n<li>\n<p><strong>\u5047\u8bbe\u72ec\u7acb\u540c\u5206\u5e03</strong>\n   - \u9519\u8bef\uff1a\u5bf9\u6240\u6709\u6570\u636e\u4f7f\u7528\u76f8\u540c\u7684sketch\n   - \u6b63\u786e\uff1a\u8003\u8651\u6570\u636e\u7684\u65f6\u53d8\u6027\u548c\u5f02\u8d28\u6027</p>\n</li>\n<li>\n<p><strong>\u5ffd\u7565\u786c\u4ef6\u7279\u6027</strong>\n   - \u9519\u8bef\uff1a\u53ea\u8003\u8651\u7b97\u6cd5\u590d\u6742\u5ea6\n   - \u6b63\u786e\uff1a\u4f18\u5316\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5229\u7528\u5e76\u884c\u6027</p>\n</li>\n</ol>\n<h2 id=\"_4\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_5\">\u7b97\u6cd5\u9009\u62e9</h3>\n<ul>\n<li>[ ] \u5206\u6790\u6570\u636e\u7279\u6027\uff08\u7a00\u758f\u6027\u3001\u8c31\u5206\u5e03\u3001\u52a8\u6001\u8303\u56f4\uff09</li>\n<li>[ ] \u660e\u786e\u7cbe\u5ea6\u8981\u6c42\u4e0e\u8d44\u6e90\u9650\u5236</li>\n<li>[ ] \u8003\u8651\u662f\u5426\u9700\u8981\u786e\u5b9a\u6027\u4fdd\u8bc1</li>\n<li>[ ] \u8bc4\u4f30\u66f4\u65b0\u9891\u7387\u4e0e\u6279\u5904\u7406\u53ef\u80fd\u6027</li>\n</ul>\n<h3 id=\"_6\">\u5b9e\u73b0\u4f18\u5316</h3>\n<ul>\n<li>[ ] \u4f7f\u7528\u9ad8\u6548\u7684\u7ebf\u6027\u4ee3\u6570\u5e93\uff08BLAS, LAPACK\uff09</li>\n<li>[ ] \u5b9e\u73b0cache-friendly\u7684\u6570\u636e\u5e03\u5c40</li>\n<li>[ ] \u5229\u7528SIMD\u6307\u4ee4\u548cGPU\u52a0\u901f</li>\n<li>[ ] \u6dfb\u52a0\u6570\u503c\u7a33\u5b9a\u6027\u68c0\u67e5</li>\n</ul>\n<h3 id=\"_7\">\u53c2\u6570\u8c03\u4f18</h3>\n<ul>\n<li>[ ] \u901a\u8fc7\u5c0f\u89c4\u6a21\u5b9e\u9a8c\u786e\u5b9asketch\u5927\u5c0f</li>\n<li>[ ] \u4f7f\u7528\u4ea4\u53c9\u9a8c\u8bc1\u9009\u62e9\u8d85\u53c2\u6570</li>\n<li>[ ] \u76d1\u63a7\u5b9e\u9645\u8bef\u5deevs\u7406\u8bba\u754c\u9650</li>\n<li>[ ] \u51c6\u5907\u81ea\u9002\u5e94\u8c03\u6574\u673a\u5236</li>\n</ul>\n<h3 id=\"_8\">\u7cfb\u7edf\u96c6\u6210</h3>\n<ul>\n<li>[ ] \u8bbe\u8ba1\u6e05\u6670\u7684API\u63a5\u53e3</li>\n<li>[ ] \u63d0\u4f9b\u589e\u91cf\u66f4\u65b0\u80fd\u529b</li>\n<li>[ ] \u5b9e\u73b0checkpoint\u548c\u6062\u590d\u673a\u5236</li>\n<li>[ ] \u6dfb\u52a0\u6027\u80fd\u76d1\u63a7\u548c\u65e5\u5fd7</li>\n</ul>\n<h2 id=\"_9\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_10\">\u57fa\u7840\u9898</h3>\n<p><strong>\u4e60\u98986.1</strong> \u8bc1\u660e\u5bf9\u4e8e\u9ad8\u65af\u968f\u673a\u6295\u5f71\u77e9\u9635 $\\mathbf{S} \\in \\mathbb{R}^{k \\times d}$\uff0c\u5176\u4e2d $S_{ij} \\sim \\mathcal{N}(0, 1/k)$\uff0c\u6709\uff1a\n$$\\mathbb{E}[|\\mathbf{S}\\mathbf{x}|^2] = |\\mathbf{x}|^2$$\n<em>Hint</em>: \u5229\u7528\u9ad8\u65af\u968f\u673a\u53d8\u91cf\u7684\u6027\u8d28\u548c\u72ec\u7acb\u6027\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe $\\mathbf{y} = \\mathbf{S}\\mathbf{x}$\uff0c\u5219 $y_i = \\sum_{j=1}^d S_{ij}x_j$\u3002</p>\n<p>\u7531\u4e8e $S_{ij} \\sim \\mathcal{N}(0, 1/k)$ \u4e14\u76f8\u4e92\u72ec\u7acb\uff1a\n$$\\mathbb{E}[y_i^2] = \\mathbb{E}\\left[\\left(\\sum_{j=1}^d S_{ij}x_j\\right)^2\\right]$$\n\u5c55\u5f00\u5e76\u5229\u7528\u72ec\u7acb\u6027\uff1a\n$$= \\sum_{j=1}^d x_j^2 \\mathbb{E}[S_{ij}^2] = \\sum_{j=1}^d x_j^2 \\cdot \\frac{1}{k} = \\frac{|\\mathbf{x}|^2}{k}$$\n\u56e0\u6b64\uff1a\n$$\\mathbb{E}[|\\mathbf{y}|^2] = \\sum_{i=1}^k \\mathbb{E}[y_i^2] = k \\cdot \\frac{|\\mathbf{x}|^2}{k} = |\\mathbf{x}|^2$$</p>\n</details>\n<p><strong>\u4e60\u98986.2</strong> \u5bf9\u4e8eCountSketch\u77e9\u9635\uff0c\u8ba1\u7b97 $\\text{Var}[(\\mathbf{S}\\mathbf{x})_i]$ \u5e76\u8bf4\u660e\u5982\u4f55\u901a\u8fc7\u591a\u4e2a\u72ec\u7acbsketch\u964d\u4f4e\u65b9\u5dee\u3002</p>\n<p><em>Hint</em>: \u8003\u8651\u54c8\u5e0c\u78b0\u649e\u7684\u5f71\u54cd\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe $h: [d] \\rightarrow [k]$ \u4e3a\u54c8\u5e0c\u51fd\u6570\uff0c$s: [d] \\rightarrow {-1,+1}$ \u4e3a\u7b26\u53f7\u51fd\u6570\u3002</p>\n<p>\u5219 $(\\mathbf{S}\\mathbf{x})_i = \\sum_{j: h(j)=i} s(j)x_j$\u3002</p>\n<p>\u5bf9\u4e8e\u5747\u5300\u968f\u673a\u54c8\u5e0c\uff0c$\\Pr[h(j)=i] = 1/k$\u3002</p>\n<p>\u671f\u671b\uff1a$\\mathbb{E}[(\\mathbf{S}\\mathbf{x})_i] = 0$\uff08\u7531\u4e8e\u968f\u673a\u7b26\u53f7\uff09</p>\n<p>\u65b9\u5dee\uff1a\n$$\\text{Var}[(\\mathbf{S}\\mathbf{x})_i] = \\mathbb{E}[(\\mathbf{S}\\mathbf{x})_i^2] = \\sum_{j=1}^d \\frac{1}{k}x_j^2 = \\frac{|\\mathbf{x}|^2}{k}$$</p>\n<p>\u4f7f\u7528 $t$ \u4e2a\u72ec\u7acbsketch\u53d6\u5e73\u5747\u53ef\u5c06\u65b9\u5dee\u964d\u81f3 $\\frac{|\\mathbf{x}|^2}{kt}$\u3002</p>\n</details>\n<p><strong>\u4e60\u98986.3</strong> \u5b9e\u73b0Frequent Directions\u7b97\u6cd5\u7684\u4e00\u4e2a\u7b80\u5316\u7248\u672c\uff0c\u5904\u7406\u6279\u91cf\u66f4\u65b0\u800c\u975e\u9010\u884c\u66f4\u65b0\u3002\u5206\u6790\u6279\u5927\u5c0f\u5bf9\u7cbe\u5ea6\u548c\u6548\u7387\u7684\u5f71\u54cd\u3002</p>\n<p><em>Hint</em>: \u4f7f\u7528QR\u5206\u89e3\u4ee3\u66ffSVD\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6279\u91cfFD\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u6536\u96c6 $b$ \u884c\u5f62\u6210\u6279\u6b21\u77e9\u9635 $\\mathbf{A}_{batch}$</li>\n<li>\u7ec4\u5408\uff1a$\\mathbf{B}_{new} = [\\mathbf{B}; \\mathbf{A}_{batch}]$</li>\n<li>QR\u5206\u89e3\uff1a$\\mathbf{B}_{new} = \\mathbf{Q}\\mathbf{R}$</li>\n<li>\u5bf9 $\\mathbf{R}$ \u8fdb\u884cSVD\uff1a$\\mathbf{R} = \\mathbf{U}_R\\mathbf{\\Sigma}\\mathbf{V}^T$</li>\n<li>\u6536\u7f29\u548c\u622a\u65ad</li>\n</ol>\n<p>\u6279\u5927\u5c0f\u5f71\u54cd\uff1a</p>\n<ul>\n<li>\u5927\u6279\u6b21\uff1a\u66f4\u597d\u7684\u8ba1\u7b97\u6548\u7387\uff08\u77e9\u9635\u4e58\u6cd5\uff09</li>\n<li>\u5c0f\u6279\u6b21\uff1a\u66f4\u597d\u7684\u7a7a\u95f4\u6548\u7387\u548c\u66f4\u65b0\u9891\u7387</li>\n<li>\u6700\u4f18\u6279\u5927\u5c0f\uff1a$b = \\Theta(\\sqrt{k})$ \u5e73\u8861\u8ba1\u7b97\u548c\u7cbe\u5ea6</li>\n</ul>\n</details>\n<h3 id=\"_11\">\u6311\u6218\u9898</h3>\n<p><strong>\u4e60\u98986.4</strong> \u8bbe\u8ba1\u4e00\u4e2a\u81ea\u9002\u5e94sketching\u7b97\u6cd5\uff0c\u80fd\u591f\u6839\u636e\u6570\u636e\u6d41\u7684\u7279\u6027\u52a8\u6001\u8c03\u6574sketch\u5927\u5c0f\u3002\u7ed9\u51fa\u7406\u8bba\u4fdd\u8bc1\u3002</p>\n<p><em>Hint</em>: \u8003\u8651\u4f7f\u7528doubling\u6280\u5de7\u548c\u8bef\u5dee\u4f30\u8ba1\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u7b97\u6cd5\u6846\u67b6\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8bef\u5dee\u4f30\u8ba1\u5668</strong>\uff1a\u7ef4\u62a4\u4e24\u4e2a\u4e0d\u540c\u5927\u5c0f\u7684sketch ($k$ \u548c $2k$)\n   - \u82e5\u4e24\u8005\u5dee\u5f02\u5927\uff0c\u8bf4\u660e\u5f53\u524d $k$ \u4e0d\u591f</p>\n</li>\n<li>\n<p><strong>Doubling\u7b56\u7565</strong>\uff1a\n   - \u521d\u59cb $k_0 = O(\\log n)$\n   - \u5f53\u8bef\u5dee\u8d85\u8fc7\u9608\u503c\u65f6\uff0c$k \\leftarrow 2k$\n   - \u4f7f\u7528\u65e7sketch\u521d\u59cb\u5316\u65b0sketch</p>\n</li>\n<li>\n<p><strong>\u7406\u8bba\u4fdd\u8bc1</strong>\uff1a\n   - \u603bsketch\u5927\u5c0f\uff1a$O(k^* \\log(d/k^*))$\n   - \u5176\u4e2d $k^*$ \u662f\u8fbe\u5230\u76ee\u6807\u7cbe\u5ea6\u7684\u6700\u5c0f\u7ef4\u5ea6\n   - \u66f4\u65b0\u590d\u6742\u5ea6\uff1aamortized $O(d)$</p>\n</li>\n<li>\n<p><strong>\u5b9e\u73b0\u6280\u5de7</strong>\uff1a\n   - \u4f7f\u7528\u73af\u5f62\u7f13\u51b2\u533a\u907f\u514d\u6570\u636e\u590d\u5236\n   - \u589e\u91cf\u5f0fSVD\u66f4\u65b0\n   - \u5e76\u884c\u7ef4\u62a4\u591a\u4e2a\u5206\u8fa8\u7387\u7684sketch</p>\n</li>\n</ol>\n</details>\n<p><strong>\u4e60\u98986.5</strong> \u5206\u6790\u5728\u975e\u5747\u5300\u6570\u636e\u5206\u5e03\u4e0b\uff0c\u4e0d\u540csketching\u65b9\u6cd5\u7684\u8868\u73b0\u3002\u7279\u522b\u8003\u8651heavy-tailed\u5206\u5e03\u3002</p>\n<p><em>Hint</em>: \u8003\u8651\u4f7f\u7528robust\u7edf\u8ba1\u91cf\u548c\u91cd\u8981\u6027\u91c7\u6837\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>Heavy-tailed\u5206\u5e03\u7684\u6311\u6218\uff1a</p>\n<ul>\n<li>\u5c11\u6570\u5927\u503c\u4e3b\u5bfc $\\ell_2$ \u8303\u6570</li>\n<li>\u6807\u51c6JL\u754c\u9650\u53ef\u80fd\u8fc7\u4e8e\u4fdd\u5b88</li>\n</ul>\n<p>\u89e3\u51b3\u65b9\u6848\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5c42sketching</strong>\uff1a\n   - \u5c06\u6570\u636e\u6309\u5927\u5c0f\u5206\u7ec4\n   - \u5bf9\u6bcf\u7ec4\u4f7f\u7528\u4e0d\u540c\u7684sketch\u5927\u5c0f\n   - \u7406\u8bba\uff1a\u4fdd\u6301\u76f8\u5bf9\u8bef\u5dee\u800c\u975e\u7edd\u5bf9\u8bef\u5dee</p>\n</li>\n<li>\n<p><strong>Robust sketching</strong>\uff1a\n   - \u4f7f\u7528 $\\ell_p$ \u8303\u6570\uff0c$p &lt; 2$\n   - CountSketch\u7684\u4e2d\u503c\u4f30\u8ba1\n   - \u7406\u8bba\uff1a\u5c3e\u90e8\u6982\u7387\u968f $p$ \u6539\u5584</p>\n</li>\n<li>\n<p><strong>\u91cd\u8981\u6027\u91c7\u6837sketch</strong>\uff1a\n   - \u91c7\u6837\u6982\u7387 $\\propto |x_i|^p$\uff0c$p \\in [0,2]$\n   - \u9700\u8981\u4e24\u904d\u626b\u63cf\u6216\u5728\u7ebf\u4f30\u8ba1\n   - \u7406\u8bba\uff1a\u65b9\u5dee\u6700\u4f18for\u7ed9\u5b9a\u5185\u5b58</p>\n</li>\n</ol>\n<p>\u6bd4\u8f83\uff1a</p>\n<ul>\n<li>Gaussian sketch: \u5bf9outlier\u654f\u611f</li>\n<li>CountSketch: \u81ea\u7136\u7684robustness</li>\n<li>FD: \u4fdd\u7559\u4e3b\u8981\u6a21\u5f0f\uff0c\u5ffd\u7565\u5c3e\u90e8</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98986.6</strong> \u63a2\u8ba8\u5982\u4f55\u5c06sketching\u6280\u672f\u5e94\u7528\u4e8e\u56fe\u795e\u7ecf\u7f51\u7edc(GNN)\u7684\u52a0\u901f\u3002\u8003\u8651\u90bb\u63a5\u77e9\u9635\u548c\u7279\u5f81\u77e9\u9635\u7684\u8054\u5408\u538b\u7f29\u3002</p>\n<p><em>Hint</em>: \u5229\u7528\u56fe\u7684\u8c31\u6027\u8d28\u548c\u6d88\u606f\u4f20\u9012\u7684\u5c40\u90e8\u6027\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>GNN\u4e2d\u7684sketching\u673a\u4f1a\uff1a</p>\n<ol>\n<li>\n<p><strong>\u90bb\u63a5\u77e9\u9635\u538b\u7f29</strong>\uff1a\n   - \u8c31sparsification\u4fdd\u6301\u5207\u5272\u6027\u8d28\n   - \u968f\u673a\u6e38\u8d70\u7684sketch\u8868\u793a\n   - \u4fdd\u6301\u5ea6\u5206\u5e03\u7684\u91c7\u6837</p>\n</li>\n<li>\n<p><strong>\u7279\u5f81\u4f20\u64ad\u52a0\u901f</strong>\uff1a\n   <code>\u539f\u59cb: H^{(l+1)} = \u03c3(AH^{(l)}W^{(l)})\n   Sketched: H^{(l+1)} = \u03c3(S_A^T S_A A S_H^T S_H H^{(l)} W^{(l)})</code></p>\n</li>\n<li>\n<p><strong>\u8054\u5408\u4f18\u5316</strong>\uff1a\n   - \u8bbe\u8ba1\u76f8\u5bb9\u7684sketch\u4fdd\u6301\uff1a\n     $|S_A A S_H^T S_H X - AX|_F \\leq \\epsilon|A|_F|X|_F$</p>\n</li>\n</ol>\n<ul>\n<li>\u5229\u7528\u56fe\u7684\u793e\u533a\u7ed3\u6784</li>\n<li>\u81ea\u9002\u5e94\u4e8e\u4e0d\u540c\u5c42\u7684\u9700\u6c42</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u7406\u8bba\u5206\u6790</strong>\uff1a\n   - \u8c31\u56fe\u7406\u8bba+JL\u5f15\u7406\n   - \u6d88\u606f\u4f20\u9012\u7684\u8bef\u5dee\u4f20\u64ad\n   - \u7aef\u5230\u7aef\u7684\u6027\u80fd\u4fdd\u8bc1</li>\n</ol>\n<p>\u5b9e\u9645\u8003\u8651\uff1a</p>\n<ul>\n<li>\u4fdd\u6301\u56fe\u7684\u8fde\u901a\u6027</li>\n<li>\u5904\u7406\u4e0d\u540c\u5927\u5c0f\u7684\u90bb\u57df</li>\n<li>\u4e0e\u56fe\u91c7\u6837\u6280\u672f\u7684\u7ed3\u5408</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98986.7</strong> (\u5f00\u653e\u95ee\u9898) \u8bbe\u8ba1\u4e00\u4e2a\u91cf\u5b50\u542f\u53d1\u7684\u7ecf\u5178sketching\u7b97\u6cd5\uff0c\u5229\u7528\u5f20\u91cf\u7f51\u7edc\u7ed3\u6784\u3002\u5206\u6790\u5176\u5728\u7279\u5b9a\u95ee\u9898\u7c7b\u4e0a\u7684\u4f18\u52bf\u3002</p>\n<p><em>Hint</em>: \u8003\u8651Matrix Product States (MPS)\u548c\u6811\u5f20\u91cf\u7f51\u7edc\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u91cf\u5b50\u542f\u53d1sketching\u7684\u8bbe\u8ba1\uff1a</p>\n<ol>\n<li>\n<p><strong>MPS\u8868\u793a</strong>\uff1a\n   - \u5c06\u9ad8\u7ef4\u5411\u91cf\u8868\u793a\u4e3a\u5f20\u91cf\u94fe\n   - \u6bcf\u4e2a\u5f20\u91cf\u7ef4\u5ea6 $O(\\text{poly}(\\log d))$\n   - \u81ea\u7136\u7684\u7ef4\u5ea6\u7ea6\u7b80</p>\n</li>\n<li>\n<p><strong>\u6811\u5f20\u91cf\u7f51\u7edcsketch</strong>\uff1a\n   - \u5c42\u6b21\u5316\u7684\u4fe1\u606f\u805a\u5408\n   - \u7c7b\u4f3c\u5c0f\u6ce2\u53d8\u6362\u7684\u591a\u5206\u8fa8\u7387\n   - \u4fdd\u6301\u5c40\u90e8\u76f8\u5173\u6027</p>\n</li>\n<li>\n<p><strong>\u4f18\u52bf\u5206\u6790</strong>\uff1a\n   - \u5bf9\u4e8e\u4f4e\u7ea0\u7f20\u6001\uff1a\u6307\u6570\u538b\u7f29\n   - \u5bf9\u4e8e\u5c40\u90e8\u76f8\u5173\u6570\u636e\uff1a\u4fdd\u6301\u7ed3\u6784\n   - \u53ef\u5e76\u884c\u5316\u7684\u66f4\u65b0</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a\n   <code>\u8f93\u5165\u5206\u89e3 \u2192 \u5f20\u91cf\u5316 \u2192 \u7f51\u7edc\u6536\u7f29 \u2192 \u4f4e\u79e9\u622a\u65ad</code></p>\n</li>\n<li>\n<p><strong>\u7406\u8bba\u6311\u6218</strong>\uff1a\n   - \u7ecf\u5178\u6570\u636e\u7684\"\u7ea0\u7f20\"\u5ea6\u91cf\n   - \u4e0e\u4f20\u7edf\u65b9\u6cd5\u7684\u4e25\u683c\u6bd4\u8f83\n   - \u8ba1\u7b97\u590d\u6742\u5ea6\u7684\u7cbe\u786e\u5206\u6790</p>\n</li>\n</ol>\n<p>\u7814\u7a76\u65b9\u5411\uff1a</p>\n<ul>\n<li>\u4e0e\u91cf\u5b50\u7b97\u6cd5\u7684\u5f62\u5f0f\u5bf9\u5e94</li>\n<li>\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u7684\u5e94\u7528</li>\n<li>\u786c\u4ef6\u52a0\u901f\u7684\u53ef\u80fd\u6027</li>\n</ul>\n</details>\n<p><strong>\u4e60\u98986.8</strong> \u7814\u7a76sketching\u5728\u8054\u90a6\u5b66\u4e60\u4e2d\u7684\u5e94\u7528\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u901a\u4fe1\u9ad8\u6548\u4e14\u9690\u79c1\u4fdd\u62a4\u7684\u68af\u5ea6\u805a\u5408\u65b9\u6848\u3002</p>\n<p><em>Hint</em>: \u7ed3\u5408\u5dee\u5206\u9690\u79c1\u548c\u5b89\u5168\u805a\u5408\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8054\u90a6\u5b66\u4e60\u4e2d\u7684Sketched\u68af\u5ea6\u805a\u5408\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u672c\u65b9\u6848</strong>\uff1a\n   - \u5ba2\u6237\u7aef\uff1a$\\tilde{\\mathbf{g}}_i = \\mathbf{S}_i \\mathbf{g}_i + \\mathbf{n}_i$\n   - \u670d\u52a1\u5668\uff1a$\\bar{\\mathbf{g}} = \\frac{1}{n}\\sum_i \\mathbf{S}_i^T \\tilde{\\mathbf{g}}_i$</p>\n</li>\n<li>\n<p><strong>\u9690\u79c1\u4fdd\u8bc1</strong>\uff1a\n   - \u5dee\u5206\u9690\u79c1\u566a\u58f0\uff1a$\\mathbf{n}_i \\sim \\mathcal{N}(0, \\sigma^2 \\mathbf{I})$\n   - \u7ec4\u5408sketching\u964d\u4f4e\u654f\u611f\u5ea6\n   - \u5f62\u5f0f\u5316\u9690\u79c1\u9884\u7b97\u5206\u6790</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u4f18\u5316</strong>\uff1a\n   - \u538b\u7f29\u7387\uff1a$O(k/d)$\uff0c\u5176\u4e2d $k = O(\\log n / \\epsilon^2)$\n   - \u91cf\u5316sketched\u68af\u5ea6\n   - \u7a00\u758f\u5316\u4f20\u8f93</p>\n</li>\n<li>\n<p><strong>\u5b89\u5168\u805a\u5408</strong>\uff1a\n   - \u4f7f\u7528\u540c\u6001\u52a0\u5bc6\u7684sketch\n   - \u79d8\u5bc6\u5171\u4eab\u7684\u5206\u5e03\u5f0fsketch\n   - \u9a8c\u8bc1sketch\u7684\u5b8c\u6574\u6027</p>\n</li>\n<li>\n<p><strong>\u6536\u655b\u6027\u5206\u6790</strong>\uff1a\n   - Sketching\u8bef\u5dee + \u9690\u79c1\u566a\u58f0\n   - \u975e\u51f8\u4f18\u5316\u7684\u6536\u655b\u7387\n   - \u4e0e\u901a\u4fe1\u8f6e\u6570\u7684\u6743\u8861</p>\n</li>\n</ol>\n<p>\u5b9e\u9645\u90e8\u7f72\u8003\u8651\uff1a</p>\n<ul>\n<li>\u5f02\u6784\u5ba2\u6237\u7aef\u7684\u5904\u7406</li>\n<li>\u6389\u7ebf\u5bb9\u9519\u673a\u5236</li>\n<li>\u81ea\u9002\u5e94sketch\u5927\u5c0f</li>\n</ul>\n</details>\n<h2 id=\"_12\">\u8fdb\u4e00\u6b65\u7814\u7a76\u65b9\u5411</h2>\n<ol>\n<li>\n<p><strong>\u7406\u8bba\u6df1\u5316</strong>\uff1a\n   - \u6570\u636e\u76f8\u5173sketch\u7684\u6700\u4f18\u6027\u523b\u753b\n   - \u975e\u7ebf\u6027sketching\u7684\u53ef\u80fd\u6027\n   - \u4e0e\u4fe1\u606f\u8bba\u754c\u9650\u7684\u5173\u7cfb</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u521b\u65b0</strong>\uff1a\n   - \u81ea\u9002\u5e94\u548c\u5728\u7ebf\u7b97\u6cd5\u8bbe\u8ba1\n   - \u591a\u6a21\u6001\u6570\u636e\u7684\u8054\u5408sketching\n   - \u91cf\u5b50-\u7ecf\u5178\u6df7\u5408\u7b97\u6cd5</p>\n</li>\n<li>\n<p><strong>\u7cfb\u7edf\u4f18\u5316</strong>\uff1a\n   - \u786c\u4ef6\u611f\u77e5\u7684\u5b9e\u73b0\n   - \u5206\u5e03\u5f0f\u548c\u6d41\u5f0f\u5904\u7406\n   - \u7aef\u5230\u7aef\u7684\u7cfb\u7edf\u8bbe\u8ba1</p>\n</li>\n<li>\n<p><strong>\u5e94\u7528\u62d3\u5c55</strong>\uff1a\n   - \u79d1\u5b66\u8ba1\u7b97\u4e2d\u7684\u65b0\u5e94\u7528\n   - \u4e0e\u5176\u4ed6AI\u6280\u672f\u7684\u7ed3\u5408\n   - \u5b9e\u9645\u7cfb\u7edf\u7684\u90e8\u7f72\u7ecf\u9a8c</p>\n</li>\n</ol>\n<h2 id=\"_13\">\u63a8\u8350\u9605\u8bfb</h2>\n<ul>\n<li>Woodruff, D. P. (2014). \"Sketching as a Tool for Numerical Linear Algebra\"</li>\n<li>Liberty, E. (2013). \"Simple and Deterministic Matrix Sketching\"</li>\n<li>Halko, N., Martinsson, P. G., &amp; Tropp, J. A. (2011). \"Finding Structure with Randomness\"</li>\n<li>Clarkson, K. L., &amp; Woodruff, D. P. (2017). \"Low-Rank Approximation and Regression in Input Sparsity Time\"</li>\n</ul>"
  },
  "../chapter16.md": {
    "hash": "eea7f56d19f5d5228e116e0aad0b2ccc",
    "content": "<h1 id=\"16\">\u7b2c16\u7ae0\uff1a\u591a\u6a21\u6001\u63a8\u8350\u7684\u5f20\u91cf\u5206\u89e3</h1>\n<p>\u73b0\u4ee3\u63a8\u8350\u7cfb\u7edf\u9762\u4e34\u7740\u65e5\u76ca\u590d\u6742\u7684\u591a\u7ef4\u4ea4\u4e92\u5efa\u6a21\u6311\u6218\u3002\u7528\u6237\u4e0d\u4ec5\u4e0e\u7269\u54c1\u4ea7\u751f\u4ea4\u4e92\uff0c\u8fd8\u6d89\u53ca\u65f6\u95f4\u3001\u5730\u70b9\u3001\u8bbe\u5907\u7c7b\u578b\u3001\u793e\u4ea4\u5173\u7cfb\u7b49\u591a\u4e2a\u7ef4\u5ea6\u3002\u4f20\u7edf\u7684\u77e9\u9635\u5206\u89e3\u65b9\u6cd5\u5728\u5904\u7406\u8fd9\u4e9b\u9ad8\u9636\u4ea4\u4e92\u65f6\u663e\u5f97\u529b\u4e0d\u4ece\u5fc3\u3002\u672c\u7ae0\u63a2\u8ba8\u5982\u4f55\u5229\u7528\u5f20\u91cf\u5206\u89e3\u6280\u672f\u4f18\u96c5\u5730\u5efa\u6a21\u591a\u6a21\u6001\u63a8\u8350\u573a\u666f\uff0c\u91cd\u70b9\u5173\u6ce8\u53ef\u6269\u5c55\u6027\u3001\u7a00\u758f\u6027\u5904\u7406\u4ee5\u53ca\u8de8\u57df\u77e5\u8bc6\u8fc1\u79fb\u3002\u6211\u4eec\u5c06\u6df1\u5165\u5256\u6790CP\u5206\u89e3\u548cTucker\u5206\u89e3\u5728\u5341\u4ebf\u7ea7\u6570\u636e\u4e0a\u7684\u5de5\u7a0b\u5b9e\u73b0\uff0c\u4ee5\u53ca\u5982\u4f55\u901a\u8fc7\u8026\u5408\u77e9\u9635\u5206\u89e3\u5b9e\u73b0\u8de8\u57df\u63a8\u8350\u3002</p>\n<h2 id=\"161\">16.1 \u9ad8\u9636\u4ea4\u4e92\u7684\u5f20\u91cf\u5efa\u6a21</h2>\n<h3 id=\"1611\">16.1.1 \u4ece\u77e9\u9635\u5230\u5f20\u91cf\uff1a\u7ef4\u5ea6\u7684\u8bc5\u5492\u4e0e\u795d\u798f</h3>\n<p>\u5728\u4f20\u7edf\u7684\u534f\u540c\u8fc7\u6ee4\u4e2d\uff0c\u6211\u4eec\u7528\u4e8c\u7ef4\u77e9\u9635 $\\mathbf{R} \\in \\mathbb{R}^{m \\times n}$ \u8868\u793a\u7528\u6237-\u7269\u54c1\u4ea4\u4e92\u3002\u7136\u800c\uff0c\u73b0\u5b9e\u4e2d\u7684\u63a8\u8350\u573a\u666f\u5f80\u5f80\u6d89\u53ca\u66f4\u591a\u7ef4\u5ea6\uff1a</p>\n<ul>\n<li><strong>\u65f6\u95f4\u7ef4\u5ea6</strong>\uff1a\u7528\u6237\u504f\u597d\u968f\u65f6\u95f4\u53d8\u5316</li>\n<li><strong>\u4e0a\u4e0b\u6587\u7ef4\u5ea6</strong>\uff1a\u5730\u70b9\u3001\u8bbe\u5907\u3001\u5929\u6c14\u7b49\u73af\u5883\u56e0\u7d20</li>\n<li><strong>\u793e\u4ea4\u7ef4\u5ea6</strong>\uff1a\u597d\u53cb\u5173\u7cfb\u3001\u7fa4\u7ec4\u5f52\u5c5e</li>\n<li><strong>\u5185\u5bb9\u7ef4\u5ea6</strong>\uff1a\u7269\u54c1\u7684\u591a\u4e2a\u5c5e\u6027\u6807\u7b7e</li>\n</ul>\n<p>\u8fd9\u4e9b\u591a\u7ef4\u4ea4\u4e92\u81ea\u7136\u5730\u5f62\u6210\u4e86\u5f20\u91cf $\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times I_2 \\times \\cdots \\times I_N}$\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u4e09\u9636\u5f20\u91cf $\\mathcal{X} \\in \\mathbb{R}^{m \\times n \\times t}$ \u53ef\u4ee5\u8868\u793a\"\u7528\u6237-\u7269\u54c1-\u65f6\u95f4\"\u7684\u4ea4\u4e92\u6a21\u5f0f\u3002</p>\n<h3 id=\"1612\">16.1.2 \u5f20\u91cf\u7684\u57fa\u672c\u8fd0\u7b97\u4e0e\u6027\u8d28</h3>\n<p><strong>\u7ea4\u7ef4\uff08Fiber\uff09\u4e0e\u5207\u7247\uff08Slice\uff09</strong>\uff1a</p>\n<ul>\n<li>Mode-n \u7ea4\u7ef4\uff1a\u56fa\u5b9a\u9664\u7b2cn\u4e2a\u7d22\u5f15\u5916\u7684\u6240\u6709\u7d22\u5f15\u5f97\u5230\u7684\u5411\u91cf</li>\n<li>Mode-n \u5207\u7247\uff1a\u56fa\u5b9a\u7b2cn\u4e2a\u7d22\u5f15\u5f97\u5230\u7684\u5b50\u5f20\u91cf</li>\n</ul>\n<p><strong>Mode-n \u5c55\u5f00\uff08Matricization\uff09</strong>\uff1a\n\u5c06\u5f20\u91cf $\\mathcal{X}$ \u6cbf\u7b2cn\u4e2a\u6a21\u5f0f\u5c55\u5f00\u6210\u77e9\u9635 $\\mathbf{X}_{(n)}$\uff0c\u8fd9\u662f\u8bb8\u591a\u5f20\u91cf\u7b97\u6cd5\u7684\u57fa\u7840\u64cd\u4f5c\u3002\u5c55\u5f00\u89c4\u5219\uff1a\n$$\\mathbf{X}_{(n)} \\in \\mathbb{R}^{I_n \\times \\prod_{k \\neq n} I_k}$$\n<strong>\u5f20\u91cf\u4e0e\u77e9\u9635\u7684\u4e58\u79ef</strong>\uff1a\nMode-n \u4e58\u79ef\u5b9a\u4e49\u4e3a\uff1a\n$$\\mathcal{Y} = \\mathcal{X} \\times_n \\mathbf{U} \\Leftrightarrow \\mathbf{Y}_{(n)} = \\mathbf{U} \\mathbf{X}_{(n)}$$</p>\n<h3 id=\"1613\">16.1.3 \u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u5f20\u91cf\u5efa\u6a21\u5b9e\u4f8b</h3>\n<p><strong>\u6848\u4f8b1\uff1a\u65f6\u5e8f\u63a8\u8350</strong>\n\u6784\u5efa\u4e09\u9636\u5f20\u91cf $\\mathcal{R} \\in \\mathbb{R}^{|\\mathcal{U}| \\times |\\mathcal{I}| \\times |\\mathcal{T}|}$\uff0c\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathcal{U}$\uff1a\u7528\u6237\u96c6\u5408</li>\n<li>$\\mathcal{I}$\uff1a\u7269\u54c1\u96c6\u5408  </li>\n<li>$\\mathcal{T}$\uff1a\u65f6\u95f4\u7247\u6bb5\uff08\u5982\u5c0f\u65f6\u3001\u5929\u3001\u5468\uff09</li>\n</ul>\n<p>\u5f20\u91cf\u5143\u7d20 $r_{uit}$ \u8868\u793a\u7528\u6237 $u$ \u5728\u65f6\u95f4\u6bb5 $t$ \u5bf9\u7269\u54c1 $i$ \u7684\u8bc4\u5206\u6216\u9690\u5f0f\u53cd\u9988\u3002</p>\n<p><strong>\u5f20\u91cf\u6784\u5efa\u7684\u5173\u952e\u51b3\u7b56</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u65f6\u95f4\u79bb\u6563\u5316\u7b56\u7565</strong>\uff1a\n   - <strong>\u56fa\u5b9a\u7a97\u53e3</strong>\uff1a\u5c06\u8fde\u7eed\u65f6\u95f4\u5212\u5206\u4e3a\u7b49\u957f\u533a\u95f4\n   - <strong>\u81ea\u9002\u5e94\u7a97\u53e3</strong>\uff1a\u6839\u636e\u4ea4\u4e92\u5bc6\u5ea6\u52a8\u6001\u8c03\u6574\u7a97\u53e3\u5927\u5c0f\n   - <strong>\u591a\u5c3a\u5ea6\u5efa\u6a21</strong>\uff1a\u540c\u65f6\u7ef4\u62a4\u5c0f\u65f6\u3001\u5929\u3001\u5468\u7b49\u591a\u4e2a\u7c92\u5ea6\u7684\u5f20\u91cf</p>\n</li>\n<li>\n<p><strong>\u7f3a\u5931\u503c\u5904\u7406</strong>\uff1a\n   - <strong>\u663e\u5f0f\u7f3a\u5931</strong>\uff1a\u672a\u89c2\u6d4b\u4f4d\u7f6e\u4e0d\u53c2\u4e0e\u8ba1\u7b97\n   - <strong>\u9690\u5f0f\u8d1f\u53cd\u9988</strong>\uff1a\u91c7\u7528\u52a0\u6743\u7b56\u7565\uff0c$w_{uit} = \\alpha + \\beta \\cdot \\text{confidence}_{uit}$\n   - <strong>\u65f6\u95f4\u8870\u51cf\u586b\u5145</strong>\uff1a$\\hat{r}_{uit} = \\sum_{s&lt;t} \\gamma^{t-s} r_{uis}$</p>\n</li>\n</ol>\n<p>\u65f6\u95f4\u7c92\u5ea6\u7684\u9009\u62e9\u81f3\u5173\u91cd\u8981\uff1a</p>\n<ul>\n<li><strong>\u7ec6\u7c92\u5ea6</strong>\uff08\u5c0f\u65f6\u7ea7\uff09\uff1a\u6355\u83b7\u65e5\u5185\u6a21\u5f0f\uff0c\u5982\u5348\u9910\u65f6\u6bb5\u7684\u5916\u5356\u63a8\u8350</li>\n<li><strong>\u4e2d\u7c92\u5ea6</strong>\uff08\u5929\u7ea7\uff09\uff1a\u6355\u83b7\u5468\u5185\u6a21\u5f0f\uff0c\u5982\u5468\u672bvs\u5de5\u4f5c\u65e5\u7684\u5dee\u5f02</li>\n<li><strong>\u7c97\u7c92\u5ea6</strong>\uff08\u5468/\u6708\u7ea7\uff09\uff1a\u6355\u83b7\u5b63\u8282\u6027\u8d8b\u52bf\u548c\u957f\u671f\u5174\u8da3\u6f14\u5316</li>\n</ul>\n<p>\u65f6\u95f4\u5efa\u6a21\u7684\u9ad8\u7ea7\u6280\u5de7\uff1a</p>\n<ul>\n<li><strong>\u5faa\u73af\u65f6\u95f4\u7f16\u7801</strong>\uff1a\u5c06\u65f6\u95f4\u6620\u5c04\u5230\u5468\u671f\u7a7a\u95f4\uff0c\u5982 $(\\sin(2\\pi t/T), \\cos(2\\pi t/T))$</li>\n<li><strong>\u591a\u5c3a\u5ea6\u878d\u5408</strong>\uff1a\u540c\u65f6\u5efa\u6a21\u591a\u4e2a\u65f6\u95f4\u7c92\u5ea6\uff0c\u4f7f\u7528\u8026\u5408\u5f20\u91cf\u5206\u89e3</li>\n<li><strong>\u65f6\u95f4\u8870\u51cf\u6743\u91cd</strong>\uff1a$w_t = \\exp(-\\lambda(t_{\\text{now}} - t))$ \u5f3a\u8c03\u8fd1\u671f\u4ea4\u4e92</li>\n<li><strong>\u53d8\u70b9\u68c0\u6d4b</strong>\uff1a\u81ea\u52a8\u8bc6\u522b\u7528\u6237\u884c\u4e3a\u6a21\u5f0f\u7684\u7a81\u53d8\u70b9</li>\n<li><strong>\u5b63\u8282\u6027\u5206\u89e3</strong>\uff1a$\\mathcal{R} = \\mathcal{R}_{\\text{trend}} + \\mathcal{R}_{\\text{seasonal}} + \\mathcal{R}_{\\text{residual}}$</li>\n</ul>\n<p><strong>\u65f6\u95f4\u5f20\u91cf\u7684\u7279\u6b8a\u7ed3\u6784</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Toeplitz\u7ed3\u6784</strong>\uff1a\u5f53\u4ea4\u4e92\u6a21\u5f0f\u5177\u6709\u65f6\u95f4\u4e0d\u53d8\u6027\u65f6\n$$\\mathcal{R}_{:,:,t} \\approx f(\\mathcal{R}_{:,:,t-1}, \\mathcal{R}_{:,:,t-2}, ...)$$</p>\n</li>\n<li>\n<p><strong>\u4f4e\u79e9\u52a0\u7a00\u758f\u5206\u89e3</strong>\uff1a\n$$\\mathcal{R} = \\mathcal{L} + \\mathcal{S}$$\n\u5176\u4e2d $\\mathcal{L}$ \u6355\u83b7\u7a33\u5b9a\u6a21\u5f0f\uff0c$\\mathcal{S}$ \u6355\u83b7\u5f02\u5e38\u4e8b\u4ef6\uff08\u5982\u4fc3\u9500\u3001\u8282\u5047\u65e5\uff09</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u5f20\u91cf\u8865\u5168</strong>\uff1a\n$$\\min_{\\mathcal{X}} |\\mathcal{P}_\\Omega(\\mathcal{X} - \\mathcal{R})|_F^2 + \\lambda_1|\\mathcal{X}|_* + \\lambda_2\\sum_{t}|\\mathcal{X}_{:,:,t} - \\mathcal{X}_{:,:,t-1}|_F^2$$\n\u7b2c\u4e09\u9879\u5f3a\u5236\u65f6\u95f4\u5e73\u6ed1\u6027\u3002</p>\n</li>\n</ol>\n<p><strong>\u6848\u4f8b2\uff1a\u591a\u6a21\u6001\u5185\u5bb9\u63a8\u8350</strong>\n\u5bf9\u4e8e\u5305\u542b\u6587\u672c\u3001\u56fe\u50cf\u3001\u89c6\u9891\u7684\u591a\u6a21\u6001\u7269\u54c1\uff0c\u6784\u5efa\u56db\u9636\u5f20\u91cf\uff1a\n$$\\mathcal{X} \\in \\mathbb{R}^{|\\mathcal{U}| \\times |\\mathcal{I}| \\times |\\mathcal{M}| \\times |\\mathcal{F}|}$$\n\u5176\u4e2d $\\mathcal{M}$ \u662f\u6a21\u6001\u7c7b\u578b\uff0c$\\mathcal{F}$ \u662f\u7279\u5f81\u7ef4\u5ea6\u3002</p>\n<p>\u6a21\u6001\u878d\u5408\u7684\u5173\u952e\u8003\u8651\uff1a</p>\n<ul>\n<li><strong>\u65e9\u671f\u878d\u5408</strong>\uff1a\u5728\u5f20\u91cf\u5c42\u9762\u76f4\u63a5\u5efa\u6a21\u591a\u6a21\u6001\u4ea4\u4e92</li>\n<li><strong>\u665a\u671f\u878d\u5408</strong>\uff1a\u5206\u522b\u5bf9\u6bcf\u4e2a\u6a21\u6001\u8fdb\u884c\u5f20\u91cf\u5206\u89e3\uff0c\u7136\u540e\u878d\u5408\u7ed3\u679c</li>\n<li><strong>\u6ce8\u610f\u529b\u673a\u5236</strong>\uff1a\u5b66\u4e60\u7528\u6237\u5bf9\u4e0d\u540c\u6a21\u6001\u7684\u504f\u597d\u6743\u91cd</li>\n</ul>\n<p><strong>\u591a\u6a21\u6001\u5f20\u91cf\u7684\u6784\u5efa\u65b9\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7279\u5f81\u5bf9\u9f50</strong>\uff1a\n   - \u4f7f\u7528\u9884\u8bad\u7ec3\u6a21\u578b\uff08CLIP\u3001BERT\u7b49\uff09\u63d0\u53d6\u7edf\u4e00\u7ef4\u5ea6\u7684\u7279\u5f81\n   - \u8de8\u6a21\u6001\u5bf9\u9f50\uff1a$\\mathbf{f}_{\\text{aligned}} = \\text{CCA}(\\mathbf{f}_{\\text{text}}, \\mathbf{f}_{\\text{image}})$\n   - \u7ef4\u5ea6\u89c4\u8303\u5316\uff1a\u5c06\u4e0d\u540c\u6a21\u6001\u6620\u5c04\u5230\u76f8\u540c\u7684\u7279\u5f81\u7a7a\u95f4</p>\n</li>\n<li>\n<p><strong>\u6a21\u6001\u4ea4\u4e92\u5efa\u6a21</strong>\uff1a\n$$\\mathcal{X}_{uimf} = \\sum_{k=1}^{K} \\alpha_{umk} \\cdot \\beta_{ik} \\cdot \\gamma_{fk}$$\n\u5176\u4e2d $\\alpha_{umk}$ \u8868\u793a\u7528\u6237 $u$ \u5bf9\u6a21\u6001 $m$ \u4e2d\u7b2c $k$ \u4e2a\u6f5c\u5728\u56e0\u5b50\u7684\u504f\u597d\u3002</p>\n</li>\n<li>\n<p><strong>\u7f3a\u5931\u6a21\u6001\u5904\u7406</strong>\uff1a\n   - <strong>\u96f6\u586b\u5145</strong>\uff1a\u7b80\u5355\u4f46\u53ef\u80fd\u5f15\u5165\u504f\u5dee\n   - <strong>\u5747\u503c\u586b\u5145</strong>\uff1a\u4f7f\u7528\u540c\u7c7b\u7269\u54c1\u7684\u5e73\u5747\u7279\u5f81\n   - <strong>\u751f\u6210\u586b\u5145</strong>\uff1a\u8bad\u7ec3\u8de8\u6a21\u6001\u751f\u6210\u6a21\u578b\u586b\u8865\u7f3a\u5931</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u5efa\u6a21\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6a21\u6001\u7279\u5b9a\u7684\u6b63\u5219\u5316</strong>\uff1a\n$$\\mathcal{L} = |\\mathcal{X} - \\hat{\\mathcal{X}}|_F^2 + \\sum_{m} \\lambda_m \\mathcal{R}_m(\\mathbf{U}^{(m)})$$\n\u5176\u4e2d $\\mathcal{R}_m$ \u662f\u6a21\u6001\u7279\u5b9a\u7684\u6b63\u5219\u5316\u5668\uff08\u5982\u6587\u672c\u7684\u7a00\u758f\u6027\u3001\u56fe\u50cf\u7684\u5e73\u6ed1\u6027\uff09\u3002</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u5f20\u91cf\u7ed3\u6784</strong>\uff1a\n   - \u9876\u5c42\uff1a\u7528\u6237-\u7269\u54c1-\u6a21\u6001\u4ea4\u4e92\n   - \u4e2d\u5c42\uff1a\u6a21\u6001\u5185\u7684\u7279\u5f81\u4ea4\u4e92\n   - \u5e95\u5c42\uff1a\u539f\u59cb\u7279\u5f81\u8868\u793a</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u6a21\u6001\u9009\u62e9</strong>\uff1a\n   \u6839\u636e\u7528\u6237\u5386\u53f2\u884c\u4e3a\u52a8\u6001\u8c03\u6574\u4e0d\u540c\u6a21\u6001\u7684\u91cd\u8981\u6027\uff1a\n$$w_{um}^{(t)} = \\frac{\\exp(\\mathbf{u}_u^T \\mathbf{m}_m + b_{um}^{(t)})}{\\sum_{m'} \\exp(\\mathbf{u}_u^T \\mathbf{m}_{m'} + b_{um'}^{(t)})}$$\n<strong>\u6848\u4f8b3\uff1a\u793e\u4ea4\u63a8\u8350\u7f51\u7edc</strong>\n\u4e94\u9636\u5f20\u91cf\u5efa\u6a21 \"\u8c01-\u4ec0\u4e48-\u4f55\u65f6-\u4f55\u5730-\u4e0e\u8c01\"\uff1a\n$$\\mathcal{Y} \\in \\mathbb{R}^{|\\mathcal{U}| \\times |\\mathcal{I}| \\times |\\mathcal{T}| \\times |\\mathcal{L}| \\times |\\mathcal{G}|}$$\n\u5176\u4e2d\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>$\\mathcal{L}$\uff1a\u5730\u7406\u4f4d\u7f6e\uff08POI\u63a8\u8350\uff09</li>\n<li>$\\mathcal{G}$\uff1a\u793e\u4ea4\u7fa4\u7ec4\u6216\u5171\u540c\u53c2\u4e0e\u8005</li>\n</ul>\n<p>\u8fd9\u79cd\u9ad8\u9636\u5efa\u6a21\u80fd\u591f\u6355\u83b7\u590d\u6742\u7684\u60c5\u5883\u4f9d\u8d56\uff1a</p>\n<ul>\n<li>\u548c\u670b\u53cb\u4e00\u8d77\u65f6\u7684\u7535\u5f71\u504f\u597d vs \u72ec\u81ea\u89c2\u770b</li>\n<li>\u5de5\u4f5c\u5730\u70b9\u7684\u5348\u9910\u9009\u62e9 vs \u5bb6\u9644\u8fd1\u7684\u665a\u9910\u9009\u62e9</li>\n<li>\u5468\u672b\u805a\u4f1a\u7684\u97f3\u4e50\u54c1\u5473 vs \u65e5\u5e38\u901a\u52e4\u7684\u64ad\u653e\u5217\u8868</li>\n</ul>\n<p><strong>\u793e\u4ea4\u5f20\u91cf\u7684\u7279\u6b8a\u6311\u6218</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8d85\u9ad8\u7ef4\u6570\u7684\u5904\u7406</strong>\uff1a\n   - \u7ef4\u5ea6\u8bc5\u5492\u52a0\u5267\uff1a$O(\\prod_{i=1}^{5} d_i)$ \u7684\u53c2\u6570\u91cf\n   - \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u5f20\u91cf\u5217\u8f66\u5206\u89e3\uff08Tensor Train Decomposition\uff09\n$$\\mathcal{Y}_{i_1,i_2,i_3,i_4,i_5} \\approx \\mathbf{G}_1(i_1)\\mathbf{G}_2(i_2)\\mathbf{G}_3(i_3)\\mathbf{G}_4(i_4)\\mathbf{G}_5(i_5)$$\n\u5176\u4e2d $\\mathbf{G}_k$ \u662f\u4e09\u9636\u6838\u5f20\u91cf\uff08\u9664\u4e86\u8fb9\u754c\uff09\u3002</p>\n</li>\n<li>\n<p><strong>\u793e\u4ea4\u5f71\u54cd\u529b\u5efa\u6a21</strong>\uff1a\n$$r_{uitlg} = \\alpha \\cdot r_{uit}^{\\text{personal}} + \\beta \\cdot \\sum_{v \\in g} w_{uv} \\cdot r_{vit}^{\\text{social}}$$\n\u5176\u4e2d $w_{uv}$ \u662f\u793e\u4ea4\u5f71\u54cd\u529b\u6743\u91cd\uff0c\u53ef\u4ee5\u901a\u8fc7\u56fe\u795e\u7ecf\u7f51\u7edc\u5b66\u4e60\u3002</p>\n</li>\n<li>\n<p><strong>\u7fa4\u4f53\u51b3\u7b56\u5efa\u6a21</strong>\uff1a\n   - <strong>\u5e73\u5747\u7b56\u7565</strong>\uff1a$\\hat{r}_g = \\frac{1}{|g|}\\sum_{u \\in g} r_u$\n   - <strong>\u6700\u5c0f\u75db\u82e6\u7b56\u7565</strong>\uff1a$\\hat{r}_g = \\min_{u \\in g} r_u$\n   - <strong>\u7075\u6d3b\u6743\u8861</strong>\uff1a$\\hat{r}_g = \\prod_{u \\in g} r_u^{\\theta_u}$\uff0c\u5176\u4e2d $\\theta_u$ \u662f\u7528\u6237\u5728\u7fa4\u4f53\u4e2d\u7684\u51b3\u7b56\u6743\u91cd</p>\n</li>\n<li>\n<p><strong>\u65f6\u7a7a\u4f9d\u8d56\u6027</strong>\uff1a\n$$P(\\text{visit } l | u, t, g) = \\frac{\\exp(\\mathbf{u}_u^T \\mathbf{l}_l + \\mathbf{t}_t^T \\mathbf{l}_l + \\sum_{v \\in g} \\mathbf{v}_v^T \\mathbf{l}_l)}{\\sum_{l'} \\exp(\\cdot)}$$\n<strong>\u9ad8\u6548\u8fd1\u4f3c\u65b9\u6cd5</strong>\uff1a</p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u5206\u89e3</strong>\uff1a\n   - \u5148\u5206\u89e3\u4f4e\u9636\u5b50\u5f20\u91cf\uff1a$\\mathcal{Y}_{:,:,:} = \\text{CP}(\\mathcal{U}, \\mathcal{I}, \\mathcal{T})$\n   - \u518d\u5efa\u6a21\u9ad8\u9636\u4ea4\u4e92\uff1a$\\mathcal{Y}_{:,:,:,l,g} = f(\\mathcal{Y}_{:,:,:}, \\mathbf{L}_l, \\mathbf{G}_g)$</p>\n</li>\n<li>\n<p><strong>\u91c7\u6837\u7b56\u7565</strong>\uff1a\n   - \u91cd\u8981\u6027\u91c7\u6837\uff1a\u6839\u636e\u4ea4\u4e92\u9891\u7387\u91c7\u6837\n   - \u8d1f\u91c7\u6837\uff1a\u4ece\u672a\u89c2\u6d4b\u7684\u7ef4\u5ea6\u7ec4\u5408\u4e2d\u91c7\u6837</p>\n</li>\n</ol>\n<p><strong>\u6848\u4f8b4\uff1a\u591a\u4efb\u52a1\u5b66\u4e60\u5f20\u91cf</strong>\n\u5bf9\u4e8e\u9700\u8981\u540c\u65f6\u4f18\u5316\u591a\u4e2a\u76ee\u6807\u7684\u63a8\u8350\u7cfb\u7edf\uff08\u70b9\u51fb\u7387\u3001\u8f6c\u5316\u7387\u3001\u505c\u7559\u65f6\u95f4\u7b49\uff09\uff1a\n$$\\mathcal{Z} \\in \\mathbb{R}^{|\\mathcal{U}| \\times |\\mathcal{I}| \\times |\\mathcal{T}| \\times |\\mathcal{O}|}$$\n\u5176\u4e2d $\\mathcal{O}$ \u662f\u76ee\u6807\u51fd\u6570\u96c6\u5408\u3002\u8fd9\u5141\u8bb8\uff1a</p>\n<ul>\n<li>\u53d1\u73b0\u4e0d\u540c\u76ee\u6807\u95f4\u7684\u76f8\u5173\u6027\u6a21\u5f0f</li>\n<li>\u901a\u8fc7\u5f20\u91cf\u5206\u89e3\u5b9e\u73b0\u591a\u4efb\u52a1\u77e5\u8bc6\u5171\u4eab</li>\n<li>\u4e3a\u4e0d\u540c\u4e1a\u52a1\u76ee\u6807\u52a8\u6001\u8c03\u6574\u63a8\u8350\u7b56\u7565</li>\n</ul>\n<p><strong>\u591a\u4efb\u52a1\u5f20\u91cf\u5206\u89e3\u7684\u6570\u5b66\u6846\u67b6</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8054\u5408\u4f18\u5316\u76ee\u6807</strong>\uff1a\n$$\\min_{{\\mathbf{U}^{(n,o)}}} \\sum_{o \\in \\mathcal{O}} \\lambda_o |\\mathcal{Z}_{:,:,:,o} - \\text{CP}(\\mathbf{U}^{(1,o)}, \\mathbf{U}^{(2,o)}, \\mathbf{U}^{(3,o)})|_F^2$$\n\u5176\u4e2d\u90e8\u5206\u56e0\u5b50\u77e9\u9635\u5728\u4efb\u52a1\u95f4\u5171\u4eab\uff1a\n$$\\mathbf{U}^{(n,o)} = \\mathbf{U}^{(n)}_{\\text{shared}} + \\mathbf{U}^{(n,o)}_{\\text{specific}}$$</p>\n</li>\n<li>\n<p><strong>\u4efb\u52a1\u76f8\u5173\u6027\u5efa\u6a21</strong>\uff1a\n$$\\mathbf{R}_{\\mathcal{O}} = \\text{corr}(\\mathcal{Z}_{:,:,:,o_1}, \\mathcal{Z}_{:,:,:,o_2})$$\n\u4f7f\u7528\u4efb\u52a1\u76f8\u5173\u6027\u77e9\u9635\u6307\u5bfc\u5171\u4eab\u7a0b\u5ea6\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u9ad8\u76f8\u5173\u4efb\u52a1\uff1a\u66f4\u591a\u5171\u4eab\u53c2\u6570</li>\n<li>\u8d1f\u76f8\u5173\u4efb\u52a1\uff1a\u72ec\u7acb\u53c2\u6570\u6216\u5bf9\u6297\u5b66\u4e60</li>\n</ul>\n<ol start=\"3\">\n<li>\n<p><strong>Pareto\u6700\u4f18\u5e73\u8861</strong>\uff1a\n   \u4e0d\u540c\u4e8e\u7b80\u5355\u7684\u52a0\u6743\u548c\uff0c\u5bfb\u627ePareto\u6700\u4f18\u89e3\uff1a\n$$\\mathcal{P} = {\\theta : \\nexists \\theta' \\text{ s.t. } L_o(\\theta') \\leq L_o(\\theta) \\, \\forall o \\text{ and } L_{o'}(\\theta') &lt; L_{o'}(\\theta) \\text{ for some } o'}$$</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u6743\u91cd\u8c03\u6574</strong>\uff1a\n$$\\lambda_o^{(t)} = \\lambda_o^{(0)} \\cdot \\exp\\left(-\\frac{\\nabla L_o}{|\\nabla L_o|_2}\\right)$$\n\u68af\u5ea6\u8303\u6570\u8f83\u5927\u7684\u4efb\u52a1\u83b7\u5f97\u66f4\u9ad8\u6743\u91cd\u3002</p>\n</li>\n</ol>\n<p><strong>\u5b9e\u9645\u5e94\u7528\u4e2d\u7684\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u9636\u6bb5\u8bad\u7ec3</strong>\uff1a\n   - \u9636\u6bb51\uff1a\u72ec\u7acb\u8bad\u7ec3\u5404\u4efb\u52a1\u83b7\u5f97\u521d\u59cb\u5316\n   - \u9636\u6bb52\uff1a\u8054\u5408\u5fae\u8c03\u5171\u4eab\u53c2\u6570\n   - \u9636\u6bb53\uff1a\u7cbe\u7ec6\u8c03\u6574\u4efb\u52a1\u7279\u5b9a\u53c2\u6570</p>\n</li>\n<li>\n<p><strong>\u4e0d\u786e\u5b9a\u6027\u91cf\u5316</strong>\uff1a\n   \u4f7f\u7528\u8d1d\u53f6\u65af\u5f20\u91cf\u5206\u89e3\u91cf\u5316\u9884\u6d4b\u4e0d\u786e\u5b9a\u6027\uff1a\n$$p(\\mathcal{Z}|\\mathcal{X}) = \\int p(\\mathcal{Z}|\\mathcal{U})p(\\mathcal{U}|\\mathcal{X})d\\mathcal{U}$$</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u66f4\u65b0</strong>\uff1a\n   \u5f53\u65b0\u4efb\u52a1\u52a0\u5165\u65f6\uff0c\u4ec5\u66f4\u65b0\u76f8\u5173\u7684\u5f20\u91cf\u5207\u7247\uff1a\n$$\\mathcal{Z}_{:,:,:,o_{\\text{new}}} = \\text{transfer_learning}(\\mathcal{Z}_{:,:,:,o_{\\text{similar}}})$$</p>\n</li>\n</ol>\n<h3 id=\"1614\">16.1.4 \u7a00\u758f\u6027\u6311\u6218\u4e0e\u673a\u9047</h3>\n<p>\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u5f20\u91cf\u6781\u5ea6\u7a00\u758f\uff0c\u89c2\u6d4b\u7387\u901a\u5e38\u4f4e\u4e8e 0.01%\u3002\u8fd9\u5e26\u6765\u4e86\u8ba1\u7b97\u548c\u7edf\u8ba1\u4e24\u65b9\u9762\u7684\u6311\u6218\uff1a</p>\n<p><strong>\u7a00\u758f\u6027\u7684\u6839\u672c\u539f\u56e0</strong>\uff1a</p>\n<ol>\n<li><strong>\u957f\u5c3e\u5206\u5e03</strong>\uff1a\u5927\u90e8\u5206\u7528\u6237\u53ea\u4e0e\u5c11\u6570\u7269\u54c1\u4ea4\u4e92</li>\n<li><strong>\u65f6\u7a7a\u5c40\u90e8\u6027</strong>\uff1a\u7528\u6237\u5728\u7279\u5b9a\u65f6\u95f4\u548c\u5730\u70b9\u7684\u6d3b\u52a8\u6709\u9650</li>\n<li><strong>\u9009\u62e9\u6027\u504f\u5dee</strong>\uff1a\u7528\u6237\u503e\u5411\u4e8e\u4e0e\u611f\u5174\u8da3\u7684\u5185\u5bb9\u4ea4\u4e92</li>\n<li><strong>\u5e73\u53f0\u9650\u5236</strong>\uff1a\u63a8\u8350\u7cfb\u7edf\u53ea\u5c55\u793a\u6709\u9650\u9009\u9879</li>\n</ol>\n<p><strong>\u8ba1\u7b97\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u5b58\u50a8\u5f00\u9500\uff1a\u7a20\u5bc6\u5b58\u50a8\u4e0d\u73b0\u5b9e</li>\n<li>\u8fd0\u7b97\u6548\u7387\uff1a\u5927\u91cf\u96f6\u5143\u7d20\u53c2\u4e0e\u8ba1\u7b97</li>\n<li>\u5185\u5b58\u8bbf\u95ee\uff1a\u968f\u673a\u8bbf\u95ee\u6a21\u5f0f\u5bfc\u81f4cache miss</li>\n<li>\u8d1f\u8f7d\u5747\u8861\uff1a\u975e\u96f6\u5143\u7d20\u5206\u5e03\u4e0d\u5747\u5bfc\u81f4\u5e76\u884c\u6548\u7387\u4f4e\u4e0b</li>\n</ul>\n<p><strong>\u7edf\u8ba1\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u8fc7\u62df\u5408\u98ce\u9669\uff1a\u53c2\u6570\u8fdc\u591a\u4e8e\u89c2\u6d4b</li>\n<li>\u51b7\u542f\u52a8\u95ee\u9898\uff1a\u65b0\u7528\u6237/\u7269\u54c1\u7f3a\u4e4f\u6570\u636e</li>\n<li>\u8d1f\u91c7\u6837\u504f\u5dee\uff1a\u672a\u89c2\u6d4b\u4e0d\u7b49\u4e8e\u8d1f\u6837\u672c</li>\n<li>\u566a\u58f0\u654f\u611f\u6027\uff1a\u7a00\u758f\u6570\u636e\u4e2d\u7684\u5f02\u5e38\u503c\u5f71\u54cd\u66f4\u5927</li>\n</ul>\n<p>\u7136\u800c\uff0c\u7a00\u758f\u6027\u4e5f\u5e26\u6765\u673a\u9047\uff1a</p>\n<ul>\n<li>\u4f4e\u79e9\u5047\u8bbe\u66f4\u53ef\u80fd\u6210\u7acb</li>\n<li>\u53ef\u5229\u7528\u9690\u5f0f\u6b63\u5219\u5316</li>\n<li>\u8ba1\u7b97\u53ef\u5927\u5e45\u4f18\u5316</li>\n<li>\u652f\u6301\u5728\u7ebf\u589e\u91cf\u5b66\u4e60</li>\n</ul>\n<p><strong>\u7a00\u758f\u6027\u7684\u6570\u5b66\u89c6\u89d2</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6838\u8303\u6570\u6b63\u5219\u5316\u7684\u9690\u5f0f\u504f\u597d</strong>\uff1a\n   \u7a00\u758f\u89c2\u6d4b\u4e0b\u7684\u5f20\u91cf\u8865\u5168\u7b49\u4ef7\u4e8e\uff1a\n$$\\min_{\\mathcal{X}} |\\mathcal{P}_\\Omega(\\mathcal{X} - \\mathcal{M})|_F^2 + \\lambda |\\mathcal{X}|_*$$\n\u5176\u4e2d $|\\cdot|_*$ \u662f\u5f20\u91cf\u6838\u8303\u6570\uff0c$\\mathcal{P}_\\Omega$ \u662f\u89c2\u6d4b\u4f4d\u7f6e\u7684\u6295\u5f71\u7b97\u5b50\u3002</p>\n</li>\n<li>\n<p><strong>\u91c7\u6837\u590d\u6742\u5ea6\u754c</strong>\uff1a\n   \u5bf9\u4e8e\u79e9\u4e3a $r$ \u7684 $n_1 \\times n_2 \\times n_3$ \u5f20\u91cf\uff0c\u53ef\u9760\u6062\u590d\u6240\u9700\u7684\u6837\u672c\u6570\uff1a\n$$m \\geq C \\cdot r \\cdot (n_1 + n_2 + n_3) \\cdot \\log^2(n_1 n_2 n_3)$$\n\u8fd9\u8fdc\u5c0f\u4e8e\u603b\u5143\u7d20\u6570 $n_1 n_2 n_3$\u3002</p>\n</li>\n<li>\n<p><strong>\u76f8\u5e72\u6027\uff08Coherence\uff09\u6761\u4ef6</strong>\uff1a\n   \u6210\u529f\u6062\u590d\u9700\u8981\u5f20\u91cf\u7684\u5947\u5f02\u5411\u91cf\u4e0d\u80fd\u8fc7\u5ea6\u96c6\u4e2d\uff1a\n$$\\mu(\\mathcal{X}) = \\max_i \\frac{n}{r} |\\mathbf{u}_i|_\\infty^2 \\leq \\mu_0$$\n\u9ad8\u76f8\u5e72\u6027\uff08\u5982\u67d0\u4e9b\u7528\u6237\u7279\u522b\u6d3b\u8dc3\uff09\u4f1a\u589e\u52a0\u6062\u590d\u96be\u5ea6\u3002</p>\n</li>\n</ol>\n<p><strong>\u76f8\u5e72\u6027\u7684\u5b9e\u9645\u542b\u4e49</strong>\uff1a</p>\n<ul>\n<li><strong>\u4f4e\u76f8\u5e72\u6027</strong>\uff1a\u4fe1\u606f\u5747\u5300\u5206\u5e03\uff0c\u6613\u4e8e\u6062\u590d</li>\n<li><strong>\u9ad8\u76f8\u5e72\u6027</strong>\uff1a\u4fe1\u606f\u96c6\u4e2d\u5728\u5c11\u6570\u7ef4\u5ea6\uff0c\u96be\u4ee5\u6062\u590d</li>\n<li><strong>\u5904\u7406\u65b9\u6cd5</strong>\uff1a\u91cd\u52a0\u6743\u91c7\u6837\u3001\u6b63\u5219\u5316\u7ea6\u675f</li>\n</ul>\n<p><strong>\u5b9e\u7528\u7684\u7a00\u758f\u6027\u5904\u7406\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u91c7\u6837</strong>\uff1a\n   - \u57fa\u4e8e\u4e0d\u786e\u5b9a\u6027\u7684\u4e3b\u52a8\u5b66\u4e60\u91c7\u6837\n   - leverage score\u91c7\u6837\u63d0\u9ad8\u4fe1\u606f\u91cf\n   - \u91cd\u8981\u6027\u91c7\u6837\u51cf\u5c11\u65b9\u5dee</p>\n</li>\n<li>\n<p><strong>\u8f85\u52a9\u4fe1\u606f\u5229\u7528</strong>\uff1a\n   - \u5f15\u5165\u7528\u6237/\u7269\u54c1\u7279\u5f81\u4f5c\u4e3aside information\n   - \u5229\u7528\u9690\u5f0f\u53cd\u9988\uff08\u6d4f\u89c8\u3001\u6536\u85cf\u7b49\uff09\n   - \u8fc1\u79fb\u5b66\u4e60\u4ece\u76f8\u5173\u57df\u501f\u529b</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u6027\u611f\u77e5\u7684\u4f18\u5316</strong>\uff1a\n   - \u53ea\u5728\u89c2\u6d4b\u4f4d\u7f6e\u8ba1\u7b97\u635f\u5931\u548c\u68af\u5ea6\n   - \u4f7f\u7528coordinate descent\u51cf\u5c11\u8ba1\u7b97\n   - \u91c7\u7528importance sampling\u52a0\u901f\u6536\u655b</p>\n</li>\n<li>\n<p><strong>\u9c81\u68d2\u6027\u589e\u5f3a</strong>\uff1a\n   - Huber\u635f\u5931\u5904\u7406\u5f02\u5e38\u503c\n   - \u77e9\u9635\u8865\u5168\u7684\u9c81\u68d2PCA\u6269\u5c55\n   - \u8d1d\u53f6\u65af\u65b9\u6cd5\u91cf\u5316\u4e0d\u786e\u5b9a\u6027</p>\n</li>\n</ol>\n<h2 id=\"162-cptucker\">16.2 CP\u5206\u89e3\u4e0eTucker\u5206\u89e3\u7684\u53ef\u6269\u5c55\u5b9e\u73b0</h2>\n<h3 id=\"1621-cpcandecompparafac\">16.2.1 CP\u5206\u89e3\uff08CANDECOMP/PARAFAC\uff09</h3>\n<p>CP\u5206\u89e3\u5c06\u5f20\u91cf\u8868\u793a\u4e3a\u79e9\u4e00\u5f20\u91cf\u4e4b\u548c\uff1a\n$$\\mathcal{X} \\approx \\sum_{r=1}^{R} \\lambda_r \\mathbf{a}_r^{(1)} \\circ \\mathbf{a}_r^{(2)} \\circ \\cdots \\circ \\mathbf{a}_r^{(N)}$$\n\u5176\u4e2d $\\circ$ \u8868\u793a\u5916\u79ef\uff0c$\\lambda_r$ \u662f\u6743\u91cd\uff0c$\\mathbf{a}_r^{(n)}$ \u662f\u7b2c $n$ \u4e2a\u6a21\u5f0f\u7684\u56e0\u5b50\u5411\u91cf\u3002</p>\n<p><strong>\u77e9\u9635\u5f62\u5f0f</strong>\uff1a\n\u5b9a\u4e49\u56e0\u5b50\u77e9\u9635 $\\mathbf{A}^{(n)} = [\\mathbf{a}_1^{(n)}, \\ldots, \\mathbf{a}_R^{(n)}]$\uff0c\u5219\uff1a\n$$\\mathbf{X}_{(n)} \\approx \\mathbf{A}^{(n)} \\boldsymbol{\\Lambda} (\\mathbf{A}^{(N)} \\odot \\cdots \\odot \\mathbf{A}^{(n+1)} \\odot \\mathbf{A}^{(n-1)} \\odot \\cdots \\odot \\mathbf{A}^{(1)})^T$$</p>\n<h3 id=\"1622-als-cp\">16.2.2 \u53ef\u6269\u5c55\u7684ALS-CP\u7b97\u6cd5</h3>\n<p>\u4ea4\u66ff\u6700\u5c0f\u4e8c\u4e58\uff08ALS\uff09\u662f\u6c42\u89e3CP\u5206\u89e3\u7684\u4e3b\u6d41\u65b9\u6cd5\u3002\u5bf9\u4e8e\u7b2c $n$ \u4e2a\u6a21\u5f0f\u7684\u66f4\u65b0\uff1a\n$$\\mathbf{A}^{(n)} = \\mathbf{X}_{(n)} \\mathbf{Z}^{(n)} (\\mathbf{V}^{(n)})^{-1}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathbf{Z}^{(n)} = \\mathbf{A}^{(N)} \\odot \\cdots \\odot \\mathbf{A}^{(n+1)} \\odot \\mathbf{A}^{(n-1)} \\odot \\cdots \\odot \\mathbf{A}^{(1)}$</li>\n<li>$\\mathbf{V}^{(n)} = \\prod_{k \\neq n} (\\mathbf{A}^{(k)})^T \\mathbf{A}^{(k)}$\uff08\u9010\u5143\u7d20\u4e58\u79ef\uff09</li>\n</ul>\n<p><strong>\u7a00\u758f\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>MTTKRP\u4f18\u5316</strong>\uff08Matricized Tensor Times Khatri-Rao Product\uff09\uff1a\n   - \u907f\u514d\u663e\u5f0f\u5f62\u6210 Khatri-Rao \u79ef\n   - \u5229\u7528\u7a00\u758f\u5f20\u91cf\u7684\u5750\u6807\u683c\u5f0f\uff08COO\uff09\n   - \u590d\u6742\u5ea6\u4ece $O(R \\prod_k I_k)$ \u964d\u81f3 $O(R \\cdot nnz(\\mathcal{X}))$</p>\n</li>\n<li>\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong>\uff1a\n   - Mode-wise \u5e76\u884c\uff1a\u4e0d\u540c\u8fdb\u7a0b\u66f4\u65b0\u4e0d\u540c\u6a21\u5f0f\n   - Element-wise \u5e76\u884c\uff1a\u5212\u5206\u5f20\u91cf\u5143\u7d20\n   - Hybrid \u5e76\u884c\uff1a\u7ed3\u5408\u4e24\u79cd\u7b56\u7565</p>\n</li>\n</ol>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u8bc1</strong>\uff1a</p>\n<ol>\n<li><strong>\u6b63\u5219\u5316\u7684ALS\u66f4\u65b0</strong>\uff1a\n$$\\mathbf{A}^{(n)} = \\mathbf{X}_{(n)} \\mathbf{Z}^{(n)} (\\mathbf{V}^{(n)} + \\lambda \\mathbf{I})^{-1}$$\n\u9009\u62e9 $\\lambda$ \u7684\u81ea\u9002\u5e94\u7b56\u7565\uff1a</li>\n</ol>\n<ul>\n<li>\u57fa\u4e8e\u6761\u4ef6\u6570\uff1a$\\lambda = \\epsilon \\cdot \\sigma_\\max(\\mathbf{V}^{(n)})$</li>\n<li>\u57fa\u4e8e\u566a\u58f0\u6c34\u5e73\uff1a$\\lambda = \\sigma^2 / \\text{SNR}$</li>\n<li>\u8d1d\u53f6\u65af\u89c6\u89d2\uff1a$\\lambda$ \u5bf9\u5e94\u5148\u9a8c\u5f3a\u5ea6</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p><strong>QR\u5206\u89e3\u7a33\u5b9a\u5316</strong>\uff1a\n   \u5f53 $\\mathbf{V}^{(n)}$ \u63a5\u8fd1\u5947\u5f02\u65f6\uff0c\u4f7f\u7528QR\u5206\u89e3\uff1a\n   <code>[Q, R] = qr([Z^(n); sqrt(\u03bb)I], 0)\n   A^(n) = X_(n) * (Q(1:end-R,:) / R)</code></p>\n</li>\n<li>\n<p><strong>\u884c\u5f52\u4e00\u5316\u7b56\u7565</strong>\uff1a\n   \u6bcf\u6b21\u8fed\u4ee3\u540e\u5f52\u4e00\u5316\u56e0\u5b50\u77e9\u9635\uff0c\u5c06\u5c3a\u5ea6\u5438\u6536\u5230 $\\lambda_r$\uff1a\n$$\\mathbf{a}_r^{(n)} \\leftarrow \\frac{\\mathbf{a}_r^{(n)}}{|\\mathbf{a}_r^{(n)}|}, \\quad \\lambda_r \\leftarrow \\lambda_r \\prod_n |\\mathbf{a}_r^{(n)}|$$\n<strong>\u6536\u655b\u52a0\u901f\u6280\u672f</strong>\uff1a</p>\n</li>\n<li>\n<p><strong>\u7ebf\u641c\u7d22</strong>\uff1a\n   \u4e0d\u76f4\u63a5\u63a5\u53d7ALS\u66f4\u65b0\uff0c\u800c\u662f\u5bfb\u627e\u6700\u4f18\u6b65\u957f\uff1a\n$$\\mathbf{A}^{(n)}_{\\text{new}} = (1-\\alpha)\\mathbf{A}^{(n)}_{\\text{old}} + \\alpha \\mathbf{A}^{(n)}_{\\text{ALS}}$$</p>\n</li>\n<li>\n<p><strong>\u52a8\u91cf\u65b9\u6cd5</strong>\uff1a\n   \u501f\u9274\u6df1\u5ea6\u5b66\u4e60\u7684\u52a8\u91cf\u6280\u5de7\uff1a\n$$\\mathbf{V}_t^{(n)} = \\beta \\mathbf{V}_{t-1}^{(n)} + (1-\\beta)\\nabla f_t$$\n   $$\\mathbf{A}_t^{(n)} = \\mathbf{A}_{t-1}^{(n)} - \\eta \\mathbf{V}_t^{(n)}$$</p>\n</li>\n<li>\n<p><strong>Anderson\u52a0\u901f</strong>\uff1a\n   \u5229\u7528\u5386\u53f2\u8fed\u4ee3\u4fe1\u606f\u6784\u9020\u66f4\u597d\u7684\u66f4\u65b0\u65b9\u5411\uff0c\u7279\u522b\u9002\u5408ALS\u8fd9\u7c7b\u5b9a\u70b9\u8fed\u4ee3\u3002</p>\n</li>\n</ol>\n<p><strong>\u5927\u89c4\u6a21\u5b9e\u73b0\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u5206\u5757\u66f4\u65b0</strong>\uff1a\n   \u5c06\u56e0\u5b50\u77e9\u9635 $\\mathbf{A}^{(n)}$ \u6309\u884c\u5206\u5757\uff0c\u6bcf\u6b21\u53ea\u66f4\u65b0\u4e00\u4e2a\u5757\uff1a</li>\n</ol>\n<ul>\n<li>\u51cf\u5c11\u5185\u5b58\u9700\u6c42</li>\n<li>\u63d0\u9ad8\u7f13\u5b58\u5229\u7528\u7387</li>\n<li>\u652f\u6301\u5728\u7ebf\u5b66\u4e60</li>\n</ul>\n<ol start=\"2\">\n<li><strong>\u91c7\u6837ALS</strong>\uff1a\n   \u6bcf\u6b21\u8fed\u4ee3\u53ea\u4f7f\u7528\u90e8\u5206\u975e\u96f6\u5143\u7d20\uff1a</li>\n</ol>\n<ul>\n<li>\u5747\u5300\u91c7\u6837\uff1a\u7b80\u5355\u4f46\u53ef\u80fd\u6709\u504f</li>\n<li>\u91cd\u8981\u6027\u91c7\u6837\uff1a\u57fa\u4e8eleverage score</li>\n<li>\u5206\u5c42\u91c7\u6837\uff1a\u4fdd\u8bc1\u6bcf\u4e2a\u7528\u6237/\u7269\u54c1\u88ab\u91c7\u6837</li>\n</ul>\n<ol start=\"3\">\n<li><strong>\u5f02\u6b65ALS</strong>\uff1a\n   \u4e0d\u7b49\u5f85\u6240\u6709\u6a21\u5f0f\u66f4\u65b0\u5b8c\u6210\uff1a</li>\n</ol>\n<ul>\n<li>Hogwild!\u98ce\u683c\u7684\u65e0\u9501\u66f4\u65b0</li>\n<li>\u5ef6\u8fdf\u8865\u507f\u673a\u5236</li>\n<li>\u7406\u8bba\u4fdd\u8bc1\uff1a\u5728\u6e29\u548c\u6761\u4ef6\u4e0b\u6536\u655b</li>\n</ul>\n<h3 id=\"1623-tucker\">16.2.3 Tucker\u5206\u89e3</h3>\n<p>Tucker\u5206\u89e3\u662fCP\u5206\u89e3\u7684\u63a8\u5e7f\uff1a\n$$\\mathcal{X} \\approx \\mathcal{G} \\times_1 \\mathbf{U}^{(1)} \\times_2 \\mathbf{U}^{(2)} \\times_3 \\cdots \\times_N \\mathbf{U}^{(N)}$$\n\u5176\u4e2d $\\mathcal{G} \\in \\mathbb{R}^{R_1 \\times R_2 \\times \\cdots \\times R_N}$ \u662f\u6838\u5fc3\u5f20\u91cf\uff0c$\\mathbf{U}^{(n)} \\in \\mathbb{R}^{I_n \\times R_n}$ \u662f\u56e0\u5b50\u77e9\u9635\u3002</p>\n<p><strong>\u4e0eCP\u5206\u89e3\u7684\u5173\u7cfb</strong>\uff1a\n\u5f53\u6838\u5fc3\u5f20\u91cf $\\mathcal{G}$ \u662f\u8d85\u5bf9\u89d2\u65f6\uff0cTucker\u5206\u89e3\u9000\u5316\u4e3aCP\u5206\u89e3\u3002</p>\n<h3 id=\"1624-tucker-als\">16.2.4 \u9ad8\u6548\u7684Tucker-ALS\u5b9e\u73b0</h3>\n<p><strong>HOOI\u7b97\u6cd5</strong>\uff08Higher-Order Orthogonal Iteration\uff09\uff1a</p>\n<ol>\n<li>\u521d\u59cb\u5316\u56e0\u5b50\u77e9\u9635 $\\mathbf{U}^{(n)}$</li>\n<li>\n<p>\u91cd\u590d\u76f4\u81f3\u6536\u655b\uff1a\n   - \u5bf9\u6bcf\u4e2a\u6a21\u5f0f $n$\uff1a\n$$\\mathbf{Y} = \\mathcal{X} \\times_1 (\\mathbf{U}^{(1)})^T \\times_2 \\cdots \\times_{n-1} (\\mathbf{U}^{(n-1)})^T \\times_{n+1} (\\mathbf{U}^{(n+1)})^T \\times_N \\cdots \\times_N (\\mathbf{U}^{(N)})^T$$\n     $$\\mathbf{U}^{(n)} = \\text{leading_eigenvectors}(\\mathbf{Y}_{(n)} \\mathbf{Y}_{(n)}^T, R_n)$$</p>\n</li>\n<li>\n<p>\u8ba1\u7b97\u6838\u5fc3\u5f20\u91cf\uff1a$\\mathcal{G} = \\mathcal{X} \\times_1 (\\mathbf{U}^{(1)})^T \\times_2 \\cdots \\times_N (\\mathbf{U}^{(N)})^T$</p>\n</li>\n</ol>\n<p><strong>\u5185\u5b58\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>\u907f\u514d\u5b58\u50a8\u4e2d\u95f4\u5f20\u91cf $\\mathbf{Y}$</li>\n<li>\u4f7f\u7528 tensor-matrix chain multiplication</li>\n<li>\u5b9e\u73b0 memory-efficient HOOI (ME-HOOI)</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li><strong>\u589e\u91cfSVD\u66f4\u65b0</strong>\uff1a\n   \u4e0d\u6bcf\u6b21\u90fd\u8ba1\u7b97\u5b8c\u6574SVD\uff0c\u800c\u662f\u4f7f\u7528\u589e\u91cf\u65b9\u6cd5\uff1a\n   <code>\u5df2\u6709\uff1aU\u03a3V^T \u2248 Y_(n)\n   \u65b0\u6570\u636e\u5230\u8fbe\uff1a\u0394Y\n   \u66f4\u65b0\uff1a[U', \u03a3', V'] = incremental_svd(U, \u03a3, V, \u0394Y)</code></li>\n</ol>\n<p>\u590d\u6742\u5ea6\u4ece $O(I_n^2 J_n)$ \u964d\u81f3 $O(I_n R_n^2)$\uff0c\u5176\u4e2d $J_n = \\prod_{k \\neq n} I_k$\u3002</p>\n<ol start=\"2\">\n<li>\n<p><strong>\u968f\u673a\u5316HOOI</strong>\uff1a\n   \u4f7f\u7528\u968f\u673a\u6295\u5f71\u52a0\u901fSVD\u8ba1\u7b97\uff1a\n   <code>\u03a9 = randn(J_n, k)  # k = R_n + oversampling\n   Q = orth(Y_(n) * \u03a9)\n   B = Q^T * Y_(n)\n   [U_B, S, V] = svd(B)\n   U^(n) = Q * U_B(:, 1:R_n)</code></p>\n</li>\n<li>\n<p><strong>\u5757Tucker\u5206\u89e3</strong>\uff1a\n   \u5c06\u5927\u5f20\u91cf\u5206\u5272\u6210\u5c0f\u5757\uff0c\u5206\u522b\u5904\u7406\uff1a\n$$\\mathcal{X} = \\sum_{b=1}^{B} \\mathcal{X}_b$$\n   $$\\mathcal{X}_b \\approx \\mathcal{G}_b \\times_1 \\mathbf{U}_b^{(1)} \\times_2 \\mathbf{U}_b^{(2)} \\times_3 \\mathbf{U}_b^{(3)}$$\n\u4f18\u52bf\uff1a</p>\n</li>\n</ol>\n<ul>\n<li>\u6bcf\u4e2a\u5757\u53ef\u5e76\u884c\u5904\u7406</li>\n<li>\u5185\u5b58\u9700\u6c42\u5927\u5e45\u964d\u4f4e</li>\n<li>\u652f\u6301\u6d41\u5f0f\u5904\u7406</li>\n</ul>\n<ol start=\"4\">\n<li><strong>\u81ea\u9002\u5e94\u79e9\u9009\u62e9</strong>\uff1a\n   \u4e0d\u9700\u8981\u9884\u5148\u6307\u5b9a $(R_1, R_2, ..., R_N)$\uff1a\n   <code>\u5bf9\u4e8e\u6bcf\u4e2a\u6a21\u5f0f n:\n       \u8ba1\u7b97\u5947\u5f02\u503c\u8870\u51cf\u7387\n       R_n = argmin{r: \u03a3_{i=1}^r s_i^2 / \u03a3_{i=1}^{I_n} s_i^2 &gt; \u03b8}</code></li>\n</ol>\n<p>\u5176\u4e2d $\\theta$ \u662f\u80fd\u91cf\u4fdd\u7559\u9608\u503c\uff08\u5982 0.95\uff09\u3002</p>\n<p><strong>\u7a00\u758fTucker\u5206\u89e3</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7a00\u758f\u6838\u5fc3\u5f20\u91cf</strong>\uff1a\n   \u5728\u6838\u5fc3\u5f20\u91cf\u4e0a\u65bd\u52a0\u7a00\u758f\u6027\u7ea6\u675f\uff1a\n$$\\min_{\\mathcal{G}, {\\mathbf{U}^{(n)}}} |\\mathcal{X} - \\mathcal{G} \\times {\\mathbf{U}^{(n)}}|_F^2 + \\lambda |\\mathcal{G}|_1$$\n\u4f7f\u7528\u8f6f\u9608\u503c\u7b97\u5b50\uff1a$\\mathcal{G} \\leftarrow \\text{soft}(\\mathcal{G}, \\lambda)$</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u56e0\u5b50\u77e9\u9635</strong>\uff1a\n   \u4fc3\u8fdb\u56e0\u5b50\u77e9\u9635\u7684\u5217\u7a00\u758f\u6027\uff1a\n$$\\min |\\mathcal{X} - \\text{tucker}(\\mathcal{G}, {\\mathbf{U}^{(n)}})|_F^2 + \\sum_n \\lambda_n |\\mathbf{U}^{(n)}|_{2,1}$$\n\u5176\u4e2d $|\\cdot|_{2,1}$ \u662f\u7ec4LASSO\u8303\u6570\u3002</p>\n</li>\n</ol>\n<p><strong>\u5e76\u884c\u5316\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li><strong>\u6a21\u5f0f\u5e76\u884c</strong>\uff1a\n   <code>parallel for n = 1:N\n       \u8ba1\u7b97 Y^(n) = X \u00d7 {U^(k)^T}_{k\u2260n}\n       \u66f4\u65b0 U^(n) = svd(Y^(n)_(n), R_n)\n   end</code></li>\n</ol>\n<p>\u6ce8\u610f\uff1a\u9700\u8981\u540c\u6b65\u4ee5\u4fdd\u8bc1\u4e00\u81f4\u6027\u3002</p>\n<ol start=\"2\">\n<li>\n<p><strong>\u6570\u636e\u5e76\u884c</strong>\uff1a\n   \u5c06\u5f20\u91cf\u6309\u67d0\u4e2a\u6a21\u5f0f\u5206\u5272\uff1a\n   <code>X = [X_1; X_2; ...; X_P]  # \u6cbfmode-1\u5206\u5272\n   \u6bcf\u4e2a\u8282\u70b9p\u8ba1\u7b97\uff1a\n       Y_p^(n) = X_p \u00d7 {U^(k)^T}_{k\u2260n}\n   \u5168\u5c40\u5f52\u7ea6\uff1a\n       Y^(n) = gather(Y_1^(n), ..., Y_P^(n))</code></p>\n</li>\n<li>\n<p><strong>\u6d41\u6c34\u7ebf\u5e76\u884c</strong>\uff1a\n   \u4e0d\u540c\u6a21\u5f0f\u7684\u66f4\u65b0\u53ef\u4ee5\u6d41\u6c34\u7ebf\u5316\uff1a\n   <code>\u65f6\u523b1: \u66f4\u65b0U^(1)\n   \u65f6\u523b2: \u66f4\u65b0U^(2), \u4f20\u8f93U^(1)\n   \u65f6\u523b3: \u66f4\u65b0U^(3), \u4f20\u8f93U^(2), \u4f7f\u7528U^(1)\n   ...</code></p>\n</li>\n</ol>\n<h3 id=\"1625\">16.2.5 \u968f\u673a\u5316\u52a0\u901f</h3>\n<p><strong>\u968f\u673a\u91c7\u6837Tucker\u5206\u89e3</strong>\uff1a</p>\n<ol>\n<li>\u5bf9\u6bcf\u4e2a\u6a21\u5f0f\u968f\u673a\u91c7\u6837\u7ea4\u7ef4</li>\n<li>\u5728\u91c7\u6837\u7684\u5b50\u5f20\u91cf\u4e0a\u6267\u884cTucker\u5206\u89e3</li>\n<li>\u4f7f\u7528\u91c7\u6837\u5206\u89e3\u521d\u59cb\u5316\u5b8c\u6574\u5206\u89e3</li>\n</ol>\n<p>\u7406\u8bba\u4fdd\u8bc1\uff1a\u5728\u4e00\u5b9a\u6761\u4ef6\u4e0b\uff0c\u91c7\u6837\u8bef\u5dee\u4ee5\u9ad8\u6982\u7387\u88ab\u63a7\u5236\u5728\uff1a\n$$|\\mathcal{X} - \\hat{\\mathcal{X}}|_F \\leq (1 + \\epsilon) |\\mathcal{X} - \\mathcal{X}_k|_F$$\n\u5176\u4e2d $\\mathcal{X}_k$ \u662f\u6700\u4f18\u7684\u79e9-$(R_1, \\ldots, R_N)$ \u8fd1\u4f3c\u3002</p>\n<p><strong>\u8be6\u7ec6\u7684\u968f\u673a\u5316\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Fiber\u91c7\u6837</strong>\uff1a\n   <code>\u5bf9\u4e8e\u6bcf\u4e2a\u6a21\u5f0f n:\n       \u9009\u62e9\u91c7\u6837\u6570 s_n = O(R_n log R_n / \u03b5^2)\n       \u91c7\u6837\u6982\u7387 p_i \u221d ||X(i,:,...,:)||_F^2  # leverage score\n       \u91c7\u6837\u7d22\u5f15\u96c6 S_n\n   \u6784\u5efa\u91c7\u6837\u5f20\u91cf\uff1a\n       X_S = X[S_1, S_2, ..., S_N]</code></p>\n</li>\n<li>\n<p><strong>\u591a\u9636\u6295\u5f71</strong>\uff1a\n   \u4f7f\u7528\u968f\u673a\u6295\u5f71\u77e9\u9635\u538b\u7f29\u5f20\u91cf\uff1a\n$$\\tilde{\\mathcal{X}} = \\mathcal{X} \\times_1 \\boldsymbol{\\Omega}^{(1)} \\times_2 \\boldsymbol{\\Omega}^{(2)} \\times_3 \\cdots \\times_N \\boldsymbol{\\Omega}^{(N)}$$\n\u5176\u4e2d $\\boldsymbol{\\Omega}^{(n)} \\in \\mathbb{R}^{s_n \\times I_n}$ \u662f\u968f\u673a\u6295\u5f71\u77e9\u9635\uff08\u5982\u9ad8\u65af\u77e9\u9635\u6216\u7a00\u758f\u77e9\u9635\uff09\u3002</p>\n</li>\n<li>\n<p><strong>\u4e24\u9636\u6bb5\u7b97\u6cd5</strong>\uff1a\n   ```\n   # \u9636\u6bb51\uff1a\u5feb\u901f\u8fd1\u4f3c\n   [G_approx, {U_approx^(n)}] = tucker_als(\u03c4ilde{X}, {R_n}, max_iter=5)</p>\n</li>\n</ol>\n<p># \u9636\u6bb52\uff1a\u7cbe\u7ec6\u5316\n   [G, {U^(n)}] = tucker_als(X, {R_n}, init={U_approx^(n)}, max_iter=20)\n   ```</p>\n<p><strong>\u91c7\u6837\u590d\u6742\u5ea6\u5206\u6790</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u5927\u5c0f\u4e3a $I_1 \\times I_2 \\times \\cdots \\times I_N$ \u7684\u5f20\u91cf\uff1a</p>\n<ul>\n<li>\u5b8c\u6574Tucker-ALS\uff1a$O(\\sum_n I_n \\prod_{k \\neq n} I_k)$</li>\n<li>\u968f\u673a\u91c7\u6837\uff1a$O(\\sum_n s_n \\prod_{k \\neq n} s_k)$</li>\n<li>\u52a0\u901f\u6bd4\uff1a$\\prod_n (I_n/s_n)$</li>\n</ul>\n<p>\u5f53 $s_n = O(\\sqrt{I_n})$ \u65f6\uff0c\u53ef\u83b7\u5f97 $O(2^{N/2})$ \u500d\u52a0\u901f\u3002</p>\n<p><strong>\u5b9e\u7528\u7684\u91c7\u6837\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u91c7\u6837</strong>\uff1a\n   <code>\u521d\u59cb\uff1as_n = min(50, I_n/10)\n   while \u4e0d\u6ee1\u8db3\u7cbe\u5ea6\u8981\u6c42:\n       s_n *= 1.5\n       \u91cd\u65b0\u91c7\u6837\u548c\u8ba1\u7b97</code></p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u91c7\u6837</strong>\uff1a\n   - \u5c06\u6bcf\u4e2a\u6a21\u5f0f\u5206\u6210\u82e5\u5e72\u5c42\n   - \u6bcf\u5c42\u72ec\u7acb\u91c7\u6837\n   - \u4fdd\u8bc1\u91cd\u8981\u7528\u6237/\u7269\u54c1\u88ab\u91c7\u6837</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u91c7\u6837</strong>\uff1a\n   - \u91cd\u8981fiber\uff1a\u786e\u5b9a\u6027\u9009\u62e9\n   - \u666e\u901afiber\uff1a\u968f\u673a\u91c7\u6837\n   - \u7a00\u758ffiber\uff1a\u53ef\u80fd\u8df3\u8fc7</p>\n</li>\n</ol>\n<p><strong>\u968f\u673a\u5316CP\u5206\u89e3</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u968f\u673aSGD</strong>\uff1a\n   ```\n   for each epoch:\n       \u968f\u673a\u91c7\u6837\u4e00\u6279\u975e\u96f6\u5143\u7d20 B\n       for (i1, i2, ..., iN, v) in B:\n           # \u8ba1\u7b97\u9884\u6d4b\u8bef\u5dee\n           pred = \u2211_r \u220f_n A^(n)[i_n, r]\n           err = v - pred</p>\n<div class=\"codehilite\"><pre><span></span><code>   # \u66f4\u65b0\u56e0\u5b50\n   for n in 1:N:\n       grad = err <span class=\"gs\">* \u220f_{k\u2260n} A^(k)[i_k, :]</span>\n<span class=\"gs\">       A^(n)[i_n, :] += \u03b7 *</span> grad\n</code></pre></div>\n\n<p>```</p>\n</li>\n<li>\n<p><strong>\u91c7\u6837ALS</strong>\uff1a\n   \u6bcf\u6b21ALS\u66f4\u65b0\u53ea\u4f7f\u7528\u90e8\u5206\u975e\u96f6\u5143\u7d20\uff1a\n   <code>\u91c7\u6837\u7387 q \u2208 (0, 1]\n   for each mode n:\n       S = sample(nnz(X), q * nnz(X))\n       A^(n) = update_with_samples(X, S, {A^(k)}_{k\u2260n})</code></p>\n</li>\n<li>\n<p><strong>Sketched CP</strong>\uff1a\n   \u4f7f\u7528Count Sketch\u52a0\u901f\uff1a\n   ```\n   # \u9884\u8ba1\u7b97sketch\n   for n in 1:N:\n       sketch[n] = CountSketch(A^(n), hash_size)</p>\n</li>\n</ol>\n<p># \u5feb\u901f\u8fd1\u4f3c\u8ba1\u7b97\n   V^(n) \u2248 FFT(conv(sketch[1], ..., sketch[n-1], sketch[n+1], ..., sketch[N]))\n   ```</p>\n<h2 id=\"163\">16.3 \u7a00\u758f\u5f20\u91cf\u7684\u9ad8\u6548\u5b58\u50a8\u4e0e\u8ba1\u7b97</h2>\n<h3 id=\"1631\">16.3.1 \u7a00\u758f\u5f20\u91cf\u5b58\u50a8\u683c\u5f0f</h3>\n<p><strong>COO\u683c\u5f0f</strong>\uff08Coordinate\uff09\uff1a\n\u5b58\u50a8\u975e\u96f6\u5143\u7d20\u7684\u5750\u6807\u548c\u503c\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>indices: [[i1, j1, k1], [i2, j2, k2], ...]\nvalues: [v1, v2, ...]\n</code></pre></div>\n\n<p>\u4f18\u70b9\uff1a\u7b80\u5355\uff0c\u652f\u6301\u9ad8\u6548\u7684\u5143\u7d20\u7ea7\u64cd\u4f5c\n\u7f3a\u70b9\uff1a\u4e0d\u652f\u6301\u9ad8\u6548\u7684\u5207\u7247\u64cd\u4f5c</p>\n<p><strong>CSF\u683c\u5f0f</strong>\uff08Compressed Sparse Fiber\uff09\uff1a\n\u591a\u5c42\u7ea7\u7684\u538b\u7f29\u5b58\u50a8\uff0c\u7c7b\u4f3c\u4e8e\u77e9\u9635\u7684CSR\u683c\u5f0f\u5728\u9ad8\u7ef4\u7684\u63a8\u5e7f\u3002</p>\n<p><strong>HiCOO\u683c\u5f0f</strong>\uff08Hierarchical COO\uff09\uff1a\n\u5c06\u5f20\u91cf\u5206\u5757\uff0c\u6bcf\u5757\u5185\u4f7f\u7528COO\u683c\u5f0f\uff1a</p>\n<ul>\n<li>\u5757\u7ea7\u522b\uff1a\u538b\u7f29\u5b58\u50a8</li>\n<li>\u5757\u5185\u90e8\uff1aCOO\u683c\u5f0f\n\u4f18\u70b9\uff1a\u66f4\u597d\u7684\u5c40\u90e8\u6027\uff0c\u652f\u6301\u5e76\u884c\u8ba1\u7b97</li>\n</ul>\n<h3 id=\"1632-mttkrp\">16.3.2 \u7a00\u758fMTTKRP\u7684\u4f18\u5316\u5b9e\u73b0</h3>\n<p>MTTKRP\uff08Matricized Tensor Times Khatri-Rao Product\uff09\u662f\u5f20\u91cf\u5206\u89e3\u7684\u6838\u5fc3\u64cd\u4f5c\uff1a\n$$\\mathbf{Y} = \\mathbf{X}_{(n)} (\\mathbf{A}^{(N)} \\odot \\cdots \\odot \\mathbf{A}^{(n+1)} \\odot \\mathbf{A}^{(n-1)} \\odot \\cdots \\odot \\mathbf{A}^{(1)})$$\n<strong>\u7a00\u758f\u4f18\u5316\u7b97\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>for each nonzero (i1, ..., iN, v) in X:\n    for r = 1 to R:\n        Y[in, r] += v * \u220f(k\u2260n) A[ik, r]\n</code></pre></div>\n\n<p><strong>\u6027\u80fd\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li><strong>\u5411\u91cf\u5316</strong>\uff1a\u4f7f\u7528SIMD\u6307\u4ee4</li>\n<li><strong>\u7f13\u5b58\u4f18\u5316</strong>\uff1a\n   - \u91cd\u6392\u5e8f\u975e\u96f6\u5143\u7d20\u63d0\u9ad8\u5c40\u90e8\u6027\n   - \u4f7f\u7528blocking\u6280\u672f</li>\n<li><strong>\u5e76\u884c\u5316</strong>\uff1a\n   - \u539f\u5b50\u64cd\u4f5c\u5904\u7406\u5199\u51b2\u7a81\n   - \u4f7f\u7528\u79c1\u6709\u7d2f\u52a0\u5668+\u5f52\u7ea6</li>\n</ol>\n<p><strong>\u9ad8\u7ea7\u4f18\u5316\u5b9e\u73b0</strong>\uff1a</p>\n<ol>\n<li><strong>\u5757\u5316MTTKRP</strong>\uff1a\n   ```c\n   // \u5c06\u975e\u96f6\u5143\u7d20\u6309mode-n\u7d22\u5f15\u5206\u5757\n   #define BLOCK_SIZE 64</li>\n</ol>\n<p>for (block = 0; block &lt; num_blocks; block++) {\n       // \u9884\u52a0\u8f7d\u8be5\u5757\u9700\u8981\u7684\u56e0\u5b50\u77e9\u9635\u884c\n       prefetch_factor_rows(block);</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"n\">#pragma</span><span class=\"w\"> </span><span class=\"n\">omp</span><span class=\"w\"> </span><span class=\"n\">parallel</span><span class=\"w\"> </span><span class=\"k\">for</span>\n<span class=\"w\">   </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">idx</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">block_start</span><span class=\"o\">[</span><span class=\"n\">block</span><span class=\"o\">]</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">idx</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">block_end</span><span class=\"o\">[</span><span class=\"n\">block</span><span class=\"o\">]</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">idx</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">       </span><span class=\"n\">i_n</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">coords</span><span class=\"o\">[</span><span class=\"n\">idx</span><span class=\"o\">]</span><span class=\"p\">.</span><span class=\"n\">mode_n</span><span class=\"p\">;</span>\n<span class=\"w\">       </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">values</span><span class=\"o\">[</span><span class=\"n\">idx</span><span class=\"o\">]</span><span class=\"p\">;</span>\n\n<span class=\"w\">       </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">SIMD\u5316\u7684\u5185\u5c42\u5faa\u73af</span>\n<span class=\"w\">       </span><span class=\"n\">#pragma</span><span class=\"w\"> </span><span class=\"n\">omp</span><span class=\"w\"> </span><span class=\"n\">simd</span>\n<span class=\"w\">       </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">           </span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"p\">;</span>\n<span class=\"w\">           </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">               </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">                   </span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">*=</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">[</span><span class=\"n\">k</span><span class=\"o\">][</span><span class=\"n\">coords[idx</span><span class=\"o\">]</span><span class=\"p\">.</span><span class=\"n\">indices</span><span class=\"o\">[</span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"err\">]</span><span class=\"o\">[</span><span class=\"n\">r</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"w\">               </span><span class=\"err\">}</span>\n<span class=\"w\">           </span><span class=\"err\">}</span>\n<span class=\"w\">           </span><span class=\"n\">Y_private</span><span class=\"o\">[</span><span class=\"n\">tid</span><span class=\"o\">][</span><span class=\"n\">i_n</span><span class=\"o\">][</span><span class=\"n\">r</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"n\">prod</span><span class=\"p\">;</span>\n<span class=\"w\">       </span><span class=\"err\">}</span>\n<span class=\"w\">   </span><span class=\"err\">}</span>\n</code></pre></div>\n\n<p>}</p>\n<p>// \u5f52\u7ea6\u79c1\u6709\u7ed3\u679c\n   reduce_private_results(Y_private, Y);\n   ```</p>\n<ol start=\"2\">\n<li><strong>\u7f13\u5b58\u611f\u77e5\u7684\u91cd\u6392\u5e8f</strong>\uff1a\n   ```\n   // Z-order (Morton order) \u91cd\u6392\u5e8f\n   struct NonZero {\n       uint64_t morton_code;\n       int indices[N];\n       float value;\n   };</li>\n</ol>\n<p>// \u8ba1\u7b97Morton\u7801\n   for (each nonzero) {\n       nz.morton_code = interleave_bits(indices);\n   }</p>\n<p>// \u6309Morton\u7801\u6392\u5e8f\n   sort(nonzeros, by_morton_code);\n   ```</p>\n<ol start=\"3\">\n<li><strong>\u878d\u5408\u8ba1\u7b97</strong>\uff1a\n   \u5c06\u591a\u4e2aMTTKRP\u64cd\u4f5c\u878d\u5408\uff1a\n   ```\n   // \u4f20\u7edf\uff1a\u5206\u522b\u8ba1\u7b97\u6bcf\u4e2a\u6a21\u5f0f\n   Y1 = MTTKRP(X, {A2, A3}, mode=1)\n   Y2 = MTTKRP(X, {A1, A3}, mode=2)\n   Y3 = MTTKRP(X, {A1, A2}, mode=3)</li>\n</ol>\n<p>// \u878d\u5408\uff1a\u4e00\u6b21\u904d\u5386\n   for (each nonzero (i,j,k,v)) {\n       for (r = 0; r &lt; R; r++) {\n           Y1[i,r] += v * A2[j,r] * A3[k,r];\n           Y2[j,r] += v * A1[i,r] * A3[k,r];\n           Y3[k,r] += v * A1[i,r] * A2[j,r];\n       }\n   }\n   ```</p>\n<ol start=\"4\">\n<li>\n<p><strong>GPU\u4f18\u5316</strong>\uff1a\n   ```cuda\n   <strong>global</strong> void sparse_mttkrp_kernel(\n       int nnz, int<em> coords, float</em> vals,\n       float*<em> factors, float</em> output, \n       int mode, int rank\n   ) {\n       int tid = blockIdx.x * blockDim.x + threadIdx.x;\n       if (tid &gt;= nnz) return;</p>\n<p>// \u5171\u4eab\u5185\u5b58\u7f13\u5b58\u56e0\u5b50\u77e9\u9635\u884c\n   <strong>shared</strong> float cache[CACHE_SIZE];</p>\n<p>int out_idx = coords[tid * N + mode];\n   float val = vals[tid];</p>\n<p>// Warp\u7ea7\u5e76\u884c\n   for (int r = threadIdx.y; r &lt; rank; r += blockDim.y) {\n       float prod = val;\n       #pragma unroll\n       for (int n = 0; n &lt; N; n++) {\n           if (n != mode) {\n               int idx = coords[tid * N + n];\n               prod *= factors[n][idx * rank + r];\n           }\n       }\n       atomicAdd(&amp;output[out_idx * rank + r], prod);\n   }\n   }\n   ```</p>\n</li>\n<li>\n<p><strong>\u6570\u636e\u5e03\u5c40\u4f18\u5316</strong>\uff1a\n   ```\n   // AoS (Array of Structures) vs SoA (Structure of Arrays)</p>\n</li>\n</ol>\n<p>// AoS (\u5dee\u7684\u5c40\u90e8\u6027)\n   struct Element {\n       int i, j, k;\n       float value;\n   } elements[nnz];</p>\n<p>// SoA (\u66f4\u597d\u7684\u5411\u91cf\u5316)\n   int<em> indices_i;\n   int</em> indices_j; \n   int<em> indices_k;\n   float</em> values;</p>\n<p>// \u8fdb\u4e00\u6b65\uff1a\u5206\u5757SoA\n   struct Block {\n       int indices[3][BLOCK_SIZE];\n       float values[BLOCK_SIZE];\n   } blocks[];\n   ```</p>\n<p><strong>\u6027\u80fd\u5206\u6790\u4e0e\u8c03\u4f18</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u74f6\u9888\u8bc6\u522b</strong>\uff1a\n   - \u5185\u5b58\u5e26\u5bbd\uff1aMTTKRP\u901a\u5e38\u53d7\u9650\u4e8e\u5185\u5b58\u5e26\u5bbd\n   - \u8ba1\u7b97\u5f3a\u5ea6\uff1aO(R) flops per byte\n   - \u4e0d\u89c4\u5219\u8bbf\u95ee\uff1a\u968f\u673a\u8bbf\u95ee\u56e0\u5b50\u77e9\u9635</p>\n</li>\n<li>\n<p><strong>Roofline\u6a21\u578b</strong>\uff1a\n   <code>\u7b97\u672f\u5f3a\u5ea6 = (2*R*nnz) / (nnz*12 + N*I*R*4)\n   \u5cf0\u503c\u6027\u80fd = min(\u5cf0\u503c\u6d6e\u70b9, \u7b97\u672f\u5f3a\u5ea6 * \u5185\u5b58\u5e26\u5bbd)</code></p>\n</li>\n<li>\n<p><strong>\u4f18\u5316\u6548\u679c</strong>\uff1a\n   - \u57fa\u7840\u5b9e\u73b0\uff1a~5% \u5cf0\u503c\u6027\u80fd\n   - \u5757\u5316+\u5411\u91cf\u5316\uff1a~25% \u5cf0\u503c\u6027\u80fd\n   - GPU\u4f18\u5316\uff1a~40% \u5cf0\u503c\u6027\u80fd\n   - \u878d\u5408\u8ba1\u7b97\uff1a2-3x \u52a0\u901f</p>\n</li>\n</ol>\n<h3 id=\"1633\">16.3.3 \u5206\u5e03\u5f0f\u7a00\u758f\u5f20\u91cf\u8ba1\u7b97</h3>\n<p><strong>\u5f20\u91cf\u5206\u533a\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Coarse-grained</strong>\uff1a\u6309\u6a21\u5f0f\u5206\u533a\n   - \u6bcf\u4e2a\u8282\u70b9\u8d1f\u8d23\u67d0\u4e9bfiber\n   - \u901a\u4fe1\u53d1\u751f\u5728\u6a21\u5f0f\u5207\u6362\u65f6</p>\n</li>\n<li>\n<p><strong>Fine-grained</strong>\uff1a\u6309\u975e\u96f6\u5143\u7d20\u5206\u533a\n   - \u66f4\u597d\u7684\u8d1f\u8f7d\u5747\u8861\n   - \u66f4\u590d\u6742\u7684\u901a\u4fe1\u6a21\u5f0f</p>\n</li>\n<li>\n<p><strong>Hybrid</strong>\uff1a\u591a\u7ea7\u5206\u533a\n   - \u9876\u5c42\u6309\u6a21\u5f0f\u5206\u533a\n   - \u5e95\u5c42\u6309\u5143\u7d20\u5206\u533a</p>\n</li>\n</ol>\n<p><strong>\u901a\u4fe1\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>All-to-all \u901a\u4fe1\u7684\u4f18\u5316\u8c03\u5ea6</li>\n<li>\u4f7f\u7528 overlap \u6280\u672f\u9690\u85cf\u901a\u4fe1\u5ef6\u8fdf</li>\n<li>\u538b\u7f29\u4f20\u8f93\u7684\u56e0\u5b50\u77e9\u9635</li>\n</ul>\n<p><strong>\u8be6\u7ec6\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5</strong>\uff1a</p>\n<ol>\n<li><strong>Medium-grained\u5206\u533a</strong>\uff1a\n   ```\n   // \u5c06\u5f20\u91cf\u5206\u6210P\u00d7Q\u00d7R\u4e2a\u5757\n   \u5bf9\u4e8e\u8282\u70b9(p,q,r)\uff1a\n       \u5b58\u50a8X[i_p:i_{p+1}, j_q:j_{q+1}, k_r:k_{r+1}]\n       \u672c\u5730\u56e0\u5b50\uff1aA1[i_p:i_{p+1},:], A2[j_q:j_{q+1},:], A3[k_r:k_{r+1},:]</li>\n</ol>\n<p>MTTKRP\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\u672c\u5730\u90e8\u5206\u8ba1\u7b97</li>\n<li>All-reduce\u5728\u9002\u5f53\u7ef4\u5ea6</li>\n<li>\n<p>Scatter\u7ed3\u679c\u5230\u76f8\u5e94\u8282\u70b9\n   ```</p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u907f\u514d\u7b97\u6cd5</strong>\uff1a\n   ```\n   // 3D\u5f20\u91cf\u5728P\u4e2a\u8282\u70b9\u4e0a\n   for iteration = 1:max_iter\n       // Mode-1\u66f4\u65b0(\u65e0\u901a\u4fe1)\n       A1_local = local_mttkrp(X_local, A2_local, A3_local, mode=1)</p>\n<p>// Mode-2\u66f4\u65b0(\u9700\u8981A1)\n   A1_gathered = allgather(A1_local, row_comm)\n   A2_local = local_mttkrp(X_local, A1_gathered, A3_local, mode=2)</p>\n<p>// Mode-3\u66f4\u65b0(\u9700\u8981A1,A2)\n   A2_gathered = allgather(A2_local, col_comm)\n   A3_local = local_mttkrp(X_local, A1_gathered, A2_gathered, mode=3)\n   end\n   ```</p>\n</li>\n<li>\n<p><strong>\u5f02\u6b65\u66f4\u65b0\u7b56\u7565</strong>\uff1a\n   ```python\n   class AsyncDistributedCP:\n       def <strong>init</strong>(self, X_local, rank, world_size):\n           self.X_local = X_local\n           self.factors = [init_factor(dim, R) for dim in dims]\n           self.buffer = [None] * N_modes\n           self.version = [0] * N_modes</p>\n<p>def async_update(self, mode):\n       # \u4f7f\u7528\u8fc7\u671f\u7684\u56e0\u5b50\u8fdb\u884c\u66f4\u65b0\n       Y = local_mttkrp(self.X_local, self.buffer, mode)\n       self.factors[mode] = solve_least_squares(Y)</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"err\">#</span><span class=\"w\"> </span><span class=\"n\">\u975e\u963b\u585e\u53d1\u9001</span>\n<span class=\"w\">   </span><span class=\"n\">req</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">comm</span><span class=\"p\">.</span><span class=\"n\">Isend</span><span class=\"p\">(</span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">factors</span><span class=\"o\">[</span><span class=\"n\">mode</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">dest</span><span class=\"o\">=</span><span class=\"ow\">all</span><span class=\"p\">)</span>\n\n<span class=\"w\">   </span><span class=\"err\">#</span><span class=\"w\"> </span><span class=\"n\">\u5c1d\u8bd5\u63a5\u6536\u5176\u4ed6\u8282\u70b9\u7684\u66f4\u65b0</span>\n<span class=\"w\">   </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">comm</span><span class=\"p\">.</span><span class=\"n\">Iprobe</span><span class=\"p\">()</span><span class=\"err\">:</span>\n<span class=\"w\">       </span><span class=\"n\">new_factor</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">source</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tag</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">comm</span><span class=\"p\">.</span><span class=\"n\">recv</span><span class=\"p\">()</span>\n<span class=\"w\">       </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">buffer</span><span class=\"o\">[</span><span class=\"n\">tag</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">new_factor</span>\n<span class=\"w\">       </span><span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">version</span><span class=\"o\">[</span><span class=\"n\">tag</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n\n<p>```</p>\n</li>\n</ol>\n<p><strong>\u8d1f\u8f7d\u5747\u8861\u6280\u672f</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u52a8\u6001\u91cd\u5206\u914d</strong>\uff1a\n   ```\n   // \u76d1\u63a7\u6bcf\u4e2a\u8282\u70b9\u7684\u8ba1\u7b97\u65f6\u95f4\n   if load_imbalance() &gt; threshold:\n       // \u8ba1\u7b97\u65b0\u7684\u5206\u533a\n       new_partition = compute_balanced_partition(nnz_per_node)</p>\n<p>// \u8fc1\u79fb\u6570\u636e\n   migrate_data(old_partition, new_partition)\n   ```</p>\n</li>\n<li>\n<p><strong>\u5de5\u4f5c\u7a83\u53d6</strong>\uff1a\n   <code>while has_work() or can_steal():\n       if has_work():\n           process_local_work()\n       else:\n           victim = select_victim_node()\n           stolen_work = steal_from(victim)\n           process_stolen_work(stolen_work)</code></p>\n</li>\n<li>\n<p><strong>\u5206\u5c42\u8d1f\u8f7d\u5747\u8861</strong>\uff1a\n   - \u8282\u70b9\u95f4\uff1a\u7c97\u7c92\u5ea6\u5747\u8861\n   - \u8282\u70b9\u5185\uff1a\u7ebf\u7a0b\u7ea7\u7ec6\u7c92\u5ea6\u5747\u8861</p>\n</li>\n</ol>\n<p><strong>\u5bb9\u9519\u4e0e\u6062\u590d</strong>\uff1a</p>\n<ol>\n<li><strong>\u68c0\u67e5\u70b9\u673a\u5236</strong>\uff1a\n   ```python\n   def checkpoint():\n       if iteration % checkpoint_interval == 0:\n           # \u4fdd\u5b58\u56e0\u5b50\u77e9\u9635\n           save_factors_to_disk(self.factors)\n           # \u4fdd\u5b58\u8fed\u4ee3\u72b6\u6001\n           save_state(iteration, loss)</li>\n</ol>\n<p>def recover():\n       # \u4ece\u6700\u8fd1\u7684\u68c0\u67e5\u70b9\u6062\u590d\n       self.factors = load_factors_from_disk()\n       iteration, loss = load_state()\n       return iteration\n   ```</p>\n<ol start=\"2\">\n<li><strong>\u590d\u5236\u7b56\u7565</strong>\uff1a\n   - \u5173\u952e\u56e0\u5b50\u77e9\u9635\u591a\u526f\u672c\n   - \u4f7f\u7528Reed-Solomon\u7f16\u7801\n   - \u8de8\u673a\u67b6\u590d\u5236</li>\n</ol>\n<p><strong>\u901a\u4fe1\u6a21\u5f0f\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Butterfly\u6df7\u5408</strong>\uff1a\n   <code>// log(P)\u8f6e\u901a\u4fe1\u5b8c\u6210\u5168\u5c40\u4ea4\u6362\n   for round = 0 to log2(P)-1:\n       partner = rank XOR (1 &lt;&lt; round)\n       exchange_with(partner)\n       merge_factors()</code></p>\n</li>\n<li>\n<p><strong>\u5206\u5c42All-reduce</strong>\uff1a\n   ```\n   // \u673a\u67b6\u5185\u5148\u5f52\u7ea6\n   local_reduce(rack_comm)</p>\n</li>\n</ol>\n<p>// \u8de8\u673a\u67b6\u901a\u4fe1\n   if is_rack_leader:\n       global_reduce(leader_comm)</p>\n<p>// \u673a\u67b6\u5185\u5e7f\u64ad\n   broadcast(rack_comm)\n   ```</p>\n<ol start=\"3\">\n<li><strong>\u6d41\u6c34\u7ebf\u901a\u4fe1</strong>\uff1a\n   <code>// \u5c06\u5927\u6d88\u606f\u5206\u6210\u5c0f\u5757\n   for chunk in chunks:\n       send_async(chunk, next_node)\n       if has_received():\n           process_chunk(recv_chunk)</code></li>\n</ol>\n<h3 id=\"1634-gpu\">16.3.4 GPU\u52a0\u901f\u7684\u7a00\u758f\u5f20\u91cf\u8fd0\u7b97</h3>\n<p><strong>\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u89c4\u5219\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>\u8d1f\u8f7d\u4e0d\u5747\u8861</li>\n<li>\u6709\u9650\u7684GPU\u5185\u5b58</li>\n<li>\u539f\u5b50\u64cd\u4f5c\u7684\u7ade\u4e89</li>\n</ul>\n<p><strong>\u4f18\u5316\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>COO-based GPU kernel</strong>\uff1a\n   - Warp-level \u5e76\u884c\n   - Shared memory \u7f13\u5b58\u56e0\u5b50\u77e9\u9635</p>\n</li>\n<li>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</strong>\uff1a\n   - FP16 \u8ba1\u7b97\uff0cFP32 \u7d2f\u52a0\n   - \u5229\u7528Tensor Core\u52a0\u901f</p>\n</li>\n<li>\n<p><strong>\u591aGPU\u5e76\u884c</strong>\uff1a\n   - \u6a21\u578b\u5e76\u884c\uff1a\u5206\u89e3\u56e0\u5b50\u77e9\u9635\n   - \u6570\u636e\u5e76\u884c\uff1a\u5206\u533a\u5f20\u91cf</p>\n</li>\n</ol>\n<p><strong>\u9ad8\u6548\u7684GPU\u5b9e\u73b0</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5c42\u5e76\u884c\u7b56\u7565</strong>\uff1a\n   ```cuda\n   <strong>global</strong> void hierarchical_mttkrp(\n       int nnz, int4<em> coords, float</em> vals,\n       float<em> A1, float</em> A2, float<em> A3, \n       float</em> output, int rank, int mode\n   ) {\n       // Block\u7ea7\u522b\uff1a\u5904\u7406\u4e00\u7ec4\u975e\u96f6\u5143\u7d20\n       <strong>shared</strong> float s_factors[3][BLOCK_SIZE][RANK];</p>\n<p>// Warp\u7ea7\u522b\uff1a\u534f\u4f5c\u52a0\u8f7d\u56e0\u5b50\u77e9\u9635\n   int warp_id = threadIdx.x / 32;\n   int lane_id = threadIdx.x % 32;</p>\n<p>// \u52a0\u8f7d\u76f8\u5173\u56e0\u5b50\u77e9\u9635\u884c\u5230\u5171\u4eab\u5185\u5b58\n   cooperative_load_factors(coords, s_factors);\n   __syncthreads();</p>\n<p>// Thread\u7ea7\u522b\uff1a\u8ba1\u7b97\u4e58\u79ef\n   for (int elem = blockIdx.x * blockDim.x + threadIdx.x; \n        elem &lt; nnz; elem += gridDim.x * blockDim.x) {</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"n\">int4</span><span class=\"w\"> </span><span class=\"n\">coord</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">coords</span><span class=\"o\">[</span><span class=\"n\">elem</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"w\">   </span><span class=\"nc\">float</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">vals</span><span class=\"o\">[</span><span class=\"n\">elem</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"w\">   </span><span class=\"nc\">int</span><span class=\"w\"> </span><span class=\"n\">out_idx</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">get_index</span><span class=\"p\">(</span><span class=\"n\">coord</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">mode</span><span class=\"p\">);</span>\n\n<span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u5c0f\u5faa\u73af\u5c55\u5f00</span>\n<span class=\"w\">   </span><span class=\"n\">#pragma</span><span class=\"w\"> </span><span class=\"n\">unroll</span><span class=\"w\"> </span><span class=\"mi\">4</span>\n<span class=\"w\">   </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nc\">int</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nf\">rank</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">       </span><span class=\"n\">float4</span><span class=\"w\"> </span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">make_float4</span><span class=\"p\">(</span><span class=\"n\">val</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"p\">);</span>\n\n<span class=\"w\">       </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u5411\u91cf\u5316\u8ba1\u7b97</span>\n<span class=\"w\">       </span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">compute_product_vectorized</span><span class=\"p\">(</span>\n<span class=\"w\">           </span><span class=\"n\">coord</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">s_factors</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">mode</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">prod</span>\n<span class=\"w\">       </span><span class=\"p\">);</span>\n\n<span class=\"w\">       </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u5206\u6563\u5199\u56de</span>\n<span class=\"w\">       </span><span class=\"n\">scatter_atomic_add</span><span class=\"p\">(</span><span class=\"k\">output</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">out_idx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">prod</span><span class=\"p\">);</span>\n<span class=\"w\">   </span><span class=\"err\">}</span>\n</code></pre></div>\n\n<p>}\n   }\n   ```</p>\n</li>\n<li>\n<p><strong>Hash-based\u51b2\u7a81\u89e3\u51b3</strong>\uff1a\n   ```cuda\n   <strong>device</strong> void scatter_atomic_add(\n       float* output, int row, int col_start, float4 vals\n   ) {\n       // \u4f7f\u7528hash table\u51cf\u5c11\u539f\u5b50\u64cd\u4f5c\u51b2\u7a81\n       const int HASH_SIZE = 1024;\n       <strong>shared</strong> float hash_table[HASH_SIZE];\n       <strong>shared</strong> int hash_keys[HASH_SIZE];</p>\n<p>int hash = (row * RANK + col_start) % HASH_SIZE;</p>\n<p>// \u5c1d\u8bd5\u5199\u5165hash table\n   int old_key = atomicCAS(&amp;hash_keys[hash], -1, row);\n   if (old_key == -1 || old_key == row) {\n       // \u6210\u529f\u83b7\u5f97\u69fd\u4f4d\n       atomicAdd(&amp;hash_table[hash], vals.x + vals.y + vals.z + vals.w);\n   } else {\n       // \u51b2\u7a81\uff0c\u76f4\u63a5\u5199\u5168\u5c40\u5185\u5b58\n       atomicAdd(&amp;output[row * RANK + col_start], vals.x);\n       // ...\n   }\n   }\n   ```</p>\n</li>\n<li>\n<p><strong>Tensor Core\u4f18\u5316</strong>\uff1a\n   ```cuda\n   // \u4f7f\u7528wmma API\u8fdb\u884c\u77e9\u9635\u4e58\u6cd5\n   #include <mma.h>\n   using namespace nvcuda;</p>\n</li>\n</ol>\n<p><strong>global</strong> void tensor_core_mttkrp(\n       half<em> A_factors, half</em> B_factors, \n       float* C_output, int M, int N, int K\n   ) {\n       // \u58f0\u660ewmma fragments\n       wmma::fragment<wmma::matrix_a, 16, 16, 16, half, wmma::row_major> a_frag;\n       wmma::fragment<wmma::matrix_b, 16, 16, 16, half, wmma::col_major> b_frag;\n       wmma::fragment<wmma::accumulator, 16, 16, 16, float> c_frag;</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"err\">\u521d\u59cb\u5316\u7d2f\u52a0\u5668</span>\n<span class=\"w\">   </span><span class=\"n\">wmma</span><span class=\"p\">::</span><span class=\"n\">fill_fragment</span><span class=\"p\">(</span><span class=\"n\">c_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"n\">f</span><span class=\"p\">);</span>\n\n<span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">Tensor</span><span class=\"w\"> </span><span class=\"n\">Core\u8ba1\u7b97</span>\n<span class=\"w\">   </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nb nb-Type\">int</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">       </span><span class=\"n\">wmma</span><span class=\"p\">::</span><span class=\"n\">load_matrix_sync</span><span class=\"p\">(</span><span class=\"n\">a_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">A_factors</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"p\">);</span>\n<span class=\"w\">       </span><span class=\"n\">wmma</span><span class=\"p\">::</span><span class=\"n\">load_matrix_sync</span><span class=\"p\">(</span><span class=\"n\">b_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">B_factors</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"p\">);</span>\n<span class=\"w\">       </span><span class=\"n\">wmma</span><span class=\"p\">::</span><span class=\"n\">mma_sync</span><span class=\"p\">(</span><span class=\"n\">c_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">a_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">b_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">c_frag</span><span class=\"p\">);</span>\n<span class=\"w\">   </span><span class=\"p\">}</span>\n\n<span class=\"w\">   </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"err\">\u5b58\u50a8\u7ed3\u679c</span>\n<span class=\"w\">   </span><span class=\"n\">wmma</span><span class=\"p\">::</span><span class=\"n\">store_matrix_sync</span><span class=\"p\">(</span><span class=\"n\">C_output</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">c_frag</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wmma</span><span class=\"p\">::</span><span class=\"n\">mem_row_major</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<p>}\n   ```</p>\n<ol start=\"4\">\n<li>\n<p><strong>\u52a8\u6001\u5e76\u884c\u5ea6\u8c03\u6574</strong>\uff1a\n   ```cuda\n   <strong>global</strong> void adaptive_kernel(\n       int nnz, int<em> row_ptr, int</em> col_idx, float* vals\n   ) {\n       // \u6839\u636e\u884c\u7684\u975e\u96f6\u5143\u7d20\u6570\u91cf\u52a8\u6001\u5206\u914d\u7ebf\u7a0b\n       int row = blockIdx.x;\n       int nnz_in_row = row_ptr[row+1] - row_ptr[row];</p>\n<p>if (nnz_in_row &lt; 32) {\n       // \u5c0f\u884c\uff1a\u4e00\u4e2awarp\u5904\u7406\u591a\u884c\n       small_row_kernel(row, row_ptr, col_idx, vals);\n   } else if (nnz_in_row &lt; 1024) {\n       // \u4e2d\u7b49\u884c\uff1a\u4e00\u4e2ablock\u5904\u7406\u4e00\u884c\n       medium_row_kernel(row, row_ptr, col_idx, vals);\n   } else {\n       // \u5927\u884c\uff1a\u591a\u4e2ablock\u5904\u7406\u4e00\u884c\n       large_row_kernel(row, row_ptr, col_idx, vals);\n   }\n   }\n   ```</p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u7ba1\u7406\u4f18\u5316</strong>\uff1a\n   ```cuda\n   class GPUMemoryPool {\n   private:\n       void* pool;\n       size_t pool_size;\n       std::vector<Block> free_blocks;</p>\n</li>\n</ol>\n<p>public:\n       void* allocate(size_t size) {\n           // \u4ece\u5185\u5b58\u6c60\u5206\u914d\n           auto it = std::find_if(free_blocks.begin(), free_blocks.end(),\n               <a href=\"const Block&amp; b\">size</a> { return b.size &gt;= size; });</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">       </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"n\">free_blocks</span><span class=\"p\">.</span><span class=\"k\">end</span><span class=\"p\">())</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">           </span><span class=\"n\">void</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">ptr</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"o\">-&gt;</span><span class=\"n\">ptr</span><span class=\"p\">;</span>\n<span class=\"w\">           </span><span class=\"n\">it</span><span class=\"o\">-&gt;</span><span class=\"n\">ptr</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"k\">size</span><span class=\"p\">;</span>\n<span class=\"w\">           </span><span class=\"n\">it</span><span class=\"o\">-&gt;</span><span class=\"k\">size</span><span class=\"w\"> </span><span class=\"o\">-=</span><span class=\"w\"> </span><span class=\"k\">size</span><span class=\"p\">;</span>\n<span class=\"w\">           </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">ptr</span><span class=\"p\">;</span>\n<span class=\"w\">       </span><span class=\"err\">}</span>\n\n<span class=\"w\">       </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u56de\u9000\u5230cudaMalloc</span>\n<span class=\"w\">       </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">fallback_allocate</span><span class=\"p\">(</span><span class=\"k\">size</span><span class=\"p\">);</span>\n<span class=\"w\">   </span><span class=\"err\">}</span>\n\n<span class=\"w\">   </span><span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">batch_prefetch</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"w\"> </span><span class=\"nl\">std</span><span class=\"p\">:</span><span class=\"err\">:</span><span class=\"n\">vector</span><span class=\"o\">&lt;</span><span class=\"n\">TensorBlock</span><span class=\"o\">&gt;&amp;</span><span class=\"w\"> </span><span class=\"n\">blocks</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">       </span><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u9884\u53d6\u4e0b\u4e00\u6279\u6570\u636e</span>\n<span class=\"w\">       </span><span class=\"n\">#pragma</span><span class=\"w\"> </span><span class=\"n\">omp</span><span class=\"w\"> </span><span class=\"n\">parallel</span><span class=\"w\"> </span><span class=\"k\">for</span>\n<span class=\"w\">       </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nc\">int</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">blocks</span><span class=\"p\">.</span><span class=\"k\">size</span><span class=\"p\">();</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">           </span><span class=\"n\">cudaMemPrefetchAsync</span><span class=\"p\">(</span><span class=\"n\">blocks</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">.</span><span class=\"k\">data</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">blocks</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">.</span><span class=\"k\">size</span><span class=\"p\">,</span><span class=\"w\"> </span>\n<span class=\"w\">                               </span><span class=\"n\">device_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">stream</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">);</span>\n<span class=\"w\">       </span><span class=\"err\">}</span>\n<span class=\"w\">   </span><span class=\"err\">}</span>\n</code></pre></div>\n\n<p>};\n   ```</p>\n<p><strong>\u6027\u80fd\u5206\u6790\u4e0e\u8c03\u4f18</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Occupancy\u4f18\u5316</strong>\uff1a\n   <code>// \u52a8\u6001\u8c03\u6574block\u5927\u5c0f\n   int block_size;\n   int min_grid_size;\n   cudaOccupancyMaxPotentialBlockSize(\n       &amp;min_grid_size, &amp;block_size, kernel, 0, 0\n   );</code></p>\n</li>\n<li>\n<p><strong>\u5185\u5b58\u5e26\u5bbd\u4f18\u5316</strong>\uff1a\n   - \u5408\u5e76\u5185\u5b58\u8bbf\u95ee\n   - \u4f7f\u7528\u7eb9\u7406\u5185\u5b58\u7f13\u5b58\u53ea\u8bfb\u6570\u636e\n   - \u907f\u514dbank conflict</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u6307\u6807</strong>\uff1a\n   - COO\u683c\u5f0f\uff1a~200 GFLOPS (V100)\n   - CSF\u683c\u5f0f\uff1a~150 GFLOPS (\u66f4\u597d\u7684\u5185\u5b58\u5c40\u90e8\u6027)\n   - Tensor Core\uff1a~400 GFLOPS (\u9650\u5236\u6761\u4ef6\u4e0b)</p>\n</li>\n</ol>\n<h2 id=\"164\">16.4 \u8de8\u57df\u63a8\u8350\u7684\u8026\u5408\u77e9\u9635\u5206\u89e3</h2>\n<h3 id=\"1641\">16.4.1 \u8de8\u57df\u63a8\u8350\u7684\u52a8\u673a\u4e0e\u6311\u6218</h3>\n<p>\u73b0\u4ee3\u7528\u6237\u5728\u591a\u4e2a\u57df\uff08domain\uff09\u4e2d\u4ea7\u751f\u884c\u4e3a\u6570\u636e\uff1a</p>\n<ul>\n<li>\u7535\u5546\u5e73\u53f0\uff1a\u8d2d\u4e70\u5386\u53f2</li>\n<li>\u89c6\u9891\u5e73\u53f0\uff1a\u89c2\u770b\u8bb0\u5f55</li>\n<li>\u97f3\u4e50\u5e73\u53f0\uff1a\u6536\u542c\u5386\u53f2</li>\n<li>\u793e\u4ea4\u5e73\u53f0\uff1a\u4e92\u52a8\u884c\u4e3a</li>\n</ul>\n<p><strong>\u8de8\u57df\u63a8\u8350\u7684\u4ef7\u503c</strong>\uff1a</p>\n<ol>\n<li><strong>\u7f13\u89e3\u51b7\u542f\u52a8</strong>\uff1a\u5229\u7528\u6e90\u57df\u7684\u4e30\u5bcc\u6570\u636e\u5e2e\u52a9\u76ee\u6807\u57df</li>\n<li><strong>\u63d0\u5347\u63a8\u8350\u8d28\u91cf</strong>\uff1a\u6316\u6398\u8de8\u57df\u7684\u4e92\u8865\u4fe1\u606f</li>\n<li><strong>\u7edf\u4e00\u7528\u6237\u753b\u50cf</strong>\uff1a\u6784\u5efa\u5168\u9762\u7684\u7528\u6237\u5174\u8da3\u6a21\u578b</li>\n</ol>\n<p><strong>\u6838\u5fc3\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u57df\u95f4\u7684\u8bed\u4e49\u9e3f\u6c9f</li>\n<li>\u6570\u636e\u5206\u5e03\u7684\u5f02\u8d28\u6027</li>\n<li>\u9690\u79c1\u548c\u6570\u636e\u5b64\u5c9b</li>\n<li>\u8d1f\u8fc1\u79fb\u98ce\u9669</li>\n</ul>\n<h3 id=\"1642-cmf\">16.4.2 \u96c6\u4f53\u77e9\u9635\u5206\u89e3\uff08CMF\uff09\u6846\u67b6</h3>\n<p>\u8003\u8651 $K$ \u4e2a\u57df\u7684\u63a8\u8350\u95ee\u9898\uff0c\u6bcf\u4e2a\u57df\u6709\u4ea4\u4e92\u77e9\u9635 $\\mathbf{R}^{(k)} \\in \\mathbb{R}^{m_k \\times n_k}$\u3002CMF\u901a\u8fc7\u5171\u4eab\u56e0\u5b50\u5b9e\u73b0\u77e5\u8bc6\u8fc1\u79fb\uff1a\n$$\\min \\sum_{k=1}^{K} \\alpha_k |\\mathbf{R}^{(k)} - \\mathbf{U}^{(k)} (\\mathbf{V}^{(k)})^T|_F^2 + \\text{regularization}$$\n<strong>\u5171\u4eab\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u7528\u6237\u4fa7\u5171\u4eab</strong>\uff1a\u5f53\u7528\u6237\u5728\u591a\u4e2a\u57df\u4e2d\u91cd\u53e0\u65f6\n$$\\mathbf{U}^{(k)} = \\mathbf{U}_{\\text{shared}} \\mathbf{B}^{(k)}$$\n\u5176\u4e2d $\\mathbf{B}^{(k)}$ \u662f\u57df\u7279\u5b9a\u7684\u53d8\u6362\u77e9\u9635</p>\n</li>\n<li>\n<p><strong>\u7269\u54c1\u4fa7\u5171\u4eab</strong>\uff1a\u5f53\u7269\u54c1\u5177\u6709\u8de8\u57df\u5c5e\u6027\u65f6\n$$\\mathbf{V}^{(k)} = \\mathbf{V}_{\\text{shared}} \\mathbf{C}^{(k)}$$</p>\n</li>\n<li>\n<p><strong>\u6df1\u5ea6\u5171\u4eab</strong>\uff1a\u901a\u8fc7\u6df1\u5ea6\u7f51\u7edc\u5b66\u4e60\u57df\u95f4\u6620\u5c04</p>\n</li>\n</ol>\n<h3 id=\"1643\">16.4.3 \u5f20\u91cf\u8026\u5408\u5206\u89e3</h3>\n<p>\u5f53\u8de8\u57df\u6570\u636e\u5177\u6709\u9ad8\u9636\u7ed3\u6784\u65f6\uff0c\u4f7f\u7528\u8026\u5408\u5f20\u91cf\u5206\u89e3\uff1a</p>\n<p><strong>CMTF\uff08Coupled Matrix-Tensor Factorization\uff09</strong>\uff1a\n\u540c\u65f6\u5206\u89e3\u77e9\u9635\u548c\u5f20\u91cf\uff0c\u901a\u8fc7\u5171\u4eab\u6a21\u5f0f\u5b9e\u73b0\u8026\u5408\uff1a\n$$\\min |\\mathcal{X} - \\sum_{r=1}^{R} \\mathbf{a}_r \\circ \\mathbf{b}_r \\circ \\mathbf{c}_r|_F^2 + \\beta |\\mathbf{Y} - \\mathbf{A}\\mathbf{D}^T|_F^2$$\n\u5176\u4e2d\u5f20\u91cf $\\mathcal{X}$ \u548c\u77e9\u9635 $\\mathbf{Y}$ \u5171\u4eab\u56e0\u5b50\u77e9\u9635 $\\mathbf{A}$\u3002</p>\n<p><strong>\u5e94\u7528\u5b9e\u4f8b</strong>\uff1a</p>\n<ul>\n<li>$\\mathcal{X}$\uff1a\u7528\u6237-\u7269\u54c1-\u65f6\u95f4 \u4ea4\u4e92\u5f20\u91cf</li>\n<li>$\\mathbf{Y}$\uff1a\u7528\u6237-\u5c5e\u6027 \u7279\u5f81\u77e9\u9635</li>\n<li>\u5171\u4eab\u7528\u6237\u56e0\u5b50 $\\mathbf{A}$ \u5b9e\u73b0\u7279\u5f81\u589e\u5f3a</li>\n</ul>\n<h3 id=\"1644\">16.4.4 \u975e\u8d1f\u8026\u5408\u5206\u89e3</h3>\n<p>\u63a8\u8350\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u901a\u5e38\u975e\u8d1f\uff08\u8bc4\u5206\u3001\u70b9\u51fb\u6b21\u6570\u7b49\uff09\uff0c\u975e\u8d1f\u7ea6\u675f\u5e26\u6765\u66f4\u597d\u7684\u53ef\u89e3\u91ca\u6027\uff1a</p>\n<p><strong>\u975e\u8d1fCMTF</strong>\uff1a\n$$\\min_{\\mathbf{A}, \\mathbf{B}, \\mathbf{C} \\geq 0} |\\mathcal{X} - \\sum_{r=1}^{R} \\mathbf{a}_r \\circ \\mathbf{b}_r \\circ \\mathbf{c}_r|_F^2$$\n<strong>\u4e58\u6027\u66f4\u65b0\u89c4\u5219</strong>\uff1a\n\u4fdd\u8bc1\u975e\u8d1f\u6027\u7684\u540c\u65f6\u4f18\u5316\u76ee\u6807\u51fd\u6570\uff1a\n$$\\mathbf{A} \\leftarrow \\mathbf{A} \\odot \\frac{[\\nabla_{\\mathbf{A}} f]^-}{[\\nabla_{\\mathbf{A}} f]^+ + \\epsilon}$$\n\u5176\u4e2d $[x]^+ = \\max(x, 0)$\uff0c$[x]^- = \\max(-x, 0)$\u3002</p>\n<h3 id=\"1645\">16.4.5 \u9690\u79c1\u4fdd\u62a4\u7684\u8054\u90a6\u8026\u5408\u5206\u89e3</h3>\n<p>\u8de8\u57df\u63a8\u8350\u9762\u4e34\u4e25\u91cd\u7684\u9690\u79c1\u6311\u6218\u3002\u8054\u90a6\u5b66\u4e60\u63d0\u4f9b\u4e86\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\uff1a</p>\n<p><strong>\u5782\u76f4\u8054\u90a6CMF</strong>\uff1a</p>\n<ul>\n<li>\u5404\u57df\u4fdd\u7559\u539f\u59cb\u6570\u636e</li>\n<li>\u4ec5\u4ea4\u6362\u52a0\u5bc6\u7684\u4e2d\u95f4\u7ed3\u679c</li>\n<li>\u4f7f\u7528\u5b89\u5168\u591a\u65b9\u8ba1\u7b97\u6216\u540c\u6001\u52a0\u5bc6</li>\n</ul>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a</p>\n<ol>\n<li>\u5404\u57df\u672c\u5730\u66f4\u65b0\u79c1\u6709\u56e0\u5b50</li>\n<li>\u5b89\u5168\u805a\u5408\u5171\u4eab\u56e0\u5b50\u7684\u68af\u5ea6</li>\n<li>\u4f7f\u7528\u5dee\u5206\u9690\u79c1\u6dfb\u52a0\u566a\u58f0</li>\n<li>\u66f4\u65b0\u5168\u5c40\u5171\u4eab\u56e0\u5b50</li>\n</ol>\n<p><strong>\u9690\u79c1-\u6548\u7528\u6743\u8861</strong>\uff1a\n$$\\mathcal{L}_{\\text{private}} = \\mathcal{L}_{\\text{original}} + \\lambda \\cdot \\text{DP-noise}$$\n\u9009\u62e9\u5408\u9002\u7684 $\\lambda$ \u5e73\u8861\u9690\u79c1\u4fdd\u62a4\u548c\u63a8\u8350\u6027\u80fd\u3002</p>\n<h3 id=\"1646\">16.4.6 \u5728\u7ebf\u8026\u5408\u5206\u89e3</h3>\n<p>\u5b9e\u65f6\u8de8\u57df\u63a8\u8350\u9700\u8981\u589e\u91cf\u66f4\u65b0\u7b97\u6cd5\uff1a</p>\n<p><strong>\u589e\u91cfCMTF\u7b97\u6cd5</strong>\uff1a\n\u5f53\u65b0\u6570\u636e $\\Delta \\mathcal{X}$ \u5230\u8fbe\u65f6\uff1a</p>\n<ol>\n<li>\u56fa\u5b9a\u5176\u4ed6\u57df\u7684\u56e0\u5b50</li>\n<li>\u4f7f\u7528 Woodbury \u6052\u7b49\u5f0f\u66f4\u65b0\u5171\u4eab\u56e0\u5b50</li>\n<li>\u5c40\u90e8\u5fae\u8c03\u57df\u7279\u5b9a\u56e0\u5b50</li>\n</ol>\n<p><strong>\u65f6\u95f4\u590d\u6742\u5ea6</strong>\uff1a\n\u4ece $O(KNR^2)$ \u964d\u81f3 $O(|\\Delta|R^2)$\uff0c\u5176\u4e2d $|\\Delta|$ \u662f\u65b0\u6570\u636e\u91cf\u3002</p>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86\u591a\u6a21\u6001\u63a8\u8350\u4e2d\u7684\u5f20\u91cf\u5206\u89e3\u6280\u672f\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f20\u91cf\u5efa\u6a21</strong>\u4e3a\u591a\u7ef4\u4ea4\u4e92\u63d0\u4f9b\u4e86\u81ea\u7136\u7684\u6570\u5b66\u6846\u67b6\uff0c\u4f46\u7a00\u758f\u6027\u5e26\u6765\u4e86\u8ba1\u7b97\u548c\u7edf\u8ba1\u6311\u6218</p>\n</li>\n<li>\n<p><strong>CP\u5206\u89e3\u548cTucker\u5206\u89e3</strong>\u5404\u6709\u4f18\u52bf\uff1a\n   - CP\u5206\u89e3\uff1a\u53c2\u6570\u5c11\uff0c\u6613\u89e3\u91ca\n   - Tucker\u5206\u89e3\uff1a\u8868\u8fbe\u80fd\u529b\u5f3a\uff0c\u7075\u6d3b\u6027\u9ad8</p>\n</li>\n<li>\n<p><strong>\u7a00\u758f\u5f20\u91cf\u8ba1\u7b97</strong>\u7684\u5173\u952e\u5728\u4e8e\uff1a\n   - \u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u683c\u5f0f\n   - \u4f18\u5316\u6838\u5fc3\u64cd\u4f5c\uff08\u5982MTTKRP\uff09\n   - \u5229\u7528\u5e76\u884c\u548c\u5206\u5e03\u5f0f\u8ba1\u7b97</p>\n</li>\n<li>\n<p><strong>\u8de8\u57df\u63a8\u8350</strong>\u901a\u8fc7\u8026\u5408\u5206\u89e3\u5b9e\u73b0\u77e5\u8bc6\u8fc1\u79fb\uff0c\u4f46\u9700\u8981carefully\u8bbe\u8ba1\u5171\u4eab\u673a\u5236\u5e76\u8003\u8651\u9690\u79c1\u4fdd\u62a4</p>\n</li>\n</ol>\n<p><strong>\u5173\u952e\u516c\u5f0f\u6c47\u603b</strong>\uff1a</p>\n<ul>\n<li>CP\u5206\u89e3\uff1a$\\mathcal{X} \\approx \\sum_{r=1}^{R} \\lambda_r \\mathbf{a}_r^{(1)} \\circ \\mathbf{a}_r^{(2)} \\circ \\cdots \\circ \\mathbf{a}_r^{(N)}$</li>\n<li>Tucker\u5206\u89e3\uff1a$\\mathcal{X} \\approx \\mathcal{G} \\times_1 \\mathbf{U}^{(1)} \\times_2 \\mathbf{U}^{(2)} \\times_3 \\cdots \\times_N \\mathbf{U}^{(N)}$</li>\n<li>MTTKRP\uff1a$\\mathbf{Y} = \\mathbf{X}_{(n)} (\\mathbf{A}^{(N)} \\odot \\cdots \\odot \\mathbf{A}^{(1)})$</li>\n<li>CMF\u76ee\u6807\uff1a$\\min \\sum_{k} \\alpha_k |\\mathbf{R}^{(k)} - \\mathbf{U}^{(k)} (\\mathbf{V}^{(k)})^T|_F^2$</li>\n</ul>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef\uff08Gotchas\uff09</h2>\n<h3 id=\"1\">1. \u79e9\u9009\u62e9\u7684\u9677\u9631</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u9009\u62e9\u8fc7\u5927\u7684\u79e9 $R$\uff0c\u671f\u671b\u83b7\u5f97\u66f4\u597d\u7684\u62df\u5408</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u8fc7\u62df\u5408\u3001\u8ba1\u7b97\u5f00\u9500\u5267\u589e\u3001\u6570\u503c\u4e0d\u7a33\u5b9a</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u4f7f\u7528\u4ea4\u53c9\u9a8c\u8bc1\u3001\u6838\u5fc3\u4e00\u81f4\u6027\u8bca\u65ad\uff08Core Consistency Diagnostic\uff09</li>\n</ul>\n<h3 id=\"2\">2. \u521d\u59cb\u5316\u654f\u611f\u6027</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u4f7f\u7528\u5168\u96f6\u6216\u7edf\u4e00\u968f\u673a\u521d\u59cb\u5316</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u9677\u5165\u5c40\u90e8\u6700\u4f18\u3001\u6536\u655b\u7f13\u6162</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u4f7f\u7528SVD-based\u521d\u59cb\u5316\u3001\u591a\u6b21\u968f\u673a\u91cd\u542f</li>\n</ul>\n<h3 id=\"3\">3. \u7a00\u758f\u6027\u5904\u7406\u4e0d\u5f53</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u5c06\u7f3a\u5931\u503c\u586b\u5145\u4e3a0\u8fdb\u884c\u7a20\u5bc6\u8ba1\u7b97</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u5f15\u5165\u5927\u91cf\u504f\u5dee\u3001\u5185\u5b58\u7206\u70b8</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u53ea\u5728\u89c2\u6d4b\u4f4d\u7f6e\u8ba1\u7b97\u635f\u5931\u3001\u4f7f\u7528\u7a00\u758f\u5f20\u91cf\u683c\u5f0f</li>\n</ul>\n<h3 id=\"4\">4. \u8d1f\u91c7\u6837\u504f\u5dee</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u5c06\u6240\u6709\u672a\u89c2\u6d4b\u9879\u89c6\u4e3a\u8d1f\u6837\u672c</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u4e25\u91cd\u7684\u5047\u9634\u6027\u95ee\u9898</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u52a0\u6743\u91c7\u6837\u3001\u7f6e\u4fe1\u5ea6\u5efa\u6a21\u3001\u4f7f\u7528\u8f85\u52a9\u4fe1\u606f</li>\n</ul>\n<h3 id=\"5\">5. \u6570\u503c\u7a33\u5b9a\u6027\u95ee\u9898</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u76f4\u63a5\u8ba1\u7b97 Khatri-Rao \u79ef\u7684\u9006</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u6761\u4ef6\u6570\u7206\u70b8\u3001\u6570\u503c\u8bef\u5dee\u7d2f\u79ef</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u4f7f\u7528\u4f2a\u9006\u3001\u6dfb\u52a0\u6b63\u5219\u5316\u9879\u3001QR\u5206\u89e3</li>\n</ul>\n<h3 id=\"6\">6. \u8de8\u57df\u8d1f\u8fc1\u79fb</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u76f2\u76ee\u5171\u4eab\u6240\u6709\u56e0\u5b50</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u6e90\u57df\u566a\u58f0\u6c61\u67d3\u76ee\u6807\u57df</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u9009\u62e9\u6027\u8fc1\u79fb\u3001\u57df\u81ea\u9002\u5e94\u673a\u5236\u3001\u6ce8\u610f\u529b\u673a\u5236</li>\n</ul>\n<h3 id=\"7\">7. \u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u901a\u4fe1\u74f6\u9888</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u9891\u7e41\u7684\u5168\u5c40\u540c\u6b65</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u901a\u4fe1\u6210\u672c\u8d85\u8fc7\u8ba1\u7b97\u6210\u672c</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u5f02\u6b65\u66f4\u65b0\u3001\u672c\u5730\u8ba1\u7b97\u4f18\u5148\u3001\u68af\u5ea6\u538b\u7f29</li>\n</ul>\n<h3 id=\"8\">8. \u5185\u5b58\u6ea2\u51fa\u95ee\u9898</h3>\n<ul>\n<li><strong>\u9519\u8bef</strong>\uff1a\u5b58\u50a8\u5b8c\u6574\u7684\u4e2d\u95f4\u5f20\u91cf</li>\n<li><strong>\u95ee\u9898</strong>\uff1a\u5373\u4f7f\u7a00\u758f\u5f20\u91cf\u4e5f\u53ef\u80fd\u4ea7\u751f\u7a20\u5bc6\u4e2d\u95f4\u7ed3\u679c</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u6d41\u5f0f\u8ba1\u7b97\u3001\u5206\u5757\u5904\u7406\u3001\u53ca\u65f6\u91ca\u653e\u5185\u5b58</li>\n</ul>\n<h2 id=\"_2\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_3\">\u5f20\u91cf\u5206\u89e3\u8bbe\u8ba1\u5ba1\u67e5</h3>\n<ol>\n<li>\n<p><strong>\u6570\u636e\u5efa\u6a21</strong>\n   - [ ] \u662f\u5426\u6b63\u786e\u8bc6\u522b\u4e86\u6240\u6709\u76f8\u5173\u7ef4\u5ea6\uff1f\n   - [ ] \u5f20\u91cf\u7684\u9636\u6570\u662f\u5426\u5408\u7406\uff08\u901a\u5e383-5\u9636\uff09\uff1f\n   - [ ] \u662f\u5426\u8003\u8651\u4e86\u65f6\u95f4\u52a8\u6001\u6027\uff1f\n   - [ ] \u7a00\u758f\u6027\u6a21\u5f0f\u662f\u5426\u5df2\u5206\u6790\uff1f</p>\n</li>\n<li>\n<p><strong>\u7b97\u6cd5\u9009\u62e9</strong>\n   - [ ] CP vs Tucker\uff1a\u662f\u5426\u57fa\u4e8e\u53ef\u89e3\u91ca\u6027\u9700\u6c42\u9009\u62e9\uff1f\n   - [ ] \u79e9\u7684\u9009\u62e9\u662f\u5426\u7ecf\u8fc7\u9a8c\u8bc1\uff1f\n   - [ ] \u662f\u5426\u9700\u8981\u975e\u8d1f\u7ea6\u675f\uff1f\n   - [ ] \u6b63\u5219\u5316\u7b56\u7565\u662f\u5426\u5408\u7406\uff1f</p>\n</li>\n<li>\n<p><strong>\u5b9e\u73b0\u4f18\u5316</strong>\n   - [ ] \u5b58\u50a8\u683c\u5f0f\u662f\u5426\u5339\u914d\u8bbf\u95ee\u6a21\u5f0f\uff1f\n   - [ ] MTTKRP\u662f\u5426\u5df2\u4f18\u5316\uff1f\n   - [ ] \u662f\u5426\u5229\u7528\u4e86\u5e76\u884c\u8ba1\u7b97\uff1f\n   - [ ] \u5185\u5b58\u4f7f\u7528\u662f\u5426\u5728\u63a7\u5236\u8303\u56f4\u5185\uff1f</p>\n</li>\n<li>\n<p><strong>\u5206\u5e03\u5f0f\u8ba1\u7b97</strong>\n   - [ ] \u5206\u533a\u7b56\u7565\u662f\u5426\u5747\u8861\u8d1f\u8f7d\uff1f\n   - [ ] \u901a\u4fe1\u6a21\u5f0f\u662f\u5426\u5df2\u4f18\u5316\uff1f\n   - [ ] \u662f\u5426\u5904\u7406\u4e86\u8282\u70b9\u6545\u969c\uff1f\n   - [ ] \u540c\u6b65\u9891\u7387\u662f\u5426\u5408\u7406\uff1f</p>\n</li>\n<li>\n<p><strong>\u8de8\u57df\u63a8\u8350</strong>\n   - [ ] \u5171\u4eab\u673a\u5236\u662f\u5426\u5408\u7406\uff1f\n   - [ ] \u662f\u5426\u8bc4\u4f30\u4e86\u8d1f\u8fc1\u79fb\u98ce\u9669\uff1f\n   - [ ] \u9690\u79c1\u4fdd\u62a4\u63aa\u65bd\u662f\u5426\u5230\u4f4d\uff1f\n   - [ ] \u57df\u81ea\u9002\u5e94\u673a\u5236\u662f\u5426\u5fc5\u8981\uff1f</p>\n</li>\n<li>\n<p><strong>\u5de5\u7a0b\u5b9e\u8df5</strong>\n   - [ ] \u662f\u5426\u6709\u589e\u91cf\u66f4\u65b0\u80fd\u529b\uff1f\n   - [ ] \u6a21\u578b\u7248\u672c\u7ba1\u7406\u7b56\u7565\uff1f\n   - [ ] A/B\u6d4b\u8bd5\u6846\u67b6\u662f\u5426\u5c31\u7eea\uff1f\n   - [ ] \u76d1\u63a7\u6307\u6807\u662f\u5426\u5b8c\u5584\uff1f</p>\n</li>\n</ol>\n<h3 id=\"_4\">\u6027\u80fd\u4f18\u5316\u68c0\u67e5</h3>\n<ol>\n<li>\n<p><strong>\u8ba1\u7b97\u6027\u80fd</strong>\n   - [ ] \u70ed\u70b9\u51fd\u6570\u662f\u5426\u5df2\u8bc6\u522b\u5e76\u4f18\u5316\uff1f\n   - [ ] \u5411\u91cf\u5316\u673a\u4f1a\u662f\u5426\u5145\u5206\u5229\u7528\uff1f\n   - [ ] \u7f13\u5b58\u53cb\u597d\u7684\u6570\u636e\u5e03\u5c40\uff1f\n   - [ ] GPU\u5229\u7528\u7387\u662f\u5426\u5145\u5206\uff1f</p>\n</li>\n<li>\n<p><strong>\u53ef\u6269\u5c55\u6027</strong>\n   - [ ] \u662f\u5426\u5728\u4e0d\u540c\u6570\u636e\u89c4\u6a21\u4e0b\u6d4b\u8bd5\uff1f\n   - [ ] \u5f3a\u6269\u5c55\u6027\u548c\u5f31\u6269\u5c55\u6027\u5982\u4f55\uff1f\n   - [ ] \u74f6\u9888\u5728\u8ba1\u7b97\u8fd8\u662f\u901a\u4fe1\uff1f\n   - [ ] \u662f\u5426\u6709\u89c4\u6a21\u4e0a\u9650\uff1f</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\n   - [ ] \u6761\u4ef6\u6570\u662f\u5426\u76d1\u63a7\uff1f\n   - [ ] \u662f\u5426\u4f7f\u7528\u4e86\u6570\u503c\u7a33\u5b9a\u7684\u7b97\u6cd5\uff1f\n   - [ ] \u7cbe\u5ea6\u635f\u5931\u662f\u5426\u53ef\u63a5\u53d7\uff1f\n   - [ ] \u662f\u5426\u6709\u5f02\u5e38\u503c\u5904\u7406\uff1f</p>\n</li>\n</ol>\n<h2 id=\"_5\">\u8fdb\u4e00\u6b65\u7814\u7a76\u65b9\u5411</h2>\n<ol>\n<li><strong>\u81ea\u9002\u5e94\u5f20\u91cf\u5206\u89e3</strong>\uff1a\u6839\u636e\u6570\u636e\u7279\u6027\u81ea\u52a8\u9009\u62e9\u5206\u89e3\u65b9\u6cd5\u548c\u53c2\u6570</li>\n<li><strong>\u795e\u7ecf\u5f20\u91cf\u7f51\u7edc</strong>\uff1a\u7ed3\u5408\u6df1\u5ea6\u5b66\u4e60\u548c\u5f20\u91cf\u5206\u89e3\u7684\u4f18\u52bf</li>\n<li><strong>\u91cf\u5b50\u5f20\u91cf\u7b97\u6cd5</strong>\uff1a\u5229\u7528\u91cf\u5b50\u8ba1\u7b97\u52a0\u901f\u5927\u89c4\u6a21\u5f20\u91cf\u8fd0\u7b97</li>\n<li><strong>\u56e0\u679c\u5f20\u91cf\u5206\u6790</strong>\uff1a\u4ece\u5173\u8054\u5230\u56e0\u679c\u7684\u63a8\u8350\u7cfb\u7edf</li>\n<li><strong>\u6301\u7eed\u5b66\u4e60\u5f20\u91cf</strong>\uff1a\u5904\u7406\u6982\u5ff5\u6f02\u79fb\u548c\u9057\u5fd8\u673a\u5236</li>\n<li><strong>\u56fe\u5f20\u91cf\u7f51\u7edc</strong>\uff1a\u7ed3\u5408\u56fe\u7ed3\u6784\u548c\u5f20\u91cf\u65b9\u6cd5</li>\n</ol>\n<h2 id=\"_6\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"161_1\">\u7ec3\u4e6016.1\uff1a\u5f20\u91cf\u5efa\u6a21\u8bbe\u8ba1\uff08\u57fa\u7840\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u56db\u9636\u5f20\u91cf\u6765\u5efa\u6a21\"\u7528\u6237-\u7269\u54c1-\u65f6\u95f4-\u5730\u70b9\"\u7684\u4ea4\u4e92\u3002\u8ba8\u8bba\u8fd9\u4e2a\u5f20\u91cf\u7684\u7a00\u758f\u6027\u7279\u5f81\uff0c\u5e76\u4f30\u8ba1\u57281M\u7528\u6237\u3001100K\u7269\u54c1\u3001365\u5929\u30011000\u4e2a\u5730\u70b9\u7684\u573a\u666f\u4e0b\uff0c\u9700\u8981\u591a\u5c11\u5185\u5b58\u6765\u5b58\u50a8\uff08\u5047\u8bbe1%\u7684\u89c2\u6d4b\u7387\uff09\u3002</p>\n<p><strong>Hint</strong>: \u8003\u8651COO\u683c\u5f0f\u7684\u5b58\u50a8\u5f00\u9500\uff0c\u6bcf\u4e2a\u975e\u96f6\u5143\u7d20\u9700\u8981\u5b58\u50a8\u5750\u6807\u548c\u503c\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u56db\u9636\u5f20\u91cf $\\mathcal{X} \\in \\mathbb{R}^{10^6 \\times 10^5 \\times 365 \\times 10^3}$</p>\n<p>\u603b\u5143\u7d20\u6570\uff1a$10^6 \\times 10^5 \\times 365 \\times 10^3 = 3.65 \\times 10^{16}$</p>\n<p>\u89c2\u6d4b\u5143\u7d20\u6570\uff081%\uff09\uff1a$3.65 \\times 10^{14}$</p>\n<p>COO\u683c\u5f0f\u5b58\u50a8\uff1a</p>\n<ul>\n<li>\u6bcf\u4e2a\u5143\u7d20\u9700\u8981\uff1a4\u4e2a\u6574\u6570\u7d22\u5f15\uff084\u00d74=16\u5b57\u8282\uff09+ 1\u4e2a\u6d6e\u70b9\u503c\uff088\u5b57\u8282\uff09= 24\u5b57\u8282</li>\n<li>\u603b\u5185\u5b58\uff1a$3.65 \\times 10^{14} \\times 24 \\text{ bytes} \u2248 8.76 \\text{ PB}$</li>\n</ul>\n<p>\u8fd9\u8bf4\u660e\u5373\u4f7f\u662f\u7a00\u758f\u5b58\u50a8\uff0c\u5927\u89c4\u6a21\u5f20\u91cf\u4ecd\u7136\u9762\u4e34\u4e25\u91cd\u7684\u5b58\u50a8\u6311\u6218\u3002\u5b9e\u8df5\u4e2d\u9700\u8981\uff1a</p>\n<ol>\n<li>\u8fdb\u4e00\u6b65\u538b\u7f29\uff08\u5982\u65f6\u95f4\u5206\u6876\uff09</li>\n<li>\u5206\u5e03\u5f0f\u5b58\u50a8</li>\n<li>\u91c7\u6837\u6216sketch\u6280\u672f</li>\n</ol>\n</details>\n<h3 id=\"162cp\">\u7ec3\u4e6016.2\uff1aCP\u5206\u89e3\u6536\u655b\u6027\u5206\u6790\uff08\u57fa\u7840\uff09</h3>\n<p>\u8bc1\u660e\u5f53\u5f20\u91cf\u5143\u7d20\u72ec\u7acb\u540c\u5206\u5e03\u4e8e $\\mathcal{N}(0, \\sigma^2)$ \u65f6\uff0cCP-ALS\u7b97\u6cd5\u7684\u6761\u4ef6\u6570\u968f\u79e9 $R$ \u7684\u589e\u957f\u5173\u7cfb\u3002\u8fd9\u5bf9\u7b97\u6cd5\u6536\u655b\u6709\u4ec0\u4e48\u5f71\u54cd\uff1f</p>\n<p><strong>Hint</strong>: \u8003\u8651 Khatri-Rao \u79ef\u7684 Gram \u77e9\u9635 $\\mathbf{V}^{(n)}$ \u7684\u7279\u5f81\u503c\u5206\u5e03\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5bf9\u4e8e\u968f\u673a\u521d\u59cb\u5316\u7684\u56e0\u5b50\u77e9\u9635\uff0cGram \u77e9\u9635 $\\mathbf{V}^{(n)} = \\prod_{k \\neq n} (\\mathbf{A}^{(k)})^T \\mathbf{A}^{(k)}$ \u7684\u6761\u4ef6\u6570\u8fd1\u4f3c\u4e3a\uff1a\n$$\\kappa(\\mathbf{V}^{(n)}) \\approx O(R^{N-1})$$</p>\n<p>\u5176\u4e2d $N$ \u662f\u5f20\u91cf\u7684\u9636\u6570\u3002</p>\n<p>\u8bc1\u660e\u8981\u70b9\uff1a</p>\n<ol>\n<li>\u6bcf\u4e2a $(\\mathbf{A}^{(k)})^T \\mathbf{A}^{(k)}$ \u7684\u6761\u4ef6\u6570\u7ea6\u4e3a $O(R)$</li>\n<li>Hadamard \u79ef\u4fdd\u6301\u6b63\u5b9a\u6027\u4f46\u4f1a\u653e\u5927\u6761\u4ef6\u6570</li>\n<li>\u6700\u7ec8\u6761\u4ef6\u6570\u662f\u5404\u9879\u7684\u4e58\u79ef</li>\n</ol>\n<p>\u5f71\u54cd\uff1a</p>\n<ul>\n<li>\u9ad8\u79e9\u5206\u89e3\u6570\u503c\u4e0d\u7a33\u5b9a</li>\n<li>\u6536\u655b\u901f\u5ea6\u663e\u8457\u964d\u4f4e</li>\n<li>\u9700\u8981\u6b63\u5219\u5316\u6216\u9884\u6761\u4ef6\u6280\u672f</li>\n</ul>\n</details>\n<h3 id=\"163mttkrp\">\u7ec3\u4e6016.3\uff1a\u7a00\u758fMTTKRP\u4f18\u5316\uff08\u6311\u6218\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u7f13\u5b58\u53cb\u597d\u7684\u7a00\u758fMTTKRP\u7b97\u6cd5\uff0c\u4f7f\u5f97\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u6700\u5927\u5316\u5229\u7528 L1/L2 \u7f13\u5b58\u3002\u5206\u6790\u4f60\u7684\u7b97\u6cd5\u5728\u4e0d\u540c\u7a00\u758f\u6a21\u5f0f\u4e0b\u7684\u6027\u80fd\u3002</p>\n<p><strong>Hint</strong>: \u8003\u8651\u975e\u96f6\u5143\u7d20\u7684\u91cd\u6392\u5e8f\u548c\u5206\u5757\u7b56\u7565\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7f13\u5b58\u53cb\u597d\u7684\u7a00\u758fMTTKRP\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>\u975e\u96f6\u5143\u7d20\u91cd\u6392\u5e8f</strong>\uff1a\n   - \u4f7f\u7528 Z-order (Morton order) \u5bf9\u5750\u6807\u6392\u5e8f\n   - \u4fdd\u6301\u7a7a\u95f4\u5c40\u90e8\u6027</p>\n</li>\n<li>\n<p><strong>\u5206\u5757\u7b56\u7565</strong>\uff1a\n   <code>\u5c06\u5f20\u91cf\u5206\u6210\u5927\u5c0f\u4e3a B\u00d7B\u00d7B \u7684\u5757\n   for each \u5757 b:\n       \u52a0\u8f7d\u76f8\u5173\u7684\u56e0\u5b50\u77e9\u9635\u7247\u6bb5\u5230\u7f13\u5b58\n       for each \u975e\u96f6\u5143\u7d20 (i,j,k,v) in \u5757 b:\n           for r = 1 to R:\n               Y[i,r] += v * A[j,r] * B[k,r]</code></p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u5206\u6790</strong>\uff1a\n   - \u968f\u673a\u7a00\u758f\uff1a\u7f13\u5b58\u547d\u4e2d\u7387 \u2248 B\u00b3/\u603b\u5757\u6570\n   - \u7ed3\u6784\u5316\u7a00\u758f\uff08\u5982\u5bf9\u89d2\u5e26\uff09\uff1a\u53ef\u8fbe\u5230 90%+ \u7f13\u5b58\u547d\u4e2d\u7387\n   - \u5757\u5927\u5c0f\u9009\u62e9\uff1aB = \u221b(L2_cache_size / (3\u00d7R\u00d7sizeof(float)))</p>\n</li>\n<li>\n<p><strong>\u8fdb\u4e00\u6b65\u4f18\u5316</strong>\uff1a\n   - \u4f7f\u7528 tiling \u5904\u7406\u56e0\u5b50\u77e9\u9635\n   - SIMD \u5411\u91cf\u5316\u5185\u5c42\u5faa\u73af\n   - \u9884\u53d6\u4e0b\u4e00\u4e2a\u5757\u7684\u6570\u636e</p>\n</li>\n</ol>\n</details>\n<h3 id=\"164tucker-vs-cp\">\u7ec3\u4e6016.4\uff1aTucker vs CP\u9009\u62e9\uff08\u6311\u6218\uff09</h3>\n<p>\u7ed9\u5b9a\u4e00\u4e2a\u4e09\u9636\u5f20\u91cf\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u81ea\u52a8\u5316\u65b9\u6cd5\u6765\u51b3\u5b9a\u4f7f\u7528 Tucker \u5206\u89e3\u8fd8\u662f CP \u5206\u89e3\u3002\u4f60\u7684\u65b9\u6cd5\u5e94\u8be5\u8003\u8651\u51c6\u786e\u6027\u3001\u53ef\u89e3\u91ca\u6027\u548c\u8ba1\u7b97\u6548\u7387\u3002</p>\n<p><strong>Hint</strong>: \u53ef\u4ee5\u4ece\u6838\u5fc3\u4e00\u81f4\u6027\u8bca\u65ad\uff08CORCONDIA\uff09\u5f00\u59cb\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u52a8\u9009\u62e9\u7b97\u6cd5\uff1a</p>\n<ol>\n<li><strong>\u5feb\u901f\u9884\u5206\u6790</strong>\uff1a\n   ```python\n   # \u8ba1\u7b97\u5f20\u91cf\u7684\u6a21\u6001\u76f8\u5173\u6027\n   for n in [1, 2, 3]:\n       S[n] = svd(unfold(X, n), k=10)\n       decay_rate[n] = S[n][5] / S[n][0]</li>\n</ol>\n<p># \u5982\u679c\u6240\u6709\u6a21\u6001\u7684\u5947\u5f02\u503c\u90fd\u5feb\u901f\u8870\u51cf\uff0c\u503e\u5411\u4e8eCP\n   if all(decay_rate &lt; 0.1):\n       initial_choice = \"CP\"\n   else:\n       initial_choice = \"Tucker\"\n   ```</p>\n<ol start=\"2\">\n<li><strong>CORCONDIA \u6d4b\u8bd5</strong>\uff08\u9488\u5bf9CP\uff09\uff1a\n   ```\n   \u5bf9\u4e8e\u79e9 R = 1, 2, ..., R_max:\n       \u6267\u884c CP \u5206\u89e3\u5f97\u5230 [[A, B, C]]\n       \u8ba1\u7b97\u6838\u5fc3\u4e00\u81f4\u6027\uff1a\n       G = X \u00d7\u2081 A\u2020 \u00d7\u2082 B\u2020 \u00d7\u2083 C\u2020\n       corcondia[R] = 100 * (1 - \u2211\u1d62\u2260\u2c7c g\u00b2\u1d62\u2c7c\u2096 / \u2211\u1d62\u2c7c\u2096 g\u00b2\u1d62\u2c7c\u2096)</li>\n</ol>\n<p>\u5982\u679c max(corcondia) &lt; 90:\n       \u9009\u62e9 Tucker\n   ```</p>\n<ol start=\"3\">\n<li><strong>\u590d\u6742\u5ea6-\u7cbe\u5ea6\u6743\u8861</strong>\uff1a\n   ```\n   CP_cost = O(nnz(X) \u00d7 R \u00d7 iterations)\n   Tucker_cost = O(nnz(X) \u00d7 (R\u2081R\u2082 + R\u2082R\u2083 + R\u2081R\u2083))</li>\n</ol>\n<p>if Tucker_cost / CP_cost &gt; threshold AND accuracy_gap &lt; \u03b5:\n       \u9009\u62e9 CP\n   ```</p>\n<ol start=\"4\">\n<li><strong>\u6700\u7ec8\u51b3\u7b56\u6811</strong>\uff1a\n   - \u9700\u8981\u53ef\u89e3\u91ca\u6027 \u2192 CP\n   - \u79e9\u5f88\u4f4e(&lt;10) \u2192 CP<br />\n   - \u6a21\u6001\u95f4\u76f8\u5173\u6027\u5f3a \u2192 Tucker\n   - \u5185\u5b58\u53d7\u9650 \u2192 CP\n   - \u5426\u5219 \u2192 \u4ea4\u53c9\u9a8c\u8bc1\u9009\u62e9</li>\n</ol>\n</details>\n<h3 id=\"165\">\u7ec3\u4e6016.5\uff1a\u8de8\u57df\u8d1f\u8fc1\u79fb\u68c0\u6d4b\uff08\u5f00\u653e\u6027\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u5728\u7ebf\u7b97\u6cd5\u6765\u68c0\u6d4b\u8de8\u57df\u63a8\u8350\u4e2d\u7684\u8d1f\u8fc1\u79fb\u73b0\u8c61\u3002\u7b97\u6cd5\u5e94\u8be5\u80fd\u591f\u81ea\u52a8\u8bc6\u522b\u54ea\u4e9b\u5171\u4eab\u7684\u56e0\u5b50\u5bf9\u76ee\u6807\u57df\u6709\u5bb3\uff0c\u5e76\u63d0\u51fa\u7f13\u89e3\u7b56\u7565\u3002</p>\n<p><strong>Hint</strong>: \u8003\u8651\u4f7f\u7528\u9a8c\u8bc1\u96c6\u4e0a\u7684\u6027\u80fd\u53d8\u5316\u548c\u68af\u5ea6\u5206\u6790\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8d1f\u8fc1\u79fb\u68c0\u6d4b\u4e0e\u7f13\u89e3\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u7ebf\u5efa\u7acb</strong>\uff1a\n   - \u4ec5\u4f7f\u7528\u76ee\u6807\u57df\u6570\u636e\u8bad\u7ec3\u6a21\u578bM\u2080\n   - \u8bb0\u5f55\u9a8c\u8bc1\u96c6\u6027\u80fd P\u2080</p>\n</li>\n<li>\n<p><strong>\u589e\u91cf\u5171\u4eab\u6d4b\u8bd5</strong>\uff1a\n   ```python\n   for each \u5171\u4eab\u5c42\u7ea7 l in [1, ..., L]:\n       # \u9010\u6b65\u589e\u52a0\u5171\u4eab\u7a0b\u5ea6\n       M_l = CMF with sharing up to layer l\n       P_l = evaluate(M_l, validation_set)</p>\n<p># \u68c0\u6d4b\u6027\u80fd\u4e0b\u964d\n   if P_l &lt; P_{l-1} - \u03b5:\n       negative_transfer_detected(layer=l)\n   ```</p>\n</li>\n<li>\n<p><strong>\u56e0\u5b50\u7ea7\u522b\u5206\u6790</strong>\uff1a\n   ```python\n   # \u8ba1\u7b97\u5404\u56e0\u5b50\u7684\u8d21\u732e\n   for each factor f:\n       # \u68af\u5ea6\u76f8\u4f3c\u6027\u5206\u6790\n       g_source = gradient(L_source, f)\n       g_target = gradient(L_target, f)\n       similarity[f] = cosine(g_source, g_target)</p>\n<p># \u8d1f\u76f8\u4f3c\u6027\u8868\u793a\u53ef\u80fd\u7684\u8d1f\u8fc1\u79fb\n   if similarity[f] &lt; -threshold:\n       suspicious_factors.add(f)\n   ```</p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6743\u91cd\u673a\u5236</strong>\uff1a\n   <code>python\n   # \u4e3a\u6bcf\u4e2a\u5171\u4eab\u56e0\u5b50\u5b66\u4e60\u6743\u91cd\n   w[f] = sigmoid(MLP([g_source[f], g_target[f], similarity[f]]))\n   shared_factor[f] = w[f] * source_factor[f] + (1-w[f]) * target_factor[f]</code></p>\n</li>\n<li>\n<p><strong>\u7f13\u89e3\u7b56\u7565</strong>\uff1a\n   - <strong>\u9009\u62e9\u6027\u5171\u4eab</strong>\uff1a\u53ea\u5171\u4eab\u6b63\u8fc1\u79fb\u7684\u56e0\u5b50\n   - <strong>\u68af\u5ea6\u53cd\u8f6c</strong>\uff1a\u5bf9\u8d1f\u8fc1\u79fb\u56e0\u5b50\u4f7f\u7528\u68af\u5ea6\u53cd\u8f6c\u5c42\n   - <strong>\u57df\u81ea\u9002\u5e94\u6b63\u5219\u5316</strong>\uff1aL = L_target + \u03bb\u00b7MMD(source, target)\n   - <strong>\u5143\u5b66\u4e60</strong>\uff1a\u5b66\u4e60\u5982\u4f55\u5feb\u901f\u9002\u5e94\u65b0\u57df</p>\n</li>\n<li>\n<p><strong>\u5728\u7ebf\u76d1\u63a7</strong>\uff1a\n   <code>python\n   # \u6ed1\u52a8\u7a97\u53e3\u76d1\u63a7\n   window_performance = deque(maxlen=100)\n   if trend(window_performance) &lt; 0:\n       trigger_retraining()</code></p>\n</li>\n</ol>\n</details>\n<h3 id=\"166tucker\">\u7ec3\u4e6016.6\uff1a\u5206\u5e03\u5f0fTucker\u5206\u89e3\u901a\u4fe1\u4f18\u5316\uff08\u6311\u6218\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u901a\u4fe1\u9ad8\u6548\u7684\u5206\u5e03\u5f0fTucker-ALS\u7b97\u6cd5\uff0c\u6700\u5c0f\u5316\u8282\u70b9\u95f4\u7684\u6570\u636e\u4f20\u8f93\u3002\u8003\u8651 P \u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u5b58\u50a8\u5f20\u91cf\u7684\u4e00\u4e2a\u5206\u533a\u3002</p>\n<p><strong>Hint</strong>: \u5229\u7528 Tucker \u5206\u89e3\u7684\u7ed3\u6784\uff0c\u8bbe\u8ba1\u90e8\u5206\u66f4\u65b0\u548c\u5ef6\u8fdf\u540c\u6b65\u7b56\u7565\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u901a\u4fe1\u4f18\u5316\u7684\u5206\u5e03\u5f0fTucker-ALS\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5f20\u91cf\u5206\u533a\u7b56\u7565</strong>\uff1a\n   <code># Mode-1 \u5206\u533a\uff08\u7528\u6237\u7ef4\u5ea6\uff09\n   \u6bcf\u4e2a\u8282\u70b9 p \u5b58\u50a8 X[i_p:i_{p+1}, :, :]\n   \u56e0\u5b50\u77e9\u9635\u5206\u533a\uff1aU^(1)[i_p:i_{p+1}, :] \u672c\u5730\u5b58\u50a8</code></p>\n</li>\n<li>\n<p><strong>\u8ba1\u7b97-\u901a\u4fe1\u91cd\u53e0</strong>\uff1a\n   ```python\n   for iteration in range(max_iter):\n       # \u9636\u6bb51\uff1a\u672c\u5730\u8ba1\u7b97\n       for n in [1, 2, 3]:\n           if n == 1:  # \u672c\u5730\u6a21\u6001\n               U_local[n] = local_tucker_update(X_local, U[2], U[3])\n           else:\n               # \u51c6\u5907\u901a\u4fe1\u7684\u6570\u636e\n               prepare_scatter_data(U[n])</p>\n<p># \u9636\u6bb52\uff1a\u5f02\u6b65\u901a\u4fe1\n   futures = []\n   for n in [2, 3]:\n       futures.append(async_allgather(U_local[n]))</p>\n<p># \u9636\u6bb53\uff1a\u672c\u5730\u8ba1\u7b97\u5176\u4ed6\u5de5\u4f5c\n   compute_core_tensor_contribution()</p>\n<p># \u9636\u6bb54\uff1a\u7b49\u5f85\u901a\u4fe1\u5b8c\u6210\n   U[2], U[3] = wait_all(futures)\n   ```</p>\n</li>\n<li>\n<p><strong>\u538b\u7f29\u901a\u4fe1</strong>\uff1a\n   ```python\n   # \u4f4e\u79e9\u538b\u7f29\n   def compress_factor(U, compression_rate=0.1):\n       rank = int(U.shape[1] * compression_rate)\n       U_compressed, S, V = randomized_svd(U, rank)\n       return U_compressed, S, V</p>\n</li>\n</ol>\n<p># \u53ea\u4f20\u8f93\u538b\u7f29\u7684\u56e0\u5b50\n   U_c, S, V = compress_factor(U_local)\n   send(U_c, S, V)  # \u901a\u4fe1\u91cf\u51cf\u5c11 90%\n   ```</p>\n<ol start=\"4\">\n<li>\n<p><strong>\u5ef6\u8fdf\u540c\u6b65</strong>\uff1a\n   <code>python\n   # \u4e0d\u662f\u6bcf\u6b21\u8fed\u4ee3\u90fd\u540c\u6b65\n   if iteration % sync_frequency == 0:\n       synchronize_all_factors()\n   else:\n       # \u4f7f\u7528\u8fc7\u671f\u7684\u56e0\u5b50\u7ee7\u7eed\u8ba1\u7b97\n       use_stale_factors()</code></p>\n</li>\n<li>\n<p><strong>\u901a\u4fe1\u6a21\u5f0f\u4f18\u5316</strong>\uff1a\n   - Ring-allreduce for factor matrices\n   - Butterfly mixing for partial updates\n   - Hierarchical reduction for multi-level clusters</p>\n</li>\n<li>\n<p><strong>\u6027\u80fd\u5206\u6790</strong>\uff1a\n   - \u901a\u4fe1\u590d\u6742\u5ea6\uff1aO(P \u00d7 R \u00d7 (I/P)) per iteration\n   - \u4f18\u5316\u540e\uff1aO(\u221aP \u00d7 R \u00d7 (I/P)) with compression\n   - \u8fdb\u4e00\u6b65\u4f18\u5316\uff1aO(log P \u00d7 R \u00d7 (I/P)) with hierarchical</p>\n</li>\n</ol>\n</details>\n<h3 id=\"167\">\u7ec3\u4e6016.7\uff1a\u5b9e\u65f6\u5f20\u91cf\u8865\u5168\uff08\u5f00\u653e\u6027\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u5728\u7ebf\u7b97\u6cd5\uff0c\u5f53\u65b0\u7684\u89c2\u6d4b $(i,j,k,v)$ \u5230\u8fbe\u65f6\uff0c\u80fd\u591f\u5b9e\u65f6\u66f4\u65b0\u5f20\u91cf\u8865\u5168\u7ed3\u679c\u3002\u8981\u6c42\u66f4\u65b0\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(R^2)$ \u6216\u66f4\u597d\u3002</p>\n<p><strong>Hint</strong>: \u8003\u8651\u4f7f\u7528 Sherman-Morrison-Woodbury \u516c\u5f0f\u548c\u7f13\u5b58\u4e2d\u95f4\u7ed3\u679c\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5b9e\u65f6\u5f20\u91cf\u8865\u5168\u7b97\u6cd5\uff1a</p>\n<ol>\n<li>\n<p><strong>\u9884\u8ba1\u7b97\u7ed3\u6784</strong>\uff1a\n   <code>python\n   # \u7ef4\u62a4\u56e0\u5b50\u77e9\u9635\u548c\u8f85\u52a9\u77e9\u9635\n   A, B, C  # \u56e0\u5b50\u77e9\u9635\n   G = (B.T @ B) * (C.T @ C)  # Gram\u77e9\u9635\u7f13\u5b58\n   invG = inv(G + \u03bbI)  # \u9884\u8ba1\u7b97\u7684\u9006</code></p>\n</li>\n<li>\n<p><strong>\u5355\u70b9\u66f4\u65b0\u7b97\u6cd5</strong>\uff1a\n   ```python\n   def update_single_observation(i, j, k, v_new):\n       # \u63d0\u53d6\u76f8\u5173\u5411\u91cf\n       a_i = A[i, :]\n       b_j = B[j, :]\n       c_k = C[k, :]</p>\n<p># \u8ba1\u7b97\u9884\u6d4b\u8bef\u5dee\n   v_pred = np.sum(a_i * b_j * c_k)\n   error = v_new - v_pred</p>\n<p># Sherman-Morrison \u66f4\u65b0\n   z = b_j * c_k  # R\u7ef4\u5411\u91cf\n   denominator = 1 + z @ invG @ z</p>\n<p># \u66f4\u65b0 A[i,:]\n   A[i, :] += (error / denominator) * invG @ z</p>\n<p># \u66f4\u65b0\u8f85\u52a9\u77e9\u9635\uff08\u53ef\u9009\uff0c\u7528\u4e8eperiodic refresh\uff09\n   if update_count % refresh_period == 0:\n       update_auxiliary_matrices()\n   ```</p>\n</li>\n<li>\n<p><strong>\u6279\u91cf\u66f4\u65b0\u4f18\u5316</strong>\uff1a\n   ```python\n   def batch_update(observations):\n       # \u6309\u7b2c\u4e00\u4e2a\u6a21\u5f0f\u5206\u7ec4\n       grouped = group_by_mode1(observations)</p>\n<p>for i, group in grouped.items():\n       # \u6784\u5efa\u6279\u91cf\u66f4\u65b0\u77e9\u9635\n       Z = stack([B[j] * C[k] for (<em>, j, k, </em>) in group])\n       V = [v for (<em>, </em>, _, v) in group]</p>\n<div class=\"codehilite\"><pre><span></span><code>   # \u6279\u91cf Woodbury \u66f4\u65b0\n   M = I + Z @ invG @ Z.T\n   A[i, :] += invG @ Z.T @ solve(M, V - predictions)\n</code></pre></div>\n\n<p>```</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u79e9\u8c03\u6574</strong>\uff1a\n   <code>python\n   # \u76d1\u63a7\u91cd\u6784\u8bef\u5dee\n   if reconstruction_error &gt; threshold:\n       # \u589e\u52a0\u79e9\n       add_new_factor_column()\n   elif rank_usage &lt; 0.8:\n       # \u51cf\u5c11\u79e9\n       remove_least_important_factor()</code></p>\n</li>\n<li>\n<p><strong>\u7f13\u5b58\u7b56\u7565</strong>\uff1a\n   - LRU \u7f13\u5b58\u6700\u8fd1\u7684\u9884\u6d4b\u503c\n   - \u589e\u91cf\u66f4\u65b0 Gram \u77e9\u9635\n   - \u5468\u671f\u6027\u91cd\u65b0\u8ba1\u7b97\u4ee5\u63a7\u5236\u6570\u503c\u8bef\u5dee</p>\n</li>\n</ol>\n<p>\u65f6\u95f4\u590d\u6742\u5ea6\uff1aO(R\u00b2) \u6bcf\u6b21\u66f4\u65b0\uff08\u7531\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5\u4e3b\u5bfc\uff09\n\u7a7a\u95f4\u590d\u6742\u5ea6\uff1aO(R\u00b2) \u7528\u4e8e\u5b58\u50a8\u9006\u77e9\u9635</p>\n</details>\n<h3 id=\"168\">\u7ec3\u4e6016.8\uff1a\u5f20\u91cf\u795e\u7ecf\u7f51\u7edc\u6df7\u5408\u6a21\u578b\uff08\u5f00\u653e\u6027\uff09</h3>\n<p>\u8bbe\u8ba1\u4e00\u4e2a\u7ed3\u5408\u5f20\u91cf\u5206\u89e3\u548c\u6df1\u5ea6\u5b66\u4e60\u7684\u63a8\u8350\u6a21\u578b\u3002\u6a21\u578b\u5e94\u8be5\u80fd\u591f\u5229\u7528\u5f20\u91cf\u5206\u89e3\u7684\u53ef\u89e3\u91ca\u6027\u548c\u795e\u7ecf\u7f51\u7edc\u7684\u8868\u8fbe\u80fd\u529b\u3002</p>\n<p><strong>Hint</strong>: \u8003\u8651\u5c06\u5f20\u91cf\u5206\u89e3\u7684\u56e0\u5b50\u4f5c\u4e3a\u795e\u7ecf\u7f51\u7edc\u7684\u8f93\u5165\u6216\u6b63\u5219\u5316\u9879\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5f20\u91cf-\u795e\u7ecf\u7f51\u7edc\u6df7\u5408\u67b6\u6784\uff1a</p>\n<ol>\n<li>\n<p><strong>\u57fa\u7840\u67b6\u6784</strong>\uff1a\n   ```python\n   class TensorNeuralHybrid(nn.Module):\n       def <strong>init</strong>(self, dims, rank, hidden_dims):\n           # \u5f20\u91cf\u5206\u89e3\u7ec4\u4ef6\n           self.cp_factors = nn.ParameterList([\n               nn.Parameter(torch.randn(dim, rank)) \n               for dim in dims\n           ])</p>\n<div class=\"codehilite\"><pre><span></span><code>   # \u795e\u7ecf\u7f51\u7edc\u7ec4\u4ef6\n   self.mlp = MLP(rank * len(dims), hidden_dims)\n   self.fusion_gate = nn.Linear(hidden_dims[-1], rank)\n</code></pre></div>\n\n<p>```</p>\n</li>\n<li>\n<p><strong>\u524d\u5411\u4f20\u64ad</strong>\uff1a\n   ```python\n   def forward(self, indices):\n       # \u5f20\u91cf\u5206\u89e3\u9884\u6d4b\n       cp_embeds = []\n       for n, idx in enumerate(indices):\n           cp_embeds.append(self.cp_factors[n][idx])</p>\n<p># CP \u9884\u6d4b\n   cp_pred = torch.prod(torch.stack(cp_embeds), dim=0).sum()</p>\n<p># \u795e\u7ecf\u7f51\u7edc\u589e\u5f3a\n   concat_embeds = torch.cat(cp_embeds, dim=-1)\n   nn_features = self.mlp(concat_embeds)</p>\n<p># \u81ea\u9002\u5e94\u878d\u5408\n   gate = torch.sigmoid(self.fusion_gate(nn_features))\n   final_pred = gate * cp_pred + (1-gate) * nn_features.sum()</p>\n<p>return final_pred, cp_embeds  # \u8fd4\u56de\u5d4c\u5165\u7528\u4e8e\u53ef\u89e3\u91ca\u6027\n   ```</p>\n</li>\n<li>\n<p><strong>\u591a\u4efb\u52a1\u5b66\u4e60</strong>\uff1a\n   ```python\n   def multi_task_loss(pred, target, cp_embeds, aux_targets):\n       # \u4e3b\u4efb\u52a1\uff1a\u9884\u6d4b\u635f\u5931\n       main_loss = F.mse_loss(pred, target)</p>\n<p># \u8f85\u52a9\u4efb\u52a1\uff1a\u56e0\u5b50\u53ef\u89e3\u91ca\u6027\n   interp_loss = factor_interpretability_loss(cp_embeds)</p>\n<p># \u6b63\u4ea4\u6027\u6b63\u5219\u5316\n   ortho_loss = orthogonality_regularization(self.cp_factors)</p>\n<p># \u7a00\u758f\u6027\u6b63\u5219\u5316\n   sparse_loss = sparsity_regularization(self.mlp)</p>\n<p>return main_loss + \u03bb\u2081<em>interp_loss + \u03bb\u2082</em>ortho_loss + \u03bb\u2083*sparse_loss\n   ```</p>\n</li>\n<li>\n<p><strong>\u56e0\u5b50\u53ef\u89e3\u91ca\u6027\u7ea6\u675f</strong>\uff1a\n   <code>python\n   def factor_interpretability_loss(factors):\n       # \u4fc3\u8fdb\u56e0\u5b50\u7684\u805a\u7c7b\u7ed3\u6784\n       cluster_loss = 0\n       for factor in factors:\n           # \u8ba1\u7b97\u56e0\u5b50\u95f4\u7684\u76f8\u4f3c\u5ea6\u77e9\u9635\n           sim_matrix = F.cosine_similarity(factor.unsqueeze(1), \n                                           factor.unsqueeze(0), dim=2)\n           # \u4fc3\u8fdb\u5757\u5bf9\u89d2\u7ed3\u6784\n           cluster_loss += block_diagonal_loss(sim_matrix)\n       return cluster_loss</code></p>\n</li>\n<li>\n<p><strong>\u589e\u91cf\u5b66\u4e60\u80fd\u529b</strong>\uff1a\n   ```python\n   def incremental_update(self, new_data):\n       # \u51bb\u7ed3\u795e\u7ecf\u7f51\u7edc\uff0c\u53ea\u66f4\u65b0\u5f20\u91cf\u56e0\u5b50\n       for param in self.mlp.parameters():\n           param.requires_grad = False</p>\n<p># \u5feb\u901f\u9002\u5e94\u65b0\u6570\u636e\n   optimizer = torch.optim.Adam(self.cp_factors.parameters(), lr=0.01)\n   for epoch in range(5):  # \u5c11\u91cfepoch\n       loss = self.forward_on_new_data(new_data)\n       loss.backward()\n       optimizer.step()</p>\n<p># \u89e3\u51bb\u8fdb\u884c\u8054\u5408\u5fae\u8c03\n   for param in self.mlp.parameters():\n       param.requires_grad = True\n   ```</p>\n</li>\n<li>\n<p><strong>\u53ef\u89e3\u91ca\u6027\u5206\u6790</strong>\uff1a\n   ```python\n   def explain_prediction(self, indices):\n       with torch.no_grad():\n           pred, cp_embeds = self.forward(indices)</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">   </span><span class=\"c1\"># \u56e0\u5b50\u8d21\u732e\u5206\u6790</span>\n<span class=\"w\">   </span><span class=\"n\">contributions</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[]</span>\n<span class=\"w\">   </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">embed</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"n\">enumerate</span><span class=\"p\">(</span><span class=\"n\">cp_embeds</span><span class=\"p\">):</span>\n<span class=\"w\">       </span><span class=\"n\">contrib</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">embed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">embed</span><span class=\"o\">.</span><span class=\"n\">norm</span><span class=\"p\">()</span>\n<span class=\"w\">       </span><span class=\"n\">contributions</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">contrib</span><span class=\"p\">)</span>\n\n<span class=\"w\">   </span><span class=\"c1\"># \u6ce8\u610f\u529b\u53ef\u89c6\u5316</span>\n<span class=\"w\">   </span><span class=\"n\">attention</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_attention_weights</span><span class=\"p\">(</span><span class=\"n\">indices</span><span class=\"p\">)</span>\n\n<span class=\"w\">   </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">       </span><span class=\"s1\">&#39;prediction&#39;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">pred</span><span class=\"p\">,</span>\n<span class=\"w\">       </span><span class=\"s1\">&#39;factor_contributions&#39;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">contributions</span><span class=\"p\">,</span>\n<span class=\"w\">       </span><span class=\"s1\">&#39;attention_weights&#39;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"n\">attention</span><span class=\"p\">,</span>\n<span class=\"w\">       </span><span class=\"s1\">&#39;top_features&#39;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_top_features</span><span class=\"p\">(</span><span class=\"n\">indices</span><span class=\"p\">)</span>\n<span class=\"w\">   </span><span class=\"p\">}</span>\n</code></pre></div>\n\n<p>```</p>\n</li>\n</ol>\n<p>\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u7ed3\u5408\u4e86\u5f20\u91cf\u5206\u89e3\u7684\u53ef\u89e3\u91ca\u6027</li>\n<li>\u5229\u7528\u795e\u7ecf\u7f51\u7edc\u6355\u83b7\u975e\u7ebf\u6027\u6a21\u5f0f</li>\n<li>\u652f\u6301\u589e\u91cf\u5b66\u4e60\u548c\u591a\u4efb\u52a1\u5b66\u4e60</li>\n<li>\u63d0\u4f9b\u9884\u6d4b\u89e3\u91ca\u673a\u5236</li>\n</ul>\n</details>"
  },
  "../chapter2.md": {
    "hash": "5b4a774f0b14a856fa5a959370ba6d02",
    "content": "<h1 id=\"2hessian\">\u7b2c2\u7ae0\uff1aHessian\u8fd1\u4f3c\u7684\u827a\u672f</h1>\n<p>\u5728\u4f18\u5316\u7406\u8bba\u4e2d\uff0cHessian\u77e9\u9635\u63d0\u4f9b\u4e86\u76ee\u6807\u51fd\u6570\u7684\u4e8c\u9636\u4fe1\u606f\uff0c\u662f\u7406\u89e3\u51fd\u6570\u5c40\u90e8\u51e0\u4f55\u7ed3\u6784\u7684\u5173\u952e\u3002\u7136\u800c\uff0c\u5bf9\u4e8e\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u76f4\u63a5\u8ba1\u7b97\u548c\u5b58\u50a8\u5b8c\u6574\u7684Hessian\u77e9\u9635\u5f80\u5f80\u662f\u4e0d\u73b0\u5b9e\u7684\u2014\u2014\u4e00\u4e2a\u5305\u542b\u767e\u4e07\u53c2\u6570\u7684\u6a21\u578b\u9700\u8981\u5b58\u50a810^12\u4e2a\u5143\u7d20\u7684Hessian\u77e9\u9635\u3002\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u5404\u79cdHessian\u8fd1\u4f3c\u6280\u672f\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5728\u4fdd\u6301\u8ba1\u7b97\u6548\u7387\u7684\u540c\u65f6\uff0c\u5de7\u5999\u5730\u5229\u7528\u4e86Hessian\u7684\u7ed3\u6784\u7279\u6027\u3002\u6211\u4eec\u5c06\u5b66\u4e60\u5982\u4f55\u5728\u5185\u5b58\u9650\u5236\u4e0b\u6784\u5efa\u6709\u6548\u7684\u4e8c\u9636\u4f18\u5316\u7b97\u6cd5\uff0c\u5982\u4f55\u9ad8\u6548\u8ba1\u7b97Hessian-\u5411\u91cf\u4e58\u79ef\uff0c\u4ee5\u53ca\u5982\u4f55\u5904\u7406\u975e\u51f8\u4f18\u5316\u4e2d\u7684\u8d1f\u66f2\u7387\u95ee\u9898\u3002</p>\n<h2 id=\"21-bfgsl-bfgs\">2.1 \u4eceBFGS\u5230L-BFGS\uff1a\u6709\u9650\u5185\u5b58\u65b9\u6cd5\u7684\u6df1\u5165\u5256\u6790</h2>\n<h3 id=\"211-bfgs\">2.1.1 BFGS\u66f4\u65b0\u516c\u5f0f\u7684\u63a8\u5bfc\u4e0e\u51e0\u4f55\u76f4\u89c9</h3>\n<p>BFGS (Broyden-Fletcher-Goldfarb-Shanno) \u7b97\u6cd5\u662f\u62df\u725b\u987f\u65b9\u6cd5\u4e2d\u6700\u6210\u529f\u7684\u4ee3\u8868\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u8fed\u4ee3\u66f4\u65b0\u6765\u6784\u5efaHessian\u77e9\u9635\uff08\u6216\u5176\u9006\uff09\u7684\u8fd1\u4f3c\uff0c\u800c\u65e0\u9700\u663e\u5f0f\u8ba1\u7b97\u4e8c\u9636\u5bfc\u6570\u3002</p>\n<p>\u8bbe $\\mathbf{B}_k$ \u4e3a\u7b2c $k$ \u6b65\u7684Hessian\u8fd1\u4f3c\uff0cBFGS\u66f4\u65b0\u6ee1\u8db3\u62df\u725b\u987f\u6761\u4ef6\uff08secant equation\uff09\uff1a\n$$\\mathbf{B}_{k+1} \\mathbf{s}_k = \\mathbf{y}_k$$\n\u5176\u4e2d $\\mathbf{s}_k = \\mathbf{x}_{k+1} - \\mathbf{x}_k$ \u662f\u6b65\u957f\u5411\u91cf\uff0c$\\mathbf{y}_k = \\nabla f(\\mathbf{x}_{k+1}) - \\nabla f(\\mathbf{x}_k)$ \u662f\u68af\u5ea6\u5dee\u3002</p>\n<p>BFGS\u66f4\u65b0\u516c\u5f0f\u4e3a\uff1a\n$$\\mathbf{B}_{k+1} = \\mathbf{B}_k - \\frac{\\mathbf{B}_k \\mathbf{s}_k \\mathbf{s}_k^T \\mathbf{B}_k}{\\mathbf{s}_k^T \\mathbf{B}_k \\mathbf{s}_k} + \\frac{\\mathbf{y}_k \\mathbf{y}_k^T}{\\mathbf{y}_k^T \\mathbf{s}_k}$$\n<strong>\u51e0\u4f55\u76f4\u89c9</strong>\uff1aBFGS\u66f4\u65b0\u53ef\u4ee5\u7406\u89e3\u4e3a\u5bf9\u5f53\u524dHessian\u8fd1\u4f3c\u8fdb\u884c\u79e9-2\u4fee\u6b63\uff0c\u4f7f\u5176\u5728\u65b0\u7684\u65b9\u5411 $\\mathbf{s}_k$ \u4e0a\u6ee1\u8db3\u66f2\u7387\u4fe1\u606f\u3002\u7b2c\u4e00\u9879\u53bb\u9664\u4e86\u65e7\u7684\u4fe1\u606f\uff0c\u7b2c\u4e8c\u9879\u52a0\u5165\u4e86\u65b0\u7684\u66f2\u7387\u4fe1\u606f\u3002</p>\n<p><strong>\u5173\u952e\u6d1e\u5bdf</strong>\uff1aBFGS\u4fdd\u6301\u4e86\u8fd1\u4f3c\u77e9\u9635\u7684\u6b63\u5b9a\u6027\uff0c\u8fd9\u5728 $\\mathbf{y}_k^T \\mathbf{s}_k &gt; 0$ \uff08Wolfe\u6761\u4ef6\uff09\u4e0b\u81ea\u52a8\u6ee1\u8db3\u3002</p>\n<h3 id=\"212-sherman-morrison-woodbury\">2.1.2 Sherman-Morrison-Woodbury\u516c\u5f0f\u7684\u5de7\u5999\u5e94\u7528</h3>\n<p>\u5b9e\u8df5\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u9700\u8981Hessian\u9006\u77e9\u9635\u7684\u8fd1\u4f3c $\\mathbf{H}_k \\approx \\mathbf{B}_k^{-1}$\u3002Sherman-Morrison-Woodbury (SMW) \u516c\u5f0f\u5141\u8bb8\u6211\u4eec\u76f4\u63a5\u66f4\u65b0\u9006\u77e9\u9635\uff1a\n$$(\\mathbf{A} + \\mathbf{U}\\mathbf{V}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\mathbf{U}(\\mathbf{I} + \\mathbf{V}^T\\mathbf{A}^{-1}\\mathbf{U})^{-1}\\mathbf{V}^T\\mathbf{A}^{-1}$$\n\u5e94\u7528SMW\u516c\u5f0f\uff0c\u6211\u4eec\u5f97\u5230BFGS\u7684\u9006\u66f4\u65b0\u516c\u5f0f\uff1a\n$$\\mathbf{H}_{k+1} = \\left(\\mathbf{I} - \\rho_k \\mathbf{s}_k \\mathbf{y}_k^T\\right) \\mathbf{H}_k \\left(\\mathbf{I} - \\rho_k \\mathbf{y}_k \\mathbf{s}_k^T\\right) + \\rho_k \\mathbf{s}_k \\mathbf{s}_k^T$$\n\u5176\u4e2d $\\rho_k = 1/(\\mathbf{y}_k^T \\mathbf{s}_k)$\u3002</p>\n<p><strong>\u8ba1\u7b97\u6280\u5de7</strong>\uff1a\u8fd9\u4e2a\u516c\u5f0f\u907f\u514d\u4e86\u77e9\u9635\u6c42\u9006\uff0c\u53ea\u9700\u8981\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6\u4ece $O(n^3)$ \u964d\u5230 $O(n^2)$\u3002</p>\n<h3 id=\"213-l-bfgs\">2.1.3 L-BFGS\u7684\u53cc\u5faa\u73af\u9012\u5f52\u7b97\u6cd5</h3>\n<p>L-BFGS (Limited-memory BFGS) \u662fBFGS\u7684\u5185\u5b58\u9ad8\u6548\u7248\u672c\uff0c\u5b83\u53ea\u5b58\u50a8\u6700\u8fd1 $m$ \u4e2a\u5411\u91cf\u5bf9 ${(\\mathbf{s}_i, \\mathbf{y}_i)}$\uff0c\u800c\u4e0d\u662f\u5b8c\u6574\u7684 $n \\times n$ \u77e9\u9635\u3002</p>\n<p><strong>\u6838\u5fc3\u7b97\u6cd5</strong>\uff1aL-BFGS\u53cc\u5faa\u73af</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u68af\u5ea6 g, \u5386\u53f2\u5411\u91cf\u5bf9 {(s_i, y_i)}_{i=k-m}^{k-1}, \u521d\u59cbHessian\u9006\u8fd1\u4f3c H_0\n\u8f93\u51fa\uff1a\u641c\u7d22\u65b9\u5411 d = H_k g\n\n// \u7b2c\u4e00\u4e2a\u5faa\u73af\uff1a\u4ece\u6700\u65b0\u5230\u6700\u65e7\nq = g\nfor i = k-1, k-2, ..., k-m:\n    \u03c1_i = 1/(y_i^T s_i)\n    \u03b1_i = \u03c1_i s_i^T q\n    q = q - \u03b1_i y_i\n\n// \u5e94\u7528\u521d\u59cbHessian\u9006\nr = H_0 q\n\n// \u7b2c\u4e8c\u4e2a\u5faa\u73af\uff1a\u4ece\u6700\u65e7\u5230\u6700\u65b0\nfor i = k-m, k-m+1, ..., k-1:\n    \u03b2 = \u03c1_i y_i^T r\n    r = r + s_i (\u03b1_i - \u03b2)\n\nreturn d = r\n</code></pre></div>\n\n<p><strong>\u5185\u5b58\u590d\u6742\u5ea6</strong>\uff1a$O(mn)$\uff0c\u5176\u4e2d $m$ \u901a\u5e38\u9009\u62e93-20\u3002</p>\n<p><strong>\u6570\u5b66\u672c\u8d28</strong>\uff1aL-BFGS\u9690\u5f0f\u5730\u6784\u5efa\u4e86 $\\mathbf{H}_k$ \u7684\u7d27\u51d1\u8868\u793a\uff1a\n$$\\mathbf{H}_k = \\mathbf{H}_0 + \\mathbf{V}_k \\mathbf{R}_k^{-1} \\mathbf{V}_k^T$$\n\u5176\u4e2d $\\mathbf{V}_k$ \u548c $\\mathbf{R}_k$ \u7531\u5386\u53f2\u5411\u91cf\u5bf9\u6784\u6210\u3002</p>\n<p><strong>\u7b97\u6cd5\u7684\u6df1\u5c42\u7406\u89e3</strong>\uff1a\u53cc\u5faa\u73af\u7b97\u6cd5\u5b9e\u9645\u4e0a\u662f\u5728\u6267\u884c\u4e00\u7cfb\u5217\u6295\u5f71\u64cd\u4f5c\u3002\u7b2c\u4e00\u4e2a\u5faa\u73af\u5c06\u68af\u5ea6\u6295\u5f71\u5230\u5386\u53f2\u4fe1\u606f\u7684\u96f6\u7a7a\u95f4\uff0c\u7b2c\u4e8c\u4e2a\u5faa\u73af\u5219\u91cd\u5efa\u51fa\u5b8c\u6574\u7684\u62df\u725b\u987f\u65b9\u5411\u3002\u8fd9\u79cd\u7ed3\u6784\u4f7f\u5f97\u7b97\u6cd5\u5177\u6709\u5929\u7136\u7684\u6570\u503c\u7a33\u5b9a\u6027\u3002</p>\n<p><strong>\u9ad8\u7ea7\u5b9e\u73b0\u6280\u5de7</strong>\uff1a</p>\n<ol>\n<li><strong>\u5faa\u73af\u7f13\u51b2\u533a</strong>\uff1a\u4f7f\u7528\u73af\u5f62\u6570\u7ec4\u5b58\u50a8\u5411\u91cf\u5bf9\uff0c\u907f\u514d\u5185\u5b58\u79fb\u52a8</li>\n<li><strong>\u5ef6\u8fdf\u8ba1\u7b97</strong>\uff1a$\\rho_i$ \u503c\u53ef\u4ee5\u9884\u8ba1\u7b97\u5e76\u7f13\u5b58</li>\n<li><strong>\u5411\u91cf\u91cd\u7528</strong>\uff1a\u5728\u5185\u5b58\u53d7\u9650\u73af\u5883\u4e0b\uff0c\u53ef\u4ee5\u539f\u5730\u4fee\u6539\u5411\u91cf</li>\n</ol>\n<p><strong>\u5e76\u884c\u5316\u6f5c\u529b</strong>\uff1a\u867d\u7136\u53cc\u5faa\u73af\u770b\u4f3c\u4e32\u884c\uff0c\u4f46\u5185\u79ef\u8ba1\u7b97 $s_i^T q$ \u548c\u5411\u91cf\u66f4\u65b0 $q - \\alpha_i y_i$ \u90fd\u53ef\u4ee5\u5e76\u884c\u5316\u3002\u73b0\u4ee3\u5b9e\u73b0\u5229\u7528BLAS Level 1\u64cd\u4f5c\u83b7\u5f97\u663e\u8457\u52a0\u901f\u3002</p>\n<h3 id=\"214\">2.1.4 \u5185\u5b58\u4f7f\u7528\u4e0e\u6536\u655b\u901f\u5ea6\u7684\u6743\u8861</h3>\n<p>\u9009\u62e9\u5386\u53f2\u957f\u5ea6 $m$ \u6d89\u53ca\u5185\u5b58\u4e0e\u6027\u80fd\u7684\u6743\u8861\uff1a</p>\n<ul>\n<li><strong>\u5c0f $m$ (3-5)</strong>\uff1a\u5185\u5b58\u5360\u7528\u5c11\uff0c\u4f46\u53ef\u80fd\u4e22\u5931\u91cd\u8981\u7684\u66f2\u7387\u4fe1\u606f</li>\n<li><strong>\u5927 $m$ (10-20)</strong>\uff1a\u66f4\u597d\u5730\u8fd1\u4f3cHessian\uff0c\u4f46\u5185\u5b58\u9700\u6c42\u589e\u52a0</li>\n</ul>\n<p><strong>\u7406\u8bba\u7ed3\u679c</strong>\uff1a\u5728\u5f3a\u51f8\u51fd\u6570\u4e0a\uff0cL-BFGS\u7684\u6536\u655b\u7387\u4e3a\uff1a\n$$|\\mathbf{x}_k - \\mathbf{x}^*| \\leq C \\cdot r^k$$\n\u5176\u4e2d $r &lt; 1$ \u4f9d\u8d56\u4e8e $m$ \u548c\u95ee\u9898\u7684\u6761\u4ef6\u6570\u3002</p>\n<p><strong>\u5b9e\u8df5\u5efa\u8bae</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u4e8e\u6761\u4ef6\u6570\u826f\u597d\u7684\u95ee\u9898\uff0c$m = 3-5$ \u901a\u5e38\u8db3\u591f</li>\n<li>\u5bf9\u4e8e\u75c5\u6001\u95ee\u9898\uff0c\u589e\u52a0 $m$ \u5230 10-20</li>\n<li>\u76d1\u63a7 $\\mathbf{y}_k^T \\mathbf{s}_k$ \u7684\u503c\uff0c\u8fc7\u5c0f\u65f6\u53ef\u80fd\u9700\u8981\u8df3\u8fc7\u66f4\u65b0</li>\n</ul>\n<h3 id=\"215\">2.1.5 \u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5b9e\u8df5\u8003\u91cf</h3>\n<p>\u6df1\u5ea6\u5b66\u4e60\u5e26\u6765\u4e86\u72ec\u7279\u7684\u6311\u6218\uff1a</p>\n<p><strong>1. \u968f\u673a\u6027\u5904\u7406</strong>\uff1a\n- \u4f7f\u7528\u8f83\u5927\u7684\u6279\u91cf\u8ba1\u7b97\u68af\u5ea6\u5dee $\\mathbf{y}_k$\n- \u5e94\u7528\u65b9\u5dee\u7f29\u51cf\u6280\u672f\uff08\u5982SVRG\uff09\n- \u8003\u8651\u91cd\u53e0\u6279\u6b21\u7b56\u7565</p>\n<p><strong>2. \u975e\u51f8\u6027\u9002\u5e94</strong>\uff1a\n- \u6dfb\u52a0\u7ebf\u641c\u7d22\u786e\u4fdd $\\mathbf{y}_k^T \\mathbf{s}_k &gt; 0$\n- \u4f7f\u7528damped BFGS\u66f4\u65b0\u5904\u7406\u8d1f\u66f2\u7387\n- \u7ed3\u5408trust region\u65b9\u6cd5</p>\n<p><strong>3. \u5206\u5e03\u5f0f\u5b9e\u73b0</strong>\uff1a\n- \u5411\u91cf\u5bf9\u7684\u9ad8\u6548\u5e7f\u64ad\n- \u4f7f\u7528all-reduce\u64cd\u4f5c\u8ba1\u7b97\u5185\u79ef\n- \u8003\u8651\u5f02\u6b65\u66f4\u65b0\u7b56\u7565</p>\n<p><strong>4. \u81ea\u9002\u5e94\u521d\u59cb\u5316</strong>\uff1a\n$$\\mathbf{H}_0^{(k)} = \\frac{\\mathbf{s}_{k-1}^T \\mathbf{y}_{k-1}}{\\mathbf{y}_{k-1}^T \\mathbf{y}_{k-1}} \\mathbf{I}$$\n\u8fd9\u4e2a\u9009\u62e9\u57fa\u4e8e\u6700\u65b0\u7684\u66f2\u7387\u4fe1\u606f\uff0c\u5f80\u5f80\u6bd4\u56fa\u5b9a\u7684 $\\mathbf{H}_0 = \\mathbf{I}$ \u66f4\u6709\u6548\u3002</p>\n<p><strong>\u7814\u7a76\u524d\u6cbf</strong>\uff1a</p>\n<ul>\n<li>\u5c06L-BFGS\u4e0eAdam\u7b49\u4e00\u9636\u65b9\u6cd5\u7ed3\u5408</li>\n<li>\u4f7f\u7528\u795e\u7ecf\u7f51\u7edc\u5b66\u4e60\u66f4\u65b0\u89c4\u5219</li>\n<li>\u63a2\u7d22\u5757\u5bf9\u89d2L-BFGS\u53d8\u4f53</li>\n</ul>\n<p><strong>\u6df1\u5ea6\u5b66\u4e60\u7279\u6709\u7684\u6311\u6218</strong>\uff1a</p>\n<p><strong>\u6279\u91cf\u5f52\u4e00\u5316\u7684\u5f71\u54cd</strong>\uff1aBatchNorm\u5c42\u6539\u53d8\u4e86\u635f\u5931\u666f\u89c2\u7684\u51e0\u4f55\u7ed3\u6784\uff0c\u4f7f\u5f97\u4f20\u7edf\u7684L-BFGS\u5047\u8bbe\u4e0d\u518d\u6210\u7acb\u3002\u7814\u7a76\u8868\u660e\uff0c\u9700\u8981\u7279\u6b8a\u5904\u7406\u8fd9\u4e9b\u5c42\u7684\u53c2\u6570\u66f4\u65b0\u3002</p>\n<p><strong>\u68af\u5ea6\u7206\u70b8/\u6d88\u5931\u7684\u5904\u7406</strong>\uff1a</p>\n<ul>\n<li>\u5b9e\u65bd\u68af\u5ea6\u88c1\u526a\uff1a$\\mathbf{g} \\leftarrow \\mathbf{g} \\cdot \\min(1, \\theta/|\\mathbf{g}|)$</li>\n<li>\u76d1\u63a7 $|\\mathbf{y}_k|/|\\mathbf{s}_k|$ \u6bd4\u7387\uff0c\u5f02\u5e38\u65f6\u91cd\u7f6e\u5386\u53f2</li>\n<li>\u4f7f\u7528\u5c42\u7ea7\u5f52\u4e00\u5316\u7a33\u5b9a\u68af\u5ea6\u6d41</li>\n</ul>\n<p><strong>\u5185\u5b58\u6548\u7387\u4f18\u5316</strong>\uff1a</p>\n<ol>\n<li><strong>\u68af\u5ea6\u7d2f\u79ef</strong>\uff1a\u5c06\u5927\u6279\u91cf\u5206\u5272\u6210\u5c0f\u6279\u91cf\u7d2f\u79ef</li>\n<li><strong>\u68c0\u67e5\u70b9\u6280\u672f</strong>\uff1a\u53ea\u5b58\u50a8\u5173\u952e\u6fc0\u6d3b\u503c\uff0c\u53cd\u5411\u4f20\u64ad\u65f6\u91cd\u8ba1\u7b97</li>\n<li><strong>\u6df7\u5408\u7cbe\u5ea6\u5b58\u50a8</strong>\uff1a\u5386\u53f2\u5411\u91cf\u5bf9\u4f7f\u7528FP16\uff0c\u8ba1\u7b97\u65f6\u8f6c\u6362\u4e3aFP32</li>\n</ol>\n<p><strong>\u4e0e\u73b0\u4ee3\u4f18\u5316\u5668\u7684\u534f\u540c</strong>\uff1a</p>\n<ul>\n<li><strong>L-BFGS + Momentum</strong>\uff1a\u4fdd\u6301\u52a8\u91cf\u7f13\u51b2\u533a\uff0c\u7528L-BFGS\u6821\u6b63\u65b9\u5411</li>\n<li><strong>AdaL-BFGS</strong>\uff1a\u7ed3\u5408\u81ea\u9002\u5e94\u5b66\u4e60\u7387\u548c\u4e8c\u9636\u4fe1\u606f</li>\n<li><strong>\u8c03\u5ea6\u7b56\u7565</strong>\uff1a\u524d\u671f\u7528Adam\u63a2\u7d22\uff0c\u540e\u671f\u7528L-BFGS\u7cbe\u7ec6\u8c03\u4f18</li>\n</ul>\n<p><strong>\u5b9e\u8bc1\u89c2\u5bdf</strong>\uff1a</p>\n<ul>\n<li>\u5728\u8fc7\u53c2\u6570\u5316\u7f51\u7edc\u4e2d\uff0c\u5c0f\u7684 $m$ (3-5) \u901a\u5e38\u8db3\u591f</li>\n<li>\u6279\u91cf\u5927\u5c0f\u9700\u8981\u81f3\u5c11 $O(m \\cdot d)$\uff0c\u5176\u4e2d $d$ \u662f\u53c2\u6570\u7ef4\u5ea6</li>\n<li>\u6b8b\u5dee\u8fde\u63a5\u6709\u52a9\u4e8eL-BFGS\u7684\u6570\u503c\u7a33\u5b9a\u6027</li>\n</ul>\n<h3 id=\"216-l-bfgs\">2.1.6 \u5206\u5757\u4e0e\u7ed3\u6784\u5316L-BFGS\u53d8\u4f53</h3>\n<p>\u5927\u89c4\u6a21\u95ee\u9898\u5f80\u5f80\u5177\u6709\u7279\u6b8a\u7ed3\u6784\uff0c\u5229\u7528\u8fd9\u4e9b\u7ed3\u6784\u53ef\u4ee5\u663e\u8457\u63d0\u5347L-BFGS\u7684\u6548\u7387\uff1a</p>\n<p><strong>1. \u5206\u5757L-BFGS (Block L-BFGS)</strong>\uff1a\n\u5f53\u53c2\u6570\u5177\u6709\u81ea\u7136\u5206\u7ec4\u65f6\uff08\u5982\u795e\u7ecf\u7f51\u7edc\u7684\u4e0d\u540c\u5c42\uff09\uff0c\u53ef\u4ee5\u5bf9\u6bcf\u7ec4\u7ef4\u62a4\u72ec\u7acb\u7684L-BFGS\u8fd1\u4f3c\uff1a\n$$\\mathbf{H} = \\begin{bmatrix}\n\\mathbf{H}_1 &amp; &amp; \\\n&amp; \\mathbf{H}_2 &amp; \\\n&amp; &amp; \\ddots\n\\end{bmatrix}$$\n\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u6355\u83b7\u4e0d\u540c\u53c2\u6570\u7ec4\u7684\u5c3a\u5ea6\u5dee\u5f02</li>\n<li>\u964d\u4f4e\u5185\u5b58\u9700\u6c42\uff08\u6bcf\u5757\u72ec\u7acb\u7684\u5c0f\u5386\u53f2\uff09</li>\n<li>\u81ea\u7136\u7684\u5e76\u884c\u5316</li>\n</ul>\n<p>\u5b9e\u73b0\u8003\u8651\uff1a</p>\n<ul>\n<li>\u5757\u5212\u5206\u7b56\u7565\uff08\u6309\u5c42\u3001\u6309\u53c2\u6570\u7c7b\u578b\u3001\u6309\u68af\u5ea6\u7edf\u8ba1\uff09</li>\n<li>\u5757\u95f4\u8026\u5408\u4fe1\u606f\u7684\u5904\u7406</li>\n<li>\u81ea\u9002\u5e94\u5757\u5927\u5c0f\u8c03\u6574</li>\n</ul>\n<p><strong>2. \u7ed3\u6784\u5316BFGS (Structured BFGS)</strong>\uff1a\n\u5229\u7528\u95ee\u9898\u7684\u7279\u5b9a\u7ed3\u6784\u8bbe\u8ba1\u66f4\u65b0\uff1a</p>\n<p><strong>Kronecker\u7ed3\u6784</strong>\uff1a\n\u5bf9\u4e8e\u5f62\u5982 $\\mathbf{H} = \\mathbf{A} \\otimes \\mathbf{B}$ \u7684\u95ee\u9898\uff1a</p>\n<ul>\n<li>\u5206\u522b\u66f4\u65b0 $\\mathbf{A}$ \u548c $\\mathbf{B}$ \u7684L-BFGS\u8fd1\u4f3c</li>\n<li>\u5185\u5b58\u4ece $O(n^2)$ \u964d\u5230 $O(n)$</li>\n<li>\u5e38\u89c1\u4e8e\u591a\u7ef4\u4f18\u5316\u548c\u5f20\u91cf\u5206\u89e3</li>\n</ul>\n<p><strong>\u4f4e\u79e9\u52a0\u5bf9\u89d2\u7ed3\u6784</strong>\uff1a\n$$\\mathbf{H}^{-1} \\approx \\mathbf{D}^{-1} + \\mathbf{U}\\mathbf{V}^T$$</p>\n<ul>\n<li>$\\mathbf{D}$\uff1a\u5bf9\u89d2\u90e8\u5206\uff0c\u6355\u83b7\u5c40\u90e8\u66f2\u7387</li>\n<li>$\\mathbf{U}\\mathbf{V}^T$\uff1a\u4f4e\u79e9\u90e8\u5206\uff0c\u6355\u83b7\u5168\u5c40\u76f8\u5173\u6027</li>\n<li>\u9002\u7528\u4e8e\u5177\u6709\u7a00\u758fHessian\u7684\u95ee\u9898</li>\n</ul>\n<p><strong>3. \u538b\u7f29L-BFGS (Compact L-BFGS)</strong>\uff1a\n\u5c06L-BFGS\u8868\u793a\u4e3a\u7d27\u51d1\u5f62\u5f0f\uff1a\n$$\\mathbf{H}_k = \\mathbf{H}_0 + [\\mathbf{S}_k \\quad \\mathbf{H}_0\\mathbf{Y}_k] \\begin{bmatrix} \\mathbf{D}_k &amp; \\mathbf{L}_k^T \\ \\mathbf{L}_k &amp; -\\mathbf{H}_0 \\end{bmatrix}^{-1} \\begin{bmatrix} \\mathbf{S}_k^T \\ \\mathbf{Y}_k^T\\mathbf{H}_0 \\end{bmatrix}$$\n\u5176\u4e2d\uff1a</p>\n<ul>\n<li>$\\mathbf{S}_k = [\\mathbf{s}_{k-m}, ..., \\mathbf{s}_{k-1}]$</li>\n<li>$\\mathbf{Y}_k = [\\mathbf{y}_{k-m}, ..., \\mathbf{y}_{k-1}]$</li>\n<li>$\\mathbf{D}_k = \\text{diag}(\\mathbf{s}_i^T\\mathbf{y}_i)$</li>\n<li>$\\mathbf{L}_k$ \u662f\u4e25\u683c\u4e0b\u4e09\u89d2\u77e9\u9635\uff0c$(L_k)_{ij} = \\mathbf{s}_{k-m+i-1}^T\\mathbf{y}_{k-m+j-1}$ for $i &gt; j$</li>\n</ul>\n<p>\u8fd9\u79cd\u8868\u793a\u4fbf\u4e8e\uff1a</p>\n<ul>\n<li>\u6279\u91cf\u64cd\u4f5c\u591a\u4e2a\u5411\u91cf</li>\n<li>\u66f4\u9ad8\u6548\u7684\u5e76\u884c\u5b9e\u73b0</li>\n<li>\u4e0e\u5176\u4ed6\u77e9\u9635\u8fd0\u7b97\u7684\u7ed3\u5408</li>\n</ul>\n<h3 id=\"217\">2.1.7 \u6536\u655b\u6027\u5206\u6790\u4e0e\u7406\u8bba\u754c\u9650</h3>\n<p>\u7406\u89e3L-BFGS\u7684\u7406\u8bba\u6027\u8d28\u5bf9\u4e8e\u7b97\u6cd5\u8c03\u4f18\u548c\u95ee\u9898\u8bca\u65ad\u81f3\u5173\u91cd\u8981\uff1a</p>\n<p><strong>1. \u6536\u655b\u901f\u7387\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u5f3a\u51f8\u60c5\u51b5</strong>\uff1a\n\u5bf9\u4e8e $\\mu$-\u5f3a\u51f8\u3001$L$-\u5149\u6ed1\u7684\u51fd\u6570\uff0cL-BFGS\u7684\u6536\u655b\u7387\u4e3a\uff1a\n$$f(\\mathbf{x}_k) - f^* \\leq \\left(1 - \\frac{2\\mu\\gamma}{L + \\mu\\gamma}\\right)^k (f(\\mathbf{x}_0) - f^*)$$\n\u5176\u4e2d $\\gamma$ \u4f9d\u8d56\u4e8eL-BFGS\u8fd1\u4f3c\u8d28\u91cf\u3002</p>\n<p><strong>\u4e00\u822c\u51f8\u60c5\u51b5</strong>\uff1a\n$$f(\\mathbf{x}_k) - f^* \\leq \\frac{C}{k}$$\n\u5176\u4e2d\u5e38\u6570 $C$ \u4f9d\u8d56\u4e8e\u521d\u59cb\u70b9\u548cHessian\u8fd1\u4f3c\u8d28\u91cf\u3002</p>\n<p><strong>\u975e\u51f8\u60c5\u51b5</strong>\uff1a\n\u5728\u9002\u5f53\u7684\u6b63\u5219\u6027\u6761\u4ef6\u4e0b\uff1a\n$$\\min_{i \\leq k} |\\nabla f(\\mathbf{x}_i)|^2 \\leq \\frac{2(f(\\mathbf{x}_0) - f^*)}{k\\eta}$$</p>\n<p><strong>2. \u8fd1\u4f3c\u8d28\u91cf\u7684\u91cf\u5316</strong>\uff1a</p>\n<p><strong>Dennis-Mor\u00e9\u6761\u4ef6</strong>\uff1a\n\u8d85\u7ebf\u6027\u6536\u655b\u7684\u5145\u8981\u6761\u4ef6\uff1a\n$$\\lim_{k \\to \\infty} \\frac{|(\\mathbf{H}_k - \\mathbf{H}(\\mathbf{x}^*))\\mathbf{s}_k|}{|\\mathbf{s}_k|} = 0$$\n<strong>\u8c31\u6761\u4ef6\u6570\u754c</strong>\uff1a\n\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u5e0c\u671b\uff1a\n$$\\kappa(\\mathbf{H}_k^{-1}\\mathbf{H}) \\approx 1$$\n\u5b9e\u8df5\u4e2d\uff0c\u76d1\u63a7\uff1a\n$$\\rho_k = \\frac{|\\mathbf{H}_k\\mathbf{g}_k|}{|\\mathbf{g}_k|} \\cdot \\frac{|\\nabla^2 f(\\mathbf{x}_k)^{-1}\\mathbf{g}_k|}{|\\nabla^2 f(\\mathbf{x}_k)^{-1}\\mathbf{g}_k|}$$</p>\n<p><strong>3. \u5185\u5b58\u9650\u5236\u7684\u5f71\u54cd</strong>\uff1a</p>\n<p><strong>\u7406\u8bba\u7ed3\u679c</strong>\uff1a</p>\n<ul>\n<li>\u5f53 $m \\geq n$ \u65f6\uff0cL-BFGS\u9000\u5316\u4e3a\u5b8c\u6574BFGS</li>\n<li>\u5f53 $m &lt; n$ \u65f6\uff0c\u53ef\u80fd\u4e22\u5931\u91cd\u8981\u7684\u66f2\u7387\u4fe1\u606f</li>\n<li>\u5b58\u5728\u95ee\u9898\u4f7f\u5f97 $m &lt; n$ \u7684L-BFGS\u65e0\u6cd5\u8fbe\u5230\u8d85\u7ebf\u6027\u6536\u655b</li>\n</ul>\n<p><strong>\u5b9e\u7528\u6307\u5bfc</strong>\uff1a</p>\n<ul>\n<li>\u5bf9\u4e8e\u4e8c\u6b21\u51fd\u6570\uff0c$m = n$ \u4fdd\u8bc1\u6709\u9650\u6b65\u6536\u655b</li>\n<li>\u5bf9\u4e8e\u4e00\u822c\u51fd\u6570\uff0c$m = O(\\log n)$ \u901a\u5e38\u8db3\u591f</li>\n<li>\u76d1\u63a7\u6709\u6548\u79e9\uff1a$\\text{rank}(\\mathbf{S}_k^T\\mathbf{Y}_k)$</li>\n</ul>\n<h3 id=\"218\">2.1.8 \u9ad8\u7ea7\u5b9e\u73b0\u6280\u5de7\u4e0e\u4f18\u5316</h3>\n<p><strong>1. \u5411\u91cf\u5316\u4e0eSIMD\u4f18\u5316</strong>\uff1a\n\u5229\u7528\u73b0\u4ee3CPU\u7684\u5411\u91cf\u6307\u4ee4\u96c6\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">// \u5411\u91cf\u5316\u7684\u5185\u79ef\u8ba1\u7b97</span>\n<span class=\"n\">float</span><span class=\"w\"> </span><span class=\"n\">dot_product_simd</span><span class=\"p\">(</span><span class=\"n\">float</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">float</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">int</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"c1\">// \u4f7f\u7528AVX/SSE\u6307\u4ee4\u96c6</span>\n<span class=\"w\">    </span><span class=\"c1\">// \u4e00\u6b21\u5904\u7406\u591a\u4e2a\u5143\u7d20</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<p>\u5173\u952e\u4f18\u5316\u70b9\uff1a</p>\n<ul>\n<li>\u5185\u79ef\u8ba1\u7b97\uff08L-BFGS\u7684\u4e3b\u8981\u64cd\u4f5c\uff09</li>\n<li>\u5411\u91cf\u52a0\u6cd5\u548c\u6807\u91cf\u4e58\u6cd5</li>\n<li>\u6570\u636e\u5bf9\u9f50\u548c\u9884\u53d6</li>\n</ul>\n<p><strong>2. \u7f13\u5b58\u4f18\u5316\u7b56\u7565</strong>\uff1a</p>\n<p><strong>\u5faa\u73af\u5c55\u5f00</strong>\uff1a\n\u51cf\u5c11\u5faa\u73af\u5f00\u9500\uff0c\u63d0\u9ad8\u6307\u4ee4\u7ea7\u5e76\u884c\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u5c55\u5f00\u56e0\u5b504\u7684\u793a\u4f8b</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">{</span>\n<span class=\"w\">    </span><span class=\"nf\">sum</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"nf\">sum</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">[</span><span class=\"n\">i+1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">[</span><span class=\"n\">i+1</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"nf\">sum</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">[</span><span class=\"n\">i+2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">[</span><span class=\"n\">i+2</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"nf\">sum</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">[</span><span class=\"n\">i+3</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">[</span><span class=\"n\">i+3</span><span class=\"o\">]</span><span class=\"p\">;</span>\n<span class=\"err\">}</span>\n</code></pre></div>\n\n<p><strong>\u6570\u636e\u5e03\u5c40\u4f18\u5316</strong>\uff1a</p>\n<ul>\n<li>\u5c06\u9891\u7e41\u8bbf\u95ee\u7684\u5411\u91cf\u5bf9\u8fde\u7eed\u5b58\u50a8</li>\n<li>\u8003\u8651cache line\u5927\u5c0f\uff08\u901a\u5e3864\u5b57\u8282\uff09</li>\n<li>\u907f\u514dfalse sharing\u5728\u591a\u7ebf\u7a0b\u73af\u5883</li>\n</ul>\n<p><strong>3. \u6570\u503c\u7a33\u5b9a\u6027\u589e\u5f3a</strong>\uff1a</p>\n<p><strong>Kahan\u6c42\u548c\u5728L-BFGS\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"o\">//</span><span class=\"w\"> </span><span class=\"n\">\u9ad8\u7cbe\u5ea6\u7d2f\u52a0alpha\u503c</span>\n<span class=\"n\">kahan_sum</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mf\">0.0</span>\n<span class=\"n\">compensation</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mf\">0.0</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"k\">range</span><span class=\"p\">(</span><span class=\"n\">m</span><span class=\"p\">)</span><span class=\"err\">:</span>\n<span class=\"w\">    </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">alpha</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">compensation</span>\n<span class=\"w\">    </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">kahan_sum</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">    </span><span class=\"n\">compensation</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">kahan_sum</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">y</span>\n<span class=\"w\">    </span><span class=\"n\">kahan_sum</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">t</span>\n</code></pre></div>\n\n<p><strong>\u7f29\u653e\u6280\u672f</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u7f29\u653e\u9632\u6b62\u4e0a\u6ea2/\u4e0b\u6ea2</li>\n<li>\u4f7f\u7528\u5bf9\u6570\u7a7a\u95f4\u8ba1\u7b97\u6781\u5c0f\u503c</li>\n<li>\u76d1\u63a7\u6570\u503c\u8303\u56f4\u5e76\u81ea\u9002\u5e94\u8c03\u6574</li>\n</ul>\n<p><strong>4. \u81ea\u9002\u5e94\u5386\u53f2\u7ba1\u7406</strong>\uff1a</p>\n<p><strong>\u52a8\u6001\u5386\u53f2\u957f\u5ea6</strong>\uff1a\n\u6839\u636e\u95ee\u9898\u7279\u6027\u52a8\u6001\u8c03\u6574 $m$\uff1a</p>\n<ul>\n<li>\u521d\u59cb\u9636\u6bb5\u4f7f\u7528\u8f83\u5c0f\u7684 $m$</li>\n<li>\u63a5\u8fd1\u6536\u655b\u65f6\u589e\u52a0 $m$ \u63d0\u9ad8\u7cbe\u5ea6</li>\n<li>\u57fa\u4e8e\u53ef\u7528\u5185\u5b58\u81ea\u9002\u5e94\u8c03\u6574</li>\n</ul>\n<p><strong>\u9009\u62e9\u6027\u66f4\u65b0</strong>\uff1a\n\u4e0d\u662f\u6240\u6709\u7684 $(\\mathbf{s}_k, \\mathbf{y}_k)$ \u5bf9\u90fd\u6709\u540c\u7b49\u4ef7\u503c\uff1a</p>\n<ul>\n<li>\u8df3\u8fc7\u6570\u503c\u4e0d\u7a33\u5b9a\u7684\u66f4\u65b0</li>\n<li>\u4f18\u5148\u4fdd\u7559\u4fe1\u606f\u91cf\u5927\u7684\u5411\u91cf\u5bf9</li>\n<li>\u4f7f\u7528\u4fe1\u606f\u8bba\u51c6\u5219\u8bc4\u4f30\u66f4\u65b0\u8d28\u91cf</li>\n</ul>\n<h3 id=\"219\">2.1.9 \u4e0e\u73b0\u4ee3\u4f18\u5316\u5668\u7684\u878d\u5408</h3>\n<p><strong>1. L-BFGS\u4e0e\u52a8\u91cf\u65b9\u6cd5\u7684\u7ed3\u5408</strong>\uff1a</p>\n<p><strong>L-BFGS-B with Momentum</strong>\uff1a\n\u7ed3\u5408L-BFGS\u7684\u4e8c\u9636\u4fe1\u606f\u548c\u52a8\u91cf\u7684\u52a0\u901f\u6548\u679c\uff1a\n$$\\mathbf{v}_{k+1} = \\beta \\mathbf{v}_k + (1-\\beta) \\mathbf{H}_k \\mathbf{g}_k$$\n$$\\mathbf{x}_{k+1} = \\mathbf{x}_k - \\alpha \\mathbf{v}_{k+1}$$\n\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u66f4\u5e73\u6ed1\u7684\u6536\u655b\u8f68\u8ff9</li>\n<li>\u5bf9\u566a\u58f0\u66f4\u9c81\u68d2</li>\n<li>\u4fdd\u6301\u4e8c\u9636\u6536\u655b\u6027\u8d28</li>\n</ul>\n<p><strong>2. \u81ea\u9002\u5e94\u5b66\u4e60\u7387\u96c6\u6210</strong>\uff1a</p>\n<p><strong>L-BFGS-Adam\u6df7\u5408</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528Adam\u7684\u81ea\u9002\u5e94\u5b66\u4e60\u7387</li>\n<li>\u7528L-BFGS\u63d0\u4f9b\u641c\u7d22\u65b9\u5411</li>\n<li>\u5728\u4e0d\u540c\u9636\u6bb5\u5207\u6362\u7b56\u7565</li>\n</ul>\n<p>\u5b9e\u73b0\u6846\u67b6\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>if phase == &quot;exploration&quot;:\n    use Adam with large learning rate\nelif phase == &quot;refinement&quot;:\n    use L-BFGS for fast local convergence\nelse:  # phase == &quot;hybrid&quot;\n    direction = L-BFGS.compute_direction()\n    step_size = Adam.compute_step_size()\n    update = step_size * direction\n</code></pre></div>\n\n<p><strong>3. \u6b63\u5219\u5316\u4e0eL-BFGS</strong>\uff1a</p>\n<p><strong>\u9690\u5f0f\u6b63\u5219\u5316\u6548\u5e94</strong>\uff1a\nL-BFGS\u7684\u6709\u9650\u5185\u5b58\u7279\u6027\u4ea7\u751f\u9690\u5f0f\u6b63\u5219\u5316\uff1a</p>\n<ul>\n<li>\u9650\u5236\u4e86\u53ef\u8868\u793a\u7684\u66f2\u7387\u4fe1\u606f</li>\n<li>\u503e\u5411\u4e8e\u4f4e\u79e9\u89e3</li>\n<li>\u53ef\u80fd\u6709\u52a9\u4e8e\u6cdb\u5316</li>\n</ul>\n<p><strong>\u663e\u5f0f\u6b63\u5219\u5316\u7684\u5904\u7406</strong>\uff1a\n\u5bf9\u4e8e $f(\\mathbf{x}) + \\lambda R(\\mathbf{x})$ \u5f62\u5f0f\u7684\u95ee\u9898\uff1a</p>\n<ul>\n<li>\u5f39\u6027\u7f51\uff1a\u5c06 $\\lambda \\mathbf{I}$ \u52a0\u5165Hessian\u8fd1\u4f3c</li>\n<li>L1\u6b63\u5219\u5316\uff1a\u4f7f\u7528orthant-wise L-BFGS</li>\n<li>\u7ed3\u6784\u5316\u6b63\u5219\u5316\uff1a\u76f8\u5e94\u8c03\u6574\u66f4\u65b0\u89c4\u5219</li>\n</ul>\n<h3 id=\"2110-l-bfgs\">2.1.10 L-BFGS\u7684\u7406\u8bba\u6df1\u5316\u4e0e\u524d\u6cbf\u7814\u7a76</h3>\n<p><strong>\u9ad8\u7ef4\u5206\u6790\u89c6\u89d2</strong>\uff1a</p>\n<p><strong>\u968f\u673a\u77e9\u9635\u7406\u8bba\u7684\u5e94\u7528</strong>\uff1a\n\u5f53 $n \\to \\infty$ \u65f6\uff0cL-BFGS\u7684\u66f4\u65b0\u77e9\u9635\u5177\u6709\u7279\u6b8a\u7684\u8c31\u6027\u8d28\uff1a</p>\n<ul>\n<li>\u7279\u5f81\u503c\u5206\u5e03\u8d8b\u5411\u4e8eMarchenko-Pastur\u5206\u5e03\u7684\u53d8\u5f62</li>\n<li>\u6709\u6548\u79e9\u7ea6\u4e3a $\\min(m, \\text{rank}(\\nabla^2 f))$</li>\n<li>\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u5c0f\u7684 $m$ \u5728\u9ad8\u7ef4\u95ee\u9898\u4e2d\u4ecd\u7136\u6709\u6548</li>\n</ul>\n<p><strong>\u4fe1\u606f\u51e0\u4f55\u89e3\u91ca</strong>\uff1a\nL-BFGS\u53ef\u4ee5\u89c6\u4e3a\u5728\u53c2\u6570\u7a7a\u95f4\u7684Riemannian\u6d41\u5f62\u4e0a\u7684\u6d4b\u5730\u7ebf\u903c\u8fd1\uff1a</p>\n<ul>\n<li>\u5386\u53f2\u5411\u91cf\u5bf9\u5b9a\u4e49\u4e86\u5207\u7a7a\u95f4\u7684\u57fa</li>\n<li>\u53cc\u5faa\u73af\u7b97\u6cd5\u6267\u884c\u5e73\u884c\u4f20\u8f93</li>\n<li>\u6709\u9650\u5185\u5b58\u9650\u5236\u4e86\u6d41\u5f62\u7684\u5c40\u90e8\u8fd1\u4f3c\u8d28\u91cf</li>\n</ul>\n<p><strong>\u4e0e\u6df1\u5ea6\u5b66\u4e60\u7406\u8bba\u7684\u8054\u7cfb</strong>\uff1a</p>\n<p><strong>\u795e\u7ecf\u5207\u7ebf\u6838(NTK)\u89c6\u89d2</strong>\uff1a\n\u5728\u65e0\u9650\u5bbd\u5ea6\u6781\u9650\u4e0b\uff0cL-BFGS\u8fd1\u4f3c\u7684\u662fNTK\u7684\u9006\uff1a\n$$\\mathbf{H}_\\infty \\approx \\mathbf{K}_{NTK}^{-1}$$\n\u8fd9\u63d0\u4f9b\u4e86\u7406\u89e3L-BFGS\u5728\u8fc7\u53c2\u6570\u5316\u7f51\u7edc\u4e2d\u884c\u4e3a\u7684\u65b0\u89c6\u89d2\u3002</p>\n<p><strong>\u635f\u5931\u666f\u89c2\u7684\u542b\u4e49</strong>\uff1a</p>\n<ul>\n<li>L-BFGS\u7684\u6709\u6548\u6027\u4f9d\u8d56\u4e8e\u5c40\u90e8\u51f8\u6027\u5047\u8bbe</li>\n<li>\u5728mode connectivity\u533a\u57df\uff0c\u8fd9\u4e2a\u5047\u8bbe\u8fd1\u4f3c\u6210\u7acb</li>\n<li>\u6279\u91cf\u5f52\u4e00\u5316\u521b\u9020\u4e86\u66f4\u9002\u5408L-BFGS\u7684\u666f\u89c2</li>\n</ul>\n<p><strong>\u6700\u65b0\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u5386\u53f2\u9009\u62e9</strong>\uff1a\n   - \u57fa\u4e8e\u68af\u5ea6\u76f8\u4f3c\u5ea6\u7684\u5411\u91cf\u5bf9\u7b5b\u9009\n   - \u4f7f\u7528\u91cd\u8981\u6027\u91c7\u6837\u4fdd\u7559\u5173\u952e\u4fe1\u606f\n   - \u52a8\u6001\u8c03\u6574\u5386\u53f2\u7a97\u53e3\u5927\u5c0f</p>\n</li>\n<li>\n<p><strong>\u7ed3\u6784\u611f\u77e5L-BFGS</strong>\uff1a\n   - \u5229\u7528\u7f51\u7edc\u67b6\u6784\u4fe1\u606f\u8bbe\u8ba1\u66f4\u65b0\u7b56\u7565\n   - \u5c42\u7ea7L-BFGS\uff1a\u4e0d\u540c\u5c42\u4f7f\u7528\u4e0d\u540c\u7684\u5386\u53f2\u957f\u5ea6\n   - \u6ce8\u610f\u529b\u673a\u5236\u52a0\u6743\u5386\u53f2\u4fe1\u606f</p>\n</li>\n<li>\n<p><strong>\u91cf\u5b50\u542f\u53d1\u7684\u6539\u8fdb</strong>\uff1a\n   - \u91cf\u5b50\u8fd1\u4f3c\u4f18\u5316\u7b97\u6cd5(QAOA)\u4e0eL-BFGS\u7684\u7ed3\u5408\n   - \u5229\u7528\u91cf\u5b50\u7ea0\u7f20\u6982\u5ff5\u8bbe\u8ba1\u5411\u91cf\u5bf9\u8026\u5408\n   - \u63a2\u7d22\u91cf\u5b50\u52a0\u901f\u7684\u53ef\u80fd\u6027</p>\n</li>\n<li>\n<p><strong>\u8054\u90a6\u5b66\u4e60\u4e2d\u7684L-BFGS</strong>\uff1a\n   - \u5206\u5e03\u5f0f\u5386\u53f2\u4fe1\u606f\u805a\u5408\n   - \u9690\u79c1\u4fdd\u62a4\u7684\u5411\u91cf\u5bf9\u5171\u4eab\n   - \u5f02\u6784\u5ba2\u6237\u7aef\u7684\u81ea\u9002\u5e94\u7b56\u7565</p>\n</li>\n</ol>\n<p><strong>\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ul>\n<li>L-BFGS\u5728\u975e\u5149\u6ed1\u4f18\u5316\u4e2d\u7684\u7406\u8bba\u4fdd\u8bc1</li>\n<li>\u6700\u4f18\u5386\u53f2\u957f\u5ea6 $m$ \u7684\u81ea\u9002\u5e94\u9009\u62e9\u7406\u8bba</li>\n<li>\u4e0eimplicit regularization\u7684\u6df1\u5c42\u8054\u7cfb</li>\n<li>\u5728\u7ebf\u5b66\u4e60\u573a\u666f\u4e0b\u7684\u9057\u61be\u754c\u5206\u6790</li>\n</ul>\n<h2 id=\"22-hessian-vector-product\">2.2 Hessian-vector product\u7684\u9ad8\u6548\u8ba1\u7b97</h2>\n<p>\u5728\u8bb8\u591a\u4e8c\u9636\u4f18\u5316\u7b97\u6cd5\u4e2d\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u5b8c\u6574\u7684Hessian\u77e9\u9635\uff0c\u800c\u53ea\u9700\u8981\u8ba1\u7b97Hessian\u4e0e\u5411\u91cf\u7684\u4e58\u79ef $\\mathbf{H}\\mathbf{v}$\u3002\u8fd9\u4e2a\u89c2\u5bdf\u5bfc\u81f4\u4e86\u4e00\u7c7b\"matrix-free\"\u7684\u65b9\u6cd5\uff0c\u5b83\u4eec\u80fd\u591f\u5728 $O(n)$ \u7684\u5185\u5b58\u548c $O(n)$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u8ba1\u7b97\u3002</p>\n<h3 id=\"221\">2.2.1 \u81ea\u52a8\u5fae\u5206\u7684\u4e8c\u9636\u6269\u5c55</h3>\n<p>\u81ea\u52a8\u5fae\u5206(AD)\u4e0d\u4ec5\u53ef\u4ee5\u9ad8\u6548\u8ba1\u7b97\u68af\u5ea6\uff0c\u8fd8\u53ef\u4ee5\u6269\u5c55\u5230\u4e8c\u9636\u5bfc\u6570\u3002\u5173\u952e\u6d1e\u5bdf\u662f\uff1a\n$$\\mathbf{H}\\mathbf{v} = \\nabla(\\nabla f^T \\mathbf{v}) = \\nabla(g^T \\mathbf{v})$$\n\u5176\u4e2d $g = \\nabla f$ \u662f\u68af\u5ea6\u3002\u8fd9\u5c06Hessian-\u5411\u91cf\u4e58\u79ef\u8f6c\u5316\u4e3a\u6807\u91cf\u51fd\u6570 $g^T \\mathbf{v}$ \u7684\u68af\u5ea6\u8ba1\u7b97\u3002</p>\n<p><strong>\u524d\u5411\u6a21\u5f0fAD</strong>\uff1a\u8ba1\u7b97\u65b9\u5411\u5bfc\u6570\n$$\\frac{d}{dt} f(\\mathbf{x} + t\\mathbf{v})\\big|_{t=0} = \\nabla f(\\mathbf{x})^T \\mathbf{v}$$\n<strong>\u53cd\u5411\u6a21\u5f0fAD</strong>\uff1a\u8ba1\u7b97\u68af\u5ea6\u7684\u68af\u5ea6\n$$\\mathbf{H}\\mathbf{v} = \\frac{d}{dt} \\nabla f(\\mathbf{x} + t\\mathbf{v})\\big|_{t=0}$$\n<strong>\u8ba1\u7b97\u590d\u6742\u5ea6</strong>\uff1a\u4e24\u6b21\u53cd\u5411\u4f20\u64ad\u7684\u6210\u672c\uff0c\u7ea6\u4e3a\u68af\u5ea6\u8ba1\u7b97\u76842-3\u500d\u3002</p>\n<h3 id=\"222-pearlmutter\">2.2.2 Pearlmutter\u6280\u5de7\u7684\u6570\u5b66\u539f\u7406</h3>\n<p>Pearlmutter\u63d0\u51fa\u4e86\u4e00\u79cd\u4f18\u96c5\u7684\u65b9\u6cd5\uff0c\u901a\u8fc7\u4fee\u6539\u53cd\u5411\u4f20\u64ad\u6765\u76f4\u63a5\u8ba1\u7b97 $\\mathbf{H}\\mathbf{v}$\uff1a</p>\n<p><strong>\u6838\u5fc3\u601d\u60f3</strong>\uff1a\u5728\u8ba1\u7b97\u56fe\u4e2d\u540c\u65f6\u4f20\u64ad\u4e24\u4e2a\u91cf\uff1a</p>\n<ol>\n<li>\u6807\u51c6\u68af\u5ea6 $\\bar{\\mathbf{w}} = \\frac{\\partial L}{\\partial \\mathbf{w}}$</li>\n<li>\u65b9\u5411\u5bfc\u6570 $\\dot{\\mathbf{w}} = \\frac{\\partial \\mathbf{w}}{\\partial t}\\big|_{t=0}$ \u5f53 $\\mathbf{w}(t) = \\mathbf{w}_0 + t\\mathbf{v}$</li>\n</ol>\n<p><strong>\u4f20\u64ad\u89c4\u5219</strong>\uff1a\u5bf9\u4e8e\u64cd\u4f5c $\\mathbf{y} = f(\\mathbf{x})$\uff1a</p>\n<ul>\n<li>\u524d\u5411\uff1a$\\dot{\\mathbf{y}} = \\frac{\\partial f}{\\partial \\mathbf{x}} \\dot{\\mathbf{x}}$</li>\n<li>\u53cd\u5411\uff1a$\\bar{\\mathbf{x}} = \\frac{\\partial f}{\\partial \\mathbf{x}}^T \\bar{\\mathbf{y}}$</li>\n<li>Hessian\uff1a$\\mathbf{H}\\mathbf{v} = \\frac{\\partial f}{\\partial \\mathbf{x}}^T \\mathbf{H}_f \\dot{\\mathbf{x}} + \\frac{\\partial^2 f}{\\partial \\mathbf{x}^2}[\\dot{\\mathbf{x}}, \\bar{\\mathbf{y}}]$</li>\n</ul>\n<p><strong>\u5b9e\u73b0\u7ec6\u8282</strong>\uff1a</p>\n<ul>\n<li>\u9700\u8981\u4e3a\u6bcf\u4e2a\u64cd\u4f5c\u5b9a\u4e49\u989d\u5916\u7684\u4f20\u64ad\u89c4\u5219</li>\n<li>\u53ef\u4ee5\u4e0e\u73b0\u6709AD\u6846\u67b6\u96c6\u6210</li>\n<li>\u5185\u5b58\u5f00\u9500\u4ec5\u589e\u52a0\u4e00\u500d</li>\n</ul>\n<h3 id=\"223-r-operatorl-operator\">2.2.3 R-operator\u4e0eL-operator\u7684\u5b9e\u73b0</h3>\n<p>\u5728\u81ea\u52a8\u5fae\u5206\u6846\u67b6\u4e2d\uff0c\u6709\u4e24\u79cd\u8ba1\u7b97Hessian-\u5411\u91cf\u4e58\u79ef\u7684\u7b97\u5b50\uff1a</p>\n<p><strong>R-operator</strong> (Right multiplication)\uff1a\u8ba1\u7b97 $\\mathbf{H}\\mathbf{v}$</p>\n<div class=\"codehilite\"><pre><span></span><code>def R_op(f, x, v):\n    # \u521b\u5efadual number: x + \u03b5*v\n    # \u8ba1\u7b97 f(x + \u03b5*v) \u5e76\u63d0\u53d6 \u03b5 \u7684\u7cfb\u6570\n    g = grad(f, x)\n    return grad(lambda x: dot(g(x), v), x)\n</code></pre></div>\n\n<p><strong>L-operator</strong> (Left multiplication)\uff1a\u8ba1\u7b97 $\\mathbf{v}^T\\mathbf{H}$</p>\n<div class=\"codehilite\"><pre><span></span><code>def L_op(f, x, v):\n    # \u4f7f\u7528\u5411\u91cf-Jacobian\u4e58\u79ef\n    g = grad(f, x)\n    return vjp(g, x, v)\n</code></pre></div>\n\n<p><strong>\u5173\u7cfb</strong>\uff1a\u7531\u4e8eHessian\u7684\u5bf9\u79f0\u6027\uff0c$\\mathbf{v}^T\\mathbf{H} = (\\mathbf{H}\\mathbf{v})^T$</p>\n<p><strong>\u4f18\u5316\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528checkpointing\u51cf\u5c11\u5185\u5b58\u4f7f\u7528</li>\n<li>\u6279\u91cf\u8ba1\u7b97\u591a\u4e2a\u5411\u91cf\u7684Hessian\u4e58\u79ef</li>\n<li>\u5229\u7528\u7a00\u758f\u6027\u548c\u7ed3\u6784</li>\n</ul>\n<h3 id=\"224\">2.2.4 \u5728\u5171\u8f6d\u68af\u5ea6\u6cd5\u4e2d\u7684\u5e94\u7528</h3>\n<p>\u5171\u8f6d\u68af\u5ea6(CG)\u6cd5\u662f\u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf $\\mathbf{H}\\mathbf{x} = \\mathbf{b}$ \u7684\u8fed\u4ee3\u65b9\u6cd5\uff0c\u7279\u522b\u9002\u5408\u5927\u89c4\u6a21\u95ee\u9898\uff1a</p>\n<p><strong>\u7b97\u6cd5\u6846\u67b6</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u521d\u59cb\u5316\uff1ar_0 = b - H*x_0, p_0 = r_0\nfor k = 0, 1, 2, ...:\n    \u03b1_k = (r_k^T r_k) / (p_k^T H p_k)  # \u9700\u8981\u8ba1\u7b97 H*p_k\n    x_{k+1} = x_k + \u03b1_k p_k\n    r_{k+1} = r_k - \u03b1_k H p_k\n    \u03b2_k = (r_{k+1}^T r_{k+1}) / (r_k^T r_k)\n    p_{k+1} = r_{k+1} + \u03b2_k p_k\n</code></pre></div>\n\n<p><strong>Newton-CG\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528CG\u6c42\u89e3Newton\u65b9\u7a0b\uff1a$\\mathbf{H}_k \\mathbf{d}_k = -\\mathbf{g}_k$</li>\n<li>\u53ea\u9700\u8981Hessian-\u5411\u91cf\u4e58\u79ef\uff0c\u4e0d\u9700\u8981\u5b58\u50a8Hessian</li>\n<li>\u53ef\u4ee5\u63d0\u524d\u7ec8\u6b62\uff08inexact Newton\uff09</li>\n</ul>\n<p><strong>\u9884\u6761\u4ef6CG (PCG)</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u9884\u6761\u4ef6\u77e9\u9635 $\\mathbf{M} \\approx \\mathbf{H}^{-1}$</li>\n<li>\u5e38\u89c1\u9009\u62e9\uff1a\u5bf9\u89d2\u9884\u6761\u4ef6\u3001\u4e0d\u5b8c\u5168Cholesky\u5206\u89e3</li>\n<li>\u663e\u8457\u52a0\u901f\u6536\u655b\uff0c\u7279\u522b\u662f\u5bf9\u75c5\u6001\u95ee\u9898</li>\n</ul>\n<p><strong>\u6536\u655b\u5206\u6790</strong>\uff1a\nCG\u7684\u8bef\u5dee\u6ee1\u8db3\uff1a\n$$|\\mathbf{x}_k - \\mathbf{x}^*|_{\\mathbf{H}} \\leq 2\\left(\\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}\\right)^k |\\mathbf{x}_0 - \\mathbf{x}^*|_{\\mathbf{H}}$$\n\u5176\u4e2d $\\kappa = \\lambda_{max}/\\lambda_{min}$ \u662f\u6761\u4ef6\u6570\u3002</p>\n<h3 id=\"225\">2.2.5 \u5e76\u884c\u5316\u7b56\u7565\u4e0e\u5185\u5b58\u4f18\u5316</h3>\n<p>\u5927\u89c4\u6a21Hessian-\u5411\u91cf\u4e58\u79ef\u7684\u9ad8\u6548\u5b9e\u73b0\u9700\u8981\u8003\u8651\u73b0\u4ee3\u786c\u4ef6\u67b6\u6784\uff1a</p>\n<p><strong>1. \u6570\u636e\u5e76\u884c</strong>\uff1a\n- \u5c06\u5411\u91cf $\\mathbf{v}$ \u5206\u5757\uff1a$\\mathbf{v} = [\\mathbf{v}_1, \\mathbf{v}_2, ..., \\mathbf{v}_p]$\n- \u6bcf\u4e2a\u5904\u7406\u5668\u8ba1\u7b97\u90e8\u5206\u4e58\u79ef\n- \u4f7f\u7528all-reduce\u805a\u5408\u7ed3\u679c</p>\n<p><strong>2. \u6a21\u578b\u5e76\u884c</strong>\uff1a\n- \u5c06\u6a21\u578b\u53c2\u6570\u5206\u5e03\u5230\u4e0d\u540c\u8bbe\u5907\n- \u4f7f\u7528pipeline\u5e76\u884c\u51cf\u5c11\u901a\u4fe1\u5f00\u9500\n- \u6ce8\u610f\u5904\u7406\u8de8\u8bbe\u5907\u7684\u4f9d\u8d56\u5173\u7cfb</p>\n<p><strong>3. \u5185\u5b58\u4f18\u5316\u6280\u672f</strong>\uff1a</p>\n<p><strong>Checkpointing</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u5b58\u50a8\u6240\u6709\u4e2d\u95f4\u6fc0\u6d3b\u503c</li>\n<li>\u5728\u53cd\u5411\u4f20\u64ad\u65f6\u91cd\u65b0\u8ba1\u7b97</li>\n<li>\u5185\u5b58\u4f7f\u7528\u4ece $O(n)$ \u964d\u5230 $O(\\sqrt{n})$</li>\n</ul>\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u8ba1\u7b97</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528FP16\u8fdb\u884c\u524d\u5411\u4f20\u64ad</li>\n<li>FP32\u7d2f\u79ef\u68af\u5ea6\u548cHessian\u4e58\u79ef</li>\n<li>\u6ce8\u610f\u6570\u503c\u7a33\u5b9a\u6027</li>\n</ul>\n<p><strong>4. \u901a\u4fe1\u4f18\u5316</strong>\uff1a\n- \u91cd\u53e0\u8ba1\u7b97\u4e0e\u901a\u4fe1\n- \u4f7f\u7528\u538b\u7f29\u6280\u672f\u51cf\u5c11\u5e26\u5bbd\u9700\u6c42\n- \u63a2\u7d22\u5f02\u6b65\u66f4\u65b0\u7b56\u7565</p>\n<p><strong>5. \u6279\u91cfHessian-\u5411\u91cf\u4e58\u79ef</strong>\uff1a\n\u8ba1\u7b97 $\\mathbf{H}[\\mathbf{v}_1, \\mathbf{v}_2, ..., \\mathbf{v}_k]$ \u6bd4\u5355\u72ec\u8ba1\u7b97\u6bcf\u4e2a\u66f4\u9ad8\u6548\uff1a</p>\n<ul>\n<li>\u66f4\u597d\u7684\u7f13\u5b58\u5229\u7528\u7387</li>\n<li>\u51cf\u5c11kernel\u542f\u52a8\u5f00\u9500</li>\n<li>\u9002\u5408GPU\u67b6\u6784</li>\n</ul>\n<p><strong>\u5b9e\u8df5\u5efa\u8bae</strong>\uff1a</p>\n<ul>\n<li>profile\u4ee3\u7801\u627e\u51fa\u74f6\u9888</li>\n<li>\u4f7f\u7528\u4e13\u95e8\u7684\u7ebf\u6027\u4ee3\u6570\u5e93\uff08\u5982cuBLAS\uff09</li>\n<li>\u8003\u8651\u8fd1\u4f3c\u6280\u672f\u6743\u8861\u7cbe\u5ea6\u4e0e\u901f\u5ea6</li>\n</ul>\n<h3 id=\"226-hessian\">2.2.6 \u7ed3\u6784\u5316Hessian\u7684\u7279\u6b8a\u5904\u7406</h3>\n<p>\u8bb8\u591a\u5b9e\u9645\u95ee\u9898\u7684Hessian\u5177\u6709\u7279\u6b8a\u7ed3\u6784\uff0c\u5229\u7528\u8fd9\u4e9b\u7ed3\u6784\u53ef\u4ee5\u5927\u5e45\u63d0\u5347\u6548\u7387\uff1a</p>\n<p><strong>1. \u5e26\u72b6Hessian</strong>\uff1a\n\u5f53\u53d8\u91cf\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u5c40\u90e8\u5316\u65f6\uff0cHessian\u5448\u73b0\u5e26\u72b6\u7ed3\u6784\uff1a\n$$\\mathbf{H} = \\begin{bmatrix}\n* &amp; * &amp; * &amp; 0 &amp; \\cdots \\\n* &amp; * &amp; * &amp; * &amp; \\ddots \\\n* &amp; * &amp; * &amp; * &amp; * \\\n0 &amp; * &amp; * &amp; * &amp; * \\\n\\vdots &amp; \\ddots &amp; * &amp; * &amp; *\n\\end{bmatrix}$$\n\u9ad8\u6548\u8ba1\u7b97\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u53ea\u5b58\u50a8\u5e26\u5185\u5143\u7d20</li>\n<li>\u5229\u7528\u7a00\u758f\u77e9\u9635-\u5411\u91cf\u4e58\u6cd5</li>\n<li>\u5e26\u5bbd $b$ \u65f6\uff0c\u590d\u6742\u5ea6\u964d\u81f3 $O(bn)$</li>\n</ul>\n<p><strong>2. \u5206\u5757Hessian</strong>\uff1a\n\u5bf9\u4e8e\u591a\u4efb\u52a1\u5b66\u4e60\u6216\u5206\u5c42\u6a21\u578b\uff1a\n$$\\mathbf{H} = \\begin{bmatrix}\n\\mathbf{H}_{11} &amp; \\mathbf{H}_{12} &amp; \\cdots \\\n\\mathbf{H}_{21} &amp; \\mathbf{H}_{22} &amp; \\cdots \\\n\\vdots &amp; \\vdots &amp; \\ddots\n\\end{bmatrix}$$\n\u4f18\u5316\u6280\u672f\uff1a</p>\n<ul>\n<li>\u5206\u5757\u8ba1\u7b97Hessian-\u5411\u91cf\u4e58\u79ef</li>\n<li>\u5229\u7528\u5757\u95f4\u7a00\u758f\u6027</li>\n<li>\u5e76\u884c\u5904\u7406\u4e0d\u540c\u5757</li>\n</ul>\n<p><strong>3. \u4f4e\u79e9\u6270\u52a8\u7ed3\u6784</strong>\uff1a\n$$\\mathbf{H} = \\mathbf{D} + \\mathbf{U}\\mathbf{V}^T$$\n\u5176\u4e2d $\\mathbf{D}$ \u662f\u5bf9\u89d2\u77e9\u9635\uff0c$\\mathbf{U}, \\mathbf{V} \\in \\mathbb{R}^{n \\times r}$\uff0c$r \\ll n$\u3002</p>\n<p>\u9ad8\u6548\u8ba1\u7b97\uff1a\n$$\\mathbf{H}\\mathbf{v} = \\mathbf{D}\\mathbf{v} + \\mathbf{U}(\\mathbf{V}^T\\mathbf{v})$$</p>\n<ul>\n<li>\u5148\u8ba1\u7b97 $\\mathbf{V}^T\\mathbf{v}$\uff08$O(rn)$\uff09</li>\n<li>\u518d\u8ba1\u7b97 $\\mathbf{U}$ \u4e0e\u7ed3\u679c\u7684\u4e58\u79ef</li>\n<li>\u603b\u590d\u6742\u5ea6\uff1a$O(rn)$ \u800c\u975e $O(n^2)$</li>\n</ul>\n<p><strong>4. Kronecker\u79ef\u7ed3\u6784</strong>\uff1a\n\u5bf9\u4e8e\u5f20\u91cf\u5316\u6a21\u578b\u6216\u591a\u7ebf\u6027\u95ee\u9898\uff1a\n$$\\mathbf{H} = \\mathbf{A}_1 \\otimes \\mathbf{A}_2 \\otimes \\cdots \\otimes \\mathbf{A}_d$$\n\u5229\u7528Kronecker\u79ef\u6027\u8d28\uff1a\n$$(\\mathbf{A} \\otimes \\mathbf{B})\\text{vec}(\\mathbf{X}) = \\text{vec}(\\mathbf{B}\\mathbf{X}\\mathbf{A}^T)$$\n\u8fd9\u5c06 $O(n^2)$ \u7684\u64cd\u4f5c\u964d\u81f3 $O(dn^{2/d})$\u3002</p>\n<p><strong>5. \u9690\u5f0f\u5b9a\u4e49\u7684Hessian\u7ed3\u6784</strong>\uff1a</p>\n<p><strong>Gauss-Newton\u8fd1\u4f3c</strong>\uff1a\n\u5bf9\u4e8e\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898 $f(\\mathbf{x}) = \\frac{1}{2}|\\mathbf{r}(\\mathbf{x})|^2$\uff1a\n$$\\mathbf{H} \\approx \\mathbf{J}^T\\mathbf{J}$$\n\u5176\u4e2d $\\mathbf{J}$ \u662f\u6b8b\u5dee\u7684Jacobian\u3002\u8ba1\u7b97 $\\mathbf{H}\\mathbf{v}$ \u53ea\u9700\uff1a</p>\n<ol>\n<li>\u8ba1\u7b97 $\\mathbf{w} = \\mathbf{J}\\mathbf{v}$ \uff08\u524d\u5411\u6a21\u5f0fAD\uff09</li>\n<li>\u8ba1\u7b97 $\\mathbf{H}\\mathbf{v} = \\mathbf{J}^T\\mathbf{w}$ \uff08\u53cd\u5411\u6a21\u5f0fAD\uff09</li>\n</ol>\n<p><strong>Fisher\u4fe1\u606f\u77e9\u9635</strong>\uff1a\n\u5bf9\u4e8e\u6982\u7387\u6a21\u578b $p(y|x;\\theta)$\uff1a\n$$\\mathbf{F} = \\mathbb{E}_{y \\sim p}[\\nabla_\\theta \\log p(y|x;\\theta) \\nabla_\\theta \\log p(y|x;\\theta)^T]$$\n\u8ba1\u7b97 $\\mathbf{F}\\mathbf{v}$ \u53ef\u4ee5\u901a\u8fc7\u91c7\u6837\u8fd1\u4f3c\uff0c\u907f\u514d\u5b58\u50a8\u5b8c\u6574\u77e9\u9635\u3002</p>\n<p><strong>6. \u56fe\u7ed3\u6784\u8bf1\u5bfc\u7684\u7a00\u758f\u6027</strong>\uff1a</p>\n<p>\u5bf9\u4e8e\u56fe\u795e\u7ecf\u7f51\u7edc\u6216\u9a6c\u5c14\u53ef\u592b\u968f\u673a\u573a\uff1a</p>\n<ul>\n<li>Hessian\u7684\u7a00\u758f\u6a21\u5f0f\u7531\u56fe\u7684\u90bb\u63a5\u7ed3\u6784\u51b3\u5b9a</li>\n<li>\u4f7f\u7528\u56fe\u7740\u8272\u7b97\u6cd5\u5e76\u884c\u8ba1\u7b97\u4e0d\u76f8\u4ea4\u7684\u5143\u7d20</li>\n<li>\u5229\u7528\u6d88\u606f\u4f20\u9012\u6846\u67b6\u9ad8\u6548\u5b9e\u73b0</li>\n</ul>\n<p><strong>\u9ad8\u7ea7\u6280\u5de7\uff1a\u7a00\u758f\u6027\u63a2\u6d4b</strong>\uff1a\n\u5f53Hessian\u7a00\u758f\u6a21\u5f0f\u672a\u77e5\u65f6\uff1a</p>\n<ol>\n<li>\u4f7f\u7528\u968f\u673a\u63a2\u6d4b\u5411\u91cf $\\mathbf{v}_i$ \u8ba1\u7b97 $\\mathbf{H}\\mathbf{v}_i$</li>\n<li>\u901a\u8fc7\u538b\u7f29\u611f\u77e5\u6280\u672f\u6062\u590d\u7a00\u758f\u6a21\u5f0f</li>\n<li>\u540e\u7eed\u8ba1\u7b97\u5229\u7528\u53d1\u73b0\u7684\u7ed3\u6784</li>\n</ol>\n<p><strong>\u6df7\u5408\u7ed3\u6784\u7684\u5904\u7406</strong>\uff1a\n\u5b9e\u9645\u95ee\u9898\u5e38\u5177\u6709\u591a\u79cd\u7ed3\u6784\u7684\u7ec4\u5408\uff1a\n$$\\mathbf{H} = \\mathbf{H}_{sparse} + \\mathbf{L}\\mathbf{L}^T + \\sigma\\mathbf{I}$$</p>\n<ul>\n<li>\u5206\u522b\u5904\u7406\u6bcf\u4e2a\u7ec4\u4ef6</li>\n<li>\u4f7f\u7528\u52a0\u6cd5\u89c4\u5219\u7ec4\u5408HVP</li>\n<li>\u6ce8\u610f\u6570\u503c\u7a33\u5b9a\u6027</li>\n</ul>\n<h3 id=\"227-hessian-\">2.2.7 \u968f\u673a\u5316Hessian-\u5411\u91cf\u4e58\u79ef</h3>\n<p>\u5bf9\u4e8e\u8d85\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u5373\u4f7f $O(n)$ \u7684\u8ba1\u7b97\u4e5f\u53ef\u80fd\u8fc7\u4e8e\u6602\u8d35\uff0c\u968f\u673a\u5316\u65b9\u6cd5\u63d0\u4f9b\u4e86\u53ef\u884c\u7684\u66ff\u4ee3\uff1a</p>\n<p><strong>1. \u5b50\u91c7\u6837\u65b9\u6cd5</strong>\uff1a\n\u4e0d\u4f7f\u7528\u5b8c\u6574\u6570\u636e\u8ba1\u7b97Hessian-\u5411\u91cf\u4e58\u79ef\uff1a\n$$\\mathbf{H}\\mathbf{v} \\approx \\frac{1}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}} \\nabla^2 f_i(\\mathbf{x}) \\mathbf{v}$$\n\u5176\u4e2d $\\mathcal{B}$ \u662f\u968f\u673a\u9009\u62e9\u7684\u5c0f\u6279\u91cf\u3002</p>\n<p>\u65b9\u5dee\u7f29\u51cf\u6280\u672f\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u63a7\u5236\u53d8\u91cf\uff1a$\\tilde{\\mathbf{H}}\\mathbf{v} = \\mathbf{H}_0\\mathbf{v} + \\frac{1}{|\\mathcal{B}|} \\sum_{i \\in \\mathcal{B}} (\\nabla^2 f_i - \\mathbf{H}_0)\\mathbf{v}$</li>\n<li>\u91cd\u8981\u6027\u91c7\u6837\uff1a\u6839\u636e\u66f2\u7387\u53d8\u5316\u9009\u62e9\u6837\u672c</li>\n<li>\u6e10\u8fdb\u65b9\u5dee\u7f29\u51cf\uff1a\u968f\u8fed\u4ee3\u589e\u52a0\u6279\u91cf\u5927\u5c0f</li>\n</ul>\n<p><strong>2. \u968f\u673a\u6295\u5f71\u65b9\u6cd5</strong>\uff1a\n\u4f7f\u7528\u968f\u673a\u77e9\u9635 $\\mathbf{S} \\in \\mathbb{R}^{n \\times k}$ \u8fd1\u4f3c\uff1a\n$$\\mathbf{H} \\approx \\mathbf{H}\\mathbf{S}(\\mathbf{S}^T\\mathbf{H}\\mathbf{S})^{-1}\\mathbf{S}^T\\mathbf{H}$$\n\u5e38\u7528\u968f\u673a\u77e9\u9635\uff1a</p>\n<ul>\n<li>\u9ad8\u65af\u968f\u673a\u77e9\u9635\uff1a$S_{ij} \\sim \\mathcal{N}(0, 1/k)$</li>\n<li>\u7a00\u758f\u968f\u673a\u77e9\u9635\uff1a\u5927\u90e8\u5206\u5143\u7d20\u4e3a\u96f6</li>\n<li>Hadamard\u77e9\u9635\u7684\u968f\u673a\u5b50\u96c6</li>\n</ul>\n<p><strong>3. \u91cf\u5b50\u542f\u53d1\u7684\u91c7\u6837</strong>\uff1a\n\u5229\u7528\u91cf\u5b50\u8ba1\u7b97\u7684\u601d\u60f3\u8bbe\u8ba1\u7ecf\u5178\u91c7\u6837\u7b56\u7565\uff1a</p>\n<ul>\n<li>\u57fa\u4e8e\u632f\u5e45\u653e\u5927\u7684\u91cd\u8981\u6027\u91c7\u6837</li>\n<li>\u5229\u7528\u7ea0\u7f20\u7ed3\u6784\u51cf\u5c11\u91c7\u6837\u590d\u6742\u5ea6</li>\n<li>\u91cf\u5b50\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u7684\u7ecf\u5178\u6a21\u62df</li>\n</ul>\n<h3 id=\"228\">2.2.8 \u81ea\u52a8\u5fae\u5206\u6846\u67b6\u7684\u9ad8\u7ea7\u5e94\u7528</h3>\n<p>\u73b0\u4ee3\u81ea\u52a8\u5fae\u5206\u6846\u67b6\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5de5\u5177\u6765\u8ba1\u7b97Hessian-\u5411\u91cf\u4e58\u79ef\uff1a</p>\n<p><strong>1. \u9ad8\u9636\u81ea\u52a8\u5fae\u5206</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># JAX\u793a\u4f8b</span>\n<span class=\"k\">def</span> <span class=\"nf\">hvp</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">jax</span><span class=\"o\">.</span><span class=\"n\">grad</span><span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"n\">jax</span><span class=\"o\">.</span><span class=\"n\">vmap</span><span class=\"p\">(</span><span class=\"n\">jax</span><span class=\"o\">.</span><span class=\"n\">grad</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">))(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"o\">@</span> <span class=\"n\">v</span><span class=\"p\">)(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># PyTorch\u793a\u4f8b  </span>\n<span class=\"k\">def</span> <span class=\"nf\">hvp</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">):</span>\n    <span class=\"n\">grad</span> <span class=\"o\">=</span> <span class=\"n\">torch</span><span class=\"o\">.</span><span class=\"n\">autograd</span><span class=\"o\">.</span><span class=\"n\">grad</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">create_graph</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n    <span class=\"k\">return</span> <span class=\"n\">torch</span><span class=\"o\">.</span><span class=\"n\">autograd</span><span class=\"o\">.</span><span class=\"n\">grad</span><span class=\"p\">(</span><span class=\"n\">grad</span> <span class=\"o\">@</span> <span class=\"n\">v</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n</code></pre></div>\n\n<p><strong>2. \u5411\u91cf\u5316\u8ba1\u7b97\u591a\u4e2aHVP</strong>\uff1a\n\u540c\u65f6\u8ba1\u7b97\u591a\u4e2a\u65b9\u5411\u7684Hessian-\u5411\u91cf\u4e58\u79ef\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u6279\u91cfHVP\u8ba1\u7b97</span>\n<span class=\"k\">def</span> <span class=\"nf\">batch_hvp</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">V</span><span class=\"p\">):</span>  <span class=\"c1\"># V\u662f\u591a\u4e2a\u5411\u91cf\u7ec4\u6210\u7684\u77e9\u9635</span>\n    <span class=\"k\">return</span> <span class=\"n\">jax</span><span class=\"o\">.</span><span class=\"n\">vmap</span><span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"n\">v</span><span class=\"p\">:</span> <span class=\"n\">hvp</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">),</span> <span class=\"n\">in_axes</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">out_axes</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)(</span><span class=\"n\">V</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p><strong>3. \u6df7\u5408\u6a21\u5f0f\u5fae\u5206</strong>\uff1a\n\u7ed3\u5408\u524d\u5411\u548c\u53cd\u5411\u6a21\u5f0f\u83b7\u5f97\u6700\u4f73\u6548\u7387\uff1a</p>\n<ul>\n<li>\u5bf9\u4e8e\"\u9ad8\u7626\"Jacobian\uff08$m \\ll n$\uff09\uff0c\u4f7f\u7528\u524d\u5411\u6a21\u5f0f</li>\n<li>\u5bf9\u4e8e\"\u77ee\u80d6\"Jacobian\uff08$m \\gg n$\uff09\uff0c\u4f7f\u7528\u53cd\u5411\u6a21\u5f0f</li>\n<li>\u5bf9\u4e8eHessian\uff0c\u53ef\u4ee5\u6df7\u5408\u4f7f\u7528</li>\n</ul>\n<p><strong>4. \u81ea\u5b9a\u4e49VJP\u89c4\u5219</strong>\uff1a\n\u4e3a\u7279\u6b8a\u64cd\u4f5c\u5b9a\u4e49\u9ad8\u6548\u7684\u5411\u91cf-Jacobian\u4e58\u79ef\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nd\">@jax</span><span class=\"o\">.</span><span class=\"n\">custom_vjp</span>\n<span class=\"k\">def</span> <span class=\"nf\">custom_op</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">):</span>\n    <span class=\"c1\"># \u524d\u5411\u8ba1\u7b97</span>\n    <span class=\"k\">return</span> <span class=\"n\">result</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">custom_op_fwd</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">):</span>\n    <span class=\"c1\"># \u4fdd\u5b58\u524d\u5411\u4f20\u64ad\u9700\u8981\u7684\u4e2d\u95f4\u7ed3\u679c</span>\n    <span class=\"k\">return</span> <span class=\"n\">result</span><span class=\"p\">,</span> <span class=\"n\">saved_values</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">custom_op_bwd</span><span class=\"p\">(</span><span class=\"n\">saved_values</span><span class=\"p\">,</span> <span class=\"n\">g</span><span class=\"p\">):</span>\n    <span class=\"c1\"># \u5b9a\u4e49\u9ad8\u6548\u7684\u53cd\u5411\u4f20\u64ad</span>\n    <span class=\"k\">return</span> <span class=\"n\">vjp_result</span>\n\n<span class=\"n\">custom_op</span><span class=\"o\">.</span><span class=\"n\">defvjp</span><span class=\"p\">(</span><span class=\"n\">custom_op_fwd</span><span class=\"p\">,</span> <span class=\"n\">custom_op_bwd</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<h3 id=\"229\">2.2.9 \u5e94\u7528\u6848\u4f8b\uff1a\u5927\u89c4\u6a21\u79d1\u5b66\u8ba1\u7b97</h3>\n<p><strong>1. \u5206\u5b50\u52a8\u529b\u5b66\u4e2d\u7684Hessian\u8ba1\u7b97</strong>\uff1a\n\u5bf9\u4e8e $N$ \u4e2a\u539f\u5b50\u7684\u7cfb\u7edf\uff0cHessian\u662f $3N \\times 3N$ \u7684\u77e9\u9635\uff1a</p>\n<ul>\n<li>\u5229\u7528\u529b\u573a\u7684\u5c40\u90e8\u6027\uff08\u622a\u65ad\u534a\u5f84\uff09</li>\n<li>\u4f7f\u7528\u90bb\u5c45\u5217\u8868\u52a0\u901f</li>\n<li>\u5e76\u884c\u8ba1\u7b97\u4e0d\u540c\u539f\u5b50\u5bf9\u7684\u8d21\u732e</li>\n</ul>\n<p><strong>2. \u504f\u5fae\u5206\u65b9\u7a0b\u7684\u79bb\u6563\u5316</strong>\uff1a\n\u6709\u9650\u5143\u65b9\u6cd5\u4ea7\u751f\u7684Hessian\u901a\u5e38\u7a00\u758f\u4e14\u7ed3\u6784\u5316\uff1a</p>\n<ul>\n<li>\u5229\u7528\u7f51\u683c\u7684\u89c4\u5219\u6027</li>\n<li>\u4f7f\u7528\u591a\u91cd\u7f51\u683c\u65b9\u6cd5\u4f5c\u4e3a\u9884\u6761\u4ef6\u5b50</li>\n<li>\u57df\u5206\u89e3\u5b9e\u73b0\u5e76\u884c\u5316</li>\n</ul>\n<p><strong>3. \u56fe\u795e\u7ecf\u7f51\u7edc\u7684\u4e8c\u9636\u4f18\u5316</strong>\uff1a\nGNN\u7684Hessian\u5177\u6709\u56fe\u7ed3\u6784\u8bf1\u5bfc\u7684\u7a00\u758f\u6027\uff1a</p>\n<ul>\n<li>\u6d88\u606f\u4f20\u9012\u6846\u67b6\u4e0b\u7684\u9ad8\u6548HVP</li>\n<li>\u5229\u7528\u56fe\u7684\u8c31\u6027\u8d28</li>\n<li>\u5c40\u90e8\u5316\u8ba1\u7b97\u51cf\u5c11\u901a\u4fe1</li>\n</ul>\n<p><strong>4. \u53d8\u5206\u63a8\u65ad\u4e2d\u7684\u81ea\u7136\u68af\u5ea6</strong>\uff1a\nFisher\u4fe1\u606f\u77e9\u9635\u7684\u9ad8\u6548\u8ba1\u7b97\uff1a</p>\n<ul>\n<li>\u5229\u7528\u6982\u7387\u6a21\u578b\u7684\u56e0\u5b50\u5206\u89e3</li>\n<li>Monte Carlo\u4f30\u8ba1HVP</li>\n<li>\u7ed3\u6784\u5316\u53d8\u5206\u65cf\u7684\u7279\u6b8a\u5904\u7406</li>\n</ul>\n<h3 id=\"2210\">2.2.10 \u672a\u6765\u7814\u7a76\u65b9\u5411</h3>\n<p><strong>1. \u786c\u4ef6-\u7b97\u6cd5\u534f\u540c\u8bbe\u8ba1</strong>\uff1a\n- \u9488\u5bf9\u65b0\u578b\u52a0\u901f\u5668\uff08\u5982Graphcore IPU\uff09\u4f18\u5316HVP\n- \u5229\u7528\u8fd1\u6570\u636e\u8ba1\u7b97\u51cf\u5c11\u5185\u5b58\u5e26\u5bbd\u538b\u529b\n- \u63a2\u7d22\u6a21\u62df\u8ba1\u7b97\u5668\u7684\u53ef\u80fd\u6027</p>\n<p><strong>2. \u7406\u8bba\u754c\u9650\u7684\u6539\u8fdb</strong>\uff1a\n- \u968f\u673aHVP\u7684\u6700\u4f18\u91c7\u6837\u590d\u6742\u5ea6\n- \u7ed3\u6784\u5316\u95ee\u9898\u7684\u4e0b\u754c\n- \u901a\u4fe1\u590d\u6742\u5ea6\u7684\u7406\u8bba\u5206\u6790</p>\n<p><strong>3. \u4e0e\u673a\u5668\u5b66\u4e60\u7684\u6df1\u5ea6\u7ed3\u5408</strong>\uff1a\n- \u5b66\u4e60\u95ee\u9898\u76f8\u5173\u7684HVP\u8fd1\u4f3c\n- \u5143\u5b66\u4e60\u4f18\u5316HVP\u8ba1\u7b97\u7b56\u7565\n- \u795e\u7ecf\u7f51\u7edc\u52a0\u901f\u7ecf\u5178\u7b97\u6cd5</p>\n<p><strong>4. \u91cf\u5b50-\u7ecf\u5178\u6df7\u5408\u7b97\u6cd5</strong>\uff1a\n- \u91cf\u5b50\u8ba1\u7b97\u673a\u4e0a\u7684HVP\u539f\u8bed\n- \u7ecf\u5178\u9884\u5904\u7406+\u91cf\u5b50\u6838\u5fc3\u8ba1\u7b97\n- \u5bb9\u9519\u91cf\u5b50\u8ba1\u7b97\u7684\u7b97\u6cd5\u8bbe\u8ba1</p>\n<h3 id=\"2211-hvp\">2.2.11 HVP\u5728\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\u4e2d\u7684\u5b9e\u8df5</h3>\n<p><strong>\u4e0e\u81ea\u52a8\u6df7\u5408\u7cbe\u5ea6(AMP)\u7684\u96c6\u6210</strong>\uff1a</p>\n<p>\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\u4e2d\u7684HVP\u8ba1\u7b97\u9700\u8981\u7279\u522b\u6ce8\u610f\u6570\u503c\u7cbe\u5ea6\uff1a</p>\n<p><strong>\u7cbe\u5ea6\u7b56\u7565</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u8ba1\u7b97\u7cbe\u5ea6\u5206\u5c42</strong>\uff1a\n   - \u524d\u5411\u4f20\u64ad\uff1aFP16/BF16\n   - HVP\u6838\u5fc3\u8ba1\u7b97\uff1aFP32\n   - \u7d2f\u79ef\u548c\u5f52\u7ea6\uff1aFP32/FP64</p>\n</li>\n<li>\n<p><strong>\u52a8\u6001\u7cbe\u5ea6\u5207\u6362</strong>\uff1a\n   <code>if gradient_norm &gt; threshold:\n       use_high_precision_hvp()\n   else:\n       use_mixed_precision_hvp()</code></p>\n</li>\n<li>\n<p><strong>\u8bef\u5dee\u8865\u507f\u673a\u5236</strong>\uff1a\n   - Kahan\u6c42\u548c\u7528\u4e8e\u5173\u952e\u7d2f\u79ef\n   - \u8bef\u5dee\u8ffd\u8e2a\u548c\u6821\u6b63\n   - \u5468\u671f\u6027\u9ad8\u7cbe\u5ea6\u9a8c\u8bc1</p>\n</li>\n</ol>\n<p><strong>\u5206\u5e03\u5f0fHVP\u7684\u901a\u4fe1\u4f18\u5316</strong>\uff1a</p>\n<p><strong>\u68af\u5ea6\u538b\u7f29\u4e0eHVP</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528Top-K\u7a00\u758f\u5316\u51cf\u5c11\u901a\u4fe1\u91cf</li>\n<li>\u8bef\u5dee\u53cd\u9988\u673a\u5236\u4fdd\u8bc1\u6536\u655b\u6027</li>\n<li>\u52a8\u91cf\u7f13\u51b2\u533a\u8865\u507f\u538b\u7f29\u635f\u5931</li>\n</ul>\n<p><strong>\u5c42\u7ea7\u901a\u4fe1\u62d3\u6251</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>Ring-AllReduce for HVP</strong>\uff1a\n   - \u5c06\u5411\u91cf\u5206\u7247\u5728\u73af\u4e0a\u4f20\u9012\n   - \u6bcf\u4e2a\u8282\u70b9\u8ba1\u7b97\u5c40\u90e8HVP\u8d21\u732e\n   - \u805a\u5408\u65f6\u8fdb\u884c\u90e8\u5206\u6c42\u548c</p>\n</li>\n<li>\n<p><strong>\u6811\u5f62\u5f52\u7ea6</strong>\uff1a\n   - \u9002\u5408\u5927\u89c4\u6a21\u96c6\u7fa4\n   - \u5bf9\u6570\u901a\u4fe1\u8f6e\u6b21\n   - \u5bb9\u9519\u6027\u8bbe\u8ba1</p>\n</li>\n</ol>\n<p><strong>\u5185\u5b58\u5e26\u5bbd\u4f18\u5316</strong>\uff1a</p>\n<p><strong>\u878d\u5408\u7b97\u5b50\u8bbe\u8ba1</strong>\uff1a\n\u5c06\u591a\u4e2aHVP\u76f8\u5173\u64cd\u4f5c\u878d\u5408\u51cf\u5c11\u5185\u5b58\u8bbf\u95ee\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>fused_hvp_and_update(H, v, x, lr):\n    hvp = compute_hvp(H, v)\n    x_new = x - lr * hvp  # \u878d\u5408\u66f4\u65b0\n    return x_new, hvp\n</code></pre></div>\n\n<p><strong>\u5f20\u91cf\u6838\u5fc3(Tensor Core)\u5229\u7528</strong>\uff1a</p>\n<ul>\n<li>\u5c06HVP\u8ba1\u7b97\u91cd\u6784\u4e3a\u5c0f\u77e9\u9635\u4e58\u6cd5</li>\n<li>\u5229\u7528Tensor Core\u7684\u9ad8\u541e\u5410\u91cf</li>\n<li>\u6ce8\u610f\u5bf9\u9f50\u548c\u586b\u5145\u8981\u6c42</li>\n</ul>\n<h3 id=\"2212-hvp\">2.2.12 HVP\u7684\u9ad8\u7ea7\u7406\u8bba\u89c6\u89d2</h3>\n<p><strong>\u6cdb\u51fd\u5206\u6790\u6846\u67b6</strong>\uff1a</p>\n<p>\u5c06HVP\u89c6\u4e3a\u7ebf\u6027\u7b97\u5b50\uff1a\n$$\\mathcal{L}_H: \\mathcal{V} \\to \\mathcal{V}, \\quad \\mathcal{L}_H(v) = Hv$$\n<strong>\u7b97\u5b50\u8303\u6570\u4e0e\u8c31\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li>$|\\mathcal{L}_H| = \\lambda_{max}(H)$</li>\n<li>\u7d27\u7b97\u5b50\u8fd1\u4f3c\u7406\u8bba\u5e94\u7528</li>\n<li>Riesz\u8868\u793a\u5b9a\u7406\u7684\u542b\u4e49</li>\n</ul>\n<p><strong>\u5fae\u5206\u51e0\u4f55\u89c6\u89d2</strong>\uff1a</p>\n<p><strong>\u8054\u7edc\u4e0e\u5e73\u884c\u4f20\u8f93</strong>\uff1a\nHVP\u53ef\u89e3\u91ca\u4e3a\u5207\u7a7a\u95f4\u4e2d\u7684\u5e73\u884c\u4f20\u8f93\uff1a</p>\n<ul>\n<li>Levi-Civita\u8054\u7edc\u5b9a\u4e49\u5c40\u90e8\u51e0\u4f55</li>\n<li>HVP\u8ba1\u7b97\u534f\u53d8\u5bfc\u6570</li>\n<li>\u6d4b\u5730\u7ebf\u65b9\u7a0b\u7684\u6570\u503c\u89e3</li>\n</ul>\n<p><strong>\u6d41\u5f62\u4f18\u5316\u542b\u4e49</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u540c\u53c2\u6570\u5316\u4e0b\u7684HVP\u53d8\u6362\u89c4\u5f8b</li>\n<li>\u81ea\u7136\u68af\u5ea6\u4e0eHVP\u7684\u5185\u5728\u8054\u7cfb</li>\n<li>Riemannian HVP\u7684\u8ba1\u7b97\u7b56\u7565</li>\n</ul>\n<p><strong>\u4fe1\u606f\u7406\u8bba\u89e3\u91ca</strong>\uff1a</p>\n<p><strong>KL\u6563\u5ea6\u7684Hessian</strong>\uff1a\n\u5bf9\u4e8e\u5206\u5e03\u65cf $p_\\theta$\uff0cKL\u6563\u5ea6\u7684Hessian\u7b49\u4e8eFisher\u4fe1\u606f\u77e9\u9635\uff1a\n$$H_{KL} = \\mathbb{E}_{p_\\theta}[\\nabla_\\theta \\log p_\\theta \\nabla_\\theta \\log p_\\theta^T] = F(\\theta)$$\n\u8fd9\u5efa\u7acb\u4e86HVP\u4e0e\u4fe1\u606f\u51e0\u4f55\u7684\u6865\u6881\u3002</p>\n<p><strong>\u6700\u5c0f\u63cf\u8ff0\u957f\u5ea6(MDL)\u539f\u7406</strong>\uff1a</p>\n<ul>\n<li>HVP\u7f16\u7801\u53c2\u6570\u53d8\u5316\u7684\"\u6210\u672c\"</li>\n<li>\u4e0e\u6a21\u578b\u590d\u6742\u5ea6\u7684\u5173\u7cfb</li>\n<li>\u5728\u6a21\u578b\u9009\u62e9\u4e2d\u7684\u5e94\u7528</li>\n</ul>\n<p><strong>\u5f00\u653e\u7814\u7a76\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u975e\u6b27\u51e0\u4f55\u4e2d\u7684HVP</strong>\uff1a\n   - \u53cc\u66f2\u7a7a\u95f4\u4f18\u5316\u7684HVP\u8ba1\u7b97\n   - \u79bb\u6563\u51e0\u4f55\uff08\u56fe\u3001\u6d41\u5f62\uff09\u4e0a\u7684\u63a8\u5e7f\n   - \u4e0e\u6700\u4f18\u4f20\u8f93\u7406\u8bba\u7684\u8054\u7cfb</p>\n</li>\n<li>\n<p><strong>\u968f\u673a\u5fae\u5206\u65b9\u7a0b\u89c6\u89d2</strong>\uff1a\n   - HVP\u5728Langevin\u52a8\u529b\u5b66\u4e2d\u7684\u4f5c\u7528\n   - \u4e0e\u968f\u673a\u4f18\u5316\u7684\u6df1\u5c42\u8054\u7cfb\n   - \u6269\u6563\u6a21\u578b\u4e2d\u7684\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>\u56e0\u679c\u63a8\u65ad\u4e2d\u7684HVP</strong>\uff1a\n   - \u53cd\u4e8b\u5b9e\u68af\u5ea6\u7684\u4e8c\u9636\u4fe1\u606f\n   - \u5de5\u5177\u53d8\u91cf\u4f30\u8ba1\u7684HVP\n   - \u56e0\u679c\u56fe\u7ed3\u6784\u7684\u5229\u7528</p>\n</li>\n<li>\n<p><strong>\u9c81\u68d2\u4f18\u5316\u4e2d\u7684\u5e94\u7528</strong>\uff1a\n   - \u5bf9\u6297\u6270\u52a8\u4e0b\u7684HVP\u7a33\u5b9a\u6027\n   - \u5206\u5e03\u9c81\u68d2\u4f18\u5316\u7684\u4e8c\u9636\u65b9\u6cd5\n   - \u4e0d\u786e\u5b9a\u6027\u91cf\u5316</p>\n</li>\n</ol>\n<h2 id=\"23\">2.3 \u8d1f\u66f2\u7387\u65b9\u5411\u7684\u68c0\u6d4b\u4e0e\u5229\u7528</h2>\n<p>\u5728\u975e\u51f8\u4f18\u5316\u4e2d\uff0cHessian\u77e9\u9635\u53ef\u80fd\u6709\u8d1f\u7279\u5f81\u503c\uff0c\u5bf9\u5e94\u7684\u7279\u5f81\u5411\u91cf\u6307\u5411\u8d1f\u66f2\u7387\u65b9\u5411\u3002\u6cbf\u7740\u8fd9\u4e9b\u65b9\u5411\u79fb\u52a8\u53ef\u4ee5\u5e2e\u52a9\u7b97\u6cd5\u9003\u79bb\u978d\u70b9\uff0c\u8fd9\u5bf9\u6df1\u5ea6\u5b66\u4e60\u7b49\u5e94\u7528\u81f3\u5173\u91cd\u8981\u3002</p>\n<h3 id=\"231\">2.3.1 \u978d\u70b9\u95ee\u9898\u7684\u672c\u8d28</h3>\n<p><strong>\u978d\u70b9\u5b9a\u4e49</strong>\uff1a\u70b9 $\\mathbf{x}^*$ \u662f\u978d\u70b9\u5982\u679c $\\nabla f(\\mathbf{x}^*) = 0$ \u4e14Hessian $\\mathbf{H}(\\mathbf{x}^*)$ \u6709\u81f3\u5c11\u4e00\u4e2a\u8d1f\u7279\u5f81\u503c\u3002</p>\n<p><strong>\u5728\u9ad8\u7ef4\u7a7a\u95f4\u7684\u666e\u904d\u6027</strong>\uff1a</p>\n<ul>\n<li>\u968f\u673a\u77e9\u9635\u7406\u8bba\u8868\u660e\uff0c\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u978d\u70b9\u8fdc\u591a\u4e8e\u5c40\u90e8\u6781\u5c0f\u503c</li>\n<li>\u5bf9\u4e8e\u968f\u673a\u9ad8\u65af\u51fd\u6570\uff0c\u978d\u70b9\u4e0e\u5c40\u90e8\u6781\u5c0f\u503c\u7684\u6bd4\u4f8b\u968f\u7ef4\u5ea6\u6307\u6570\u589e\u957f</li>\n<li>\u6df1\u5ea6\u7f51\u7edc\u7684\u635f\u5931\u666f\u89c2\u4e3b\u8981\u7531\u978d\u70b9\u800c\u975e\u5c40\u90e8\u6781\u5c0f\u503c\u4e3b\u5bfc</li>\n</ul>\n<p><strong>\u978d\u70b9\u7684\u7c7b\u578b</strong>\uff1a</p>\n<ol>\n<li><strong>\u4e25\u683c\u978d\u70b9</strong>\uff1a\u81f3\u5c11\u6709\u4e00\u4e2a\u7279\u5f81\u503c $\\lambda &lt; -\\epsilon &lt; 0$</li>\n<li><strong>\u9000\u5316\u978d\u70b9</strong>\uff1a\u6700\u5c0f\u7279\u5f81\u503c\u63a5\u8fd1\u96f6</li>\n<li><strong>\u9ad8\u9636\u978d\u70b9</strong>\uff1a\u4e00\u9636\u548c\u4e8c\u9636\u5bfc\u6570\u90fd\u4e3a\u96f6</li>\n</ol>\n<p><strong>\u9003\u9038\u7684\u5fc5\u8981\u6027</strong>\uff1a</p>\n<ul>\n<li>\u4e00\u9636\u65b9\u6cd5\u5728\u978d\u70b9\u9644\u8fd1\u6536\u655b\u6781\u6162</li>\n<li>\u53ef\u80fd\u957f\u65f6\u95f4\u505c\u6ede\u5728\u6b21\u4f18\u89e3</li>\n<li>\u8d1f\u66f2\u7387\u65b9\u5411\u63d0\u4f9b\u4e86\u5feb\u901f\u4e0b\u964d\u7684\u8def\u5f84</li>\n</ul>\n<h3 id=\"232-lanczos\">2.3.2 Lanczos\u7b97\u6cd5\u4e0e\u6700\u5c0f\u7279\u5f81\u503c\u4f30\u8ba1</h3>\n<p>Lanczos\u7b97\u6cd5\u662f\u8ba1\u7b97\u5927\u89c4\u6a21\u5bf9\u79f0\u77e9\u9635\u6781\u7aef\u7279\u5f81\u503c\u7684\u6709\u6548\u65b9\u6cd5\uff1a</p>\n<p><strong>\u7b97\u6cd5\u6d41\u7a0b</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u8f93\u5165\uff1a\u5bf9\u79f0\u77e9\u9635 H (\u901a\u8fc7 H*v \u8bbf\u95ee), \u521d\u59cb\u5411\u91cf v_0\n\u8f93\u51fa\uff1a\u4e09\u5bf9\u89d2\u77e9\u9635 T_k, \u6b63\u4ea4\u57fa V_k\n\nv_1 = v_0 / ||v_0||\nfor j = 1 to k:\n    w = H <span class=\"gs\">* v_j</span>\n<span class=\"gs\">    \u03b1_j = v_j^T *</span> w\n    w = w - \u03b1_j <span class=\"gs\">* v_j - \u03b2_{j-1} *</span> v_{j-1}  (\u03b2_0 = 0)\n    \u03b2_j = ||w||\n    v_{j+1} = w / \u03b2_j\n</code></pre></div>\n\n<p><strong>\u4e09\u5bf9\u89d2\u77e9\u9635</strong>\uff1a\n$$\\mathbf{T}_k = \\begin{bmatrix}\n\\alpha_1 &amp; \\beta_1 &amp; &amp; \\\n\\beta_1 &amp; \\alpha_2 &amp; \\beta_2 &amp; \\\n&amp; \\beta_2 &amp; \\ddots &amp; \\beta_{k-1} \\\n&amp; &amp; \\beta_{k-1} &amp; \\alpha_k\n\\end{bmatrix}$$\n<strong>\u5173\u952e\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li>$\\mathbf{T}_k$ \u7684\u7279\u5f81\u503c\uff08Ritz\u503c\uff09\u8fd1\u4f3c $\\mathbf{H}$ \u7684\u6781\u7aef\u7279\u5f81\u503c</li>\n<li>\u901a\u5e38 10-30 \u6b21\u8fed\u4ee3\u5c31\u80fd\u5f97\u5230\u597d\u7684\u8fd1\u4f3c</li>\n<li>\u53ef\u4ee5\u540c\u65f6\u4f30\u8ba1\u6700\u5c0f\u548c\u6700\u5927\u7279\u5f81\u503c</li>\n</ul>\n<p><strong>\u7528\u4e8e\u8d1f\u66f2\u7387\u68c0\u6d4b</strong>\uff1a</p>\n<ol>\n<li>\u8fd0\u884cLanczos\u7b97\u6cd5 k \u6b65</li>\n<li>\u8ba1\u7b97 $\\mathbf{T}_k$ \u7684\u6700\u5c0f\u7279\u5f81\u503c $\\theta_{min}$ \u548c\u5bf9\u5e94\u7279\u5f81\u5411\u91cf $\\mathbf{y}$</li>\n<li>\u5982\u679c $\\theta_{min} &lt; -\\epsilon$\uff0c\u8d1f\u66f2\u7387\u65b9\u5411\u4e3a $\\mathbf{d} = \\mathbf{V}_k \\mathbf{y}$</li>\n</ol>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528\u5b8c\u5168\u6b63\u4ea4\u5316\u907f\u514d\u7cbe\u5ea6\u635f\u5931</li>\n<li>\u76d1\u63a7\u6b63\u4ea4\u6027\uff1a$|\\mathbf{v}_i^T \\mathbf{v}_j| &lt; \\epsilon$</li>\n<li>\u8003\u8651\u5757Lanczos\u53d8\u4f53\u63d0\u9ad8\u9c81\u68d2\u6027</li>\n</ul>\n<h3 id=\"233\">2.3.3 \u968f\u673a\u5316\u65b9\u6cd5\uff1a\u52a0\u901f\u9003\u9038\u978d\u70b9</h3>\n<p>\u968f\u673a\u5316\u6280\u672f\u53ef\u4ee5\u663e\u8457\u52a0\u901f\u978d\u70b9\u9003\u9038\uff1a</p>\n<p><strong>1. \u968f\u673a\u6270\u52a8\u65b9\u6cd5</strong>\uff1a\n- \u5f53\u68af\u5ea6\u8303\u6570\u5c0f\u4e8e\u9608\u503c\u65f6\uff0c\u6dfb\u52a0\u968f\u673a\u566a\u58f0\n- \u7406\u8bba\u4fdd\u8bc1\uff1a\u4ee5\u9ad8\u6982\u7387\u9003\u79bb\u4e25\u683c\u978d\u70b9\n- \u566a\u58f0\u5c3a\u5ea6\uff1a$\\mathcal{N}(0, \\sigma^2 \\mathbf{I})$\uff0c\u5176\u4e2d $\\sigma \\propto \\sqrt{\\epsilon/d}$</p>\n<p><strong>2. \u968f\u673a\u5316Lanczos</strong>\uff1a\n- \u4f7f\u7528\u591a\u4e2a\u968f\u673a\u8d77\u59cb\u5411\u91cf\n- \u5e76\u884c\u8ba1\u7b97\u63d0\u9ad8\u6548\u7387\n- \u66f4\u9c81\u68d2\u5730\u627e\u5230\u8d1f\u66f2\u7387\u65b9\u5411</p>\n<p><strong>3. Oja's\u7b97\u6cd5\u53d8\u4f53</strong>\uff1a\n\u5728\u7ebf\u4f30\u8ba1\u6700\u5c0f\u7279\u5f81\u5411\u91cf\uff1a\n$$\\mathbf{v}_{t+1} = \\mathbf{v}_t - \\eta_t (\\mathbf{H} \\mathbf{v}_t + \\lambda_t \\mathbf{v}_t)$$\n\u5176\u4e2d $\\lambda_t$ \u662f\u5f53\u524d\u7279\u5f81\u503c\u4f30\u8ba1\u3002</p>\n<p><strong>4. \u52a0\u901f\u65b9\u6cd5</strong>\uff1a\nAccelerated Gradient Descent with Negative Curvature (AGD+NC)\uff1a</p>\n<ul>\n<li>\u7ed3\u5408Nesterov\u52a0\u901f\u548c\u8d1f\u66f2\u7387\u5229\u7528</li>\n<li>\u7406\u8bba\u6536\u655b\u7387\uff1a$O(\\epsilon^{-7/4})$ vs \u6807\u51c6GD\u7684 $O(\\epsilon^{-2})$</li>\n</ul>\n<p><strong>\u5b9e\u8df5\u6280\u5de7</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u9009\u62e9\u68c0\u6d4b\u9891\u7387</li>\n<li>\u4f7f\u7528warm-start\u51cf\u5c11\u8ba1\u7b97</li>\n<li>\u7ed3\u5408\u4e00\u9636\u4fe1\u606f\u5224\u65ad\u662f\u5426\u9700\u8981\u4e8c\u9636\u4fe1\u606f</li>\n</ul>\n<h3 id=\"234-trust-region\">2.3.4 Trust Region\u6846\u67b6\u4e0b\u7684\u8d1f\u66f2\u7387\u5229\u7528</h3>\n<p>Trust Region\u65b9\u6cd5\u63d0\u4f9b\u4e86\u5229\u7528\u8d1f\u66f2\u7387\u7684\u539f\u5219\u6027\u6846\u67b6\uff1a</p>\n<p><strong>\u5b50\u95ee\u9898</strong>\uff1a\n$$\\min_{|\\mathbf{d}| \\leq \\Delta} m_k(\\mathbf{d}) = f_k + \\mathbf{g}_k^T \\mathbf{d} + \\frac{1}{2} \\mathbf{d}^T \\mathbf{H}_k \\mathbf{d}$$\n<strong>Mor\u00e9-Sorensen\u7b97\u6cd5</strong>\uff1a\n\u7cbe\u786e\u6c42\u89e3trust region\u5b50\u95ee\u9898\uff1a</p>\n<ol>\n<li>\u5982\u679c $\\mathbf{H}_k \\succeq 0$ \u4e14 $|\\mathbf{H}_k^{-1} \\mathbf{g}_k| \\leq \\Delta$\uff1a$\\mathbf{d}^* = -\\mathbf{H}_k^{-1} \\mathbf{g}_k$</li>\n<li>\u5426\u5219\uff0c\u5bfb\u627e $\\lambda \\geq 0$ \u4f7f\u5f97\uff1a\n   - $(\\mathbf{H}_k + \\lambda \\mathbf{I}) \\mathbf{d} = -\\mathbf{g}_k$\n   - $|\\mathbf{d}| = \\Delta$ \uff08\u5982\u679c\u7ea6\u675f\u6d3b\u8dc3\uff09\n   - $\\mathbf{H}_k + \\lambda \\mathbf{I} \\succeq 0$</li>\n</ol>\n<p><strong>\u8d1f\u66f2\u7387\u7684\u5229\u7528</strong>\uff1a\n\u5f53 $\\mathbf{H}_k$ \u6709\u8d1f\u7279\u5f81\u503c\u65f6\uff1a</p>\n<ul>\n<li>\u5982\u679c\u68af\u5ea6\u5728\u8d1f\u66f2\u7387\u65b9\u5411\u6709\u5206\u91cf\uff0c\u81ea\u7136\u5229\u7528</li>\n<li>\u5426\u5219\uff0c\u6cbf\u6700\u5c0f\u7279\u5f81\u5411\u91cf\u79fb\u52a8\u5230\u8fb9\u754c</li>\n<li>\u4fdd\u8bc1\u76ee\u6807\u51fd\u6570\u7684\u5145\u5206\u4e0b\u964d</li>\n</ul>\n<p><strong>\u4e24\u9636\u6bb5\u65b9\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u9636\u6bb51\uff1a\u8ba1\u7b97Cauchy\u70b9\nd_c = -\u03b1_c g_k, where \u03b1_c = argmin_{\u03b1} m_k(-\u03b1 g_k)\n\n\u9636\u6bb52\uff1a\u4eceCauchy\u70b9\u51fa\u53d1\uff0c\u5bfb\u627e\u66f4\u597d\u7684\u89e3\n\u4f7f\u7528CG\u6216Lanczos\u5728\u5b50\u7a7a\u95f4\u4e2d\u4f18\u5316\n\u5982\u679c\u9047\u5230\u8d1f\u66f2\u7387\uff0c\u6cbf\u8be5\u65b9\u5411\u5230\u8fb9\u754c\n</code></pre></div>\n\n<p><strong>\u6536\u655b\u6027\u4fdd\u8bc1</strong>\uff1a</p>\n<ul>\n<li>\u5168\u5c40\u6536\u655b\u5230\u4e8c\u9636\u5fc5\u8981\u6761\u4ef6</li>\n<li>\u5c40\u90e8\u4e8c\u6b21\u6536\u655b\uff08\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\uff09</li>\n<li>\u5bf9\u975e\u51f8\u95ee\u9898\u7684\u9c81\u68d2\u6027</li>\n</ul>\n<h3 id=\"235\">2.3.5 \u5728\u975e\u51f8\u4f18\u5316\u4e2d\u7684\u7406\u8bba\u4fdd\u8bc1</h3>\n<p>\u5229\u7528\u8d1f\u66f2\u7387\u53ef\u4ee5\u83b7\u5f97\u66f4\u5f3a\u7684\u7406\u8bba\u4fdd\u8bc1\uff1a</p>\n<p><strong>1. \u4e8c\u9636\u5fc5\u8981\u6761\u4ef6</strong>\uff1a\n\u5c40\u90e8\u6781\u5c0f\u503c $\\mathbf{x}^*$ \u5fc5\u987b\u6ee1\u8db3\uff1a</p>\n<ul>\n<li>$\\nabla f(\\mathbf{x}^*) = 0$ \uff08\u4e00\u9636\u6761\u4ef6\uff09</li>\n<li>$\\nabla^2 f(\\mathbf{x}^*) \\succeq 0$ \uff08\u4e8c\u9636\u6761\u4ef6\uff09</li>\n</ul>\n<p><strong>2. \u9003\u9038\u978d\u70b9\u7684\u590d\u6742\u5ea6</strong>\uff1a</p>\n<p><strong>Cubic Regularization</strong>\uff1a\n$$\\min_{\\mathbf{d}} f_k + \\mathbf{g}_k^T \\mathbf{d} + \\frac{1}{2} \\mathbf{d}^T \\mathbf{H}_k \\mathbf{d} + \\frac{\\sigma}{3} |\\mathbf{d}|^3$$</p>\n<ul>\n<li>\u8fed\u4ee3\u590d\u6742\u5ea6\uff1a$O(\\epsilon^{-3/2})$ \u5230\u4e8c\u9636\u9a7b\u70b9</li>\n<li>\u81ea\u9002\u5e94\u9009\u62e9 $\\sigma$ \u53c2\u6570</li>\n</ul>\n<p><strong>\u5e26\u8d1f\u66f2\u7387\u7684\u52a0\u901f\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>SPIDER-SFO+\uff1a$O(\\epsilon^{-3})$ \u6837\u672c\u590d\u6742\u5ea6</li>\n<li>SARAH-SOTA\uff1a\u6539\u8fdb\u7684\u65b9\u5dee\u7f29\u51cf\u6280\u672f</li>\n</ul>\n<p><strong>3. \u968f\u673a\u7b97\u6cd5\u7684\u4fdd\u8bc1</strong>\uff1a</p>\n<p><strong>Perturbed GD (PGD)</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>if ||\u2207f(x_t)|| \u2264 \u03b5:\n    x_{t+1} = x_t + \u03be_t,  \u03be_t ~ N(0, \u03c3\u00b2I)\nelse:\n    x_{t+1} = x_t - \u03b7\u2207f(x_t)\n</code></pre></div>\n\n<ul>\n<li>\u4ee5 $1-\\delta$ \u6982\u7387\u9003\u79bb\u978d\u70b9</li>\n<li>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\tilde{O}(\\log(d/\\delta)/\\epsilon^4)$</li>\n</ul>\n<p><strong>4. \u666f\u89c2\u5206\u6790</strong>\uff1a</p>\n<p><strong>\u4e25\u683c\u978d\u70b9\u6027\u8d28</strong>\uff1a\n\u8bb8\u591a\u673a\u5668\u5b66\u4e60\u95ee\u9898\u6ee1\u8db3\u4e25\u683c\u978d\u70b9\u6027\u8d28\uff1a</p>\n<ul>\n<li>\u6240\u6709\u978d\u70b9\u90fd\u662f\u4e25\u683c\u7684\uff08\u6709\u8d1f\u66f2\u7387\uff09</li>\n<li>\u6240\u6709\u5c40\u90e8\u6781\u5c0f\u503c\u90fd\u662f\u5168\u5c40\u6700\u4f18</li>\n<li>\u4f8b\u5982\uff1a\u77e9\u9635\u8865\u5168\u3001\u76f8\u4f4d\u6062\u590d\u3001\u67d0\u4e9b\u795e\u7ecf\u7f51\u7edc</li>\n</ul>\n<p><strong>Polyak-\u0141ojasiewicz (PL) \u6761\u4ef6</strong>\uff1a\n$$|\\nabla f(\\mathbf{x})|^2 \\geq 2\\mu (f(\\mathbf{x}) - f^*)$$</p>\n<ul>\n<li>\u6bd4\u5f3a\u51f8\u6027\u5f31\uff0c\u4f46\u4fdd\u8bc1\u7ebf\u6027\u6536\u655b</li>\n<li>\u5728\u978d\u70b9\u9644\u8fd1\u53ef\u80fd\u4e0d\u6ee1\u8db3\uff0c\u9700\u8981\u8d1f\u66f2\u7387</li>\n</ul>\n<p><strong>\u7814\u7a76\u524d\u6cbf</strong>\uff1a</p>\n<ul>\n<li>\u9ad8\u9636\u65b9\u6cd5\uff08\u5229\u7528\u4e09\u9636\u4fe1\u606f\uff09</li>\n<li>\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u8d1f\u66f2\u7387\u68c0\u6d4b</li>\n<li>\u4e0e\u73b0\u4ee3\u6df1\u5ea6\u5b66\u4e60\u4f18\u5316\u5668\u7684\u96c6\u6210</li>\n<li>\u9690\u5f0f\u504f\u5dee\u4e0e\u8d1f\u66f2\u7387\u7684\u5173\u7cfb</li>\n</ul>\n<h3 id=\"236\">2.3.6 \u73b0\u4ee3\u8d1f\u66f2\u7387\u5229\u7528\u7b97\u6cd5</h3>\n<p><strong>1. Negative Curvature Descent (NCD)</strong>\uff1a</p>\n<p>\u7ed3\u5408\u68af\u5ea6\u4e0b\u964d\u548c\u8d1f\u66f2\u7387\u65b9\u5411\u7684\u6df7\u5408\u7b97\u6cd5\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>if \u03bb_min(H) &lt; -\u03b5:\n    d = \u03b1_g <span class=\"gs\">* (-g) + \u03b1_n *</span> v_min  # \u6df7\u5408\u65b9\u5411\nelse:\n    d = -g  # \u7eaf\u68af\u5ea6\u65b9\u5411\n</code></pre></div>\n\n<p>\u5176\u4e2d\u6743\u91cd $\\alpha_g, \\alpha_n$ \u6839\u636e\u66f2\u7387\u5f3a\u5ea6\u81ea\u9002\u5e94\u8c03\u6574\u3002</p>\n<p><strong>\u7406\u8bba\u521b\u65b0</strong>\uff1a</p>\n<ul>\n<li>\u7edf\u4e00\u6846\u67b6\u5904\u7406\u51f8\u548c\u975e\u51f8\u533a\u57df</li>\n<li>\u81ea\u9002\u5e94\u6df7\u5408\u7cfb\u6570\u7684\u6700\u4f18\u9009\u62e9</li>\n<li>\u4e0e\u52a8\u91cf\u65b9\u6cd5\u7684\u534f\u540c\u6548\u5e94</li>\n</ul>\n<p><strong>2. Hessian-Free Newton with Negative Curvature</strong>\uff1a</p>\n<p>\u5229\u7528CG\u6c42\u89e3\u5668\u7684\u65e9\u505c\u7279\u6027\u81ea\u7136\u68c0\u6d4b\u8d1f\u66f2\u7387\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">CG\u8fed\u4ee3\u4e2d</span><span class=\"err\">\uff1a</span>\n<span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">^</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"mh\">0</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"p\">#</span><span class=\"w\"> </span><span class=\"err\">\u68c0\u6d4b\u5230\u8d1f\u66f2\u7387</span>\n<span class=\"w\">    </span><span class=\"err\">\u6cbf</span><span class=\"n\">p\u65b9\u5411\u5230trust</span><span class=\"w\"> </span><span class=\"n\">region\u8fb9\u754c</span>\n<span class=\"w\">    </span><span class=\"err\">\u63d0\u524d\u7ec8\u6b62</span><span class=\"n\">CG</span>\n</code></pre></div>\n\n<p><strong>\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u65e0\u9700\u989d\u5916\u7684\u7279\u5f81\u503c\u8ba1\u7b97</li>\n<li>\u4e0eNewton\u65b9\u5411\u8ba1\u7b97\u65e0\u7f1d\u96c6\u6210</li>\n<li>\u8ba1\u7b97\u6210\u672c\u51e0\u4e4e\u4e0d\u589e\u52a0</li>\n</ul>\n<p><strong>3. \u968f\u673a\u8d1f\u66f2\u7387\u65b9\u6cd5\u7684\u6700\u65b0\u8fdb\u5c55</strong>\uff1a</p>\n<p><strong>SGLD with Negative Curvature</strong>\uff1a\n\u5c06\u968f\u673a\u68af\u5ea6Langevin\u52a8\u529b\u5b66\u4e0e\u8d1f\u66f2\u7387\u7ed3\u5408\uff1a\n$$x_{t+1} = x_t - \\eta_t(\\nabla f(x_t) + \\epsilon_t) + \\sqrt{2\\eta_t/\\beta}\\xi_t - \\gamma_t \\lambda_{min}v_{min}$$\n\u5176\u4e2d $\\xi_t \\sim \\mathcal{N}(0, I)$ \u662f\u566a\u58f0\u9879\uff0c\u6700\u540e\u4e00\u9879\u662f\u8d1f\u66f2\u7387\u6821\u6b63\u3002</p>\n<p><strong>\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u7406\u8bba\u4e0a\u4fdd\u8bc1\u6536\u655b\u5230\u5168\u5c40\u6700\u4f18\u7684\u90bb\u57df</li>\n<li>\u81ea\u7136\u7684\u63a2\u7d22-\u5229\u7528\u5e73\u8861</li>\n<li>\u4e0e\u8d1d\u53f6\u65af\u63a8\u65ad\u7684\u8054\u7cfb</li>\n</ul>\n<h3 id=\"237\">2.3.7 \u6df1\u5ea6\u5b66\u4e60\u4e2d\u7684\u5b9e\u8df5\u521b\u65b0</h3>\n<p><strong>1. \u5c42\u7ea7\u8d1f\u66f2\u7387\u68c0\u6d4b</strong>\uff1a</p>\n<p>\u4e0d\u540c\u7f51\u7edc\u5c42\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u66f2\u7387\u7279\u6027\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>for layer in network.layers:\n    H_layer = compute_layer_hessian()\n    \u03bb_min, v_min = power_method(H_layer, k=10)\n    if \u03bb_min &lt; -threshold:\n        apply_negative_curvature_update(layer, v_min)\n</code></pre></div>\n\n<p><strong>\u53d1\u73b0</strong>\uff1a</p>\n<ul>\n<li>\u6df1\u5c42\u5f80\u5f80\u6709\u66f4\u591a\u8d1f\u66f2\u7387</li>\n<li>BatchNorm\u5c42\u540e\u8d1f\u66f2\u7387\u51cf\u5c11</li>\n<li>\u6b8b\u5dee\u8fde\u63a5\u6539\u53d8\u66f2\u7387\u5206\u5e03</li>\n</ul>\n<p><strong>2. \u8d1f\u66f2\u7387\u4e0e\u6cdb\u5316\u7684\u8054\u7cfb</strong>\uff1a</p>\n<p><strong>\u5e73\u5766\u5ea6\u611f\u77e5\u7684\u8d1f\u66f2\u7387\u5229\u7528</strong>\uff1a</p>\n<ul>\n<li>\u907f\u514d\u8fc7\u5ea6\u5229\u7528\u53ef\u80fd\u5bfc\u81f4\u5c16\u9510\u6781\u5c0f\u503c\u7684\u8d1f\u66f2\u7387</li>\n<li>\u7ed3\u5408SAM (Sharpness Aware Minimization)</li>\n<li>\u5e73\u8861\u8bad\u7ec3\u901f\u5ea6\u548c\u6cdb\u5316\u6027\u80fd</li>\n</ul>\n<p><strong>\u5b9e\u8bc1\u89c2\u5bdf</strong>\uff1a</p>\n<ul>\n<li>\u9002\u5ea6\u7684\u8d1f\u66f2\u7387\u5229\u7528\u6539\u5584\u6cdb\u5316</li>\n<li>\u8fc7\u5ea6\u9003\u9038\u53ef\u80fd\u635f\u5bb3\u7a33\u5b9a\u6027</li>\n<li>\u4e0e\u6570\u636e\u589e\u5f3a\u7684\u4ea4\u4e92\u6548\u5e94</li>\n</ul>\n<p><strong>3. \u9ad8\u6548\u5b9e\u73b0\u6280\u5de7</strong>\uff1a</p>\n<p><strong>GPU\u53cb\u597d\u7684Lanczos\u5b9e\u73b0</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">// \u5229\u7528cuSPARSE for HVP</span>\n<span class=\"c1\">// \u6279\u91cf\u5904\u7406\u591a\u4e2a\u968f\u673a\u5411\u91cf</span>\n<span class=\"c1\">// Warp-level\u539f\u8bed\u4f18\u5316</span>\n<span class=\"n\">cublasHandle_t</span><span class=\"w\"> </span><span class=\"n\">handle</span><span class=\"p\">;</span>\n<span class=\"n\">cusparseHandle_t</span><span class=\"w\"> </span><span class=\"n\">sparseHandle</span><span class=\"p\">;</span>\n<span class=\"c1\">// ... GPU\u4f18\u5316\u7684Lanczos\u8fed\u4ee3</span>\n</code></pre></div>\n\n<p><strong>\u6df7\u5408\u7cbe\u5ea6\u8003\u8651</strong>\uff1a</p>\n<ul>\n<li>Lanczos\u4e3b\u5faa\u73af\u4f7f\u7528FP32</li>\n<li>HVP\u8ba1\u7b97\u53ef\u7528FP16/BF16</li>\n<li>\u7279\u5f81\u503c\u7528FP64\u9a8c\u8bc1</li>\n</ul>\n<h3 id=\"238\">2.3.8 \u7406\u8bba\u6df1\u5316\uff1a\u51e0\u4f55\u89c6\u89d2</h3>\n<p><strong>\u83ab\u5c14\u65af\u7406\u8bba\u4e0e\u978d\u70b9</strong>\uff1a</p>\n<p><strong>\u4e34\u754c\u70b9\u7684\u62d3\u6251\u7279\u5f81</strong>\uff1a</p>\n<ul>\n<li>Index\u5b9a\u7406\uff1a\u8d1f\u7279\u5f81\u503c\u4e2a\u6570\u51b3\u5b9a\u978d\u70b9\u7c7b\u578b</li>\n<li>Morse\u5f15\u7406\uff1a\u5c40\u90e8\u6807\u51c6\u5f62\u5f0f</li>\n<li>\u4e0e\u6301\u7eed\u540c\u8c03\u7684\u8054\u7cfb</li>\n</ul>\n<p><strong>\u8fde\u901a\u6027\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u4e0d\u540c\u6781\u5c0f\u503c\u901a\u8fc7\u978d\u70b9\u8fde\u63a5</li>\n<li>Mode connectivity\u7684\u5b9a\u91cf\u523b\u753b</li>\n<li>\u5bf9\u4f18\u5316\u8def\u5f84\u7684\u542f\u793a</li>\n</ul>\n<p><strong>\u52a8\u529b\u7cfb\u7edf\u89c6\u89d2</strong>\uff1a</p>\n<p><strong>\u68af\u5ea6\u6d41\u7684\u7a33\u5b9a\u6027\u5206\u6790</strong>\uff1a\n$$\\frac{dx}{dt} = -\\nabla f(x)$$\n\u978d\u70b9\u662f\u4e0d\u7a33\u5b9a\u5e73\u8861\u70b9\uff1a</p>\n<ul>\n<li>\u7a33\u5b9a\u6d41\u5f62\uff1a\u6b63\u7279\u5f81\u503c\u5bf9\u5e94\u65b9\u5411</li>\n<li>\u4e0d\u7a33\u5b9a\u6d41\u5f62\uff1a\u8d1f\u7279\u5f81\u503c\u5bf9\u5e94\u65b9\u5411</li>\n<li>\u4e2d\u5fc3\u6d41\u5f62\uff1a\u96f6\u7279\u5f81\u503c\u60c5\u51b5</li>\n</ul>\n<p><strong>\u5206\u5c94\u7406\u8bba\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>\u53c2\u6570\u53d8\u5316\u5982\u4f55\u5f71\u54cd\u978d\u70b9</li>\n<li>\u4f18\u5316\u8f68\u8ff9\u7684\u5b9a\u6027\u53d8\u5316</li>\n<li>\u4e0ecatastrophe\u7406\u8bba\u7684\u8054\u7cfb</li>\n</ul>\n<h3 id=\"239\">2.3.9 \u524d\u6cbf\u7814\u7a76\u65b9\u5411</h3>\n<p><strong>1. \u9ad8\u9636\u4fe1\u606f\u7684\u5229\u7528</strong>\uff1a</p>\n<p><strong>\u4e09\u9636\u5bfc\u6570\u4e0e\u9003\u9038\u901f\u5ea6</strong>\uff1a\n\u8003\u8651\u4e09\u9636\u9879\u7684\u5f71\u54cd\uff1a\n$$f(x + d) \\approx f(x) + g^Td + \\frac{1}{2}d^THd + \\frac{1}{6}\\sum_{ijk}T_{ijk}d_id_jd_k$$\n\u7814\u7a76\u8868\u660e\u4e09\u9636\u4fe1\u606f\u53ef\u4ee5\uff1a</p>\n<ul>\n<li>\u52a0\u901f\u978d\u70b9\u9003\u9038</li>\n<li>\u63d0\u4f9b\u66f4\u597d\u7684\u4e0b\u964d\u65b9\u5411</li>\n<li>\u6539\u5584\u6536\u655b\u901f\u5ea6\u754c</li>\n</ul>\n<p><strong>2. \u5206\u5e03\u5f0f\u8d1f\u66f2\u7387\u68c0\u6d4b</strong>\uff1a</p>\n<p><strong>\u8054\u90a6\u5b66\u4e60\u4e2d\u7684\u6311\u6218</strong>\uff1a</p>\n<ul>\n<li>\u9690\u79c1\u4fdd\u62a4\u7684\u7279\u5f81\u503c\u8ba1\u7b97</li>\n<li>\u5f02\u6b65\u73af\u5883\u4e0b\u7684\u4e00\u81f4\u6027</li>\n<li>\u901a\u4fe1\u9ad8\u6548\u7684\u7b97\u6cd5\u8bbe\u8ba1</li>\n</ul>\n<p><strong>\u65b0\u65b9\u6cd5</strong>\uff1a</p>\n<ul>\n<li>\u5b89\u5168\u591a\u65b9\u8ba1\u7b97\u534f\u8bae</li>\n<li>\u5dee\u5206\u9690\u79c1\u7684Lanczos</li>\n<li>\u53bb\u4e2d\u5fc3\u5316\u7684\u5171\u8bc6\u7b97\u6cd5</li>\n</ul>\n<p><strong>3. \u4e0e\u73b0\u4ee3AI\u7684\u7ed3\u5408</strong>\uff1a</p>\n<p><strong>Transformer\u67b6\u6784\u7684\u7279\u6b8a\u6027</strong>\uff1a</p>\n<ul>\n<li>\u6ce8\u610f\u529b\u673a\u5236\u5f15\u5165\u7684\u66f2\u7387\u7ed3\u6784</li>\n<li>\u4f4d\u7f6e\u7f16\u7801\u7684\u5f71\u54cd</li>\n<li>\u5927\u89c4\u6a21\u9884\u8bad\u7ec3\u7684\u542f\u793a</li>\n</ul>\n<p><strong>\u751f\u6210\u6a21\u578b\u4e2d\u7684\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>GAN\u8bad\u7ec3\u7684\u978d\u70b9\u95ee\u9898</li>\n<li>\u6269\u6563\u6a21\u578b\u7684score matching</li>\n<li>VAE\u7684\u540e\u9a8c\u8fd1\u4f3c</li>\n</ul>\n<p><strong>4. \u7406\u8bba\u7a81\u7834\u65b9\u5411</strong>\uff1a</p>\n<p><strong>\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>\u975e\u5149\u6ed1\u51fd\u6570\u7684\"\u5e7f\u4e49\u8d1f\u66f2\u7387\"\u5b9a\u4e49</li>\n<li>\u968f\u673a\u8bbe\u7f6e\u4e0b\u7684\u6700\u4f18\u590d\u6742\u5ea6\u754c</li>\n<li>\u4e0e\u91cf\u5b50\u4f18\u5316\u7684\u6df1\u5c42\u8054\u7cfb</li>\n<li>\u795e\u7ecf\u7f51\u7edc\u7279\u5b9a\u7684\u66f2\u7387\u7406\u8bba</li>\n</ol>\n<p><strong>\u65b0\u5de5\u5177\u5f00\u53d1</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u52a8\u8d1f\u66f2\u7387\u68c0\u6d4b\u5e93</li>\n<li>\u786c\u4ef6\u52a0\u901f\u7684\u7279\u5f81\u503c\u7b97\u6cd5</li>\n<li>\u53ef\u5fae\u5206\u7684\u4e8c\u9636\u4f18\u5316\u5668</li>\n<li>\u7406\u8bba\u6307\u5bfc\u7684\u8d85\u53c2\u6570\u9009\u62e9</li>\n</ul>\n<h2 id=\"24\">2.4 \u6570\u503c\u7a33\u5b9a\u6027\u4e0e\u6761\u4ef6\u6570\u63a7\u5236</h2>\n<p>Hessian\u8fd1\u4f3c\u7684\u6570\u503c\u7a33\u5b9a\u6027\u76f4\u63a5\u5f71\u54cd\u4f18\u5316\u7b97\u6cd5\u7684\u53ef\u9760\u6027\u548c\u6536\u655b\u6027\u3002\u672c\u8282\u63a2\u8ba8\u5982\u4f55\u8bc6\u522b\u548c\u7f13\u89e3\u6570\u503c\u95ee\u9898\uff0c\u8bbe\u8ba1\u9c81\u68d2\u7684\u7b97\u6cd5\u3002</p>\n<h3 id=\"241\">2.4.1 \u6761\u4ef6\u6570\u6076\u5316\u7684\u6839\u6e90\u5206\u6790</h3>\n<p><strong>\u6761\u4ef6\u6570\u5b9a\u4e49</strong>\uff1a\n$$\\kappa(\\mathbf{H}) = \\frac{\\lambda_{max}(\\mathbf{H})}{\\lambda_{min}(\\mathbf{H})} = |\\mathbf{H}| \\cdot |\\mathbf{H}^{-1}|$$\n<strong>\u6076\u5316\u6765\u6e90</strong>\uff1a</p>\n<p><strong>1. \u95ee\u9898\u56fa\u6709\u7684\u75c5\u6001\u6027</strong>\uff1a\n- \u53c2\u6570\u5c3a\u5ea6\u5dee\u5f02\u5de8\u5927\uff08\u5982\u795e\u7ecf\u7f51\u7edc\u4e0d\u540c\u5c42\uff09\n- \u9ad8\u5ea6\u76f8\u5173\u7684\u7279\u5f81\n- \u63a5\u8fd1\u5947\u5f02\u7684\u8bbe\u8ba1\u77e9\u9635</p>\n<p><strong>2. \u7b97\u6cd5\u5f15\u5165\u7684\u75c5\u6001\u6027</strong>\uff1a\n- BFGS\u66f4\u65b0\u53ef\u80fd\u7d2f\u79ef\u6570\u503c\u8bef\u5dee\n- \u6709\u9650\u7cbe\u5ea6\u7b97\u672f\u7684\u820d\u5165\u8bef\u5dee\n- \u4e0d\u9002\u5f53\u7684\u6b65\u957f\u9009\u62e9</p>\n<p><strong>3. \u8fd1\u4f3c\u5f15\u8d77\u7684\u95ee\u9898</strong>\uff1a\n- \u6709\u9650\u5dee\u5206\u8fd1\u4f3c\u7684\u6b65\u957f\u9009\u62e9\n- \u622a\u65ad\u8bef\u5deevs\u820d\u5165\u8bef\u5dee\u7684\u6743\u8861\n- \u4f4e\u79e9\u8fd1\u4f3c\u7684\u79e9\u4e0d\u8db3</p>\n<p><strong>\u8bca\u65ad\u5de5\u5177</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u6761\u4ef6\u6570\u4f30\u8ba1\uff08\u4e0d\u9700\u8981\u5b8c\u6574\u77e9\u9635\uff09\uff1a\n1. \u4f7f\u7528Lanczos\u4f30\u8ba1\u6781\u7aef\u7279\u5f81\u503c\n2. \u6761\u4ef6\u6570\u4f30\u8ba1\u5668\uff1aCONDEST\u7b97\u6cd5\n3. \u76d1\u63a7 ||H*v||/||v|| \u7684\u53d8\u5316\u8303\u56f4\n</code></pre></div>\n\n<p><strong>\u9884\u8b66\u4fe1\u53f7</strong>\uff1a</p>\n<ul>\n<li>L-BFGS\u4e2d $\\mathbf{y}_k^T \\mathbf{s}_k$ \u63a5\u8fd1\u96f6</li>\n<li>CG\u8fed\u4ee3\u6570\u6025\u5267\u589e\u52a0</li>\n<li>\u4f18\u5316\u6b65\u957f\u53d8\u5f97\u6781\u5c0f</li>\n<li>\u76ee\u6807\u51fd\u6570\u503c\u9707\u8361</li>\n</ul>\n<h3 id=\"242-levenberg-marquardt\">2.4.2 \u6b63\u5219\u5316\u6280\u672f\uff1aLevenberg-Marquardt\u963b\u5c3c</h3>\n<p>Levenberg-Marquardt (LM) \u65b9\u6cd5\u901a\u8fc7\u6dfb\u52a0\u963b\u5c3c\u9879\u6539\u5584\u6761\u4ef6\u6570\uff1a</p>\n<p><strong>\u57fa\u672c\u5f62\u5f0f</strong>\uff1a\n$$(\\mathbf{H} + \\lambda \\mathbf{I}) \\mathbf{d} = -\\mathbf{g}$$\n\u5176\u4e2d $\\lambda &gt; 0$ \u662f\u963b\u5c3c\u53c2\u6570\u3002</p>\n<p><strong>\u81ea\u9002\u5e94\u7b56\u7565</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u521d\u59cb\u5316\uff1a\u03bb = \u03bb_0\nrepeat:\n    \u6c42\u89e3 (H + \u03bbI)d = -g\n    \u8ba1\u7b97\u5b9e\u9645\u4e0b\u964d \u0394f_actual = f(x+d) - f(x)\n    \u8ba1\u7b97\u9884\u6d4b\u4e0b\u964d \u0394f_pred = -g^T d - 0.5 d^T H d\n    \u6bd4\u7387 \u03c1 = \u0394f_actual / \u0394f_pred\n\n    if \u03c1 &gt; 0.75:  # \u5f88\u597d\u7684\u8fd1\u4f3c\n        \u03bb = \u03bb / 2\n    elif \u03c1 &lt; 0.25:  # \u5dee\u7684\u8fd1\u4f3c\n        \u03bb = \u03bb * 2\n</code></pre></div>\n\n<p><strong>\u7406\u8bba\u6027\u8d28</strong>\uff1a</p>\n<ul>\n<li>\u6761\u4ef6\u6570\u6539\u5584\uff1a$\\kappa(\\mathbf{H} + \\lambda \\mathbf{I}) \\leq \\frac{\\lambda_{max} + \\lambda}{\\lambda_{min} + \\lambda} &lt; \\kappa(\\mathbf{H})$</li>\n<li>\u5f53 $\\lambda \\to \\infty$\uff1a\u9000\u5316\u4e3a\u68af\u5ea6\u4e0b\u964d</li>\n<li>\u5f53 $\\lambda \\to 0$\uff1a\u63a5\u8fd1\u725b\u987f\u6cd5</li>\n</ul>\n<p><strong>\u53d8\u4f53\u4e0e\u6269\u5c55</strong>\uff1a</p>\n<p><strong>1. \u81ea\u9002\u5e94\u5bf9\u89d2\u6b63\u5219\u5316</strong>\uff1a\n$$(\\mathbf{H} + \\mathbf{D}) \\mathbf{d} = -\\mathbf{g}$$\n\u5176\u4e2d $\\mathbf{D} = \\text{diag}(\\lambda_1, ..., \\lambda_n)$ \u6839\u636e\u53c2\u6570\u654f\u611f\u5ea6\u8c03\u6574\u3002</p>\n<p><strong>2. Trust Region\u8054\u7cfb</strong>\uff1a\nLM\u66f4\u65b0\u7b49\u4ef7\u4e8e\u6c42\u89e3\uff1a\n$$\\min_{\\mathbf{d}} \\mathbf{g}^T \\mathbf{d} + \\frac{1}{2} \\mathbf{d}^T \\mathbf{H} \\mathbf{d} \\quad \\text{s.t.} \\quad |\\mathbf{d}| \\leq \\Delta$$\n\u5176\u4e2d $\\lambda$ \u662fLagrange\u4e58\u5b50\u3002</p>\n<p><strong>3. \u6982\u7387\u89e3\u91ca</strong>\uff1a\n\u6dfb\u52a0 $\\lambda \\mathbf{I}$ \u76f8\u5f53\u4e8e\u5bf9\u53c2\u6570\u65bd\u52a0\u9ad8\u65af\u5148\u9a8c $\\mathcal{N}(0, \\lambda^{-1} \\mathbf{I})$\u3002</p>\n<h3 id=\"243\">2.4.3 \u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\u7684\u827a\u672f</h3>\n<p>\u9884\u6761\u4ef6\u5b50 $\\mathbf{M} \\approx \\mathbf{H}^{-1}$ \u53ef\u4ee5\u663e\u8457\u6539\u5584\u8fed\u4ee3\u65b9\u6cd5\u7684\u6536\u655b\u6027\uff1a</p>\n<p><strong>\u9884\u6761\u4ef6\u7cfb\u7edf</strong>\uff1a\n$$\\mathbf{M}^{-1} \\mathbf{H} \\mathbf{d} = -\\mathbf{M}^{-1} \\mathbf{g}$$\n<strong>\u8bbe\u8ba1\u539f\u5219</strong>\uff1a</p>\n<ol>\n<li><strong>\u6613\u4e8e\u8ba1\u7b97</strong>\uff1a$\\mathbf{M}\\mathbf{v}$ \u5e94\u8be5\u9ad8\u6548</li>\n<li><strong>\u826f\u597d\u8fd1\u4f3c</strong>\uff1a$\\mathbf{M}^{-1}\\mathbf{H} \\approx \\mathbf{I}$</li>\n<li><strong>\u6570\u503c\u7a33\u5b9a</strong>\uff1a\u4fdd\u6301\u6b63\u5b9a\u6027</li>\n<li><strong>\u5185\u5b58\u9ad8\u6548</strong>\uff1a\u7a00\u758f\u6216\u7ed3\u6784\u5316</li>\n</ol>\n<p><strong>\u5e38\u7528\u9884\u6761\u4ef6\u5b50</strong>\uff1a</p>\n<p><strong>1. \u5bf9\u89d2\u9884\u6761\u4ef6\uff08Jacobi\uff09</strong>\uff1a\n$$\\mathbf{M} = \\text{diag}(\\mathbf{H})^{-1}$$</p>\n<ul>\n<li>\u6700\u7b80\u5355\uff0c\u9002\u5408\u5bf9\u89d2\u5360\u4f18\u77e9\u9635</li>\n<li>\u53ef\u4ee5\u4f7f\u7528running average\u66f4\u65b0</li>\n</ul>\n<p><strong>2. \u4e0d\u5b8c\u5168Cholesky\u5206\u89e3</strong>\uff1a\n$$\\mathbf{H} \\approx \\mathbf{L}\\mathbf{L}^T, \\quad \\mathbf{M} = (\\mathbf{L}\\mathbf{L}^T)^{-1}$$</p>\n<ul>\n<li>\u63a7\u5236\u586b\u5145\u6c34\u5e73\u6743\u8861\u7cbe\u5ea6\u4e0e\u7a00\u758f\u6027</li>\n<li>IC(0): \u96f6\u586b\u5145\uff0cIC(k): k\u7ea7\u586b\u5145</li>\n</ul>\n<p><strong>3. BFGS\u4f5c\u4e3a\u9884\u6761\u4ef6\u5b50</strong>\uff1a\n\u4f7f\u7528L-BFGS\u8fd1\u4f3c\u4f5c\u4e3a\u9884\u6761\u4ef6\uff1a\n$$\\mathbf{M} = \\mathbf{H}_k^{LBFGS}$$</p>\n<ul>\n<li>\u81ea\u7136\u5730\u5305\u542b\u66f2\u7387\u4fe1\u606f</li>\n<li>\u53ef\u4ee5\u91cd\u7528\u5df2\u6709\u8ba1\u7b97</li>\n</ul>\n<p><strong>4. \u591a\u7ea7\u9884\u6761\u4ef6</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u7c97\u7f51\u683c\u6821\u6b63 + \u7ec6\u7f51\u683c\u5e73\u6ed1\nM^{-1} = S^T (I - P(P^T H P)^{-1} P^T H) S + P(P^T H P)^{-1} P^T\n</code></pre></div>\n\n<p>\u5176\u4e2d $\\mathbf{P}$ \u662f\u9650\u5236\u7b97\u5b50\uff0c$\\mathbf{S}$ \u662f\u5e73\u6ed1\u7b97\u5b50\u3002</p>\n<p><strong>\u81ea\u9002\u5e94\u9884\u6761\u4ef6</strong>\uff1a</p>\n<ul>\n<li>\u76d1\u63a7\u9884\u6761\u4ef6\u6548\u679c\uff1a$\\kappa(\\mathbf{M}^{-1}\\mathbf{H})$</li>\n<li>\u52a8\u6001\u66f4\u65b0\u7b56\u7565</li>\n<li>\u5747\u8861\u9884\u5904\u7406\u6210\u672c\u4e0e\u8fed\u4ee3\u6b21\u6570</li>\n</ul>\n<h3 id=\"244\">2.4.4 \u6570\u503c\u8bef\u5dee\u7684\u4f20\u64ad\u5206\u6790</h3>\n<p>\u7406\u89e3\u8bef\u5dee\u5982\u4f55\u5728Hessian\u8fd1\u4f3c\u4e2d\u4f20\u64ad\u5bf9\u8bbe\u8ba1\u9c81\u68d2\u7b97\u6cd5\u81f3\u5173\u91cd\u8981\uff1a</p>\n<p><strong>\u8bef\u5dee\u6765\u6e90</strong>\uff1a</p>\n<ol>\n<li><strong>\u820d\u5165\u8bef\u5dee</strong>\uff1a$fl(x \\pm y) = (x \\pm y)(1 + \\delta)$\uff0c$|\\delta| \\leq \\epsilon_{machine}$</li>\n<li><strong>\u622a\u65ad\u8bef\u5dee</strong>\uff1a\u6709\u9650\u7cbe\u5ea6\u8868\u793a</li>\n<li><strong>\u65b9\u6cd5\u8bef\u5dee</strong>\uff1a\u8fd1\u4f3c\u7b97\u6cd5\u56fa\u6709\u8bef\u5dee</li>\n</ol>\n<p><strong>\u8bef\u5dee\u4f20\u64ad\u5206\u6790</strong>\uff1a</p>\n<p><strong>1. \u77e9\u9635-\u5411\u91cf\u4e58\u79ef</strong>\uff1a\n$$|fl(\\mathbf{H}\\mathbf{v}) - \\mathbf{H}\\mathbf{v}| \\leq n\\epsilon_{machine}|\\mathbf{H}||\\mathbf{v}| + O(\\epsilon_{machine}^2)$$</p>\n<p><strong>2. BFGS\u66f4\u65b0\u8bef\u5dee</strong>\uff1a\n\u8bbe $\\tilde{\\mathbf{H}}_k$ \u662f\u8ba1\u7b97\u7684\u8fd1\u4f3c\uff0c$\\mathbf{H}_k$ \u662f\u7cbe\u786e\u503c\uff1a\n$$|\\tilde{\\mathbf{H}}_{k+1} - \\mathbf{H}_{k+1}| \\leq |\\tilde{\\mathbf{H}}_k - \\mathbf{H}_k| + C\\epsilon_{machine}$$\n\u8bef\u5dee\u53ef\u80fd\u7d2f\u79ef\uff01</p>\n<p><strong>3. \u6c42\u89e3\u7ebf\u6027\u7cfb\u7edf</strong>\uff1a\n\u76f8\u5bf9\u8bef\u5dee\u754c\uff1a\n$$\\frac{|\\tilde{\\mathbf{x}} - \\mathbf{x}|}{|\\mathbf{x}|} \\leq \\kappa(\\mathbf{H}) \\frac{|\\mathbf{r}|}{|\\mathbf{b}|}$$\n\u5176\u4e2d $\\mathbf{r} = \\mathbf{b} - \\mathbf{H}\\tilde{\\mathbf{x}}$ \u662f\u6b8b\u5dee\u3002</p>\n<p><strong>\u7a33\u5b9a\u6027\u589e\u5f3a\u6280\u672f</strong>\uff1a</p>\n<p><strong>1. \u8fed\u4ee3\u7cbe\u5316</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>\u6c42\u89e3 H x = b:\n1. \u8ba1\u7b97\u8fd1\u4f3c\u89e3 x_0\n2. for k = 0, 1, ...\n   r_k = b - H x_k\n   \u6c42\u89e3 H \u03b4_k = r_k\n   x_{k+1} = x_k + \u03b4_k\n</code></pre></div>\n\n<p><strong>2. \u6df7\u5408\u7cbe\u5ea6\u7b56\u7565</strong>\uff1a\n- \u4f4e\u7cbe\u5ea6\u8ba1\u7b97\u4e3b\u4f53\n- \u9ad8\u7cbe\u5ea6\u7d2f\u79ef\u5173\u952e\u91cf\n- \u5b9a\u671f\u9ad8\u7cbe\u5ea6\u6821\u6b63</p>\n<p><strong>3. Kahan\u6c42\u548c</strong>\uff1a\n\u51cf\u5c11\u6d6e\u70b9\u6570\u7d2f\u52a0\u8bef\u5dee\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nv\">sum</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>,<span class=\"w\"> </span><span class=\"nv\">c</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"nv\">x</span><span class=\"w\"> </span><span class=\"nv\">in</span><span class=\"w\"> </span><span class=\"nv\">values</span>:\n<span class=\"w\">    </span><span class=\"nv\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">x</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">c</span>\n<span class=\"w\">    </span><span class=\"nv\">t</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">sum</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nv\">y</span>\n<span class=\"w\">    </span><span class=\"nv\">c</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ss\">(</span><span class=\"nv\">t</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">sum</span><span class=\"ss\">)</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"nv\">y</span>\n<span class=\"w\">    </span><span class=\"nv\">sum</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nv\">t</span>\n</code></pre></div>\n\n<h3 id=\"245\">2.4.5 \u9c81\u68d2\u6027\u589e\u5f3a\u6280\u5de7</h3>\n<p><strong>1. \u5b89\u5168\u4fdd\u62a4\u63aa\u65bd</strong>\uff1a</p>\n<p><strong>\u6570\u503c\u68c0\u67e5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>BFGS\u66f4\u65b0\u524d\u68c0\u67e5\uff1a\nif y^T s &lt; \u03b5 <span class=\"gs\">* ||y|| *</span> ||s||:\n    \u8df3\u8fc7\u66f4\u65b0\u6216\u4f7f\u7528damped BFGS\n\nif ||H|| &gt; max_norm or cond(H) &gt; max_cond:\n    \u91cd\u7f6e\u4e3a H = I \u6216\u5176\u4ed6\u5b89\u5168\u503c\n</code></pre></div>\n\n<p><strong>2. \u4fee\u6b63\u6280\u672f</strong>\uff1a</p>\n<p><strong>Powell's\u4fee\u6b63</strong>\uff1a\n\u786e\u4fdd $\\mathbf{y}^T \\mathbf{s} &gt; 0$\uff1a\n$$\\tilde{\\mathbf{y}} = \\theta \\mathbf{y} + (1-\\theta) \\mathbf{B}_k \\mathbf{s}$$\n\u5176\u4e2d $\\theta$ \u9009\u62e9\u4f7f\u5f97 $\\tilde{\\mathbf{y}}^T \\mathbf{s} \\geq 0.2 \\mathbf{s}^T \\mathbf{B}_k \\mathbf{s}$</p>\n<p><strong>3. \u81ea\u9002\u5e94\u7cbe\u5ea6\u63a7\u5236</strong>\uff1a\n- \u6839\u636e\u95ee\u9898\u89c4\u6a21\u8c03\u6574\u5bb9\u5dee\n- \u76d1\u63a7\u76f8\u5bf9\u8bef\u5dee\u800c\u975e\u7edd\u5bf9\u8bef\u5dee\n- \u4f7f\u7528\u95ee\u9898\u76f8\u5173\u7684\u505c\u6b62\u51c6\u5219</p>\n<p><strong>4. \u91cd\u542f\u7b56\u7565</strong>\uff1a\n- \u5b9a\u671f\u91cd\u7f6eHessian\u8fd1\u4f3c\n- \u57fa\u4e8e\u6027\u80fd\u6307\u6807\u89e6\u53d1\u91cd\u542f\n- \u4fdd\u7559\u90e8\u5206\u5386\u53f2\u4fe1\u606f\u7684\u8f6f\u91cd\u542f</p>\n<p><strong>\u5b9e\u8df5\u5efa\u8bae\u603b\u7ed3</strong>\uff1a</p>\n<ol>\n<li>\u59cb\u7ec8\u76d1\u63a7\u6761\u4ef6\u6570\u548c\u6570\u503c\u7a33\u5b9a\u6027\u6307\u6807</li>\n<li>\u4f7f\u7528\u76f8\u5bf9\u8bef\u5dee\u51c6\u5219\u800c\u975e\u7edd\u5bf9\u8bef\u5dee</li>\n<li>\u5b9e\u73b0\u9632\u5fa1\u6027\u7f16\u7a0b\uff0c\u68c0\u67e5\u5f02\u5e38\u60c5\u51b5</li>\n<li>\u4fdd\u6301\u7b97\u6cd5\u7684\u53ef\u89e3\u91ca\u6027\u548c\u53ef\u8c03\u8bd5\u6027</li>\n<li>\u5728\u7cbe\u5ea6\u548c\u6548\u7387\u4e4b\u95f4\u627e\u5230\u5e73\u8861\u70b9</li>\n</ol>\n<p><strong>\u7814\u7a76\u65b9\u5411</strong>\uff1a</p>\n<ul>\n<li>\u81ea\u9002\u5e94\u7cbe\u5ea6\u4f18\u5316\u7b97\u6cd5</li>\n<li>\u786c\u4ef6\u611f\u77e5\u7684\u6570\u503c\u7a33\u5b9a\u6027</li>\n<li>\u968f\u673a\u820d\u5165\u7684\u5f71\u54cd\u5206\u6790</li>\n<li>\u91cf\u5b50\u8ba1\u7b97\u4e2d\u7684\u6570\u503c\u7a33\u5b9a\u6027</li>\n</ul>\n<h3 id=\"246\">2.4.6 \u73b0\u4ee3\u8ba1\u7b97\u73af\u5883\u4e0b\u7684\u6570\u503c\u6311\u6218</h3>\n<p><strong>1. \u6df7\u5408\u7cbe\u5ea6\u8bad\u7ec3\u7684\u7a33\u5b9a\u6027</strong>\uff1a</p>\n<p><strong>\u52a8\u6001\u635f\u5931\u7f29\u653e(Dynamic Loss Scaling)</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>scale = initial_scale\nfor iteration in training:\n    scaled_loss = loss <span class=\"gs\">* scale</span>\n<span class=\"gs\">    compute_gradients(scaled_loss)  # FP16</span>\n<span class=\"gs\">    if gradients_contain_inf_or_nan:</span>\n<span class=\"gs\">        scale *</span>= backoff_factor\n        skip_update()\n    else:\n        unscale_gradients()\n        if scale &lt; max_scale:\n            scale *= growth_factor\n        update_parameters()  # FP32\n</code></pre></div>\n\n<p><strong>\u5173\u952e\u6d1e\u5bdf</strong>\uff1a</p>\n<ul>\n<li>Hessian\u8fd1\u4f3c\u5728\u4f4e\u7cbe\u5ea6\u4e0b\u5bb9\u6613\u9000\u5316</li>\n<li>\u5173\u952e\u91cf\uff08\u5982 $\\mathbf{y}^T\\mathbf{s}$\uff09\u5fc5\u987b\u9ad8\u7cbe\u5ea6\u8ba1\u7b97</li>\n<li>\u5b9a\u671f\u7684\u9ad8\u7cbe\u5ea6\"\u6821\u51c6\"\u6b65\u9aa4</li>\n</ul>\n<p><strong>2. \u5206\u5e03\u5f0f\u8bad\u7ec3\u7684\u6570\u503c\u4e00\u81f4\u6027</strong>\uff1a</p>\n<p><strong>\u786e\u5b9a\u6027\u5e76\u884c\u5f52\u7ea6</strong>\uff1a\n\u4e0d\u540c\u7684\u5f52\u7ea6\u987a\u5e8f\u5bfc\u81f4\u4e0d\u540c\u7684\u820d\u5165\u8bef\u5dee\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"gh\">#</span> \u975e\u786e\u5b9a\u6027\nsum = parallel_reduce(values)  # \u987a\u5e8f\u4e0d\u5b9a\n\n<span class=\"gh\">#</span> \u786e\u5b9a\u6027\nsum = tree_reduce(values, deterministic=True)\n</code></pre></div>\n\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ul>\n<li>\u4f7f\u7528Kahan\u6c42\u548c\u7684\u5206\u5e03\u5f0f\u7248\u672c</li>\n<li>\u56fa\u5b9a\u901a\u4fe1\u62d3\u6251\u786e\u4fdd\u91cd\u73b0\u6027</li>\n<li>\u9ad8\u7cbe\u5ea6\u7d2f\u52a0\u5668\u7528\u4e8e\u5173\u952e\u805a\u5408</li>\n</ul>\n<p><strong>3. \u7a00\u758f\u5316\u4e0e\u91cf\u5316\u7684\u5f71\u54cd</strong>\uff1a</p>\n<p><strong>\u68af\u5ea6\u7a00\u758f\u5316\u7684\u8bef\u5dee\u7d2f\u79ef</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code>sparse_grad = top_k(grad, sparsity=0.99)\nerror_feedback += grad - sparse_grad\nnext_grad = compute_grad() + momentum * error_feedback\n</code></pre></div>\n\n<p><strong>Hessian\u8fd1\u4f3c\u7684\u4fee\u6b63</strong>\uff1a</p>\n<ul>\n<li>\u7a00\u758f\u5316\u5bfc\u81f4\u7684\u504f\u5dee\u9700\u8981\u8865\u507f</li>\n<li>\u4f7f\u7528\u65e0\u504f\u4f30\u8ba1\u5668</li>\n<li>\u81ea\u9002\u5e94\u8c03\u6574\u7a00\u758f\u5ea6</li>\n</ul>\n<h3 id=\"247\">2.4.7 \u9ad8\u7ea7\u6570\u503c\u5206\u6790\u6280\u672f</h3>\n<p><strong>1. \u540e\u9a8c\u8bef\u5dee\u4f30\u8ba1</strong>\uff1a</p>\n<p><strong>\u53ef\u8ba1\u7b97\u7684\u8bef\u5dee\u754c</strong>\uff1a\n\u5bf9\u4e8e\u7ebf\u6027\u7cfb\u7edf $\\mathbf{H}\\mathbf{x} = \\mathbf{b}$\uff0c\u540e\u9a8c\u8bef\u5dee\u4f30\u8ba1\uff1a\n$$|\\mathbf{x} - \\tilde{\\mathbf{x}}| \\leq \\frac{|\\mathbf{r}|}{\\sigma_{min}(\\mathbf{H})}$$\n\u5176\u4e2d $\\mathbf{r} = \\mathbf{b} - \\mathbf{H}\\tilde{\\mathbf{x}}$ \u662f\u53ef\u8ba1\u7b97\u7684\u6b8b\u5dee\u3002</p>\n<p><strong>\u5b9e\u8df5\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>\u52a8\u6001\u8c03\u6574\u6c42\u89e3\u7cbe\u5ea6</li>\n<li>\u65e9\u505c\u8fed\u4ee3\u6c42\u89e3\u5668</li>\n<li>\u53ef\u9760\u6027\u9a8c\u8bc1</li>\n</ul>\n<p><strong>2. \u533a\u95f4\u7b97\u672f\u4e0e\u9a8c\u8bc1\u8ba1\u7b97</strong>\uff1a</p>\n<p><strong>\u533a\u95f4Hessian</strong>\uff1a\n$$[\\mathbf{H}] = [\\mathbf{H}^L, \\mathbf{H}^U]$$\n\u4fdd\u8bc1\u771f\u5b9eHessian\u5728\u533a\u95f4\u5185\u3002</p>\n<p><strong>\u5e94\u7528</strong>\uff1a</p>\n<ul>\n<li>\u9c81\u68d2\u4f18\u5316\u4fdd\u8bc1</li>\n<li>\u6700\u574f\u60c5\u51b5\u5206\u6790</li>\n<li>\u5b89\u5168\u5173\u952e\u5e94\u7528</li>\n</ul>\n<p><strong>3. \u968f\u673a\u820d\u5165\u7684\u5229\u7528</strong>\uff1a</p>\n<p><strong>\u968f\u673a\u820d\u5165\u5b9a\u4e49</strong>\uff1a\n$$\\text{SR}(x) = \\begin{cases}\n\\lfloor x \\rfloor &amp; \\text{\u6982\u7387} \\frac{\\lceil x \\rceil - x}{\\text{ulp}(x)} \\\n\\lceil x \\rceil &amp; \\text{\u6982\u7387} \\frac{x - \\lfloor x \\rfloor}{\\text{ulp}(x)}\n\\end{cases}$$\n<strong>\u4f18\u52bf</strong>\uff1a</p>\n<ul>\n<li>\u65e0\u504f\u4f30\u8ba1\uff1a$\\mathbb{E}[\\text{SR}(x)] = x$</li>\n<li>\u6253\u7834\u7cfb\u7edf\u6027\u504f\u5dee</li>\n<li>\u67d0\u4e9b\u60c5\u51b5\u4e0b\u63d0\u9ad8\u7cbe\u5ea6</li>\n</ul>\n<h3 id=\"248\">2.4.8 \u5b9e\u9645\u6848\u4f8b\u7814\u7a76</h3>\n<p><strong>\u6848\u4f8b1\uff1a\u5927\u89c4\u6a21\u63a8\u8350\u7cfb\u7edf\u7684\u6570\u503c\u95ee\u9898</strong>\uff1a</p>\n<p><strong>\u95ee\u9898\u63cf\u8ff0</strong>\uff1a</p>\n<ul>\n<li>\u7279\u5f81\u7ef4\u5ea6\uff1a10^9</li>\n<li>\u7a00\u758f\u5ea6\uff1a99.99%</li>\n<li>\u6761\u4ef6\u6570\uff1a10^12</li>\n</ul>\n<p><strong>\u89e3\u51b3\u65b9\u6848</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u5206\u5757\u5bf9\u89d2\u9884\u6761\u4ef6</strong>\uff1a\n   <code>H_precond = BlockDiagonal([H_user, H_item, H_context])</code></p>\n</li>\n<li>\n<p><strong>\u81ea\u9002\u5e94\u6b63\u5219\u5316</strong>\uff1a\n   <code>\u03bb_adaptive = \u03bb_base * (1 + log(condition_number))</code></p>\n</li>\n<li>\n<p><strong>\u589e\u91cf\u66f4\u65b0\u7b56\u7565</strong>\uff1a\n   \u53ea\u66f4\u65b0\u6d3b\u8dc3\u7279\u5f81\u7684Hessian\u5757</p>\n</li>\n</ol>\n<p><strong>\u6548\u679c</strong>\uff1a</p>\n<ul>\n<li>\u6761\u4ef6\u6570\u964d\u4f4e1000\u500d</li>\n<li>\u6536\u655b\u901f\u5ea6\u63d0\u534710\u500d</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u663e\u8457\u6539\u5584</li>\n</ul>\n<p><strong>\u6848\u4f8b2\uff1a\u79d1\u5b66\u8ba1\u7b97\u4e2d\u7684\u75c5\u6001Hessian</strong>\uff1a</p>\n<p><strong>PDE\u79bb\u6563\u5316\u4ea7\u751f\u7684Hessian</strong>\uff1a</p>\n<ul>\n<li>\u7f51\u683c\u7ec6\u5316\u5bfc\u81f4\u6761\u4ef6\u6570\u7206\u70b8</li>\n<li>\u591a\u5c3a\u5ea6\u73b0\u8c61</li>\n<li>\u8fb9\u754c\u6761\u4ef6\u654f\u611f\u6027</li>\n</ul>\n<p><strong>\u591a\u7ea7\u65b9\u6cd5</strong>\uff1a</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"gh\">#</span> V-cycle\ndef v_cycle(A, b, x0):\n    # \u524d\u5e73\u6ed1\n    x = smooth(A, b, x0, n_pre)\n    # \u9650\u5236\u5230\u7c97\u7f51\u683c\n    r = b - A @ x\n    r_coarse = restrict(r)\n    # \u7c97\u7f51\u683c\u6c42\u89e3\n    e_coarse = solve_coarse(A_coarse, r_coarse)\n    # \u5ef6\u62d3\u5230\u7ec6\u7f51\u683c\n    e = prolongate(e_coarse)\n    x = x + e\n    # \u540e\u5e73\u6ed1\n    x = smooth(A, b, x, n_post)\n    return x\n</code></pre></div>\n\n<h3 id=\"249\">2.4.9 \u672a\u6765\u5c55\u671b\u4e0e\u5f00\u653e\u95ee\u9898</h3>\n<p><strong>1. \u65b0\u786c\u4ef6\u67b6\u6784\u7684\u6311\u6218</strong>\uff1a</p>\n<p><strong>\u795e\u7ecf\u5f62\u6001\u8ba1\u7b97</strong>\uff1a</p>\n<ul>\n<li>\u6a21\u62df\u8ba1\u7b97\u7684\u8bef\u5dee\u6a21\u578b</li>\n<li>\u6982\u7387\u8ba1\u7b97\u7684\u6570\u503c\u5206\u6790</li>\n<li>\u80fd\u91cf-\u7cbe\u5ea6\u6743\u8861</li>\n</ul>\n<p><strong>\u91cf\u5b50-\u7ecf\u5178\u6df7\u5408</strong>\uff1a</p>\n<ul>\n<li>\u91cf\u5b50\u8bef\u5dee\u7684\u7ecf\u5178\u8865\u507f</li>\n<li>\u76f8\u5e72\u65f6\u95f4\u9650\u5236\u4e0b\u7684\u7b97\u6cd5\u8bbe\u8ba1</li>\n<li>\u566a\u58f0\u4e2d\u95f4\u5c3a\u5ea6\u91cf\u5b50(NISQ)\u8bbe\u5907</li>\n</ul>\n<p><strong>2. \u7406\u8bba\u7a81\u7834\u9700\u6c42</strong>\uff1a</p>\n<p><strong>\u5f00\u653e\u95ee\u9898</strong>\uff1a</p>\n<ol>\n<li>\u6df7\u5408\u7cbe\u5ea6\u4f18\u5316\u7684\u6700\u4f18\u7b56\u7565</li>\n<li>\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u8bef\u5dee\u4f20\u64ad\u754c</li>\n<li>\u975e\u51f8\u95ee\u9898\u7684\u6761\u4ef6\u6570\u7406\u8bba</li>\n<li>\u81ea\u9002\u5e94\u7cbe\u5ea6\u7684\u6536\u655b\u6027\u4fdd\u8bc1</li>\n</ol>\n<p><strong>3. \u8f6f\u4ef6\u5de5\u5177\u53d1\u5c55</strong>\uff1a</p>\n<p><strong>\u81ea\u52a8\u6570\u503c\u7a33\u5b9a\u6027\u5206\u6790</strong>\uff1a</p>\n<ul>\n<li>\u9759\u6001\u5206\u6790\u5de5\u5177\u68c0\u6d4b\u6f5c\u5728\u95ee\u9898</li>\n<li>\u8fd0\u884c\u65f6\u76d1\u63a7\u548c\u81ea\u52a8\u4fee\u6b63</li>\n<li>\u53ef\u9a8c\u8bc1\u7684\u6570\u503c\u8ba1\u7b97\u5e93</li>\n</ul>\n<p><strong>4. \u8de8\u5b66\u79d1\u878d\u5408</strong>\uff1a</p>\n<p><strong>\u4e0e\u5176\u4ed6\u9886\u57df\u7684\u8054\u7cfb</strong>\uff1a</p>\n<ul>\n<li>\u8ba1\u7b97\u7269\u7406\u4e2d\u7684\u8f9b\u7b97\u6cd5</li>\n<li>\u8ba1\u7b97\u5316\u5b66\u4e2d\u7684\u80fd\u91cf\u5b88\u6052</li>\n<li>\u8ba1\u7b97\u751f\u7269\u5b66\u4e2d\u7684\u968f\u673a\u6a21\u62df</li>\n<li>\u91d1\u878d\u5de5\u7a0b\u4e2d\u7684\u98ce\u9669\u63a7\u5236</li>\n</ul>\n<p><strong>\u7814\u7a76\u673a\u4f1a</strong>\uff1a</p>\n<ul>\n<li>\u9886\u57df\u7279\u5b9a\u7684\u6570\u503c\u7a33\u5b9a\u6027\u7406\u8bba</li>\n<li>\u8de8\u5c3a\u5ea6\u8ba1\u7b97\u7684\u8bef\u5dee\u63a7\u5236</li>\n<li>\u4e0d\u786e\u5b9a\u6027\u91cf\u5316\u7684\u4e8c\u9636\u65b9\u6cd5</li>\n<li>\u53ef\u89e3\u91caAI\u7684\u6570\u503c\u4fdd\u8bc1</li>\n</ul>\n<h2 id=\"_1\">\u672c\u7ae0\u5c0f\u7ed3</h2>\n<p>\u672c\u7ae0\u6df1\u5165\u63a2\u8ba8\u4e86Hessian\u8fd1\u4f3c\u7684\u5404\u79cd\u6280\u672f\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4f7f\u5f97\u4e8c\u9636\u4f18\u5316\u5728\u5927\u89c4\u6a21\u95ee\u9898\u4e0a\u6210\u4e3a\u53ef\u80fd\uff1a</p>\n<p><strong>\u5173\u952e\u6982\u5ff5\u603b\u7ed3</strong>\uff1a</p>\n<ol>\n<li>\n<p><strong>\u6709\u9650\u5185\u5b58\u65b9\u6cd5 (L-BFGS)</strong>\uff1a\n   - \u901a\u8fc7\u5b58\u50a8\u6709\u9650\u7684\u5411\u91cf\u5bf9 ${(\\mathbf{s}_i, \\mathbf{y}_i)}$ \u9690\u5f0f\u8868\u793aHessian\u9006\n   - \u53cc\u5faa\u73af\u9012\u5f52\u7b97\u6cd5\u5b9e\u73b0 $O(mn)$ \u5185\u5b58\u548c\u8ba1\u7b97\u590d\u6742\u5ea6\n   - Sherman-Morrison-Woodbury\u516c\u5f0f\u7684\u5de7\u5999\u5e94\u7528</p>\n</li>\n<li>\n<p><strong>Hessian-\u5411\u91cf\u4e58\u79ef</strong>\uff1a\n   - \u65e0\u9700\u663e\u5f0f\u6784\u5efaHessian\u77e9\u9635\uff0c\u901a\u8fc7 $\\mathbf{H}\\mathbf{v} = \\nabla(g^T\\mathbf{v})$ \u8ba1\u7b97\n   - Pearlmutter\u6280\u5de7\u548cR/L-operator\u7684\u5b9e\u73b0\n   - \u5728\u5171\u8f6d\u68af\u5ea6\u6cd5\u548cNewton-CG\u4e2d\u7684\u6838\u5fc3\u4f5c\u7528</p>\n</li>\n<li>\n<p><strong>\u8d1f\u66f2\u7387\u5229\u7528</strong>\uff1a\n   - Lanczos\u7b97\u6cd5\u9ad8\u6548\u68c0\u6d4b\u8d1f\u7279\u5f81\u503c\n   - \u968f\u673a\u5316\u65b9\u6cd5\u52a0\u901f\u978d\u70b9\u9003\u9038\n   - Trust Region\u6846\u67b6\u4e0b\u7684\u539f\u5219\u6027\u5904\u7406</p>\n</li>\n<li>\n<p><strong>\u6570\u503c\u7a33\u5b9a\u6027</strong>\uff1a\n   - \u6761\u4ef6\u6570\u63a7\u5236\u901a\u8fc7Levenberg-Marquardt\u963b\u5c3c\n   - \u9884\u6761\u4ef6\u5b50\u8bbe\u8ba1\u6539\u5584\u6536\u655b\u6027\n   - \u8bef\u5dee\u4f20\u64ad\u5206\u6790\u548c\u9c81\u68d2\u6027\u589e\u5f3a\u6280\u672f</p>\n</li>\n</ol>\n<p><strong>\u91cd\u8981\u516c\u5f0f\u56de\u987e</strong>\uff1a</p>\n<ul>\n<li>BFGS\u9006\u66f4\u65b0\uff1a$\\mathbf{H}_{k+1} = (\\mathbf{I} - \\rho_k \\mathbf{s}_k \\mathbf{y}_k^T) \\mathbf{H}_k (\\mathbf{I} - \\rho_k \\mathbf{y}_k \\mathbf{s}_k^T) + \\rho_k \\mathbf{s}_k \\mathbf{s}_k^T$</li>\n<li>\u6761\u4ef6\u6570\u5b9a\u4e49\uff1a$\\kappa(\\mathbf{H}) = \\lambda_{max}/\\lambda_{min}$</li>\n<li>Trust Region\u5b50\u95ee\u9898\uff1a$\\min_{|\\mathbf{d}| \\leq \\Delta} f_k + \\mathbf{g}_k^T \\mathbf{d} + \\frac{1}{2} \\mathbf{d}^T \\mathbf{H}_k \\mathbf{d}$</li>\n<li>LM\u6b63\u5219\u5316\uff1a$(\\mathbf{H} + \\lambda \\mathbf{I}) \\mathbf{d} = -\\mathbf{g}$</li>\n</ul>\n<h2 id=\"_2\">\u7ec3\u4e60\u9898</h2>\n<h3 id=\"_3\">\u57fa\u7840\u9898</h3>\n<p><strong>\u7ec3\u4e60 2.1</strong>\uff1a\u63a8\u5bfcBFGS\u66f4\u65b0\u516c\u5f0f\n\u8bc1\u660eBFGS\u66f4\u65b0\u516c\u5f0f\u4fdd\u6301\u5bf9\u79f0\u6027\u548c\u6b63\u5b9a\u6027\u3002\u5177\u4f53\u5730\uff0c\u5982\u679c $\\mathbf{B}_k \\succ 0$ \u4e14 $\\mathbf{y}_k^T \\mathbf{s}_k &gt; 0$\uff0c\u8bc1\u660e $\\mathbf{B}_{k+1} \\succ 0$\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528\u8c31\u5206\u89e3\u548cCauchy-Schwarz\u4e0d\u7b49\u5f0f\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bbe $\\mathbf{B}_k = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^T$ \u4e3a\u8c31\u5206\u89e3\uff0c\u5176\u4e2d $\\mathbf{\\Lambda} = \\text{diag}(\\lambda_1, ..., \\lambda_n) \\succ 0$\u3002</p>\n<p>BFGS\u66f4\u65b0\u53ef\u5199\u4e3a\uff1a\n$$\\mathbf{B}_{k+1} = \\mathbf{B}_k + \\mathbf{u}\\mathbf{u}^T - \\mathbf{v}\\mathbf{v}^T$$\n\u5176\u4e2d $\\mathbf{u} = \\mathbf{y}_k/\\sqrt{\\mathbf{y}_k^T\\mathbf{s}_k}$\uff0c$\\mathbf{v} = \\mathbf{B}_k\\mathbf{s}_k/\\sqrt{\\mathbf{s}_k^T\\mathbf{B}_k\\mathbf{s}_k}$\u3002</p>\n<p>\u5bf9\u4efb\u610f $\\mathbf{x} \\neq \\mathbf{0}$\uff1a\n$$\\mathbf{x}^T\\mathbf{B}_{k+1}\\mathbf{x} = \\mathbf{x}^T\\mathbf{B}_k\\mathbf{x} + (\\mathbf{x}^T\\mathbf{u})^2 - (\\mathbf{x}^T\\mathbf{v})^2$$\n\u9700\u8981\u8bc1\u660e\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e3a\u6b63\u3002\u8003\u8651\u6700\u574f\u60c5\u51b5\uff0c\u5f53 $\\mathbf{x}$ \u4e0e $\\mathbf{v}$ \u5171\u7ebf\u65f6...\uff08\u5b8c\u6574\u8bc1\u660e\u6d89\u53ca\u6784\u9020\u6027\u8bba\u8bc1\uff09</p>\n</details>\n<p><strong>\u7ec3\u4e60 2.2</strong>\uff1aL-BFGS\u5185\u5b58\u590d\u6742\u5ea6\u5206\u6790\n\u8bbe $n$ \u662f\u95ee\u9898\u7ef4\u5ea6\uff0c$m$ \u662f\u5b58\u50a8\u7684\u5411\u91cf\u5bf9\u6570\u3002\u5206\u6790L-BFGS\u7b97\u6cd5\u7684\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u5e76\u4e0e\u5b8c\u6574BFGS\u6bd4\u8f83\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u53cc\u5faa\u73af\u4e2d\u7684\u64cd\u4f5c\u6b21\u6570\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a</p>\n<ul>\n<li>L-BFGS\uff1a$O(mn)$ \u5b58\u50a8 $m$ \u4e2a $n$ \u7ef4\u5411\u91cf\u5bf9</li>\n<li>\u5b8c\u6574BFGS\uff1a$O(n^2)$ \u5b58\u50a8 $n \\times n$ \u77e9\u9635</li>\n</ul>\n<p>\u65f6\u95f4\u590d\u6742\u5ea6\uff08\u6bcf\u6b21\u8fed\u4ee3\uff09\uff1a</p>\n<ul>\n<li>L-BFGS\uff1a$O(mn)$ \u53cc\u5faa\u73af\uff0c\u6bcf\u6b65 $O(n)$ \u5185\u79ef</li>\n<li>\u5b8c\u6574BFGS\uff1a$O(n^2)$ \u77e9\u9635\u66f4\u65b0</li>\n</ul>\n<p>\u5f53 $m \\ll n$ \u65f6\uff0cL-BFGS\u663e\u8457\u8282\u7701\u5185\u5b58\u548c\u8ba1\u7b97\u3002</p>\n</details>\n<p><strong>\u7ec3\u4e60 2.3</strong>\uff1aHessian-\u5411\u91cf\u4e58\u79ef\u7684\u6709\u9650\u5dee\u5206\u8fd1\u4f3c\n\u7ed9\u5b9a\u51fd\u6570 $f: \\mathbb{R}^n \\to \\mathbb{R}$ \u548c\u5411\u91cf $\\mathbf{v}$\uff0c\u5982\u4f55\u7528\u6709\u9650\u5dee\u5206\u8fd1\u4f3c $\\mathbf{H}\\mathbf{v}$\uff1f\u5206\u6790\u622a\u65ad\u8bef\u5dee\u548c\u820d\u5165\u8bef\u5dee\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651 $\\nabla f(\\mathbf{x} + h\\mathbf{v})$ \u7684Taylor\u5c55\u5f00\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6709\u9650\u5dee\u5206\u516c\u5f0f\uff1a\n$$\\mathbf{H}\\mathbf{v} \\approx \\frac{\\nabla f(\\mathbf{x} + h\\mathbf{v}) - \\nabla f(\\mathbf{x})}{h}$$\n\u8bef\u5dee\u5206\u6790\uff1a</p>\n<ul>\n<li>\u622a\u65ad\u8bef\u5dee\uff1a$O(h)$ \u6765\u81eaTaylor\u5c55\u5f00\u7684\u9ad8\u9636\u9879</li>\n<li>\u820d\u5165\u8bef\u5dee\uff1a$O(\\epsilon_{machine}/h)$ \u6765\u81ea\u6570\u503c\u8ba1\u7b97</li>\n</ul>\n<p>\u6700\u4f18\u6b65\u957f\uff1a$h_{opt} = \\sqrt{\\epsilon_{machine}}$\uff0c\u603b\u8bef\u5dee $O(\\sqrt{\\epsilon_{machine}})$\u3002</p>\n</details>\n<h3 id=\"_4\">\u6311\u6218\u9898</h3>\n<p><strong>\u7ec3\u4e60 2.4</strong>\uff1a\u5757L-BFGS\u8bbe\u8ba1\n\u8bbe\u8ba1\u4e00\u4e2a\u5757L-BFGS\u7b97\u6cd5\uff0c\u540c\u65f6\u66f4\u65b0\u591a\u4e2a\u65b9\u5411\u3002\u5206\u6790\u5176\u4f18\u52bf\u548c\u5b9e\u73b0\u6311\u6218\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u8003\u8651\u5757\u5411\u91cf $\\mathbf{S}_k = [\\mathbf{s}_1, ..., \\mathbf{s}_b]$ \u548c $\\mathbf{Y}_k = [\\mathbf{y}_1, ..., \\mathbf{y}_b]$\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5757\u66f4\u65b0\u516c\u5f0f\uff1a\n$$\\mathbf{H}_{k+1} = \\mathbf{H}_k + (\\mathbf{S}_k - \\mathbf{H}_k\\mathbf{Y}_k)(\\mathbf{Y}_k^T\\mathbf{S}_k)^{-1}\\mathbf{Y}_k^T$$</p>\n<p>\u4f18\u52bf\uff1a</p>\n<ul>\n<li>\u66f4\u597d\u7684\u7f13\u5b58\u5229\u7528\u7387</li>\n<li>\u5e76\u884c\u5316\u6f5c\u529b</li>\n<li>\u53ef\u80fd\u66f4\u597d\u7684\u6536\u655b\u6027</li>\n</ul>\n<p>\u6311\u6218\uff1a</p>\n<ul>\n<li>\u9700\u8981\u6c42\u89e3 $b \\times b$ \u7ebf\u6027\u7cfb\u7edf</li>\n<li>\u5b58\u50a8\u9700\u6c42\u589e\u52a0\u5230 $O(mbn)$</li>\n<li>\u6570\u503c\u7a33\u5b9a\u6027\u66f4\u590d\u6742</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e60 2.5</strong>\uff1a\u81ea\u9002\u5e94\u8d1f\u66f2\u7387\u68c0\u6d4b\n\u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\uff0c\u81ea\u9002\u5e94\u5730\u51b3\u5b9a\u4f55\u65f6\u8fdb\u884c\u8d1f\u66f2\u7387\u68c0\u6d4b\uff0c\u5e73\u8861\u8ba1\u7b97\u6210\u672c\u548c\u6536\u655b\u901f\u5ea6\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u76d1\u63a7\u68af\u5ea6\u8303\u6570\u4e0b\u964d\u7387\u548c\u6b65\u957f\u53d8\u5316\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u81ea\u9002\u5e94\u7b56\u7565\uff1a</p>\n<ol>\n<li>\n<p>\u76d1\u63a7\u6307\u6807\uff1a\n   - \u68af\u5ea6\u8303\u6570\u6bd4\u7387\uff1a$r_k = |\\mathbf{g}_k|/|\\mathbf{g}_{k-1}|$\n   - \u6b65\u957f\u8d8b\u52bf\uff1a$\\alpha_k$ \u7684\u79fb\u52a8\u5e73\u5747</p>\n</li>\n<li>\n<p>\u89e6\u53d1\u6761\u4ef6\uff1a\n   - \u5982\u679c $r_k &gt; 0.9$ \u8fde\u7eed $T$ \u6b65\uff08\u505c\u6ede\uff09\n   - \u6216 $\\bar{\\alpha} &lt; \\epsilon$ \uff08\u6b65\u957f\u8fc7\u5c0f\uff09\n   - \u5219\u8fdb\u884cLanczos\u68c0\u6d4b</p>\n</li>\n<li>\n<p>\u52a8\u6001\u8c03\u6574\uff1a\n   - \u6210\u529f\u9003\u79bb\u540e\u589e\u52a0\u68c0\u6d4b\u95f4\u9694\n   - \u591a\u6b21\u672a\u68c0\u6d4b\u5230\u8d1f\u66f2\u7387\u5219\u51cf\u5c11\u9891\u7387</p>\n</li>\n</ol>\n</details>\n<p><strong>\u7ec3\u4e60 2.6</strong>\uff1a\u6df7\u5408\u7cbe\u5ea6L-BFGS\n\u8bbe\u8ba1\u4e00\u4e2a\u6df7\u5408\u7cbe\u5ea6L-BFGS\u5b9e\u73b0\uff0c\u5728FP16\u548cFP32\u4e4b\u95f4\u667a\u80fd\u5207\u6362\u3002\u5206\u6790\u7cbe\u5ea6\u635f\u5931\u548c\u6027\u80fd\u63d0\u5347\u7684\u6743\u8861\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5173\u952e\u91cf\uff08\u5982 $\\mathbf{y}_k^T\\mathbf{s}_k$\uff09\u4f7f\u7528\u9ad8\u7cbe\u5ea6\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u6df7\u5408\u7cbe\u5ea6\u7b56\u7565\uff1a</p>\n<ol>\n<li>FP16\u5b58\u50a8\uff1a\u5411\u91cf\u5bf9 ${(\\mathbf{s}_i, \\mathbf{y}_i)}$</li>\n<li>\n<p>FP32\u8ba1\u7b97\uff1a\n   - \u5185\u79ef $\\mathbf{y}_i^T\\mathbf{s}_i$ \u548c $\\rho_i$\n   - \u7d2f\u79ef\u91cf $\\alpha_i$</p>\n</li>\n<li>\n<p>\u81ea\u9002\u5e94\u5207\u6362\uff1a\n   - \u76d1\u63a7 $|\\mathbf{y}_k|/|\\mathbf{s}_k|$ \u6bd4\u7387\n   - \u8fc7\u5927\u65f6\u5347\u7ea7\u5230FP32\u907f\u514d\u6ea2\u51fa</p>\n</li>\n</ol>\n<p>\u6027\u80fd\u5206\u6790\uff1a</p>\n<ul>\n<li>\u5185\u5b58\u51cf\u5c1150%</li>\n<li>\u8ba1\u7b97\u52a0\u901f1.5-2x\uff08GPU\u4f9d\u8d56\uff09</li>\n<li>\u7cbe\u5ea6\u635f\u5931\u901a\u5e38\u53ef\u63a5\u53d7\uff08\u76d1\u63a7\u6536\u655b\uff09</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e60 2.7</strong>\uff1a\u5206\u5e03\u5f0fTrust Region\u6c42\u89e3\n\u8bbe\u8ba1\u4e00\u4e2a\u5206\u5e03\u5f0f\u7b97\u6cd5\u6c42\u89e3\u5927\u89c4\u6a21Trust Region\u5b50\u95ee\u9898\uff0c\u8003\u8651\u901a\u4fe1\u6210\u672c\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u4f7f\u7528Lanczos\u8fed\u4ee3\u7684\u5206\u5e03\u5f0f\u7248\u672c\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u5206\u5e03\u5f0f\u7b56\u7565\uff1a</p>\n<ol>\n<li>\u6570\u636e\u5206\u533a\uff1a\u53c2\u6570\u7a7a\u95f4\u5206\u5757</li>\n<li>\n<p>\u5206\u5e03\u5f0fLanczos\uff1a\n   - \u672c\u5730\u8ba1\u7b97 $\\mathbf{H}_i\\mathbf{v}_i$\n   - All-reduce\u805a\u5408\u7ed3\u679c</p>\n</li>\n<li>\n<p>\u901a\u4fe1\u4f18\u5316\uff1a\n   - \u91cd\u53e0\u8ba1\u7b97\u4e0e\u901a\u4fe1\n   - \u4f7f\u7528\u68af\u5ea6\u538b\u7f29\u6280\u672f\n   - \u6279\u91cf\u5904\u7406\u591a\u4e2a\u5411\u91cf</p>\n</li>\n</ol>\n<p>\u5173\u952e\u6311\u6218\uff1a</p>\n<ul>\n<li>\u4fdd\u6301\u6570\u503c\u6b63\u4ea4\u6027</li>\n<li>\u8d1f\u8f7d\u5747\u8861</li>\n<li>\u5bb9\u9519\u6027\u8bbe\u8ba1</li>\n</ul>\n</details>\n<p><strong>\u7ec3\u4e60 2.8</strong>\uff1a\u7406\u8bba\u5206\u6790\u9898\n\u8bc1\u660e\uff1a\u5bf9\u4e8e\u5f3a\u51f8\u4e8c\u6b21\u51fd\u6570\uff0c\u4f7f\u7528\u7cbe\u786e\u7ebf\u641c\u7d22\u7684BFGS\u65b9\u6cd5\u5728 $n$ \u6b65\u5185\u6536\u655b\u5230\u7cbe\u786e\u89e3\u3002</p>\n<p><em>\u63d0\u793a</em>\uff1a\u5229\u7528\u5171\u8f6d\u65b9\u5411\u7684\u6027\u8d28\u3002</p>\n<details>\n<summary>\u7b54\u6848</summary>\n<p>\u8bc1\u660e\u6982\u8981\uff1a</p>\n<ol>\n<li>\u5bf9\u4e8c\u6b21\u51fd\u6570 $f(\\mathbf{x}) = \\frac{1}{2}\\mathbf{x}^T\\mathbf{A}\\mathbf{x} - \\mathbf{b}^T\\mathbf{x}$</li>\n<li>BFGS\u751f\u6210\u5171\u8f6d\u65b9\u5411\uff1a$\\mathbf{s}_i^T\\mathbf{A}\\mathbf{s}_j = 0$ for $i \\neq j$</li>\n<li>\u5171\u8f6d\u65b9\u5411\u5f20\u6210\u6574\u4e2a\u7a7a\u95f4\u9700\u6700\u591a $n$ \u4e2a</li>\n<li>\u56e0\u6b64 $n$ \u6b65\u540e $\\mathbf{H}_n = \\mathbf{A}^{-1}$\uff08\u7cbe\u786e\uff09</li>\n<li>\u4e0b\u4e00\u6b65\u5373\u5f97\u5230\u7cbe\u786e\u89e3</li>\n</ol>\n<p>\u5173\u952e\uff1aBFGS\u4fdd\u6301\u4e86\"\u9057\u4f20\u6027\u8d28\"\u3002</p>\n</details>\n<h2 id=\"gotchas\">\u5e38\u89c1\u9677\u9631\u4e0e\u9519\u8bef (Gotchas)</h2>\n<h3 id=\"1-l-bfgs\">1. L-BFGS\u66f4\u65b0\u7684\u6570\u503c\u95ee\u9898</h3>\n<ul>\n<li><strong>\u9677\u9631</strong>\uff1a\u5f53 $\\mathbf{y}_k^T\\mathbf{s}_k \\approx 0$ \u65f6\u76f4\u63a5\u66f4\u65b0</li>\n<li><strong>\u540e\u679c</strong>\uff1a\u6570\u503c\u4e0d\u7a33\u5b9a\uff0c\u751a\u81f3\u9664\u96f6\u9519\u8bef</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u68c0\u67e5 $\\mathbf{y}_k^T\\mathbf{s}_k &gt; \\epsilon|\\mathbf{y}_k||\\mathbf{s}_k|$\uff0c\u5426\u5219\u8df3\u8fc7\u66f4\u65b0</li>\n</ul>\n<h3 id=\"2-hessian-\">2. Hessian-\u5411\u91cf\u4e58\u79ef\u7684\u5185\u5b58\u6cc4\u6f0f</h3>\n<ul>\n<li><strong>\u9677\u9631</strong>\uff1a\u5728\u81ea\u52a8\u5fae\u5206\u4e2d\u4fdd\u7559\u8ba1\u7b97\u56fe</li>\n<li><strong>\u540e\u679c</strong>\uff1a\u5185\u5b58\u5feb\u901f\u8017\u5c3d</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u4f7f\u7528<code>detach()</code>\u6216<code>stop_gradient</code>\u53ca\u65f6\u91ca\u653e</li>\n</ul>\n<h3 id=\"3\">3. \u8d1f\u66f2\u7387\u68c0\u6d4b\u7684\u65f6\u673a</h3>\n<ul>\n<li><strong>\u9677\u9631</strong>\uff1a\u6bcf\u6b65\u90fd\u8fdb\u884cLanczos\u8fed\u4ee3</li>\n<li><strong>\u540e\u679c</strong>\uff1a\u8ba1\u7b97\u6210\u672c\u8fc7\u9ad8</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u81ea\u9002\u5e94\u68c0\u6d4b\u7b56\u7565\uff0c\u57fa\u4e8e\u6536\u655b\u6307\u6807</li>\n</ul>\n<h3 id=\"4-trust-region\">4. Trust Region\u534a\u5f84\u7684\u521d\u59cb\u5316</h3>\n<ul>\n<li><strong>\u9677\u9631</strong>\uff1a\u56fa\u5b9a\u521d\u59cb\u534a\u5f84</li>\n<li><strong>\u540e\u679c</strong>\uff1a\u5bf9\u4e0d\u540c\u89c4\u6a21\u95ee\u9898\u9002\u5e94\u6027\u5dee</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u57fa\u4e8e\u68af\u5ea6\u8303\u6570\u81ea\u9002\u5e94\uff1a$\\Delta_0 = |\\mathbf{g}_0|$</li>\n</ul>\n<h3 id=\"5\">5. \u9884\u6761\u4ef6\u5b50\u7684\u66f4\u65b0\u9891\u7387</h3>\n<ul>\n<li><strong>\u9677\u9631</strong>\uff1a\u6bcf\u6b65\u91cd\u65b0\u8ba1\u7b97\u9884\u6761\u4ef6\u5b50</li>\n<li><strong>\u540e\u679c</strong>\uff1a\u5f00\u9500\u8d85\u8fc7\u6536\u76ca</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u5b9a\u671f\u66f4\u65b0\u6216\u57fa\u4e8e\u6761\u4ef6\u6570\u53d8\u5316</li>\n</ul>\n<h3 id=\"6\">6. \u6df7\u5408\u7cbe\u5ea6\u7684\u6570\u503c\u9677\u9631</h3>\n<ul>\n<li><strong>\u9677\u9631</strong>\uff1a\u5173\u952e\u91cf\u4f7f\u7528\u4f4e\u7cbe\u5ea6</li>\n<li><strong>\u540e\u679c</strong>\uff1a\u7d2f\u79ef\u8bef\u5dee\u5bfc\u81f4\u53d1\u6563</li>\n<li><strong>\u89e3\u51b3</strong>\uff1a\u8bc6\u522b\u6570\u503c\u654f\u611f\u64cd\u4f5c\uff0c\u9009\u62e9\u6027\u4f7f\u7528\u9ad8\u7cbe\u5ea6</li>\n</ul>\n<h2 id=\"_5\">\u6700\u4f73\u5b9e\u8df5\u68c0\u67e5\u6e05\u5355</h2>\n<h3 id=\"_6\">\u7b97\u6cd5\u8bbe\u8ba1\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u9009\u62e9\u5408\u9002\u7684Hessian\u8fd1\u4f3c\u65b9\u6cd5\uff08\u5185\u5b58 vs \u7cbe\u5ea6\u6743\u8861\uff09</li>\n<li>[ ] \u786e\u5b9a\u662f\u5426\u9700\u8981\u8d1f\u66f2\u7387\u4fe1\u606f\uff08\u95ee\u9898\u662f\u5426\u975e\u51f8\uff09</li>\n<li>[ ] \u8bbe\u8ba1\u6570\u503c\u7a33\u5b9a\u6027\u4fdd\u62a4\u63aa\u65bd</li>\n<li>[ ] \u8003\u8651\u5e76\u884c\u5316\u548c\u5206\u5e03\u5f0f\u9700\u6c42</li>\n</ul>\n<h3 id=\"_7\">\u5b9e\u73b0\u9636\u6bb5</h3>\n<ul>\n<li>[ ] \u5b9e\u73b0\u6570\u503c\u68c0\u67e5\uff08\u6761\u4ef6\u6570\u3001\u6b63\u5b9a\u6027\uff09</li>\n<li>[ ] \u6dfb\u52a0\u5f02\u5e38\u5904\u7406\uff08\u9664\u96f6\u3001\u6ea2\u51fa\uff09</li>\n<li>[ ] \u4f7f\u7528\u9ad8\u6548\u7684\u7ebf\u6027\u4ee3\u6570\u5e93</li>\n<li>[ ] \u5b9e\u73b0\u8bca\u65ad\u548c\u65e5\u5fd7\u529f\u80fd</li>\n</ul>\n<h3 id=\"_8\">\u8c03\u53c2\u9636\u6bb5</h3>\n<ul>\n<li>[ ] L-BFGS\u5386\u53f2\u957f\u5ea6 $m$\uff1a\u4ece5\u5f00\u59cb\uff0c\u6839\u636e\u5185\u5b58\u8c03\u6574</li>\n<li>[ ] Trust Region\u521d\u59cb\u534a\u5f84\uff1a$\\Delta_0 = \\min(1, |\\mathbf{g}_0|)$</li>\n<li>[ ] \u7ebf\u641c\u7d22\u53c2\u6570\uff1a$c_1 = 10^{-4}$, $c_2 = 0.9$\uff08Wolfe\u6761\u4ef6\uff09</li>\n<li>[ ] \u6570\u503c\u5bb9\u5dee\uff1a\u76f8\u5bf9\u8bef\u5dee $10^{-8}$\uff0c\u7edd\u5bf9\u8bef\u5dee $10^{-12}$</li>\n</ul>\n<h3 id=\"_9\">\u6027\u80fd\u4f18\u5316</h3>\n<ul>\n<li>[ ] Profile\u627e\u51fa\u8ba1\u7b97\u74f6\u9888</li>\n<li>[ ] \u8003\u8651\u5411\u91cf\u5316\u548c\u6279\u5904\u7406</li>\n<li>[ ] \u4f18\u5316\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f</li>\n<li>[ ] \u5b9e\u73b0checkpoint\u7b56\u7565</li>\n</ul>\n<h3 id=\"_10\">\u9c81\u68d2\u6027\u6d4b\u8bd5</h3>\n<ul>\n<li>[ ] \u6d4b\u8bd5\u75c5\u6001\u95ee\u9898\uff08\u9ad8\u6761\u4ef6\u6570\uff09</li>\n<li>[ ] \u6d4b\u8bd5\u968f\u673a\u521d\u59cb\u5316</li>\n<li>[ ] \u9a8c\u8bc1\u6536\u655b\u6027\u4fdd\u8bc1</li>\n<li>[ ] \u538b\u529b\u6d4b\u8bd5\uff08\u5927\u89c4\u6a21\u3001\u957f\u65f6\u95f4\u8fd0\u884c\uff09</li>\n</ul>\n<h2 id=\"_11\">\u6df1\u5165\u7814\u7a76\u65b9\u5411</h2>\n<ol>\n<li><strong>\u968f\u673a\u4e8c\u9636\u65b9\u6cd5</strong>\uff1a\u5982\u4f55\u5728\u968f\u673a\u68af\u5ea6setting\u4e0b\u6709\u6548\u5229\u7528\u4e8c\u9636\u4fe1\u606f</li>\n<li><strong>\u9690\u5f0f\u6b63\u5219\u5316</strong>\uff1aL-BFGS\u7b49\u65b9\u6cd5\u7684\u9690\u5f0f\u504f\u597d\u5982\u4f55\u5f71\u54cd\u89e3\u7684\u8d28\u91cf</li>\n<li><strong>\u786c\u4ef6\u534f\u540c\u8bbe\u8ba1</strong>\uff1a\u9488\u5bf9\u7279\u5b9a\u786c\u4ef6\uff08GPU/TPU\uff09\u4f18\u5316\u7684Hessian\u8fd1\u4f3c</li>\n<li><strong>\u5728\u7ebf\u5b66\u4e60\u573a\u666f</strong>\uff1a\u6d41\u6570\u636e\u4e0b\u7684\u589e\u91cfHessian\u66f4\u65b0\u7b56\u7565</li>\n</ol>"
  }
}